define("component/kp/kpTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n            ",i=n["if"].call(e,e&&e.keyName,{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function c(e,t){var n="",r;return n+="\n                "+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+"\n            ",n}function h(e,t){return"\n                Select Key Pair as $DefaultKeyPair\n            "}function p(e,t){var r="",i;r+="\n            "+a((i=e&&e.keyName,typeof i===u?i.apply(e):i))+"\n            ",i=n["if"].call(e,e&&e.defaultKey,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;r+="\n            ",i=n["if"].call(e,e&&e.noKey,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function d(e,t){var r="";return r+='\n                <i class="icon-info tooltip" data-tooltip="'+a(n.i18n.call(e,"PROP_INSTANCE_TIP_NO_KP",{hash:{},data:t}))+'"></i>\n            ',r}function v(e,t){var r="";return r+='\n        <div class="manage-kp btn btn-primary" style="display:none;">'+a(n.i18n.call(e,"PROP_INSTANCE_MANAGE_KP",{hash:{},data:t}))+"</div>\n        ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="selectbox keypair-select">\n    <div class="selection">\n        ',o=n["if"].call(t,t&&t.isRunTime,{hash:{},inverse:f.program(6,p,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n\n    </div>\n    <div style="height: 300px; width:260px;" class="dropdown scroll-wrap scrollbar-auto-hide  clearfix">\n        <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n        <div class="scroll-content" id="kp-content">\n        </div>\n        ',o=n.unless.call(t,t&&t.isRunTime,{hash:{},inverse:f.noop,fn:f.program(9,v,i),data:i});if(o||o===0)s+=o;return s+='\n        <input class="input keypair-filter" type="text" placeholder="'+a(n.i18n.call(t,"PROP_INSTANCE_FILTER_KP",{hash:{},data:i}))+'"/>\n    </div>\n</div>\n\n',s},n.frame=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n        ",i=n.unless.call(e,e&&e.isRunTime,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;r+='\n        <li data-id="@no" class="item',i=n["if"].call(e,e&&e.noKey,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" tabindex="-1">\n            '+a(n.i18n.call(e,"PROP_INSTANCE_NO_KP",{hash:{},data:t}))+'\n            <i class="icon-info tooltip" data-tooltip="'+a(n.i18n.call(e,"PROP_INSTANCE_TIP_NO_KP",{hash:{},data:t}))+'"></i>\n        </li>\n    ',r}function c(e,t){var r="",i;r+='\n        <li data-id="@default" class="item',i=n["if"].call(e,e&&e.defaultKey,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" tabindex="-1">\n            '+a(n.i18n.call(e,"PROP_INSTANCE_DEFAULT_KP",{hash:{},data:t}))+'\n            <i class="icon-info tooltip" data-tooltip=\''+a(n.i18n.call(e,"PROP_INSTANCE_TIP_DEFAULT_KP",{hash:{},data:t}))+"'></i>\n        </li>\n        ",r}function h(e,t){return" selected"}function p(e,t){var r="",i;r+='\n        <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+a((i=e&&e.keyName,typeof i===f?i.apply(e):i))+'" data-fingerprint="'+a((i=e&&e.keyFingerprint,typeof i===f?i.apply(e):i))+'" tabindex="-1">'+a((i=e&&e.keyName,typeof i===f?i.apply(e):i))+"\n        </li>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a=this.escapeExpression,f="function";s+='<ul id="kp-list">\n    ',o=n.unless.call(t,t&&t.hideDefaultNoKey,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n    ",o=n.each.call(t,t&&t.keys,{hash:{},inverse:u.noop,fn:u.program(5,p,i),data:i});if(o||o===0)s+=o;return s+="\n</ul>\n\n",s},n.keys=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="kp-no-credential tac">\n    <p>You are using a demo AWS account.</p>\n    <a class="show-credential">Provide AWS Credential <br/>to manage key pairs</a>\n</div>\n\n'},n.nocredential=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="loading-spinner loading-spinner-small"></div>\n\n'},n.loading=e.template(t),n}),define("component/kp/kpDialogTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n                                        <tr class="item" data-id="">\n                                            <td>\n                                                <div class="checkbox">\n                                                    <input id="kp-select-'+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+'" type="checkbox" value="None" data-name="'+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+'" class="one-cb">\n                                                    <label for="kp-select-'+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+'"></label>\n                                                </div>\n                                            </td>\n                                            <td>'+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+"</td>\n                                            <td>"+a((r=e&&e.keyFingerprint,typeof r===u?r.apply(e):r))+"</td>\n                                        </tr>\n                                        ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div id="modal-kp-manage" class="modal-toolbar">\n    <div class="modal-header">\n        <h3>Manage Key Pairs in '+a((o=t&&t.regionName,typeof o===u?o.apply(t):o))+'</h3>\n        <i class="modal-close">Ã—</i>\n    </div>\n\n    <div class="modal-body">\n        <div class="content-wrap">\n            <div class="toolbar">\n                <button class="icon-new-stack btn btn-blue" id="kp-create">Create Key Pair</button>\n                <div class="btn-group">\n                    <button class="icon-import tooltip" id="kp-import" data-tooltip="">Import Key Pair</button>\n                    <button class="icon-del tooltip" id="kp-delete" data-tooltip="" disabled>Delete</button>\n                    <button class="icon-refresh tooltip" id="kp-refresh" data-tooltip=""></button>\n                </div>\n            </div>\n            <div class="list">\n                <div class="slidebox">\n                    <div class="content clearfix">\n                    </div>\n                    <div class="error">\n                        something wrong\n                    </div>\n                </div>\n                <div class="table-head-fix">\n                        <table class="table-head">\n                            <thead>\n                                <tr>\n                                    <th>\n                                        <div class="checkbox">\n                                            <input id="kp-select-all" type="checkbox" value="None">\n                                            <label for="kp-select-all"></label>\n                                        </div>\n                                    </th>\n                                    <th class="sortable">Name</th>\n                                    <th>Fingerprint</th>\n                                </tr>\n                            </thead>\n                        </table>\n                        <div class="scroll-wrap">\n                            <div class="scrollbar-veritical-wrap" style="display: block;"><div class="scrollbar-veritical-thumb"></div></div>\n                            <div class="scroll-content" style="display:block;">\n                                <table class="table">\n                                    <thead>\n                                        <tr>\n                                            <th><div class="th-inner"></div></th>\n                                            <th><div class="th-inner"></div></th>\n                                            <th><div class="th-inner"></div></th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                        ',o=n.each.call(t,t&&t.keys,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n                                    </tbody>\n                                </table>\n                            </div>\n                        </div>\n                    </div>\n\n            </div>\n        </div>\n    </div>\n</div>\n\n",s},n.frame=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n<tr class="item" data-id="">\n    <td>\n        <div class="checkbox">\n            <input id="kp-select-'+a((r=e&&e.keyFingerprint,typeof r===u?r.apply(e):r))+'" type="checkbox" value="None" data-name="'+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+'" class="one-cb">\n            <label for="kp-select-'+a((r=e&&e.keyFingerprint,typeof r===u?r.apply(e):r))+'"></label>\n        </div>\n    </td>\n    <td>'+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+"</td>\n    <td>"+a((r=e&&e.keyFingerprint,typeof r===u?r.apply(e):r))+"</td>\n</tr>\n",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;o=n.each.call(t,t&&t.keys,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n\n",s},n.keys=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="loading-spinner"></div>\n\n'},n.loading=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="slide-create" data-bind="true">\n    <div class="before-create">\n        <label for="create-kp-name">Key Pair Name</label>\n        <input class="input" type="text" id="create-kp-name" data-ignore="true" data-ignore-regexp="^[a-zA-Z0-9,_-]*$" data-required="true" maxlength="255" placeholder="allow alphanumber, _ or - up to 255 characters" autofocus>\n    </div>\n    <div class="after-create hide">Key pair <span></span> is created. You have to download the private key file (*.pem file) before you can continue. Store it in a secure and accessible location. You will not be able to download the file again after it\'s created.</div>\n    <div class="init action">\n        <button class="btn btn-blue do-action" data-action="create">Create</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Creating...</button>\n    </div>\n    <div class="download action" style="display:none;">\n        <a class="btn btn-blue do-action pulse" data-action="download" id="download-kp">Download</a>\n        <button class="btn btn-silver cancel" disabled>Close</button>\n    </div>\n</div>\n\n'},n.slideCreate=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n;return a((n=e&&e.selecteKeyName,typeof n===u?n.apply(e):n))}function c(e,t){var n="",r;return n+="selected "+a((r=e&&e.selectedCount,typeof r===u?r.apply(e):r))+" key pairs",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">Confirm to delete ',o=n["if"].call(t,t&&t.selecteKeyName,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='?</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">Delete</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Deleting...</button>\n    </div>\n</div>\n',s},n.slideDelete=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="slide-import" data-bind="true">\n    <label for="import-kp-name">Key Pair Name</label>\n    <input class="input" type="text" id="import-kp-name" data-ignore="true" data-ignore-regexp="^[a-zA-Z0-9,_-]*$" data-required="true" maxlength="255" placeholder="allow alphanumber, _ or - up to 255 characters">\n    <div class="import-zone">\n\n    </div>\n    <div class="init action">\n        <button class="btn" disabled>Import</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="ready action" style="display:none;">\n        <button class="btn btn-blue do-action" data-action="import">Import</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Importing...</button>\n    </div>\n</div>\n\n'},n.slideImport=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="upload-kp-component drop-zone">\n    <p class="upload-stuff">\n        Drop '+a((o=t&&t.type,typeof o===u?o.apply(t):o))+',\n        <label for="modal-import" class="select-file-link">select a file</label>\n        <span class="display-empty">or paste the key content here.</span>\n        <span class="display-filled" style="display:none;">or paste the key content again to update.</span>\n        <input type="file" id="modal-import">\n    </p>\n    <p class="key-content"></p>\n</div>\n\n\n\n',s},n.upload=e.template(t),n}),function(){define("kp_upload",["./component/kp/kpDialogTpl","backbone","jquery"],function(e,t,n){return t.View.extend({__data:null,events:{"paste .upload-kp-component":"onPaste","change .upload-kp-component":"hanldeFile","drop .upload-kp-component":"hanldeFile","dragenter .upload-kp-component":"addDragoverClass","dragleave .upload-kp-component":"removeDragoverClass","dragover .upload-kp-component":"dragoverHandler"},removeDragoverClass:function(e){return n(e.currentTarget).removeClass("dragover")},addDragoverClass:function(e){return n(e.currentTarget).addClass("dragover")},dragoverHandler:function(e){var t;return t=e.originalEvent.dataTransfer,t&&(t.dropEffect="copy"),e.stopPropagation(),e.preventDefault(),null},save:function(e){if(!e)return;return this.__data=e,this.$(".drop-zone").addClass("filled"),this.$(".key-content").text(e),this.trigger("load",e)},onPaste:function(e){var t;return t=e.originalEvent.clipboardData.getData("text/plain"),this.save(t)},hanldeFile:function(e){var t;e.stopPropagation(),e.preventDefault(),this.$(".drop-zone").removeClass("dragover"),this.$("#import-json-error").html(""),e=e.originalEvent,t=(e.dataTransfer||e.target).files;if(!t||!t.length)return;return this.__reader.readAsText(t[0]),null},initialize:function(e){var t,n;return n=this,n.type=e&&e.type||"public key",t=this.__reader=new FileReader,t.onload=function(e){return n.save(t.result),null},t.onerror=function(){return n.trigger("error"),null}},getData:function(){return this.__data},render:function(){var t;return t={type:this.type},this.$el.html(e.upload(t)),this}})})}.call(this),function(){define("component/kp/kpView",["./kpTpl","./kpDialogTpl","kp_upload","backbone","jquery","constant","component/exporter/JsonExporter","UI.notification"],function(e,t,n,r,i,s,o){var u,a;return u=o.download,a=r.View.extend({__needDownload:!1,__upload:null,__import:"",__mode:"normal",needDownload:function(){return arguments.length===1?(this.__needDownload=arguments[0],arguments[0]===!1&&this.$(".cancel").prop("disabled",!1)):this.__needDownload&&notification("warning","You must download the keypair."),this.__needDownload},initialize:function(){return this.model.on("change:keys",function(){return this.$(".scroll-content").length?this.renderKeys():this.render(!0)},this)},render:function(e){var n,r;return n=this.model.toJSON(),r=Design.instance().get("region"),n.regionName=s.REGION_SHORT_LABEL[r],this.$el.html(t.frame(n)),e||this.open(),this},renderKeys:function(){return this.$(".scroll-content tbody").html(t.keys(this.model.toJSON())),this},renderLoading:function(){return this.$(".content-wrap").html(t.loading),this},stopPropagation:function(e){var t;t=".sortable, #download-kp";if(!i(e.target).is(t))return e.stopPropagation()},open:function(){return modal(this.el),i("#modal-wrap").click(this.stopPropagation)},showErr:function(e){return this.$(".error").text(e).show()},hideErr:function(){return this.$(".error").hide()},events:{"click .modal-close":"close","change #kp-select-all":"checkAll","change .one-cb":"checkOne","click #download-kp":"downloadKp","click #kp-create":"renderCreate","click #kp-import":"renderImport","click #kp-delete":"renderDelete","click #kp-refresh":"refresh","click .do-action":"doAction","click .cancel":"cancel"},downloadKp:function(){return this.__downloadKp&&this.__downloadKp()},doAction:function(e){var t;return this.hideErr(),t=i(e.currentTarget).data("action"),this[t]&&this[t](this.validate(t))},validate:function(e){switch(e){case"create":return!this.$("#create-kp-name").parsley("validate");case"import":return!this.$("#import-kp-name").parsley("validate")}},switchAction:function(e){return e||(e="init"),this.$(".slidebox .action").each(function(){return i(this).hasClass(e)?i(this).show():i(this).hide()})},genDownload:function(e,t){return this.__downloadKp=function(){var n;return i("body").hasClass("safari")?n=null:n=new Blob([t]),n?(u(n,e),null):{data:"data://text/plain;,"+t,name:e}},this.__downloadKp},genDeleteFinish:function(e){var t,n,r,i;return r=[],t=[],i=this,n=_.after(e,function(){return i.cancel(),r.length===1?notification("info",""+r[0].param[4]+" is deleted."):r.length>1&&notification("info","Selected "+r.length+" key pairs are deleted."),i.processDelBtn(),i.model.get("keys").length||(i.$("#kp-select-all").get(0).checked=!1),_.each(t,function(e){return void 0})}),function(e){return e.is_error?t.push(e):r.push(e),n()}},create:function(e){var t,n;n=this;if(!e)return t=this.$("#create-kp-name").val(),this.switchAction("processing"),this.model.create(t).then(function(e){return void 0,n.needDownload(!0),n.genDownload(""+e.keyName+".pem",e.keyMaterial),n.switchAction("download"),n.$(".before-create").hide(),n.$(".after-create").find("span").text(e.keyName).end().show()})["catch"](function(e){return void 0,n.showErr(e.error_message),n.switchAction()})},download:function(){return this.needDownload(!1),!0},"delete":function(e){var t,n,r,s;return t=this.$(".one-cb:checked"),n=t.length,r=this.genDeleteFinish(n),this.switchAction("processing"),s=this,t.each(function(){return s.model.remove(i(this).data("name")).then(r,r)})},"import":function(e){var t,n;n=this;if(!e)return t=this.$("#import-kp-name").val(),this.switchAction("processing"),this.model["import"](t,btoa(n.__upload.getData())).then(function(e){return void 0,notification("info",""+t+" is imported."),n.cancel()})["catch"](function(e){return void 0,n.showErr(e.error_message),n.switchAction("ready")})},cancel:function(){return this.preSlide()},refresh:function(){if(!this.needDownload())return this.model.getKeys(),this.renderLoading()},renderSlide:function(e){return this.$(".slidebox .content").html(e),this.hideErr(),this},preSlide:function(e){var t,n,r,i;return this.needDownload()?!1:(i=this,t=this.$(".content-wrap"),n=this.$(".slidebox"),r=t.hasClass("show-"+e),e==="delete"&&!r?this.$("input[type=checkbox]").prop("disabled",!0):this.$("input[type=checkbox]").prop("disabled",!1),r?(t.removeClass("show-create show-import show-delete"),n.removeClass("show"),i.$("#kp-"+e).removeClass("active")):(t.removeClass("show-create show-import show-delete"),_.each(["create","delete","import"],function(t){return t===e?i.$("#kp-"+t).addClass("active"):i.$("#kp-"+t).removeClass("active")}),e?(t.addClass("show-"+e),n.addClass("show")):n.removeClass("show")),!r)},renderCreate:function(){var e,n,r;if(this.preSlide("create"))return r=t.slideCreate,e={},n=r(e),this.renderSlide(n)},renderDelete:function(){var e,n,r,i,s;e=this.$(".one-cb:checked"),n=e.length;if(!n)return;if(this.preSlide("delete"))return s=t.slideDelete,r={},n===1?r.selecteKeyName=e.data("name"):r.selectedCount=n,i=s(r),this.renderSlide(i)},renderImport:function(){var e,r,i;if(this.preSlide("import"))return i=t.slideImport,e={},r=i(e),this.renderSlide(r),this.__upload&&this.__upload.remove(),this.__upload=new n,this.__upload.on("load",this.afterImport,this),this.$(".import-zone").html(this.__upload.render().el)},afterImport:function(e){return this.switchAction("ready")},checkOne:function(e){var t,n,r,s;t=i(e.currentTarget),this.processDelBtn(),n=this.$("#kp-select-all"),r=this.model.get("keys").length,s=this.$(".one-cb:checked").length,t.closest("tr").toggleClass("selected");if(s===r)return n.prop("checked",!0);if(r-s===1)return n.prop("checked",!1)},checkAll:function(e){return this.processDelBtn(),e.currentTarget.checked?(this.$('input[type="checkbox"]').prop("checked",!0),this.$("tr.item").addClass("selected")):(this.$('input[type="checkbox"]').prop("checked",!1),this.$("tr.item").removeClass("selected"))},processDelBtn:function(){var e;return e=this,_.defer(function(){return e.$("input:checked").length?e.$("#kp-delete").prop("disabled",!1):e.$("#kp-delete").prop("disabled",!0)})},close:function(e){return this.needDownload()?!1:(i("#modal-wrap").off("click",this.stopPropagation),modal.close(),this.remove(),!1)}}),r.View.extend({tagName:"section",events:{"click .keypair-filter":"returnFalse","click .manage-kp":"manageKp","click .show-credential":"showCredential","OPTION_SHOW .selectbox":"show","OPTION_CHANGE .selectbox":"setKey","keyup .keypair-filter":"filter"},showCredential:function(){return App.showSettings(App.showSettings.TAB.Credential)},filter:function(e){var t,n,r;return n=e.currentTarget.value,r=n.length,t=_.filter(this.model.get("keys"),function(e){return e.keyName.slice(0,r).toLowerCase()===n}),n?this.renderKeys(t):this.renderKeys()},setKey:function(e,t,n){var r;return this.__mode==="runtime"?(r=Design.modelClassForType(s.RESTYPE.KP),t==="@no"?r.setDefaultKP("",""):r.setDefaultKP(t,n.fingerprint)):t==="@default"?this.model.setKey("",!0):t==="@no"?this.model.setKey(""):this.model.setKey(t)},returnFalse:function(e){return!1},manageKp:function(e){return this.renderModal(),!1},initialize:function(e){this.model.on("change:keys",this.renderKeys,this),this.model.on("request:error",this.syncErrorHandler,this);if(!this.model.resModel)return this.__mode="runtime"},show:function(){if(!App.user.hasCredential())return this.renderNoCredential();if(!this.model.haveGot())return this.renderLoading(),this.model.getKeys()},render:function(){return this.renderFrame(),this},renderLoading:function(){return this.$("#kp-content").html(e.loading),this.toggleKpListControls(!1)},renderNoCredential:function(){return this.$("#kp-content").html(e.nocredential),this.toggleKpListControls(!1),this},toggleKpListControls:function(e){return this.$(".keypair-filter, .manage-kp").toggle(e)},syncErrorHandler:function(e){return void 0},renderKeys:function(t){return t&&arguments.length===1?t={keys:t,hideDefaultNoKey:!0}:t={keys:this.model.get("keys")},this.model.resModel&&(this.model.resModel.isNoKey()&&(t.noKey=!0),this.model.resModel.isDefaultKey()&&(t.defaultKey=!0)),t.isRunTime=this.__mode==="runtime",this.$("#kp-content").html(e.keys(t)),this.toggleKpListControls(!0),this.showManageBtn(),this},renderFrame:function(){var t;return t=this.model.toJSON(),t.keyName==="$DefaultKeyPair"?t.defaultKey=!0:t.keyName==="No Key Pair"&&(t.noKey=!0),t.isRunTime=this.__mode==="runtime",this.$el.html(e.frame(t))},renderModal:function(){return(new a({model:this.model})).render()},showManageBtn:function(){return this.$(".manage-kp").show()}})})}.call(this),function(){define("component/kp/kpModel",["constant","backbone","underscore","MC","keypair_service","Design"],function(e,t,n,r,i,s){var o,u,a,f,l,c;return f=function(e,t,n){var r,o,u,a;return a=$.cookie("usercode"),u=$.cookie("session_id"),o=s.instance().region(),r=[null,a,u,o],arguments.length>1&&r.push(t),arguments.length>2&&r.push(n),i[e].apply(null,r)},c=function(e){return function(e){if(e.is_error)throw e;return e.resolved_data||e}},o=function(e){return function(t){throw t=a(t),e.trigger("request:error",t),t}},a=function(e){var t;return t=e.error_message,e.error_message&&t.indexOf("Length exceeds maximum of 2048")!==-1&&(t="Length exceeds maximum of 2048"),e.error_message=t,e},l=function(e,t){return n.each(e,function(e){if(e.keyName===t)return e.selected=!0}),e},u=function(e){return n.reject(e,function(e){return e.keyName[0]==="@"})},t.Model.extend({defaults:{keys:[],deleting:null,creating:null,keyName:"",defaultKey:null},__haveGot:!1,initialize:function(e){this.resModel=e.resModel;if(this.resModel)return this.set("keyName",this.resModel.getKeyName())},haveGot:function(){return arguments.length===1&&(this.__haveGot=arguments[0]),this.__haveGot},setKey:function(e,t){if(this.resModel)return this.resModel.setKey(e,t)},settle:function(e,t){var r;if(arguments.length===1)return this.trigger("change:"+e);r=this.get("keys"),this.set(e,t);if(n.isEqual(r,t))return this.trigger("change:"+e)},getKeys:function(){var e;return e=this,this.haveGot(!0),this.list().then(function(t){var r,i;return void 0,e.resModel&&(r=e.resModel.getKeyName()),n.isArray(t)?(i=u(t),i=l(i,r)):i=t.resolved_data,e.settle("keys",i||[])},function(t){return e.settle("keys",[])})},list:function(){return f("DescribeKeyPairs",null,null).then(c(this)).fail(o(this))},"import":function(e,t){var n;return n=this,f("ImportKeyPair",e,t).then(c(this)).fail(o(this)).then(function(e){var t;return t=n.get("keys"),t.unshift(e),n.settle("keys"),e})},create:function(e){var t;return t=this,f("CreateKeyPair",e).then(c(this)).fail(o(this)).then(function(e){var n;return n=t.get("keys"),n.unshift(e),t.settle("keys"),e})},remove:function(e){var t;return t=this,f("DeleteKeyPair",e).then(c(this)).fail(o(this)).then(function(e){var r,i;return i=t.get("keys"),r=e.param[4],t.set("keys",n.reject(i,function(e){return e.keyName===r})),e})},download:function(e){return f("download",e).then(function(e){return void 0},function(e){return void 0})}})})}.call(this),function(){define("kp",["./component/kp/kpView","./component/kp/kpModel","constant"],function(e,t,n){var r,i,s;return i=function(n){var r,i;return r=new t({resModel:n}),i=new e({model:r}),i.render()},s=function(){return view.remove(),model.destroy()},r=function(){var e;return e=!1,Design.instance().eachComponent(function(t){var r;if((r=t.type)===n.RESTYPE.INSTANCE||r===n.RESTYPE.LC)if(t.isDefaultKey()&&!t.get("appId"))return e=!0,!1}),e},{load:i,unload:s,hasResourceWithDefaultKp:r}})}.call(this);