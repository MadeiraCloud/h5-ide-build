(function(){define("component/trustedadvisor/config",{validDebug:"",syncTimeout:1e4,componentTypeToFileMap:{"AWS.AutoScaling.Group":["asg"],"AWS.EC2.SecurityGroup":["sg"],"AWS.VPC.VPNGateway":["vgw"],"AWS.VPC.VPNConnection":["vpn"],"AWS.VPC.CustomerGateway":["cgw"],"AWS.VPC.InternetGateway":["igw"],"AWS.EC2.Instance":["instance","state"],"AWS.ELB":["elb"],"AWS.VPC.NetworkInterface":["eni"],"AWS.VPC.NetworkAcl":["acl"],"AWS.AutoScaling.LaunchConfiguration":["state"],"AWS.VPC.RouteTable":["rtb"],"AWS.EC2.EBS.Volume":["ebs"],"AWS.EC2.KeyPair":["kp"]},globalList:{eip:["isHasIGW"],az:["isAZAlone"],sg:["isStackUsingOnlyOneSG","isAssociatedSGNumExceedLimit"],vpc:["isVPCAbleConnectToOutside"],stack:["~isHaveNotExistAMI"],kp:["longLiveNotice"]},asyncList:{cgw:["isCGWHaveIPConflict"],stack:["verify","isHaveNotExistAMIAsync"],subnet:["getAllAWSENIForAppEditAndDefaultVPC"],ebs:["isSnapshotExist"],kp:["isKeyPairExistInAws"],elb:["isSSLCertExist"],asg:["isTopicNonexist"],vpc:["isVPCUsingNonexistentDhcp"]}})}).call(this),function(){define("component/trustedadvisor/validation/result_vo",["event","MC","Design","underscore"],function(e,t,n){var r,i,s,o,u,a,f,l,c,h;return c=function(e){var t;return t=0,e.length===0?t:(_.each(e,function(n,r){var i;return i=e.charCodeAt(r),t=(t<<5)-t+i,t&=t,null}),"k"+t)},f=function(e,t){return c(""+e+"|"+t)},l=function(e,t,n){return n=n||t&&t.uid||null,_.extend({},t,{key:f(e,n),type:e})},u=function(n){var r;return r={},_.map(t.ta.list,function(e){return e.key===n&&(r=e),null}),r&&(t.ta.list=_.without(t.ta.list,r),r.level&&e.trigger(e.UPDATE_TA_MODAL,"delete",r.level)),null},o=function(n){return t.ta.list.push(n),e.trigger(e.UPDATE_TA_MODAL,"add",n.level)},h=function(e){return t.ta.list=_.map(t.ta.list,function(t){return t.key===e.key?e:t}),t.ta.list},a=function(e){return _.contains(_.pluck(t.ta.list,"key"),e)},s=function(e,n,r){var i,f;return f=l(e,n,r),i=f.key,_.isArray(n)?_.each(n,function(t){if(t)return s(e,t,t.uid)}):n?a(i)?h(f):o(f):u(i),t.ta.list},r=function(){return t.ta.list=[],t.canvas_data=n.instance().serialize(),null},i=function(){return t.ta.list},{set:s,reset:r,result:i}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("component/trustedadvisor/validation/stack/stack",["constant","jquery","MC","i18n!/nls/lang.js","ApiRequest","stack_service","ami_service","CloudResources","../result_vo"],function(t,n,r,i,s,o,u,a){var f,l,c,h,p,d;return f=function(t){var n,i,s;return i=r.canvas_data.component[t],s=i.resource.Instances,n=[],_.each(s,function(t){var i,s,o;return s=t.InstanceId,o=r.extractID(s),i=r.canvas_data.component[o].resource.Placement.AvailabilityZone,e.call(n,i)>=0||n.push(i),null}),n},p=function(e){var t,n;return t="",n=r.canvas_data.component[e],n&&n.name&&(t=n.name),t},d=function(e){var t,n;return n="",t=r.canvas_data.component[e],t&&t.type&&(n=t.type),n},h=function(e){var o,u,a;try{return e||(e=function(){}),a=r.canvas_data,s("stack_verify",{username:n.cookie("usercode"),session_id:n.cookie("session_id"),spec:a}).then(function(n){var r,s,o,u,a,f,l,c,h,v,m,g;r=!0,v=null,l="";if(n!==!0){r=!1;try{v=n,m=JSON.parse(v),f=m.uid,o=m.code,c=m.key,h=m.message,u=p(f),a=d(f),l=sprintf(i.ide.TA_MSG_ERROR_STACK_FORMAT_VALID_FAILED,u,h),o==="EMPTY_VALUE"&&c==="InstanceId"&&h==="Key InstanceId can not empty"&&a==="AWS.VPC.NetworkInterface"&&(r=!0),o==="EMPTY_VALUE"&&c==="LaunchConfigurationName"&&h==="Key LaunchConfigurationName can not empty"&&a==="AWS.AutoScaling.Group"&&(r=!0),o==="EMPTY_VALUE"&&c==="TopicARN"&&h==="Key TopicARN can not empty"&&a==="AWS.AutoScaling.NotificationConfiguration"&&(r=!0)}catch(y){s=y,l="Stack format validation error"}}else e(null);return r?e(null):(g={level:t.TA.ERROR,info:l},e(g),void 0)},function(t){return e(null)}),u=sprintf(i.ide.TA_MSG_ERROR_STACK_CHECKING_FORMAT_VALID),{level:t.TA.ERROR,info:u}}catch(f){return o=f,e(null)}},c=function(s){var o,a,f,l,c;try{return s||(s=function(){}),f=r.canvas.getState(),o=[],c={},_.each(r.canvas_data.component,function(e){var n,r;if(e.type===t.RESTYPE.INSTANCE||e.type===t.RESTYPE.LC)n=e.resource.ImageId,r="",e.type===t.RESTYPE.INSTANCE?r=e.resource.InstanceId:e.type===t.RESTYPE.LC&&(r=e.resource.LaunchConfigurationARN),n&&!r&&(c[n]||(c[n]=[],o.push(n)),c[n].push(e.uid));return null}),o.length?(a=r.canvas_data.region,u.DescribeImages({sender:this},n.cookie("usercode"),n.cookie("session_id"),a,o,null,null,null,function(u){var a,f,l,h,p;p=[];if(u.is_error&&u.aws_error_code==="InvalidAMIID.NotFound"){f=u.error_message,f=f.replace("The image ids '[","").replace("]' do not exist","").replace("The image id '[","").replace("]' does not exist",""),a=f.split(","),a=_.map(a,function(e){return n.trim(e)});if(!a.length)return s(null),null;_.each(o,function(n){var s;return e.call(a,n)>=0&&(s=c[n],_.each(s,function(e){var s,o,u,a,f,l;return a=r.canvas_data.component[e],f=a.type,u=a.name,s="Instance",o="instance",f===t.RESTYPE.LC&&(s="Launch Configuration",o="lc"),l=sprintf(i.ide.TA_MSG_ERROR_STACK_HAVE_NOT_EXIST_AMI,s,o,u,n),p.push({level:t.TA.ERROR,info:l,uid:e}),null})),null})}else u.is_error||(h=[],l=u.resolved_data,_.isArray(l)&&_.each(l,function(e){return h.push(e.imageId),null}),_.each(o,function(n){var s;return e.call(h,n)<0&&(s=c[n],_.each(s,function(e){var s,o,u,a,f,l;return a=r.canvas_data.component[e],f=a.type,u=a.name,s="Instance",o="instance",f===t.RESTYPE.LC&&(s="Launch Configuration",o="lc"),l=sprintf(i.ide.TA_MSG_ERROR_STACK_HAVE_NOT_AUTHED_AMI,s,o,u,n),p.push({level:t.TA.ERROR,info:l,uid:e}),null})),null}));return p.length?(s(p),void 0):s(null)}),null):s(null)}catch(h){return l=h,s(null)}},l=function(){var e,n,s,o;return e=[],s={},_.each(r.canvas_data.component,function(n){var r,i;if(n.type===t.RESTYPE.INSTANCE||n.type===t.RESTYPE.LC)r=n.resource.ImageId,i="",n.type===t.RESTYPE.INSTANCE?i=n.resource.InstanceId:n.type===t.RESTYPE.LC&&(i=n.resource.LaunchConfigurationARN),r&&!i&&(s[r]||(s[r]=[],e.push(r)),s[r].push(n.uid));return null}),o=[],n=a(t.RESTYPE.AMI,r.canvas_data.region),_.each(e,function(e){var u;return n.get(e)||(u=s[e],_.each(u,function(n){var s,u,a,f,l,c;return f=r.canvas_data.component[n],l=f.type,a=f.name,s="Instance",u="instance",l===t.RESTYPE.LC&&(s="Launch Configuration",u="lc"),c=sprintf(i.ide.TA_MSG_ERROR_STACK_HAVE_NOT_EXIST_AMI,s,u,a,e),o.push({level:t.TA.ERROR,info:c,uid:n}),null})),null}),o},{isHaveNotExistAMIAsync:c,isHaveNotExistAMI:l,verify:h}})}.call(this),function(){define("component/trustedadvisor/helper",["constant","MC","i18n!/nls/lang.js","Design","underscore"],function(e,t,n,r,i){var s,o;return o={taReturn:function(t,n,r){var i;return i={level:e.TA[t],info:n},r&&(i.uid=r),i},genTip:function(e){var t;return e.length>2?t=Function.call.apply(sprintf,e):t=e[1],t}},s={map:{protocal:{1:"icmp",6:"tcp",17:"udp","-1":"all"}},protocal:{get:function(e){return s.map.protocal[e.toString()]||e}},i18n:{"short":function(){return n.ide}},component:{get:function(e,n){return n?r.instance().component(e):t.canvas_data.component[e]}},message:{error:function(t,n){return n=o.genTip(arguments),o.taReturn(e.TA.ERROR,n,t)},warning:function(t,n){return n=o.genTip(arguments),o.taReturn(e.TA.WARNING,n,t)},notice:function(t,n){return n=o.genTip(arguments),o.taReturn(e.TA.NOTICE,n,t)}},eni:{getByInstance:function(n){return i.filter(t.canvas_data.component,function(r){if(r.type===e.RESTYPE.ENI&&t.extractID(r.resource.Attachment.InstanceId)===n.uid)return!0})}},sg:{get:function(n){var r,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;f=[];if(n.type===e.RESTYPE.LC){y=n.resource.SecurityGroups;for(l=0,d=y.length;l<d;l++)a=y[l],f.push(s.component.get(t.extractID(a)))}else if(n.type===e.RESTYPE.INSTANCE){o=s.eni.getByInstance(n);for(c=0,v=o.length;c<v;c++){r=o[c],b=r.resource.GroupSet;for(h=0,m=b.length;h<m;h++)u=b[h],f.push(s.component.get(t.extractID(u.GroupId)))}}else if(n.type===e.RESTYPE.ELB){w=n.resource.SecurityGroups;for(p=0,g=w.length;p<g;p++)a=w[p],f.push(s.component.get(t.extractID(a)))}return i.uniq(i.compact(f))},port:function(t){var n,r,o,u,a,f,l,c,h,p,d,v;r={"in":{},out:{}},i.isArray(t)||(t=[t]),n=function(e,t){var n,o;n=s.protocal.get(e.IpProtocol),r[t][n]||(r[t][n]=[]),o={from:Number(e.FromPort),to:Number(e.ToPort),range:e.IpRanges};if(i.where(r[t][n],o).length===0)return r[t][n].push(o)};for(a=0,c=t.length;a<c;a++){u=t[a];if(u.type!==e.RESTYPE.SG)continue;d=u.resource.IpPermissionsEgress;for(f=0,h=d.length;f<h;f++)o=d[f],n(o,"out");v=u.resource.IpPermissions;for(l=0,p=v.length;l<p;l++)o=v[l],n(o,"in")}return r},isInRange:function(e,t,n,r){var o,u,a;return o=!1,a=s.protocal.get(e.toLowerCase()),u=Number(t),i.each(n[r],function(e,t){return(t===a||t==="all")&&i.each(e,function(e){return u>=e.from&&u<=e.to&&(o=!0),null}),null}),o}}},s})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("component/trustedadvisor/validation/ec2/instance",["constant","MC","Design","../../helper"],function(t,n,r,i){var s,o,u,a,f,l;return s=i.i18n.short(),a=function(e){var r,i,o,u,a,f,l,c,h,p;return o=n.canvas_data.component[e],a=o.type,l=a===t.RESTYPE.INSTANCE,i=!1,f=c=r=null,o?f=n.genResRef(e,"resource.InstanceId"):(c=o.resource.LaunchConfigurationName,r=o.resource.ImageId),_.each(n.canvas_data.component,function(e){return e.type===t.RESTYPE.VOL&&e.resource.VolumeType!=="standard"&&(l&&e.resource.AttachmentSet.InstanceId===f?i=!0:!l&&e.resource.ImageId===r&&e.resource.LaunchConfigurationName===c&&(i=!0)),null}),!i||(p=o.resource.EbsOptimized)!=="false"&&p!==!1&&p!==""?null:(u=o.name,h=sprintf(s.TA_MSG_NOTICE_INSTANCE_NOT_EBS_OPTIMIZED_FOR_ATTACHED_PROVISIONED_VOLUME,u),{level:t.TA.NOTICE,info:h,uid:e})},l=function(e){var t,r,i,s;return t=n.canvas_data.component[e],r=t.resource.IpPermissions,i=t.resource.IpPermissionsEgress,s=0,r&&(s+=r.length),i&&(s+=i.length),s},o=function(r){var i,o,u,a,f,c,h,p;i=n.canvas_data.component[r],a=i.type,f=a===t.RESTYPE.INSTANCE,c=[];if(f){_.each(n.canvas_data.component,function(i){var s,o,u;return i.type===t.RESTYPE.ENI&&(s=i.resource.Attachment.InstanceId,o=n.extractID(s),o===r&&(u=i.resource.GroupSet,_.each(u,function(t){var r,i;return i=t.GroupId,r=n.extractID(i),e.call(c,r)>=0||c.push(r),null}))),null}),p=0,_.each(c,function(e){return p+=l(e),null});if(p>50)return o=i.name,h=sprintf(s.TA_MSG_WARNING_INSTANCE_SG_RULE_EXCEED_FIT_NUM,o,50),{level:t.TA.WARNING,info:h,uid:r}}else{c=[],f?u=i.resource.SecurityGroup:u=i.resource.SecurityGroups,_.each(u,function(t){var r;return r=n.extractID(t),e.call(c,r)>=0||c.push(r),null}),p=0,_.each(c,function(e){return p+=l(e),null});if(p>100)return o=i.name,h=sprintf(s.TA_MSG_WARNING_INSTANCE_SG_RULE_EXCEED_FIT_NUM,o,100),{level:t.TA.WARNING,info:h,uid:r}}return null},u=function(e){var r,i,o,u,a,f,l;return i=n.canvas_data.component,u=i[e],a=n.genResRef(e,"resource.InstanceId"),r="",f=_.some(i,function(e){if(e.type===t.RESTYPE.RT)return _.some(e.resource.RouteSet,function(t){if(t.InstanceId===a)return r=e,!0})}),o=_.some(i,function(e){if(e.type===t.RESTYPE.EIP&&e.resource.InstanceId===a)return!0}),!f||o?null:(l=sprintf(s.TA_MSG_NOTICE_INSTANCE_HAS_RTB_NO_ELB,r.name,u.name,u.name),{level:t.TA.NOTICE,info:l,uid:e})},f=function(e){var t,n,o,u;u=r.instance().component(e);if(!u)return null;t=u.connectionTargets("RTB_Route");if(t&&t.length){n=u.connectionTargets("EniAttachment"),n.push(u.getEmbedEni()),o=_.some(n,function(e){return!e.get("sourceDestCheck")});if(!o)return i.message.error(e,s.TA_MSG_ERROR_INSTANCE_NAT_CHECKED_SOURCE_DEST,u.get("name"));null}return null},{isEBSOptimizedForAttachedProvisionedVolume:a,isAssociatedSGRuleExceedFitNum:o,isConnectRoutTableButNoEIP:u,isNatCheckedSourceDest:f}})}.call(this),function(){define("component/trustedadvisor/validation/vpc/subnet",["constant","jquery","MC","i18n!/nls/lang.js"],function(e,t,n,r){return{getAllAWSENIForAppEditAndDefaultVPC:function(e){return e(null)}}})}.call(this),function(){define("component/trustedadvisor/validation/vpc/vpc",["constant","MC","i18n!/nls/lang.js","Design","CloudResources","../../helper","../result_vo"],function(e,t,n,r,i,s){var o,u,a,f,l;return o=s.i18n.short(),l=function(e){var t,n,i;return r.instance().get("agent").enabled===!1?!1:e?(t=r.instance().component(e),t?(i=t.get("state"),i&&i.length):!1):(n=!1,r.instance().eachComponent(function(e){if(l(e.id))return n=!0,!1}),n)},u=function(){var r,i,s,o;return s=!1,r=!1,i=!1,_.each(t.canvas_data.component,function(t){var n;return n=t.type,n===e.RESTYPE.VPN&&(s=!0),n===e.RESTYPE.EIP&&(r=!0),n===e.RESTYPE.ENI&&t.index===0&&t.resource.AssociatePublicIpAddress&&(i=!0),n===e.RESTYPE.LC&&t.resource.AssociatePublicIpAddress&&(i=!0),null}),s||r||i?null:(o=sprintf(n.ide.TA_MSG_WARNING_NOT_VPC_CAN_CONNECT_OUTSIDE),{level:e.TA.WARNING,info:o})},a=function(t){var n,i;return l()?(i=r.modelClassForType(e.RESTYPE.VPC).theVPC(),n=i.get("dhcp").get("appId"),n!=="default"?null:s.message.warning(i.id,o.TA_MSG_WARNING_VPC_CANNOT_USE_DEFAULT_DHCP_WHEN_USE_VISUALOPS)):null},f=function(t){var n,u,a;a=r.modelClassForType(e.RESTYPE.VPC).theVPC(),u=a.get("dhcp").get("appId");if(!u||u==="default"){t(null);return}return n=i(e.RESTYPE.DHCP,r.instance().region()),n.fetchForce().fin(function(){return n.get(u)?t(null):t(s.message.error(a.id,o.TA_MSG_ERROR_VPC_DHCP_NONEXISTENT))}),null},{isVPCAbleConnectToOutside:u,isVPCUsingNonexistentDhcp:f,isVPCUsingNoneDHCPAndVisualops:a}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("component/trustedadvisor/validation/elb/elb",["constant","MC","i18n!/nls/lang.js","../../helper","CloudResources"],function(t,n,r,i,s){var o,u,a,f,l,c,h,p,d,v,m,g;return a=function(e){var i,s,o,u,a;return i=n.canvas_data.component[e],u=i.resource.Scheme==="internet-facing",o=!1,_.each(n.canvas_data.component,function(e){var n;return n=e.type,n===t.RESTYPE.IGW&&(o=!0),null}),!u||!!o?null:(s=i.name,a=sprintf(r.ide.TA_MSG_ERROR_VPC_HAVE_INTERNET_ELB_AND_NO_HAVE_IGW,s),{level:t.TA.ERROR,info:a,uid:e})},f=function(i){var s,o,u,a,f,l;return u=n.canvas_data.component[i],o=u.resource.Instances.length,s=0,f=n.genResRef(i,"resource.LoadBalancerName"),_.each(n.canvas_data.component,function(n){var r,i;return i=n.type,i===t.RESTYPE.ASG&&(r=n.resource.LoadBalancerNames,e.call(r,f)>=0&&s++),null}),o!==0||s!==0?null:(a=u.name,l=sprintf(r.ide.TA_MSG_ERROR_ELB_NO_ATTACH_INSTANCE_OR_ASG,a),{level:t.TA.ERROR,info:l,uid:i})},o=function(e){var i,s,o,u;return s=n.canvas_data.component[e],i=s.resource.AvailabilityZones,i.length!==1?null:(o=s.name,u=sprintf(r.ide.TA_MSG_WARNING_ELB_NO_ATTACH_TO_MULTI_AZ,o),{level:t.TA.WARNING,info:u,uid:e})},h=function(e){var i,s,o,u,a;return i=n.canvas_data.component[e],o=!1,u=i.resource.ListenerDescriptions,_.each(u,function(e){var t,n,r;return r=e.Listener,t=r.LoadBalancerPort,n=r.InstancePort,(t===443||t==="443")&&(n===443||n==="443")&&(o=!0),null}),o?(s=i.name,a=sprintf(r.ide.TA_MSG_NOTICE_ELB_REDIRECT_PORT_443_TO_443,s),{level:t.TA.NOTICE,info:a,uid:e}):null},l=function(e){var i,s,o,u,a,f;return i=n.canvas_data.component[e],u=i.resource.ListenerDescriptions,a={},o=!1,_.each(u,function(e){var t,n;return n=e.Listener,t=n.LoadBalancerPort,a[t]?o=!0:a[String(t)]=!0,null}),o?(s=i.name,f=sprintf(r.ide.TA_MSG_ERROR_ELB_HAVE_REPEAT_LISTENER_ITEM,s),{level:t.TA.ERROR,info:f,uid:e}):null},c=function(e){var i,s,o,u,a;return i=n.canvas_data.component[e],u=i.resource.ListenerDescriptions,o=!0,_.each(u,function(e){var t,n;n=e.Listener,t=n.Protocol;if(t==="HTTPS"||t==="SSL")n.SSLCertificateId||(o=!1);return null}),o?null:(s=i.name,a=sprintf(r.ide.TA_MSG_ERROR_ELB_HAVE_NO_SSL_CERT,s),{level:t.TA.ERROR,info:a,uid:e})},d=function(e){var s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;s=n.canvas_data.component[e],o=s.name,m=i.sg.get(s),p=i.sg.port(m),l=s.resource.ListenerDescriptions,d=!0,v=[];for(y=0,b=l.length;y<b;y++)c=l[y],h=c.Listener,a=h.Protocol,u=h.LoadBalancerPort,f=i.sg.isInRange("tcp",u,p,"in"),f||(d=!1,v.push(a+' <span class="validation-tag tag-port">'+u+"</span>"));return d?null:(o=s.name,g=sprintf(r.ide.TA_MSG_ERROR_ELB_RULE_NOT_INBOUND_TO_ELB_LISTENER,o,v.join(", ")),{level:t.TA.WARNING,info:g,uid:e})},m=function(e){var s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;s=n.canvas_data.component[e],m=i.sg.get(s),p=i.sg.port(m),l=s.resource.ListenerDescriptions,d=!0,v=[];for(y=0,b=l.length;y<b;y++)c=l[y],h=c.Listener,a=h.InstanceProtocol,u=h.InstancePort,f=i.sg.isInRange("tcp",u,p,"out"),f||(d=!1,v.push(a+' <span class="validation-tag tag-port">'+u+"</span>"));return d?null:(o=s.name,g=sprintf(r.ide.TA_MSG_ERROR_ELB_RULE_NOT_OUTBOUND_TO_INSTANCE_LISTENER,o,v.join(", ")),{level:t.TA.WARNING,info:g,uid:e})},p=function(e){var s,o,u,a,f,l;return o=n.canvas_data.component[e],u=o.name,a=o.resource.Instances,f=o.resource.ListenerDescriptions,l=[],_.each(a,function(s){var o,a,c,h,p,d,v,m,g,y,b,w,E,S,x,T;h=n.extractID(s.InstanceId);if(h){y=[],o=n.canvas_data.component[h];if(o.index!==0)return;b=i.sg.get(o),m=i.sg.port(b);for(x=0,T=f.length;x<T;x++)d=f[x],v=d.Listener,c=v.InstanceProtocol,a=v.InstancePort,p=i.sg.isInRange("tcp",a,m,"in"),p||y.push(c+' <span class="validation-tag tag-port">'+a+"</span>");if(y.length)return E="Instance",w=o.serverGroupName,g=y.join(", "),S=sprintf(r.ide.TA_MSG_ERROR_ELB_RULE_INSTANCE_NOT_OUTBOUND_FOR_ELB_LISTENER,E,w,g,u),l.push({level:t.TA.WARNING,info:S,uid:e})}}),s=[],_.each(n.canvas_data.component,function(r){var i;return r.type===t.RESTYPE.ASG&&(i=r.resource.LoadBalancerNames,_.each(i,function(t){var i;return i=n.extractID(t),e===i&&s.push(r.uid),null})),null}),_.each(s,function(s){var o,a,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C;w=[],o=n.canvas_data.component[s],d=o.resource.LaunchConfigurationName;if(!d)return;v=n.extractID(d),p=n.canvas_data.component[v],E=i.sg.get(p),y=i.sg.port(E);for(N=0,C=f.length;N<C;N++)m=f[N],g=m.Listener,c=g.InstanceProtocol,a=g.InstancePort,h=i.sg.isInRange("tcp",a,y,"in"),h||w.push(c+' <span class="validation-tag tag-port">'+a+"</span>");if(w.length)return x="Launch Configuration",S=p.name,b=w.join(", "),T=sprintf(r.ide.TA_MSG_ERROR_ELB_RULE_INSTANCE_NOT_OUTBOUND_FOR_ELB_LISTENER,x,S,b,u),l.push({level:t.TA.WARNING,info:T,uid:e})}),l},v=function(e){var s,o,u,a,f,l,c,h;s=n.canvas_data.component[e],o=s.name,c=i.sg.get(s),l=i.sg.port(c),f=null;try{f=s.resource.HealthCheck.Target,f=f.split(":")[1],f=f.split("/")[0]}catch(p){return u=p,null}return a=i.sg.isInRange("tcp",f,l,"in"),a?null:(o=s.name,h=sprintf(r.ide.TA_MSG_WARNING_ELB_RULE_NOT_INBOUND_TO_ELB_PING_PORT,o,f),{level:t.TA.WARNING,info:h,uid:e})},u=function(e){var i,s,o,u;return i=n.canvas_data.component[e],o=i.resource.Subnets,s=i.name,u=[],_.each(o,function(e){var i,o,a,f,l,c;return f=n.extractID(e),o=n.canvas_data.component[f],o&&(a=o.name,f=o.uid,i=o.resource.CidrBlock,l=Number(i.split("/")[1]),l>27&&(c=sprintf(r.ide.TA_MSG_ERROR_ELB_ATTACHED_SUBNET_CIDR_SUFFIX_GREATE_27,s,a),u.push({level:t.TA.ERROR,info:c,uid:f}))),null}),u},g=function(i){var o,u,a,f,l,c,h;try{return i||(i=function(){}),a={},u=function(e){return _.each(n.canvas_data.component,function(r){var i,s,o,u,f,l,c,h,p,d;if(r.type===t.RESTYPE.ELB){i=r.name,a[i]=r.uid,s=r.resource.ListenerDescriptions;for(p=0,d=s.length;p<d;p++){f=s[p],l=f.Listener,o=l.SSLCertificateId;if(!o)continue;u=n.extractID(o),c=n.canvas_data.component[u],c&&(h=c.name,e(i,h))}}return null})},f={},o=[],h=[],c=!1,u(function(){return c=!0}),c?(window.sslCertCol||(window.sslCertCol=s(t.RESTYPE.IAM)),window.sslCertCol.fetchForce().then(function(n){var s;s=window.sslCertCol.toJSON(),_.each(s,function(e){return o.push(e.Name)}),u(function(t,n){if(e.call(o,n)<0)return f[t]||(f[t]=[]),f[t].push(n)}),_.each(f,function(e,n){var i,s;return s=_.uniq(e),i=sprintf(r.ide.TA_MSG_ERROR_ELB_SSL_CERT_NOT_EXIST_FROM_AWS,n,s.join(", ")),h.push({level:t.TA.ERROR,info:i,uid:a[n]})});if(h.length){i(h);return}return i(null)},function(){return i(null)})):i(null)}catch(p){return l=p,i(null)}},{isHaveIGWForInternetELB:a,isHaveInstanceAttached:f,isAttachELBToMultiAZ:o,isRedirectPortHttpsToHttp:h,isHaveRepeatListener:l,isHaveSSLCert:c,isRuleInboundToELBListener:d,isRuleOutboundToInstanceListener:m,isRuleInboundInstanceForELBListener:p,isRuleInboundToELBPingPort:v,isELBSubnetCIDREnough:u,isSSLCertExist:g}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("component/trustedadvisor/validation/ec2/securitygroup",["constant","MC","i18n!/nls/lang.js"],function(t,n,r){var i,s,o,u,a,f,l,c,h;return i=function(t){var r,i,s;return i=0,s=[],r=[],_.each(n.canvas_data.component,function(i){var o,u;o=i.type;if(o==="AWS.ELB"||o==="AWS.AutoScaling.LaunchConfiguration")s=i.resource.SecurityGroups,s=_.map(s,function(e){var t;return t=n.extractID(e),t}),e.call(s,t)>=0&&r.push(i);return o==="AWS.EC2.Instance"&&(s=i.resource.SecurityGroupId,s=_.map(s,function(e){var t;return t=n.extractID(e),t}),e.call(s,t)>=0&&r.push(i)),o==="AWS.VPC.NetworkInterface"&&(u=[],_.each(i.resource.GroupSet,function(e){return u.push(e.GroupId),null}),s=u,s=_.map(s,function(e){var t;return t=n.extractID(e),t}),e.call(s,t)>=0&&r.push(i)),null}),r},o=function(e){var t;return t=n.canvas_data.component[e],t&&t.name.indexOf("elbsg-")===0},c=function(e){var i,s,o,u,a,f;return i=n.canvas_data.component[e],s=i.resource.IpPermissions,u=i.resource.IpPermissionsEgress,a=0,s&&(a+=s.length),u&&(a+=u.length),a>50?(o=i.name,f=sprintf(r.ide.TA_MSG_WARNING_SG_RULE_EXCEED_FIT_NUM,o,50),{level:t.TA.WARNING,info:f,uid:e}):null},h=function(){var e,s;return e=0,_.each(n.canvas_data.component,function(n){var r,s;return n.type===t.RESTYPE.SG&&(s=n.uid,r=i(s),r.length>0&&e++),null}),e===1?(s=sprintf(r.ide.TA_MSG_NOTICE_STACK_USING_ONLY_ONE_SG),{level:t.TA.NOTICE,info:s}):null},f=function(e){var s,u,a,f,l,c,h;return s=i(e),s.length===0?null:o(e)?null:(a=n.canvas_data.component[e],f=a.resource.IpPermissions,c=a.resource.IpPermissionsEgress,u=!1,_.each(f,function(e){var t;t=e.IpProtocol;if(t==="-1"||t===-1)u=!0;return null}),u||_.each(c,function(e){var t;t=e.IpProtocol;if(t==="-1"||t===-1)u=!0;return null}),u?(l=a.name,h=sprintf(r.ide.TA_MSG_WARNING_SG_USING_ALL_PROTOCOL_RULE,l),{level:t.TA.WARNING,info:h,uid:e}):null)},a=function(s){var u,a,f,l,c,h,p,d;return u=i(s),u.length===0?null:o(s)?null:(f=n.canvas_data.component[s],l=f.resource.IpPermissions,a=!1,p=[80,"80"],d=[443,"443"],_.each(l,function(t){var n,r,i,s;return t.IpRanges==="0.0.0.0/0"&&((n=t.FromPort,e.call(p,n)>=0)&&(r=t.ToPort,e.call(p,r)>=0)||(i=t.FromPort,e.call(d,i)>=0)&&(s=t.ToPort,e.call(d,s)>=0)||(a=!0)),null}),a?(c=f.name,h=sprintf(r.ide.TA_MSG_WARNING_SG_RULE_FULL_ZERO_SOURCE_TARGET_TO_OTHER_PORT,c),{level:t.TA.WARNING,info:h,uid:s}):null)},l=function(s){var u,a,f,l,c,h,p,d;return u=i(s),u.length===0?null:o(s)?null:(f=n.canvas_data.component[s],l=f.resource.IpPermissions,h=f.resource.IpPermissionsEgress,a=!1,d=[22,"22"],_.each(l,function(t){var n,r;return(n=t.FromPort,e.call(d,n)>=0)&&(r=t.ToPort,e.call(d,r)>=0)&&(a=!0),null}),a?(c=f.name,p=sprintf(r.ide.TA_MSG_NOTICE_SG_RULE_USING_PORT_22,c),{level:t.TA.NOTICE,info:p,uid:s}):null)},u=function(e){var s,u,a,f,l,c;return s=i(e),s.length===0?null:o(e)?null:(a=n.canvas_data.component[e],l=a.resource.IpPermissionsEgress,u=!1,_.each(l,function(e){return e.IpRanges==="0.0.0.0/0"&&(u=!0),null}),u?(f=a.name,c=sprintf(r.ide.TA_MSG_WARNING_SG_RULE_HAVE_FULL_ZERO_OUTBOUND,f),{level:t.TA.WARNING,info:c,uid:e}):null)},s=function(){var e,i;return e=5,i=[],_.each(n.canvas_data.component,function(s){var o,u,a,f,l,c,h,p,d,v,m,g,y,b;u=s.type,o=s.name,a=s.uid,p=!1,v=[],d="",g="",u===t.RESTYPE.ELB&&(v=s.resource.SecurityGroups,d="Load Balancer",g="elb");if(u===t.RESTYPE.LC)v=s.resource.SecurityGroups,d="Launch Configuration",g="lc";else if(u===t.RESTYPE.INSTANCE)v=s.resource.SecurityGroupId,d="Instance",g="instance";else if(u===t.RESTYPE.ENI){_.each(s.resource.GroupSet,function(e){return v.push(e.GroupId),null}),d="Network Interface",g="eni";if((b=s.resource.Attachment.DeviceIndex)===0||b==="0")h=s.resource.Attachment.InstanceId,h&&(c=n.extractID(h),f=n.canvas_data.component[c],f&&(l=f.name,d="Instance",g="instance",o=l))}return v.length>e&&(y=sprintf(r.ide.TA_MSG_ERROR_RESOURCE_ASSOCIATED_SG_EXCEED_LIMIT,d,g,o,e),m={level:t.TA.ERROR,info:y,uid:a},i.push(m)),null}),i.length>0?i:null},{isSGRuleExceedFitNum:c,isStackUsingOnlyOneSG:h,isHaveUsingAllProtocolRule:f,isHaveFullZeroSourceToHTTPRule:a,isHaveUsingPort22Rule:l,isHaveFullZeroOutboundRule:u,isAssociatedSGNumExceedLimit:s}})}.call(this),function(){define("component/trustedadvisor/validation/asg/asg",["constant","MC","i18n!/nls/lang.js","../result_vo","../../helper","CloudResources"],function(e,t,n,r,i,s){var o,u,a,f,l,c;return o=i.i18n.short(),a=function(r){var i,s;return i=t.canvas_data.component[r],i.resource.LaunchConfigurationName?null:(s=sprintf(n.ide.TA_MSG_ERROR_ASG_HAS_NO_LAUNCH_CONFIG,i.name),{level:e.TA.ERROR,info:s,uid:r})},u=function(r){var i,s,o;return i=t.canvas_data.component[r],s=t.canvas_data.component[r].resource.LoadBalancerNames.length>0,!s||s&&i.resource.HealthCheckType==="ELB"?null:(o=sprintf(n.ide.TA_MSG_WARNING_ELB_HEALTH_NOT_CHECK,i.name),{level:e.TA.WARNING,info:o,uid:r})},f=function(e){var t,n,r;return t=Design.instance().component(e),n=t.getNotiObject(),!n||!n.isEffective()?null:(r=n.getTopic(),r&&r.get("appId")?null:i.message.error(e,o.TA_MSG_ERROR_ASG_NOTIFICATION_NO_TOPIC,t.get("name")))},l=function(e){var t,n,r,s,u,a;t=Design.instance().component(e),r=t.get("policies")||[],s=[];for(u=0,a=r.length;u<a;u++){n=r[u];if(!n.isNotificate()||n.getTopic())continue;s.push(i.message.error(n.id,o.TA_MSG_ERROR_ASG_POLICY_NO_TOPIC,t.get("name"),n.get("name")))}return s},c=function(t){var n,r,u,a,f,l,c,h,p,d,v,m,g,y,b;n=Design.modelClassForType(e.RESTYPE.ASG).allObjects(),u=[];for(m=0,y=n.length;m<y;m++){r=n[m],f=r.getNotiObject(),a=!1,!f||!f.isEffective()?a=!0:(d=f.getTopic(),d||(a=!0)),a||u.push([d,r,f]),c=r.get("policies")||[];for(g=0,b=c.length;g<b;g++)l=c[g],d=l.getTopic(),l.isNotificate()&&d&&u.push([d,r,l])}if(_.isEmpty(u)){t(null);return}return h=Design.instance().region(),v=s(e.RESTYPE.TOPIC,h),p=[],v.fetchForce().fin(function(){var n,s,a,f;for(a=0,f=u.length;a<f;a++)s=u[a],d=s[0],r=s[1],n=s[2],v.get(d.get("appId"))||(n.type===e.RESTYPE.SP?p.push(i.message.error(n.id,o.TA_MSG_ERROR_ASG_POLICY_TOPIC_NONEXISTENT,r.get("name"),n.get("name"),d.get("name"))):n.type===e.RESTYPE.NC&&p.push(i.message.error(n.id,o.TA_MSG_ERROR_ASG_NOTIFICITION_TOPIC_NONEXISTENT,r.get("name"),d.get("name"))));return t(p)})},{isHasLaunchConfiguration:a,isELBHasHealthCheck:u,isNotificationNotHasTopic:f,isPolicyNotHasTopic:l,isTopicNonexist:c}})}.call(this),function(){define("component/trustedadvisor/validation/ec2/eip",["constant","MC","i18n!/nls/lang.js","../result_vo"],function(e,t,n,r){var i,s;return i=function(){var t;return!s(e.RESTYPE.EIP)||s(e.RESTYPE.IGW)?null:(t=n.ide.TA_MSG_ERROR_HAS_EIP_NOT_HAS_IGW,{level:e.TA.ERROR,info:t})},s=function(e){var n;return n=t.canvas_data.component,_.some(n,function(t){return t.type===e})},{isHasIGW:i}})}.call(this),function(){define("component/trustedadvisor/validation/ec2/az",["constant","MC","i18n!/nls/lang.js","../result_vo"],function(e,t,n,r){var i;return i=function(){var r,i,s;return i=_.countBy(t.canvas_data.component,function(t){var n;return(n=t.type)===e.RESTYPE.INSTANCE||n===e.RESTYPE.LC?"instance":"others"}),i.instance?(r=_.countBy(t.canvas_data.component,function(t){return t.type===e.RESTYPE.AZ?"az":"others"}),r.az>1?null:(s=n.ide.TA_MSG_WARNING_SINGLE_AZ,{level:e.TA.WARNING,info:s})):null},{isAZAlone:i}})}.call(this),function(){define("component/trustedadvisor/validation/vpc/vgw",["constant","MC","i18n!/nls/lang.js","../result_vo"],function(e,t,n,r){var i;return i=function(r){var i,s,o,u,a;return i=t.canvas_data.component,u=i[r],a=t.genResRef(r,"resource.VpnGatewayId"),s=_.some(i,function(t){if(t.type===e.RESTYPE.RT)return _.some(t.resource.RouteSet,function(e){var n;if(e.GatewayId===a)return n=t,!0})}),s?null:(o=n.ide.TA_MSG_WARNING_NO_RTB_CONNECT_VGW,{level:e.TA.WARNING,info:o,uid:r})},{isConnectToRTB:i}})}.call(this),function(){define("component/trustedadvisor/validation/vpc/vpn",["constant","MC","i18n!/nls/lang.js","../result_vo"],function(e,t,n,r){var i,s;return i=function(r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;return c=null,y=t.canvas_data.component[r],u=y.resource.CustomerGatewayId,m=y.resource.VpnGatewayId,a="",u&&(a=t.extractID(u)),g="",m&&(g=t.extractID(m)),a&&g&&(s=t.canvas_data.component[a],d=t.canvas_data.component[g],s&&(l=!0,i=s.resource.BgpAsn,i&&_.isNumber(Number(i))&&(l=!1),l&&(h=y.resource.Routes,f=!0,h.length||(f=!1),_.isArray(h)&&_.each(h,function(e){return e.DestinationCidrBlock||(f=!1),null}),l&&!f&&(v=d.name,o=s.name,p=sprintf(n.ide.TA_MSG_ERROR_VPN_NO_IP_FOR_STATIC_CGW,o,v),c={level:e.TA.ERROR,info:p,uid:r})))),c},s=function(r){var i,s,o,u,a,f;return s=null,a=t.canvas_data.component[r],f=a.name,o=a.resource.Routes,i=[],_.each(o,function(n){var r,s,o,u,a,f;o=n.DestinationCidrBlock;if(o){f=Design.modelClassForType(e.RESTYPE.SUBNET).isValidSubnetCIDR(o);if(!f)return i.push(o);u=o.split("/")[0],a=o.split("/")[1],s=t.aws.aws.isValidInIPRange(u,"public"),r=t.aws.aws.isValidInIPRange(u,"private");if(s&&!r||Number(a)===0)return i.push(o)}}),i.length&&(u=sprintf(n.ide.TA_MSG_ERROR_VPN_NOT_PUBLIC_IP,f,i.join(", ")),s={level:e.TA.ERROR,info:u,uid:r}),s},{isVPNHaveIPForStaticCGW:i,isVPNPrefixIPNotValid:s}})}.call(this),function(){define("component/trustedadvisor/validation/vpc/igw",["constant","MC","i18n!/nls/lang.js","../result_vo"],function(e,t,n,r){var i;return i=function(r){var i,s,o,u,a;return i=t.canvas_data.component,s=i[r],o=t.genResRef(r,"resource.InternetGatewayId"),u=_.some(i,function(t){if(t.type===e.RESTYPE.RT)return _.some(t.resource.RouteSet,function(e){var n;if(e.GatewayId===o)return n=t,!0})}),u?null:(a=n.ide.TA_MSG_WARNING_NO_RTB_CONNECT_IGW,{level:e.TA.WARNING,info:a,uid:r})},{isConnectToRTB:i}})}.call(this),function(){define("component/trustedadvisor/validation/vpc/networkacl",["constant","MC","i18n!/nls/lang.js","../result_vo"],function(e,t,n,r){var i;return i=function(r){var i,s,o,u,a;return o=t.canvas_data.component,s=o[r],u=_.some(s.resource.AssociationSet,function(e){if(e.SubnetId)return!0}),i=_.some(s.resource.EntrySet,function(e){return e.RuleAction==="allow"}),!u||i?null:(a=sprintf(n.ide.TA_MSG_NOTICE_ACL_HAS_NO_ALLOW_RULE,s.name),{level:e.TA.NOTICE,info:a,uid:r})},{isConnectSubnetButNoAllowRule:i}})}.call(this),function(){define("component/trustedadvisor/validation/vpc/cgw",["constant","jquery","MC","i18n!/nls/lang.js","customergateway_service","../../helper","../result_vo"],function(e,t,n,r,i,s){var o,u,a,f;return o=s.i18n.short(),a=function(s){var o,u,a,f,l,c,h;try{return s||(s=function(){}),a=l=c=f=null,_.each(n.canvas_data.component,function(t){return t.type===e.RESTYPE.CGW&&(f=t.resource.CustomerGatewayId,a=t.resource.IpAddress,l=t.name,c=t.uid),null}),a&&l&&c&&!f?(o=n.canvas_data.region,i.DescribeCustomerGateways({sender:this},t.cookie("usercode"),t.cookie("session_id"),o,[],null,function(t){var n,i,o,u;return i=!0,o=null,t.is_error?s(null):(n=t.resolved_data,_.each(n,function(e){var t,n,s;return n=e.customerGatewayId,t=e.ipAddress,s=e.state,a===t&&s==="available"&&(o=sprintf(r.ide.TA_MSG_ERROR_CGW_IP_CONFLICT,l,a,n,t),i=!1),null})),i?s(null):(u={level:e.TA.ERROR,info:o},s(u),void 0),null}),h=sprintf(r.ide.TA_MSG_ERROR_CGW_CHECKING_IP_CONFLICT),{level:e.TA.ERROR,info:h}):s(null)}catch(p){return u=p,s(null)}},f=function(t){var i,s,o,u,a;return i=n.canvas_data.component[t],o=i.name,s=i.resource.IpAddress,u=n.aws.aws.isValidInIPRange(s,"private"),u?(a=sprintf(r.ide.TA_MSG_WARNING_CGW_IP_RANGE_ERROR,o,s),{level:e.TA.WARNING,info:a,uid:t}):null},u=function(t){var n,r;return n=Design.instance().component(t),r=n.connections(e.RESTYPE.VPN).length,r?null:s.message.error(t,o.TA_MSG_ERROR_CGW_MUST_ATTACH_VPN,n.get("name"))},{isCGWHaveIPConflict:a,isValidCGWIP:f,isAttachVGW:u}})}.call(this),function(){define("component/trustedadvisor/validation/vpc/eni",["constant","MC","i18n!/nls/lang.js"],function(e,t,n){var r;return r=function(r){var i,s,o,u;return s=t.canvas_data.component[r],i=s.resource.Attachment.InstanceId,i?null:(o=s.name,u=sprintf(n.ide.TA_MSG_ERROR_ENI_NOT_ATTACH_TO_INSTANCE,o),{level:e.TA.ERROR,info:u,uid:r})},{isENIAttachToInstance:r}})}.call(this),function(){define("component/trustedadvisor/validation/vpc/rtb",["constant","MC","../../helper","Design"],function(e,t,n,r){var i,s,o;return i=n.i18n.short(),s=function(t){var s,o,u,a,f,l,c,h,p,d,v;l=r.instance().component(t),c=l.get("name"),p=l.connectionTargets("RTB_Route"),h=l.connectionTargets("RTB_Asso"),a="",s=_.filter(p,function(t){return t.type===e.RESTYPE.INSTANCE}),f=[];if(h.length){for(d=0,v=s.length;d<v;d++)o=s[d],u=o.get("name"),f.push(n.message.notice(t+o.id,i.TA_MSG_NOTICE_RT_ROUTE_NAT,u,c,u,c));return f}return null},o=function(n){var s,o,u,a,f;return a=t.canvas_data.component[n],u=a.resource.RouteSet,f=a.name,o=[],s=[],_.each(u,function(t,u){var a;return a=t.DestinationCidrBlock,_.each(o,function(t){var o,l;o=r.modelClassForType(e.RESTYPE.SUBNET);if(a===t||u===0&&o.isCidrConflict(a,t))return l=sprintf(i.TA_MSG_ERROR_RT_HAVE_CONFLICT_DESTINATION,f),s.push({level:e.TA.ERROR,info:l,uid:n})}),o.push(a)}),s.length?s:null},{isRtbConnectedNatAndItConnectedSubnet:s,isRtbHaveConflictDestination:o}})}.call(this),function(){define("component/trustedadvisor/validation/stateeditor/validation/reference",["constant","MC","i18n!/nls/lang.js"],function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v;return o={"AWS.EC2.Instance":n.ide.TA_MSG_ERROR_STATE_EDITOR_INEXISTENT_INSTANCE,"AWS.AutoScaling.LaunchConfiguration":n.ide.TA_MSG_ERROR_STATE_EDITOR_INEXISTENT_ASG},l=function(e,t,n,r){var i;return i=o[arguments[0]],sprintf.apply(this,[].concat(i,Array.prototype.slice.call(arguments,1)))},a=function(t,n){return{level:e.TA.ERROR,info:t,uid:"refinexsit:"+n}},u=function(t){var n,r,i,s;r=e.REGEXP.stateEditorOriginReference,s=[];while((i=r.exec(t))!==null)n={attr:i[3],uid:i[2],ref:i[1],str:i[0]},s.push(n);return s},h=function(t){return e.REGEXP.uid.lastIndex=0,e.REGEXP.uid.test(t)},f=function(e){var n;return n=t.canvas_data.component[e],n},c=function(e,t){var n,r,i;r=[];if(_.isString(e)){if(e.length===0)return[];r=r.concat(u(e))}else for(n in e)i=e[n],r=r.concat(c(i,t));return r},p=function(e,t){return _.some(e,function(e){return e.ref===t.ref})},d=function(e){var t,n,r,i;return t=e.attr.split("."),r=t[0],i=t[1],n=f(e.uid),n&&n[r]&&_.where(n[r],{id:i}).length?!0:!1},v=function(e){return e.attr.indexOf(".")!==-1},r={illegal:function(e){var t,n;return t=f(e.uid),t?n=""+(t.serverGroupName||t.name)+"."+e.attr:h(e.uid)?n="unknown."+e.attr:n=e.ref,n},state:function(e){var t,n;return n=r.illegal(e),t=n.split("."),t[2].length===42&&(t[2]="unknown"),t.join(".")}},i=function(e,n){var i,s,o,u,f,h,m,g;u=c(e,n),i=[],u.length&&(s=t.aws.aws.genAttrRefList(n.comp,t.canvas_data.component));for(m=0,g=u.length;m<g;m++)o=u[m],v(o)?d(o)||(f=r.state(o)):p(s,o)||(f=r.illegal(o)),f&&(h=l(n.type,n.name,n.stateId,f),i.push(a(h,n.stateId)));return i},s=function(){return null},i})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("component/trustedadvisor/validation/stateeditor/validation/format",["Design","constant","i18n!/nls/lang.js","jquery","underscore","MC"],function(t,n,r){var i,s,o,u,a;return s={},o={command:function(e,t,n,r){var s;return e=i.trim(e),s=t.dataMap,this.required(e)?this.stateAllowed(e,s)?null:'Command "'+e+'" is not supported.':"Command name is required."},parameter:function(e,t,n,r){var i,s;return s=["required","type"],i=null,this[t.constraint.type]&&(i=this[t.constraint.type](e,t,n,r)),i||(i=this.componentExist(e)),i},dict:function(e,t,n,r){var i,s;return s=t.subType,i=null,t.constraint.required&&s==="key"&&!this.required(e)&&(i="dict key is required"),i},array:function(e,t,n,r){var i;return i=null,t.constraint.required&&!this.required(e)&&(i="array value is required"),i},line:function(e,t,n,r){var i;return i=null,t.constraint.required&&!this.required(e)&&(i="line value is required"),i},text:function(e,t,n,r){var i;return i=null,t.constraint.required&&!this.required(e)?i="text value is required":i=this.componentExist(e),i},bool:function(e,t,n,r){var i;return i=null,t.constraint.required&&!this.required(e)?i="line value is required":!this.isBool(e)&&!this.isStringBool(e,!0)&&(i='invalid boolean value: "'+e+'"'),i},componentExist:function(e){var t,n,r,s,o;r=i.getRefName(e),t=0;for(s=0,o=r.length;s<o;s++)n=r[s],i.nameExist(n.name)||t++;return t?"Reference 'unknown' doesn't exist.":null},required:function(e){return _.isArray(e)||_.isObject(e)?!!_.size(e):this.notnull(e)&&this.notblank(e)},isRef:function(e){return _.isArray(e)||(e=[e]),_.every(e,function(e){return n.REGEXP.stateEditorRefOnly.test(e)})},notnull:function(e){return e.length>0},notblank:function(e){return"string"==typeof e&&""!==e.replace(/^\s+/g,"").replace(/\s+$/g,"")},isBool:function(e){return _.isBoolean(e)},isStringBool:function(e,t){return/^(true|false)$/i.test(e||t&&e==="")},stateAllowed:function(t,n){return e.call(i.getAllowCommands(n),t)>=0}},i={getAllowCommands:function(e){return _.keys(e)},trim:function(e){return $.trim(e)},nameExist:function(e){var n,r,i;n=t.instance().serialize().component;for(i in n){r=n[i];if(r.name===e)return!0}return!1},getRefName:function(e){var t,r,i;t=n.REGEXP.stateEditorOriginReference,i=[];while((r=t.exec(e))!==null)i.push({name:r[1],ref:r[0]});return i},buildError:function(e,t,r){return{level:n.TA.ERROR,info:e,uid:"format_"+r+":"+t}},getModule:function(){var e,n,r;return r=t.instance().get("agent").module,n=App.model.getStateModule(r.repo,r.tag),e={},_.each(n,function(t,n){return _.extend(e,t)}),e},getCommand:function(e,t){return _.findWhere(e,{module:t})}},a=function(e,t){var n,s,u,a,f,l,c,h;u=i.getModule(),n=i.getCommand(u,e.module);if(n){s=[],h=n.parameter;for(a in h)f=h[a],f.required===!0&&!o.required(e.parameter[a])?(l=sprintf(r.ide.TA_MSG_ERROR_STATE_EDITOR_EMPTY_REQUIED_PARAMETER,t.name,t.stateId,a),c="requiredParameter",s.push(i.buildError(l,t.stateId,c))):n.module==="meta.wait"&&a==="state"&&!o.isRef(e.parameter[a])&&(l=sprintf(r.ide.TA_MSG_ERROR_STATE_EDITOR_INVALID_FORMAT,t.name,t.stateId,"wait"),c="invalidFormat",s.push(i.buildError(l,t.stateId,c)));return s}},u=function(e,t){return a(e,t)},u})}.call(this),function(){define("component/trustedadvisor/validation/stateeditor/register",["./validation/reference","./validation/format"],function(e,t){return[e,t]})}.call(this),function(){define("component/trustedadvisor/validation/stateeditor/main",["./register","constant","MC","i18n!/nls/lang.js","../result_vo"],function(e,t,n,r,i){var s,o,u;return u=function(e,t,n){var r,i,s,o;if(e){_.isArray(e)||(e=[e]),o=e||[];for(i=0,s=o.length;i<s;i++)r=o[i],r.uid=""+t+":"+n+":"+r.uid}return e},o=function(t,n){var r,i,s,o;s=[];for(r in e)o=e[r],i=o(t,n),i=u(i,n.uid,r),s=s.concat(i);return s},s=function(e){var t,r,i,s;return t=n.canvas_data.component[e],!t||!t.state||t.index&&t.index>0?null:(s=t.state,r={uid:e,comp:t,type:t.type,name:t.name,stateId:null},i=[],_.each(s,function(e,t){return i=i.concat(o(e,_.extend({},r,{stateId:t+1}))),null}),i.length||(i=null),i)},s})}.call(this),function(){define("component/trustedadvisor/validation/state/state",["constant","MC","../result_vo","Design","../../helper"],function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k;return s=i.i18n.short(),k=function(e){return function(t){return m(t)?e(t):null}},c=function(e,n){return n?r.instance().component(e):t.canvas_data.component[e]},m=function(e){var t,n,i;return r.instance().get("agent").enabled===!1?!1:e?(t=c(e,!0),t?(i=t.get("state"),i&&i.length):!1):(n=!1,r.instance().eachComponent(function(e){if(m(e.id))return n=!0,!1}),n)},g=function(e){return r.modelClassForType(e).allObjects().length},h=function(n){return _.filter(t.canvas_data.component,function(r){if(r.type===e.RESTYPE.ENI&&t.extractID(r.resource.Attachment.InstanceId)===n.uid)return!0})},p=function(n){var r,i,s,o,u,a,f,l,p,d,v,m,g;u=[];if(n.type===e.RESTYPE.LC){m=n.resource.SecurityGroups;for(a=0,p=m.length;a<p;a++)o=m[a],u.push(c(t.extractID(o)))}else if(n.type===e.RESTYPE.INSTANCE){i=h(n);for(f=0,d=i.length;f<d;f++){r=i[f],g=r.resource.GroupSet;for(l=0,v=g.length;l<v;l++)s=g[l],u.push(c(t.extractID(s.GroupId)))}}return _.uniq(_.compact(u))},S=function(e,t){var n,r,i,s;r=!1;if((s=e.IpProtocol)==="-1"||s==="6"||s==="tcp")n=+e.FromPort,i=+e.ToPort,n===i&&i===t?r=!0:+e.FromPort<=t&&e.ToPort>=t&&(r=!0);return r},C=function(e,t){var n,r,i,s,o,u,a,f,l;s=i=0;for(o=0,a=e.length;o<a;o++){r=e[o],l=r.resource.IpPermissionsEgress;for(u=0,f=l.length;u<f;u++){n=l[u];if(t&&n.IpRanges==="0.0.0.0/0"||!t)S(n,80)&&s++,S(n,443)&&i++}}return s>0&&i>0},v=function(t){var n,r,i;if(t.type==="ExpandedAsg")return i=t.get("originalAsg").get("lc"),i.get("publicIp")===!0;if(t.type===e.RESTYPE.LC)return t.get("publicIp")===!0;if(t.type===e.RESTYPE.INSTANCE)return n=t.connectionTargets("EniAttachment"),n.push(t.getEmbedEni()),r=_.some(n,function(e){return e.hasEip()}),t.hasAutoAssignPublicIp()||r},d=function(t){var n;return n=t.parent(),n.type!==e.RESTYPE.SUBNET&&(n=n.parent()),n.connectionTargets("RTB_Asso")[0]},x=function(t){var n,i,s,o,u,a;o=t.uid||t.id,t=r.instance().component(o),s=[],s.push(d(t)),i=t.connectionTargets("EniAttachment");for(u=0,a=i.length;u<a;u++)n=i[u],s.push(d(n));return _.some(s,function(t){var n,r;return r=t.connectionTargets("RTB_Route"),n=_.where(r,{type:e.RESTYPE.IGW}),n.length>0})},T=function(t){var n,r,i;if((i=t.type)===e.RESTYPE.INSTANCE||i===e.RESTYPE.LC){r=d(t);if(r)return n=_.where(r.connectionTargets("RTB_Route"),{type:e.RESTYPE.INSTANCE}),_.some(n,function(e){return w(e)})}return!1},w=function(e){return x(e)&&y(e)},y=function(e){var t;return t=e.connectionTargets("EniAttachment"),t.push(e.getEmbedEni()),_.some(t,function(e){return!e.get("sourceDestCheck")})},N=function(e,t,n){var r,o;return v(e)?x(e)?!0:!1:(o=e.get("name"),e.type==="ExpandedAsg"&&(r=e.get("originalAsg").get("lc"),n=e.parent().get("name"),o=r&&r.get("name")),t.push(i.message.error(e.id,s.TA_MSG_ERROR_NO_EIP_OR_PIP,o,o,n)),!0)},l=function(e,t){return i.message.error(t,s.TA_MSG_ERROR_NOT_CONNECT_OUT,e)},E=function(e){var t,n,r,i,s,o,u,a,f,h,p;i=c(e,!0),s=c(e),o=[],t=i.parent(),n=t.get("expandedList"),u=i.parent().parent(),f=u.get("name"),a=u.id,r=T(i),!r&&!N(i,o,f)&&o.push(l(f,a));for(h=0,p=n.length;h<p;h++)t=n[h],!r&&!N(t,o,f)&&(f=t.parent().get("name"),o.push(l(f,a)));return o},b=function(e){var t,n,r,i,s;return t=c(e,!0),n=[],r=t.parent(),s=r.get("name"),i=r.id,T(t)||N(t,n,s)?n:(n.push(l(s,i)),n)},u=function(t){return g(e.RESTYPE.IGW)?null:i.message.error(t,s.TA_MSG_ERROR_NO_CGW)},a=function(e){var t,n;return t=c(e),n=p(t),C(n)?null:i.message.error(e,s.TA_MSG_ERROR_NO_OUTBOUND_RULES,t.name)},f=function(e){var t,n;return t=c(e),n=p(t),a(e)||C(n,!0)?null:i.message.warning(e,s.TA_MSG_WARNING_OUTBOUND_NOT_TO_ALL,t.name)},o=function(t){var n,r;return r=[],n=c(t),n.type===e.RESTYPE.LC?E(t):b(t)},{isHasIgw:k(u),isHasOutPort80and443:k(a),isHasOutPort80and443Strict:k(f),isConnectedOut:k(o)}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("component/trustedadvisor/validation/ec2/ebs",["constant","jquery","MC","i18n!/nls/lang.js","ebs_service","../result_vo"],function(t,n,r,i,s){var o;return o=function(o){var u,a,f,l;try{return o||(o=function(){}),f=[],l={},_.each(r.canvas_data.component,function(e){var n,r;return e.type===t.RESTYPE.VOL&&(r=e.resource.SnapshotId,n=e.resource.AttachmentSet.InstanceId,r&&n&&(l[r]||(l[r]=[]))),e.type===t.RESTYPE.LC&&_.each(e.resource.BlockDeviceMapping,function(t,i){if(i>0){r=t.Ebs.SnapshotId,n=e.uid;if(r&&n&&!l[r])return l[r]=[]}}),null}),f=_.keys(l),f.length?(u=r.canvas_data.region,s.DescribeSnapshots({sender:this},n.cookie("usercode"),n.cookie("session_id"),u,f,null,null,null,function(s){var u,a,c;c=[];if(s.is_error&&s.aws_error_code==="InvalidSnapshot.NotFound"){a=s.error_message,a=a.replace("The snapshot '","").replace("' does not exist.",""),u=a.split(","),u=_.map(u,function(e){return n.trim(e)});if(!u.length)return o(null),null;_.each(f,function(n){var s;return e.call(u,n)>=0&&(s=l[n],_.each(s,function(e){var s,o,u,a,f,l,h;return f=r.canvas_data.component[e],l=f.type,a=f.name,s="Instance",o="instance",u=null,l===t.RESTYPE.LC?(s="Launch Configuration",o="lc",u=f.resource.LaunchConfigurationARN):u=f.resource.InstanceId,u||(h=sprintf(i.ide.TA_MSG_ERROR_STACK_HAVE_NOT_EXIST_SNAPSHOT,n,s,a),c.push({level:t.TA.ERROR,info:h,uid:e})),null})),null})}return c.length?(o(c),void 0):o(null)}),null):o(null)}catch(c){return a=c,o(null)}},{isSnapshotExist:o}})}.call(this),function(){define("component/trustedadvisor/validation/ec2/kp",["constant","MC","Design","../../helper","keypair_service","underscore"],function(e,t,n,r,i,s){var o,u,a,f;return o=r.i18n.short(),a=function(t){var i,s,u,a,f,l,c,h,p;a=n.instance().component(t),u=a.connectionTargets("KeypairUsage");if(a.isDefault()||!u.length)return null;f="",s="",l="";for(h=0,p=u.length;h<p;h++)i=u[h],c=i.type===e.RESTYPE.LC?"lc":"instance",i.type===e.RESTYPE.LC?(c="lc",f+="<span class='validation-tag tag-"+c+"'>"+i.get("name")+"</span>, "):(c="instance",s+="<span class='validation-tag tag-"+c+"'>"+i.get("name")+"</span>, ");return s&&(l+="Instance "+s),f&&(l+="Launch Configuration"+f),l=l.slice(0,-2),r.message.error(t,o.TA_MSG_ERROR_INSTANCE_REF_OLD_KEYPAIR,l,a.get("name"))},f=function(){return r.message.notice(null,o.TA_MSG_NOTICE_KEYPAIR_LONE_LIVE)},u=function(t){var u,a,f,l,c,h,p,d,v,m,g,y,b,w;u=n.modelClassForType(e.RESTYPE.INSTANCE).allObjects(),a=n.modelClassForType(e.RESTYPE.LC).allObjects(),c=u.concat(a),d=[],h=[],f={},m=[];for(b=0,w=c.length;b<w;b++){l=c[b];if(l.type===e.RESTYPE.INSTANCE&&l.get("appId")&&l.get("count")===l.groupMembers().length+1)continue;p=l.get("keyName"),p&&p[0]!=="@"&&!l.connectionTargets("KeypairUsage").length&&d.push(l)}return d.length?(y=$.cookie("usercode"),g=$.cookie("session_id"),v=n.instance().region(),i.DescribeKeyPairs(null,y,g,v).then(function(n){var i;if(n.is_error)throw n;return i=n.resolved_data||[],s.each(d,function(t){var n,r;n=s.every(i,function(e){return e.keyName!==t.get("keyName")});if(n)return p=t.get("keyName"),h.push(t),f[p]||(f[p]={lc:"",instance:""}),r=t.type===e.RESTYPE.LC?"lc":"instance",t.type===e.RESTYPE.LC?(r="lc",f[p].lc+="<span class='validation-tag tag-"+r+"'>"+t.get("name")+"</span>, "):(r="instance",f[p].instance+="<span class='validation-tag tag-"+r+"'>"+t.get("name")+"</span>, ")}),s.each(f,function(e,t){var n;return n="",e.instance&&(n+="Instance "+e.instance),e.lc&&(n+="Launch Configuration"+e.lc),n=n.slice(0,-2),m.push(r.message.error(t,o.TA_MSG_ERROR_INSTANCE_REF_OLD_KEYPAIR,n,t))}),t(m)}).fail(function(e){return t(null)})):t(null)},{isNotDefaultAndRefInstance:a,longLiveNotice:f,isKeyPairExistInAws:u}})}.call(this),function(){define("component/trustedadvisor/validation/main",["MC","./stack/stack","./ec2/instance","./vpc/subnet","./vpc/vpc","./elb/elb","./ec2/securitygroup","./asg/asg","./ec2/eip","./ec2/az","./vpc/vgw","./vpc/vpn","./vpc/igw","./vpc/networkacl","./vpc/cgw","./vpc/eni","./vpc/rtb","./stateeditor/main","./state/state","./ec2/ebs","./ec2/kp"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){return{stack:t,instance:n,subnet:r,vpc:i,elb:s,sg:o,asg:u,eip:a,az:f,vgw:l,vpn:c,igw:h,acl:p,cgw:d,eni:v,rtb:m,stateEditor:g,state:y,ebs:b,kp:w}})}.call(this),function(){define("validation",["constant","event","component/trustedadvisor/config","component/trustedadvisor/validation/main","component/trustedadvisor/validation/result_vo","jquery","underscore","MC"],function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;return p=function(){return i.reset()},v=function(e,t){return n.globalList[e]&&_.contains(n.globalList[e],t)},d=function(e,t){return n.asyncList[e]&&_.contains(n.asyncList[e],t)},c=function(e){var t;return n.componentTypeToFileMap[e]?n.componentTypeToFileMap[e]:(t=_.last(e.split(".")),t=t.toLowerCase(),[t])},m=function(e,t,n,r){return i.set(""+n+"."+t,e,r)},g=function(){return t.trigger(t.TA_SYNC_START)},l=function(e){return _.after(e,function(){return t.trigger(t.TA_SYNC_FINISH)})},f=function(e,t,r){var i;return i=!1,_.delay(function(){if(!i)return i=!0,m(null,e,t),r(),void 0},n.syncTimeout),function(n){if(!i)return i=!0,m(n,e,t),r()}},h=function(e){return void 0},w=function(e){return _.each(n.globalList,function(t,n){return _.each(t,function(t){var i,s;try{if(t.indexOf("~")===0){if(e!=="all")return;t=t.slice(1)}return s=r[n][t](),m(s,t,n)}catch(o){return i=o,h(i)}})}),null},b=function(){var e;return e=MC.canvas_data.component,_.each(e,function(e,t){var n,i;i=c(e.type),_.each(i,function(e){return _.each(r[e],function(n,i){var s,o;if(!v(e,i)&&!d(e,i))try{return o=r[e][i](t),m(o,i,e,t)}catch(u){return s=u,h(s)}})});try{return E(r,t)}catch(s){return n=s,h(n)}}),null},E=function(e,t){var n;return Design.instance().get("agent").enabled===!0&&(n=e.stateEditor(t),m(n,"stateEditor","stateEditor",t)),null},y=function(){var e,t;return e=_.reduce(n.asyncList,function(e,t){return e+t.length},0),g(),t=l(e),_.each(n.asyncList,function(e,n){return _.each(e,function(e){var i,s;try{return s=r[n][e](f(e,n,t)),m(s,e,n)}catch(o){return i=o,h(i)}})}),null},u=function(e){var t,n,s,o,u,a,f;try{MC.ta.resultVO=i,f=e.split("."),s=f[0],u=f[1],o=r[s][u];if(_.isFunction(o))return t=Array.prototype.slice.call(arguments,1),a=o.apply(r[s],t),i.set(e,a),a;void 0}catch(l){n=l,h(n)}return null},a=function(){return p(),b(),w("run"),y(),i.result()},o=function(){return p(),b(),w("all"),i.result()},s={validComp:u,validAll:o,validRun:a,stateEditor:r.stateEditor,list:[],state_list:{}},MC.ta=s,s})}.call(this),define("component/trustedadvisor/template",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return"no-item"}function c(e,t){var n="",r;n+='\r\n					<div class="title" data-key="'+a((r=e&&e.key,typeof r===u?r.apply(e):r))+'" data-type="'+a((r=e&&e.type,typeof r===u?r.apply(e):r))+'">\r\n						',r=(r=e&&e.info,typeof r===u?r.apply(e):r);if(r||r===0)n+=r;return n+="\r\n					</div>\r\n\r\n				",n}function h(e,t){var n="",r;return n+='\r\n					<div class="title empty" data-key="'+a((r=e&&e.key,typeof r===u?r.apply(e):r))+'" data-type="'+a((r=e&&e.type,typeof r===u?r.apply(e):r))+'">\r\n						Good job! No error here.\r\n					</div>\r\n				',n}function p(e,t){var n="",r;n+='\r\n					<div class="title" data-key="'+a((r=e&&e.key,typeof r===u?r.apply(e):r))+'" data-type="'+a((r=e&&e.type,typeof r===u?r.apply(e):r))+'">\r\n						',r=(r=e&&e.info,typeof r===u?r.apply(e):r);if(r||r===0)n+=r;return n+="\r\n					</div>\r\n				",n}function d(e,t){var n="",r;return n+='\r\n					<div class="title empty" data-key="'+a((r=e&&e.key,typeof r===u?r.apply(e):r))+'" data-type="'+a((r=e&&e.type,typeof r===u?r.apply(e):r))+'">\r\n						Good job! No warning here.\r\n					</div>\r\n				',n}function v(e,t){var n="",r;return n+='\r\n					<div class="title empty" data-key="'+a((r=e&&e.key,typeof r===u?r.apply(e):r))+'" data-type="'+a((r=e&&e.type,typeof r===u?r.apply(e):r))+'">\r\n						Good job! No notice here.\r\n					</div>\r\n				',n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="validation-content">\r\n	<ul class="tab">\r\n		<li class="active ',o=n.unless.call(t,(o=t&&t.error_list,o==null||o===!1?o:o.length),{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='" data-tab-target="#item-error">Error<span class="validation-counter validation-counter-error">'+a((o=(o=t&&t.error_list,o==null||o===!1?o:o.length),typeof o===u?o.apply(t):o))+'</span></li>\r\n		<li data-tab-target="#item-warning" class="',o=n.unless.call(t,(o=t&&t.warning_list,o==null||o===!1?o:o.length),{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='">Warning<span class="validation-counter validation-counter-warning">'+a((o=(o=t&&t.warning_list,o==null||o===!1?o:o.length),typeof o===u?o.apply(t):o))+'</span></li>\r\n		<li data-tab-target="#item-notice" class="',o=n.unless.call(t,(o=t&&t.notice_list,o==null||o===!1?o:o.length),{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='">Notice<span class="validation-counter validation-counter-notice">'+a((o=(o=t&&t.notice_list,o==null||o===!1?o:o.length),typeof o===u?o.apply(t):o))+'</span></li>\r\n	</ul>\r\n	<div class="scroll-wrap scroll-wrap-validation">\r\n		<div class="scrollbar-veritical-wrap" style="display: block;"><div class="scrollbar-veritical-thumb"></div></div>\r\n		<div class="content_wrap scroll-content">\r\n\r\n			<div id="item-error" class="content active">\r\n\r\n				',o=n.each.call(t,t&&t.error_list,{hash:{},inverse:f.program(5,h,i),fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\r\n\r\n				<div class="item-error-tip"><i class="icon-info"></i>Some error validation only happens at the time to run stack.</div>\r\n\r\n			</div>\r\n			<div id="item-warning" class="content">\r\n				',o=n.each.call(t,t&&t.warning_list,{hash:{},inverse:f.program(9,d,i),fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+='\r\n			</div>\r\n			<div id="item-notice" class="content">\r\n				',o=n.each.call(t,t&&t.notice_list,{hash:{},inverse:f.program(11,v,i),fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;return s+="\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>",s};return e.template(t)}),define("component/trustedadvisor/modal_template",["handlebars"],function(e){var t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="modal-header">\r\n	<h3>Validation</h3>\r\n	<i class="modal-close">×</i>\r\n</div>\r\n<div class="modal-body">\r\n	<div id="modal-validation-statusbar">\r\n	</div>\r\n</div>'};return e.template(t)}),function(){define("component/trustedadvisor/view",["event","./template","./modal_template","backbone","jquery","handlebars"],function(e,t,n){var r;return r=Backbone.View.extend({el:".status-bar-modal",events:{"click .modal-close":"closedPopup"},render:function(e,r){return void 0,e==="stack"?($("#stack-run-validation-container").html(t(this.model.attributes)),$(".validating").hide(),this.processDetails(),$(".stack-validation details").show()):e==="statusbar"&&(this.$el.html(n()),this.$el.find("#modal-validation-statusbar").html(t(this.model.attributes)),this.processStatusBarDetails(),$(".status-bar-modal").show()),null},processStatusBarDetails:function(){var e,t,n,r;t=this.model.get("error_list"),r=this.model.get("warning_list"),n=this.model.get("notice_list"),e=this.$el.find(".tab li");if(!t.length)return r.length?e.eq(1).click():n.length?e.eq(2).click():(this.$el.find(".validation-content").text("Great job! No error, warning or notice here."),this.$el.find(".validation-content").addClass("empty"))},processDetails:function(){var e,t,n,r,i,s,o,u,a;return s=this.model.get("error_list"),a=this.model.get("warning_list"),o=this.model.get("notice_list"),r=$(".modal-box .tab li"),t=$(".modal-box .nutshell"),e=t.prev("details"),n=e.find("summary"),i=function(){return n.click(function(){return e.attr("open")==="open"?t.show():t.hide()})},u=function(e){var r;r="",s.length&&(r+=""+s.length+" error(s), ",_.defer(function(){return modal.position()})),a.length&&(r+=""+a.length+" warning(s), "),o.length&&(r+=""+o.length+" notice(s), "),r?r=r.slice(0,-2):r="No error, warning or notice.",t.find("label").text(r),t.click(function(){return n.click()});if(!e)return t.show()},s.length?(i(),u(!0)):a.length?(r.eq(1).click(),e.removeAttr("open"),u(),i()):o.length?(r.eq(2).click(),e.removeAttr("open"),u(),i()):(e.removeAttr("open"),u(),i(),$(".validation-content").text("Great job! No error, warning or notice here."))},restoreRun:function(){return $("#btn-confirm, #confirm-update-app").removeAttr("disabled")},_clickCurrentTab:function(e){void 0;if(!e)return;return _.each($(".tab").find("li"),function(t){if($(t).attr("data-tab-target")==="#item-"+e)return $(t).trigger("click")})},closedPopup:function(){if(this.$el.html())return void 0,this.$el.empty(),this.trigger("CLOSE_POPUP"),$(".status-bar-modal").hide()}}),r})}.call(this),function(){define("component/trustedadvisor/model",["backbone","jquery","underscore","MC"],function(){var e;return e=Backbone.Model.extend({defaults:{notice_list:null,warning_list:null,error_list:null},createList:function(){var e,t,n,r;void 0,t=[],r=[],e=[],n={},_.each(MC.ta.list,function(i){n={info:i.info,key:i.key,type:i.type};switch(i.level){case"NOTICE":return t.push(n);case"WARNING":return r.push(n);case"ERROR":return e.push(n)}}),this.set("notice_list",t),this.set("warning_list",r),this.set("error_list",e),MC.ta.state_list={notice_list:t,warning_list:r,error_list:e}}}),e})}.call(this),function(){define("component/trustedadvisor/main",["jquery","event","./view","./model"],function(e,t,n,r){var i,s;return i=function(e,i){var o,u,a,f;return f=new n,o=new r,f.model=o,f.on("CLOSE_POPUP",function(){return s(f,o)}),u=function(){return t.onLongListen(t.UPDATE_TA_MODAL,function(){return void 0}),o.createList(),f.render(e,i)},a=function(){var n;return n=Q.defer(),t.onListen(t.TA_SYNC_FINISH,function(){return void 0,o.createList(),f.render(e,i),o.get("error_list").length===0?n.resolve():n.reject()}),MC.ta.validRun(),n.promise},t.onLongListen(t.UNLOAD_TA_MODAL,function(){return void 0,s(f,o)}),e==="stack"?(f.closedPopup(),a()):u()},s=function(e,n){return void 0,e.off(),n.off(),e.undelegateEvents(),e=null,n=null,t.offListen(t.UPDATE_TA_MODAL),t.offListen(t.UNLOAD_TA_MODAL)},{loadModule:i,unLoadModule:s}})}.call(this),define("component/Validation",function(){});