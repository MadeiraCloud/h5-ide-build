define("component/common/toolbarModalTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="modal-toolbar '+a((o=t&&t.classList,typeof o===u?o.apply(t):o))+'">\n    <div class="content-wrap">\n\n    </div>\n</div>',s},n.frame=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n    <button class="icon-new-stack btn btn-blue t-m-btn" data-btn="create">'+a((r=e&&e.btnValueCreate,typeof r===u?r.apply(e):r))+"</button>\n    ",n}function c(e,t){var r="",i;r+='\n        <button class="icon-'+a((i=e&&e.icon,typeof i===u?i.apply(e):i))+' t-m-btn" data-btn="'+a((i=e&&e.type,typeof i===u?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.disabled,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+=">"+a((i=e&&e.name,typeof i===u?i.apply(e):i))+"</button>\n        ",r}function h(e,t){return"disabled"}function p(e,t){var r="",i;r+='\n                    <th class="',i=n["if"].call(e,e&&e.sortable,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;r+='" data-row-type="',i=n["if"].call(e,e&&e.rowType,{hash:{},inverse:f.program(11,m,t),fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+='" style="',i=n["if"].call(e,e&&e.width,{hash:{},inverse:f.noop,fn:f.program(13,g,t),data:t});if(i||i===0)r+=i;return r+='">'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+"</th>\n                    ",r}function d(e,t){return"sortable"}function v(e,t){var n;return a((n=e&&e.rowType,typeof n===u?n.apply(e):n))}function m(e,t){return"string"}function g(e,t){var n="",r;return n+="width:"+a((r=e&&e.width,typeof r===u?r.apply(e):r))+";",n}function y(e,t){var r="",i;r+='\n                            <th style="',i=n["if"].call(e,e&&e.width,{hash:{},inverse:f.noop,fn:f.program(13,g,t),data:t});if(i||i===0)r+=i;return r+='"><div class="th-inner"></div></th>\n                            ',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="toolbar">\n    ',o=n["if"].call(t,t&&t.btnValueCreate,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n    <div class="btn-group">\n        ',o=n.each.call(t,t&&t.buttons,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n    </div>\n</div>\n<div class="list">\n    <div class="slidebox" style="'+a((o=t&&t.slideStyle,typeof o===u?o.apply(t):o))+'">\n        <div class="content clearfix">\n        </div>\n        <div class="error">\n            something wrong\n        </div>\n    </div>\n    <div class="table-head-fix">\n        <table class="table-head">\n            <thead>\n                <tr>\n                    <th>\n                        <div class="checkbox">\n                            <input id="t-m-select-all" type="checkbox" value="None">\n                            <label for="t-m-select-all"></label>\n                        </div>\n                    </th>\n                    ',o=n.each.call(t,t&&t.columns,{hash:{},inverse:f.noop,fn:f.program(6,p,i),data:i});if(o||o===0)s+=o;s+='\n                </tr>\n            </thead>\n        </table>\n        <div class="scroll-wrap">\n            <div class="scrollbar-veritical-wrap" style="display: block;"><div class="scrollbar-veritical-thumb"></div></div>\n            <div class="scroll-content" style="display:block;">\n                <table class="table">\n                    <thead>\n                        <tr>\n                            <th><div class="th-inner"></div></th>\n                            ',o=n.each.call(t,t&&t.columns,{hash:{},inverse:f.noop,fn:f.program(15,y,i),data:i});if(o||o===0)s+=o;return s+="\n                        </tr>\n                    </thead>\n                    <tbody class='t-m-content'>\n\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</div>",s},n.content=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="loading-spinner"></div>'},n.loading=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="kp-no-credential tac">\n    <p>You are using a demo AWS account.</p>\n    <a class="show-credential">Provide AWS Credential <br/>to manage key pairs</a>\n</div>'},n.nocredential=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<tr class="table tr-detail">\n    <td colspan="'+a((o=t&&t.columnCount,typeof o===u?o.apply(t):o))+'">\n    </td>\n</tr>',s},n.tr_detail=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="no-credential tac">\n    <p>You are using a demo AWS account.</p>\n    <a class="show-credential">Provide AWS Credential <br/>to manage key pairs</a>\n</div>'},n.nocredential=e.template(t),n}),function(){define("toolbar_modal",["component/common/toolbarModalTpl","backbone","jquery","UI.modalplus","UI.notification"],function(e,t,n,r){return t.View.extend({tagName:"section",__slide:null,__modalplus:null,events:{"change #t-m-select-all":"__checkAll","change .one-cb":"__checkOne","click .t-m-btn":"__handleSlide","click tr .show-detail":"__handleDetail","click .cancel":"cancel","click .do-action":"__doAction","click [data-btn=refresh]":"__refresh","click .table-head .sortable":"__sort","click .show-credential":"__showCredential"},initialize:function(e){return this.options=e||{},this.options.title||(this.options.title="Default Title"),e.context&&(this.options.context.modal=this,this.options.context.M$=_.bind(this.$,this)),null},__showCredential:function(){return App.showSettings(App.showSettings.TAB.Credential)},__sort:function(){return this.$(".tr-detail").remove()},__doAction:function(e){var t;return this.error(),t=n(e.currentTarget).data("action"),this.trigger("action",t,this.getChecked())},getChecked:function(){var e,t;return e=this.$(".one-cb:checked"),t=[],e.each(function(){return t.push({id:this.id,value:this.value,data:n(this).data()})}),t},__slideRejct:function(){return _.isFunction(this.options.slideable)&&!this.options.slideable()},__handleSlide:function(e){var t,r,i,s,o;return r=n(e.currentTarget),i=this.$(".slidebox"),o=r.data("btn"),o==="refresh"?this:this.__slideRejct()?this:(t=this.$(".toolbar .active"),s=t&&t.data("btn"),t.length?t.get(0)===r.get(0)?(this.trigger("slideup",o),r.removeClass("active"),i.removeClass("show"),this.__slide=null):(this.trigger("slidedown",o,this.getChecked()),t.removeClass("active"),r.addClass("active"),i.addClass("show"),this.__slide=o):(this.trigger("slidedown",o,this.getChecked()),r.addClass("active"),i.addClass("show"),this.__slide=o),null)},__handleDetail:function(t){var r,i;return r=n(t.currentTarget),i=r.closest("tr"),i.hasClass("detailed")?(i.removeClass("detailed"),i.next(".tr-detail").remove()):(i.addClass("detailed").after(e.tr_detail({columnCount:this.options.columns.length+1})),this.trigger("detail",t,i.data(),i))},__refresh:function(){return this.__slideRejct()?this:(this.__renderLoading(),this.trigger("refresh"))},__close:function(e){return this.trigger("close"),this.remove(),!1},__checkOne:function(e){var t,r,i,s;return t=n(e.currentTarget),this.__processDelBtn(),r=this.$("#t-m-select-all"),i=this.$(".one-cb").length,s=this.$(".one-cb:checked").length,t.closest("tr").toggleClass("selected"),s===i?r.prop("checked",!0):i-s===1&&r.prop("checked",!1),this.__triggerChecked(e)},__checkAll:function(e){return this.__processDelBtn(),e.currentTarget.checked?(this.$('input[type="checkbox"]').prop("checked",!0),this.$("tr.item").addClass("selected")):(this.$('input[type="checkbox"]').prop("checked",!1),this.$("tr.item").removeClass("selected")),this.__triggerChecked(e)},__triggerChecked:function(e){return this.trigger("checked",e,this.getChecked())},__processDelBtn:function(e){var t;return arguments.length===1?this.$("[data-btn=delete]").prop("disabled",!e):(t=this,_.defer(function(){return t.$(".one-cb:checked").length?t.$("[data-btn=delete]").prop("disabled",!1):t.$("[data-btn=delete]").prop("disabled",!0)}))},__stopPropagation:function(e){var t;t=".sortable, #download-kp, .selection, .item";if(!n(e.target).is(t))return e.stopPropagation()},__open:function(){var e;return e={template:this.el,title:this.options.title,disableFooter:!0,disableClose:!0,width:"855px",height:"473px",compact:!0},this.__modalplus=new r(e),this.__modalplus.on("closed",this.__close,this)},__renderLoading:function(){return this.$(".content-wrap").html(e.loading),this},__renderContent:function(){var t,n;t=this.$(".content-wrap");if(!t.find(".toolbar").size())return n=this.options,n.buttons=_.reject(n.buttons,function(e){if(e.type==="create")return n.btnValueCreate=e.name,!0}),this.$(".content-wrap").html(e.content(n)),this},render:function(t){var n;return this.$el.html(e.frame(this.options)),_.isString(t)?(n=t,this.$(".content-wrap").html(e[n]&&e[n]()||n)):this.__renderLoading(),t||this.__open(),this},setContent:function(e){return this.__renderContent(),this.$(".t-m-content").html(e),this.__triggerChecked(null),this},setSlide:function(e){return this.$(".slidebox .content").html(e),this.error(),this},setDetail:function(e,t){var n;return n=e.next(".tr-detail"),n.find("td").html(t),n},triggerSlide:function(e){return this.$("[data-btn="+e+"]").click()},cancel:function(){var e,t;return this.__slideRejct()?this:(t=this.$(".slidebox"),e=this.$(".toolbar .active"),this.trigger("slideup",e.data("btn")),e.removeClass("active"),t.removeClass("show"),this)},unCheckSelectAll:function(){return this.$("#t-m-select-all").get(0).checked=!1,this.__processDelBtn(!1)},delegate:function(e,t){var n,r,i,s,o,u,a;if(!e||!_.isObject(e))return this;for(s=u=0,a=e.length;u<a;s=++u){r=e[s];if(!s)continue;i=r.match(/^(\S+)\s*(.*)$/),n=i[1],o=i[2],s=_.bind(s,t||this),n+=".delegateEvents"+this.cid,o===""?this.$el.on(n,s):this.$el.on(n,o,s)}return this},error:function(e){var t;return t=this.$(".error"),e?t.text(e).show():t.hide()},getSlide:function(){return this.__slide}})})}.call(this),define("component/kp/kpDialogTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var n="",r;return n+='\n<tr class="item" data-id="">\n    <td>\n        <div class="checkbox">\n            <input id="kp-select-'+u((r=e&&e.keyName,typeof r===o?r.apply(e):r))+'" type="checkbox" value="None" data-name="'+u((r=e&&e.keyName,typeof r===o?r.apply(e):r))+'" class="one-cb">\n            <label for="kp-select-'+u((r=e&&e.keyName,typeof r===o?r.apply(e):r))+'"></label>\n        </div>\n    </td>\n    <td>'+u((r=e&&e.keyName,typeof r===o?r.apply(e):r))+"</td>\n    <td>"+u((r=e&&e.keyFingerprint,typeof r===o?r.apply(e):r))+"</td>\n</tr>\n",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.keys,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.keys=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="slide-create" data-bind="true">\n    <div class="before-create">\n        <label for="create-kp-name">Key Pair Name</label>\n        <input class="input" type="text" id="create-kp-name" data-ignore="true" data-ignore-regexp="^[a-zA-Z0-9,_-]*$" data-required="true" maxlength="255" placeholder="allow alphanumber, _ or - up to 255 characters" autofocus>\n    </div>\n    <div class="after-create hide">Key pair <span></span> is created. You have to download the private key file (*.pem file) before you can continue. Store it in a secure and accessible location. You will not be able to download the file again after it\'s created.</div>\n    <div class="init action">\n        <button class="btn btn-blue do-action" data-action="create">Create</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Creating...</button>\n    </div>\n    <div class="download action" style="display:none;">\n        <a class="btn btn-blue do-action pulse" data-action="download" id="download-kp">Download</a>\n        <button class="btn btn-silver cancel" disabled>Close</button>\n    </div>\n</div>'},n.slide_create=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n;return a((n=e&&e.selecteKeyName,typeof n===u?n.apply(e):n))}function c(e,t){var n="",r;return n+="selected "+a((r=e&&e.selectedCount,typeof r===u?r.apply(e):r))+" key pairs",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">Confirm to delete ',o=n["if"].call(t,t&&t.selecteKeyName,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='?</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">Delete</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Deleting...</button>\n    </div>\n</div>',s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="slide-import" data-bind="true">\n    <label for="import-kp-name">Key Pair Name</label>\n    <input class="input" type="text" id="import-kp-name" data-ignore="true" data-ignore-regexp="^[a-zA-Z0-9,_-]*$" data-required="true" maxlength="255" placeholder="allow alphanumber, _ or - up to 255 characters">\n    <div class="import-zone">\n\n    </div>\n    <div class="init action">\n        <button class="btn" disabled>Import</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="ready action" style="display:none;">\n        <button class="btn btn-blue do-action" data-action="import">Import</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Importing...</button>\n    </div>\n</div>'},n.slide_import=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="upload-kp-component drop-zone">\n    <p class="upload-stuff">\n        Drop '+a((o=t&&t.type,typeof o===u?o.apply(t):o))+',\n        <label for="modal-import" class="select-file-link">select a file</label>\n        <span class="display-empty">or paste the key content here.</span>\n        <span class="display-filled" style="display:none;">or paste the key content again to update.</span>\n        <input type="file" id="modal-import">\n    </p>\n    <p class="key-content"></p>\n</div>',s},n.upload=e.template(t),n}),function(){define("kp_upload",["./component/kp/kpDialogTpl","backbone","jquery"],function(e,t,n){return t.View.extend({__data:null,events:{"paste .upload-kp-component":"onPaste","change .upload-kp-component":"hanldeFile","drop .upload-kp-component":"hanldeFile","dragenter .upload-kp-component":"addDragoverClass","dragleave .upload-kp-component":"removeDragoverClass","dragover .upload-kp-component":"dragoverHandler"},removeDragoverClass:function(e){return n(e.currentTarget).removeClass("dragover")},addDragoverClass:function(e){return n(e.currentTarget).addClass("dragover")},dragoverHandler:function(e){var t;return t=e.originalEvent.dataTransfer,t&&(t.dropEffect="copy"),e.stopPropagation(),e.preventDefault(),null},save:function(e){if(!e)return;return this.__data=e,this.$(".drop-zone").addClass("filled"),this.$(".key-content").text(e),this.trigger("load",e)},onPaste:function(e){var t;return t=e.originalEvent.clipboardData.getData("text/plain"),this.save(t)},hanldeFile:function(e){var t;e.stopPropagation(),e.preventDefault(),this.$(".drop-zone").removeClass("dragover"),this.$("#import-json-error").html(""),e=e.originalEvent,t=(e.dataTransfer||e.target).files;if(!t||!t.length)return;return this.__reader.readAsText(t[0]),null},initialize:function(e){var t,n;return n=this,n.type=e&&e.type||"public key",t=this.__reader=new FileReader,t.onload=function(e){return n.save(t.result),null},t.onerror=function(){return n.trigger("error"),null},null},getData:function(){return this.__data},render:function(){var t;return t={type:this.type},this.$el.html(e.upload(t)),this}})})}.call(this),function(){define("kp_manage",["toolbar_modal","component/kp/kpDialogTpl","kp_upload","backbone","jquery","constant","JsonExporter","CloudResources","i18n!/nls/lang.js","UI.notification"],function(e,t,n,r,i,s,o,u,a){var f;return f=o.download,r.View.extend({__needDownload:!1,__upload:null,__import:"",__mode:"normal",needDownload:function(){return arguments.length===1?(this.__needDownload=arguments[0],arguments[0]===!1&&this.M$(".cancel").prop("disabled",!1)):this.__needDownload&&notification("warning","You must download the keypair."),this.__needDownload},denySlide:function(){return!this.needDownload()},getRegion:function(){var e;return e=Design.instance().get("region"),s.REGION_SHORT_LABEL[e]},getModalOptions:function(){var e,t,n;return n=this,e=Design.instance().get("region"),t=s.REGION_SHORT_LABEL[e],{title:"Manage Key Pairs in "+t,slideable:_.bind(n.denySlide,n),context:n,buttons:[{icon:"new-stack",type:"create",name:"Create Key Pair"},{icon:"import",type:"import",name:"Import Key Pair"},{icon:"del",type:"delete",disabled:!0,name:"Delete"},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"40%",name:"Name"},{sortable:!1,name:"Fingerprint"}]}},initModal:function(){return new e(this.getModalOptions()),this.modal.on("close",function(){return this.remove()},this),this.modal.on("slidedown",this.renderSlides,this),this.modal.on("action",this.doAction,this),this.modal.on("refresh",this.refresh,this)},initialize:function(e){var t;return e||(e={}),this.model=e.model,this.resModel=e.resModel,this.collection=u(s.RESTYPE.KP,Design.instance().get("region")),this.initModal(),App.user.hasCredential()?(t=this,this.modal.render(),this.collection.fetch().then(function(){return t.renderKeys()})):this.modal.render("nocredential"),this.collection.on("update",this.renderKeys,this)},renderKeys:function(){var e;return this.collection.isReady()?(e={keys:this.collection.toJSON()},this.modal.setContent(t.keys(e)),this):!1},__events:{"click #kp-create":"renderCreate","click #kp-import":"renderImport","click #kp-delete":"renderDelete","click #kp-refresh":"refresh","click .cancel":"cancel"},downloadKp:function(){return this.__downloadKp&&this.__downloadKp()},doAction:function(e,t){return this[e]&&this[e](this.validate(e),t)},validate:function(e){switch(e){case"create":return!this.M$("#create-kp-name").parsley("validate");case"import":return!this.M$("#import-kp-name").parsley("validate")}},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return i(this).hasClass(e)?i(this).show():i(this).hide()})},genDownload:function(e,t){return this.__downloadKp=function(){var n;return i("body").hasClass("safari")?n=null:n=new Blob([t]),n?(f(n,e),null):{data:"data://text/plain;,"+t,name:e}},this.__downloadKp},genDeleteFinish:function(e){var t,n,r,i;return r=[],t=[],i=this,n=_.after(e,function(){return i.cancel(),r.length===1?(void 0,notification("info",""+r[0].attributes.keyName+" is deleted.")):r.length>1&&notification("info","Selected "+r.length+" key pairs are deleted."),i.collection.toJSON().length||(i.M$("#t-m-select-all").get(0).checked=!1),_.each(t,function(e){return void 0})}),function(e){return void 0,!e.reason&&!e.msg?r.push(e):t.push(e),n()}},create:function(e){var t,n;n=this;if(!e)return t=this.M$("#create-kp-name").val(),this.switchAction("processing"),this.collection.create({keyName:t}).save().then(function(e){return void 0,n.needDownload(!0),n.genDownload(""+e.attributes.keyName+".pem",e.attributes.keyMaterial),n.switchAction("download"),n.M$(".before-create").hide(),n.M$(".after-create").find("span").text(e.attributes.keyName).end().show()},function(e){return void 0,n.modal.error(e.reason||e.msg),n.switchAction()})},download:function(){return this.needDownload(!1),this.__downloadKp&&this.__downloadKp()},"delete":function(e,t){var n,r,i;return n=t.length,r=this.genDeleteFinish(n),this.switchAction("processing"),i=this,_.each(t,function(e){return function(t){return e.collection.findWhere({keyName:t.data.name.toString()}).destroy().then(r,r)}}(this))},"import":function(e){var t,n,r;r=this;if(!e){n=this.M$("#import-kp-name").val(),this.switchAction("processing");try{t=btoa(r.__upload.getData())}catch(i){this.modal.error("Key is not in valid OpenSSH public key format"),r.switchAction("init");return}return this.collection.create({keyName:n,keyData:t}).save().then(function(e){return void 0,notification("info",""+n+" is imported."),r.cancel()},function(e){return void 0,r.modal.error(e.error_message||e.reason||e.msg),r.switchAction("ready")})}},cancel:function(){return this.modal.cancel()},refresh:function(){return this.collection.fetchForce().then(function(e){return function(){return e.renderKeys()}}(this))},renderSlides:function(e,n){var r,i,s;return i=t["slide_"+e],r=this.getSlides(),(s=r[e])!=null?s.call(this,i,n):void 0},getSlides:function(){var e,t;return t=this,e=this.modal,{create:function(t,n){return e.setSlide(t)},"delete":function(t,n){var r,i;r=n.length;if(!r)return;return i={},r===1?i.selecteKeyName=n[0].data.name:i.selectedCount=r,e.setSlide(t(i))},"import":function(r,i){return e.setSlide(r),t.__upload&&t.__upload.remove(),t.__upload=new n,t.__upload.on("load",t.afterImport,this),t.M$(".import-zone").html(t.__upload.render().el)}}},afterImport:function(e){return this.switchAction("ready")}})})}.call(this),define("component/common/comboDropdownTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n            <input class="input combo-dd-filter" type="text" placeholder="'+a((r=e&&e.filterPlaceHolder,typeof r===u?r.apply(e):r))+'"/>\n        ',n}function c(e,t){var n="",r;return n+='\n            <div class="combo-dd-manage btn btn-primary" style="display:none;">'+a((r=e&&e.manageBtnValue,typeof r===u?r.apply(e):r))+"</div>\n        ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="selectbox combo-dd multiopen '+a((o=t&&t.classList,typeof o===u?o.apply(t):o))+'" data-silent-close="#modal-wrap">\n    <div class="selection"></div>\n\n    <div class="dropdown">\n        ',o=n.unless.call(t,t&&t.noFilter,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n        <div class="scroll-wrap scrollbar-auto-hide clearfix">\n            <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n            <div class="scroll-content combo-dd-content">\n            </div>\n        </div>\n        ',o=n.unless.call(t,t&&t.noManage,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+="\n    </div>\n</div>",s},n.frame=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<ul class="combo-dd-list"></ul>'},n.listframe=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="loading-spinner loading-spinner-small"></div>'},n.loading=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="no-credential tac">\n    <p>You are using a demo AWS account.</p>\n    <a class="show-credential">Provide AWS Credential <br/>to manage key pairs</a>\n</div>'},n.nocredential=e.template(t),n}),function(){define("combo_dropdown",["component/common/comboDropdownTpl","backbone","jquery"],function(e,t,n){return t.View.extend({tagName:"section",events:{"click .combo-dd-manage":"__manage","click .show-credential":"__showCredential","OPTION_SHOW .selectbox":"__optionShow","OPTION_CHANGE .selectbox":"__optionChange","keyup .combo-dd-filter":"__filter","keydown .combo-dd-filter":"__stopPropagation","click .combo-dd-filter":"__returnFalse","click .create-one":"__quickCreate"},__quickCreate:function(){return this.trigger("quick_create")},__stopPropagation:function(e){return e.stopPropagation()},__returnFalse:function(){return!1},__showCredential:function(){return App.showSettings(App.showSettings.TAB.Credential)},__filter:function(e){return this.trigger("filter",e.currentTarget.value)},__manage:function(e){return this.trigger("manage"),e.stopPropagation()},__optionShow:function(){return this.$(".combo-dd-content").html().trim()||this.render("loading"),this.trigger("open")},__optionChange:function(e,t,n){return this.trigger("change",t,n)},initialize:function(t){return this.$el.html(e.frame(t)),this},render:function(t){return this.$(".combo-dd-content").html(e[t]&&e[t]()||t),this},setSelection:function(e){return this.$(".selection").html(e),this},getSelection:function(e){return n.trim(this.$(".selection").text())},setContent:function(t){return this.$(".combo-dd-content").html(e.listframe),this.$(".combo-dd-list").html(t),this},toggleControls:function(e,t){return t?this.$(".combo-dd-"+t).toggle(e):this.$(".combo-dd-filter, .combo-dd-manage").toggle(e),this},delegate:function(e,t){var n,r,i,s,o,u,a;if(!e||!_.isObject(e))return this;for(s=u=0,a=e.length;u<a;s=++u){r=e[s];if(!s)continue;i=r.match(/^(\S+)\s*(.*)$/),n=i[1],o=i[2],s=_.bind(s,t||this),n+=".delegateEvents"+this.cid,o===""?this.$el.on(n,s):this.$el.on(n,o,s)}return this}})})}.call(this),define("component/kp/kpTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,e&&e.keyName,{hash:{},inverse:a.program(4,c,t),fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function l(e,t){var n="",r;return n+="\n        "+u((r=e&&e.keyName,typeof r===o?r.apply(e):r))+"\n    ",n}function c(e,t){return"\n        Select Key Pair as $DefaultKeyPair\n    "}function h(e,t){var r="",i;r+="\n    "+u((i=e&&e.keyName,typeof i===o?i.apply(e):i))+"\n    ",i=n["if"].call(e,e&&e.defaultKey,{hash:{},inverse:a.noop,fn:a.program(7,p,t),data:t});if(i||i===0)r+=i;r+="\n    ",i=n["if"].call(e,e&&e.noKey,{hash:{},inverse:a.noop,fn:a.program(7,p,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function p(e,t){var r="";return r+='\n        <i class="icon-info tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_INSTANCE_TIP_NO_KP",{hash:{},data:t}))+'"></i>\n    ',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n["if"].call(t,t&&t.isRunTime,{hash:{},inverse:a.program(6,h,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.selection=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n    ",i=n.unless.call(e,e&&e.isRunTime,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;r+='\n    <li data-id="@no" class="item',i=n["if"].call(e,e&&e.noKey,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" tabindex="-1">\n        '+a(n.i18n.call(e,"PROP_INSTANCE_NO_KP",{hash:{},data:t}))+'\n        <i class="icon-info tooltip" data-tooltip="'+a(n.i18n.call(e,"PROP_INSTANCE_TIP_NO_KP",{hash:{},data:t}))+'"></i>\n    </li>\n',r}function c(e,t){var r="",i;r+='\n    <li data-id="@default" class="item',i=n["if"].call(e,e&&e.defaultKey,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" tabindex="-1">\n        '+a(n.i18n.call(e,"PROP_INSTANCE_DEFAULT_KP",{hash:{},data:t}))+'\n        <i class="icon-info tooltip" data-tooltip=\''+a(n.i18n.call(e,"PROP_INSTANCE_TIP_DEFAULT_KP",{hash:{},data:t}))+"'></i>\n    </li>\n    ",r}function h(e,t){return" selected"}function p(e,t){var r="",i;r+='\n    <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+a((i=e&&e.keyName,typeof i===f?i.apply(e):i))+'" data-fingerprint="'+a((i=e&&e.keyFingerprint,typeof i===f?i.apply(e):i))+'" tabindex="-1">'+a((i=e&&e.keyName,typeof i===f?i.apply(e):i))+"\n    </li>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a=this.escapeExpression,f="function";o=n.unless.call(t,t&&t.hideDefaultNoKey,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n.each.call(t,t&&t.keys,{hash:{},inverse:u.noop,fn:u.program(5,p,i),data:i});if(o||o===0)s+=o;return s},n.keys=e.template(t),n}),function(){define("kp_dropdown",["Design","kp_manage","combo_dropdown","component/kp/kpTpl","backbone","jquery","constant","i18n!/nls/lang.js","CloudResources"],function(e,t,n,r,i,s,o,u,a){var f;return f={},i.View.extend({showCredential:function(){return App.showSettings(App.showSettings.TAB.Credential)},filter:function(e){var t;return t=_.filter(this.getKey(),function(t){return t.keyName.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.renderKeys(t):this.renderKeys()},getKey:function(){var e,t;return t=this,e=this.collection.toJSON(),this.resModel&&_.each(e,function(e){if(e.keyName===t.resModel.getKeyName())return e.selected=!0}),e},setKey:function(t,n){var r;return this.__mode==="runtime"?(r=e.modelClassForType(o.RESTYPE.KP),t==="@no"?r.setDefaultKP("",""):r.setDefaultKP(t,n.fingerprint)):t==="@default"?this.resModel.setKey("",!0):t==="@no"?this.resModel.setKey(""):this.resModel.setKey(t)},manageKp:function(e){return this.renderModal(),!1},initDropdown:function(){var e;return e={manageBtnValue:u.ide.PROP_INSTANCE_MANAGE_KP,filterPlaceHolder:u.ide.PROP_INSTANCE_FILTER_KP},this.dropdown=new n(e),this.dropdown.on("open",this.show,this),this.dropdown.on("manage",this.manageKp,this),this.dropdown.on("change",this.setKey,this),this.dropdown.on("filter",this.filter,this)},initialize:function(t){return this.resModel=t?t.resModel:null,this.collection=a(o.RESTYPE.KP,e.instance().get("region")),this.listenTo(this.collection,"update",this.renderKeys),this.listenTo(this.collection,"change",this.renderKeys),this.resModel||(this.__mode="runtime"),this.initDropdown()},show:function(){var t;return App.user.hasCredential()?(t=null,!f[e.instance().get("region")]&&this.collection.isReady()?(f[e.instance().get("region")]=!0,t=this.collection.fetchForce()):(f[e.instance().get("region")]=!0,t=this.collection.fetch()),t.then(function(e){return function(){return e.renderKeys()}}(this))):this.renderNoCredential()},render:function(){return this.renderDropdown(),this.el=this.dropdown.el,this},renderNoCredential:function(){return this.dropdown.render("nocredential").toggleControls(!1)},syncErrorHandler:function(e){return void 0},renderKeys:function(e){return e&&arguments.length===1?e={keys:e,hideDefaultNoKey:!0}:e={keys:this.getKey()},this.resModel&&(this.resModel.isNoKey()&&(e.noKey=!0),this.resModel.isDefaultKey()&&(e.defaultKey=!0)),e.isRunTime=this.__mode==="runtime",this.dropdown.setContent(r.keys(e)),this.dropdown.toggleControls(!0),this},renderDropdown:function(){var e;return this.data={keyName:this.resModel?this.resModel.getKeyName():""},this.data.keyName==="$DefaultKeyPair"?this.data.defaultKey=!0:this.data.keyName==="No Key Pair"&&(this.data.noKey=!0),this.data.isRunTime=this.__mode==="runtime",e=r.selection(this.data),this.dropdown.setSelection(e)},renderModal:function(){var e;return e=this,new t({model:e.data})},remove:function(){return this.dropdown.remove(),i.View.prototype.remove.apply(this,arguments)}},{hasResourceWithDefaultKp:function(){var t;return t=!1,e.instance().eachComponent(function(e){var n;if((n=e.type)===o.RESTYPE.INSTANCE||n===o.RESTYPE.LC)if(e.isDefaultKey()&&!e.get("appId"))return t=!0,!1}),t}})})}.call(this),define("component/sns/snsTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},"<span>None</span>"},n.dropdown_no_selection=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n    <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:o.noop,fn:o.program(2,l,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'" data-name="'+a((i=e&&e.Name,typeof i===u?i.apply(e):i))+'" tabindex="-1">\n        '+a((i=e&&e.Name,typeof i===u?i.apply(e):i))+'\n        <p><span class="icon-tag-sub">'+a((i=e&&e.subCount,typeof i===u?i.apply(e):i))+" sub</span> "+a((i=e&&e.DisplayName,typeof i===u?i.apply(e):i))+"</p>\n    </li>\n",r}function l(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this,u="function",a=this.escapeExpression;return s=n.each.call(t,t,{hash:{},inverse:o.noop,fn:o.program(1,f,i),data:i}),s||s===0?s:""},n.dropdown_list=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<tr class="item" data-topic-arn="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'">\n    <td>\n        <div class="checkbox">\n            <input id="kp-select-'+u((i=e&&e.Name,typeof i===o?i.apply(e):i))+'" type="checkbox" value="None" data-name="'+u((i=e&&e.Name,typeof i===o?i.apply(e):i))+'" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" class="one-cb">\n            <label for="kp-select-'+u((i=e&&e.Name,typeof i===o?i.apply(e):i))+'"></label>\n        </div>\n    </td>\n    <td>'+u((i=e&&e.Name,typeof i===o?i.apply(e):i))+"</td>\n    <td>"+u((i=e&&e.id,typeof i===o?i.apply(e):i))+"</td>\n    <td ",i=n["if"].call(e,e&&e.subCount,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+="><b>"+u((i=e&&e.subCount,typeof i===o?i.apply(e):i))+"</b> Subscriptions</td>\n</tr>\n",r}function l(e,t){return'class="show-detail"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.modal_list=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n                    <li class="item" data-id="'+a((r=e&&e.id,typeof r===u?r.apply(e):r))+'" data-display-name="'+a((r=e&&e.DisplayName,typeof r===u?r.apply(e):r))+'">'+a((r=e&&e.Name,typeof r===u?r.apply(e):r))+"</li>\n                  ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-create" data-bind="true">\n    <div class="before-create">\n        <div>\n          <label>Select Topic</label>\n            <div class="selectbox dd-topic-name">\n                <div class="selection">New Topic</div>\n                <ul class="dropdown" tabindex="-1">\n                  <li class="item selected new-topic" data-id="@new">New Topic</li>\n                  ',o=n.each.call(t,t,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='\n                </ul>\n            </div>\n\n        </div>\n        <div class="create-sns-topic">\n            <label for="create-topic-name">Topic Name</label>\n            <input class="input" type="text" id="create-topic-name" data-ignore="true" data-ignore-regexp="^[a-zA-Z0-9,_-]*$" data-required="true" maxlength="255" placeholder="Required. Up to 256 characters" data-event-trigger="false">\n        </div>\n        <div>\n            <label for="create-display-name">Display Name</label>\n            <input class="input" type="text" id="create-display-name" maxlength="255" placeholder="Required for SMS subscriptions (up to 10 characters)" data-event-trigger="false">\n        </div>\n        <div>\n            <label>Protocol</label>\n            <div class="selectbox dd-protocol">\n                <div class="selection">email</div>\n                <ul class="dropdown" tabindex="-1">\n                    <li class="item" data-id="https">HTTPS</li>\n                    <li class="item" data-id="http">HTTP</li>\n                    <li class="item selected" data-id="email">Email</li>\n                    <li class="item" data-id="email-json">Email-JSON</li>\n                    <li class="item" data-id="sms">SMS</li>\n                    <li class="item" data-id="arn">Application</li>\n                    <li class="item" data-id="sqs">Amazon SQS</li>\n                </ul>\n            </div>\n        </div>\n        <div>\n            <label for="create-endpoint">Endpoint</label>\n            <input type="text" class="input" id="create-endpoint" max-length="255" data-required="true" placeholder="example@mail.com" data-event-trigger="false">\n        </div>\n    </div>\n    <div class="init action">\n        <button class="btn btn-blue do-action" data-action="create" disabled>Create</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Creating...</button>\n    </div>\n    <div class="download action" style="display:none;">\n        <a class="btn btn-blue do-action pulse" data-action="download" id="download-kp">Download</a>\n        <button class="btn btn-silver cancel" disabled>Close</button>\n    </div>\n</div>',s},n.slide_create=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+="SNS Topic "+a((r=e&&e.selecteKeyName,typeof r===u?r.apply(e):r)),n}function c(e,t){var n="",r;return n+="selected "+a((r=e&&e.selectedCount,typeof r===u?r.apply(e):r))+" SNS Topics",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">Confirm to delete ',o=n["if"].call(t,t&&t.selecteKeyName,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+=' and all associated subscriptions?</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">Delete</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Deleting...</button>\n    </div>\n</div>',s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n        <tr>\n            <td>"+a((i=e&&e.Protocol,typeof i===u?i.apply(e):i))+"</td>\n            <td>"+a((i=e&&e.Endpoint,typeof i===u?i.apply(e):i))+"</td>\n            <td>"+a((i=e&&e.SubscriptionArn,typeof i===u?i.apply(e):i))+"</td>\n            <td>\n                ",i=n["if"].call(e,e&&e.isRemovable,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n            </td>\n        </tr>\n        ",r}function c(e,t){var n="",r;return n+='\n                    <a class="icon-delete remove"></a>\n                    <div class="do-remove-panel">\n                        <button class="btn btn-blue btn-small do-remove" data-id="'+a((r=e&&e.SubscriptionArn,typeof r===u?r.apply(e):r))+'">Delete</button>\n                        <button class="btn btn-link btn-small cancel">Cancel</button>\n                    </div>\n                ',n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table sns-detail">\n    <thead>\n        <tr>\n            <th style="width: 48px;">Protocol</th>\n            <th>Endpoint</th>\n            <th style="wdith: 30%;">Subscription ARN</th>\n            <th style="width: 103px;"></th>\n        </tr>\n    </thead>\n    <tbody>\n        ',o=n.each.call(t,t,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n    </tbody>\n</table>",s},n.detail=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="combo-dd-no-data">\n    <p>No SNS Topic in '+a((o=t&&t.regionName,typeof o===u?o.apply(t):o))+'.</p>\n    <a class="create-one">Create SNS Topic</a>\n</div>',s},n.nosns=e.template(t),n}),function(){define("sns_manage",["constant","CloudResources","toolbar_modal","./component/sns/snsTpl","i18n!/nls/lang.js"],function(e,t,n,r,i){return Backbone.View.extend({tagName:"section",initCol:function(){var n;return n=Design.instance().region(),this.subCol=t(e.RESTYPE.SUBSCRIPTION,n),this.topicCol=t(e.RESTYPE.TOPIC,n),this.topicCol.on("update",this.processCol,this),this.subCol.on("update",this.processSubUpdate,this)},processSubUpdate:function(){if(!this.M$(".tr-detail").length)return this.processCol()},processSubCreate:function(e){var t,n;return n=e.get("TopicArn"),t=this,this.M$(".detailed").each(function(){if($(this).data("topicArn")===n)return t.detail(null,$(this).data(),$(this)),!1})},quickCreate:function(){return this.modal.triggerSlide("create")},getModalOptions:function(){var t,n,r;return r=this,t=Design.instance().get("region"),n=e.REGION_SHORT_LABEL[t],{title:"Manage SNS in "+n,classList:"sns-manage",context:r,buttons:[{icon:"new-stack",type:"create",name:"Create Subscription"},{icon:"del",type:"delete",disabled:!0,name:"Delete"},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"25%",name:"Topic"},{sortable:!0,name:"Topic ARN"},{sortable:!1,width:"20%",name:"Subscription"}]}},initModal:function(){return new n(this.getModalOptions()),this.modal.on("close",function(){return this.remove()},this),this.modal.on("slidedown",this.renderSlides,this),this.modal.on("action",this.doAction,this),this.modal.on("refresh",this.refresh,this),this.modal.on("detail",this.detail,this)},detail:function(e,t,n){var i,s;return s=this.getSubs(t.topicArn),t=_.map(s,function(e){var t;return t=e.toJSON(),t.isRemovable=e.isRemovable(),t}),i=this.modal.setDetail(n,r.detail(t)),this.processDetail(i,n)},processDetail:function(e,t){var n;return n=this,e.on("click",".remove",function(){return $(this).hide(),e.find(".do-remove-panel").show()}).on("click",".cancel",function(){return $(this).closest(".do-remove-panel").hide(),e.find(".remove").show()}).on("click",".do-remove",function(){var r;return r=$(this),n.removeSub(r.data("id")).then(function(){var n;r.closest("tr").remove(),n=e.find(".sns-detail tbody tr").length,t.find(".show-detail b").text(n);if(n===0)return t.find(".show-detail").click()})})},removeSub:function(e){var t;return t=this.subCol.findWhere({SubscriptionArn:e}),t!=null?t.destroy().then(function(e){return notification("info","Remove Subscription Succeed."),e}).fail(function(e){throw notification("error",e.awsResult),e}):void 0},fetch:function(){if(App.user.hasCredential())return this.topicCol.fetch(),this.subCol.fetch()},initialize:function(){return this.initCol(),this.initModal(),this.fetch()},doAction:function(e,t){return this[e]&&this[e](this.validate(e),t)},validate:function(e){switch(e){case"create":return!this.M$("#create-topic-name").parsley("validateForm")}},genDeleteFinish:function(e){var t,n,r,i;return r=[],t=[],i=this,n=_.after(e,function(){return i.modal.cancel(),r.length===1?notification("info",""+r[0].get("Name")+" is deleted."):r.length>1&&notification("info","Selected "+r.length+" SNS topic are deleted."),t.length||i.modal.unCheckSelectAll(),_.each(t,function(e){return void 0})}),function(e){return e instanceof Backbone.Model?r.push(e):t.push(e),n()}},errorHandler:function(e){return this.modal.error(e.awsResult)},create:function(e){var t,n,r,i,s,o,u,a;return e?!1:(s=this,this.switchAction("processing"),o=this.M$(".dd-topic-name .selected").data("id"),i=this.M$(".dd-protocol .selected ").data("id"),a=this.M$("#create-topic-name").val(),n=this.M$("#create-display-name").val(),r=this.M$("#create-endpoint").val(),t=function(e){return s.subCol.create({TopicArn:e&&e.id||o,Endpoint:r,Protocol:i}).save().then(function(e){return s.processSubCreate(e),notification("info","Create Subscription Succeed"),s.modal.cancel()}).fail(function(e){return s.errorHandler(e)})},o==="@new"?this.topicCol.create({Name:a,DisplayName:n}).save().then(t).fail(function(e){return s.errorHandler(e)}):(u=this.topicCol.get(o),n===u.get("DisplayName")?t():u.update(n).then(t)))},"delete":function(e,t){var n,r,i;return n=t.length,i=this,r=this.genDeleteFinish(n),this.switchAction("processing"),_.each(t,function(e){var t;return t=i.topicCol.get(e.data.id),t!=null?t.destroy().then(r,r):void 0})},refresh:function(){return this.subCol.fetchForce(),this.topicCol.fetchForce()},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return $(this).hasClass(e)?$(this).show():$(this).hide()})},render:function(){return this.modal.render(),App.user.hasCredential()?this.processCol():this.modal.render("nocredential"),this},processCol:function(e){var t,n;return n=this,this.topicCol.isReady()&&this.subCol.isReady()&&(t=this.topicCol.map(function(e){var t,r;return r=e.toJSON(),t=n.subCol.where({TopicArn:r.id}),r.sub=t.map(function(e){return e.toJSON()}),r.subCount=r.sub.length,r}),e||this.renderList(t)),t},getSubs:function(e){return this.subCol.where({TopicArn:e})},renderList:function(e){return this.modal.setContent(r.modal_list(e))},renderNoCredential:function(){return this.modal.render("nocredential").toggleControls(!1)},renderSlides:function(e,t){var n,i,s;return i=r["slide_"+e],n=this.getSlides(),(s=n[e])!=null?s.call(this,i,t):void 0},getSlides:function(){var e,t;return t=this,e=this.modal,{create:function(n,r){var s,o,u,a;return e.setSlide(n(this.processCol(!0))),u=function(e){var n,r,s,o,u;o=t.M$(".dd-protocol .selected").data("id");switch(o){case"sqs":s=i.ide.PROP_STACK_AMAZON_ARN,u=i.ide.PROP_STACK_SQS,r=i.ide.PARSLEY_PLEASE_PROVIDE_A_VALID_AMAZON_SQS_ARN;break;case"arn":s=i.ide.PROP_STACK_AMAZON_ARN,u=i.ide.PROP_STACK_ARN,r=i.ide.PARSLEY_PLEASE_PROVIDE_A_VALID_APPLICATION_ARN;break;case"email":s=i.ide.PROP_STACK_EXAMPLE_EMAIL,u=i.ide.PROP_STACK_EMAIL,r=i.ide.HEAD_MSG_ERR_UPDATE_EMAIL3;break;case"email-json":s=i.ide.PROP_STACK_EXAMPLE_EMAIL,u=i.ide.PROP_STACK_EMAIL,r=i.ide.HEAD_MSG_ERR_UPDATE_EMAIL3;break;case"sms":s=i.ide.PROP_STACK_E_G_1_206_555_6423,u=i.ide.PROP_STACK_USPHONE,r=i.ide.PARSLEY_PLEASE_PROVIDE_A_VALID_PHONE_NUMBER;break;case"http":s=i.ide.PROP_STACK_HTTP_WWW_EXAMPLE_COM,u=i.ide.PROP_STACK_HTTP,r=i.ide.PARSLEY_PLEASE_PROVIDE_A_VALID_URL;break;case"https":s=i.ide.PROP_STACK_HTTPS_WWW_EXAMPLE_COM,u=i.ide.PROP_STACK_HTTPS,r=i.ide.PARSLEY_PLEASE_PROVIDE_A_VALID_URL}return n=t.M$("#create-endpoint"),n.attr("placeholder",s),n.parsley("custom",function(e){if(u&&e&&!MC.validate(u,e))return r}),null},u("email"),t.M$("#create-display-name").parsley("custom",function(e){var n;return n=t.M$(".dd-protocol .selected").data("id"),n==="sms"&&!e?"Display Name is required if subscription uses SMS protocol.":null}),t.M$("#create-topic-name").parsley("custom",function(e){return t.topicCol.where({Name:e}).length?"Topic name is already taken.":null}),s=t.M$(".slide-create input[type=text]"),a=function(){var e;return e=!0,s.each(function(){var n;if(this.id==="create-display-name"){n=t.M$(".dd-protocol .selected").data("id");if(n==="sms"&&!this.value.trim().length)return e=!1}else if(!this.value.trim().length)return e=!1}),e},o=function(e,n){var r;return r=e&&$(e.currentTarget)||$("#create-topic-name"),a()?t.M$(".slide-create .do-action").prop("disabled",!1):t.M$(".slide-create .do-action").prop("disabled",!0)},s.on("keyup",o),t.M$(".dd-protocol").off("OPTION_CHANGE").on("OPTION_CHANGE",function(e){return u(e),o(null,!0)}),t.M$(".dd-topic-name").off("OPTION_CHANGE").on("OPTION_CHANGE",function(e,n,r){return n==="@new"?t.M$(".create-sns-topic").show():(t.M$("#create-display-name").val(r.displayName),t.M$(".create-sns-topic").hide())})},"delete":function(t,n){var r,i;r=n.length;if(!r)return;return i={},r===1?i.selecteKeyName=n[0].data.name:i.selectedCount=r,e.setSlide(t(i))},"import":function(n,r){return e.setSlide(n),t.__upload&&t.__upload.remove(),t.__upload=new upload,t.__upload.on("load",t.afterImport,this),t.M$(".import-zone").html(t.__upload.render().el)}}},show:function(){return App.user.hasCredential()?(this.topicCol.fetch(),this.subCol.fetch(),this.processCol()):this.renderNoCredential()},filter:function(e){return this.processCol(!0,e)}})})}.call(this),function(){define("sns_dropdown",["constant","CloudResources","sns_manage","combo_dropdown","./component/sns/snsTpl","i18n!/nls/lang.js"],function(e,t,n,r,i,s){var o,u;return o=t(e.RESTYPE.SUBSCRIPTION,"us-east-1"),u=t(e.RESTYPE.TOPIC,"us-east-1"),Backbone.View.extend({tagName:"section",initCol:function(){var n;return n=Design.instance().region(),this.subCol=t(e.RESTYPE.SUBSCRIPTION,n),this.topicCol=t(e.RESTYPE.TOPIC,n),this.listenTo(this.topicCol,"update",this.processCol),this.listenTo(this.topicCol,"change",this.processCol),this.listenTo(this.subCol,"update",this.processCol)},initDropdown:function(){var e;return e={manageBtnValue:s.ide.PROP_INSTANCE_MANAGE_SNS,filterPlaceHolder:s.ide.PROP_INSTANCE_FILTER_SNS,classList:"sns-dropdown"},this.dropdown=new r(e),this.dropdown.on("open",this.show,this),this.dropdown.on("manage",this.manage,this),this.dropdown.on("change",this.set,this),this.dropdown.on("filter",this.filter,this),this.dropdown.on("quick_create",this.quickCreate,this)},initialize:function(e){e&&e.selection&&(this.selection=e.selection),this.initCol(),this.initDropdown();if(App.user.hasCredential())return this.topicCol.fetch(),this.subCol.fetch()},render:function(e){var t;return t=this.selection,e?this.topicCol.first()?(this.selection=t=this.topicCol.first().get("Name"),this.processCol(),this.trigger("change",this.topicCol.first().id,t)):t=i.dropdown_no_selection():t||(t=i.dropdown_no_selection()),this.dropdown.setSelection(t),this.el=this.dropdown.el,this},quickCreate:function(){return(new n).render().quickCreate()},processCol:function(e,t){var n,r,i,s;return s=this,this.topicCol.isReady()&&this.subCol.isReady()&&(n=this.topicCol.map(function(e){var t,n;return n=e.toJSON(),t=s.subCol.where({TopicArn:n.id}),n.sub=t.map(function(e){return e.toJSON()}),n.subCount=n.sub.length,n}),e&&(r=t.length,n=_.filter(n,function(e){return e.Name.toLowerCase().indexOf(t.toLowerCase())!==-1})),i=this.selection,_.each(n,function(e){if(e.Name&&e.Name===i)return e.selected=!0,null}),this.renderDropdownList(n)),!1},renderDropdownList:function(t){var n,r;return _.isEmpty(t)?(n=Design.instance().region(),r=e.REGION_SHORT_LABEL[n],this.dropdown.setContent(i.nosns({regionName:r})).toggleControls(!0,"manage").toggleControls(!1,"filter")):this.dropdown.setContent(i.dropdown_list(t)).toggleControls(!0)},renderNoCredential:function(){return this.dropdown.render("nocredential").toggleControls(!1)},show:function(){if(!App.user.hasCredential())return this.renderNoCredential();this.topicCol.fetch(),this.subCol.fetch();if(!this.dropdown.$(".item").length)return this.processCol()},manage:function(){return(new n).render()},set:function(e,t){return this.trigger("change",e,t.name)},filter:function(e){return this.processCol(!0,e)},remove:function(){return this.dropdown.remove(),Backbone.View.prototype.remove.apply(this,arguments)}})})}.call(this),define("component/dhcp/dhcp_template",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var r="";return r+="\n    "+o(n.i18n.call(e,"PROP_VPC_AUTO_DHCP",{hash:{},data:t}))+'<i class="icon-info tooltip" data-tooltip=\''+o(n.i18n.call(e,"PROP_VPC_TIP_AUTO_DHCP",{hash:{},data:t}))+"'></i>\n",r}function l(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,e&&e.isDefault,{hash:{},inverse:a.program(6,h,t),fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){var r="";return r+="\n        "+o(n.i18n.call(e,"PROP_VPC_DEFAULT_DHCP",{hash:{},data:t}))+' <i class="icon-info tooltip" data-tooltip="'+o(n.i18n.call(e,"PROP_VPC_TIP_DEFAULT_DHCP",{hash:{},data:t}))+'"></i>\n    ',r}function h(e,t){var n="",r;return n+="\n        "+o((r=e&&e.id,typeof r===u?r.apply(e):r))+"\n    ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u="function",a=this;return s=n["if"].call(t,t&&t.isAuto,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.selection=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<tr class="item" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'">\n    <td>\n        <div class="checkbox">\n            <input id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" type="checkbox" value="None" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" class="one-cb">\n            <label for="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'"></label>\n        </div>\n    </td>\n    <td><div class="manager-content-main"></div>'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+"</td>\n    <td>",i=n["if"].call(e,(i=e&&e["domain-name"],i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,(i=e&&e["domain-name-servers"],i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(5,h,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,(i=e&&e["ntp-servers"],i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(7,p,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,(i=e&&e["netbios-name-servers"],i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(9,d,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e&&e["netbios-node-type"],{hash:{},inverse:a.noop,fn:a.program(11,v,t),data:t});if(i||i===0)r+=i;return r+='</td>\n    <td class="show-detail icon-toolbar-cloudformation"></td>\n</tr>\n',r}function l(e,t){var r="",i;r+="domain-name = ",i=n.each.call(e,e&&e["domain-name"],{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;return r+=";",r}function c(e,t){var n="";return n+=u(typeof e===o?e.apply(e):e)+" ",n}function h(e,t){var r="",i;r+="domain-name-servers = ",i=n.each.call(e,e&&e["domain-name-servers"],{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;return r+=";",r}function p(e,t){var r="",i;r+="ntp-servers = ",i=n.each.call(e,e&&e["ntp-servers"],{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;return r+=";",r}function d(e,t){var r="",i;r+="netbios-name-servers = ",i=n.each.call(e,e&&e["netbios-name-servers"],{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;return r+=";",r}function v(e,t){var n="",r;return n+="netbios-node-type = "+u((r=e&&e["netbios-node-type"],typeof r===o?r.apply(e):r)),n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.items,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.content=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n",i=n.unless.call(e,e&&e.isRunTime,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;r+='\n<li data-id="@default" class="item',i=n["if"].call(e,e&&e["default"],{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" tabindex="-1">\n    '+a(n.i18n.call(e,"PROP_VPC_DEFAULT_DHCP",{hash:{},data:t}))+'\n    <i class="icon-info tooltip" data-tooltip="'+a(n.i18n.call(e,"PROP_VPC_TIP_DEFAULT_DHCP",{hash:{},data:t}))+'"></i>\n</li>\n',r}function c(e,t){var r="",i;r+='\n<li data-id="@auto" class="item',i=n["if"].call(e,e&&e.auto,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" tabindex="-1">\n    '+a(n.i18n.call(e,"PROP_VPC_AUTO_DHCP",{hash:{},data:t}))+'\n    <i class="icon-info tooltip" data-tooltip=\''+a(n.i18n.call(e,"PROP_VPC_TIP_AUTO_DHCP",{hash:{},data:t}))+"'></i>\n</li>\n",r}function h(e,t){return" selected"}function p(e,t){var r="",i;r+='\n<li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+a((i=e&&e.id,typeof i===f?i.apply(e):i))+'" tabindex="-1">'+a((i=e&&e.id,typeof i===f?i.apply(e):i))+"</li>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a=this.escapeExpression,f="function";o=n.unless.call(t,t&&t.hideDefaultNoKey,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n.each.call(t,t&&t.keys,{hash:{},inverse:u.noop,fn:u.program(5,p,i),data:i});if(o||o===0)s+=o;return s},n.keys=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n;return a((n=e&&e.selectedId,typeof n===u?n.apply(e):n))}function c(e,t){var n="",r;return n+="selected "+a((r=e&&e.selectedCount,typeof r===u?r.apply(e):r))+" DHCP Options set",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">Confirm to delete ',o=n["if"].call(t,t&&t.selectedId,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='?</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">Delete</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Deleting...</button>\n    </div>\n</div>',s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){function l(e,t){return'checked="checked"'}function c(e,t){return"3"}function h(e,t){return"4"}function p(e,t){var r="";return r+='\n                        <div class="multi-ipt-row">\n                            <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                            <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_DNS",{hash:{},data:t}))+'" value="'+u(typeof e===a?e.apply(e):e)+'" type="text" maxlength="255" placeholder="'+u(n.i18n.call(e,"PROP_VPC_TIP_EG_172_16_16_16",{hash:{},data:t}))+'" data-type="ipv4" data-ignore="true"></span>\n                        </div>\n                        ',r}function d(e,t){var r="";return r+='\n                        <div class="multi-ipt-row">\n                            <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                            <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_DNS",{hash:{},data:t}))+'"  placeholder="'+u(n.i18n.call(e,"PROP_VPC_TIP_EG_172_16_16_16",{hash:{},data:t}))+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n                        </div>\n                        ',r}function v(e,t){var r="";return r+='\n                    <div class="multi-ipt-row">\n                        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                        <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_NTP",{hash:{},data:t}))+'" value="'+u(typeof e===a?e.apply(e):e)+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n                    </div>\n                    ',r}function m(e,t){var r="";return r+='\n                    <div class="multi-ipt-row">\n                        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                        <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_NTP",{hash:{},data:t}))+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n                    </div>\n                    ',r}function g(e,t){var r="";return r+='\n                    <div class="multi-ipt-row">\n                        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                        <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_NETBIOS",{hash:{},data:t}))+'" value="'+u(typeof e===a?e.apply(e):e)+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n                    </div>\n                    ',r}function y(e,t){var r="";return r+='\n                    <div class="multi-ipt-row">\n                        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                        <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_NETBIOS",{hash:{},data:t}))+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n                    </div>\n                    ',r}function b(e,t){var r;return r=n.i18n.call(e,"PROP_VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE_NOT_SPECIFIED",{hash:{},data:t}),r||r===0?r:""}function w(e,t){var r="",i;r+='\n                        <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:f.noop,fn:f.program(22,E,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+u((i=e&&e.id,typeof i===a?i.apply(e):i))+'">'+u((i=e&&e.value,typeof i===a?i.apply(e):i))+"</li>\n                        ",r}function E(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<div class="slide-create" data-bind="true">\n    <div class="formart_toolbar_modal" data-type="true">\n        <section data-bind="true">\n            <div class="control-group clearfix">\n                <label for="property-dhcp-domain">'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME",{hash:{},data:i}))+'</label>\n                <div id="property-dhcp-domain" class="multi-input" data-max-row="100">\n                    <div class="multi-ipt-row">\n                        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                        <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP_VPC_TIP_ENTER_THE_DOMAIN_NAME",{hash:{},data:i}))+'" type="text" maxlength="255" data-type="domain" data-ignore="true"></span>\n                    </div>\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label>'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME_SERVER",{hash:{},data:i}))+'</label>\n                <div>\n                    <div class="modal-right" style="margin: 10px 0">\n                        <div class="checkbox">\n                            <input id="property-amazon-dns" ',o=n["if"].call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.amazonDNS),{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='type="checkbox">\n                            <label style="width: 14px" for="property-amazon-dns"></label>\n                        </div>\n                        <label for="property-amazon-dns">'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_AMZN_PROVIDED_DNS",{hash:{},data:i}))+'</label>\n                    </div>\n                    <div id="property-domain-server" class="multi-input" data-max-row="',o=n["if"].call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.amazonDNS),{hash:{},inverse:f.program(5,h,i),fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='">\n                        ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.domainServers),{hash:{},inverse:f.program(9,d,i),fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+='\n                    </div>\n                </div>\n            </div>\n\n            <div class="control-group clearfix">\n                <label>'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_NTP_SERVER",{hash:{},data:i}))+'</label>\n                <div id="property-ntp-server" class="multi-input" data-max-row="4">\n                    ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.ntpServers),{hash:{},inverse:f.program(13,m,i),fn:f.program(11,v,i),data:i});if(o||o===0)s+=o;s+='\n                </div>\n            </div>\n\n            <div class="control-group clearfix">\n                <label>'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_NETBIOS_NAME_SERVER",{hash:{},data:i}))+'</label>\n                <div id="property-netbios-server" class="multi-input" data-max-row="4">\n                    ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.netbiosServers),{hash:{},inverse:f.program(17,y,i),fn:f.program(15,g,i),data:i});if(o||o===0)s+=o;s+='\n                </div>\n            </div>\n\n            <div class="control-group clearfix">\n                <label>'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE",{hash:{},data:i}))+'</label>\n                <div class="selectbox selectbox-mega" id="property-netbios-type">\n                    <div class="selection tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP_VPC_TIP_SELECT_NETBIOS_NODE",{hash:{},data:i}))+'">',o=n.unless.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.netbiosType),{hash:{},inverse:f.noop,fn:f.program(19,b,i),data:i});if(o||o===0)s+=o;s+='</div>\n                    <ul class="dropdown" tabindex="-1">\n                        ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.netbiosTypes),{hash:{},inverse:f.noop,fn:f.program(21,w,i),data:i});if(o||o===0)s+=o;return s+='\n                    </ul>\n                </div>\n            </div>\n\n        </section>\n        <div class="init action">\n            <button class="btn btn-blue do-action" data-action="create">Create</button>\n            <button class="btn btn-silver cancel">Cancel</button>\n        </div>\n        <div class="processing action" style="display:none;">\n            <button class="btn" disabled>Creating...</button>\n        </div>\n    </div>\n</div>',s},n.slide_create=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="";return n+=a(typeof e===u?e.apply(e):e)+"<br>",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="detail-info">\n    <div class="detail-info-row">\n        <section class="property-control-group">\n            <label>Domain Name</label>\n            <div>',o=n.each.call(t,t&&t["domain-name"],{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='</div>\n        </section>\n        <section class="property-control-group">\n            <label>Domain Name Server</label>\n            <div>',o=n.each.call(t,t&&t["domain-name-servers"],{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='</div>\n        </section>\n    </div>\n    <div class="detail-info-row">\n        <section class="property-control-group">\n            <label>NTP Server</label>\n            <div>',o=n.each.call(t,t&&t["ntp-servers"],{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='</div>\n        </section>\n        <section class="property-control-group">\n\n            <label>NetBIOS Node Type</label>\n            <div>'+a((o=t&&t["netbios-node-type"],typeof o===u?o.apply(t):o))+"</div>\n        </section>\n    </div>\n</div>",s},n.detail_info=e.template(t),n}),function(){define("dhcp",["CloudResources","constant","combo_dropdown","UI.modalplus","toolbar_modal","i18n!/nls/lang.js","component/dhcp/dhcp_template"],function(e,t,n,r,i,s,o){var u,a,f,l,c,h,p,d;return l=!1,c=!1,p={},d=function(){var e;return e=$("#property-domain-server").children().length,e>3?$("#property-amazon-dns").attr("disabled",!0):$("#property-amazon-dns").removeAttr("disabled")},h=function(e){var t,n,r,i,s;t=$(e),r=[];for(i=0,s=t.length;i<s;i++)n=t[i],n.value&&r.push(n.value);return r},u=0,a=0,f=Backbone.View.extend({constructor:function(r){var i,u;return this.resModel=r!=null?r.resModel:void 0,this.collection=e(t.RESTYPE.DHCP,Design.instance().region()),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"update",this.render),this.listenTo(this.collection,"change",function(){return this.renderManager()}),this.listenTo(this.collection,"update",function(){return this.renderManager()}),i={manageBtnValue:s.ide.PROP_VPC_MANAGE_DHCP,filterPlaceHolder:s.ide.PROP_VPC_FILTER_DHCP},this.dropdown=new n(i),u=o.selection({isDefault:!1,isAuto:!0}),this.dropdown.setSelection(u),this.dropdown.on("open",this.show,this),this.dropdown.on("manage",this.manageDhcp,this),this.dropdown.on("change",this.setDHCP,this),this.dropdown.on("filter",this.filter,this),this},remove:function(){return this.isRemoved=!0,Backbone.View.prototype.remove.call(this)},render:function(){return l?this.renderDropdown():(this.renderLoading(),this.collection.fetch().then(function(e){return function(){return e.render()}}(this)),l=!0,!1)},show:function(){return App.user.hasCredential()?this.render():this.renderNoCredential()},renderNoCredential:function(){return this.dropdown.render("nocredential").toggleControls(!1)},renderLoading:function(){return this.dropdown.render("loading").toggleControls(!1)},renderDropdown:function(e){var t,n,r,i,s;i=(s=this.resModel)!=null?s.toJSON().dhcp.appId:void 0,n=this.collection.toJSON(),r={isRuntime:!1,keys:n},i?_.each(n,function(e){e.id===i&&(e.selected=!0)}):r.auto=!0,i===""?r.auto=!0:i&&i==="default"&&(r["default"]=!0),e&&(r.keys=e,r.hideDefaultNoKey=!0);if(Design.instance().modeIsApp()||Design.instance().modeIsAppEdit())r.isRunTime=!0;return t=o.keys(r),this.dropdown.toggleControls(!0),this.dropdown.setContent(t)},filter:function(e){var t;return t=_.filter(this.collection.toJSON(),function(t){return t.id.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.renderDropdown(t):this.renderDropdown()},setDHCP:function(e){var t,n;return e==="@auto"?t={id:""}:e==="@default"?t={id:"default"}:(n=this.collection.findWhere({id:e}),t=n.toJSON()),this.resModel.toJSON().dhcp.dhcpOptionsId=t.id,this.trigger("change",t)},setSelection:function(e){var t;return t=o.selection(e),this.dropdown.setSelection(t)},manageDhcp:function(){return this.manager=new i(this.getModalOptions()),this.manager.on("refresh",this.refreshManager,this),this.manager.on("slidedown",this.renderSlides,this),this.manager.on("action",this.doAction,this),this.manager.on("detail",this.detail,this),this.manager.on("close",function(e){return function(){return e.manager.remove()}}(this)),this.manager.render(),this.renderManager(),this.trigger("manage")},refreshManager:function(){return l=!1,this.renderManager()},renderManager:function(){var e,t,n;if(!App.user.hasCredential())return(n=this.manager)!=null&&n.render("nocredential"),!1;t=this.initManager.bind(this),e=Design.instance().get("region");if(!l&&!c||!p[e])return c=!0,p[e]=!0,this.collection.fetchForce().then(t,t);if(!c)return t()},initManager:function(){var e,t;return c=!1,l=!0,e=o.content({items:this.collection.toJSON()}),(t=this.manager)!=null?t.setContent(e):void 0},renderSlides:function(e,t){var n,r,i;return r=o["slide_"+e],n=this.getSlides(),(i=n[e])!=null?i.call(this,r,t):void 0},detail:function(e,t,n){var r,i,s,u;return u=this,s=t.id,i=this.collection.get(s).toJSON(),r=o.detail_info,this.manager.setDetail(n,r(i))},getSlides:function(){return{"delete":function(e,t){var n,r;n=t.length;if(!n)return;return r={},n===1?r.selectedId=t[0].data.id:r.selectedCount=n,this.manager.setSlide(e(r))},create:function(e){var t,n;return t={dhcp:{}},n=0,t.dhcp.netbiosTypes=[{id:"default",value:s.ide.PROP_VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE_NOT_SPECIFIED,selected:n===0},{id:1,value:1,selected:n===1},{id:2,value:2,selected:n===2},{id:4,value:4,selected:n===4},{id:8,value:8,selected:n===8}],this.manager.setSlide(e(t)),this.manager.$el.find("#property-amazon-dns").change(function(e){return function(t){return e.onChangeAmazonDns(t)}}(this)),this.manager.$el.find(".multi-input").on("ADD_ROW",function(e){return function(t){return e.processParsley(t)}}(this)),this.manager.$el.find(".control-group .input").change(function(e){return function(t){return e.onChangeDhcpOptions(t)}}(this)),this.manager.$el.find(".formart_toolbar_modal").on("OPTION_CHANGE REMOVE_ROW",function(e){return function(t){return e.onChangeDhcpOptions(t)}}(this)),this.manager.$el.find("#property-domain-server").on("ADD_ROW REMOVE_ROW",d),d()}}},processParsley:function(e){return $(e.currentTarget).find("input").last().removeClass("parsley-validated").removeClass("parsley-error").next(".parsley-error-list").remove(),$(".parsley-error-list").remove()},doAction:function(e,t){return this[e]&&this[e](this.validate(e),t)},create:function(e,t){var n,r,i,s;if(!e)return i=h("#property-domain-server .input"),$("#property-amazon-dns").is(":checked")&&i.push("AmazonProvidedDNS"),r={"domain-name":h("#property-dhcp-domain .input"),"domain-name-servers":i,"ntp-servers":h("#property-ntp-server .input"),"netbios-name-servers":h("#property-netbios-server .input"),"netbios-node-type":[parseInt($("#property-netbios-type .selection").html(),10)||0]},s=function(e,t){return t==="netbios-node-type"?!1:e.length<1?!1:!0},_.some(r,s)?(r["netbios-node-type"][0]===0&&(r["netbios-node-type"]=[]),this.switchAction("processing"),n=this.afterCreated.bind(this),this.collection.create(r).save().then(n,n)):(this.manager.error("Please provide at least one field."),!1)},"delete":function(e,t){var n,r;return r=this,u+=t.length,this.switchAction("processing"),n=r.afterDeleted.bind(r),_.each(t,function(e){return function(t){return e.collection.findWhere({id:t.data.id}).destroy().then(n,n)}}(this))},afterDeleted:function(e){u--,e.error&&a++;if(u===0)return a>0?notification("error",a+(' DhcpOptions failed to delete because of: "'+e.awsResult+'"')):notification("info","Delete Successfully"),this.manager.unCheckSelectAll(),a=0,this.manager.cancel()},afterCreated:function(e){return e.error?(this.manager.error("Create failed because of: "+(e.awsResult||e.msg)),this.switchAction(),!1):(notification("info","New DHCP Option is created successfully"),this.manager.cancel())},validate:function(e){switch(e){case"create":return this.manager.$el.find(".parsley-error").size()>0}},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return $(this).hasClass(e)?$(this).show():$(this).hide()})},onChangeAmazonDns:function(){var e,t,n,r;return r=$("#property-amazon-dns").is(":checked"),n=r?3:4,e=$("#property-domain-server").attr("data-max-row",n),t=e.children(),e.toggleClass("max",t.length>=n),null},onChangeDhcpOptions:function(e){e&&!$(e.currentTarget).closest("[data-bind=true]").parsley("validate")},getModalOptions:function(){var e,n,r;return r=this,e=Design.instance().get("region"),n=t.REGION_SHORT_LABEL[e],{title:"Manage DHCP Options in "+n,slideable:!0,context:r,buttons:[{icon:"new-stack",type:"create",name:"Create DHCP Options Set"},{icon:"del",type:"delete",disabled:!0,name:"Delete"},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"200px",name:"Name"},{sortable:!1,width:"480px",name:"Options"},{sortable:!1,width:"56px",name:"Details"}]}}}),f})}.call(this),define("component/snapshot/snapshot_template",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+='" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" tabindex="-1">\n    ',i=n["if"].call(e,e&&e.id,{hash:{},inverse:a.program(13,m,t),fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;return r+="\n</li>\n",r}function l(e,t){return" selected"}function c(e,t){var r="",i;r+='\n    <div class="manager-content-main" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'">',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:a.program(7,p,t),fn:a.program(5,h,t),data:t});if(i||i===0)r+=i;r+='</div>\n    <div class="manager-content-sub">',i=n["if"].call(e,e&&e.id,{hash:{},inverse:a.program(11,v,t),fn:a.program(9,d,t),data:t});if(i||i===0)r+=i;return r+=" &nbsp;&nbsp;&nbsp;&nbsp;Size: "+u((i=e&&e.size,typeof i===o?i.apply(e):i))+" GiB</div>\n    ",r}function h(e,t){var n;return u((n=(n=e&&e.tagSet,n==null||n===!1?n:n.Name),typeof n===o?n.apply(e):n))}function p(e,t){return"&lt;No Name&gt;"}function d(e,t){var n;return u((n=e&&e.id,typeof n===o?n.apply(e):n))}function v(e,t){var n;return u((n=e&&e.name,typeof n===o?n.apply(e):n))}function m(e,t){var n="",r;return n+='\n    <div class="manager-content-main" data-id="'+u((r=e&&e.region,typeof r===o?r.apply(e):r))+'">'+u((r=e&&e.name,typeof r===o?r.apply(e):r))+"</div>\n    ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.data,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.keys=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<tr class="item" data-id="">\n    <td>\n        <div class="checkbox">\n            <input id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" type="checkbox" value="None" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" data-name="'+u((i=e&&e.name,typeof i===o?i.apply(e):i))+'" class="one-cb">\n            <label for="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'"></label>\n        </div>\n    </td>\n    <td><div class="manager-content-main">',i=n["if"].call(e,e&&e.name,{hash:{},inverse:a.program(4,c,t),fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+='</div><span class="manager-content-sub">'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+"</span></td>\n    <td>"+u((i=e&&e.volumeSize,typeof i===o?i.apply(e):i))+' GiB</td>\n    <td>\n        <div class="manager-content-main">',i=n["if"].call(e,e&&e.completed,{hash:{},inverse:a.program(8,p,t),fn:a.program(6,h,t),data:t});if(i||i===0)r+=i;return r+='</div>\n        <span class="manager-content-sub">Started: '+u((i=e&&e.started,typeof i===o?i.apply(e):i))+"</span>\n    </td>\n    <td>"+u((i=e&&e.description,typeof i===o?i.apply(e):i))+"</td>\n</tr>\n",r}function l(e,t){var n;return u((n=e&&e.name,typeof n===o?n.apply(e):n))}function c(e,t){return"&lt;No Name&gt;"}function h(e,t){return'<i class="status status-green icon-label"></i> Completed'}function p(e,t){var n="",r;return n+='<i class="status status-yellow icon-label"></i> Pending - '+u((r=e&&e.progress,typeof r===o?r.apply(e):r))+"%",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.items,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.content=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n;return a((n=e&&e.selectedId,typeof n===u?n.apply(e):n))}function c(e,t){var n="",r;return n+="selected "+a((r=e&&e.selectedCount,typeof r===u?r.apply(e):r))+" Snapshot ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">Confirm to delete ',o=n["if"].call(t,t&&t.selectedId,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='?</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">Delete</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Deleting...</button>\n    </div>\n</div>',s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="slide-create" data-bind="true">\n    <div class="formart_toolbar_modal" data-type="true">\n        <section data-bind="true">\n            <div class="control-group clearfix">\n                <label for="property-snapshot-name-create">'+o(n.i18n.call(t,"PROP_SNAPSHOT_SET_NAME",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id="property-snapshot-name-create" class="input" type="text" maxlength="255" data-type="domain" data-ignore="true" placeholder="Allow alpha number, _ or - up to 255 characters.">\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-volume-choose">'+o(n.i18n.call(t,"PROP_SNAPSHOT_SET_VOLUME",{hash:{},data:i}))+'</label>\n                <div>\n                    <div id="property-volume-choose"></div>\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-snapshot-desc-create">'+o(n.i18n.call(t,"PROP_SNAPSHOT_SET_DESC",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id=\'property-snapshot-desc-create\' class="input" placeholder="Up to 255 characters" type="text"/>\n                </div>\n            </div>\n\n        </section>\n        <div class="init action">\n            <button class="btn btn-blue do-action" data-action="create" disabled>Create</button>\n            <button class="btn btn-silver cancel">Cancel</button>\n        </div>\n        <div class="processing action" style="display:none;">\n            <button class="btn" disabled>Creating...</button>\n        </div>\n    </div>\n</div>',s},n.slide_create=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+='<div class="slide-duplicate" data-bind="true">\n    <div class="formart_toolbar_modal" data-type="true">\n        <section data-bind="true">\n            <div class="control-group clearfix">\n                <label for="property-snapshot-source">'+u(n.i18n.call(t,"PROP_SNAPSHOT_SOURCE_SNAPSHOT",{hash:{},data:i}))+'</label>\n                <div>\n                    <p id="property-snapshot-source">'+u((o=(o=t&&t.originSnapshot,o==null||o===!1?o:o.id),typeof o===a?o.apply(t):o))+'</p>\n                </div>\n            </div>\n            <div class="control-group clearfix">\n                <label for="property-snapshot-name">'+u(n.i18n.call(t,"PROP_SNAPSHOT_SET_NEW_NAME",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id="property-snapshot-name" class="input" type="text" maxlength="255" data-type="domain" value="'+u((o=(o=t&&t.originSnapshot,o==null||o===!1?o:o.id),typeof o===a?o.apply(t):o))+'-copy" data-ignore="true">\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-region-choose">'+u(n.i18n.call(t,"PROP_SNAPSHOT_DESTINATION_REGION",{hash:{},data:i}))+'</label>\n                <div>\n                    <div id="property-region-choose"></div>\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-snapshot-desc">'+u(n.i18n.call(t,"PROP_SNAPSHOT_SET_DESC",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id=\'property-snapshot-desc\' class="input" value="[Copied '+u((o=(o=t&&t.originSnapshot,o==null||o===!1?o:o.id),typeof o===a?o.apply(t):o))+" from "+u((o=t&&t.region,typeof o===a?o.apply(t):o))+']" type="text"/>\n                </div>\n            </div>\n\n        </section>\n        <div class="init action">\n            <button class="btn btn-blue do-action" data-action="duplicate" disabled>Duplicate</button>\n            <button class="btn btn-silver cancel">Cancel</button>\n        </div>\n        <div class="processing action" style="display:none;">\n            <button class="btn" disabled>Duplicating...</button>\n        </div>\n    </div>\n</div>',s},n.slide_duplicate=e.template(t),n}),function(){define("snapshotManager",["CloudResources","ApiRequest","constant","combo_dropdown","UI.modalplus","toolbar_modal","i18n!/nls/lang.js","component/snapshot/snapshot_template"],function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p;return l=!1,a=0,f=0,c=!1,h={},p=Backbone.View.extend({constructor:function(){return this.collection=e(n.RESTYPE.SNAP,Design.instance().region()),this.listenTo(this.collection,"update",this.onChange.bind(this)),this.listenTo(this.collection,"change",this.onChange.bind(this)),this},onChange:function(){return this.initManager(),this.trigger("datachange",this)},remove:function(){return this.isRemoved=ture,Backbone.View.prototype.remove.call(this)},render:function(){return this.renderManager()},renderDropdown:function(){var t,i;return t={filterPlaceHolder:o.ide.PROP_SNAPSHOT_FILTER_VOLUME},this.dropdown=new r(t),this.volumes=e(n.RESTYPE.VOL,Design.instance().region()),i=o.ide.PROP_VOLUME_SNAPSHOT_SELECT,this.dropdown.setSelection(i),this.dropdown.on("open",this.openDropdown,this),this.dropdown.on("filter",this.filterDropdown,this),this.dropdown.on("change",this.selectSnapshot,this),this.dropdown},renderRegionDropdown:function(){var e,t;return e={filterPlaceHolder:o.ide.PROP_SNAPSHOT_FILTER_REGION},this.regionsDropdown=new r(e),this.regions=_.keys(n.REGION_LABEL),t=o.ide.PROP_VOLUME_SNAPSHOT_SELECT_REGION,this.regionsDropdown.setSelection(t),this.regionsDropdown.on("open",this.openRegionDropdown,this),this.regionsDropdown.on("filter",this.filterRegionDropdown,this),this.regionsDropdown.on("change",this.selectRegion,this),this.regionsDropdown},openRegionDropdown:function(e){var t,r,i,s;return r=Design.instance().get("region"),i=_.map(this.regions,function(e){return{name:n.REGION_LABEL[e]+" - "+n.REGION_SHORT_LABEL[e],selected:e===r,region:e}}),s={isRuntime:!1,data:i},e&&(s.data=e,s.hideDefaultNoKey=!0),t=u.keys(s),this.regionsDropdown.toggleControls(!1,"manage"),this.regionsDropdown.toggleControls(!0,"filter"),this.regionsDropdown.setContent(t)},openDropdown:function(e){return this.volumes.fetch().then(function(t){return function(){var n,r,i,s;return i=t.volumes.toJSON(),r=Design.instance().get("region"),i=_.filter(i,function(e){return e.category===r}),s={isRuntime:!1,data:i},e&&(s.data=e,s.hideDefaultNoKey=!0),n=u.keys(s),t.dropdown.toggleControls(!1,"manage"),t.dropdown.toggleControls(!0,"filter"),t.dropdown.setContent(n)}}(this))},filterDropdown:function(e){var t;return t=_.filter(this.volumes.toJSON(),function(t){return t.id.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.openDropdown(t):this.openDropdown()},filterRegionDropdown:function(e){var t;return t=_.filter(this.regions,function(t){return t.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.openRegionDropdown(t):this.openRegionDropdown()},selectSnapshot:function(e){return this.manager.$el.find('[data-action="create"]').prop("disabled",!1)},selectRegion:function(e){return this.manager.$el.find('[data-action="duplicate"]').prop("disabled",!1)},renderManager:function(){var e;return this.manager=new s(this.getModalOptions()),this.manager.on("refresh",this.refresh,this),this.manager.on("slidedown",this.renderSlides,this),this.manager.on("action",this.doAction,this),this.manager.on("close",function(e){return function(){return e.manager.remove()}}(this)),this.manager.on("checked",this.processDuplicate,this),this.manager.render(),App.user.hasCredential()?this.initManager():((e=this.manager)!=null&&e.render("nocredential"),!1)},processDuplicate:function(e,t){return t.length===1?this.M$("[data-btn=duplicate]").prop("disabled",!1):this.M$("[data-btn=duplicate]").prop("disabled",!0)},refresh:function(){return l=!1,this.initManager()},setContent:function(){var e,t,n,r;return c=!1,l=!0,t=this.collection.toJSON(),_.each(t,function(e,n){return e.progress===100&&(t[n].completed=!0),e.startTime&&(t[n].started=(new Date(e.startTime)).toString()),null}),n={items:t},e=u.content(n),(r=this.manager)!=null?r.setContent(e):void 0},initManager:function(){var e,t;t=this.setContent.bind(this),e=Design.instance().get("region");if(!l&&!c||!h[e])return c=!0,h[e]=!0,this.collection.fetchForce().then(t,t);if(!c)return this.setContent()},renderSlides:function(e,t){var n,r,i;return r=u["slide_"+e],n=this.getSlides(),(i=n[e])!=null?i.call(this,r,t):void 0},getSlides:function(){return{"delete":function(e,t){var n,r;n=t.length;if(!n)return;return r={},n===1?r.selectedName=t[0].data.name:r.selectedCount=n,this.manager.setSlide(e(r))},create:function(e){var t;return t={volumes:{}},this.manager.setSlide(e(t)),this.dropdown=this.renderDropdown(),this.manager.$el.find("#property-volume-choose").html(this.dropdown.$el)},duplicate:function(e,t){var n;n={},n.originSnapshot=t[0],n.region=Design.instance().get("region");if(!t)return;return this.manager.setSlide(e(n)),this.regionsDropdown=this.renderRegionDropdown(),this.regionsDropdown.on("change",function(e){return function(){return e.manager.$el.find('[data-action="duplicate"]').prop("disabled",!1)}}(this)),this.manager.$el.find("#property-region-choose").html(this.regionsDropdown.$el)}}},doAction:function(e,t){return this["do_"+e]&&this["do_"+e]("do_"+e,t)},do_create:function(e,t){var n,r,i;return i=this.volumes.findWhere({id:$("#property-volume-choose").find(".selectbox .selection .manager-content-main").data("id")}),i?(r={name:$("#property-snapshot-name-create").val(),volumeId:i.id,description:$("#property-snapshot-desc-create").val()},this.switchAction("processing"),n=this.afterCreated.bind(this),this.collection.create(r).save().then(n,n)):!1},do_delete:function(e,t){var n,r;return r=this,a+=t.length,this.switchAction("processing"),n=r.afterDeleted.bind(r),_.each(t,function(e){return function(t){return e.collection.findWhere({id:t.data.id}).destroy().then(n,n)}}(this))},do_duplicate:function(e,t){var n,r,i,s,o;return s=t[0],o=$("#property-region-choose").find(".selectbox .selection .manager-content-main").data("id"),this.regions.indexOf(o)<0?!1:(this.switchAction("processing"),i=this.manager.$el.find("#property-snapshot-name").val(),r=this.manager.$el.find("#property-snapshot-desc").val(),n=this.afterDuplicate.bind(this),this.collection.findWhere({id:s.data.id}).copyTo(o,i,r).then(n,n))},afterCreated:function(e,t){return this.manager.cancel(),e.error?(notification("error","Create failed because of: "+e.msg),!1):notification("info","New DHCP Option is created successfully!")},afterDuplicate:function(e){var t;return t=Design.instance().get("region"),this.manager.cancel(),e.error?(notification("error","Duplicate failed because of: "+e.msg),!1):e.attributes.region===t?(this.collection.add(e),notification("info","New Snapshot is duplicated successfully!")):(this.initManager(),notification("info","New Snapshot is duplicated to another region, you need to switch region to check the snapshot you just created."))},afterDeleted:function(e){a--,e.error&&f++;if(a===0)return f>0?notification("error",f+" Snapshot failed to delete, Please try again later."):notification("info","Delete Successfully"),this.manager.unCheckSelectAll(),f=0,this.manager.cancel()},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return $(this).hasClass(e)?$(this).show():$(this).hide()})},getModalOptions:function(){var e,t,r;return r=this,e=Design.instance().get("region"),t=n.REGION_SHORT_LABEL[e],{title:"Manage Snapshots in "+t,slideable:!0,context:r,buttons:[{icon:"new-stack",type:"create",name:"Create Snapshot"},{icon:"duplicate",type:"duplicate",disabled:!0,name:"Duplicate"},{icon:"del",type:"delete",disabled:!0,name:"Delete"},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"20%",name:"Name"},{sortable:!0,rowType:"number",width:"10%",name:"Capicity"},{sortable:!0,rowType:"datetime",width:"40%",name:"status"},{sortable:!1,width:"30%",name:"Description"}]}}}),p})}.call(this),define("component/sslcert/sslCertTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression;return u((s=t&&t.Name,typeof s===o?s.apply(t):s))},n.dropdown_selection=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n    <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:o.noop,fn:o.program(2,l,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'" data-name="'+a((i=e&&e.Name,typeof i===u?i.apply(e):i))+'" tabindex="-1">\n        '+a((i=e&&e.Name,typeof i===u?i.apply(e):i))+"\n    </li>\n",r}function l(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this,u="function",a=this.escapeExpression;return s=n.each.call(t,t,{hash:{},inverse:o.noop,fn:o.program(1,f,i),data:i}),s||s===0?s:""},n.dropdown_list=e.template(t),t=function(e,t,n,r,i){function f(e,t){var n="",r;return n+='\n<tr class="item" data-id="'+u((r=e&&e.id,typeof r===o?r.apply(e):r))+'">\n    <td>\n        <div class="checkbox">\n            <input id="sslcert-select-'+u((r=e&&e.id,typeof r===o?r.apply(e):r))+'" type="checkbox" data-id="'+u((r=e&&e.id,typeof r===o?r.apply(e):r))+'" data-name="'+u((r=e&&e.Name,typeof r===o?r.apply(e):r))+'" class="one-cb">\n            <label for="sslcert-select-'+u((r=e&&e.id,typeof r===o?r.apply(e):r))+'"></label>\n        </div>\n    </td>\n    <td>'+u((r=e&&e.Name,typeof r===o?r.apply(e):r))+"</td>\n    <td>"+u((r=e&&e.UploadDate,typeof r===o?r.apply(e):r))+'</td>\n    <td class="show-detail icon-toolbar-cloudformation"></td>\n</tr>\n',n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.modal_list=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="slide-create" data-bind="true">\n    <div class="modal-ssl-cert-create">\n        <div class="modal-ssl-cert-item clearfix">\n            <label class="left">'+o(n.i18n.call(t,"PROP_ELB_LBL_LISTENER_CERT_NAME",{hash:{},data:i}))+'</label>\n            <input placeholder="Required. Up to 128 characters" class="input" type="text" data-required="true" data-ignore="true" id="ssl-cert-name-input"/>\n        </div>\n        <div class="modal-ssl-cert-item clearfix">\n            <label class="left">'+o(n.i18n.call(t,"PROP_ELB_LBL_LISTENER_PRIVATE_KEY",{hash:{},data:i}))+'</label>\n            <textarea placeholder="Required. PEM Encoded" class="input ssl-cert-input" data-required="true" id="ssl-cert-privatekey-input"></textarea>\n        </div>\n        <div class="modal-ssl-cert-item clearfix">\n            <label class="left"  >'+o(n.i18n.call(t,"PROP_ELB_LBL_LISTENER_PUBLIC_KEY",{hash:{},data:i}))+'</label>\n            <textarea placeholder="Required. PEM Encoded" class="input ssl-cert-input" data-required="true" id="ssl-cert-publickey-input"></textarea>\n        </div>\n        <div class="modal-ssl-cert-item clearfix">\n            <label class="left"  >'+o(n.i18n.call(t,"PROP_ELB_LBL_LISTENER_CERTIFICATE_CHAIN",{hash:{},data:i}))+'</label>\n            <textarea placeholder="Optional. PEM Encoded" class="input ssl-cert-input" id="ssl-cert-chain-input"></textarea>\n        </div>\n    </div>\n    <div class="init action">\n        <button class="btn btn-blue do-action" data-action="create" disabled>Upload</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Upload...</button>\n    </div>\n</div>',s},n.slide_create=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+="SSL Certificate "+a((r=e&&e.selecteKeyName,typeof r===u?r.apply(e):r)),n}function c(e,t){var n="",r;return n+="selected "+a((r=e&&e.selectedCount,typeof r===u?r.apply(e):r))+" SSL Certificates",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">Confirm to delete ',o=n["if"].call(t,t&&t.selecteKeyName,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+=' ?</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">Delete</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Deleting...</button>\n    </div>\n</div>',s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="slide-update" data-bind="true">\n    <div class="modal-ssl-cert-update">\n        <div class="modal-ssl-cert-item clearfix">\n            <label class="left">Certificate Name</label>\n            <input class="input" value="'+a((o=t&&t.cert_name,typeof o===u?o.apply(t):o))+'" type="text" data-required="true" id="ssl-cert-name-update-input"/>\n        </div>\n    </div>\n    <div class="init action">\n        <button class="btn btn-blue do-action" data-action="update">Update</button>\n        <button class="btn btn-silver cancel">Cancel</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>Updating...</button>\n    </div>\n</div>',s},n.slide_update=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="detail-info">\n    <div class="detail-info-row">\n        <section class="property-control-group">\n            <label>Server Certificate ID</label>\n            <div>'+a((o=t&&t.id,typeof o===u?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>Server Certificate ARN</label>\n            <div>'+a((o=t&&t.Arn,typeof o===u?o.apply(t):o))+'</div>\n        </section>\n    </div>\n    <div class="detail-info-row">\n        <section class="property-control-group">\n            <label>Expiration Date</label>\n            <div>'+a((o=t&&t.Expiration,typeof o===u?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>Path</label>\n            <div>'+a((o=t&&t.Path,typeof o===u?o.apply(t):o))+"</div>\n        </section>\n    </div>\n</div>",s},n.detail_info=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="combo-dd-no-data">\n    <p>No SSL Certificate.</p>\n    <a class="create-one">Create SSL Certificate</a>\n</div>'},n.no_sslcert=e.template(t),n}),function(){define("sslcert_manage",["constant","CloudResources","toolbar_modal","./component/sslcert/sslCertTpl","i18n!/nls/lang.js","event"],function(e,t,n,r,i,s){return Backbone.View.extend({tagName:"section",initCol:function(){return this.sslCertCol=t(e.RESTYPE.IAM),App.user.hasCredential()&&this.sslCertCol.fetch(),this.sslCertCol.on("update",this.processCol,this),this.sslCertCol.on("change",this.processCol,this)},getModalOptions:function(){var t,n,r;return r=this,t=Design.instance().get("region"),n=e.REGION_SHORT_LABEL[t],{title:"Manage SSL Certificate",classList:"sslcert-manage",context:r,buttons:[{icon:"new-stack",type:"create",name:"Upload New SSL Certificate"},{icon:"edit",type:"update",disabled:!0,name:"Update"},{icon:"del",type:"delete",disabled:!0,name:"Delete"},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"50%",name:"Name"},{sortable:!0,rowType:"datetime",width:"33%",name:"Upload Date"},{sortable:!1,name:"View Details"}]}},initModal:function(){return new n(this.getModalOptions()),this.modal.on("close",function(){return this.remove()},this),this.modal.on("slidedown",this.renderSlides,this),this.modal.on("action",this.doAction,this),this.modal.on("refresh",this.refresh,this),this.modal.on("checked",this.checked,this),this.modal.on("detail",this.detail,this)},initialize:function(){return this.initCol(),this.initModal()},quickCreate:function(){return this.modal.triggerSlide("create")},doAction:function(e,t){return this[e]&&this[e](this.validate(e),t)},validate:function(e){switch(e){case"create":return!0}},genDeleteFinish:function(e){var t,n,r,i;return r=[],t=[],i=this,n=_.after(e,function(){return i.modal.cancel(),r.length===1?notification("info",""+r[0].get("Name")+" is deleted."):r.length>1&&notification("info","Selected "+r.length+" SNS topic are deleted."),i.model.get("keys").length||(i.M$("#kp-select-all").get(0).checked=!1),_.each(t,function(e){return void 0})}),function(e){return e instanceof Backbone.Model?r.push(e):t.push(e),n()}},create:function(e){var t,n,r,i,s,o;o=this,this.switchAction("processing"),n=$("#ssl-cert-name-input"),r=$("#ssl-cert-privatekey-input"),i=$("#ssl-cert-publickey-input"),t=$("#ssl-cert-chain-input"),s=n.val();if(s==="None"){notification("error","Certificate name "+s+" is invalid");return}return this.sslCertCol.create({Name:s,CertificateBody:i.val(),PrivateKey:r.val(),CertificateChain:t.val(),Path:""}).save().then(function(e){return notification("info","Certificate "+s+" is uploaded"),o.modal.cancel()},function(e){o.switchAction();if(e.awsResult)return notification("error",e.awsResult)})},"delete":function(e,t){var n,r;return n=t.length,r=this.genDeleteFinish(n),this.switchAction("processing"),_.each(t,function(e){var t;return t=this.sslCertCol.get(e.data.id),t!=null?t.destroy().then(r,r):void 0})},update:function(t,n){var r,i,o,u,a;a=this,this.switchAction("processing");if(n&&n[0])return u=n[0].data.id,o=a.sslCertCol.get(u),i=o.get("Name"),r=$("#ssl-cert-name-update-input").val(),r===i?a.modal.cancel():o.update({Name:r}).then(function(t){var n,u;return n=r,notification("info","Certificate "+n+" is updated"),u=Design.modelClassForType(e.RESTYPE.IAM).allObjects(),_.each(u,function(e){return e.get("name")===i&&(e.set("name",r),e.set("arn",o.get("Arn"))),null}),s.trigger(s.REFRESH_PROPERTY),a.modal.cancel()},function(e){a.switchAction();if(e.awsResult)return notification("error",e.awsResult)})},detail:function(e,t,n){var i,s,o,u;return u=this,o=t.id,s=sslCertCol.get(o).toJSON(),s.Expiration=MC.dateFormat(new Date(s.Expiration),"yyyy-MM-dd hh:mm:ss"),i=r.detail_info,this.modal.setDetail(n,i(s))},refresh:function(){return this.sslCertCol.fetchForce()},checked:function(e,t){var n;return n=this.M$(".toolbar .icon-edit"),t.length===1?n.removeAttr("disabled"):n.attr("disabled","disabled")},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return $(this).hasClass(e)?$(this).show():$(this).hide()})},render:function(){return this.modal.render(),App.user.hasCredential()?this.processCol():this.modal.render("nocredential"),this},processCol:function(){var e;return this.sslCertCol.isReady()&&(e=this.sslCertCol.map(function(e){var t;return t=e.toJSON(),t.UploadDate=MC.dateFormat(new Date(t.UploadDate),"yyyy-MM-dd hh:mm:ss"),t}),this.renderList(e)),!1},renderList:function(e){return this.modal.setContent(r.modal_list(e))},renderNoCredential:function(){return this.modal.render("nocredential").toggleControls(!1)},renderSlides:function(e,t){var n,i,s;return i=r["slide_"+e],n=this.getSlides(),(s=n[e])!=null?s.call(this,i,t):void 0},processSlideCreate:function(){},getSlides:function(){var e,t;return t=this,e=this.modal,{create:function(n,r){var i,s;return e.setSlide(n),i=t.M$(".slide-create input, .slide-create textarea"),s=function(e){return $(e.currentTarget).parsley("validateForm",!1)?t.M$(".slide-create .do-action").prop("disabled",!1):t.M$(".slide-create .do-action").prop("disabled",!0)},i.on("keyup",s)},"delete":function(t,n){var r,i;r=n.length;if(!r)return;return i={},r===1?i.selecteKeyName=n[0].data.name:i.selectedCount=r,e.setSlide(t(i))},update:function(n,r){var i,s,o;return t=this,r&&r[0]&&(s=r[0].data.name,e.setSlide(n({cert_name:s}))),i=t.M$(".slide-update input"),o=function(e){return $(e.currentTarget).parsley("validateForm",!1)?t.M$(".slide-update .do-action").prop("disabled",!1):t.M$(".slide-update .do-action").prop("disabled",!0)},i.on("keyup",o)}}},show:function(){return App.user.hasCredential()?(this.sslCertCol.fetch(),this.processCol()):this.renderNoCredential()},manage:function(){},set:function(){},filter:function(e){return this.processCol(!0,e)}})})}.call(this),function(){define("sslcert_dropdown",["constant","CloudResources","sslcert_manage","combo_dropdown","./component/sslcert/sslCertTpl","i18n!/nls/lang.js"],function(e,t,n,r,i,s){var o;return o=t(e.RESTYPE.IAM),window.sslCertCol=o,Backbone.View.extend({tagName:"section",initCol:function(){return this.sslCertCol=t(e.RESTYPE.IAM),this.sslCertCol.on("update",this.processCol,this)},initDropdown:function(){var e;return e={manageBtnValue:s.ide.PROP_INSTANCE_MANAGE_SSL_CERT,filterPlaceHolder:s.ide.PROP_INSTANCE_FILTER_SSL_CERT},this.dropdown=new r(e),this.dropdown.on("open",this.show,this),this.dropdown.on("manage",this.manage,this),this.dropdown.on("change",this.set,this),this.dropdown.on("filter",this.filter,this),this.dropdown.on("quick_create",this.quickCreate,this)},initialize:function(){return this.initCol(),this.initDropdown()},quickCreate:function(){return(new n).render().quickCreate()},render:function(){var e;return e=this.sslCertName||"None",this.el=this.dropdown.el,e==="None"&&($(this.el).addClass("empty"),this.sslCertCol.fetch()),this.dropdown.setSelection(e),this},setDefault:function(){var e,t,n,r,i;if(this.sslCertCol.isReady()){n=this.sslCertCol.toJSON();if(n&&n[0]&&this.uid&&this.dropdown.getSelection()==="None"){e=Design.instance().component(this.uid);if(e){r=e.get("listeners"),t=r[this.listenerNum];if(t&&((i=t.protocol)==="HTTPS"||i==="SSL"))return e.setSSLCert(this.listenerNum,n[0].id),this.dropdown.trigger("change",n[0].id),this.dropdown.setSelection(n[0].Name),$(this.el).removeClass("empty")}}}},processCol:function(e,t){var n,r;return this.sslCertCol.isReady()&&(n=this.sslCertCol.toJSON(),this.setDefault(),e&&(r=t.length,n=_.filter(n,function(e){return e.Name.toLowerCase().indexOf(t.toLowerCase())!==-1})),this.renderDropdownList(n)),!1},renderDropdownList:function(e){var t;return e.length?(t=this.dropdown.getSelection(),_.each(e,function(e){return e.Name&&e.Name===t&&(e.selected=!0),null}),this.dropdown.setContent(i.dropdown_list(e)).toggleControls(!0)):this.dropdown.setContent(i.no_sslcert({})).toggleControls(!0)},renderNoCredential:function(){return this.dropdown.render("nocredential").toggleControls(!1)},show:function(){return App.user.hasCredential()?(this.sslCertCol.fetch(),this.processCol()):this.renderNoCredential()},manage:function(){return(new n).render()},set:function(e,t){var n,r,i;if(this.uid&&e){r=Design.instance().component(this.uid).get("listeners"),n=r[this.listenerNum];if(n&&((i=n.protocol)==="HTTPS"||i==="SSL"))return Design.instance().component(this.uid).setSSLCert(this.listenerNum,e)}},filter:function(e){return this.processCol(!0,e)}})})}.call(this),function(){define("DiffTree",[],function(){var e;return e=function(e){var t,n,r,i,s;return e||(e={}),e.filterAttrMap={type:!0,uid:!0,name:!0,index:!0,number:!0,serverGroupUid:!0,serverGroupName:!0,state:!0,"resource.PrivateIpAddressSet.n.AutoAssign":!0,"resource.AssociatePublicIpAddress":!0,"resource.KeyName":!0,"resource.AssociationSet.n.RouteTableAssociationId":!0,"resource.AssociationSet.n.NetworkAclAssociationId":!0,"resource.BlockDeviceMapping":!0,"resource.VolumeSize":!0,"resource.GroupDescription":!0,"resource.ListenerDescriptions.n.Listener.SSLCertificateId":!0,"resource.Attachment.AttachmentId":!0,"resource.Iops":!0},e.filterResMap={},e.state==="stop"&&(e.filterResMap={"AWS.AutoScaling.Group":!0}),n=function(e){return e&&typeof e=="object"&&e.constructor===Array},r=function(e){return n(e)?"array":e===null?"null":typeof e},t=function(e){return typeA==="object"||typeA==="array"?"":String(a)+" "},s=function(e,t){var n,r,s,o,u,a,f,l,c,h,p;c=function(){p=[];for(var t=0,n=e.length;0<=n?t<n:t>n;0<=n?t++:t--)p.push(t);return p}.apply(this),h=[];for(n=u=0,f=c.length;u<f;n=++u)o=c[n],h.push(function(){var u,a,f,l,c,h,p;c=function(){p=[];for(var e=0,n=t.length;0<=n?e<n:e>n;0<=n?e++:e--)p.push(e);return p}.apply(this),h=[];for(r=u=0,f=c.length;u<f;r=++u)o=c[r],i.call(this,e[n],t[r],"",null,[])?h.push(void 0):(s=t[n],t[n]=t[r],h.push(t[r]=s));return h}.call(this));return h},i=function(t,n,o,u,a){var f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;o==="VPCZoneIdentifier"&&(f=t.split(","),p=n.split(","),f=_.map(f,function(e){return $.trim(e)}),p=_.map(p,function(e){return $.trim(e)}),t=f,n=p);if(u){o&&(u=u.concat([o]));if(u.length===2){x=u[1];if(t&&t.type){S=t.type;if(e.filterResMap[S])return}}else if(u.length>2){h=u.slice(2),h=_.map(h,function(e){var t;return t=Number(e),t>=0?"n":e}),c=h.join(".");if(e.filterAttrMap[c])return}}if(!t&&!n)return;y=!1,T=r(t),N=r(n),l=T==="object"||T==="array"?"":String(t)+"",d=N==="object"||N==="array"?"":String(n)+"",l||(l=""),d||(d=""),v=k=L="",t===void 0?(v="added",L=d):n===void 0?(v="removed",k=l):T!==N||T!=="object"&&T!=="array"&&t!==n?(v="changed",k=l,L=d):k=l,a[o]={};if(T==="object"||T==="array"||N==="object"||N==="array"){T==="array"&&N==="array"&&(m={},t.length<n.length?s.call(this,t,n):s.call(this,n,t)),E=[];for(C in t)E.push(C);for(C in n)E.push(C);E.sort(),w=!0;for(b=A=0,O=E.length;A<O;b=++A){C=E[b];if(E[b]===E[b-1])continue;g=i.call(this,t&&t[E[b]],n&&n[E[b]],E[b],u,a[o]),g&&(w=!1)}y=!w,w&&delete a[o]}else u&&(u.length=0),r(t)==="number"&&(t=String(t)),r(n)==="number"&&(n=String(n)),r(t)==="boolean"&&(t=String(t)),r(n)==="boolean"&&(n=String(n)),t!==n?(y=!0,a[o]={type:v,__old__:t,__new__:n}):delete a[o];return y},this.compare=function(e,t){var n;return n={},i.call(this,e,t,"result",[],n),n.result},null},e})}.call(this),define("component/common/diff/resDiffTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="scroll-wrap scroll-wrap-res-diff">\n	<div class="scrollbar-veritical-wrap" style="display: block;"><div class="scrollbar-veritical-thumb"></div></div>\n	<div class="content_wrap scroll-content">\n		<p>Resources of this App have been changed externally. This has been synced to your App. The diagram may be re-generated to reflect the change(s).</p>\n		<h5>What have been changed:</h5>\n		<article></article>\n	</div>\n</div>'},n.frame=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="group '+a((o=t&&t.type,typeof o===u?o.apply(t):o))+'">\n	<div class="head">'+a((o=t&&t.title,typeof o===u?o.apply(t):o))+'<span class="count">('+a((o=t&&t.count,typeof o===u?o.apply(t):o))+')</span></div>\n	<div class="content"></div>\n</div>',s},n.resDiffGroup=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<ul class="tree"></ul>'},n.resDiffTree=e.template(t),t=function(e,t,n,r,i){function l(e,t){return"closed"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<li class="item ',o=n["if"].call(t,t&&t.closed,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='">\n	<div class="meta">\n		<span class="type">'+f((o=t&&t.key,typeof o===a?o.apply(t):o))+'</span>\n		<span class="name">'+f((o=t&&t.value,typeof o===a?o.apply(t):o))+"</span>\n	</div>\n</li>",s},n.resDiffTreeItem=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n;return a((n=e&&e.type,typeof n===u?n.apply(e):n))}function c(e,t){var n="",r;return n+='<span class="name to"> -></span><span class="name '+a((r=e&&e.type1,typeof r===u?r.apply(e):r))+'">'+a((r=e&&e.value1,typeof r===u?r.apply(e):r))+"</span>",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="meta">\n	<span class="type">'+a((o=t&&t.key,typeof o===u?o.apply(t):o))+'</span>\n	<span class="name ',o=n["if"].call(t,t&&t.type,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='">'+a((o=t&&t.value,typeof o===u?o.apply(t):o))+"</span>\n	",o=n["if"].call(t,t&&t.value1,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+="\n</div>",s},n.resDiffTreeMeta=e.template(t),n}),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("component/common/diff/prepare",["constant"],function(t){var n,r,i;return r=function(n){return{getNodeMap:function(e){var t,r,i,s;return _.isString(e)&&(e=e.split(".")),i=n.oldAppJSON.component,t=n.newAppJSON.component,s=_.extend(i,{}),r=_.extend(t,{}),_.each(e,function(e){return s&&(_.isUndefined(s[e])?s=void 0:s=s[e]),r&&(_.isUndefined(r[e])?r=void 0:r=r[e]),null}),{oldAttr:s,newAttr:r}},genValue:function(e,t,n){var r;return r="",t=String(t),n=String(n),e==="changed"&&(t||(t="none"),n||(n="none")),t?(r=t,n&&t!==n&&(r+=" -> "+n)):r=n,r},getNodeData:function(e){return this.getNewest(this.getNodeMap(e))},getNewest:function(e){return e.newAttr||e.oldAttr},pluralToSingular:function(e){return e.slice(0,-1)},setToElement:function(e){return e.slice(0,-3)},replaceArrayIndex:function(n,r){var i,s,o,u,a,f,l;o=this.getNodeMap(n[0]),s=this.getNewest(o),l=s.type,a=n[n.length-2],i=r.originValue,f=["Dimensions","AlarmActions","Instances","Attachments","AvailabilityZones","LoadBalancerNames","TerminationPolicies","ListenerDescriptions","SecurityGroups","Subnets","Routes"];switch(a){case"BlockDeviceMapping":u=i.DeviceName,r.key="Device",u&&(_.isObject(u)?r.key=this.genValue(u.type,u.__old__,u.__new__):r.key=u);break;case"GroupSet":r.key="SecurityGroup";break;case"IpPermissions":case"IpPermissionsEgress":case"EntrySet":r.key="Rule";break;case"AssociationSet":case"AttachmentSet":case"PrivateIpAddressSet":r.key=this.setToElement(a);break;case"NotificationType":r.key="Type";break;case"VPCZoneIdentifier":r.key="Subnet";break;case"RouteSet":r.key="Route"}return e.call(f,a)>=0&&(r.key=this.pluralToSingular(a)),n.length===1&&(r.key=t.RESNAME[r.key]||r.key),r}}},i=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v;return v=function(e,t){var n,r,i,s;if(_.isString(e)&&e.indexOf("@{")===0){i=/@\{.*\}/g,n=e.match(i);if(n&&n.length){r=e.slice(2,e.length-1),s=r.split(".")[0];if(!t)return r;if(s)return""+s+".name"}}return null},_.isObject(t.value)?(f=t.value,s=!0,t.key&&t.key.substr(t.key.lastIndexOf("Id"))==="Id"&&(s=!1),h=v(f.__old__,s),a=v(f.__new__,s),h&&(f.__old__=this.h.getNodeMap(h).oldAttr),a&&(f.__new__=this.h.getNodeMap(a).newAttr),t=this.h.replaceArrayIndex(e,t),t.value={type:f.type,old:f.__old__,"new":f.__new__}):(r=this.h.getNodeMap(e),l=r.oldAttr,o=r.newAttr,d=v(t.value),d&&(n=this.h.getNodeMap(d),p=n.oldAttr,f=n.newAttr,t.value=p||f),e.length===1&&(i=e[0],c=(l?l.name:void 0)||"",u=(o?o.name:void 0)||"",l?t.key=l.type:t.key=o.type,t.value=this.h.genValue(null,c,u)),t=this.h.replaceArrayIndex(e,t)),e.length===2&&e[1]==="resource"&&(t.skip=!0),t},n=function(e){return _.extend(this,e),this.h=r(e),this},n.prototype.node=i,n})}.call(this),function(){define("ResDiff",["UI.modalplus","DiffTree","component/common/diff/resDiffTpl","component/common/diff/prepare","constant"],function(e,t,n,r,i){return Backbone.View.extend({className:"res_diff_tree",tagName:"section",initialize:function(e){return this.oldAppJSON=e.old,this.newAppJSON=e["new"],e.callback&&(this.callback=e.callback),this.prepare=new r({oldAppJSON:this.oldAppJSON,newAppJSON:this.newAppJSON}),this._genDiffInfo(this.oldAppJSON.component,this.newAppJSON.component),this.state=e.state},events:{"click .item .type":"_toggleTab","click .head":"_toggleItem"},_toggleItem:function(e){var t;return t=$(e.currentTarget).closest(".group"),t.toggleClass("closed")},_toggleTab:function(e){var t;t=$(e.currentTarget).closest(".item");if(t.hasClass("end"))return;return t.toggleClass("closed")},render:function(){var t,r,i;return i=this,t="OK, got it",r={template:this.el,title:"App Changes",disableClose:!0,hideClose:!0,confirm:{text:t},width:"608px",compact:!0,preventClose:!0},this.modal=new e(r),this.modal.on("confirm",function(){var e,n;return e=i.modal.tpl.find(".modal-confirm"),i.callback?(e.addClass("disabled"),e.text("Saving..."),n=i.callback(!0),n.then(function(){return i.modal.close()},function(n){return e.text(t),e.removeClass("disabled"),notification("error",n.msg)})):i.modal.close()},this),this.modal.on("cancel",function(){return i.callback&&i.callback(!1),i.modal.close()},this),this.$el.html(n.frame()),this._genResGroup(this.oldAppJSON.component,this.newAppJSON.component),this.modal.resize()},_genDiffInfo:function(e,n){var r,i,s,o;i=this,i.addedComps={},i.removedComps={},i.modifiedComps={},o={},s={},_.each(e,function(t,r){return n[r]?(o[r]=e[r],s[r]=n[r]):i.removedComps[r]=e[r],null}),_.each(_.keys(n),function(t){return e[t]||(i.addedComps[t]=n[t]),null}),r=new t({state:i.state}),i.modifiedComps=r.compare(o,s);if(!i.modifiedComps)return i.modifiedComps={}},_genResGroup:function(){var e,t,r,i,s,o,u,a;s=this,i=[{title:"New Resource",diffComps:s.addedComps,closed:!0,type:"added",needDiff:!1},{title:"Removed Resource",diffComps:s.removedComps,closed:!0,type:"removed",needDiff:!1},{title:"Modified Resource",diffComps:s.modifiedComps,closed:!1,type:"modified",needDiff:!0}],a=[];for(o=0,u=i.length;o<u;o++)r=i[o],t=_.keys(r.diffComps).length,t?(e=$(n.resDiffGroup({type:r.type,title:r.title,count:t})).appendTo(this.$("article")),a.push(this._genResTree(e.find(".content"),r.diffComps,r.closed,r.needDiff))):a.push(void 0);return a},_genResTree:function(e,t,r,i){var s,o;return s=this,o=function(e,t,i,u){var a,f,l,c,h,p,d,v,m,g,y,b;if(_.isObject(e)){if(_.isUndefined(e.__new__)&&_.isUndefined(e.__old__)){a=$(n.resDiffTree({})).appendTo(u),y=[];for(g in e)b=e[g],m=_.isObject(b)?"":b,h=i.concat([g]),c=this.prepare.node(h,{key:g,value:m,originValue:b}),c.key?(c.skip?(f=u,a.remove()):(f=$(n.resDiffTreeItem({key:c.key,value:c.value,closed:r})).appendTo(a),_.isObject(b)||f.addClass("end")),_.isArray(b)&&b.length===0?y.push(f.remove()):y.push(o.call(s,b,g,h,f))):y.push(void 0);return y}return l=e.type,c=this.prepare.node(i,{key:t,value:e}),c.key?(p=v=d="",_.isObject(c.value)?c.value.type==="added"?(e=c.value["new"],p="new"):c.value.type==="removed"?(e=c.value.old,p="old"):c.value.type==="changed"&&(e=c.value.old,v=c.value["new"],p="old",d="new"):e=c.value,u.html(n.resDiffTreeMeta({key:c.key,value:e,type:p,value1:v,type1:d,closed:r})),u.addClass("end"),u.addClass(l)):u.remove()}},o.call(s,t,null,[],e)},getRelatedInstanceGroupUID:function(e,t){var n,r,s,o,u,a,f,l;l=this,f=t.type;if(f===i.RESTYPE.INSTANCE)return t.serverGroupUid;f===i.RESTYPE.ENI&&(u=t.resource.Attachment.InstanceId);if(u){a=MC.extractID(u),o=e[a];if(o)return o.serverGroupUid}f===i.RESTYPE.VOL&&(u=t.resource.AttachmentSet.InstanceId);if(u){a=MC.extractID(u),o=e[a];if(o)return o.serverGroupUid}f===i.RESTYPE.EIP&&(r=t.resource.NetworkInterfaceId);if(r){s=MC.extractID(r),n=e[s];if(n)return l.getRelatedInstanceGroupUID(e,n)}return""},getChangeInfo:function(){var e,t,n,r,s;s=this,e=!1;if(_.size(s.addedComps)||_.size(s.removedComps)||_.size(s.modifiedComps))e=!0;return t=_.some(s.addedComps,function(e){return s.newAppJSON.layout[e.uid]}),n=s.newAppJSON.component,r=s.oldAppJSON.component,_.each(s.modifiedComps,function(e,n){var s,o;return s=r[n],s&&((o=s.type)===i.RESTYPE.ENI||o===i.RESTYPE.EIP||o===i.RESTYPE.INSTANCE||o===i.RESTYPE.VOL)&&s&&s.number>1&&(t=!0),null}),_.each(s.modifiedComps,function(e,n){var s;return r[n]&&r[n].type===i.RESTYPE.ELB&&e&&e.resource&&e.resource.Instances&&(s=[],_.map(e.resource.Instances,function(e){var t;t=e.InstanceId;if(t){t.__old__&&s.push(t.__old__);if(t.__new__)return s.push(t.__new__)}}),_.each(s,function(e){return n=MC.extractID(e),r[n]&&r[n].number>1&&(t=!0),null})),null}),_.each(s.modifiedComps,function(e,r){return n[r]&&n[r].type===i.RESTYPE.ASG&&(e&&e.resource&&e.resource.AvailabilityZones&&(t=!0),e&&e.resource&&e.resource.VPCZoneIdentifier&&(t=!0)),null}),_.each(s.removedComps,function(e){var n,o,u;if((u=e.type)===i.RESTYPE.ENI||u===i.RESTYPE.EIP||u===i.RESTYPE.INSTANCE||u===i.RESTYPE.VOL)o=s.getRelatedInstanceGroupUID(r,e),n=r[o],n&&n.number>1&&(t=!0);return null}),{hasResChange:e,needUpdateLayout:t}}})})}.call(this),define("component/sharedrescomp",function(){});