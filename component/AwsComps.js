define("component/awscomps/DhcpTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var r="";return r+="\n    "+o(n.i18n.call(e,"PROP.VPC_AUTO_DHCP",{hash:{},data:t}))+'<i class="icon-info tooltip" data-tooltip=\''+o(n.i18n.call(e,"PROP.VPC_TIP_AUTO_DHCP",{hash:{},data:t}))+"'></i>\n",r}function l(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,e&&e.isDefault,{hash:{},inverse:a.program(6,h,t),fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){var r="";return r+="\n        "+o(n.i18n.call(e,"PROP.VPC_DEFAULT_DHCP",{hash:{},data:t}))+' <i class="icon-info tooltip" data-tooltip="'+o(n.i18n.call(e,"PROP.VPC_TIP_DEFAULT_DHCP",{hash:{},data:t}))+'"></i>\n    ',r}function h(e,t){var n="",r;return n+="\n        "+o((r=e&&e.id,typeof r===u?r.apply(e):r))+"\n    ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u="function",a=this;return s=n["if"].call(t,t&&t.isAuto,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.selection=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<tr class="item" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'">\n    <td>\n        <div class="checkbox">\n            <input id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" type="checkbox" value="None" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" class="one-cb">\n            <label for="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'"></label>\n        </div>\n    </td>\n    <td>'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+"</td>\n    <td>",i=n["if"].call(e,(i=e&&e["domain-name"],i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,(i=e&&e["domain-name-servers"],i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(5,h,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,(i=e&&e["ntp-servers"],i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(7,p,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,(i=e&&e["netbios-name-servers"],i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(9,d,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e&&e["netbios-node-type"],{hash:{},inverse:a.noop,fn:a.program(11,v,t),data:t});if(i||i===0)r+=i;return r+='</td>\n    <td class="show-detail icon-toolbar-cloudformation"></td>\n</tr>\n',r}function l(e,t){var r="",i;r+="domain-name = ",i=n.each.call(e,e&&e["domain-name"],{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;return r+=";",r}function c(e,t){var n="";return n+=u(typeof e===o?e.apply(e):e)+" ",n}function h(e,t){var r="",i;r+="domain-name-servers = ",i=n.each.call(e,e&&e["domain-name-servers"],{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;return r+=";",r}function p(e,t){var r="",i;r+="ntp-servers = ",i=n.each.call(e,e&&e["ntp-servers"],{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;return r+=";",r}function d(e,t){var r="",i;r+="netbios-name-servers = ",i=n.each.call(e,e&&e["netbios-name-servers"],{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;return r+=";",r}function v(e,t){var n="",r;return n+="netbios-node-type = "+u((r=e&&e["netbios-node-type"],typeof r===o?r.apply(e):r)),n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.items,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.content=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n",i=n.unless.call(e,e&&e.isRunTime,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;r+='\n<li data-id="@default" class="item',i=n["if"].call(e,e&&e["default"],{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" tabindex="-1">\n    '+a(n.i18n.call(e,"PROP.VPC_DEFAULT_DHCP",{hash:{},data:t}))+'\n    <i class="icon-info tooltip" data-tooltip="'+a(n.i18n.call(e,"PROP.VPC_TIP_DEFAULT_DHCP",{hash:{},data:t}))+'"></i>\n</li>\n',r}function c(e,t){var r="",i;r+='\n<li data-id="@auto" class="item',i=n["if"].call(e,e&&e.auto,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" tabindex="-1">\n    '+a(n.i18n.call(e,"PROP.VPC_AUTO_DHCP",{hash:{},data:t}))+'\n    <i class="icon-info tooltip" data-tooltip=\''+a(n.i18n.call(e,"PROP.VPC_TIP_AUTO_DHCP",{hash:{},data:t}))+"'></i>\n</li>\n",r}function h(e,t){return" selected"}function p(e,t){var r="",i;r+='\n<li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+a((i=e&&e.id,typeof i===f?i.apply(e):i))+'" tabindex="-1">'+a((i=e&&e.id,typeof i===f?i.apply(e):i))+"</li>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a=this.escapeExpression,f="function";o=n.unless.call(t,t&&t.hideDefaultNoKey,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n.each.call(t,t&&t.keys,{hash:{},inverse:u.noop,fn:u.program(5,p,i),data:i});if(o||o===0)s+=o;return s},n.keys=e.template(t),t=function(e,t,n,r,i){function f(e,t){return u(n.i18n.call(e,"DHCP_DELETE_CONFIRM_ONE",e&&e.selectedId,{hash:{},data:t}))}function l(e,t){return u(n.i18n.call(e,"DHCP_DELETE_CONFIRM_MULTY",e&&e.selectedCount,{hash:{},data:t}))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">',o=n["if"].call(t,t&&t.selectedId,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;return s+='</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">'+u(n.i18n.call(t,"PROP.LBL_DELETE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.LBL_DELETING",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){function l(e,t){return'checked="checked"'}function c(e,t){return"3"}function h(e,t){return"4"}function p(e,t){var r="";return r+='\n                        <div class="multi-ipt-row">\n                            <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                            <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.VPC_TIP_ENTER_UP_TO_4_DNS",{hash:{},data:t}))+'" value="'+u(typeof e===a?e.apply(e):e)+'" type="text" maxlength="255" placeholder="'+u(n.i18n.call(e,"PROP.VPC_TIP_EG_172_16_16_16",{hash:{},data:t}))+'" data-type="ipv4" data-ignore="true"></span>\n                        </div>\n                        ',r}function d(e,t){var r="";return r+='\n                        <div class="multi-ipt-row">\n                            <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                            <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.VPC_TIP_ENTER_UP_TO_4_DNS",{hash:{},data:t}))+'"  placeholder="'+u(n.i18n.call(e,"PROP.VPC_TIP_EG_172_16_16_16",{hash:{},data:t}))+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n                        </div>\n                        ',r}function v(e,t){var r="";return r+='\n                    <div class="multi-ipt-row">\n                        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                        <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.VPC_TIP_ENTER_UP_TO_4_NTP",{hash:{},data:t}))+'" value="'+u(typeof e===a?e.apply(e):e)+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n                    </div>\n                    ',r}function m(e,t){var r="";return r+='\n                    <div class="multi-ipt-row">\n                        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                        <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.VPC_TIP_ENTER_UP_TO_4_NTP",{hash:{},data:t}))+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n                    </div>\n                    ',r}function g(e,t){var r="";return r+='\n                    <div class="multi-ipt-row">\n                        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                        <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.VPC_TIP_ENTER_UP_TO_4_NETBIOS",{hash:{},data:t}))+'" value="'+u(typeof e===a?e.apply(e):e)+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n                    </div>\n                    ',r}function y(e,t){var r="";return r+='\n                    <div class="multi-ipt-row">\n                        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                        <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.VPC_TIP_ENTER_UP_TO_4_NETBIOS",{hash:{},data:t}))+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n                    </div>\n                    ',r}function b(e,t){var r;return r=n.i18n.call(e,"PROP.VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE_NOT_SPECIFIED",{hash:{},data:t}),r||r===0?r:""}function w(e,t){var r="",i;r+='\n                        <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:f.noop,fn:f.program(22,E,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+u((i=e&&e.id,typeof i===a?i.apply(e):i))+'">'+u((i=e&&e.value,typeof i===a?i.apply(e):i))+"</li>\n                        ",r}function E(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<div class="slide-create" data-bind="true">\n    <div class="formart_toolbar_modal" data-type="true">\n        <section data-bind="true">\n            <div class="control-group clearfix">\n                <label for="property-dhcp-domain">'+u(n.i18n.call(t,"PROP.VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME",{hash:{},data:i}))+'</label>\n                <div id="property-dhcp-domain" class="multi-input" data-max-row="100">\n                    <div class="multi-ipt-row">\n                        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                        <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP.VPC_TIP_ENTER_THE_DOMAIN_NAME",{hash:{},data:i}))+'" type="text" maxlength="255" data-type="domain" data-ignore="true"></span>\n                    </div>\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label>'+u(n.i18n.call(t,"PROP.VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME_SERVER",{hash:{},data:i}))+'</label>\n                <div>\n                    <div class="modal-right" style="margin: 10px 0">\n                        <div class="checkbox">\n                            <input id="property-amazon-dns" ',o=n["if"].call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.amazonDNS),{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='type="checkbox">\n                            <label style="width: 14px" for="property-amazon-dns"></label>\n                        </div>\n                        <label for="property-amazon-dns">'+u(n.i18n.call(t,"PROP.VPC_DHCP_SPECIFIED_LBL_AMZN_PROVIDED_DNS",{hash:{},data:i}))+'</label>\n                    </div>\n                    <div id="property-domain-server" class="multi-input" data-max-row="',o=n["if"].call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.amazonDNS),{hash:{},inverse:f.program(5,h,i),fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='">\n                        ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.domainServers),{hash:{},inverse:f.program(9,d,i),fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+='\n                    </div>\n                </div>\n            </div>\n\n            <div class="control-group clearfix">\n                <label>'+u(n.i18n.call(t,"PROP.VPC_DHCP_SPECIFIED_LBL_NTP_SERVER",{hash:{},data:i}))+'</label>\n                <div id="property-ntp-server" class="multi-input" data-max-row="4">\n                    ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.ntpServers),{hash:{},inverse:f.program(13,m,i),fn:f.program(11,v,i),data:i});if(o||o===0)s+=o;s+='\n                </div>\n            </div>\n\n            <div class="control-group clearfix">\n                <label>'+u(n.i18n.call(t,"PROP.VPC_DHCP_SPECIFIED_LBL_NETBIOS_NAME_SERVER",{hash:{},data:i}))+'</label>\n                <div id="property-netbios-server" class="multi-input" data-max-row="4">\n                    ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.netbiosServers),{hash:{},inverse:f.program(17,y,i),fn:f.program(15,g,i),data:i});if(o||o===0)s+=o;s+='\n                </div>\n            </div>\n\n            <div class="control-group clearfix">\n                <label>'+u(n.i18n.call(t,"PROP.VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE",{hash:{},data:i}))+'</label>\n                <div class="selectbox selectbox-mega" id="property-netbios-type">\n                    <div class="selection tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP.VPC_TIP_SELECT_NETBIOS_NODE",{hash:{},data:i}))+'">',o=n.unless.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.netbiosType),{hash:{},inverse:f.noop,fn:f.program(19,b,i),data:i});if(o||o===0)s+=o;s+='</div>\n                    <ul class="dropdown" tabindex="-1">\n                        ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.netbiosTypes),{hash:{},inverse:f.noop,fn:f.program(21,w,i),data:i});if(o||o===0)s+=o;return s+='\n                    </ul>\n                </div>\n            </div>\n\n        </section>\n        <div class="init action">\n            <button class="btn btn-blue do-action" data-action="create">'+u(n.i18n.call(t,"PROP.LBL_CREATE",{hash:{},data:i}))+'</button>\n            <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n        </div>\n        <div class="processing action" style="display:none;">\n            <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.LBL_CREATING",{hash:{},data:i}))+"</button>\n        </div>\n    </div>\n</div>",s},n.slide_create=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="";return n+=a(typeof e===u?e.apply(e):e)+"<br>",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="detail-info">\n    <div class="detail-info-row">\n        <section class="property-control-group">\n            <label>'+a(n.i18n.call(t,"PROP.VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME",{hash:{},data:i}))+"</label>\n            <div>",o=n.each.call(t,t&&t["domain-name"],{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+a(n.i18n.call(t,"PROP.VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME_SERVER",{hash:{},data:i}))+"</label>\n            <div>",o=n.each.call(t,t&&t["domain-name-servers"],{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='</div>\n        </section>\n    </div>\n    <div class="detail-info-row">\n        <section class="property-control-group">\n            <label>'+a(n.i18n.call(t,"PROP.VPC_DHCP_SPECIFIED_LBL_NTP_SERVER",{hash:{},data:i}))+"</label>\n            <div>",o=n.each.call(t,t&&t["ntp-servers"],{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='</div>\n        </section>\n        <section class="property-control-group">\n\n            <label>'+a(n.i18n.call(t,"PROP.VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE",{hash:{},data:i}))+"</label>\n            <div>"+a((o=t&&t["netbios-node-type"],typeof o===u?o.apply(t):o))+"</div>\n        </section>\n    </div>\n</div>",s},n.detail_info=e.template(t),n}),define("dhcp_manage",["CloudResources","constant","UI.modalplus","toolbar_modal","i18n!/nls/lang.js","component/awscomps/DhcpTpl"],function(e,t,n,r,i,s){var o,u,a,f,l,c,h,p;return f=!1,l=!1,h={},p=function(){var e;return e=$("#property-domain-server").children().length,e>3?$("#property-amazon-dns").attr("disabled",!0):$("#property-amazon-dns").removeAttr("disabled")},c=function(e){var t,n,r,i,s;t=$(e),r=[];for(i=0,s=t.length;i<s;i++)n=t[i],n.value&&r.push(n.value);return r},u=0,a=0,o=Backbone.View.extend({constructor:function(){return this.collection=e(Design.instance().credentialId(),t.RESTYPE.DHCP,Design.instance().region()),this.listenTo(this.collection,"change",function(){return this.renderManager()}),this.listenTo(this.collection,"update",function(){return this.renderManager()}),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged),this},credChanged:function(){var e;return this.collection.fetchForce(),(e=this.manager)!=null&&e.renderLoading(),this.manager&&this.refreshManager()},remove:function(){return this.isRemoved=!0,Backbone.View.prototype.remove.call(this)},filter:function(e){var t;return t=_.filter(this.collection.toJSON(),function(t){return t.id.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.renderDropdown(t):this.renderDropdown()},render:function(){return this.manager=new r(this.getModalOptions()),this.manager.on("refresh",this.refreshManager,this),this.manager.on("slidedown",this.renderSlides,this),this.manager.on("action",this.doAction,this),this.manager.on("detail",this.detail,this),this.manager.on("close",function(e){return function(){return e.manager.remove()}}(this)),this.manager.render(),this.renderManager(),this.trigger("manage")},refreshManager:function(){return f=!1,this.renderManager()},renderManager:function(){var e,t,n,r,i;if((n=Design.instance().credential())!=null?n.isDemo():void 0)return(r=this.manager)!=null&&r.render("nocredential"),!1;t=this.initManager.bind(this),e=(i=Design.instance())!=null?i.get("region"):void 0;if(e&&(!f&&!l||!h[e]))return l=!0,h[e]=!0,this.collection.fetchForce().then(t,t);if(!l)return t()},initManager:function(){var e,t;return l=!1,f=!0,e=s.content({items:this.collection.toJSON()}),(t=this.manager)!=null?t.setContent(e):void 0},renderSlides:function(e,t){var n,r,i;return r=s["slide_"+e],n=this.getSlides(),(i=n[e])!=null?i.call(this,r,t):void 0},detail:function(e,t,n){var r,i,o;return o=t.id,i=this.collection.get(o).toJSON(),r=s.detail_info,this.manager.setDetail(n,r(i))},getSlides:function(){return{"delete":function(e,t){var n,r;n=t.length;if(!n)return;return r={},n===1?r.selectedId=t[0].data.id:r.selectedCount=n,this.manager.setSlide(e(r))},create:function(e){var t,n;return t={dhcp:{}},n=0,t.dhcp.netbiosTypes=[{id:"default",value:i.PROP.VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE_NOT_SPECIFIED,selected:n===0},{id:1,value:1,selected:n===1},{id:2,value:2,selected:n===2},{id:4,value:4,selected:n===4},{id:8,value:8,selected:n===8}],this.manager.setSlide(e(t)),this.manager.$el.find("#property-amazon-dns").change(function(e){return function(t){return e.onChangeAmazonDns(t)}}(this)),this.manager.$el.find(".multi-input").on("ADD_ROW",function(e){return function(t){return e.processParsley(t)}}(this)),this.manager.$el.find(".control-group .input").change(function(e){return function(t){return e.onChangeDhcpOptions(t)}}(this)),this.manager.$el.find(".formart_toolbar_modal").on("OPTION_CHANGE REMOVE_ROW",function(e){return function(t){return e.onChangeDhcpOptions(t)}}(this)),this.manager.$el.find("#property-domain-server").on("ADD_ROW REMOVE_ROW",p),p()}}},processParsley:function(e){return $(e.currentTarget).find("input").last().removeClass("parsley-validated").removeClass("parsley-error").next(".parsley-error-list").remove(),$(".parsley-error-list").remove()},doAction:function(e,t){return this[e]&&this[e](this.validate(e),t)},create:function(e,t){var n,r,i,s;if(!e)return i=c("#property-domain-server .input"),$("#property-amazon-dns").is(":checked")&&i.push("AmazonProvidedDNS"),r={"domain-name":c("#property-dhcp-domain .input"),"domain-name-servers":i,"ntp-servers":c("#property-ntp-server .input"),"netbios-name-servers":c("#property-netbios-server .input"),"netbios-node-type":[parseInt($("#property-netbios-type .selection").html(),10)||0]},s=function(e,t){return t==="netbios-node-type"?!1:e.length<1?!1:!0},_.some(r,s)?(r["netbios-node-type"][0]===0&&(r["netbios-node-type"]=[]),this.switchAction("processing"),n=this.afterCreated.bind(this),this.collection.create(r).save().then(n,n)):(this.manager.error("Please provide at least one field."),!1)},"delete":function(e,t){var n,r;return r=this,u+=t.length,this.switchAction("processing"),n=r.afterDeleted.bind(r),_.each(t,function(e){return function(t){return e.collection.findWhere({id:t.data.id}).destroy().then(n,n)}}(this))},afterDeleted:function(e){u--,e.error&&a++;if(u===0)return a>0?notification("error",sprintf(i.NOTIFY.FAILED_TO_DELETE_DHCP,a,e.awsResult)):notification("info",i.NOTIFY.DELETE_SUCCESSFULLY),this.manager.unCheckSelectAll(),a=0,this.manager.cancel()},afterCreated:function(e){return e.error?(this.manager.error("Create failed because of: "+(e.awsResult||e.msg)),this.switchAction(),!1):(notification("info",i.NOTIFY.DHCP_CREATED_SUCCESSFULLY),this.manager.cancel())},validate:function(e){switch(e){case"create":return this.manager.$el.find(".parsley-error").size()>0}},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return $(this).hasClass(e)?$(this).show():$(this).hide()})},onChangeAmazonDns:function(){var e,t,n,r;return r=$("#property-amazon-dns").is(":checked"),n=r?3:4,e=$("#property-domain-server").attr("data-max-row",n),t=e.children(),e.toggleClass("max",t.length>=n),null},onChangeDhcpOptions:function(e){e&&!$(e.currentTarget).closest("[data-bind=true]").parsley("validate")},getModalOptions:function(){var e,n,r;return r=this,e=Design.instance().get("region"),n=t.REGION_SHORT_LABEL[e],{title:sprintf(i.IDE.MANAGE_DHCP_IN_AREA,n),slideable:!0,resourceName:i.PROP.RESOURCE_NAME_DHCP,context:r,buttons:[{icon:"new-stack",type:"create",name:i.PROP.LBL_CREATE_DHCP_OPTIONS_SET},{icon:"del",type:"delete",disabled:!0,name:i.PROP.LBL_DELETE},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"200px",name:i.PROP.NAME},{sortable:!1,width:"480px",name:i.PROP.LBL_OPTIONS},{sortable:!1,width:"56px",name:i.PROP.LBL_DETAIL}]}}}),o}),define("dhcp",["CloudResources","constant","combo_dropdown","dhcp_manage","UI.modalplus","toolbar_modal","i18n!/nls/lang.js","component/awscomps/DhcpTpl"],function(e,t,n,r,i,s,o,u){var a,f;return f=!1,a=Backbone.View.extend({constructor:function(r){var i,s;return this.resModel=r!=null?r.resModel:void 0,this.collection=e(Design.instance().credentialId(),t.RESTYPE.DHCP,Design.instance().region()),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"update",this.render),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged),i={manageBtnValue:o.PROP.VPC_MANAGE_DHCP,filterPlaceHolder:o.PROP.VPC_FILTER_DHCP,resourceName:o.PROP.RESOURCE_NAME_DHCP},this.dropdown=new n(i),s=u.selection({isDefault:!1,isAuto:!0}),this.dropdown.setSelection(s),this.dropdown.on("open",this.show,this),this.dropdown.on("manage",this.manageDhcp,this),this.dropdown.on("change",this.setDHCP,this),this.dropdown.on("filter",this.filter,this),this},initialize:function(e){return _.extend(this,e)},credChanged:function(){var e;return(e=this.dropdown)!=null&&e.render("loading"),this.collection.fetchForce().then(function(e){return function(){return e.render()}}(this))},remove:function(){return this.isRemoved=!0,Backbone.View.prototype.remove.call(this)},render:function(){return f?this.renderDropdown():(this.renderLoading(),this.collection.fetch().then(function(e){return function(){return e.render()}}(this)),f=!0,!1)},show:function(){return Design.instance().credential()&&!Design.instance().credential().isDemo()?this.render():this.renderNoCredential()},renderNoCredential:function(){return this.dropdown.render("nocredential").toggleControls(!1)},renderLoading:function(){return this.dropdown.render("loading").toggleControls(!1)},renderDropdown:function(e){var t,n,r,i,s;return i=(s=this.resModel)!=null?s.toJSON().dhcp.appId:void 0,n=this.collection.toJSON(),r={isRuntime:!1,keys:n},i?_.each(n,function(e){e.id===i&&(e.selected=!0)}):r.auto=!0,i===""?r.auto=!0:i&&i==="default"&&(r["default"]=!0),e&&(r.keys=e,r.hideDefaultNoKey=!0),Design.instance()&&(Design.instance().modeIsApp()||Design.instance().modeIsAppEdit())&&(r.isRunTime=!0),t=u.keys(r),this.dropdown.toggleControls(!0),this.dropdown.setContent(t)},filter:function(e){var t;return t=_.filter(this.collection.toJSON(),function(t){return t.id.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.renderDropdown(t):this.renderDropdown()},setDHCP:function(e){var t,n;return e==="@auto"?t={id:""}:e==="@default"?t={id:"default"}:(n=this.collection.findWhere({id:e}),t=n.toJSON()),this.resModel.toJSON().dhcp.dhcpOptionsId=t.id,this.trigger("change",t)},setSelection:function(e){var t;return t=u.selection(e),this.dropdown.setSelection(t)},manageDhcp:function(){return(new r).render()}}),a}),define("component/awscomps/KpDialogTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var n="",r;return n+='\n<tr class="item" data-id="">\n    <td>\n        <div class="checkbox">\n            <input id="kp-select-'+u((r=e&&e.keyName,typeof r===o?r.apply(e):r))+'" type="checkbox" value="None" data-name="'+u((r=e&&e.keyName,typeof r===o?r.apply(e):r))+'" class="one-cb">\n            <label for="kp-select-'+u((r=e&&e.keyName,typeof r===o?r.apply(e):r))+'"></label>\n        </div>\n    </td>\n    <td>'+u((r=e&&e.keyName,typeof r===o?r.apply(e):r))+"</td>\n    <td>"+u((r=e&&e.keyFingerprint,typeof r===o?r.apply(e):r))+"</td>\n</tr>\n",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.keys,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.keys=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression;s+='<div class="slide-create" data-bind="true">\n    <div class="before-create">\n        <label for="create-kp-name">'+u(n.i18n.call(t,"PROP.KP_NAME",{hash:{},data:i}))+'</label>\n        <input class="input" type="text" id="create-kp-name" data-ignore="true" data-ignore-regexp="^[a-zA-Z0-9,_-]*$" data-required="true" maxlength="255" placeholder="allow alphanumber, _ or - up to 255 characters" autofocus>\n    </div>\n    <div class="after-create hide">',o=n.i18n.call(t,"PROP.KP_CREATED_NEED_TO_DOWNLOAD",{hash:{},data:i});if(o||o===0)s+=o;return s+='</div>\n    <div class="init action">\n        <button class="btn btn-blue do-action" data-action="create">'+u(n.i18n.call(t,"PROP.LBL_CREATE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.LBL_CREATING",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="download action" style="display:none;">\n        <a class="btn btn-blue do-action pulse" data-action="download" id="download-kp">'+u(n.i18n.call(t,"PROP.LBL_DOWNLOAD",{hash:{},data:i}))+'</a>\n        <button class="btn btn-silver cancel" disabled>'+u(n.i18n.call(t,"PROP.LBL_CLOSE",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_create=e.template(t),t=function(e,t,n,r,i){function f(e,t){return u(n.i18n.call(e,"PROP.KP_CONFIRM_DELETE_3",e&&e.selecteKeyName,{hash:{},data:t}))}function l(e,t){return u(n.i18n.call(e,"PROP.KP_CONFIRM_DELETE_2",e&&e.selectedCount,{hash:{},data:t}))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">'+u(n.i18n.call(t,"PROP.KP_CONFIRM_DELETE_1",{hash:{},data:i}))+" ",o=n["if"].call(t,t&&t.selecteKeyName,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;return s+='</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">'+u(n.i18n.call(t,"PROP.LBL_DELETE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.LBL_DELETING",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="slide-import" data-bind="true">\n    <label for="import-kp-name">'+o(n.i18n.call(t,"PROP.KP_NAME",{hash:{},data:i}))+'</label>\n    <input class="input" type="text" id="import-kp-name" data-ignore="true" data-ignore-regexp="^[a-zA-Z0-9,_-]*$" data-required="true" maxlength="255" placeholder="allow alphanumber, _ or - up to 255 characters">\n    <div class="import-zone">\n\n    </div>\n    <div class="init action">\n        <button class="btn" disabled>'+o(n.i18n.call(t,"PROP.LBL_IMPORT",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+o(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="ready action" style="display:none;">\n        <button class="btn btn-blue do-action" data-action="import">'+o(n.i18n.call(t,"PROP.LBL_IMPORT",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+o(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+o(n.i18n.call(t,"PROP.LBL_IMPORTING",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_import=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="upload-kp-component drop-zone">\n    <p class="upload-stuff">\n        '+o(n.i18n.call(t,"LBL_DROP",t&&t.type,{hash:{},data:i}))+'\n        <label for="modal-import" class="select-file-link">'+o(n.i18n.call(t,"PROP.KP_SELECT_A_FILE",{hash:{},data:i}))+'</label>\n        <span class="display-empty">'+o(n.i18n.call(t,"PROP.KP_OR_PASTE_KEY_CONTENT",{hash:{},data:i}))+'</span>\n        <span class="display-filled" style="display:none;">'+o(n.i18n.call(t,"PROP.KP_OR_PASTE_TO_UPDATE",{hash:{},data:i}))+'</span>\n        <input type="file" id="modal-import">\n    </p>\n    <p class="key-content"></p>\n</div>',s},n.upload=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<textarea autofocus spellcheck="false" class="safari-download-textarea input">'+a((o=t&&t.keypair,typeof o===u?o.apply(t):o))+"</textarea>",s},n.safari_download=e.template(t),n}),define("kp_upload",["component/awscomps/KpDialogTpl","backbone","jquery"],function(e,t,n){return t.View.extend({__data:null,events:{"paste .upload-kp-component":"onPaste","change .upload-kp-component":"hanldeFile","drop .upload-kp-component":"hanldeFile","dragenter .upload-kp-component":"addDragoverClass","dragleave .upload-kp-component":"removeDragoverClass","dragover .upload-kp-component":"dragoverHandler"},removeDragoverClass:function(e){return n(e.currentTarget).removeClass("dragover")},addDragoverClass:function(e){return n(e.currentTarget).addClass("dragover")},dragoverHandler:function(e){var t;return t=e.originalEvent.dataTransfer,t&&(t.dropEffect="copy"),e.stopPropagation(),e.preventDefault(),null},save:function(e){if(!e)return;return this.__data=e,this.$(".drop-zone").addClass("filled"),this.$(".key-content").text(e),this.trigger("load",e)},onPaste:function(e){var t;return t=e.originalEvent.clipboardData.getData("text/plain"),this.save(t)},hanldeFile:function(e){var t;e.stopPropagation(),e.preventDefault(),this.$(".drop-zone").removeClass("dragover"),this.$("#import-json-error").html(""),e=e.originalEvent,t=(e.dataTransfer||e.target).files;if(!t||!t.length)return;return this.__reader.readAsText(t[0]),null},initialize:function(e){var t,n;return n=this,n.type=e&&e.type||"public key",t=this.__reader=new FileReader,t.onload=function(e){return n.save(t.result),null},t.onerror=function(){return n.trigger("error"),null},null},getData:function(){return this.__data},render:function(){var t;return t={type:this.type},this.$el.html(e.upload(t)),this}})}),define("kp_manage",["toolbar_modal","UI.modalplus","component/awscomps/KpDialogTpl","kp_upload","backbone","jquery","constant","JsonExporter","CloudResources","i18n!/nls/lang.js","UI.notification"],function(e,t,n,r,i,s,o,u,a,f){var l;return l=u.download,i.View.extend({__needDownload:!1,__upload:null,__import:"",__mode:"normal",needDownload:function(){return arguments.length===1?(this.__needDownload=arguments[0],arguments[0]===!1&&this.M$(".cancel").prop("disabled",!1)):this.__needDownload&&notification("warning",f.NOTIFY.YOU_MUST_DOWNLOAD_THE_KEYPAIR),this.__needDownload},denySlide:function(){return!this.needDownload()},getRegion:function(){var e;return e=Design.instance().get("region"),o.REGION_SHORT_LABEL[e]},getModalOptions:function(){var e,t,n;return n=this,e=Design.instance().get("region"),t=o.REGION_SHORT_LABEL[e],{title:sprintf(f.IDE.MANAGE_KP_IN_AREA,t),slideable:_.bind(n.denySlide,n),resourceName:f.PROP.RESOURCE_NAME_KEYPAIR,context:n,buttons:[{icon:"new-stack",type:"create",name:f.IDE.COMPONENT_CREATE_KEYPAIR},{icon:"import",type:"import",name:f.IDE.COMPONENT_IMPORT_KEY_PAIR},{icon:"del",type:"delete",disabled:!0,name:f.IDE.COMPONENT_DELETE_KEY_PAIR},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"40%",name:f.IDE.COMPONENT_KEY_PAIR_COL_NAME},{sortable:!1,name:f.IDE.COMPONENT_KEY_PAIR_COL_FINGERPRINT}]}},initModal:function(){return new e(this.getModalOptions()),this.modal.on("close",function(){return this.remove()},this),this.modal.on("slidedown",this.renderSlides,this),this.modal.on("action",this.doAction,this),this.modal.on("refresh",this.refresh,this)},initialize:function(e){var t;return _.extend(this,e),this.collection=a(Design.instance().credentialId(),o.RESTYPE.KP,Design.instance().get("region")),this.initModal(),this.modal.render(),Design.instance().credential()&&!Design.instance().credential().isDemo()?(t=this,this.collection.fetch().then(function(){return t.renderKeys()})):this.modal.render("nocredential"),this.collection.on("update",this.renderKeys,this),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged)},credChanged:function(){return this.collection.fetchForce(),this.modal.renderLoading(),this.modal&&this.refresh()},renderKeys:function(){var e;return this.collection.isReady()?(e={keys:this.collection.toJSON()},this.modal.setContent(n.keys(e)),this):!1},__events:{"click #kp-create":"renderCreate","click #kp-import":"renderImport","click #kp-delete":"renderDelete","click #kp-refresh":"refresh","click .cancel":"cancel"},downloadKp:function(){return this.__downloadKp&&this.__downloadKp()},doAction:function(e,t){return this[e]&&this[e](this.validate(e),t)},validate:function(e){switch(e){case"create":return!this.M$("#create-kp-name").parsley("validate");case"import":return!this.M$("#import-kp-name").parsley("validate")}},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return s(this).hasClass(e)?s(this).show():s(this).hide()})},genDownload:function(e,r){return this.__downloadKp=function(){var i,o;s("body").hasClass("safari")?i=null:i=new Blob([r]);if(!i){o={template:n.safari_download({keypair:r}),title:f.IDE.TITLE_KEYPAIR_CONTENT,disableFooter:!0,disableClose:!0,width:"855px",height:"473px",compact:!0},new t(o),s(".safari-download-textarea").select();return}return l(i,e)},this.__downloadKp},genDeleteFinish:function(e){var t,n,r,i;return r=[],t=[],i=this,n=_.after(e,function(){i.cancel();if(r.length===1){void 0,notification("info",sprintf(f.NOTIFY.XXX_IS_DELETED,r[0].attributes.keyName));return}if(r.length>1){notification("info",sprintf(f.NOTIFY.SELECTED_KEYPAIRS_ARE_DELETED,r.length));return}i.collection.toJSON().length||(i.M$("#t-m-select-all").get(0).checked=!1),_.each(t,function(e){return void 0});if(t.length>0)return notification("error",f.NOTIFY.FAILED_TO_DELETE_KP)}),function(e){return void 0,!e.reason&&!e.msg?r.push(e):t.push(e),n()}},create:function(e){var t,n;n=this;if(!e)return t=this.M$("#create-kp-name").val(),this.switchAction("processing"),this.collection.create({keyName:t}).save().then(function(e){return n.needDownload(!0),n.genDownload(""+e.attributes.keyName+".pem",e.attributes.keyMaterial),n.switchAction("download"),n.M$(".before-create").hide(),n.M$(".after-create").find("span").text(e.attributes.keyName).end().show()},function(e){return n.modal.error(e.awsResult||e.reason||e.msg),n.switchAction()})},download:function(){return this.needDownload(!1),this.__downloadKp&&this.__downloadKp(),null},"delete":function(e,t){var n,r,i;return n=t.length,r=this.genDeleteFinish(n),this.switchAction("processing"),i=this,_.each(t,function(e){return function(t){return e.collection.findWhere({keyName:t.data.name.toString()}).destroy().then(r,r)}}(this))},"import":function(e){var t,n,r;r=this;if(!e){n=this.M$("#import-kp-name").val(),this.switchAction("processing");try{t=(typeof Base64!="undefined"&&Base64!==null?Base64.encode:void 0)?Base64.encode(r.__upload.getData()):window.btoa(r.__upload.getData())}catch(i){this.modal.error("Key is not in valid OpenSSH public key format"),r.switchAction("init");return}return this.collection.create({keyName:n,keyData:t}).save().then(function(e){return notification("info",sprintf(f.NOTIFY.XXX_IS_IMPORTED,n)),r.cancel()},function(e){var t;return e.awsResult&&e.awsResult.indexOf("Length exceeds maximum of 2048")>=0?t="Length exceeds maximum of 2048":t=e.awsResult||e.error_message||e.reason||e.msg,r.modal.error(t),r.switchAction("ready")})}},cancel:function(){return this.modal.cancel()},refresh:function(){var e;return(e=this.modal)!=null&&e.render("loading"),this.collection.fetchForce().then(function(e){return function(){return e.renderKeys()}}(this))},renderSlides:function(e,t){var r,i,s;return i=n["slide_"+e],r=this.getSlides(),(s=r[e])!=null?s.call(this,i,t):void 0},getSlides:function(){var e,t;return t=this,e=this.modal,{create:function(t,n){return e.setSlide(t)},"delete":function(t,n){var r,i;r=n.length;if(!r)return;return i={},r===1?i.selecteKeyName=n[0].data.name:i.selectedCount=r,e.setSlide(t(i))},"import":function(n,i){return e.setSlide(n),t.__upload&&t.__upload.remove(),t.__upload=new r({type:f.IDE.LBL_PUBLIC_KEY}),t.__upload.on("load",t.afterImport,this),t.M$(".import-zone").html(t.__upload.render().el)}}},afterImport:function(e){return this.switchAction("ready")}})}),define("component/awscomps/KpTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,e&&e.keyName,{hash:{},inverse:a.program(4,c,t),fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function l(e,t){var n="",r;return n+="\n        "+u((r=e&&e.keyName,typeof r===o?r.apply(e):r))+"\n    ",n}function c(e,t){var r="";return r+="\n        "+u(n.i18n.call(e,"COMPONENT_SELECT_KEYPAIR",{hash:{},data:t}))+"\n    ",r}function h(e,t){var r="",i;r+="\n    "+u((i=e&&e.keyName,typeof i===o?i.apply(e):i))+"\n    ",i=n["if"].call(e,e&&e.defaultKey,{hash:{},inverse:a.noop,fn:a.program(7,p,t),data:t});if(i||i===0)r+=i;r+="\n    ",i=n["if"].call(e,e&&e.noKey,{hash:{},inverse:a.noop,fn:a.program(7,p,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function p(e,t){var r="";return r+='\n        <i class="icon-info tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.INSTANCE_TIP_NO_KP",{hash:{},data:t}))+'"></i>\n    ',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n["if"].call(t,t&&t.isRunTime,{hash:{},inverse:a.program(6,h,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.selection=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n    ",i=n.unless.call(e,e&&e.isRunTime,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;r+='\n    <li data-id="@no" class="item',i=n["if"].call(e,e&&e.noKey,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" tabindex="-1">\n        '+a(n.i18n.call(e,"PROP.INSTANCE_NO_KP",{hash:{},data:t}))+'\n        <i class="icon-info tooltip" data-tooltip="'+a(n.i18n.call(e,"PROP.INSTANCE_TIP_NO_KP",{hash:{},data:t}))+'"></i>\n    </li>\n',r}function c(e,t){var r="",i;r+='\n    <li data-id="@default" class="item',i=n["if"].call(e,e&&e.defaultKey,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" tabindex="-1">\n        '+a(n.i18n.call(e,"PROP.INSTANCE_DEFAULT_KP",{hash:{},data:t}))+'\n        <i class="icon-info tooltip" data-tooltip=\''+a(n.i18n.call(e,"PROP.INSTANCE_TIP_DEFAULT_KP",{hash:{},data:t}))+"'></i>\n    </li>\n    ",r}function h(e,t){return" selected"}function p(e,t){var r="",i;r+='\n    <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+a((i=e&&e.keyName,typeof i===f?i.apply(e):i))+'" data-fingerprint="'+a((i=e&&e.keyFingerprint,typeof i===f?i.apply(e):i))+'" tabindex="-1">'+a((i=e&&e.keyName,typeof i===f?i.apply(e):i))+"\n    </li>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a=this.escapeExpression,f="function";o=n.unless.call(t,t&&t.hideDefaultNoKey,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n.each.call(t,t&&t.keys,{hash:{},inverse:u.noop,fn:u.program(5,p,i),data:i});if(o||o===0)s+=o;return s},n.keys=e.template(t),n}),define("kp_dropdown",["Design","kp_manage","combo_dropdown","component/awscomps/KpTpl","backbone","jquery","constant","i18n!/nls/lang.js","CloudResources"],function(e,t,n,r,i,s,o,u,a){var f;return f={},i.View.extend({showCredential:function(){return e.instance().project().showCredential()},filter:function(e){var t;return t=_.filter(this.getKey(),function(t){return t.keyName.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.renderKeys(t):this.renderKeys()},getKey:function(){var e,t;return t=this,e=this.collection.toJSON(),this.resModel&&_.each(e,function(e){if(e.keyName===t.resModel.getKeyName())return e.selected=!0}),e},setKey:function(t,n){var r;return this.__mode==="runtime"?(r=e.modelClassForType(o.RESTYPE.KP),t==="@no"?r.setDefaultKP("",""):r.setDefaultKP(t,n.fingerprint)):t==="@default"?this.resModel.setKey("",!0):t==="@no"?this.resModel.setKey(""):this.resModel.setKey(t)},manageKp:function(e){return this.renderModal(),!1},initDropdown:function(){var e;return e={manageBtnValue:u.PROP.INSTANCE_MANAGE_KP,filterPlaceHolder:u.PROP.INSTANCE_FILTER_KP,resourceName:u.PROP.RESOURCE_NAME_KEYPAIR},this.dropdown=new n(e),this.dropdown.on("open",this.show,this),this.dropdown.on("manage",this.manageKp,this),this.dropdown.on("change",this.setKey,this),this.dropdown.on("filter",this.filter,this)},initialize:function(t){var n;return this.resModel=t?t.resModel:null,n=e.instance().credentialId(),this.collection=a(n,o.RESTYPE.KP,e.instance().get("region")),this.listenTo(this.collection,"update",this.renderKeys),this.listenTo(this.collection,"change",this.renderKeys),this.listenTo(e.instance().credential(),"update",this.credChanged),this.listenTo(e.instance().credential(),"change",this.credChanged),this.resModel||(this.__mode="runtime"),this.initDropdown()},credChanged:function(){var e;return(e=this.dropdown)!=null&&e.render("loading"),this.collection.fetchForce().then(function(e){return function(){return e.renderKeys()}}(this))},show:function(){var t;return e.instance().credential()&&!e.instance().credential().isDemo()?(t=null,!f[e.instance().get("region")]&&this.collection.isReady()?(f[e.instance().get("region")]=!0,t=this.collection.fetchForce()):(f[e.instance().get("region")]=!0,t=this.collection.fetch()),t.then(function(e){return function(){return e.renderKeys()}}(this))):this.renderNoCredential()},render:function(){return this.renderDropdown(),this.el=this.dropdown.el,this},renderNoCredential:function(){return this.dropdown.render("nocredential").toggleControls(!1)},syncErrorHandler:function(e){return void 0},renderKeys:function(e){return this.collection.isReady()?(e&&arguments.length===1?e={keys:e,hideDefaultNoKey:!0}:e={keys:this.getKey()},this.resModel&&(this.resModel.isNoKey()&&(e.noKey=!0),this.resModel.isDefaultKey()&&(e.defaultKey=!0)),e.isRunTime=this.__mode==="runtime",this.dropdown.setContent(r.keys(e)),this.dropdown.toggleControls(!0),this):!1},renderDropdown:function(){var e;return this.data={keyName:this.resModel?this.resModel.getKeyName():""},this.data.keyName==="$DefaultKeyPair"?this.data.defaultKey=!0:this.data.keyName===u.PROP.INSTANCE_NO_KP&&(this.data.noKey=!0),this.data.isRunTime=this.__mode==="runtime",e=r.selection(this.data),this.dropdown.setSelection(e)},renderModal:function(){var e;return e=this,new t({model:e.data})},remove:function(){return this.dropdown.remove(),i.View.prototype.remove.apply(this,arguments)}},{hasResourceWithDefaultKp:function(){var t;return t=!1,e.instance().eachComponent(function(e){var n;if((n=e.type)===o.RESTYPE.INSTANCE||n===o.RESTYPE.LC)if(e.isDefaultKey()&&!e.get("appId"))return t=!0,!1}),t}})}),define("component/awscomps/SnsTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+="<span>"+o(n.i18n.call(t,"PROP.NONE",{hash:{},data:i}))+"</span>",s},n.dropdown_no_selection=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n    <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:o.noop,fn:o.program(2,l,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'" data-name="'+a((i=e&&e.Name,typeof i===u?i.apply(e):i))+'" tabindex="-1">\n        '+a((i=e&&e.Name,typeof i===u?i.apply(e):i))+'\n        <p><span class="icon-tag-sub">'+a((i=e&&e.subCount,typeof i===u?i.apply(e):i))+" sub</span> "+a((i=e&&e.DisplayName,typeof i===u?i.apply(e):i))+"</p>\n    </li>\n",r}function l(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this,u="function",a=this.escapeExpression;return s=n.each.call(t,t,{hash:{},inverse:o.noop,fn:o.program(1,f,i),data:i}),s||s===0?s:""},n.dropdown_list=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<tr class="item" data-topic-arn="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'">\n    <td>\n        <div class="checkbox">\n            <input id="kp-select-'+u((i=e&&e.Name,typeof i===o?i.apply(e):i))+'" type="checkbox" value="None" data-name="'+u((i=e&&e.Name,typeof i===o?i.apply(e):i))+'" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" class="one-cb">\n            <label for="kp-select-'+u((i=e&&e.Name,typeof i===o?i.apply(e):i))+'"></label>\n        </div>\n    </td>\n    <td>'+u((i=e&&e.Name,typeof i===o?i.apply(e):i))+"</td>\n    <td>"+u((i=e&&e.id,typeof i===o?i.apply(e):i))+"</td>\n    <td ",i=n["if"].call(e,e&&e.subCount,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+="><b>"+u((i=e&&e.subCount,typeof i===o?i.apply(e):i))+"</b> "+u(n.i18n.call(e,"PROP.SUBSCRIPTIONS",{hash:{},data:t}))+"</td>\n</tr>\n",r}function l(e,t){return'class="show-detail"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.modal_list=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n                    <li class="item" data-id="'+a((r=e&&e.id,typeof r===u?r.apply(e):r))+'" data-display-name="'+a((r=e&&e.DisplayName,typeof r===u?r.apply(e):r))+'">'+a((r=e&&e.Name,typeof r===u?r.apply(e):r))+"</li>\n                  ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-create" data-bind="true">\n    <div class="before-create">\n        <div>\n          <label>'+a(n.i18n.call(t,"PROP.SELECT_TOPIC",{hash:{},data:i}))+'</label>\n            <div class="selectbox dd-topic-name">\n                <div class="selection">'+a(n.i18n.call(t,"PROP.NEW_TOPIC",{hash:{},data:i}))+'</div>\n                <ul class="dropdown" tabindex="-1">\n                  <li class="item selected new-topic" data-id="@new">'+a(n.i18n.call(t,"PROP.NEW_TOPIC",{hash:{},data:i}))+"</li>\n                  ",o=n.each.call(t,t,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='\n                </ul>\n            </div>\n\n        </div>\n        <div class="create-sns-topic">\n            <label for="create-topic-name">'+a(n.i18n.call(t,"PROP.TOPIC_NAME",{hash:{},data:i}))+'</label>\n            <input class="input" type="text" id="create-topic-name" data-ignore="true" data-ignore-regexp="^[a-zA-Z0-9,_-]*$" data-required="true" maxlength="255" placeholder="Required. Up to 256 characters" data-event-trigger="false">\n        </div>\n        <div>\n            <label for="create-display-name">'+a(n.i18n.call(t,"PROP.DISPLAY_NAME",{hash:{},data:i}))+'</label>\n            <input class="input" type="text" id="create-display-name" maxlength="255" placeholder="Required for SMS subscriptions (up to 10 characters)" data-event-trigger="false">\n        </div>\n        <div>\n            <label>'+a(n.i18n.call(t,"PROP.ACL_TIP_PROTOCOL",{hash:{},data:i}))+'</label>\n            <div class="selectbox dd-protocol">\n                <div class="selection">email</div>\n                <ul class="dropdown" tabindex="-1">\n                    <li class="item" data-id="https">HTTPS</li>\n                    <li class="item" data-id="http">HTTP</li>\n                    <li class="item selected" data-id="email">Email</li>\n                    <li class="item" data-id="email-json">Email-JSON</li>\n                    <li class="item" data-id="sms">SMS</li>\n                    <li class="item" data-id="arn">Application</li>\n                    <li class="item" data-id="sqs">Amazon SQS</li>\n                </ul>\n            </div>\n        </div>\n        <div>\n            <label for="create-endpoint">'+a(n.i18n.call(t,"PROP.ENDPOINT",{hash:{},data:i}))+'</label>\n            <input type="text" class="input" id="create-endpoint" max-length="255" data-required="true" placeholder="example@mail.com" data-event-trigger="false">\n        </div>\n    </div>\n    <div class="init action">\n        <button class="btn btn-blue do-action" data-action="create" disabled>'+a(n.i18n.call(t,"PROP.LBL_CREATE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+a(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+a(n.i18n.call(t,"PROP.CREATING_3PERIOD",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="download action" style="display:none;">\n        <a class="btn btn-blue do-action pulse" data-action="download" id="download-kp">'+a(n.i18n.call(t,"PROP.LBL_DOWNLOAD",{hash:{},data:i}))+'</a>\n        <button class="btn btn-silver cancel" disabled>'+a(n.i18n.call(t,"PROP.LBL_CLOSE",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_create=e.template(t),t=function(e,t,n,r,i){function f(e,t){return u(n.i18n.call(e,"DELETE_SNS_TOPIC_CONFIRM",e&&e.selecteKeyName,{hash:{},data:t}))}function l(e,t){return u(n.i18n.call(e,"DELETE_SNS_TOPIC_CONFIRM_M",e&&e.selectedCount,{hash:{},data:t}))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">',o=n["if"].call(t,t&&t.selecteKeyName,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;return s+='</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">'+u(n.i18n.call(t,"PROP.LBL_DELETE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.DELETING_3PERIOD",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n        <tr>\n            <td>"+a((i=e&&e.Protocol,typeof i===u?i.apply(e):i))+"</td>\n            <td>"+a((i=e&&e.Endpoint,typeof i===u?i.apply(e):i))+"</td>\n            <td>"+a((i=e&&e.SubscriptionArn,typeof i===u?i.apply(e):i))+"</td>\n            <td>\n                ",i=n["if"].call(e,e&&e.isRemovable,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n            </td>\n        </tr>\n        ",r}function c(e,t){var r="",i;return r+='\n                    <a class="icon-delete remove"></a>\n                    <div class="do-remove-panel">\n                        <button class="btn btn-blue btn-small do-remove" data-id="'+a((i=e&&e.SubscriptionArn,typeof i===u?i.apply(e):i))+'">'+a(n.i18n.call(e,"PROP.LBL_DELETE",{hash:{},data:t}))+'</button>\n                        <button class="btn btn-link btn-small cancel">'+a(n.i18n.call(e,"PROP.LBL_CANCEL",{hash:{},data:t}))+"</button>\n                    </div>\n                ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table sns-detail">\n    <thead>\n        <tr>\n            <th style="width: 48px;">'+a(n.i18n.call(t,"PROP.ACL_TIP_PROTOCOL",{hash:{},data:i}))+"</th>\n            <th>"+a(n.i18n.call(t,"PROP.ENDPOINT",{hash:{},data:i}))+'</th>\n            <th style="wdith: 30%;">'+a(n.i18n.call(t,"PROP.SUBSCRIPTION_ARN",{hash:{},data:i}))+'</th>\n            <th style="width: 103px;"></th>\n        </tr>\n    </thead>\n    <tbody>\n        ',o=n.each.call(t,t,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n    </tbody>\n</table>",s},n.detail=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="combo-dd-no-data">\n    <p>'+o(n.i18n.call(t,"PROP.NO_SNS_TOPIC_IN_XXX",t&&t.regionName,{hash:{},data:i}))+'</p>\n\n    <a class="create-one">'+o(n.i18n.call(t,"PROP.CREATE_SNS_TOPIC",{hash:{},data:i}))+"</a>\n</div>",s},n.nosns=e.template(t),n}),define("sns_manage",["constant","CloudResources","toolbar_modal","component/awscomps/SnsTpl","i18n!/nls/lang.js"],function(e,t,n,r,i){return Backbone.View.extend({tagName:"section",initCol:function(){var n;return n=Design.instance().region(),this.subCol=t(Design.instance().credentialId(),e.RESTYPE.SUBSCRIPTION,n),this.topicCol=t(Design.instance().credentialId(),e.RESTYPE.TOPIC,n),this.topicCol.on("update",this.processCol,this),this.subCol.on("update",this.processSubUpdate,this)},processSubUpdate:function(){if(!this.M$(".tr-detail").length)return this.processCol()},processSubCreate:function(e){var t,n;return n=e.get("TopicArn"),t=this,this.M$(".detailed").each(function(){if($(this).data("topicArn")===n)return t.detail(null,$(this).data(),$(this)),!1})},quickCreate:function(){return this.modal.triggerSlide("create")},getModalOptions:function(){var t,n,r;return r=this,t=Design.instance().get("region"),n=e.REGION_SHORT_LABEL[t],{title:sprintf(i.IDE.MANAGE_SNS_IN_AREA,n),classList:"sns-manage",resourceName:i.IDE.RESOURCE_NAME_SNS,context:r,buttons:[{icon:"new-stack",type:"create",name:i.PROP.LBL_CREATE_SUBSCRIPTION},{icon:"del",type:"delete",disabled:!0,name:i.PROP.LBL_DELETE},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"25%",name:i.PROP.LBL_TOPIC},{sortable:!0,name:i.PROP.LBL_TOPIC_ARN},{sortable:!1,width:"20%",name:i.PROP.LBL_SUBSCRIPTION}]}},initModal:function(){return new n(this.getModalOptions()),this.modal.on("close",function(){return this.remove()},this),this.modal.on("slidedown",this.renderSlides,this),this.modal.on("action",this.doAction,this),this.modal.on("refresh",this.refresh,this),this.modal.on("detail",this.detail,this)},detail:function(e,t,n){var i,s;return s=this.getSubs(t.topicArn),t=_.map(s,function(e){var t;return t=e.toJSON(),t.isRemovable=e.isRemovable(),t}),i=this.modal.setDetail(n,r.detail(t)),this.processDetail(i,n)},processDetail:function(e,t){var n,r;return n=this,r=function(){var n;n=e.find(".sns-detail tbody tr").length,t.find(".show-detail b").text(n);if(n===0)return t.find(".show-detail").click()},e.on("click",".remove",function(){return $(this).hide(),e.find(".do-remove-panel").show()}).on("click",".cancel",function(){return $(this).closest(".do-remove-panel").hide(),e.find(".remove").show()}).on("click",".do-remove",function(){var e;return e=$(this),n.removeSub(e.data("id")).then(function(){return e.closest("tr").remove(),r()})}),r()},removeSub:function(e){var t;return t=this.subCol.findWhere({SubscriptionArn:e}),t!=null?t.destroy().then(function(e){return notification("info",i.NOTIFY.REMOVE_SUBSCRIPTION_SUCCEED),e}).fail(function(e){throw notification("error",e.awsResult),e}):void 0},fetch:function(){if(Design.instance().credential()&&!Design.instance().credential().isDemo())return this.topicCol.fetch(),this.subCol.fetch()},initialize:function(){return this.initCol(),this.initModal(),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged),this.fetch()},credChanged:function(){var e;return this.topicCol.fetchForce(),(e=this.modal)!=null&&e.renderLoading(),this.modal&&this.refresh()},doAction:function(e,t){return this[e]&&this[e](this.validate(e),t)},validate:function(e){switch(e){case"create":return!this.M$("#create-topic-name").parsley("validateForm")}},genDeleteFinish:function(e){var t,n,r,s;return r=[],t=[],s=this,n=_.after(e,function(){return s.modal.cancel(),r.length===1?notification("info",sprintf(i.NOTIFY.XXX_IS_DELETED,r[0].get("Name"))):r.length>1&&notification("info",sprintf(i.NOTIFY.SELECTED_XXX_SNS_TOPIC_ARE_DELETED,r.length)),t.length||s.modal.unCheckSelectAll(),_.each(t,function(e){return void 0})}),function(e){return e instanceof Backbone.Model?r.push(e):t.push(e),n()}},errorHandler:function(e){return this.modal.error(e.awsResult)},create:function(e){var t,n,r,s,o,u,a,f;return e?!1:(o=this,this.switchAction("processing"),u=this.M$(".dd-topic-name .selected").data("id"),s=this.M$(".dd-protocol .selected ").data("id"),f=this.M$("#create-topic-name").val(),n=this.M$("#create-display-name").val(),r=this.M$("#create-endpoint").val(),t=function(e){return o.subCol.create({TopicArn:e&&e.id||u,Endpoint:r,Protocol:s}).save().then(function(e){return o.processSubCreate(e),notification("info",i.NOTIFY.CREATE_SUBSCRIPTION_SUCCEED),o.modal.cancel()}).fail(function(e){return o.errorHandler(e)})},u==="@new"?this.topicCol.create({Name:f,DisplayName:n}).save().then(t).fail(function(e){return o.errorHandler(e)}):(a=this.topicCol.get(u),n===a.get("DisplayName")?t():a.update(n).then(t)))},"delete":function(e,t){var n,r,i;return n=t.length,i=this,r=this.genDeleteFinish(n),this.switchAction("processing"),_.each(t,function(e){var t;return t=i.topicCol.get(e.data.id),t!=null?t.destroy().then(r,r):void 0})},refresh:function(){return this.subCol.fetchForce(),this.topicCol.fetchForce()},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return $(this).hasClass(e)?$(this).show():$(this).hide()})},render:function(){return this.modal.render(),Design.instance().credential()&&!Design.instance().credential().isDemo()?this.processCol():this.modal.render("nocredential"),this},processCol:function(e){var t,n;return n=this,this.topicCol.isReady()&&this.subCol.isReady()&&(t=this.topicCol.map(function(e){var t,r;return r=e.toJSON(),t=n.subCol.where({TopicArn:r.id}),r.sub=t.map(function(e){return e.toJSON()}),r.subCount=r.sub.length,r}),e||this.renderList(t)),t},getSubs:function(e){return this.subCol.where({TopicArn:e})},renderList:function(e){return this.modal.setContent(r.modal_list(e))},renderNoCredential:function(){return this.modal.render("nocredential").toggleControls(!1)},renderSlides:function(e,t){var n,i,s;return i=r["slide_"+e],n=this.getSlides(),(s=n[e])!=null?s.call(this,i,t):void 0},getSlides:function(){var e,t;return t=this,e=this.modal,{create:function(n,r){var s,o,u,a;return e.setSlide(n(this.processCol(!0))),u=function(e){var n,r,s,o,u;o=t.M$(".dd-protocol .selected").data("id");switch(o){case"sqs":s=i.PROP.STACK_AMAZON_ARN,u=i.PROP.STACK_SQS,r=i.PARSLEY.PLEASE_PROVIDE_A_VALID_AMAZON_SQS_ARN;break;case"arn":s=i.PROP.STACK_AMAZON_ARN,u=i.PROP.STACK_ARN,r=i.PARSLEY.PLEASE_PROVIDE_A_VALID_APPLICATION_ARN;break;case"email":s=i.PROP.STACK_EXAMPLE_EMAIL,u=i.PROP.STACK_EMAIL,r=i.IDE.HEAD_MSG_ERR_UPDATE_EMAIL3;break;case"email-json":s=i.PROP.STACK_EXAMPLE_EMAIL,u=i.PROP.STACK_EMAIL,r=i.IDE.HEAD_MSG_ERR_UPDATE_EMAIL3;break;case"sms":s=i.PROP.STACK_E_G_1_206_555_6423,u=i.PROP.STACK_USPHONE,r=i.PARSLEY.PLEASE_PROVIDE_A_VALID_PHONE_NUMBER;break;case"http":s=i.PROP.STACK_HTTP_WWW_EXAMPLE_COM,u=i.PROP.STACK_HTTP,r=i.PARSLEY.PLEASE_PROVIDE_A_VALID_URL;break;case"https":s=i.PROP.STACK_HTTPS_WWW_EXAMPLE_COM,u=i.PROP.STACK_HTTPS,r=i.PARSLEY.PLEASE_PROVIDE_A_VALID_URL}return n=t.M$("#create-endpoint"),n.attr("placeholder",s),n.parsley("custom",function(e){if(u&&e&&!MC.validate(u,e))return r}),null},u("email"),t.M$("#create-display-name").parsley("custom",function(e){var n;return n=t.M$(".dd-protocol .selected").data("id"),n==="sms"&&!e?i.IDE.SMS_DISPLAY_NAME_IS_REQUIRED:null}),t.M$("#create-topic-name").parsley("custom",function(e){return t.topicCol.where({Name:e}).length?i.IDE.TOPIC_NAME_IS_ALREADY_TAKEN:null}),s=t.M$(".slide-create input[type=text]"),a=function(){var e;return e=!0,s.each(function(){var n;if($(this).is(":hidden"))return;if(this.id==="create-display-name"){n=t.M$(".dd-protocol .selected").data("id");if(n==="sms"&&!this.value.trim().length)return e=!1}else if(!this.value.trim().length)return e=!1}),e},o=function(e,n){var r;return r=e&&$(e.currentTarget)||$("#create-topic-name"),a()?t.M$(".slide-create .do-action").prop("disabled",!1):t.M$(".slide-create .do-action").prop("disabled",!0)},s.on("keyup",o),t.M$(".dd-protocol").off("OPTION_CHANGE").on("OPTION_CHANGE",function(e){return u(e),o(null,!0)}),t.M$(".dd-topic-name").off("OPTION_CHANGE").on("OPTION_CHANGE",function(e,n,r){return n==="@new"?t.M$(".create-sns-topic").show():(t.M$("#create-display-name").val(r.displayName),t.M$(".create-sns-topic").hide())})},"delete":function(t,n){var r,i;r=n.length;if(!r)return;return i={},r===1?i.selecteKeyName=n[0].data.name:i.selectedCount=r,e.setSlide(t(i))},"import":function(n,r){return e.setSlide(n),t.__upload&&t.__upload.remove(),t.__upload=new upload,t.__upload.on("load",t.afterImport,this),t.M$(".import-zone").html(t.__upload.render().el)}}},show:function(){return Design.instance().credential()&&!Design.instance().credential().isDemo()?(this.topicCol.fetch(),this.subCol.fetch(),this.processCol()):this.renderNoCredential()},filter:function(e){return this.processCol(!0,e)}})}),define("sns_dropdown",["constant","CloudResources","sns_manage","combo_dropdown","component/awscomps/SnsTpl","i18n!/nls/lang.js"],function(e,t,n,r,i,s){return Backbone.View.extend({tagName:"section",initCol:function(){var n;return n=Design.instance().region(),this.subCol=t(Design.instance().credentialId(),e.RESTYPE.SUBSCRIPTION,n),this.topicCol=t(Design.instance().credentialId(),e.RESTYPE.TOPIC,n),this.listenTo(this.topicCol,"update",this.processCol),this.listenTo(this.topicCol,"change",this.processCol),this.listenTo(this.subCol,"update",this.processCol),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged)},initDropdown:function(){var e;return e={manageBtnValue:s.PROP.INSTANCE_MANAGE_SNS,filterPlaceHolder:s.PROP.INSTANCE_FILTER_SNS,classList:"sns-dropdown",resourceName:s.PROP.RESOURCE_NAME_SNS},this.dropdown=new r(e),this.dropdown.on("open",this.show,this),this.dropdown.on("manage",this.manage,this),this.dropdown.on("change",this.set,this),this.dropdown.on("filter",this.filter,this),this.dropdown.on("quick_create",this.quickCreate,this)},initialize:function(e){e&&e.selection&&(this.selection=e.selection),this.initCol(),this.initDropdown();if(Design.instance().credential()&&!Design.instance().credential().isDemo())return this.topicCol.fetch(),this.subCol.fetch()},render:function(e){var t;return t=this.selection,e?this.topicCol.first()?(this.selection=t=this.topicCol.first().get("Name"),this.processCol(),this.trigger("change",this.topicCol.first().id,t)):t=i.dropdown_no_selection():t||(t=i.dropdown_no_selection()),this.dropdown.setSelection(t),this.el=this.dropdown.el,this},credChanged:function(){var e;return(e=this.dropdown)!=null&&e.render("loading"),this.topicCol.fetchForce()},quickCreate:function(){return(new n).render().quickCreate()},processCol:function(e,t){var n,r,i,s;return s=this,this.topicCol.isReady()&&this.subCol.isReady()&&(n=this.topicCol.map(function(e){var t,n;return n=e.toJSON(),t=s.subCol.where({TopicArn:n.id}),n.sub=t.map(function(e){return e.toJSON()}),n.subCount=n.sub.length,n}),e===!0&&(r=t.length,n=_.filter(n,function(e){return e.Name.toLowerCase().indexOf(t.toLowerCase())!==-1})),i=this.selection,_.each(n,function(e){if(e.Name&&e.Name===i)return e.selected=!0,null}),this.renderDropdownList(n,e)),!1},renderDropdownList:function(t,n){var r,s;return _.isEmpty(t)&&!n?(r=Design.instance().region(),s=e.REGION_SHORT_LABEL[r],this.dropdown.setContent(i.nosns({regionName:s})).toggleControls(!0,"manage").toggleControls(!1,"filter")):this.dropdown.setContent(i.dropdown_list(t)).toggleControls(!0)},renderNoCredential:function(){return this.dropdown.render("nocredential").toggleControls(!1)},show:function(){if(!Design.instance().credential()||!!Design.instance().credential().isDemo())return this.renderNoCredential();this.topicCol.fetch(),this.subCol.fetch();if(!this.dropdown.$(".item").length)return this.processCol()},manage:function(){return(new n).render()},set:function(e,t){return this.trigger("change",e,t.name)},filter:function(e){return this.processCol(!0,e)},remove:function(){return this.dropdown.remove(),Backbone.View.prototype.remove.apply(this,arguments)}})}),define("component/awscomps/SnapshotTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+='" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" tabindex="-1">\n    ',i=n["if"].call(e,e&&e.id,{hash:{},inverse:a.program(13,m,t),fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;return r+="\n</li>\n",r}function l(e,t){return" selected"}function c(e,t){var r="",i;r+='\n    <div class="manager-content-main" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'">',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:a.program(7,p,t),fn:a.program(5,h,t),data:t});if(i||i===0)r+=i;r+='</div>\n    <div class="manager-content-sub">',i=n["if"].call(e,e&&e.id,{hash:{},inverse:a.program(11,v,t),fn:a.program(9,d,t),data:t});if(i||i===0)r+=i;return r+=" &nbsp;&nbsp;&nbsp;&nbsp;Size: "+u((i=e&&e.size,typeof i===o?i.apply(e):i))+" GiB</div>\n    ",r}function h(e,t){var n;return u((n=(n=e&&e.tagSet,n==null||n===!1?n:n.Name),typeof n===o?n.apply(e):n))}function p(e,t){return"&lt;No Name&gt;"}function d(e,t){var n;return u((n=e&&e.id,typeof n===o?n.apply(e):n))}function v(e,t){var n;return u((n=e&&e.name,typeof n===o?n.apply(e):n))}function m(e,t){var n="",r;return n+='\n    <div class="manager-content-main" data-id="'+u((r=e&&e.region,typeof r===o?r.apply(e):r))+'">'+u((r=e&&e.name,typeof r===o?r.apply(e):r))+"</div>\n    ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.data,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.keys=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<tr class="item" data-id="">\n    <td>\n        <div class="checkbox">\n            <input id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" type="checkbox" value="None" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" data-name="'+u((i=e&&e.name,typeof i===o?i.apply(e):i))+'" class="one-cb">\n            <label for="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'"></label>\n        </div>\n    </td>\n    <td><div class="manager-content-main">',i=n["if"].call(e,e&&e.name,{hash:{},inverse:a.program(4,c,t),fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+='</div><span class="manager-content-sub">'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+"</span></td>\n    <td>"+u((i=e&&e.volumeSize,typeof i===o?i.apply(e):i))+' GiB</td>\n    <td>\n        <div class="manager-content-main">',i=n["if"].call(e,e&&e.completed,{hash:{},inverse:a.program(8,p,t),fn:a.program(6,h,t),data:t});if(i||i===0)r+=i;return r+='</div>\n        <span class="manager-content-sub">Started: '+u((i=e&&e.started,typeof i===o?i.apply(e):i))+"</span>\n    </td>\n    <td>"+u((i=e&&e.description,typeof i===o?i.apply(e):i))+"</td>\n</tr>\n",r}function l(e,t){var n;return u((n=e&&e.name,typeof n===o?n.apply(e):n))}function c(e,t){return"&lt;No Name&gt;"}function h(e,t){return'<i class="status status-green icon-label"></i> Completed'}function p(e,t){var n="",r;return n+='<i class="status status-yellow icon-label"></i> Pending - '+u((r=e&&e.progress,typeof r===o?r.apply(e):r))+"%",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.items,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.content=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n;return a((n=e&&e.selectedId,typeof n===u?n.apply(e):n))}function c(e,t){var r="",i;return r+=a(n.i18n.call(e,"PROP.DELETE_SNAPSHOT_2",{hash:{},data:t}))+a((i=e&&e.selectedCount,typeof i===u?i.apply(e):i))+a(n.i18n.call(e,"PROP.DELETE_SNAPSHOT_3",{hash:{},data:t})),r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">'+a(n.i18n.call(t,"PROP.DELETE_SNAPSHOT_1",{hash:{},data:i})),o=n["if"].call(t,t&&t.selectedId,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='?</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">'+a(n.i18n.call(t,"PROP.LBL_DELETE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+a(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+a(n.i18n.call(t,"PROP.LBL_DELETING",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="slide-create" data-bind="true">\n    <div class="formart_toolbar_modal" data-type="true">\n        <section data-bind="true">\n            <div class="control-group clearfix">\n                <label for="property-snapshot-name-create">'+o(n.i18n.call(t,"PROP.SNAPSHOT_SET_NAME",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id="property-snapshot-name-create" class="input" type="text" maxlength="255" data-type="domain" data-ignore="true" placeholder="Allow alpha number, _ or - up to 255 characters.">\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-volume-choose">'+o(n.i18n.call(t,"PROP.SNAPSHOT_SET_VOLUME",{hash:{},data:i}))+'</label>\n                <div>\n                    <div id="property-volume-choose"></div>\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-snapshot-desc-create">'+o(n.i18n.call(t,"PROP.SNAPSHOT_SET_DESC",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id=\'property-snapshot-desc-create\' class="input" placeholder="Up to 255 characters" type="text"/>\n                </div>\n            </div>\n\n        </section>\n        <div class="init action">\n            <button class="btn btn-blue do-action" data-action="create" disabled>'+o(n.i18n.call(t,"PROP.LBL_CREATE",{hash:{},data:i}))+'</button>\n            <button class="btn btn-silver cancel">'+o(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n        </div>\n        <div class="processing action" style="display:none;">\n            <button class="btn" disabled>'+o(n.i18n.call(t,"PROP.LBL_CREATING",{hash:{},data:i}))+"</button>\n        </div>\n    </div>\n</div>",s},n.slide_create=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+='<div class="slide-duplicate" data-bind="true">\n    <div class="formart_toolbar_modal" data-type="true">\n        <section data-bind="true">\n            <div class="control-group clearfix">\n                <label for="property-snapshot-source">'+u(n.i18n.call(t,"PROP.SNAPSHOT_SOURCE_SNAPSHOT",{hash:{},data:i}))+'</label>\n                <div>\n                    <p id="property-snapshot-source">'+u((o=(o=t&&t.originSnapshot,o==null||o===!1?o:o.id),typeof o===a?o.apply(t):o))+'</p>\n                </div>\n            </div>\n            <div class="control-group clearfix">\n                <label for="property-snapshot-name">'+u(n.i18n.call(t,"PROP.SNAPSHOT_SET_NEW_NAME",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id="property-snapshot-name" class="input" type="text" maxlength="255" data-type="domain" value="'+u((o=(o=t&&t.originSnapshot,o==null||o===!1?o:o.id),typeof o===a?o.apply(t):o))+'-copy" data-ignore="true">\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-region-choose">'+u(n.i18n.call(t,"PROP.SNAPSHOT_DESTINATION_REGION",{hash:{},data:i}))+'</label>\n                <div>\n                    <div id="property-region-choose"></div>\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-snapshot-desc">'+u(n.i18n.call(t,"PROP.SNAPSHOT_SET_DESC",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id=\'property-snapshot-desc\' class="input" value="[Copied '+u((o=(o=t&&t.originSnapshot,o==null||o===!1?o:o.id),typeof o===a?o.apply(t):o))+" from "+u((o=t&&t.region,typeof o===a?o.apply(t):o))+']" type="text"/>\n                </div>\n            </div>\n\n        </section>\n        <div class="init action">\n            <button class="btn btn-blue do-action" data-action="duplicate" disabled>'+u(n.i18n.call(t,"PROP.LBL_DUPLICATE",{hash:{},data:i}))+'</button>\n            <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n        </div>\n        <div class="processing action" style="display:none;">\n            <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.LBL_DUPLICATING",{hash:{},data:i}))+"</button>\n        </div>\n    </div>\n</div>",s},n.slide_duplicate=e.template(t),n}),define("snapshotManager",["CloudResources","ApiRequest","constant","combo_dropdown","UI.modalplus","toolbar_modal","i18n!/nls/lang.js","component/awscomps/SnapshotTpl"],function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p;return l=!1,a=0,f=0,c=!1,h={},p=Backbone.View.extend({constructor:function(){return this.collection=e(Design.instance().credentialId(),n.RESTYPE.SNAP,Design.instance().region()),this.listenTo(this.collection,"update",this.onChange.bind(this)),this.listenTo(this.collection,"change",this.onChange.bind(this)),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged),this},credChanged:function(){var e,t;return this.collection.fetchForce(),(e=this.manager)!=null&&e.renderLoading(),this.manager&&this.refresh(),(t=this.dropdown)!=null?t.render("loading"):void 0},onChange:function(){return this.initManager(),this.trigger("datachange",this)},remove:function(){return this.isRemoved=!0,Backbone.View.prototype.remove.call(this)},render:function(){return this.renderManager()},renderDropdown:function(){var t,i;return t={filterPlaceHolder:o.PROP.SNAPSHOT_FILTER_VOLUME,resourceName:o.PROP.RESOURCE_NAME_SNAPSHOT},this.dropdown=new r(t),this.volumes=e(Design.instance().credentialId(),n.RESTYPE.VOL,Design.instance().region()),i=o.PROP.VOLUME_SNAPSHOT_SELECT,this.dropdown.setSelection(i),this.dropdown.on("open",this.openDropdown,this),this.dropdown.on("filter",this.filterDropdown,this),this.dropdown.on("change",this.selectSnapshot,this),this.dropdown},renderRegionDropdown:function(){var e,t;return e={filterPlaceHolder:o.PROP.SNAPSHOT_FILTER_REGION},this.regionsDropdown=new r(e),this.regions=_.keys(n.REGION_LABEL),t=o.PROP.VOLUME_SNAPSHOT_SELECT_REGION,this.regionsDropdown.setSelection(t),this.regionsDropdown.on("open",this.openRegionDropdown,this),this.regionsDropdown.on("filter",this.filterRegionDropdown,this),this.regionsDropdown.on("change",this.selectRegion,this),this.regionsDropdown},openRegionDropdown:function(e){var t,r,i,s;return r=Design.instance().get("region"),i=_.map(this.regions,function(e){return{name:n.REGION_LABEL[e]+" - "+n.REGION_SHORT_LABEL[e],selected:e===r,region:e}}),s={isRuntime:!1,data:i},e&&(s.data=e,s.hideDefaultNoKey=!0),t=u.keys(s),this.regionsDropdown.toggleControls(!1,"manage"),this.regionsDropdown.toggleControls(!0,"filter"),this.regionsDropdown.setContent(t)},openDropdown:function(e){return this.volumes.fetch().then(function(t){return function(){var n,r,i,s;return i=t.volumes.toJSON(),r=Design.instance().get("region"),i=_.filter(i,function(e){return e.category===r}),s={isRuntime:!1,data:i},e&&(s.data=e,s.hideDefaultNoKey=!0),n=u.keys(s),t.dropdown.toggleControls(!1,"manage"),t.dropdown.toggleControls(!0,"filter"),t.dropdown.setContent(n)}}(this))},filterDropdown:function(e){var t;return t=_.filter(this.volumes.toJSON(),function(t){return t.id.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.openDropdown(t):this.openDropdown()},filterRegionDropdown:function(e){var t;return t=_.filter(this.regions,function(t){return t.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.openRegionDropdown(t):this.openRegionDropdown()},selectSnapshot:function(e){return this.manager.$el.find('[data-action="create"]').prop("disabled",!1)},selectRegion:function(e){return this.manager.$el.find('[data-action="duplicate"]').prop("disabled",!1)},renderManager:function(){var e,t;return this.manager=new s(this.getModalOptions()),this.manager.on("refresh",this.refresh,this),this.manager.on("slidedown",this.renderSlides,this),this.manager.on("action",this.doAction,this),this.manager.on("close",function(e){return function(){return e.manager.remove()}}(this)),this.manager.on("checked",this.processDuplicate,this),this.manager.render(),((e=Design.instance().credential())!=null?e.isDemo():void 0)?((t=this.manager)!=null&&t.render("nocredential"),!1):this.initManager()},processDuplicate:function(e,t){return t.length===1?this.M$("[data-btn=duplicate]").prop("disabled",!1):this.M$("[data-btn=duplicate]").prop("disabled",!0)},refresh:function(){return l=!1,this.initManager()},setContent:function(){var e,t,n,r;return c=!1,l=!0,t=this.collection.toJSON(),_.each(t,function(e,n){return e.progress===100&&(t[n].completed=!0),e.startTime&&(t[n].started=(new Date(e.startTime)).toString()),null}),n={items:t},e=u.content(n),(r=this.manager)!=null?r.setContent(e):void 0},initManager:function(){var e,t,n;t=this.setContent.bind(this),e=(n=Design.instance())!=null?n.get("region"):void 0;if(e&&(!l&&!c||!h[e]))return c=!0,h[e]=!0,this.collection.fetchForce().then(t,t);if(!c)return this.setContent()},renderSlides:function(e,t){var n,r,i;return r=u["slide_"+e],n=this.getSlides(),(i=n[e])!=null?i.call(this,r,t):void 0},getSlides:function(){return{"delete":function(e,t){var n,r;n=t.length;if(!n)return;return r={},n===1?r.selectedName=t[0].data.name:r.selectedCount=n,this.manager.setSlide(e(r))},create:function(e){var t;return t={volumes:{}},this.manager.setSlide(e(t)),this.dropdown=this.renderDropdown(),this.manager.$el.find("#property-volume-choose").html(this.dropdown.$el)},duplicate:function(e,t){var n;n={},n.originSnapshot=t[0],n.region=Design.instance().get("region");if(!t)return;return this.manager.setSlide(e(n)),this.regionsDropdown=this.renderRegionDropdown(),this.regionsDropdown.on("change",function(e){return function(){return e.manager.$el.find('[data-action="duplicate"]').prop("disabled",!1)}}(this)),this.manager.$el.find("#property-region-choose").html(this.regionsDropdown.$el)}}},doAction:function(e,t){return this["do_"+e]&&this["do_"+e]("do_"+e,t)},do_create:function(e,t){var n,r,i;return i=this.volumes.findWhere({id:$("#property-volume-choose").find(".selectbox .selection .manager-content-main").data("id")}),i?(r={name:$("#property-snapshot-name-create").val(),volumeId:i.id,description:$("#property-snapshot-desc-create").val()},this.switchAction("processing"),n=this.afterCreated.bind(this),this.collection.create(r).save().then(n,n)):!1},do_delete:function(e,t){var n,r;return r=this,a+=t.length,this.switchAction("processing"),n=r.afterDeleted.bind(r),_.each(t,function(e){return function(t){return e.collection.findWhere({id:t.data.id}).destroy().then(n,n)}}(this))},do_duplicate:function(e,t){var n,r,i,s,o;return s=t[0],o=$("#property-region-choose").find(".selectbox .selection .manager-content-main").data("id"),this.regions.indexOf(o)<0?!1:(this.switchAction("processing"),i=this.manager.$el.find("#property-snapshot-name").val(),r=this.manager.$el.find("#property-snapshot-desc").val(),n=this.afterDuplicate.bind(this),this.collection.findWhere({id:s.data.id}).copyTo(o,i,r).then(n,n))},afterCreated:function(e,t){return this.manager.cancel(),e.error?(notification("error",sprintf(o.NOTIFY.CREATE_FAILED_BECAUSE_OF_XXX,e.msg)),!1):notification("info",o.NOTIFY.NEW_SNAPSHOT_IS_CREATED_SUCCESSFULLY)},afterDuplicate:function(e){var t;return t=Design.instance().get("region"),this.manager.cancel(),e.error?(notification("error",sprintf,o.NOTIFY.DUPLICATE_FAILED_BECAUSE_OF_XXX,e.msg),!1):e.attributes.region===t?(this.collection.add(e),notification("info",o.NOTIFY.INFO_DUPLICATE_SNAPSHOT_SUCCESS)):(this.initManager(),notification("info",o.NOTIFY.INFO_ANOTHER_REGION_DUPLICATE_SNAPSHOT_SUCCESS))},afterDeleted:function(e){a--,e.error&&f++;if(a===0)return f>0?notification("error",sprintf(o.NOTIFY.XXX_SNAPSHOT_FAILED_TO_DELETE,f)):notification("info",o.NOTIFY.INFO_DELETE_SNAPSHOT_SUCCESSFULLY),this.manager.unCheckSelectAll(),f=0,this.manager.cancel()},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return $(this).hasClass(e)?$(this).show():$(this).hide()})},getModalOptions:function(){var e,t,r;return r=this,e=Design.instance().get("region"),t=n.REGION_SHORT_LABEL[e],{title:sprintf(o.IDE.MANAGE_SNAPSHOT_IN_AREA,t),slideable:!0,resourceName:o.PROP.RESOURCE_NAME_SNAPSHOT,context:r,buttons:[{icon:"new-stack",type:"create",name:o.PROP.CREATE_SNAPSHOT},{icon:"duplicate",type:"duplicate",disabled:!0,name:o.PROP.LBL_DUPLICATE},{icon:"del",type:"delete",disabled:!0,name:o.PROP.LBL_DELETE},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"20%",name:o.PROP.LBL_NAME},{sortable:!0,rowType:"number",width:"10%",name:o.PROP.LBL_CAPACITY},{sortable:!0,rowType:"datetime",width:"40%",name:o.PROP.LBL_STATUS},{sortable:!1,width:"30%",name:o.PROP.LBL_DESC}]}}}),p}),define("component/awscomps/RdsPgTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n    <tr class="item" data-id="">\n        <td>\n            <div class="checkbox">\n                <input id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" type="checkbox" value="None" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" data-name="'+u((i=e&&e.name,typeof i===o?i.apply(e):i))+'" class="one-cb" ',i=n["if"].call(e,e&&e.isDefault,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+='>\n                <label for="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'"></label>\n            </div>\n        </td>\n        <td>'+u((i=e&&e.DBParameterGroupName,typeof i===o?i.apply(e):i))+"</td>\n        <td>"+u((i=e&&e.DBParameterGroupFamily,typeof i===o?i.apply(e):i))+"</td>\n        <td>"+u((i=e&&e.Description,typeof i===o?i.apply(e):i))+"</td>\n    </tr>\n",r}function l(e,t){return"disabled"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.items,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.content=e.template(t),t=function(e,t,n,r,i){function f(e,t){return u(n.i18n.call(e,"CONFIRM_DELETE_PARAMETER_GROUP",e&&e.selectedId,{hash:{},data:t}))}function l(e,t){return u(n.i18n.call(e,"CONFIRM_DELETE_PARAMETER_GROUP_MULTY",e&&e.selectedCount,{hash:{},data:t}))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">',o=n["if"].call(t,t&&t.selectedId,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;return s+='</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">'+u(n.i18n.call(t,"PROP.LBL_DELETE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.LBL_DELETING",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="";return n+='\n                                        <li class="item" data-id="'+a(typeof e===u?e.apply(e):e)+'">'+a(typeof e===u?e.apply(e):e)+"</li>\n                                        ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-create" data-bind="true">\n    <div class="formart_toolbar_modal" data-type="true">\n        <section data-bind="true">\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-volume-choose">'+a(n.i18n.call(t,"PROP.DBPG_SET_FAMILY",{hash:{},data:i}))+'</label>\n                <div>\n                    <div id="property-family-choose">\n                        <div class="selectbox selectbox-mega" id="property-family">\n                            <div class="selection">'+a((o=(o=t&&t.families,o==null||o===!1?o:o[0]),typeof o===u?o.apply(t):o))+'</div>\n                            <div class="scroll-wrap" style="height: 160px">\n                                <div class="scrollbar-veritical-wrap" style="display: block;"><div class="scrollbar-veritical-thumb"></div></div>\n                                <div class="scroll-content">\n                                    <ul class="dropdown" tabindex="-1">\n                                        ',o=n.each.call(t,t&&t.families,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='\n                                    </ul>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n\n\n            <div class="control-group clearfix">\n                <label for="property-dbpg-name-create">'+a(n.i18n.call(t,"PROP.DBPG_SET_NAME",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id="property-dbpg-name-create" class="input" type="text" maxlength="255" data-ignore-regexp="^[a-zA-Z][a-zA-Z0-9-]*$" data-required="true" data-type="database" data-ignore="true" placeholder="Begin with a letter; must contain only ASCII letters, digits, and hyphens; and must not end with a hyphen or contain two consecutive hyphens">\n                </div>\n            </div>\n\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-dbpg-desc-create">'+a(n.i18n.call(t,"PROP.DBPG_SET_DESC",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id=\'property-dbpg-desc-create\' class="input" placeholder="Up to 255 characters" data-required="true" type="text"/>\n                </div>\n            </div>\n\n        </section>\n        <div class="init action">\n            <button class="btn btn-blue do-action" data-action="create" disabled>'+a(n.i18n.call(t,"PROP.LBL_CREATE",{hash:{},data:i}))+'</button>\n            <button class="btn btn-silver cancel">'+a(n.i18n.call(t,"PROP.LBL_CLOSE",{hash:{},data:i}))+'</button>\n        </div>\n        <div class="processing action" style="display:none;">\n            <button class="btn" disabled>'+a(n.i18n.call(t,"PROP.LBL_CREATING",{hash:{},data:i}))+"</button>\n        </div>\n    </div>\n</div>",s},n.slide_create=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+='<div class="slide-reset" data-bind="true">\n    <div class="formart_toolbar_modal" data-type="true">\n        <div class="modal-text-major">'+u(n.i18n.call(t,"PROP.DBPG_CONFIRM_RESET_1",{hash:{},data:i}))+u((o=t&&t.name,typeof o===a?o.apply(t):o))+u(n.i18n.call(t,"PROP.DBPG_CONFIRM_RESET_2",{hash:{},data:i}))+'</div>\n        <div class="init action">\n            <button class="btn btn-red do-action" data-action="reset">'+u(n.i18n.call(t,"PROP.LBL_RESET",{hash:{},data:i}))+'</button>\n            <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n        </div>\n        <div class="processing action" style="display:none;">\n            <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.LBL_RESETTING",{hash:{},data:i}))+"</button>\n        </div>\n    </div>\n</div>",s},n.slide_reset=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n                <th width="40%">'+u(n.i18n.call(e,"PROP.LBL_PARAMETER_NAME",{hash:{},data:t}))+'</th>\n                <th width="20%">'+u(n.i18n.call(e,"PROP.LBL_ORIGINAL_VALUE",{hash:{},data:t}))+'</th>\n                <th width="40%">'+u(n.i18n.call(e,"PROP.LBL_EDIT_VALUE",{hash:{},data:t}))+"</th>\n            ",r}function c(e,t){var r="";return r+='\n                <th width="50%">'+u(n.i18n.call(e,"PROP.LBL_PARAMETER_NAME",{hash:{},data:t}))+'</th>\n                <th width="50%">'+u(n.i18n.call(e,"PROP.LBL_EDIT_VALUE",{hash:{},data:t}))+"</th>\n            ",r}function h(e,t,r){var i="",s;i+='\n            <tr id="pg-'+u((s=e&&e.ParameterName,typeof s===a?s.apply(e):s))+'">\n                <td>\n                    <div class="prop_main">'+u((s=e&&e.ParameterName,typeof s===a?s.apply(e):s))+'\n                        <div class="prop_sub">('+u((s=e&&e.Source,typeof s===a?s.apply(e):s))+')</div>\n                    </div>\n                    <div class="prop_sub">'+u((s=e&&e.Description,typeof s===a?s.apply(e):s))+"</div>\n                </td>\n                ",s=n["if"].call(e,r&&r.preview,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(s||s===0)i+=s;i+='\n                <td>\n                    <div class="prop_main">\n                        ',s=n.ifCond.call(e,e&&e.inputType,"select",{hash:{},inverse:f.noop,fn:f.programWithDepth(14,y,t,e),data:t});if(s||s===0)i+=s;i+="\n                        ",s=n.ifCond.call(e,e&&e.inputType,"input",{hash:{},inverse:f.noop,fn:f.program(26,C,t),data:t});if(s||s===0)i+=s;i+='\n                    </div>\n                    <div class="prop_main">\n                        <div class="prop_sub">'+u(n.i18n.call(e,"PROP.DBPG_APPLY_IMMEDIATELY_1",{hash:{},data:t})),s=n.ifCond.call(e,e&&e.ApplyType,"dynamic",{hash:{},inverse:f.program(35,M,t),fn:f.program(33,O,t),data:t});if(s||s===0)i+=s;return i+="</div>\n                    </div>\n                </td>\n            </tr>\n        ",i}function p(e,t){var r="",i;r+='\n                    <td>\n                        <div class="prop_main" style="text-align: center">\n                            ',i=n["if"].call(e,e&&e.ParameterValue,{hash:{},inverse:f.program(9,v,t),fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n                        </div>\n                    </td>\n                ",r}function d(e,t){var n="",r;return n+="\n                                "+u((r=e&&e.ParameterValue,typeof r===a?r.apply(e):r))+"\n                            ",n}function v(e,t){var r="",i;r+="\n                                ",i=n.ifCond.call(e,e&&e.inputType,"select",{hash:{},inverse:f.program(12,g,t),fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;return r+="\n                            ",r}function m(e,t){return"&lt;engine-default&gt;"}function g(e,t){return"&lt;empty&gt;"}function y(e,t,r){var i="",s;i+='\n                            <select name="'+u((s=e&&e.ParameterName,typeof s===a?s.apply(e):s))+'" class="select3" ',s=n.unless.call(e,e&&e.IsModifiable,{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(s||s===0)i+=s;i+=">\n                            ",s=n.unless.call(e,e&&e.ParameterValue,{hash:{},inverse:f.noop,fn:f.program(17,w,t),data:t});if(s||s===0)i+=s;i+="\n                            ",s=n.each.call(e,e&&e.selections,{hash:{},inverse:f.noop,fn:f.programWithDepth(19,E,t,e,r),data:t});if(s||s===0)i+=s;return i+="\n                            </select>\n                        ",i}function b(e,t){return'disabled="disabled"'}function w(e,t){return'<option value="<engine-default>">&lt;engine-default&gt;</option>'}function E(e,t,r,i){var s="",o;s+='\n                                <option value="'+u(typeof e===a?e.apply(e):e)+'" ',o=n["if"].call(e,i&&i.newValue,{hash:{},inverse:f.programWithDepth(23,T,t,r),fn:f.programWithDepth(20,S,t,r),data:t});if(o||o===0)s+=o;return s+=">"+u(typeof e===a?e.apply(e):e)+"</option>\n                            ",s}function S(e,t,r){var i;return i=n.ifCond.call(e,r&&r.newValue,e,{hash:{},inverse:f.noop,fn:f.program(21,x,t),data:t}),i||i===0?i:""}function x(e,t){return'selected="selected" '}function T(e,t,r){var i;return i=n.ifCond.call(e,r&&r.ParameterValue,e,{hash:{},inverse:f.noop,fn:f.program(24,N,t),data:t}),i||i===0?i:""}function N(e,t){return'selected="selected"'}function C(e,t){var r="",i;r+='\n                            <input type="text" class="input prop-half-width" name="'+u((i=e&&e.ParameterName,typeof i===a?i.apply(e):i))+'" value="',i=n["if"].call(e,e&&e.newValue,{hash:{},inverse:f.program(29,L,t),fn:f.program(27,k,t),data:t});if(i||i===0)r+=i;r+='" ',i=n.unless.call(e,e&&e.IsModifiable,{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;r+="/>\n                            ",i=n["if"].call(e,e&&e.AllowedValues,{hash:{},inverse:f.noop,fn:f.program(31,A,t),data:t});if(i||i===0)r+=i;return r+="\n                        ",r}function k(e,t){var n;return u((n=e&&e.newValue,typeof n===a?n.apply(e):n))}function L(e,t){var n;return u((n=e&&e.ParameterValue,typeof n===a?n.apply(e):n))}function A(e,t){var n="",r;return n+='<div class="prop_sub">('+u((r=e&&e.AllowedValues,typeof r===a?r.apply(e):r))+")</div>",n}function O(e,t){return u(n.i18n.call(e,"PROP.DBPG_APPLY_IMMEDIATELY_2",{hash:{},data:t}))}function M(e,t){return u(n.i18n.call(e,"PROP.DBPG_APPLY_IMMEDIATELY_3",{hash:{},data:t}))}function _(e,t){var r="";return r+='\n            <button class="btn do-action" id="pg-back-to-edit">'+u(n.i18n.call(e,"PROP.LBL_BACK_TO_EDITING",{hash:{},data:t}))+'</button>\n            <button class="btn btn-blue" id="rds-pg-save">'+u(n.i18n.call(e,"PROP.LBL_APPLY_CHANGES",{hash:{},data:t}))+"</button>\n        ",r}function D(e,t){var r="";return r+='\n            <button class="btn btn-blue do-action" data-action="preview" disabled>'+u(n.i18n.call(e,"PROP.LBL_REVIEW_CHANGES_SAVE",{hash:{},data:t}))+"</button>\n        ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<div class="clearfix" id="pg-sort-filter">\n    <div class="pull-left">\n        '+u(n.i18n.call(t,"PROP.LBL_FILTER",{hash:{},data:i}))+' <input id="pg-filter-parameter-name" class="input" type="text" placeholder="'+u(n.i18n.call(t,"PROP.DBPG_FILTER_BY_NAME",{hash:{},data:i}))+'"/>\n    </div>\n    <div class="pull-right">\n        '+u(n.i18n.call(t,"PROP.LBL_SORT_BY",{hash:{},data:i}))+'\n        <div class="selectbox" id="sort-parameter-name">\n            <div class="selection">'+u(n.i18n.call(t,"PROP.LBL_PARAMETER_NAME",{hash:{},data:i}))+'</div>\n            <ul class="dropdown" tabindex="-1">\n                <li class="item selected" data-id="ParameterName">'+u(n.i18n.call(t,"PROP.LBL_PARAMETER_NAME",{hash:{},data:i}))+'</li>\n                <li class="item" data-id="IsModifiable">'+u(n.i18n.call(t,"PROP.LBL_ISMODIFIABLE",{hash:{},data:i}))+'</li>\n                <li class="item" data-id="ApplyType">'+u(n.i18n.call(t,"PROP.LBL_APPLY_METHOD",{hash:{},data:i}))+'</li>\n                <li class="item" data-id="Source">'+u(n.i18n.call(t,"PROP.LBL_SOURCE",{hash:{},data:i}))+'</li>\n            </ul>\n        </div>\n    </div>\n</div>\n<div id="parameter-table" style="height: '+u(n.or.call(t,t&&t.height,310,{hash:{},data:i}))+'px">\n    <table class="table">\n        <thead>\n        <tr>\n            ',o=n["if"].call(t,t&&t.preview,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n        </tr>\n        </thead>\n        <tbody>\n        ",o=n.each.call(t,t&&t.data,{hash:{},inverse:f.noop,fn:f.programWithDepth(5,h,i,t),data:i});if(o||o===0)s+=o;s+='\n        </tbody>\n    </table>\n</div>\n<div class="pg-edit-footer clearfix">\n    <a target="_blank" href="http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_ParamValuesRef.html">'+u(n.i18n.call(t,"PROP.LBL_PARAMETER_VALUE_REFERENCE",{hash:{},data:i}))+'</a>\n    <div class="init action" style="padding: 10px 0">\n        ',o=n["if"].call(t,t&&t.preview,{hash:{},inverse:f.program(39,D,i),fn:f.program(37,_,i),data:i});if(o||o===0)s+=o;return s+='\n        <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="padding: 10px 0;display: none">\n        <button class="btn btn-blue" id="rds-pg-save" disabled>'+u(n.i18n.call(t,"PROP.LBL_APPLYING",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel" disabled>'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_edit=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n            <th width="40%">'+u(n.i18n.call(e,"PROP.LBL_PARAMETER_NAME",{hash:{},data:t}))+'</th>\n            <th width="20%">'+u(n.i18n.call(e,"PROP.LBL_ORIGINAL_VALUE",{hash:{},data:t}))+'</th>\n            <th width="40%">'+u(n.i18n.call(e,"PROP.LBL_EDIT_VALUE",{hash:{},data:t}))+"</th>\n        ",r}function c(e,t){var r="";return r+='\n            <th width="50%">'+u(n.i18n.call(e,"PROP.LBL_PARAMETER_NAME",{hash:{},data:t}))+'</th>\n            <th width="50%">'+u(n.i18n.call(e,"PROP.LBL_EDIT_VALUE",{hash:{},data:t}))+"</th>\n        ",r}function h(e,t,r){var i="",s;i+='\n        <tr id="pg-'+u((s=e&&e.ParameterName,typeof s===a?s.apply(e):s))+'">\n            <td>\n                <div class="prop_main">'+u((s=e&&e.ParameterName,typeof s===a?s.apply(e):s))+'\n                    <div class="prop_sub">('+u((s=e&&e.Source,typeof s===a?s.apply(e):s))+')</div>\n                </div>\n                <div class="prop_sub">'+u((s=e&&e.Description,typeof s===a?s.apply(e):s))+"</div>\n            </td>\n            ",s=n["if"].call(e,r&&r.preview,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(s||s===0)i+=s;i+='\n            <td>\n                <div class="prop_main">\n                    ',s=n.ifCond.call(e,e&&e.inputType,"select",{hash:{},inverse:f.noop,fn:f.programWithDepth(14,y,t,e),data:t});if(s||s===0)i+=s;i+="\n                    ",s=n.ifCond.call(e,e&&e.inputType,"input",{hash:{},inverse:f.noop,fn:f.program(26,C,t),data:t});if(s||s===0)i+=s;i+='\n                </div>\n                <div class="prop_main">\n                    <div class="prop_sub">'+u(n.i18n.call(e,"PROP.DBPG_APPLY_IMMEDIATELY_1",{hash:{},data:t})),s=n.ifCond.call(e,e&&e.ApplyType,"dynamic",{hash:{},inverse:f.program(35,M,t),fn:f.program(33,O,t),data:t});if(s||s===0)i+=s;return i+="</div>\n                </div>\n            </td>\n        </tr>\n    ",i}function p(e,t){var r="",i;r+='\n                <td>\n                    <div class="prop_main" style="text-align: center">\n                        ',i=n["if"].call(e,e&&e.ParameterValue,{hash:{},inverse:f.program(9,v,t),fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n                    </div>\n                </td>\n            ",r}function d(e,t){var n="",r;return n+="\n                            "+u((r=e&&e.ParameterValue,typeof r===a?r.apply(e):r))+"\n                        ",n}function v(e,t){var r="",i;r+="\n                            ",i=n.ifCond.call(e,e&&e.inputType,"select",{hash:{},inverse:f.program(12,g,t),fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;return r+="\n                        ",r}function m(e,t){return"&lt;engine-default&gt;"}function g(e,t){return"&lt;empty&gt;"}function y(e,t,r){var i="",s;i+='\n                        <select name="'+u((s=e&&e.ParameterName,typeof s===a?s.apply(e):s))+'" class="select3" ',s=n.unless.call(e,e&&e.IsModifiable,{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(s||s===0)i+=s;i+=">\n                            ",s=n.unless.call(e,e&&e.ParameterValue,{hash:{},inverse:f.noop,fn:f.program(17,w,t),data:t});if(s||s===0)i+=s;i+="\n                            ",s=n.each.call(e,e&&e.selections,{hash:{},inverse:f.noop,fn:f.programWithDepth(19,E,t,e,r),data:t});if(s||s===0)i+=s;return i+="\n                        </select>\n                    ",i}function b(e,t){return'disabled="disabled"'}function w(e,t){return'<option value="<engine-default>">&lt;engine-default&gt;</option>'}function E(e,t,r,i){var s="",o;s+='\n                                <option value="'+u(typeof e===a?e.apply(e):e)+'" ',o=n["if"].call(e,i&&i.newValue,{hash:{},inverse:f.programWithDepth(23,T,t,r),fn:f.programWithDepth(20,S,t,r),data:t});if(o||o===0)s+=o;return s+=">"+u(typeof e===a?e.apply(e):e)+"</option>\n                            ",s}function S(e,t,r){var i;return i=n.ifCond.call(e,r&&r.newValue,e,{hash:{},inverse:f.noop,fn:f.program(21,x,t),data:t}),i||i===0?i:""}function x(e,t){return'selected="selected" '}function T(e,t,r){var i;return i=n.ifCond.call(e,r&&r.ParameterValue,e,{hash:{},inverse:f.noop,fn:f.program(24,N,t),data:t}),i||i===0?i:""}function N(e,t){return'selected="selected"'}function C(e,t){var r="",i;r+='\n                        <input type="text" class="input prop-half-width" name="'+u((i=e&&e.ParameterName,typeof i===a?i.apply(e):i))+'" value="',i=n["if"].call(e,e&&e.newValue,{hash:{},inverse:f.program(29,L,t),fn:f.program(27,k,t),data:t});if(i||i===0)r+=i;r+='" ',i=n.unless.call(e,e&&e.IsModifiable,{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;r+="/>\n                        ",i=n["if"].call(e,e&&e.AllowedValues,{hash:{},inverse:f.noop,fn:f.program(31,A,t),data:t});if(i||i===0)r+=i;return r+="\n                    ",r}function k(e,t){var n;return u((n=e&&e.newValue,typeof n===a?n.apply(e):n))}function L(e,t){var n;return u((n=e&&e.ParameterValue,typeof n===a?n.apply(e):n))}function A(e,t){var n="",r;return n+='<div class="prop_sub">('+u((r=e&&e.AllowedValues,typeof r===a?r.apply(e):r))+")</div>",n}function O(e,t){return u(n.i18n.call(e,"PROP.DBPG_APPLY_IMMEDIATELY_2",{hash:{},data:t}))}function M(e,t){return u(n.i18n.call(e,"PROP.DBPG_APPLY_IMMEDIATELY_3",{hash:{},data:t}))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<table class="table">\n    <thead>\n    <tr>\n        ',o=n["if"].call(t,t&&t.preview,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n    </tr>\n    </thead>\n    <tbody>\n    ",o=n.each.call(t,t&&t.data,{hash:{},inverse:f.noop,fn:f.programWithDepth(5,h,i,t),data:i});if(o||o===0)s+=o;return s+="\n    </tbody>\n</table>",s},n.filter=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="loading-spinner"></div>'},n.loading=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n    <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:o.noop,fn:o.program(2,l,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'" tabindex="-1">'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+"</li>\n",r}function l(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this,u="function",a=this.escapeExpression;return s=n.each.call(t,t&&t.keys,{hash:{},inverse:o.noop,fn:o.program(1,f,i),data:i}),s||s===0?s:""},n.keys=e.template(t),n}),define("rds_pg",["CloudResources","ApiRequest","constant","UI.modalplus","combo_dropdown","toolbar_modal","i18n!/nls/lang.js","component/awscomps/RdsPgTpl"],function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p;return c=!1,f=0,l=0,h=!1,p={},a=Backbone.View.extend({constructor:function(t){return t&&(this.resModel=t),this.collection=e(Design.instance().credentialId(),n.RESTYPE.DBPG,Design.instance().region()),this.listenTo(this.collection,"update",this.onUpdate.bind(this)),this.listenTo(this.collection,"change",this.onUpdate.bind(this)),this.listenTo(this.collection,"remove",this.onRemove.bind(this)),this.listenTo(this.collection,"add",this.onAdd.bind(this)),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged),this},credChanged:function(){var e,t;return(e=this.dropdown)!=null&&e.render("loading"),(t=this.manager)!=null&&t.renderLoading(),this.manager&&this.refresh(),this.collection.fetchForce()},onUpdate:function(){return this.initManager(),this.trigger("datachange",this)},onAdd:function(){return this.initDropdown()},onRemove:function(){var e;return this.initDropdown(),this.resModel&&!this.collection.get(this.resModel.get("pgName"))&&this.resModel.setDefaultParameterGroup(this.resModel.get("engineVersion")),(e=this.dropdown)!=null?e.setSelection(this.resModel.get("pgName")):void 0},remove:function(){return Backbone.View.prototype.remove.call(this)},render:function(){return this.renderManager()},enableCreate:function(){return this.manager.$el.find('[data-action="create"]').prop("disabled",!1)},selectRegion:function(){return this.manager.$el.find('[data-action="reset"]').prop("disabled",!1)},renderManager:function(){var e,t;return this.manager=new s(this.getModalOptions()),this.manager.on("refresh",this.refresh,this),this.manager.on("slidedown",this.renderSlides,this),this.manager.on("slideup",this.slideDown,this),this.manager.on("action",this.doAction,this),this.manager.on("close",function(e){return function(){return e.manager.remove(),e.collection.remove()}}(this)),this.manager.on("checked",this.processReset,this),this.manager.render(),((e=Design.instance().credential())!=null?e.isDemo():void 0)?((t=this.manager)!=null&&t.render("nocredential"),!1):this.initManager()},initManager:function(){var e,t;t=this.setContent.bind(this),e=Design.instance().get("region");if(!c&&!h||!p[e])return h=!0,p[e]=!0,this.collection.fetchForce().then(t,t);if(!h)return this.setContent()},processReset:function(e,t){var n,r;return t.length===1&&!this.collection.findWhere({id:t[0].data.id}).isDefault()?this.M$("[data-btn=reset],[data-btn=edit]").prop("disabled",!1):this.M$("[data-btn=reset],[data-btn=edit]").prop("disabled",!0),r=this,n=_.every(t,function(e){var t;return t=!r.collection.findWhere({id:e.data.id}).isDefault(),t}),t.length>=1&&n?window.setTimeout(function(){return r.M$("[data-btn=delete]").prop("disabled",!1)},1):window.setTimeout(function(){return r.M$("[data-btn=delete]").prop("disabled",!0)},1)},refresh:function(){return c=!1,this.initManager()},setContent:function(){var e,t,n,r;return h=!1,c=!0,t=this.collection.toJSON(),_.each(t,function(e){if(e.DBParameterGroupName.indexOf("default.")===0)return e.isDefault=!0,e}),n={items:t},e=u.content(n),(r=this.manager)!=null?r.setContent(e):void 0},renderSlides:function(e,t){var n,r,i;return r=u["slide_"+e],$(".slidebox .content").removeAttr("style"),n=this.getSlides(),(i=n[e])!=null?i.call(this,r,t):void 0},slideDown:function(e,t){var n,r;if(e==="edit"&&t.length===1)return r=this.collection.findWhere({id:t[0].data.id}),n=r.getParameters(),n.fetch().then(function(e){return _.each(e.models,function(e){if(e.has("newValue"))return e.unset("newValue")})})},getSlides:function(){return{"delete":function(e,t){var n,r;n=t.length;if(!n)return;return r={},n===1?r.selectedId=t[0].data.id:r.selectedCount=n,this.manager.setSlide(e(r))},create:function(t){var r;return this.families=e(Design.instance().credentialId(),n.RESTYPE.DBENGINE,Design.instance().get("region")),r=this,this.families.fetch().then(function(){var e,n;return n=_.uniq(_.pluck(r.families.toJSON(),"DBParameterGroupFamily")),e={families:n},r.manager.setSlide(t(e)),$("#property-dbpg-name-create").keyup(function(){var e;return e=!$(this).val(),r.manager.$el.find('[data-action="create"]').prop("disabled",e)})})},edit:function(e,t,n){var r,i,s;return t?(s=this,i=this.collection.findWhere({id:t[0].data.id}),r=i.getParameters(),n||s.manager.setSlide(u.loading()),r.fetch().then(function(t){return t.error&&(s.manager.cancel(),notification("error",t.awsResult||t.msg)),s.renderEditTpl(r,e,n),$(".slidebox .content").css({width:"100%","margin-top":"0px"}),s.bindEditEvent(r,e,n)})):!1},reset:function(e,t){var n;n={name:t[0].data.id};if(!t)return;return this.manager.setSlide(e(n))}}},renderEditTpl:function(e,t,n){var r,i,s,o;o=this,r=e.toJSON?e.toJSON():e,s=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},i=function(e){var t,n;return t=!1,n=e.split(","),_.each(n,function(e){var n;n=e.split("-");if(n.length===2&&s(n[0])&&s(n[1]))return t=!0,null}),t},_.each(r,function(e){var t;((t=e.AllowedValues)!=null?t.split(",").length:void 0)>1&&!i(e.AllowedValues)?(e.inputType="select",e.selections=e.AllowedValues.split(",")):e.inputType="input"});if(n!=null?n.sort:void 0)r=_.sortBy(r,function(e){var t;return t=e.ParameterName,n.sort==="ParameterName"&&(t=e.ParameterName),n.sort==="IsModifiable"&&(t=e.IsModifiable),n.sort==="ApplyType"&&(t=e.ApplyType),n.sort==="Source"&&(t=e.Source),t}),$("#parameter-table").html(u.filter({data:r}));if(n!=null?n.filter:void 0)r=_.filter(r,function(e){return e.ParameterName.toLowerCase().indexOf(n.filter.toLowerCase())>-1}),$("#parameter-table").html(u.filter({data:r}));return(n!=null?n.filter:void 0)||(n!=null?n.sort:void 0)?!1:(void 0,o.manager.setSlide(t({data:r,height:$(".table-head-fix.will-be-covered>div").height()-76})),$(".slidebox").css("max-height","none"),this.manager.on("slideup",function(){return $(".slidebox").removeAttr("style")}),$(window).on("resize",function(){return $("#parameter-table").height($(".table-head-fix.will-be-covered>div").height()-67).find(".scrollbar-veritical-thumb").removeAttr("style")}))},bindFilter:function(e,t){var n,r,i,s,o;return i=this,r=(s=$("#sort-parameter-name").find(".item.selected"))!=null?(o=s.data())!=null?o.id:void 0:void 0,n=$("#pg-filter-parameter-name"),n.off("change").on("change",function(){var t,n;return n=$(this).val(),t=[{data:{id:e.groupModel.id}}],i.filterDelay&&window.clearTimeout(i.filterDelay),i.filterDelay=window.setTimeout(function(){return i.getSlides().edit.bind(i)(u.slide_edit,t,{filter:n,sort:r})},200),null}),$("#sort-parameter-name").on("OPTION_CHANGE",function(e,t,i){return r=(i!=null?i.id:void 0)||t,n.trigger("change")})},bindEditEvent:function(e,t,n){var r,i;i=this,r=function(){var t;return t=[],e.filter(function(e){if(e.has("newValue")&&e.get("newValue")!==e.get("ParameterValue"))return t.push(e.toJSON())}),t},r().length&&$("[data-action='preview']").prop("disabled",!1),n||i.bindFilter(e,t),n||$("#pg-filter-parameter-name").keyup(function(){return $(this).trigger("change")}),_.each(e.models,function(e){var t;t=function(){$("[data-action='preview']").prop("disabled",!1),(this.value==="<engine-default>"||this.value===""&&!e.get("ParameterValue"))&&e.unset("newValue");if(!(e.isValidValue(this.value)||this.value===""||e.isFunctionValue(this.value)&&!e.isNumber(this.value)))return $(this).addClass("parsley-error");$(this).removeClass("parsley-error");if(this.value!=="")return e.set("newValue",this.value)};if(e.attributes.IsModifiable)return $(".slidebox").on("change","[name='"+e.attributes.ParameterName+"']",t),$(".slidebox").on("keyup","[name='"+e.attributes.ParameterName+"']",t)});if(!n)return $("[data-action='preview']").click(function(){var n;return n=r(),_.each(n,function(e){var t;((t=e.AllowedValues)!=null?t.split(",").length:void 0)>1?(e.inputType="select",e.selections=e.AllowedValues.split(",")):e.inputType="input"}),i.manager.setSlide(t({data:n,preview:!0})),$("#parameter-table").height($(".table-head-fix.will-be-covered>div").height()-67).find(".scrollbar-veritical-thumb").removeAttr("style"),$("#rds-pg-save").click(function(){return i.modifyParams(e,r())}),$("#pg-back-to-edit").click(function(){var n;return n=[{data:{id:e.groupModel.id}}],i.getSlides().edit.bind(i)(t,n)})})},modifyParams:function(e,t){var n,r;return r={},_.each(t,function(e){return r[e.ParameterName]=e.newValue,null}),_.each(e.models,function(e){return e.unset("newValue")}),n=this.afterModify.bind(this),this.switchAction("processing"),e.groupModel.modifyParams(r).then(n,n)},afterModify:function(e){return(e!=null?e.error:void 0)?(notification("error",sprintf(o.NOTIFY.PARAMETER_GROUP_UPDATED_FAILED,(e!=null?e.awsResult:void 0)||(e!=null?e.awsErrorCode:void 0)||(e!=null?e.msg:void 0))),this.switchAction(),!1):(notification("info",o.NOTIFY.PARAMETER_GROUP_IS_UPDATED),this.manager.cancel())},doAction:function(e,t){return this["do_"+e]&&this["do_"+e]("do_"+e,t)},do_create:function(){var e,t;return!$("#property-dbpg-name-create").parsley("validate")||!$("#property-dbpg-desc-create").parsley("validate")?!1:(t={DBParameterGroupName:$("#property-dbpg-name-create").val(),DBParameterGroupFamily:$("#property-family .selection").html().trim(),Description:$("#property-dbpg-desc-create").val()},this.switchAction("processing"),e=this.afterCreated.bind(this),this.collection.create(t).save().then(e,e))},do_delete:function(e,t){var n,r;return r=this,f+=t.length,this.switchAction("processing"),n=r.afterDeleted.bind(r),_.each(t,function(e){return function(t){return e.collection.findWhere({id:t.data.id}).destroy().then(n,n)}}(this))},do_edit:function(e,t){},do_reset:function(e,t){var n,r;return r=t[0],this.switchAction("processing"),n=this.afterReset.bind(this),this.collection.findWhere({id:r.data.id}).resetParams().then(n,n)},afterCreated:function(e){return this.manager.cancel(),e.error?(notification("error",sprintf(o.NOTIFY.CREATE_FAILED_BECAUSE_OF_XXX,e.msg)),!1):notification("info",o.NOTIFY.NEW_RDS_PARAMETER_GROUP_IS_CREATED_SUCCESSFULLY)},afterReset:function(e){var t;return t=Design.instance().get("region"),this.manager.cancel(),e.error?(notification("error",e.awsResult),!1):notification("info",o.NOTIFY.RDS_PARAMETER_GROUP_IS_RESET_SUCCESSFULLY)},afterDeleted:function(e){f--,e.error&&l++;if(f===0)return l>0?(this.manager.error(e.awsResult||sprintf(o.IDE.RDS_DELETE_DB_PG_FAILED,l)),this.switchAction(),l=0,null):(notification("info",o.NOTIFY.DELETE_SUCCESSFULLY),this.manager.unCheckSelectAll(),l=0,this.manager.cancel())},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return $(this).hasClass(e)?$(this).show():$(this).hide()})},renderDropdown:function(){var e,t;return t=this,e={manageBtnValue:o.PROP.VPC_MANAGE_RDS_PG,filterPlaceHolder:o.PROP.VPC_FILTER_RDS_PG,resourceName:o.PROP.RESOURCE_NAME_PARAMETER_GROUP},this.dropdown=new i(e),this.resModel&&!this.resModel.attributes.pgName?t.dropdown.setSelection("Please Select Parameter Group"):this.dropdown.setSelection(this.resModel.attributes.pgName),this.dropdown.on("open",this.initDropdown.bind(this),this),this.dropdown.on("manage",this.renderManager.bind(this),this),this.dropdown.on("filter",this.filterDropdown.bind(this),this),this.dropdown.on("change",this.setParameterGroup.bind(this),this),this.dropdown},initDropdown:function(){return Design.instance().credential()&&!Design.instance().credential().isDemo()?this.renderDefault():this.renderNoCredential()},renderDefault:function(){return this.dropdown?c?this.openDropdown():(this.renderLoading(),this.collection.fetch().then(function(e){return function(){return e.renderDefault()}}(this)),c=!0,!1):!1},renderNoCredential:function(){return this.dropdown.render("nocredential").toggleControls(!1)},renderLoading:function(){return this.dropdown.render("loading").toggleControls(!1)},openDropdown:function(t){var r,i,s,o,a,f,l,c,h;i=this.collection.toJSON(),c=this.resModel.attributes.pgName,_.each(i,function(e){if(e.DBParameterGroupName===c)return e.selected=!0,null}),s={keys:i},t&&(s.keys=t);if(Design.instance().modeIsApp()||Design.instance().modeIsAppEdit())s.isRunTime=!0;return f=this.resModel.attributes,l=Design.instance().region(),a=e(Design.instance().credentialId(),n.RESTYPE.DBENGINE,l),a&&(o=a.getDefaultByNameVersion(l,f.engine,f.engineVersion),h=o.family),h&&(s.keys=_.filter(s.keys,function(e){return e.DBParameterGroupFamily===h})),r=u.keys(s),this.dropdown.toggleControls(!0),this.dropdown.setContent(r)},filterDropdown:function(e){var t;return t=_.filter(this.collection.toJSON(),function(t){return t.id.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.openDropdown(t):this.openDropdown()},setParameterGroup:function(e,t){var n;return n=e||t.id,this.resModel.set("pgName",n)},getModalOptions:function(){var e,t,r;return r=this,e=Design.instance().get("region"),t=n.REGION_SHORT_LABEL[e],{title:sprintf(o.IDE.COMPONENT_RDS_PG_MANAGER_TITLE,t),slideable:!0,resourceName:o.PROP.RESOURCE_NAME_PARAMETER_GROUP,context:r,buttons:[{icon:"new-stack",type:"create",name:o.PROP.LBL_CREATE_PARAMETER_GROUP},{icon:"edit",type:"edit",disabled:!0,name:o.PROP.LBL_EDIT},{icon:"reset",type:"reset",disabled:!0,name:o.PROP.LBL_RESET},{icon:"del",type:"delete",disabled:!0,name:o.PROP.LBL_DELETE},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"30%",rowType:"string",name:o.PROP.NAME},{sortable:!0,rowType:"string",width:"30%",name:o.PROP.DBPG_SET_FAMILY},{sortable:!1,width:"40%",name:o.PROP.LBL_DESC}]}}}),a}),define("component/awscomps/RdsSnapshotTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+='" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" tabindex="-1">\n    ',i=n["if"].call(e,e&&e.id,{hash:{},inverse:a.program(6,h,t),fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;return r+="\n</li>\n",r}function l(e,t){return" selected"}function c(e,t){var n="",r;return n+='\n    <div class="manager-content-main" data-id="'+u((r=e&&e.id,typeof r===o?r.apply(e):r))+'">'+u((r=e&&e.id,typeof r===o?r.apply(e):r))+'</div>\n    <div class="manager-content-sub">Engine: '+u((r=e&&e.Engine,typeof r===o?r.apply(e):r))+" &nbsp;&nbsp;Size: "+u((r=e&&e.AllocatedStorage,typeof r===o?r.apply(e):r))+" GiB</div>\n    ",n}function h(e,t){var n="",r;return n+='\n    <div class="manager-content-main" data-id="'+u((r=e&&e.region,typeof r===o?r.apply(e):r))+'">'+u((r=e&&e.name,typeof r===o?r.apply(e):r))+"</div>\n    ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.data,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.keys=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<tr class="item" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'">\n    <td>\n        <div class="checkbox">\n            <input id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" type="checkbox" value="None" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" data-name="'+u((i=e&&e.name,typeof i===o?i.apply(e):i))+'" class="one-cb">\n            <label for="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'"></label>\n        </div>\n    </td>\n    <td>'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+"</td>\n    <td>"+u((i=e&&e.AllocatedStorage,typeof i===o?i.apply(e):i))+' GiB</td>\n    <td>\n        <div class="manager-content-main">',i=n.ifCond.call(e,e&&e.Status,"creating",{hash:{},inverse:a.program(4,c,t),fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+='</div>\n        <span class="manager-content-sub">Started: '+u((i=e&&e.started,typeof i===o?i.apply(e):i))+'</span>\n    </td>\n    <td class="show-detail icon-toolbar-cloudformation"></td>\n</tr>\n',r}function l(e,t){var n="",r;return n+='<i class="status status-yellow icon-label"></i>'+u((r=e&&e.Status,typeof r===o?r.apply(e):r))+" - "+u((r=e&&e.PercentProgress,typeof r===o?r.apply(e):r))+"%",n}function c(e,t){var n="",r;return n+='<i class="status status-green icon-label"></i>'+u((r=e&&e.Status,typeof r===o?r.apply(e):r))+" ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.items,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.content=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n;return a((n=e&&e.selectedId,typeof n===u?n.apply(e):n))}function c(e,t){var r="",i;return r+=a(n.i18n.call(e,"PROP.DB_SNAPSHOT_DELETE_2",{hash:{},data:t}))+a((i=e&&e.selectedCount,typeof i===u?i.apply(e):i))+a(n.i18n.call(e,"PROP.DB_SNAPSHOT_DELETE_3",{hash:{},data:t})),r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">'+a(n.i18n.call(t,"PROP.DB_SNAPSHOT_DELETE_1",{hash:{},data:i}))+" ",o=n["if"].call(t,t&&t.selectedId,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='?</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">'+a(n.i18n.call(t,"PROP.LBL_DELETE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+a(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+a(n.i18n.call(t,"PROP.LBL_DELETING",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="no-credential tac">\n    <p>'+o(n.i18n.call(t,"PROP.DB_SNAPSHOT_EMPTY",{hash:{},data:i}))+"</p>\n</div>",s},n.noinstance=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="slide-create" data-bind="true">\n    <div class="formart_toolbar_modal" data-type="true">\n        <section data-bind="true">\n            <div class="control-group clearfix">\n                <label for="property-snapshot-name-create">'+o(n.i18n.call(t,"PROP.SNAPSHOT_SET_NAME",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id="property-snapshot-name-create" class="input" type="text" maxlength="255" data-type="database" data-ignore="true" data-ignore-regexp="^[a-zA-Z][a-zA-Z0-9-]*$" data-required="true"  placeholder="Allow alpha number, _ or - up to 255 characters.">\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-volume-choose">'+o(n.i18n.call(t,"PROP.SNAPSHOT_SET_INSTANCE",{hash:{},data:i}))+'</label>\n                <div>\n                    <div id="property-db-instance-choose"></div>\n                </div>\n            </div>\n\n        </section>\n        <div class="init action">\n            <button class="btn btn-blue do-action" data-action="create" disabled>'+o(n.i18n.call(t,"PROP.LBL_CREATE",{hash:{},data:i}))+'</button>\n            <button class="btn btn-silver cancel">'+o(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n        </div>\n        <div class="processing action" style="display:none;">\n            <button class="btn" disabled>'+o(n.i18n.call(t,"PROP.LBL_CREATING",{hash:{},data:i}))+"</button>\n        </div>\n    </div>\n</div>",s},n.slide_create=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+='<div class="slide-duplicate" data-bind="true">\n    <div class="formart_toolbar_modal" data-type="true">\n        <section data-bind="true">\n            <div class="control-group clearfix">\n                <label for="property-snapshot-source">'+u(n.i18n.call(t,"PROP.SNAPSHOT_SOURCE_SNAPSHOT",{hash:{},data:i}))+'</label>\n                <div>\n                    <p id="property-snapshot-source">'+u((o=(o=t&&t.originSnapshot,o==null||o===!1?o:o.id),typeof o===a?o.apply(t):o))+'</p>\n                </div>\n            </div>\n\n            <div class="control-group clearfix property-content" style="background: none">\n                <label for="property-region-choose">'+u(n.i18n.call(t,"PROP.SNAPSHOT_DESTINATION_REGION",{hash:{},data:i}))+'</label>\n                <div>\n                    <div id="property-region-choose"></div>\n                </div>\n            </div>\n\n            <div class="control-group clearfix">\n                <label for="property-snapshot-name">'+u(n.i18n.call(t,"PROP.SNAPSHOT_SET_NEW_NAME",{hash:{},data:i}))+'</label>\n                <div>\n                    <input id="property-snapshot-name" class="input" type="text" maxlength="255" data-type="domain" value="'+u((o=t&&t.newCopyName,typeof o===a?o.apply(t):o))+'" data-ignore="true">\n                </div>\n            </div>\n\n\n        </section>\n        <div class="init action">\n            <button class="btn btn-blue do-action" data-action="duplicate" disabled>'+u(n.i18n.call(t,"PROP.LBL_DUPLICATE",{hash:{},data:i}))+'</button>\n            <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n        </div>\n        <div class="processing action" style="display:none;">\n            <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.LBL_DUPLICATING",{hash:{},data:i}))+"</button>\n        </div>\n    </div>\n</div>",s},n.slide_duplicate=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+='<div class="detail-info horizontal">\n    <div class="detail-info-row">\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_ID",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.id,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_VPC_ID",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.VpcId,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_ENGINE",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.Engine,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_LICENSE_MODEL",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.LicenseModel,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_STATUS",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.Status,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_STORAGE",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.AllocatedStorage,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_CREATE_TIME",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.SnapshotCreateTime,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_SOURCE_REGION",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.AvailabilityZone,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n    </div>\n    <div class="detail-info-row">\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_INSTANCE_NAME",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.DBInstanceIdentifier,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_TYPE",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.SnapshotType,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_ENGINE_VERSION",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.EngineVersion,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_MASTER_USERNAME",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.MasterUsername,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.OPTION_GROUP_NAME",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.OptionGroupName,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.PORT",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.Port,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.DB_SNAPSHOT_INSTANCE_CREATE_TIME",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.InstanceCreateTime,typeof o===a?o.apply(t):o))+"</div>\n        </section>\n\n    </div>\n</div>",s},n.detail=e.template(t),n}),define("rds_snapshot",["CloudResources","ApiRequest","constant","combo_dropdown","UI.modalplus","toolbar_modal","i18n!/nls/lang.js","component/awscomps/RdsSnapshotTpl"],function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p;return l=!1,a=0,f=0,c=!1,h={},p=Backbone.View.extend({constructor:function(){return this.collection=e(Design.instance().credentialId(),n.RESTYPE.DBSNAP,Design.instance().region()),this.listenTo(this.collection,"update",this.onChange.bind(this)),this.listenTo(this.collection,"change",this.onChange.bind(this)),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged),this},onChange:function(){return this.initManager(),this.trigger("datachange",this)},credChanged:function(){var e,t;return(e=this.dropdown)!=null&&e.render("loading"),(t=this.manager)!=null&&t.renderLoading(),this.manager&&this.refresh(),this.collection.fetchForce()},remove:function(){return this.isRemoved=!0,Backbone.View.prototype.remove.call(this)},render:function(){return this.renderManager()},renderDropdown:function(){var t,i;return t={filterPlaceHolder:o.PROP.SNAPSHOT_FILTER_VOLUME,resourceName:o.PROP.RESOURCE_NAME_RDS_SNAPSHOT},this.dropdown=new r(t),this.instances=e(Design.instance().credentialId(),n.RESTYPE.DBINSTANCE,Design.instance().region()),i=o.PROP.INSTANCE_SNAPSHOT_SELECT,this.dropdown.setSelection(i),this.dropdown.on("open",this.openDropdown,this),this.dropdown.on("filter",this.filterDropdown,this),this.dropdown.on("change",this.selectSnapshot,this),this.dropdown},renderRegionDropdown:function(e){var t,i;return t={filterPlaceHolder:o.PROP.SNAPSHOT_FILTER_REGION},this.regionsDropdown=new r(t),this.regions=_.keys(n.REGION_LABEL),e&&(this.regions=_.without(this.regions,e)),i=o.PROP.VOLUME_SNAPSHOT_SELECT_REGION,this.regionsDropdown.setSelection(i),this.regionsDropdown.on("open",this.openRegionDropdown,this),this.regionsDropdown.on("filter",this.filterRegionDropdown,this),this.regionsDropdown.on("change",this.selectRegion,this),this.regionsDropdown},openRegionDropdown:function(e){var t,r,i,s;return r=Design.instance().get("region"),i=_.map(this.regions,function(e){return{name:n.REGION_LABEL[e]+" - "+n.REGION_SHORT_LABEL[e],selected:e===r,region:e}}),s={isRuntime:!1,data:i},e&&(s.data=e,s.hideDefaultNoKey=!0),t=u.keys(s),this.regionsDropdown.toggleControls(!1,"manage"),this.regionsDropdown.toggleControls(!0,"filter"),this.regionsDropdown.setContent(t)},openDropdown:function(e){return this.instances.fetch().then(function(t){return function(){var n,r,i;return r=t.instances.toJSON(),r.length<1?(t.dropdown.setContent(u.noinstance()),!1):(i={isRuntime:!1,data:r},e&&(i.data=e,i.hideDefaultNoKey=!0),n=u.keys(i),t.dropdown.toggleControls(!1,"manage"),t.dropdown.toggleControls(!0,"filter"),t.dropdown.setContent(n))}}(this))},filterDropdown:function(e){var t;return t=_.filter(this.instances.toJSON(),function(t){return t.id.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.openDropdown(t):this.openDropdown()},filterRegionDropdown:function(e){var t;return t=_.filter(this.regions,function(t){return t.toLowerCase().indexOf(e.toLowerCase())!==-1}),e?this.openRegionDropdown(t):this.openRegionDropdown()},selectSnapshot:function(e){return $("#property-db-instance-choose .selection .manager-content-sub").remove(),this.manager.$el.find('[data-action="create"]').prop("disabled",!1)},selectRegion:function(e){return this.manager.$el.find('[data-action="duplicate"]').prop("disabled",!1)},renderManager:function(){var e,t;return this.manager=new s(this.getModalOptions()),this.manager.on("refresh",this.refresh,this),this.manager.on("slidedown",this.renderSlides,this),this.manager.on("slideup",this.resetSlide,this),this.manager.on("action",this.doAction,this),this.manager.on("detail",this.detail,this),this.manager.on("close",function(e){return function(){return e.manager.remove(),e.collection.remove()}}(this)),this.manager.on("checked",this.processDuplicate,this),this.manager.render(),((e=Design.instance().credential())!=null?e.isDemo():void 0)?((t=this.manager)!=null&&t.render("nocredential"),!1):this.initManager()},resetSlide:function(){return this.manager.$el.find(".slidebox").removeAttr("style")},processDuplicate:function(e,t){return t.length===1?this.M$("[data-btn=duplicate]").prop("disabled",!1):this.M$("[data-btn=duplicate]").prop("disabled",!0)},refresh:function(){return l=!1,this.initManager()},setContent:function(){var e,t,n,r;return c=!1,l=!0,t=this.collection.toJSON(),_.each(t,function(e,t){return e.PercentProgress===100&&(e.completed=!0),e.SnapshotCreateTime&&(e.started=(new Date(e.SnapshotCreateTime)).toString()),null}),n={items:t},e=u.content(n),(r=this.manager)!=null?r.setContent(e):void 0},initManager:function(){var e,t;t=this.setContent.bind(this),e=Design.instance().get("region");if(!l&&!c||!h[e])return c=!0,h[e]=!0,this.collection.fetchForce().then(t,t);if(!c)return this.setContent()},renderSlides:function(e,t){var n,r,i;return r=u["slide_"+e],n=this.getSlides(),(i=n[e])!=null?i.call(this,r,t):void 0},getSlides:function(){return{"delete":function(e,t){var n,r;n=t.length;if(!n)return;return r={},n===1?r.selectedName=t[0].data.name:r.selectedCount=n,this.manager.setSlide(e(r))},create:function(e){var t;return t={volumes:{}},this.manager.setSlide(e(t)),this.dropdown=this.renderDropdown(),this.manager.$el.find("#property-db-instance-choose").html(this.dropdown.$el),this.manager.$el.find(".slidebox").css("overflow","visible")},duplicate:function(e,t){var n,r;n={},n.originSnapshot=t[0],n.region=Design.instance().get("region");if(!t)return;return n.newCopyName=t[0].id.split(":").pop()+"-copy",r=this.collection.get(t[0].id),void 0,this.manager.setSlide(e(n)),r.isAutomated()?this.regionsDropdown=this.renderRegionDropdown():this.regionsDropdown=this.renderRegionDropdown(r.collection.region()),this.regionsDropdown.on("change",function(e){return function(){return e.manager.$el.find('[data-action="duplicate"]').prop("disabled",!1)}}(this)),this.manager.$el.find("#property-region-choose").html(this.regionsDropdown.$el),this.manager.$el.find(".slidebox").css("overflow","visible")}}},doAction:function(e,t){return this["do_"+e]&&this["do_"+e]("do_"+e,t)},do_create:function(e,t){var n,r,i;return $("#property-snapshot-name-create").parsley("validate")?(i=this.instances.findWhere({id:$("#property-db-instance-choose").find(".selectbox .selection .manager-content-main").data("id")}),i?(r={DBSnapshotIdentifier:$("#property-snapshot-name-create").val(),DBInstanceIdentifier:i.id},this.switchAction("processing"),n=this.afterCreated.bind(this),this.collection.create(r).save().then(n,n)):!1):!1},do_delete:function(e,t){var n,r;return r=this,a+=t.length,this.switchAction("processing"),n=r.afterDeleted.bind(r),_.each(t,function(e){return function(t){return e.collection.findWhere({id:t.data.id}).destroy().then(n,n)}}(this))},do_duplicate:function(e,t){var n,r,i,s,u;return s=t[0],u=$("#property-region-choose").find(".selectbox .selection .manager-content-main").data("id"),this.regions.indexOf(u)<0?!1:(this.switchAction("processing"),i=this.manager.$el.find("#property-snapshot-name").val(),r=this.afterDuplicate.bind(this),n=Design.instance().credential().get("awsAccount"),/^\d+$/.test(n.split("-").join(""))?this.collection.findWhere({id:s.data.id}).copyTo(u,i).then(r,r):(notification("error",o.PROP.DB_SNAPSHOT_ACCOUNT_NUMBER_INVALID),!1))},afterCreated:function(e,t){return this.manager.cancel(),e.error?(notification("error",sprintf(o.NOTIFY.DB_SNAPSHOT_CREATE_FAILED,e.msg)),!1):notification("info",o.NOTIFY.NEW_SNAPSHOT_IS_CREATED_SUCCESSFULLY)},afterDuplicate:function(e){var t;return t=Design.instance().get("region"),this.manager.cancel(),e.error?(notification("error",sprintf(o.NOTIFY.DUPLICATE_FAILED_BECAUSE_OF_XXX,e.awsResult||e.msg)),!1):e.attributes.region===t?(this.collection.add(e),notification("info",o.NOTIFY.DB_SNAPSHOT_DUPLICATE_SUCCESS)):(this.initManager(),notification("info",o.NOTIFY.DB_SNAPSHOT_DUPLICATE_SUCCESS_OTHER_REGION))},afterDeleted:function(e){a--,e.error&&f++;if(a===0)return f>0?notification("error",sprintf(o.NOTIFY.XXX_SNAPSHOT_FAILED_TO_DELETE,f)):notification("info",o.NOTIFY.DB_SNAPSHOT_DELETE_SUCCESS),this.manager.unCheckSelectAll(),f=0,this.manager.cancel()},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return $(this).hasClass(e)?$(this).show():$(this).hide()})},detail:function(e,t,n){var r,i,s;return s=t.id,i=this.collection.get(s).toJSON(),r=u.detail(i),this.manager.setDetail(n,r)},getModalOptions:function(){var e,t,r;return r=this,e=Design.instance().get("region"),t=n.REGION_SHORT_LABEL[e],{title:sprintf(o.IDE.MANAGE_DB_SNAPSHOT_IN_AREA,t),slideable:!0,resourceName:o.PROP.RESOURCE_NAME_RDS_SNAPSHOT,context:r,buttons:[{icon:"new-stack",type:"create",name:o.PROP.CREATE_SNAPSHOT},{icon:"duplicate",type:"duplicate",disabled:!0,name:o.PROP.LBL_DUPLICATE},{icon:"del",type:"delete",disabled:!0,name:o.PROP.LBL_DELETE},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"30%",name:o.PROP.LBL_NAME},{sortable:!0,rowType:"number",width:"20%",name:o.PROP.LBL_CAPACITY},{sortable:!0,rowType:"datetime",width:"40%",name:o.PROP.LBL_STATUS},{sortable:!1,width:"10%",name:o.PROP.LBL_DETAIL}]}}}),p}),define("component/awscomps/SslCertTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression;return u((s=t&&t.Name,typeof s===o?s.apply(t):s))},n.dropdown_selection=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n    <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:o.noop,fn:o.program(2,l,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'" data-name="'+a((i=e&&e.Name,typeof i===u?i.apply(e):i))+'" tabindex="-1">\n        '+a((i=e&&e.Name,typeof i===u?i.apply(e):i))+"\n    </li>\n",r}function l(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this,u="function",a=this.escapeExpression;return s=n.each.call(t,t,{hash:{},inverse:o.noop,fn:o.program(1,f,i),data:i}),s||s===0?s:""},n.dropdown_list=e.template(t),t=function(e,t,n,r,i){function f(e,t){var n="",r;return n+='\n<tr class="item" data-id="'+u((r=e&&e.id,typeof r===o?r.apply(e):r))+'">\n    <td>\n        <div class="checkbox">\n            <input id="sslcert-select-'+u((r=e&&e.id,typeof r===o?r.apply(e):r))+'" type="checkbox" data-id="'+u((r=e&&e.id,typeof r===o?r.apply(e):r))+'" data-name="'+u((r=e&&e.Name,typeof r===o?r.apply(e):r))+'" class="one-cb">\n            <label for="sslcert-select-'+u((r=e&&e.id,typeof r===o?r.apply(e):r))+'"></label>\n        </div>\n    </td>\n    <td>'+u((r=e&&e.Name,typeof r===o?r.apply(e):r))+"</td>\n    <td>"+u((r=e&&e.UploadDate,typeof r===o?r.apply(e):r))+'</td>\n    <td class="show-detail icon-toolbar-cloudformation"></td>\n</tr>\n',n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.modal_list=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="slide-create" data-bind="true">\n    <div class="modal-ssl-cert-create">\n        <div class="modal-ssl-cert-item clearfix">\n            <label class="left">'+o(n.i18n.call(t,"PROP.ELB_LBL_LISTENER_CERT_NAME",{hash:{},data:i}))+'</label>\n            <input placeholder="Required. Up to 128 characters" class="input" type="text" data-required="true" data-ignore="true" id="ssl-cert-name-input"/>\n        </div>\n        <div class="modal-ssl-cert-item clearfix">\n            <label class="left">'+o(n.i18n.call(t,"PROP.ELB_LBL_LISTENER_PRIVATE_KEY",{hash:{},data:i}))+'</label>\n            <textarea placeholder="Required. PEM Encoded" class="input ssl-cert-input" data-required="true" id="ssl-cert-privatekey-input"></textarea>\n        </div>\n        <div class="modal-ssl-cert-item clearfix">\n            <label class="left"  >'+o(n.i18n.call(t,"PROP.ELB_LBL_LISTENER_PUBLIC_KEY",{hash:{},data:i}))+'</label>\n            <textarea placeholder="Required. PEM Encoded" class="input ssl-cert-input" data-required="true" id="ssl-cert-publickey-input"></textarea>\n        </div>\n        <div class="modal-ssl-cert-item clearfix">\n            <label class="left"  >'+o(n.i18n.call(t,"PROP.ELB_LBL_LISTENER_CERTIFICATE_CHAIN",{hash:{},data:i}))+'</label>\n            <textarea placeholder="Optional. PEM Encoded" class="input ssl-cert-input" id="ssl-cert-chain-input"></textarea>\n        </div>\n    </div>\n    <div class="init action">\n        <button class="btn btn-blue do-action" data-action="create" disabled>'+o(n.i18n.call(t,"PROP.UPLOAD",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+o(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+o(n.i18n.call(t,"PROP.UPLOAD_3PERIOD",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_create=e.template(t),t=function(e,t,n,r,i){function f(e,t){return u(n.i18n.call(e,"DELETE_SSL_CERT_CONFIRM",e&&e.selecteKeyName,{hash:{},data:t}))}function l(e,t){return u(n.i18n.call(e,"DELETE_SSL_CERT_CONFIRM_M",e&&e.selectedCount,{hash:{},data:t}))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this;s+='<div class="slide-delete">\n    <div class="modal-text-major">',o=n["if"].call(t,t&&t.selecteKeyName,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;return s+='</div>\n    <div class="init action">\n        <button class="btn btn-red do-action" data-action="delete">'+u(n.i18n.call(t,"PROP.LBL_DELETE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.DELETING_3PERIOD",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_delete=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+='<div class="slide-update" data-bind="true">\n    <div class="modal-ssl-cert-update">\n        <div class="modal-ssl-cert-item clearfix">\n            <label class="left">'+u(n.i18n.call(t,"PROP.ELB_LBL_LISTENER_CERT_NAME",{hash:{},data:i}))+'</label>\n            <input class="input" value="'+u((o=t&&t.cert_name,typeof o===a?o.apply(t):o))+'" type="text" data-required="true" id="ssl-cert-name-update-input"/>\n        </div>\n    </div>\n    <div class="init action">\n        <button class="btn btn-blue do-action" data-action="update">'+u(n.i18n.call(t,"PROP.UPDATE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver cancel">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+'</button>\n    </div>\n    <div class="processing action" style="display:none;">\n        <button class="btn" disabled>'+u(n.i18n.call(t,"PROP.UPDATING_3PERIOD",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.slide_update=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+='<div class="detail-info">\n    <div class="detail-info-row">\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.SERVER_CERTIFICATE_ID",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.id,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.SERVER_CERTIFICATE_ARN",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.Arn,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n    </div>\n    <div class="detail-info-row">\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.EXPIRATION_DATE",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.Expiration,typeof o===a?o.apply(t):o))+'</div>\n        </section>\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(t,"PROP.PATH",{hash:{},data:i}))+"</label>\n            <div>"+u((o=t&&t.Path,typeof o===a?o.apply(t):o))+"</div>\n        </section>\n    </div>\n</div>",s},n.detail_info=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="combo-dd-no-data">\n    <p>'+o(n.i18n.call(t,"PROP.NO_SSL_CERTIFICATE",{hash:{},data:i}))+'</p>\n    <a class="create-one">'+o(n.i18n.call(t,"PROP.CREATE_SSL_CERTIFICATE",{hash:{},data:i}))+"</a>\n</div>",s},n.no_sslcert=e.template(t),n}),define("sslcert_manage",["constant","CloudResources","toolbar_modal","component/awscomps/SslCertTpl","i18n!/nls/lang.js","event"],function(e,t,n,r,i,s){return Backbone.View.extend({tagName:"section",initCol:function(){var n;return n=Design.instance().region(),this.sslCertCol=t(Design.instance().credentialId(),e.RESTYPE.IAM,n),Design.instance().credential()&&this.sslCertCol.fetch(),this.sslCertCol.on("update",this.processCol,this),this.sslCertCol.on("change",this.processCol,this)},getModalOptions:function(){var t,n,r;return r=this,t=Design.instance().get("region"),n=e.REGION_SHORT_LABEL[t],{title:sprintf(i.IDE.MANAGE_SSL_CERT_IN_AREA,n),classList:"sslcert-manage",resourceName:i.PROP.RESOURCE_NAME_SSL,context:r,buttons:[{icon:"new-stack",type:"create",name:i.PROP.LBL_UPLOAD_NEW_SSL_CERTIFICATE},{icon:"edit",type:"update",disabled:!0,name:i.PROP.UPDATE},{icon:"del",type:"delete",disabled:!0,name:i.PROP.LBL_DELETE},{icon:"refresh",type:"refresh",name:""}],columns:[{sortable:!0,width:"50%",name:i.PROP.NAME},{sortable:!0,rowType:"datetime",width:"33%",name:i.PROP.LBL_UPLOAD_DATE},{sortable:!1,name:i.PROP.LBL_VIEW_DETAILS}]}},initModal:function(){return new n(this.getModalOptions()),this.modal.on("close",function(){return this.remove()},this),this.modal.on("slidedown",this.renderSlides,this),this.modal.on("action",this.doAction,this),this.modal.on("refresh",this.refresh,this),this.modal.on("checked",this.checked,this),this.modal.on("detail",this.detail,this)},initialize:function(){return this.initCol(),this.initModal(),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged)},credChanged:function(){var e;return this.sslCertCol.fetchForce(),(e=this.modal)!=null&&e.renderLoading(),this.modal&&this.refresh()},quickCreate:function(){return this.modal.triggerSlide("create")},doAction:function(e,t){return this[e]&&this[e](this.validate(e),t)},validate:function(e){switch(e){case"create":return!0}},genDeleteFinish:function(e){var t,n,r,s;return r=[],t=[],s=this,n=_.after(e,function(){return s.modal.cancel(),r.length===1?notification("info",sprintf(i.NOTIFY.XXX_IS_DELETED,r[0].get("Name"))):r.length>1&&notification("info",sprintf(i.NOTIFY.SELECTED_XXX_SNS_TOPIC_ARE_DELETED,r.length)),_.each(t,function(e){return void 0})}),function(e){return e instanceof Backbone.Model?r.push(e):t.push(e),n()}},create:function(e){var t,n,r,s,o,u;u=this,this.switchAction("processing"),n=$("#ssl-cert-name-input"),r=$("#ssl-cert-privatekey-input"),s=$("#ssl-cert-publickey-input"),t=$("#ssl-cert-chain-input"),o=n.val();if(o==="None"){notification("error",sprintf(i.NOTIFY.CERTIFICATE_NAME_XXX_IS_INVALID,o));return}return this.sslCertCol.create({Name:o,CertificateBody:s.val(),PrivateKey:r.val(),CertificateChain:t.val(),Path:""}).save().then(function(e){return notification("info",sprintf(i.NOTIFY.CERTIFICATE_XXX_IS_UPLOADED,o)),u.modal.cancel()},function(e){u.switchAction();if(e.awsResult)return notification("error",e.awsResult)})},"delete":function(e,t){var n,r,i;return n=t.length,i=this,r=this.genDeleteFinish(n),this.switchAction("processing"),_.each(t,function(e){var t;return t=i.sslCertCol.get(e.data.id),t!=null?t.destroy().then(r,r):void 0})},update:function(t,n){var r,o,u,a,f;f=this,this.switchAction("processing");if(n&&n[0])return a=n[0].data.id,u=f.sslCertCol.get(a),o=u.get("Name"),r=$("#ssl-cert-name-update-input").val(),r===o?f.modal.cancel():u.update({Name:r}).then(function(t){var n,a;return n=r,notification("info",sprintf(i.NOTIFY.CERTIFICATE_XXX_IS_UPLOADED,n)),a=Design.modelClassForType(e.RESTYPE.IAM).allObjects(),_.each(a,function(e){return e.get("name")===o&&(e.set("name",r),e.set("arn",u.get("Arn"))),null}),s.trigger(s.REFRESH_PROPERTY),f.modal.cancel()},function(e){f.switchAction();if(e.awsResult)return notification("error",e.awsResult)})},detail:function(e,t,n){var i,s,o,u;return u=this,o=t.id,s=this.sslCertCol.get(o).toJSON(),s.Expiration=MC.dateFormat(new Date(s.Expiration),"yyyy-MM-dd hh:mm:ss"),i=r.detail_info,this.modal.setDetail(n,i(s))},refresh:function(){return this.sslCertCol.fetchForce()},checked:function(e,t){var n;return n=this.M$(".toolbar .icon-edit"),t.length===1?n.removeAttr("disabled"):n.attr("disabled","disabled")},switchAction:function(e){return e||(e="init"),this.M$(".slidebox .action").each(function(){return $(this).hasClass(e)?$(this).show():$(this).hide()})},render:function(){return this.modal.render(),Design.instance().credential()&&!Design.instance().credential().isDemo()?this.processCol():this.modal.render("nocredential"),this},processCol:function(){var e;return this.sslCertCol.isReady()&&(e=this.sslCertCol.map(function(e){var t;return t=e.toJSON(),t.UploadDate=MC.dateFormat(new Date(t.UploadDate),"yyyy-MM-dd hh:mm:ss"),t}),this.renderList(e)),!1},renderList:function(e){return this.modal.setContent(r.modal_list(e))},renderNoCredential:function(){return this.modal.render("nocredential").toggleControls(!1)},renderSlides:function(e,t){var n,i,s;return i=r["slide_"+e],n=this.getSlides(),(s=n[e])!=null?s.call(this,i,t):void 0},processSlideCreate:function(){},getSlides:function(){var e,t;return t=this,e=this.modal,{create:function(n,r){var i,s;return e.setSlide(n),i=t.M$(".slide-create input, .slide-create textarea"),s=function(e){return $(e.currentTarget).parsley("validateForm",!1)?t.M$(".slide-create .do-action").prop("disabled",!1):t.M$(".slide-create .do-action").prop("disabled",!0)},i.on("keyup",s)},"delete":function(t,n){var r,i;r=n.length;if(!r)return;return i={},r===1?i.selecteKeyName=n[0].data.name:i.selectedCount=r,e.setSlide(t(i))},update:function(n,r){var i,s,o;return t=this,r&&r[0]&&(s=r[0].data.name,e.setSlide(n({cert_name:s}))),i=t.M$(".slide-update input"),o=function(e){return $(e.currentTarget).parsley("validateForm",!1)?t.M$(".slide-update .do-action").prop("disabled",!1):t.M$(".slide-update .do-action").prop("disabled",!0)},i.on("keyup",o)}}},show:function(){return Design.instance().credential()&&!Design.instance().credential().isDemo()?(this.sslCertCol.fetch(),this.processCol()):this.renderNoCredential()},manage:function(){},set:function(){},filter:function(e){return this.processCol(!0,e)}})}),define("sslcert_dropdown",["constant","CloudResources","sslcert_manage","combo_dropdown","component/awscomps/SslCertTpl","i18n!/nls/lang.js"],function(e,t,n,r,i,s){return Backbone.View.extend({tagName:"section",initCol:function(){var n;return n=Design.instance().region(),this.sslCertCol=t(Design.instance().credentialId(),e.RESTYPE.IAM,n),this.sslCertCol.on("update",this.processCol,this)},initDropdown:function(){var e;return e={manageBtnValue:s.PROP.INSTANCE_MANAGE_SSL_CERT,filterPlaceHolder:s.PROP.INSTANCE_FILTER_SSL_CERT,resourceName:s.PROP.RESOURCE_NAME_SSL},this.dropdown=new r(e),this.dropdown.on("open",this.show,this),this.dropdown.on("manage",this.manage,this),this.dropdown.on("change",this.set,this),this.dropdown.on("filter",this.filter,this),this.dropdown.on("quick_create",this.quickCreate,this)},initialize:function(){return this.initCol(),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged),this.initDropdown()},credChanged:function(){var e;return(e=this.dropdown)!=null&&e.render("loading"),this.sslCertCol.fetchForce()},quickCreate:function(){return(new n).render().quickCreate()},render:function(){var e;return e=this.sslCertName||"None",this.el=this.dropdown.el,e==="None"&&($(this.el).addClass("empty"),this.sslCertCol.fetch()),this.dropdown.setSelection(e),this},setDefault:function(){var e,t,n,r,i;if(this.sslCertCol.isReady()){n=this.sslCertCol.toJSON();if(n&&n[0]&&this.uid&&this.dropdown.getSelection()==="None"){e=Design.instance().component(this.uid);if(e){r=e.get("listeners"),t=r[this.listenerNum];if(t&&((i=t.protocol)==="HTTPS"||i==="SSL"))return e.setSSLCert(this.listenerNum,n[0].id),this.dropdown.trigger("change",n[0].id),this.dropdown.setSelection(n[0].Name),$(this.el).removeClass("empty")}}}},processCol:function(e,t){var n,r;return this.sslCertCol.isReady()&&(n=this.sslCertCol.toJSON(),this.setDefault(),e&&(r=t.length,n=_.filter(n,function(e){return e.Name.toLowerCase().indexOf(t.toLowerCase())!==-1})),this.renderDropdownList(n)),!1},renderDropdownList:function(e){var t;return e.length?(t=this.dropdown.getSelection(),_.each(e,function(e){return e.Name&&e.Name===t&&(e.selected=!0),null}),this.dropdown.setContent(i.dropdown_list(e)).toggleControls(!0)):this.dropdown.setContent(i.no_sslcert({})).toggleControls(!0)},renderNoCredential:function(){return this.dropdown.render("nocredential").toggleControls(!1)},show:function(){return Design.instance().credential()&&!Design.instance().credential().isDemo()?(this.sslCertCol.fetch(),this.processCol()):this.renderNoCredential()},manage:function(){return(new n).render()},set:function(e,t){var n,r,i;if(this.uid&&e){r=Design.instance().component(this.uid).get("listeners"),n=r[this.listenerNum];if(n&&((i=n.protocol)==="HTTPS"||i==="SSL"))return Design.instance().component(this.uid).setSSLCert(this.listenerNum,e)}},filter:function(e){return this.processCol(!0,e)}})}),define("component/awscomps/OgTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression;return u((s=t&&t.Name,typeof s===o?s.apply(t):s))},n.dropdown_selection=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n    <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:o.noop,fn:o.program(2,l,t),data:t});if(i||i===0)r+=i;r+='" data-id="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'" data-name="'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'" tabindex="-1">\n        '+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'\n        <div class="option-preview">'+a((i=e&&e.preview,typeof i===u?i.apply(e):i))+"</div>\n        ",i=n["if"].call(e,e&&e.id,{hash:{},inverse:o.noop,fn:o.program(4,c,t),data:t});if(i||i===0)r+=i;return r+="\n    </li>\n",r}function l(e,t){return" selected"}function c(e,t){return'<div class="icon-edit"></div>'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this,u="function",a=this.escapeExpression;return s=n.each.call(t,t,{hash:{},inverse:o.noop,fn:o.program(1,f,i),data:i}),s||s===0?s:""},n.dropdown_list=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="combo-dd-no-data">\n    <p>'+o(n.i18n.call(t,"PROP.NO_OPTION_GROUP_PERIOD",{hash:{},data:i}))+'</p>\n    <a class="create-one">'+o(n.i18n.call(t,"PROP.CREATE_OPTION_GROUP",{hash:{},data:i}))+"</a>\n</div>",s},n.no_option_group=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n    <div class="port-sg">\n        <div>\n            <label for="og-port">'+f(n.i18n.call(e,"PROP.PORT",{hash:{},data:t}))+'</label>\n            <input type="text" id="og-port" class="input" value="'+f((i=e&&e.port,typeof i===a?i.apply(e):i))+'" data-required="true" data-type="number" autocomplete="off" data-min="1150" data-max="65535"/>\n        </div>\n        <label>'+f(n.i18n.call(e,"PROP.SECURITY_GROUP",{hash:{},data:t}))+'</label>\n        <ul class="acl-sg-info-list mega-list-wraper" id="og-sg">\n            ',i=n.each.call(e,e&&e.sgs,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n        </ul>\n\n    </div>\n    ",r}function c(e,t){var r="",i;r+='\n            <li>\n                <div class="checkbox-wrap col1">\n                    <div class="checkbox">\n                        <input type="checkbox" ',i=n["if"].call(e,e&&e.used,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;r+=' data-uid="'+f((i=e&&e.id,typeof i===a?i.apply(e):i))+'" id="og-sg-'+f((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.checked,{hash:{},inverse:u.noop,fn:u.program(5,p,t),data:t});if(i||i===0)r+=i;return r+=' />\n                        <label for="og-sg-'+f((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'"></label>\n                    </div>\n                </div>\n\n                <div class="col2">\n                    <div class="col2-1 truncate"><div class="sg-color" style="background-color:'+f((i=e&&e.color,typeof i===a?i.apply(e):i))+'" ></div><span class="sg-name">'+f((i=e&&e.name,typeof i===a?i.apply(e):i))+'</span></div>\n                    <div class="col2-2 truncate">'+f((i=e&&e.description,typeof i===a?i.apply(e):i))+'</div>\n                    <div class="col2-3 truncate">'+f((i=e&&e.ruleCount,typeof i===a?i.apply(e):i))+" "+f(n.i18n.call(e,"PROP.SGLIST_LBL_RULE",{hash:{},data:t}))+", "+f((i=e&&e.memberCount,typeof i===a?i.apply(e):i))+" "+f(n.i18n.call(e,"PROP.SGLIST_LBL_MEMBER",{hash:{},data:t}))+"</div>\n                </div>\n            </li>\n            ",r}function h(e,t){return'checked="checked"'}function p(e,t){return"checked"}function d(e,t){var r="",i;r+='\n    <table class="table">\n        <tr>\n            <th>'+f(n.i18n.call(e,"PROP.OPTION_SETTING",{hash:{},data:t}))+"</th>\n            <th>"+f(n.i18n.call(e,"PROP.VALUE",{hash:{},data:t}))+"</th>\n            <th>"+f(n.i18n.call(e,"PROP.ALLOWED_VALUES",{hash:{},data:t}))+"</th>\n        </tr>\n        ",i=n.each.call(e,e&&e.OptionGroupOptionSettings,{hash:{},inverse:u.noop,fn:u.program(8,v,t),data:t});if(i||i===0)r+=i;return r+="\n    </table>\n    ",r}function v(e,t){var r="",i;r+="\n        <tr>\n            <td>"+f((i=e&&e.SettingName,typeof i===a?i.apply(e):i))+'</td>\n            <td class="value">\n                ',i=n["if"].call(e,e&&e.items,{hash:{},inverse:u.program(13,b,t),fn:u.program(9,m,t),data:t});if(i||i===0)r+=i;return r+="\n            </td>\n            <td>"+f((i=e&&e.AllowedValues,typeof i===a?i.apply(e):i))+"</td>\n        </tr>\n        ",r}function m(e,t){var r="",i;r+='\n                <select name="'+f((i=e&&e.SettingName,typeof i===a?i.apply(e):i))+'" class="option-setting select3">\n                    ',i=n.each.call(e,e&&e.items,{hash:{},inverse:u.noop,fn:u.program(10,g,t),data:t});if(i||i===0)r+=i;return r+="\n                </select>\n                ",r}function g(e,t){var r="",i;r+='\n                    <option value="'+f((i=e&&e.value,typeof i===a?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(11,y,t),data:t});if(i||i===0)r+=i;return r+=">"+f((i=e&&e.value,typeof i===a?i.apply(e):i))+"</option>\n                    ",r}function y(e,t){return"selected"}function b(e,t){var n="",r;return n+='\n                <input name="'+f((r=e&&e.SettingName,typeof r===a?r.apply(e):r))+'" data-required="true" data-type="number" class="input option-setting" type="text" class="input" value="'+f((r=e&&e.value,typeof r===a?r.apply(e):r))+'" data-start="'+f((r=e&&e.start,typeof r===a?r.apply(e):r))+'" data-end="'+f((r=e&&e.end,typeof r===a?r.apply(e):r))+'"/>\n                ',n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<form class="content clearfix" data-bind="true">\n    ',o=n["if"].call(t,t&&t.DefaultPort,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n    ",o=n["if"].call(t,t&&t.OptionGroupOptionSettings,{hash:{},inverse:u.noop,fn:u.program(7,d,i),data:i});if(o||o===0)s+=o;return s+='\n    <div class="action">\n        <a class="btn btn-blue do-action add-option" data-option-name="'+f((o=t&&t.Name,typeof o===a?o.apply(t):o))+'">'+f(n.i18n.call(t,"PROP.SAVE_OPTION",{hash:{},data:i}))+'</a>\n        <a class="btn btn-silver cancel">'+f(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+"</a>\n    </div>\n</form>",s},n.og_slide=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="slide-delete">\n    <div class="modal-text-major">'+o(n.i18n.call(t,"PROP.CONFIRM_TO_DELETE_THIS_OPTION_GROUP_QUESTION",{hash:{},data:i}))+'</div>\n    <div class="init action">\n        <button class="btn btn-red remove-confirm">'+o(n.i18n.call(t,"PROP.LBL_DELETE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver remove-cancel">'+o(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+"</button>\n    </div>\n</div>",s},n.og_slide_remove=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n            <a class="tooltip icon-info" href="http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Appendix.MySQL.Options.html" data-tooltip="'+u(n.i18n.call(e,"READ_AWS_DOCUMENT",{hash:{},data:t}))+'" target="_blank"></a>\n            ',r}function c(e,t){var r="";return r+='\n            <a class="tooltip icon-info" href="http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Appendix.Oracle.Options.html" data-tooltip="'+u(n.i18n.call(e,"READ_AWS_DOCUMENT",{hash:{},data:t}))+'" target="_blank"></a>\n            ',r}function h(e,t){var r="";return r+='\n            <a class="tooltip icon-info" href="http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Appendix.SQLServer.Options.html" data-tooltip="'+u(n.i18n.call(e,"READ_AWS_DOCUMENT",{hash:{},data:t}))+'" target="_blank"></a>\n            ',r}function p(e,t){var r="",i;r+="\n            ",i=n["if"].call(e,e&&e.appId,{hash:{},inverse:a.noop,fn:a.program(8,d,t),data:t});if(i||i===0)r+=i;return r+="\n            ",r}function d(e,t){var r="",i;r+='\n            <div class="og-apply-immediately">\n                <div class="checkbox tooltip" ',i=n["if"].call(e,e&&e.isAppPortChanged,{hash:{},inverse:a.noop,fn:a.program(9,v,t),data:t});if(i||i===0)r+=i;r+='>\n                    <input type="checkbox" id="option-apply-immediately" ',i=n["if"].call(e,e&&e.applyImmediately,{hash:{},inverse:a.program(13,g,t),fn:a.program(11,m,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,e&&e.isAppPortChanged,{hash:{},inverse:a.noop,fn:a.program(15,y,t),data:t});if(i||i===0)r+=i;return r+='>\n                    <label for="option-apply-immediately"></label>\n                </div>\n                <label for="option-apply-immediately">'+u(n.i18n.call(e,"PROP.DBINSTANCE_APPLY_IMMEDIATELY",{hash:{},data:t}))+"</label>\n            </div>\n            ",r}function v(e,t){var r="";return r+="data-tooltip="+u(n.i18n.call(e,"RDS_PORT_CHANGE_REQUIRES_APPLIED_IMMEDIATELY",{hash:{},data:t})),r}function m(e,t){return"checked"}function g(e,t){var r;return r=n["if"].call(e,e&&e.isAppPortChanged,{hash:{},inverse:a.noop,fn:a.program(11,m,t),data:t}),r||r===0?r:""}function y(e,t){return"disabled"}function b(e,t){var r="",i;r+='<button class="remove-btn btn btn-red ',i=n["if"].call(e,e&&e.appId,{hash:{},inverse:a.noop,fn:a.program(18,w,t),data:t});if(i||i===0)r+=i;r+='" ',i=n["if"].call(e,e&&e.appId,{hash:{},inverse:a.noop,fn:a.program(20,E,t),data:t});if(i||i===0)r+=i;return r+=">"+u(n.i18n.call(e,"PROP.LBL_DELETE",{hash:{},data:t}))+"</button>",r}function w(e,t){return"disabled tooltip"}function E(e,t){return'data-tooltip="This option group canot be deleted since it is currently in use."'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<div id="modal-option-group">\n    <div class="slidebox">\n        <div class="form"></div>\n        <div class="error">\n        </div>\n    </div>\n    <div class="will-be-covered">\n        <div class="header">\n            '+u(n.i18n.call(t,"OPTION_GROUP_USED_FOR",{hash:{},data:i}))+u((o=t&&t.engineName,typeof o===f?o.apply(t):o))+" "+u((o=t&&t.engineVersion,typeof o===f?o.apply(t):o))+"\n            ",o=n.ifCond.call(t,t&&t.engineType,"mysql",{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n            ",o=n.ifCond.call(t,t&&t.engineType,"oracle",{hash:{},inverse:a.noop,fn:a.program(3,c,i),data:i});if(o||o===0)s+=o;s+="\n            ",o=n.ifCond.call(t,t&&t.engineType,"sqlserver",{hash:{},inverse:a.noop,fn:a.program(5,h,i),data:i});if(o||o===0)s+=o;s+='\n        </div>\n        <div class="container optiongroup">\n            <div class="input-item">\n                <label class="left">'+u(n.i18n.call(t,"PROP.NAME",{hash:{},data:i}))+'</label>\n                <input class="input og-name" value="'+u((o=t&&t.name,typeof o===f?o.apply(t):o))+'" type="text" data-ignore="true" data-required-rollback="true"/>\n            </div>\n            <div class="input-item">\n                <label class="left">'+u(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+'</label>\n                <input class="input og-description" value="'+u((o=t&&t.description,typeof o===f?o.apply(t):o))+'" type="text" data-ignore="true" data-required-rollback="true"/>\n            </div>\n            <div class="left option-list-head">'+u(n.i18n.call(t,"PROP.OPTION",{hash:{},data:i}))+'</div>\n            <ul class="option-list"></ul>\n            ',o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(7,p,i),data:i});if(o||o===0)s+=o;s+='\n        </div>\n        <div class="modal-footer">\n            ',o=n.unless.call(t,t&&t.isCreate,{hash:{},inverse:a.noop,fn:a.program(17,b,i),data:i});if(o||o===0)s+=o;return s+='\n            <span class="err-tip"></span>\n            <button class="save-btn btn btn-blue">'+u(n.i18n.call(t,"PROP.SAVE",{hash:{},data:i}))+'</button>\n            <button class="btn btn-silver modal-close cancel-btn">'+u(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+"</button>\n        </div>\n    </div>\n</div>",s},n.og_modal=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<li class="option-item" data-idx="'+o((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'" data-name="'+o((i=e&&e.Name,typeof i===a?i.apply(e):i))+'">\n    <div class="name">'+o((i=e&&e.Name,typeof i===a?i.apply(e):i))+"</div>\n    ",i=n["if"].call(e,e&&e.Persistent,{hash:{},inverse:u.noop,fn:u.program(2,l,t),data:t});if(i||i===0)r+=i;r+="\n    ",i=n["if"].call(e,e&&e.Permenant,{hash:{},inverse:u.noop,fn:u.program(4,c,t),data:t});if(i||i===0)r+=i;r+='\n\n    <div class="option-edit-btn ',i=n["if"].call(e,e&&e.unmodify,{hash:{},inverse:u.program(8,p,t),fn:u.program(6,h,t),data:t});if(i||i===0)r+=i;r+=' icon-btn-details"></div>\n    <label class="switcher',i=n["if"].call(e,e&&e.checked,{hash:{},inverse:u.noop,fn:u.program(11,v,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e&&e.disabled,{hash:{},inverse:u.noop,fn:u.program(13,m,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,e&&e.unmodify,{hash:{},inverse:u.noop,fn:u.program(6,h,t),data:t});if(i||i===0)r+=i;return r+='">\n        <span class="switch-label" data-on="ON" data-off="OFF"></span>\n        <span class="switch-handle"></span>\n    </label>\n\n</li>\n',r}function l(e,t){var r="";return r+='<div class="persistent">'+o(n.i18n.call(e,"PROP.PERSISTENT",{hash:{},data:t}))+"</div>",r}function c(e,t){var r="";return r+='<div class="permenant">'+o(n.i18n.call(e,"PROP.PERMENANT",{hash:{},data:t}))+"</div>",r}function h(e,t){return"invisible"}function p(e,t){var r="",i;i=n.unless.call(e,e&&e.visible,{hash:{},inverse:u.noop,fn:u.program(6,h,t),data:t});if(i||i===0)r+=i;i=n.unless.call(e,e&&e.checked,{hash:{},inverse:u.noop,fn:u.program(9,d,t),data:t});if(i||i===0)r+=i;return r}function d(e,t){return" invisible"}function v(e,t){return" on"}function m(e,t){return" disabled"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u=this,a="function";return s=n.each.call(t,t&&t.ogOptions,{hash:{},inverse:u.noop,fn:u.program(1,f,i),data:i}),s||s===0?s:""},n.og_option_item=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n    <li class="option-item" data-idx="'+u((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'" data-name="'+u((i=e&&e.OptionName,typeof i===a?i.apply(e):i))+'">\n        <div class="og-title clearfix">\n            <div class="name">'+u((i=e&&e.OptionName,typeof i===a?i.apply(e):i))+"</div>\n            ",i=n["if"].call(e,e&&e.Persistent,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+="\n            ",i=n["if"].call(e,e&&e.Permenant,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+='\n            <a class="toggle-og-detail show-og-detail">'+u(n.i18n.call(e,"PROP.SHOW_DETAILS",{hash:{},data:t}))+'</a>\n            <a class="toggle-og-detail hide-og-detail" style="display:none;">'+u(n.i18n.call(e,"PROP.HIDE_DETAILS",{hash:{},data:t}))+'</a>\n        </div>\n        <div class="og-details">\n            ',i=n["if"].call(e,e&&e.Port,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+="\n            ",i=n.each.call(e,e&&e.VpcSecurityGroupMemberships,{hash:{},inverse:f.noop,fn:f.program(8,d,t),data:t});if(i||i===0)r+=i;r+='\n            <table class="table">\n                <tr><th>'+u(n.i18n.call(e,"PROP.SETTING",{hash:{},data:t}))+"</th><th>"+u(n.i18n.call(e,"PROP.VALUE",{hash:{},data:t}))+"</th></tr>\n                ",i=n.each.call(e,e&&e.OptionSettings,{hash:{},inverse:f.noop,fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;return r+="\n            </table>\n        </div>\n    </li>\n    ",r}function c(e,t){var r="";return r+='<div class="persistent">'+u(n.i18n.call(e,"PROP.PERSISTENT",{hash:{},data:t}))+"</div>",r}function h(e,t){var r="";return r+='<div class="permenant">'+u(n.i18n.call(e,"PROP.PERMENANT",{hash:{},data:t}))+"</div>",r}function p(e,t){var r="",i;return r+="\n            <div>\n                <span>"+u(n.i18n.call(e,"PROP.PORT_COLON",{hash:{},data:t}))+"</span>\n                <span>"+u((i=e&&e.Port,typeof i===a?i.apply(e):i))+"</span>\n            </div>\n            ",r}function d(e,t){var r="",i;return r+="\n            <div>\n                <span>"+u(n.i18n.call(e,"PROP.SECURITY_GROUP_COLON",{hash:{},data:t}))+"</span>\n                <span>"+u((i=e&&e.VpcSecurityGroupId,typeof i===a?i.apply(e):i))+"</span>\n            </div>\n            ",r}function v(e,t){var n="",r;return n+="\n                <tr><td>"+u((r=e&&e.Name,typeof r===a?r.apply(e):r))+"</td><td>"+u((r=e&&e.Value,typeof r===a?r.apply(e):r))+"</td></tr>\n                ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<div class="summary clearfix">\n    <dl>\n        <dt>'+u(n.i18n.call(t,"PROP.OPTION_GROUP_NAME",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=t&&t.OptionGroupName,typeof o===a?o.apply(t):o))+"</dd>\n    </dl>\n    <dl>\n        <dt>"+u(n.i18n.call(t,"PROP.ENGINE",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=t&&t.EngineName,typeof o===a?o.apply(t):o))+"</dd>\n    </dl>\n    <dl>\n        <dt>"+u(n.i18n.call(t,"PROP.OPTION_GROUP_DESCRIPTION",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=t&&t.OptionGroupDescription,typeof o===a?o.apply(t):o))+"</dd>\n    </dl>\n    <dl>\n        <dt>"+u(n.i18n.call(t,"PROP.ENGINE_VERSION",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=t&&t.MajorEngineVersion,typeof o===a?o.apply(t):o))+'</dd>\n    </dl>\n</div>\n<div class="left option-list-head">'+u(n.i18n.call(t,"PROP.OPTION",{hash:{},data:i}))+"("+u((o=(o=t&&t.Options,o==null||o===!1?o:o.length),typeof o===a?o.apply(t):o))+')</div>\n<ul class="option-list">\n    ',o=n.each.call(t,t&&t.Options,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</ul>",s},n.og_app_modal=e.template(t),n});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("og_manage",["constant","CloudResources","component/common/toolbarModalTpl","component/awscomps/OgTpl","i18n!/nls/lang.js","event","UI.modalplus"],function(e,t,n,r,i,s,o){var u,a;return a=function(e,t){return function(n){return n=+n,n>t||n<e?sprintf(i.PARSLEY.RDS_VALUE_IS_NOT_ALLOWED,n):null}},u=function(e){var t,n,r,i,s,o,u,a;s=[];for(u=0,a=e.length;u<a;u++){t=e[u],i={};for(n in t)o=t[n],r=n.charAt(0).toUpperCase()+n.substring(1),i[r]=o;s.push(i)}return s},Backbone.View.extend({id:"modal-option-group",tagName:"section",className:"modal-toolbar",events:{"click .option-item .switcher":"optionChanged","click .option-item .option-edit-btn":"optionEditClicked","click .cancel":"cancel","click .add-option":"addOption","click .save-btn":"saveClicked","click .remove-btn":"removeClicked","click .cancel-btn":"cancelClicked","submit form":"doNothing","click #og-sg input":"changeSg","click .remove-confirm":"removeConfirm","click .remove-cancel":"removeCancel","change #option-apply-immediately":"changeApplyImmediately"},changeApplyImmediately:function(e){return this.model.set("applyImmediately",e.currentTarget.checked)},changeSg:function(e){var t,n;return t=e.currentTarget.checked,n=$("#og-sg input:checked"),n.length?null:!1},doNothing:function(){return!1},getModalOptions:function(){return{title:i.IDE.RDS_EDIT_OPTION_GROUP,classList:"option-group-manage",context:that}},isAppPortChanged:function(){var n,r,i,s,o;return this.isAppEdit?(r=this.ogModel.get("appId"),n=(o=t(Design.instance().credentialId(),e.RESTYPE.DBOG,Design.instance().region()).get(r))!=null?o.toJSON():void 0,n?(i={},s=this,_.each(n.Options,function(e){return i[e.OptionName]=e}),_.some(i,function(e,t){return s.ogDataStore[t]&&+s.ogDataStore[t].Port!==+e.Port})):!1):!1},initModal:function(e){var t,n;return n=this,t={template:e,title:i.IDE.RDS_EDIT_OPTION_GROUP,disableFooter:!0,disableClose:!0,width:"855px",height:"473px",compact:!0,mode:"panel"},this.__modalplus=new o(t),this.__modalplus.on("closed",this.close,this),this.dropdown.refresh(),null},initialize:function(n){var r,i,s,o;return o=this,this.isAppEdit=Design.instance().modeIsAppEdit(),this.dropdown=n.dropdown,this.isCreate=n.isCreate,this.dbInstance=n.dbInstance,s=t(Design.instance().credentialId(),e.RESTYPE.DBENGINE,Design.instance().region()),r=s.getOptionGroupsByEngine(Design.instance().region(),n.engine),r&&(this.ogOptions=r[n.version]),this.ogModel=n.model,this.ogNameOptionMap={},this.ogDataStore={},i=this.ogModel.get("options"),_.each(i,function(e){return o.ogDataStore[e.OptionName]=e,null}),_.each(this.ogOptions,function(e){o.ogNameOptionMap[e.Name]=e,o.ogDataStore[e.Name]?e.checked=!0:e.checked=!1,o.isAppEdit&&(e.Permanent||e.Persistent)&&o.ogModel.get("appId")?e.unmodify=!0:e.unmodify=!1;if(!!e.DefaultPort||!!e.OptionGroupOptionSettings)e.visible=!0;return null}),null},render:function(){var e;return e=this.ogModel.toJSON(),e.isCreate=this.isCreate,e.isAppEdit=this.isAppEdit,e.engineType=this.ogModel.engineType(),e.isAppPortChanged=this.isAppPortChanged(),this.$el.html(r.og_modal(e)),this.initModal(this.el),!Design.instance().credential()||!!Design.instance().credential().isDemo()?(this.renderNoCredential(),!1):(this.renderOptionList(),this.__modalplus.resize(),this)},renderOptionList:function(){return this.$el.find(".option-list").html(r.og_option_item({ogOptions:this.ogOptions,isAppEdit:this.isAppEdit}))},slide:function(e,t){var n;if(!e.DefaultPort&&!e.OptionGroupOptionSettings){t({Port:"",VpcSecurityGroupMemberships:[],OptionSettings:[]});return}return this.optionCb=t,n=this.ogDataStore[e.Name],this.renderSlide(e,n),this.$(".slidebox").addClass("show")},slideUp:function(){return this.$(".slidebox").removeClass("show").removeAttr("style")},cancel:function(){return this.slideUp(),typeof this.optionCb=="function"&&this.optionCb(null),null},removeConfirm:function(){return this.ogModel.remove(),this.dropdown.setSelection(this.dbInstance.getOptionGroupName()),this.dropdown.refresh(),this.slideUp(),this.__modalplus.close()},removeCancel:function(){return this.slideUp()},addOption:function(e){var t,n,r,s,o;r=$(e.currentTarget).data("optionName"),n=$("form");if(!n.parsley("validate")){this.$(".error").html(i.IDE.RDS_SOME_ERROR_OCCURED);return}return t={OptionSettings:u(n.serializeArray())},s=$("#og-port").val(),o=$("#og-sg input:checked"),t.Port=s||"",t.VpcSecurityGroupMemberships=[],o.each(function(){return t.VpcSecurityGroupMemberships.push(Design.instance().component($(this).data("uid")).createRef("GroupId"))}),typeof this.optionCb=="function"&&this.optionCb(t),this.ogDataStore[r]=t,this.slideUp(),null},renderSlide:function(t,n){var i,s,o,u,f,l,c,h,p;t=jQuery.extend(!0,{},t),t.OptionGroupOptionSettings&&!_.isArray(t.OptionGroupOptionSettings)&&(t.OptionGroupOptionSettings=[t.OptionGroupOptionSettings]),t.DefaultPort&&(t.port=(n!=null?n.Port:void 0)||t.DefaultPort,t.sgs=[],Design.modelClassForType(e.RESTYPE.SG).each(function(e){var r,i;return r=e.toJSON(),r["default"]=e.isDefault(),r.color=e.color,r.ruleCount=e.ruleCount(),r.memberCount=e.getMemberList().length,n&&n.VpcSecurityGroupMemberships&&(i=e.createRef("GroupId"),__indexOf.call(n.VpcSecurityGroupMemberships,i)>=0)&&(r.checked=!0),r["default"]?(n||(r.checked=!0),t.sgs.unshift(r)):t.sgs.push(r)})),p=t.OptionGroupOptionSettings||[];for(o=c=0,h=p.length;c<h;o=++c)u=p[o],u.AllowedValues.indexOf(",")>=0?u.items=_.map(u.AllowedValues.split(","),function(e){return{value:e,selected:n&&e===n.OptionSettings[o].Value}}):u.AllowedValues.indexOf("-")>=0&&(i=u.AllowedValues.split("-"),f=+i[0],s=+i[1],u.start=f,u.end=s),u.items&&(u.AllowedValues=""),n?u.value=n.OptionSettings[o].Value:u.value=u.DefaultValue;return this.$(".form").html(r.og_slide(t||{})),this.$(".error").html(""),void 0,l=this,window.setTimeout(function(){return l.__modalplus.$(".slidebox.show").css("max-height",l.__getHeightOfContent())},0),$(window).on("resize",function(){return l.__modalplus.$(".slidebox.show").css("max-height",l.__getHeightOfContent())}),$("form input").each(function(){var e;e=$(this),f=+e.data("start"),s=+e.data("end");if(isFinite(f)&&isFinite(s))return e.parsley("custom",a(f,s))}),null},__getHeightOfContent:function(){var e,t,n;return n=$(window).height(),e=this.__modalplus.tpl,t=e.find(".modal-header").outerHeight(),n-t},renderRemoveConfirm:function(){return this.$(".slidebox").addClass("show"),this.$(".slidebox .form").html(r.og_slide_remove({}))},renderNoCredential:function(){return this.__modalplus.setContent(n.nocredential({resourceName:i.PROP.RESOURCE_NAME_OPTION_GROUP}))},renderSlides:function(e,t){var n,i,s;return i=r["slide_"+e],n=this.getSlides(),(s=n[e])!=null?s.call(this,i,t):void 0},close:function(){return this.optionCb=null,this.remove()},handleApplyImmediately:function(){return this.isAppPortChanged()?this.$("#option-apply-immediately").prop("disabled",!0).prop("checked",!0).parent().data("tooltip",i.IDE.RDS_PORT_CHANGE_REQUIRES_APPLIED_IMMEDIATELY):this.$("#option-apply-immediately").prop("disabled",!1).parent().removeAttr("data-tooltip")},optionChanged:function(e){var t,n,r,i,s,o,u;return u=this,r=$(e.currentTarget),t=r.siblings(".option-edit-btn"),r.toggleClass("on"),n=r.parents(".option-item"),s=Number(n.data("idx")),o=n.data("name"),r.hasClass("on")?(i=this.ogOptions[s],(!!i.DefaultPort||!!i.OptionGroupOptionSettings)&&t.removeClass("invisible"),this.slide(i,function(e){return e?u.ogDataStore[o]=e:u.setOption(n,!1)}),this.handleApplyImmediately()):t.addClass("invisible"),null},optionEditClicked:function(e){var t,n,r,i,s;return s=this,t=$(e.currentTarget),n=t.parents(".option-item"),r=Number(n.data("idx")),i=n.data("name"),this.slide(this.ogOptions[r],function(e){return e&&(s.ogDataStore[i]=e),s.handleApplyImmediately()})},setOption:function(e,t){var n,r;return r=e.find(".switcher"),n=r.siblings(".option-edit-btn"),t?(r.addClass("on"),n.removeClass("invisible")):(r.removeClass("on"),n.addClass("invisible"))},getOption:function(e){var t;return t=e.find(".switcher"),t.hasClass("on")},getOptionByName:function(e){var t;return t=this.$('.option-list .option-item[data-name="'+e+'"]').find(".switcher"),t.hasClass("on")},saveClicked:function(){var e,t,n,r,s,o,u,a,f;f=this,n=this.$(".og-name"),e=this.$(".og-description"),n.val(n.val().toLowerCase()),n.parsley("custom",function(e){var t;t=i.PARSLEY.OPTION_GROUP_NAME_INVALID;if(e[e.length-1]==="-"||e.indexOf("--")!==-1)return t;if(e.length<1||e.length>255)return t;if(!MC.validate("letters",e[0]))return t}),a=MC.aws.aws.checkResName(this.ogModel.get("id"),n,"OptionGroup"),e.parsley("custom",function(e){var t;t=i.PARSLEY.OPTION_GROUP_DESCRIPTION_INVALID;if(e.length<1)return t}),r=!0,t=f.$(".option-list .option-item"),_.each(t,function(e){var t,n,i,s,o,u,a,l;return t=$(e),l=f.getOption(t),l&&(a=t.data("name"),u=f.ogNameOptionMap[a],u.OptionsDependedOn&&u.OptionsDependedOn.OptionName&&(i=u.OptionsDependedOn.OptionName,n=i.split(","),o=[],_.each(n,function(e){var t;t=f.getOptionByName(e);if(!t)return o.push(e)}),o.length&&(r=!1,s=""+a+" has a dependency on "+o.join(",")+" option.",f.$(".err-tip").text(s)))),null});if(!r)return;if(n.parsley("validate")&&e.parsley("validate")&&a)return u=n.val(),o=e.val(),this.ogModel.set("name",u),this.ogModel.set("description",o),s=[],t=this.$(".option-list .option-item"),_.each(t,function(e){var t,n,r;return t=$(e),r=f.getOption(t),r&&(u=t.data("name"),n=f.ogDataStore[u],n.OptionName=u,s.push(n)),null}),this.ogModel.set("options",s),this.dropdown.refresh(),this.__modalplus.close(),null},removeClicked:function(e){var t;t=this;if(!$(e.target).hasClass("disabled"))return this.renderRemoveConfirm()},cancelClicked:function(){var e;return e=this,this.__modalplus.close()}})}),define("og_manage_app",["constant","CloudResources","component/awscomps/OgTpl","i18n!/nls/lang.js","event","UI.modalplus"],function(e,t,n,r,i,s){return Backbone.View.extend({id:"modal-option-group",tagName:"section",className:"modal-toolbar modal-option-group-app",events:{"click .toggle-og-detail":"toggleDetail"},toggleDetail:function(e){var t,n;return n=$(e.currentTarget),t=n.closest("li"),t.toggleClass("show-details"),t.find(".toggle-og-detail").toggle()},initModal:function(e){var t;return t={template:e,title:this.model.get("appId"),width:"855px",height:"473px",compact:!0,confirm:{hide:!0},cancel:{text:"Close"}},this.__modalplus=new s(t),this.__modalplus.on("closed",this.close,this),null},initialize:function(n){var r,i;return r=this.model.get("appId"),this.appData=(i=t(Design.instance().credentialId(),e.RESTYPE.DBOG,Design.instance().region()).get(r))!=null?i.toJSON():void 0,this.appData?this.render():!1},render:function(){return this.$el.html(n.og_app_modal(this.appData)),this.initModal(this.el),this},close:function(){return this.remove()}})}),define("og_dropdown",["constant","CloudResources","combo_dropdown","og_manage","component/awscomps/OgTpl","i18n!/nls/lang.js","credentialFormView"],function(e,t,n,r,i,s,o){return Backbone.View.extend({tagName:"section",events:{"click .icon-edit":"editClicked","click .combo-dd-no-data .create-one":"showCredential"},initDropdown:function(){var e;return e={manageBtnValue:"Create New Option Group ...",filterPlaceHolder:"Filter by Option Group name",noFilter:!0,resourceName:s.PROP.RESOURCE_NAME_OPTION_GROUP},this.dropdown=new n(e),this.dropdown.on("open",this.show,this),this.dropdown.on("manage",this.manage,this),this.dropdown.on("change",this.set,this),this.dropdown.on("filter",this.filter,this),this.dropdown.on("quick_create",this.quickCreate,this)},initialize:function(e){return this.initDropdown(),this.listenTo(Design.instance().credential(),"update",this.credChanged),this.listenTo(Design.instance().credential(),"change",this.credChanged),this.dbInstance=e.dbInstance},render:function(e){var t;return t=this,this.el=this.dropdown.el,this.dropdown.setSelection("None"),this.engine=e.engine,this.engineVersion=e.engineVersion,this.version=e.majorVersion,this.refresh(),this},credChanged:function(){var e;return(e=this.dropdown)!=null&&e.render("loading"),this.refresh()},refresh:function(){var n,r,i,s,o,u,a;return a=this,u=Design.instance().region(),s=t(Design.instance().credentialId(),e.RESTYPE.DBENGINE,u),o=Design.modelClassForType(e.RESTYPE.DBOG).allObjects(),i=[],r=s.getDefaultByNameVersion(u,this.engine,this.engineVersion),r&&r.defaultOGName&&i.push({id:null,name:r.defaultOGName}),n=[],_.each(o,function(e){if(e.get("engineName")===a.engine&&e.get("engineVersion")===a.version)return n.push({id:e.id,name:e.get("name"),data:e.toJSON()})}),this.ogAry=i.concat(n),this.renderDropdownList()},renderDropdownList:function(){var e,t;return t=this,this.ogAry.length?(e=this.dbInstance.getOptionGroupName(),_.each(this.ogAry,function(n){var r,i;return r=n.name,i=[],n.data&&(_.each(n.data.options,function(e){return i.push(e.OptionName)}),n.preview=i.join(",")),r&&r===e&&(n.selected=!0,t.dropdown.setSelection(e)),null}),this.dropdown.setContent(i.dropdown_list(this.ogAry)).toggleControls(!0)):this.dropdown.setContent(i.no_option_group({})).toggleControls(!0)},quickCreate:function(){var t,n;return t=Design.modelClassForType(e.RESTYPE.DBOG),n=new t({engineName:this.engine,engineVersion:this.version}),(new r({dbInstance:this.dbInstance,engine:this.engine,version:this.version,model:n,dropdown:this,isCreate:!0})).render()},renderNoCredential:function(){return this.dropdown.render("nocredential").toggleControls(!1)},show:function(){if(!Design.instance().credential()||!!Design.instance().credential().isDemo())return this.renderNoCredential(),!1;$("#property-dbinstance-parameter-group-select .selectbox").removeClass("open");if(!this.dropdown.$(".item").length)return this.renderDropdownList()},manage:function(){return this.quickCreate()},set:function(e,t){return this.dbInstance.setOptionGroup(t.name)},filter:function(e){},editClicked:function(e){var t,n,i;return t=$(e.currentTarget).parent(),i=t.data("id"),i&&(n=Design.instance().component(i),(new r({dbInstance:this.dbInstance,engine:this.engine,version:this.version,model:n,dropdown:this})).render()),!1},setSelection:function(){return this.dropdown.setSelection.apply(this,arguments)},showCredential:function(){return(new o({model:Design.instance().project()})).render()}})}),define("component/awscomps/SGRulePppTpl",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n\n      <div class="selectbox" id="sg-create-sg-out">\n        <div class="selection"><span class="sg-create-sg-color" style="background:'+f((i=(i=(i=e&&e.owner,i==null||i===!1?i:i[0]),i==null||i===!1?i:i.color),typeof i===a?i.apply(e):i))+'"></span>'+f((i=(i=(i=e&&e.owner,i==null||i===!1?i:i[0]),i==null||i===!1?i:i.name),typeof i===a?i.apply(e):i))+'</div>\n        <ul class="dropdown">\n          ',i=n.each.call(e,e&&e.owner,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;return r+='\n        </ul>\n      </div>\n\n      <div class="selectbox" id="sg-create-direction">\n        <div class="selection">'+f(n.i18n.call(e,"PROP.INITIATE_TRAFFIC_TO",{hash:{},data:t}))+'</div>\n        <ul class="dropdown">\n          <li class="item selected" data-id="outbound">'+f(n.i18n.call(e,"PROP.INITIATE_TRAFFIC_TO",{hash:{},data:t}))+'</li>\n          <li class="item" data-id="inbound">'+f(n.i18n.call(e,"PROP.ACCEPT_TRAFFIC_FROM",{hash:{},data:t}))+'</li>\n          <li class="item" data-id="biway">'+f(n.i18n.call(e,"PROP.HAVE_2WAY_TRAFFIC_WITH",{hash:{},data:t}))+"</li>\n        </ul>\n      </div>\n\n      ",r}function c(e,t){var r="",i;r+='\n            <li class="item ',i=n.unless.call(e,t==null||t===!1?t:t.index,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+f((i=e&&e.uid,typeof i===a?i.apply(e):i))+'">\n              <span class="sg-create-sg-color" style="background:'+f((i=e&&e.color,typeof i===a?i.apply(e):i))+'"></span>\n              '+f((i=e&&e.name,typeof i===a?i.apply(e):i))+"\n            </li>\n          ",r}function h(e,t){return"selected"}function p(e,t){var r="",i;return r+='\n\n      <div id="sg-create-sg-out">\n        <div class="sg-create-selection selected" data-id="'+f((i=(i=e&&e.owner,i==null||i===!1?i:i.uid),typeof i===a?i.apply(e):i))+'">'+f((i=(i=e&&e.owner,i==null||i===!1?i:i.name),typeof i===a?i.apply(e):i))+'</div>\n      </div>\n\n      <div id="sg-create-direction">\n        <div class="sg-create-selection selected" data-id="outbound">'+f(n.i18n.call(e,"PROP.INITIATE_TRAFFIC_TO",{hash:{},data:t}))+"</div>\n      </div>\n\n      ",r}function d(e,t){var r="",i;r+='\n            <li class="item truncate ',i=n.unless.call(e,t==null||t===!1?t:t.index,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+f((i=e&&e.uid,typeof i===a?i.apply(e):i))+'">\n              <span class="sg-create-sg-color" style="background:'+f((i=e&&e.color,typeof i===a?i.apply(e):i))+'"></span>\n              '+f((i=e&&e.name,typeof i===a?i.apply(e):i))+"\n            </li>\n          ",r}function v(e,t){return'\n          <li class="item" data-id="custom">Custom</li>\n          <li class="item" data-id="all">All</li>\n          '}function m(e,t){var r="";return r+='\n          <section class="sg-proto-input" id="sg-proto-ipt-custom">\n            <input class="input" type="text" name="protocol-custom-ranged" value="1" min="1" max="255" data-ignore="true" data-ignore-regexp="^[0-9]*$" data-required="true">\n          </section>\n\n          <section class="sg-proto-input" id="sg-proto-ipt-all">'+f(n.i18n.call(e,"PROP.PORT_RANGE_COLON",{hash:{},data:t}))+"0-65535</section>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<article class="modal-body" id="sg-rule-create-modal" data-bind="true">\n  <section class="sg-rule-create-add-wrap">\n    <section class="sg-node-wrap clearfix">\n      <label>'+f(n.i18n.call(t,"PROP.ALLOW",{hash:{},data:i}))+"</label>\n\n      ",o=n["if"].call(t,(o=t&&t.owner,o==null||o===!1?o:o.length),{hash:{},inverse:u.program(5,p,i),fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n      <div class="selectbox" id="sg-create-sg-in">\n        <div class="selection truncate"><span class="sg-create-sg-color" style="background:'+f((o=(o=(o=t&&t.relation,o==null||o===!1?o:o[0]),o==null||o===!1?o:o.color),typeof o===a?o.apply(t):o))+'"></span>'+f((o=(o=(o=t&&t.relation,o==null||o===!1?o:o[0]),o==null||o===!1?o:o.name),typeof o===a?o.apply(t):o))+'</div>\n        <ul class="dropdown">\n          ',o=n.each.call(t,t&&t.relation,{hash:{},inverse:u.noop,fn:u.program(7,d,i),data:i});if(o||o===0)s+=o;s+='\n        </ul>\n      </div>\n    </section>\n\n    <p class="clearfix mgt10">\n      <label class="sg-create-proto-label">'+f(n.i18n.call(t,"PROP.DESTINATION_PROTOCOL",{hash:{},data:i}))+'</label>\n      <label class="sg-create-proto-label-port">'+f((o=t&&t.Port,typeof o===a?o.apply(t):o))+'</label>\n    </p>\n\n    <section class="clearfix sg-proto-option-wrap">\n      <div class="selectbox sg-proto-option" id="sg-create-proto" data-protocal-type="tcp">\n        <div class="selection">TCP</div>\n        <ul class="dropdown" tabindex="-1">\n          <li class="selected item" data-id="tcp">TCP</li>\n          <li class="item" data-id="udp">UDP</li>\n          <li class="item" data-id="icmp">ICMP</li>\n          ',o=n.unless.call(t,t&&t.isClassic,{hash:{},inverse:u.noop,fn:u.program(9,v,i),data:i});if(o||o===0)s+=o;s+='\n        </ul>\n      </div>\n\n      <div class="sg-create-proto-inputs">\n          <section class="sg-proto-input" id="sg-proto-ipt-tcp" style="display:block;">\n            <input class="input" type="text" placeholder="Port Range.eg.80 or 49152-65535" data-ignore="true" data-ignore-regexp="^[0-9-]*$" data-required="true"/>\n          </section>\n\n          <section class="sg-proto-input" id="sg-proto-ipt-udp">\n            <input class="input" type="text" placeholder="Port Range.eg.80 or 49152-65535" data-ignore="true" data-ignore-regexp="^[0-9-]*$" data-required="true"/>\n          </section>\n\n          <section class="sg-proto-input" id="sg-proto-ipt-icmp">\n            <div class="selectbox" id="sg-proto-icmp-sel">\n              <div class="selection">Echo Reply(0)</div>\n              <div class="dropdown scroll-wrap scrollbar-auto-hide context-wrap" style="height:300px;">\n                <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n                <ul tabindex="-1" class="scroll-content">\n                  <li class="item selected" data-id="0">Echo Reply(0)</li>\n                  <li class="item" data-id="3">Destination Unreachable(3) ...</li>\n                  <li class="item" data-id="4">Source Quench(4)</li>\n                  <li class="item" data-id="5">Redirect Message(5) ...</li>\n                  <li class="item" data-id="6">Alternate Host Address(6)</li>\n                  <li class="item" data-id="8">Echo Request(8)</li>\n                  <li class="item" data-id="9">Router Advertisement(9)</li>\n                  <li class="item" data-id="10">Router Solicitation(10)</li>\n                  <li class="item" data-id="11">Time Exceeded(11) ...</li>\n                  <li class="item" data-id="12">Parameter Problem: Bad IP header(12) ...</li>\n                  <li class="item" data-id="13">Timestamp(13)</li>\n                  <li class="item" data-id="14">Timestamp Reply(14)</li>\n                  <li class="item" data-id="15">Information Request(15)</li>\n                  <li class="item" data-id="16">Information Reply(16)</li>\n                  <li class="item" data-id="17">Address Mask Request(17)</li>\n                  <li class="item" data-id="18">Address Mask Reply(18)</li>\n                  <li class="item" data-id="30">Traceroute(30)</li>\n                  <li class="item" data-id="31">Datagram Conversion Error(31)</li>\n                  <li class="item" data-id="32">Mobile Host Redirect(32)</li>\n                  <li class="item" data-id="33">Where Are You(33)</li>\n                  <li class="item" data-id="34">Here I Am(34)</li>\n                  <li class="item" data-id="35">Mobile Registration Request(35)</li>\n                  <li class="item" data-id="36">Mobile Registration Reply(36)</li>\n                  <li class="item" data-id="37">Domain Name Request(37)</li>\n                  <li class="item" data-id="38">Domain Name Reply(38)</li>\n                  <li class="item" data-id="39">SKIP Algorithm Discovery Protocol(39)</li>\n                  <li class="item" data-id="40">Photuris Security Failures(40)</li>\n                  <li class="item" data-id="-1">All(-1)</li>\n                </ul>\n              </div>\n            </div>\n            <div class="selectbox sg-proto-input-sub" id="sg-proto-input-sub-3">\n              <div class="selection">All(-1)</div>\n              <div class="dropdown scroll-wrap scrollbar-auto-hide context-wrap" style="height:300px;">\n                <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n                <ul class="scroll-content" tabindex="-1">\n                  <li class="item selected" data-id="-1">All(-1)</li>\n                  <li class="item" data-id="0">destination network unreachable(0)</li>\n                  <li class="item" data-id="1">destination host unreachable(1)</li>\n                  <li class="item" data-id="2">destination protocol unreachable(2)</li>\n                  <li class="item" data-id="3">destination port unreachable(3)</li>\n                  <li class="item" data-id="4">fragmentation required and DF flag set(4)</li>\n                  <li class="item" data-id="5">source route failed(5)</li>\n                  <li class="item" data-id="6">destination network unknown(6)</li>\n                  <li class="item" data-id="7">destination host unknown(7)</li>\n                  <li class="item" data-id="8">source host isolated(8)</li>\n                  <li class="item" data-id="9">network administratively prohibited(9)</li>\n                  <li class="item" data-id="10">host administratively prohibited(10)</li>\n                  <li class="item" data-id="11">network unreachable for TOS(11)</li>\n                  <li class="item" data-id="12">host unreachable for TOS(12)</li>\n                  <li class="item" data-id="13">communication administratively prohibited(13)</li>\n                </ul>\n              </div>\n            </div>\n            <div class="selectbox sg-proto-input-sub" id="sg-proto-input-sub-5">\n              <div class="selection">All(-1)</div>\n              <ul class="dropdown" tabindex="-1">\n                <li class="selected item" data-id="-1">All(-1)</li>\n                <li class="item" data-id="0">redirect datagram for the network(0)</li>\n                <li class="item" data-id="1">redirect datagram for the host(1)</li>\n                <li class="item" data-id="2">redirect datagram for the TOS & network(2)</li>\n                <li class="item" data-id="3">redirect datagram for the TOS & host(3)</li>\n              </ul>\n            </div>\n            <div class="selectbox sg-proto-input-sub" id="sg-proto-input-sub-11">\n              <div class="selection">All(-1)</div>\n              <ul class="dropdown" tabindex="-1">\n                <li class="item selected" data-id="-1">All(-1)</li>\n                <li class="item" data-id="0">TTL expired transit(0)</li>\n                <li class="item" data-id="1">fragmentation reasembly time exceeded(1)</li>\n              </ul>\n            </div>\n            <div class="selectbox sg-proto-input-sub" id="sg-proto-input-sub-12">\n              <div class="selection">All(-1)</div>\n              <ul class="dropdown" role="menu">\n                <li class="item selected" data-id="-1">All(-1)</li>\n                <li class="item" data-id="0">pointer indicates the error(0)</li>\n                <li class="item" data-id="1">missing a required option(1)</li>\n                <li class="item" data-id="2">bad length(2)</li>\n              </ul>\n            </div>\n          </section>\n\n\n    ',o=n.unless.call(t,t&&t.isClassic,{hash:{},inverse:u.noop,fn:u.program(11,m,i),data:i});if(o||o===0)s+=o;return s+='\n      </div>\n    </section>\n    <button class="btn btn-blue sg-rule-create-add">'+f(n.i18n.call(t,"PROP.ADD_RULE",{hash:{},data:i}))+'</button>\n  </section>\n\n  <section class="sg-rule-create-done-wrap">\n    <div>\n      <p id="sg-rule-create-msg" class="modal-text-major"></p>\n      <p id="sg-rule-self-ref" class="hide"><i class="icon-info icon-label"></i>'+f(n.i18n.call(t,"PROP.RULE_REF_ITS_OWN_SG",{hash:{},data:i}))+'</p>\n    </div>\n    <button class="btn btn-blue sg-rule-create-readd">'+f(n.i18n.call(t,"PROP.CREATE_ANOTHER_RULE",{hash:{},data:i}))+'</button>\n    <button class="btn btn-silver btn-modal-close">'+f(n.i18n.call(t,"PROP.LBL_CLOSE",{hash:{},data:i}))+'</button>\n  </section>\n</article>\n\n\n\n<aside class="sg-rule-create-sidebar">\n  <div class="sidebar-wrap">\n  <header class="sg-create-sb-h">'+f(n.i18n.call(t,"PROP.RELATED_RULE",{hash:{},data:i}))+'<span class="num-wrap" id="sgRuleCreateCount">('+f((o=t&&t.ruleCount,typeof o===a?o.apply(t):o))+')</span></header>\n  <section class="scroll-wrap scrollbar-auto-hide" style="max-height:358px">\n      <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n      <div class="scroll-content sg-create-rule-list" id="sgRuleCreateSidebar"></div>\n  </section>\n</div>\n</aside>',s};return e.template(t)}),define("component/awscomps/SGRulePopupView",["./SGRulePppTpl","i18n!/nls/lang.js","Design","event","UI.modalplus"],function(e,t,n,r,i){var s;return s=Backbone.View.extend({events:{"click .sg-rule-create-add":"addRule","click .sg-rule-create-readd":"readdRule","OPTION_CHANGE #sg-create-proto":"onProtocolChange","click .sg-rule-delete":"deleteRule","OPTION_CHANGE #sg-proto-icmp-sel":"onICMPChange","click .btn-modal-close":"onModalClose"},render:function(){return this.modal=new i({title:t.PROP.CREATE_SECURITY_GROUP_RULE,template:e(this.model.attributes),compact:!0,disableClose:!0,disableFooter:!0,width:530}),this.modal.find(".modal-header").css({background:"#232526"}),this.setElement($("#sg-rule-create-modal").closest("#modal-wrap")),this.updateSidebar(),null},addRule:function(e){var n,r,i,s,o,u;r=this.extractRuleData(e);if(!r)return;u=this.model.addRule(r);if(u===0)return;return o=$("#sg-create-sg-out").find(".selected").text(),i=$("#sg-create-sg-in").find(".selected").text(),n=$("#sg-create-direction").find(".selected").text(),$("#sg-rule-self-ref").hide(),u===1?s=sprintf(t.PROP.MSG_SG_CREATE,o,o,n,i):r.target===r.relation?(s=sprintf(t.PROP.MSG_SG_CREATE_SELF,u,o,o),$("#sg-rule-self-ref").show()):s=sprintf(t.PROP.MSG_SG_CREATE_MULTI,u,o,i,o,n,i),$("#sg-rule-create-msg").text(s),this.$el.find(".modal-box").toggleClass("done",!0),this.updateSidebar()},readdRule:function(){return this.$el.find(".modal-box").toggleClass("done",!1)},deleteRule:function(e){var t,n,r,i,s;return n=$(e.currentTarget).closest("li"),s={ruleSetId:n.attr("data-uid"),protocol:n.attr("data-protocol"),relation:n.attr("data-relation"),port:n.attr("data-port"),direction:n.attr("data-direction")},r=n.parent(),n.remove(),r.children().length===0&&(r.prev().remove(),r.remove()),this.model.delRule(s),t=$("#sgRuleCreateCount"),i=parseInt($("#sgRuleCreateCount").text().replace("(",""),10)-1,i<0&&(i=0),t.text("("+i+")"),!1},onDirChange:function(){return $(".sg-rule-direction").html($("#sg-rule-create-dir-i").is(":checked")?t.IDE.POP_SGRULE_LBL_SOURCE:t.IDE.POP_SGRULE_LBL_DEST)},onProtocolChange:function(e,t){return $(".sg-proto-input").hide(),$("#sg-proto-ipt-"+t).show(),t==="custom"?$("#sg-rule-create-modal .sg-create-proto-label-port").text("Protocol"):$("#sg-rule-create-modal .sg-create-proto-label-port").text("Port")},onICMPChange:function(e,t){return $(".sg-proto-input-sub").hide(),$("#sg-proto-input-sub-"+t).show()},updateSidebar:function(){var e,t,n,r,i,s,o,u;i=0,u=this.model.attributes.groups||[];for(s=0,o=u.length;s<o;s++)n=u[s],i+=n.rules.length,n.rules.deletable=!0,n.content=MC.template.sgRuleList(n.rules);t=$("#sgRuleCreateSidebar").html(MC.template.groupedSgRuleList(this.model.attributes)),$("#sgRuleCreateCount").text("("+i+")"),e=this.$el.find(".modal-box"),t=t.closest(".sg-rule-create-sidebar"),r=t.hasClass("shown");if(i===0){if(r)return t.removeClass("shown").animate({left:"0"}),e.animate({left:"-=100px"},300)}else if(!r)return t.addClass("shown").animate({left:"-200px"}),e.animate({left:"+=100px"},300)},onModalClose:function(){var e,t;return this.modal.close(),t=this.model.get("lineId"),e=n.instance().component(t),e&&r.trigger(r.OPEN_PROPERTY,e.type,t),!1},extractRuleData:function(e){var n,r,i,s,o,u,a,f,l,c,h;l=$("#sg-proto-ipt-tcp input"),c=$("#sg-proto-ipt-udp input"),i=$("#sg-proto-ipt-custom input"),a=$("#sg-create-proto").find(".selected").attr("data-id"),h={custom:{dom:i,method:function(e){return MC.validate.portRange(e)?Number(e)<0||Number(e)>255?t.PARSLEY.THE_PROTOCOL_NUMBER_RANGE_MUST_BE_0_255:null:t.PARSLEY.MUST_BE_A_VALID_FORMAT_OF_NUMBER}},tcp:{dom:l,method:function(e){var n;return n=MC.validate.portRange(e),n?MC.validate.portValidRange(n)?null:t.PARSLEY.PORT_RANGE_BETWEEN_0_65535:t.PARSLEY.MUST_BE_A_VALID_FORMAT_OF_PORT_RANGE}},udp:{dom:c,method:function(e){var n;return n=MC.validate.portRange(e),n?MC.validate.portValidRange(n)?null:t.PARSLEY.PORT_RANGE_BETWEEN_0_65535:t.PARSLEY.MUST_BE_A_VALID_FORMAT_OF_PORT_RANGE}}},a in h&&(s=h[a],s.dom.parsley("custom",s.method));if(s&&!s.dom.parsley("validate"))return;f={protocol:a,direction:$("#sg-create-direction").find(".selected").attr("data-id"),fromPort:"",toPort:"",target:$("#sg-create-sg-out").find(".selected").attr("data-id"),relation:$("#sg-create-sg-in").find(".selected").attr("data-id")},r=$("#sg-proto-ipt-"+f.protocol),n=r.find("input"),o=n.val();switch(a){case"tcp":case"udp":u=o.split("-"),f.fromPort=u[0].trim(),u.length>=2&&(f.toPort=u[1].trim());break;case"icmp":o=$("#sg-proto-icmp-sel").find(".selected").attr("data-id"),f.fromPort=o,o==="3"||o==="5"||o==="11"||o==="12"?f.toPort=$("#sg-proto-input-sub-"+o).find(".selected").attr("data-id"):f.toPort="-1";break;case"custom":f.protocol=o}return f}}),s}),define("SGRulePopup",["constant","Design","component/awscomps/SGRulePopupView","backbone"],function(e,t,n){var r,i;return i=Backbone.Model.extend({initialize:function(){var e,n,r,i;return e=t.instance(),r=this.get("port1"),i=this.get("port2"),n=function(e){return{uid:e.id,color:e.color,name:e.get("name")}},this.set("relation",_.map(i.connectionTargets("SgAsso"),n)),_.isString(r)?this.set("owner",{name:r,uid:this.get("port1").id}):this.set("owner",_.map(r.connectionTargets("SgAsso"),n)),this.updateGroupList(),null},updateGroupList:function(){var e,n,r,i;return i=t.instance(),r=i.component(this.get("uid")),e=t.modelClassForType("SgRuleSet"),n=e.getRelatedSgRuleSets(this.get("port1"),this.get("port2")),this.set("groups",e.getGroupedObjFromRuleSets(n)),null},addRule:function(e){var n,r,i,s,o;return o=t.instance().component(e.target),i=t.instance().component(e.relation),n=t.modelClassForType("SgRuleSet"),s=new n(o,i),r=2,s.addRule(e.target,e.direction,e),e.direction==="biway"&&(r*=2),this.updateGroupList(),r},delRule:function(e){var n;return n=t.instance().component(e.ruleSetId),n.removeRuleByPlainObj(e),null}}),r=function(e,r){var s,o,u;return r?(u=e,e=""):(s=t.instance().component(e),u=s.port1Comp(),r=s.port2Comp()),o=new i({port1:u,port2:r,lineId:e}),(new n({model:o})).render()},r}),define("component/awscomps/DbSubnetGPopupTpl",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n		<header class="mega-list-wraper-header">'+a((i=t==null||t===!1?t:t.key,typeof i===u?i.apply(e):i))+"</header>\n		",i=n.each.call(e,e,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function c(e,t){var r="",i;r+='\n		<section class="mega-list-wraper-body">\n		  <div class="checkbox dbsgppp-check">\n		   <input id="dbsgppp-'+a((i=e&&e.idx,typeof i===u?i.apply(e):i))+'" class="dbsgppp-subnet" type="checkbox" data-id="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.checked,{hash:{},inverse:f.noop,fn:f.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='>\n		   <label for="dbsgppp-'+a((i=e&&e.idx,typeof i===u?i.apply(e):i))+'"></label>\n		  </div>\n		  <div class="dbsgppp-sbname" for="dbsgppp-'+a((i=e&&e.idx,typeof i===u?i.apply(e):i))+'">'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'\n		  	<div class="dbsgppp-cidr">('+a((i=e&&e.cidr,typeof i===u?i.apply(e):i))+")</div>\n		  </div>\n\n		</section>\n		",r}function h(e,t){return'checked="checked"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<p class="modal-text-major">'+a(n.i18n.call(t,"IDE.POP_SELECT_SUBNET_FOR_SUBNET_GROUP_CONTENT",t&&t.minAZCount,{hash:{},data:i}))+'</p>\n\n<div class="scroll-wrap" style="max-height:256px;">\n	<div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n	<div class="scroll-content">\n		',o=n.each.call(t,t&&t.group,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n	</div>\n</div>",s};return e.template(t)}),define("DbSubnetGPopup",["component/awscomps/DbSubnetGPopupTpl","i18n!/nls/lang.js","UI.modalplus","constant","Design"],function(e,t,n,r,i){return Backbone.View.extend({events:{"click .dbsgppp-subnet":"updateSelected"},initialize:function(){var s,o,u,a,f,l;a=this,s=this.model.connectionTargets("SubnetgAsso"),f=_.map(this.model.design().componentsOfType(r.RESTYPE.SUBNET),function(e,t){return{az:e.parent().get("name"),id:e.id,name:e.get("name"),cidr:e.get("cidr"),idx:t,checked:s.indexOf(e)>=0}}),(l=i.instance().region())==="cn-north-1"?o=1:o=2,u=new n({title:t.IDE.POP_SELECT_SUBNET_FOR_SUBNET_GROUP_TITLE,template:e({minAZCount:o,group:_.groupBy(f,"az")}),confirm:{text:t.IDE.POP_LBL_DONE},disableClose:!0,onCancel:function(){return a.cancel()},onClose:function(){return a.cancel()},onConfirm:function(){return a.apply(),u.close()}}),this.setElement(u.tpl),this.updateSelected()},updateSelected:function(){var e,t,n,r;t=this.$el.closest(".modal-box").find(".modal-confirm"),e={},_.each(this.$el.find(".dbsgppp-subnet:checked"),function(t){var n;return n=$(t).attr("data-id"),e[i.instance().component(n).parent().get("name")]=!0}),(r=i.instance().region())==="cn-north-1"?n=1:n=2,_.keys(e).length>=n?t.removeAttr("disabled"):t.attr("disabled","disabled")},cancel:function(){this.model.connectionTargets("SubnetgAsso").length===0&&this.model.remove()},apply:function(){var e,t,n,s,o,u,a,f,l,c,h,p,d,v,m;f={},v=this.$el.find(".dbsgppp-subnet:checked");for(c=0,p=v.length;c<p;c++)t=v[c],f[$(t).attr("data-id")]=!0;s={},m=this.model.connections("SubnetgAsso");for(h=0,d=m.length;h<d;h++)a=m[h],o=a.getTarget(r.RESTYPE.SUBNET).id,f[o]?s[o]=!0:a.remove();e=i.modelClassForType("SubnetgAsso"),n=this.model.design();for(u in f)l=f[u],s[u]||new e(this.model,n.component(u));this.trigger("update")}})}),define("component/AwsComps",function(){});