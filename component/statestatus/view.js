(function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define(["event","./template","backbone","jquery","handlebars"],function(t,n){var r,i;return r=Backbone.View.extend({tagName:"li",className:"state-status-item",initialize:function(){return this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(n.item(this.model.toJSON())),this},events:{"click .state-status-item-detail":"openStateEditor"},openStateEditor:function(){return t.trigger(t.OPEN_PROPERTY,null,this.model.get("uid"),!1,"state"),null}}),i=Backbone.View.extend({events:{"click .modal-close":"closePopup","click .state-status-update":"renderNew"},initialize:function(){return this.items=this.model.get("items"),this.listenTo(this.model,"change:items",this.renderAllItem),this.listenTo(this.model,"change:stop",this.renderAllItem),this.listenTo(this.model,"change:new",this.renderUpdate),this.itemView=r,null},render:function(){return this.$statusModal=this.$el,this.$el.html(n.modal()),this.$(".modal-state-statusbar").html(n.content()),this.renderAllItem(),$("#status-bar-modal").html(this.el).show(),this},renderUpdate:function(e){var t;return t=e.get("new").length,t&&this.$(".update-tip").html(n.update(t)),scrollbar.scrollTo(this.$(".scroll-wrap"),{top:0})},renderNew:function(){return this.$(".update-tip div").hide(),this.renderAllItem(),this.model.flushNew()},renderAllItem:function(){var e;e=this.items;if(this.model.get("stop")){this.renderPending();return}if(e.length)return this.renderContainer(),e.each(this.renderItem,this)},renderItem:function(t,n){var r;return r=new this.itemView({model:t}),r.render(),r.$el.hide(),this.$(".state-status-list").append(r.el),e.call(this.model.get("new"),t)>=0?_.defer(function(){return r.$el.fadeIn(300)}):r.$el.show()},renderContainer:function(){return this.$(".status-item").html(n.container())},renderPending:function(){return this.$(".status-item").html(n.pending())},closePopup:function(){return $("#status-bar-modal").hide(),this.trigger("CLOSE_POPUP")}}),i})}).call(this);