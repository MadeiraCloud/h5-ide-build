define("scenes/ProjectTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){return"role-observer"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a=this.escapeExpression;s+='<div class="project-scene ',o=n["if"].call(t,t&&t.observer,{hash:{},inverse:u.noop,fn:u.program(1,f,i),data:i});if(o||o===0)s+=o;return s+='">\n  <header class="project-header">\n    <button class="ph-nav-btn project-list popuptrigger truncate icon-caret-down" data-popup="popupProject"></button>\n    <button class="ph-nav-btn icon-menu asset-list popuptrigger" data-popup="popupAsset"></button>\n    <div class="ws-tabbar"><ul class="ws-fixed-tabs"></ul><ul class="ws-tabs"></ul></div>\n    <nav>\n      <!--\n      <a class="ph-nav-btn cloudfielder-btn" href="http://cloudfielder.com/" target="_blank"><img src="/assets/images/ide/cf-favicon.ico" /> CloudFielder<span>NEW</span></a>\n      -->\n      <button class="ph-nav-btn user-guide-btn popuptrigger truncate" data-popup="popupGuide">Guide</button>\n      <a class="ph-nav-btn icon-support" href="mailto:3rp02j1w@incoming.intercom.io" target="_blank">'+a(n.i18n.call(t,"IDE.DASH_LBL_SUPPORT",{hash:{},data:i}))+'</a>\n      <button class="ph-nav-btn icon-notification popuptrigger" data-popup="popupNotify"></button>\n      <button class="ph-nav-btn user-menu popuptrigger truncate tooltip" data-tooltip-type="html" data-tooltip="" data-popup="popupUser"></button>\n    </nav>\n  </header>\n\n  <section class="ws-content"></section>\n</div>',s},n.frame=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='<li>\n        <h3 class="nav-group-title">'+u((i=e&&e.regionName,typeof i===a?i.apply(e):i))+" ("+u((i=(i=e&&e.data,i==null||i===!1?i:i.length),typeof i===a?i.apply(e):i))+')</h3>\n        <nav class="nav-item-list">\n        ',i=n.each.call(e,e&&e.data,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n        </nav>\n      </li>",r}function c(e,t){var r="",i;r+='<a class="route truncate icon-app-',i=n["if"].call(e,e&&e.progressing,{hash:{},inverse:f.program(5,p,t),fn:f.program(3,h,t),data:t});if(i||i===0)r+=i;r+='" href="'+u((i=e&&e.url,typeof i===a?i.apply(e):i))+'" title="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+" ["+u((i=e&&e.stateDesc,typeof i===a?i.apply(e):i))+']">'+u((i=e&&e.name,typeof i===a?i.apply(e):i)),i=n["if"].call(e,e&&e.usage,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="</a>",r}function h(e,t){return"pending"}function p(e,t){return u(n.tolower.call(e,e&&e.stateDesc,{hash:{},data:t}))}function d(e,t){var n="",r;return n+='<i class="icon-app-type-'+u((r=e&&e.usage,typeof r===a?r.apply(e):r))+'"></i>',n}function v(e,t){var r="";return r+='<div class="nav-empty">'+u(n.i18n.call(e,"DASH_LBL_NO_APP",{hash:{},data:t}))+"</div>",r}function m(e,t){var r="",i;r+='<li>\n        <h3 class="nav-group-title">'+u((i=e&&e.regionName,typeof i===a?i.apply(e):i))+" ("+u((i=(i=e&&e.data,i==null||i===!1?i:i.length),typeof i===a?i.apply(e):i))+')</h3>\n        <nav class="nav-item-list">\n        ',i=n.each.call(e,e&&e.data,{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;return r+="\n        </nav>\n      </li>",r}function g(e,t){var n="",r;return n+='<a class="route icon-stack-nav truncate" href="'+u((r=e&&e.url,typeof r===a?r.apply(e):r))+'">'+u((r=e&&e.name,typeof r===a?r.apply(e):r))+"</a>",n}function y(e,t){var r="";return r+='<div class="nav-empty">'+u(n.i18n.call(e,"DASH_LBL_NO_STACK",{hash:{},data:t}))+"</div>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<aside class="header-popup ph-asset-list">\n  <nav>\n    <button class="off-canvas-tab" data-id="app">'+u(n.i18n.call(t,"NAV_TIT_APPS",{hash:{},data:i}))+'</button>\n    <button class="off-canvas-tab selected" data-id="stack">'+u(n.i18n.call(t,"NAV_TIT_STACKS",{hash:{},data:i}))+'</button>\n  </nav>\n  <div class="ph-asset-list-wrap">\n    <ul data-id="app" class="hide">\n      ',o=n.each.call(t,t&&t.apps,{hash:{},inverse:f.program(9,v,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n    </ul>\n    <ul data-id="stack">\n      ',o=n.each.call(t,t&&t.stacks,{hash:{},inverse:f.program(14,y,i),fn:f.program(11,m,i),data:i});if(o||o===0)s+=o;return s+="\n    </ul>\n  </div>\n</aside>",s},n.assetList=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='<li><a class="route',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;return r+=' truncate" href="'+f((i=e&&e.url,typeof i===a?i.apply(e):i))+'">'+f((i=e&&e.name,typeof i===a?i.apply(e):i))+'</a><a class="route icon-gear tooltip" href="settings/'+f((i=e&&e.id,typeof i===a?i.apply(e):i))+'" data-tooltip="Workspace Settings"></a></li>',r}function c(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<ul class="header-popup ph-project-list">\n  ',o=n.each.call(t,t,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='\n  <li class="create-new-project padding icon-add">Create New Workspace</li>\n</ul>',s},n.projectList=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="header-popup ph-notify-list">\n  <ul></ul>\n  <div class="ph-notify-list-empty">No news is good news.</div>\n</div>'},n.notifyList=e.template(t),t=function(e,t,n,r,i){function l(e,t){return" new-item"}function c(e,t){var n="",r;return n+=' <p class="ph-notify-error">'+a((r=e&&e.error,typeof r===u?r.apply(e):r))+"</p> ",n}function h(e,t){var n="",r;return n+=" "+a((r=e&&e.duration,typeof r===u?r.apply(e):r))+" ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<li class="'+a((o=t&&t.klass,typeof o===u?o.apply(t):o)),o=n["if"].call(t,t&&t.isNew,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='" data-id="'+a((o=t&&t.id,typeof o===u?o.apply(t):o))+'">\n  <p>App <a href="/workspace/'+a((o=t&&t.pid,typeof o===u?o.apply(t):o))+"/ops/"+a((o=t&&t.id,typeof o===u?o.apply(t):o))+'" class="route">'+a((o=t&&t.name,typeof o===u?o.apply(t):o))+"</a> "+a((o=t&&t.desc,typeof o===u?o.apply(t):o))+' in workspace <a href="/workspace/'+a((o=t&&t.pid,typeof o===u?o.apply(t):o))+'" class="route">'+a((o=t&&t.pname,typeof o===u?o.apply(t):o))+"</a></p>\n\n  ",o=n["if"].call(t,t&&t.error,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n  <p class="ph-notify-timestamp">'+a((o=t&&t.time,typeof o===u?o.apply(t):o))+" <span>",o=n["if"].call(t,t&&t.duration,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;return s+="</span></p>\n</li>",s},n.notifyListItem=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<ul class="header-popup hp-usermenu">\n  <li><a class="route" href="/cheatsheet">Keyboard Shortcuts</a></li>\n  <li><a href="http://docs.visualops.io" target="_blank">Documentation</a></li>\n  <li><a class="route" href="/settings">Settings</a></li>\n  <li class="logout padding">Log Out</li>\n</ul>\n<div></div>'},n.usermenu=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<section class="new-project-modal" data-bind="true">\n  <label for="new-project-name">'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_NAME",{hash:{},data:i}))+'</label>\n  <input type="text" class="input" id="new-project-name" data-required="true" required>\n  <div class="new-project-billing-wrap">\n    <h4>'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_BILLING",{hash:{},data:i}))+'</h4>\n    <span class="billing-info-tip tooltip icon-password" data-tooltip="'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_CHARGIFY_SUPPORT_TIT",{hash:{},data:i}))+'">'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_CHARGIFY_SUPPORT",{hash:{},data:i}))+'</span>\n    <div class="new-project-info">'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_BILLING_TIP",{hash:{},data:i}))+'</div>\n    <div class="billing-info-err warning-red"></div>\n    <div class="billing-info-item billing-info-item-owner">\n      <label for="new-project-fn">'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_BILLING_OWNER",{hash:{},data:i}))+'</label>\n      <input class="input" id="new-project-fn" type="text" placeholder="'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_FIRST_NAME",{hash:{},data:i}))+'" data-required="true">\n      <input class="input" id="new-project-ln" type="text" placeholder="'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_LAST_NAME",{hash:{},data:i}))+'" data-required="true">\n    </div>\n    <div class="billing-info-item billing-info-item-email">\n      <label for="new-project-email">'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_BILLING_EMAIL",{hash:{},data:i}))+'</label>\n      <input class="input" id="new-project-email" type="text" placeholder="'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_PL_EMAIL",{hash:{},data:i}))+'" data-required="true">\n    </div>\n  </div>\n  <div class="modal-footer">\n    <button class="btn new-project-create btn-blue">'+o(n.i18n.call(t,"LBL_CREATE",{hash:{},data:i}))+'</button>\n    <button class="btn modal-close new-project-cancel btn-silver">'+o(n.i18n.call(t,"LBL_CANCEL",{hash:{},data:i}))+"</button>\n  </div>\n</section>",s},n.newProject=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<section class="update-payment-wrap" data-bind="true">\n    <div class="update-payment-err billing-info-err warning-red"></div>\n    <span class="billing-info-tip tooltip icon-password" data-tooltip="'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_CHARGIFY_SUPPORT_TIT",{hash:{},data:i}))+'">'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_CHARGIFY_SUPPORT",{hash:{},data:i}))+'</span>\n    <div class="billing-info-item billing-info-item-owner">\n      <label for="new-project-fn">'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_BILLING_OWNER",{hash:{},data:i}))+'</label>\n      <input class="input" id="new-project-fn" type="text" placeholder="'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_FIRST_NAME",{hash:{},data:i}))+'" data-required="true">\n      <input class="input" id="new-project-ln" type="text" placeholder="'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_LAST_NAME",{hash:{},data:i}))+'" data-required="true">\n    </div>\n    <div class="billing-info-item billing-info-item-card">\n      <label for="new-project-card">'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_CARD_NAME",{hash:{},data:i}))+'</label>\n      <input class="input" id="new-project-card" type="text" data-required="true" placeholder="'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_PL_CARD_NAME",{hash:{},data:i}))+'">\n    </div>\n    <div class="billing-info-item billing-info-item-cvv">\n      <label for="new-project-cvv">'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_CARD_CVV",{hash:{},data:i}))+'</label>\n      <input class="input" id="new-project-cvv"  type="text" data-required="true">\n    </div>\n    <div class="billing-info-item billing-info-item-date">\n      <label for="new-project-date">'+o(n.i18n.call(t,"SETTINGS_CREATE_PROJECT_EXPRIATION",{hash:{},data:i}))+'</label>\n      <input class="input" id="new-project-date" type="text" placeholder="MM/YYYY" data-required="true">\n    </div>\n    <div class="update-payment-ctrl">\n        <button class="btn btn-blue update-payment-done">'+o(n.i18n.call(t,"LBL_DONE",{hash:{},data:i}))+'</button>\n        <button class="btn btn-silver modal-close update-payment-cancel">'+o(n.i18n.call(t,"LBL_CANCEL",{hash:{},data:i}))+"</button>\n    </div>\n</section>",s},n.updateProject=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<section>\n  <p class="modal-text-major">You have unsaved changes in current workspace. Switching to another workspace will cause your chages to lose.</p>\n  <p class="modal-text-major">Do you confirm to switch project anyway?</p>\n  <div class="modal-footer">\n    <button class="btn do-switch btn-red">Switch and discard changes</button>\n    <button class="btn btn-blue modal-close">Do not switch</button>\n  </div>\n</section>'},n.switchConfirm=e.template(t),n}),define("scenes/userguide/userguideTpl",["handlebars"],function(e){var t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="guide-overlay"></div>\n<img class="guide-logo guide-ui" src="/assets/images/login/logo.svg" />\n<div class="guide-view icon-menu guide-ui"></div>\n<div class="guide-close icon-close guide-ui"></div>\n<div class="guide-video">\n	<div class="guide-video-tip">Tutorial</div>\n	<div class="guide-video-title"></div>\n	<div class="box-loading box-wrapper">\n		<div class="loading-spinner"></div>\n	</div>\n	<video class="guide-video" controls><source type="video/mp4"></video>\n</div>\n<div class="guide-list guide-ui">\n	<!-- <div class="guide-title"><div>VisualOps Guide</div></div> -->\n	<ul class="guide-cards">\n		<li class="guide-card color1" data-src="https://s3.amazonaws.com/visualopsguide/design_your_infrastructure_1.mp4">\n			<div class="head"><i class="guideicon guideicon-drag"></i></div>\n			<div class="info">1<span>m</span></div>\n			<div class="intro">Design Your Infrastructure</div>\n		</li>\n		<span class="guide-head">Workflow</span>\n		<li class="guide-card color2" data-src="https://s3.amazonaws.com/visualopsguide/configure_deploy_app_1.mp4">\n			<div class="head"><i class="guideicon guideicon-config"></i></div>\n			<div class="info">1<span>m</span></div>\n			<div class="intro">Configure & Deploy App</div>\n		</li>\n		<li class="guide-card color3" data-src="https://s3.amazonaws.com/visualopsguide/launch_update_app_1.mp4">\n			<div class="head"><i class="guideicon guideicon-run"></i></div>\n			<div class="info">2<span>m</span></div>\n			<div class="intro">Launch & Update App</div>\n		</li>\n		<li class="guide-card color6" data-src="https://s3.amazonaws.com/visualopsguide/aws_resource_monitor_1.mp4">\n			<div class="head"><i class="guideicon guideicon-eye"></i></div>\n			<div class="info">1<span>m</span></div>\n			<div class="intro">AWS Resource Monitor</div>\n		</li>\n		<li class="guide-card color4" data-src="https://s3.amazonaws.com/visualopsguide/export_image_cloudformation.mp4">\n			<div class="head"><i class="guideicon guideicon-picture-o"></i></div>\n			<div class="info">50<span>s</span></div>\n			<div class="intro">Export Image & CloudFormation</div>\n		</li>\n		<span class="guide-head">Import & Export</span>\n		<li class="guide-card color5" data-src="https://s3.amazonaws.com/visualopsguide/import_from_aws.mp4">\n			<div class="head"><i class="guideicon guideicon-cloud-download"></i></div>\n			<div class="info">58<span>s</span></div>\n			<div class="intro">Import From AWS</div>\n		</li>\n		<li class="guide-card color7" data-src="https://s3.amazonaws.com/visualopsguide/import_cloudformation.mp4">\n			<div class="head"><i class="guideicon guideicon-code"></i></div>\n			<div class="info">23<span>s</span></div>\n			<div class="intro">Import CloudFormation</div>\n		</li>\n		<li class="guide-card color9" data-src="https://s3.amazonaws.com/visualopsguide/aws_resource_manage.mp4">\n			<div class="head"><i class="guideicon guideicon-columns"></i></div>\n			<div class="info">1<span>m</span></div>\n			<div class="intro">AWS Resource Manage</div>\n		</li>\n		<span class="guide-head">Manage</span>\n		<li class="guide-card color8" data-src="https://s3.amazonaws.com/visualopsguide/team_collaboration.mp4">\n			<div class="head"><i class="guideicon guideicon-users"></i></div>\n			<div class="info">1<span>m</span></div>\n			<div class="intro">Team Collaboration</div>\n		</li>\n	</ul>\n</div>'};return e.template(t)}),define("scenes/userguide/userguide",["constant","i18n!/nls/lang.js","./userguideTpl","backbone"],function(e,t,n){return Backbone.View.extend({className:"user-guide",tagName:"section",initialize:function(){return this.render()},events:{"click .guide-card":"playVideo","click .guide-video":"closeVideo","click .guide-close":"closeGuide","click .guide-view":"switchView","mousewheel .guide-list":"scrollHorizontally"},render:function(){var e,t;return e=this,this.$el.html(n()),$("body").append(this.$el),t=this.$el.find(".guide-video video")[0],t.addEventListener("ended",function(){return e.closeVideo()}),t.addEventListener("loadeddata",function(){return e.$el.find(".box-loading").hide()}),this.$el.fadeIn()},playVideo:function(e){var t,n,r;return this.$el.find(".guide-ui").hide(),t=$(e.currentTarget),r=t.data("src"),this.$el.find(".guide-video source").attr("src",r),this.$el.find(".guide-video .guide-video-title").text(t.find(".intro").text()),this.$el.find(".guide-video").fadeIn(),n=this.$el.find(".guide-video video")[0],n.height=$(document).height(),this.$el.find(".box-loading").show(),n.load(),n.play(),this.$el.find(".guide-card").removeClass("active"),t.addClass("active")},closeVideo:function(){var e;return this.$el.find(".guide-ui").show(),this.$el.find(".guide-video").fadeOut(),e=this.$el.find(".guide-video video")[0],e.pause(),e.currentTime=0},closeGuide:function(){var e;e=this,this.$el.fadeOut("normal",function(){return e.remove()})},switchView:function(e){var t;return t=$(e.currentTarget),t.hasClass("icon-menu")?(t.removeClass("icon-menu").addClass("icon-resources"),this.$el.find(".guide-cards").addClass("cube")):(t.removeClass("icon-resources").addClass("icon-menu"),this.$el.find(".guide-cards").removeClass("cube"))},scrollHorizontally:function(e){var t;return t=Math.max(-1,Math.min(1,e.originalEvent.wheelDelta||-e.originalEvent.detail)),e.currentTarget.scrollLeft-=t*100}})}),define("scenes/ProjectView",["ApiRequest","./ProjectTpl","OpsModel","UI.modalplus","./userguide/userguide","i18n!/nls/lang.js","constant","backbone","jquerysort","UI.parsley","UI.errortip","MC.validate"],function(e,t,n,r,i,s,o){var u,a,f,l,c,h;return l=Backbone.View.extend({events:{"click .new-project-cancel":"cancel","click .new-project-create":"create"},initialize:function(){this.modal=new r({template:t.newProject(),title:s.IDE.SETTINGS_CREATE_PROJECT_TITLE,disableClose:!0,disableFooter:!0,width:"500px"}),this.setElement(this.modal.tpl)},cancel:function(){return this.modal.close()},create:function(){var e,t,n,r,i,s,o;s=this.modal,s.tpl.find(".billing-info-err").hide(),e=s.tpl.find(".new-project-create"),i=s.tpl.find("#new-project-name"),n=s.tpl.find("#new-project-fn"),r=s.tpl.find("#new-project-ln"),t=s.tpl.find("#new-project-email"),o=!0,s.tpl.find("input").each(function(e,t){if(!$(t).parsley("validate"))return o=!1,!1});if(o)return e.prop("disabled",!0),App.model.createProject({name:i.val(),firstname:n.val(),lastname:r.val(),email:t.val(),card:null}).then(function(e){return s.close(function(){return App.loadUrl(e.url())})}).fail(function(e){var t,n;try{n=JSON.parse(e.result),_.isArray(n.errors)&&s.tpl.find(".billing-info-err").show().html(n.errors.join("<br/>"))}catch(r){t=r,notification("error",e.result||e.msg)}}).done(function(){return e.prop("disabled",!1)})}}),a=Backbone.View.extend({constructor:function(e){var t,n;for(t in e)n=e[t],this[t]=n;this.setElement($("<div class='hp-popup-overlay'></div>").appendTo("body").on("click",function(e){return function(t){return e.closeOnClick(t)}}(this))),this.render(),Backbone.View.call(this)},closeOnEvent:function(){return!0},closeOnClick:function(e){if(e.target===this.el||this.closeOnEvent&&this.closeOnEvent(e))return this.close()},close:function(){this.remove(),this.onClose&&this.onClose(this)}}),h=a.extend({events:{"click .logout":"logout"},render:function(){return this.$el.html(t.usermenu())},logout:function(){return App.logout()}}),u=a.extend({events:{"click .off-canvas-tab":"switchTab"},initialize:function(){this.listenTo(this.project,"change:stack",this.render),this.listenTo(this.project,"change:app",this.render),this.listenTo(this.project,"update:stack",this.render),this.listenTo(this.project,"update:app",this.render)},closeOnEvent:function(e){return $(e.target).hasClass("route")},switchTab:function(e){var t,n;t=$(e.currentTarget),t.parent().children().removeClass("selected"),t.addClass("selected"),n=t.attr("data-id"),this.$el.find(".ph-asset-list-wrap").children().hide().filter("[data-id='"+n+"']").show(),this.showApp=n==="app"},render:function(){var e,n,r;return n=function(e){return e.data=_.filter(e.data,function(e){var t;return(t=e.provider)==="aws::global"||t==="aws::china"||t==="os::awcloud_bj"}),e},e=_.map(this.project.apps().groupByRegion(),n),r=_.map(this.project.stacks().groupByRegion(),n),this.$el.html(t.assetList({apps:e,stacks:r,showApp:this.showApp}))}}),c=a.extend({render:function(){var e,n,r,i,s;n=[],s=App.model.projects().models;for(r=0,i=s.length;r<i;r++)e=s[r],n.push({id:e.id,url:e.url(),name:e.get("name"),selected:e===this.project,"private":e.isPrivate()});return this.$el.html(t.projectList(n)),this.$el.find(".create-new-project").on("click",_.bind(this.createProject,this)),this},createProject:function(){return new l}}),f=a.extend({initialize:function(){return this.listenTo(App.model.notifications(),"change",this.renderPiece),this.listenTo(App.model.notifications(),"add",this.renderPiece)},pieceTpl:function(e){var n,r,i;return i=e.target(),r=e.targetProject(),n=e.get("duration"),n&&(n<60?n=sprintf(s.TOOLBAR.TOOK_XXX_SEC,n):n=sprintf(s.TOOLBAR.TOOK_XXX_MIN,Math.round(n/60))),t.notifyListItem({name:i.get("name"),id:i.id,pname:r.get("name"),pid:r.id,time:MC.dateFormat(new Date(e.get("startTime")*1e3),"hh:mm yyyy-MM-dd"),duration:n,error:e.get("error"),desc:this.getNotifyDesc(e),isNew:e.isNew(),klass:["processing","success","failure","rollingback"][e.get("state")]})},renderPiece:function(e){var t,n;if(!e){this.render();return}n=this.$el.find("ul"),t=n.children("[data-id='"+e.id+"']"),t.length?t.after(this.pieceTpl(e)).remove():n.prepend(this.pieceTpl(e))},render:function(){var e,n,r,i,s;n="",s=App.model.notifications().models;for(r=0,i=s.length;r<i;r++)e=s[r],n+=this.pieceTpl(e);this.$el.html(t.notifyList()),n&&this.$el.find("ul").html(n)},getNotifyDesc:function(e){var t;switch(e.get("action")){case o.OPS_CODE_NAME.LAUNCH:t=["is launching","launched successfully","failed to launch","is rolling back"];break;case o.OPS_CODE_NAME.STOP:t=["is stopping","stopped successfully","failed to stop","is rolling back"];break;case o.OPS_CODE_NAME.START:t=["is starting","started successfully","failed to start","is rolling back"];break;case o.OPS_CODE_NAME.TERMINATE:t=["is terminating","terminated successfully","failed to terminate","is rolling back"];break;case o.OPS_CODE_NAME.UPDATE:case o.OPS_CODE_NAME.STATE_UPDATE:t=["is updating","updated successfully","failed to update","is rolling back"]}return t[e.get("state")]},close:function(){return this.stopListening(),App.model.notifications().markAllAsRead(),a.prototype.close.call(this)}}),Backbone.View.extend({initialize:function(e){var n,r,i;this.scene=e.scene,this.tabsWidth=0,this.setElement($(t.frame(e)).appendTo("#scenes")),this.render(),this.$tabbar=this.$el.find(".ws-tabbar"),this.$wsparent=this.$el.find(".ws-content"),i=this,this.$el.find(".ws-tabs").dragsort({horizontal:!0,dragSelectorExclude:".fixed, .icon-close",dragEnd:function(){return i.updateTabOrder()}}),n=this.$header=this.$el.find(".project-header"),n.on("click",".ws-tabbar li",function(e){return i.onTabClick(e)}),n.on("click",".ws-tabbar .icon-close",function(e){return i.onTabClose(e)}),n.on("click",".popuptrigger",function(e){return i[$(e.currentTarget).attr("data-popup")](e.currentTarget)}),n.on("click",".icon-support",function(){if(window.Intercom)return window.Intercom("showNewMessage"),!1}),r=App.model.notifications(),this.listenTo(r,"change",this.updateNotify),this.listenTo(r,"add",this.updateNotify),this.listenTo(r,"remove",this.updateNotify),this.updateNotify(),this.listenTo(this.scene,"switchWorkspace",this.updateNotify)},render:function(){var e,t,n;this.$el.find(".project-list").text(this.scene.project.get("name")),n=App.user.get("username"),e=App.user.get("email"),t="<span class='tip-for-username'>"+n+"</span> <br/> <span class='tip-for-email'>"+e+"<span/>",this.$el.find(".user-menu").text(App.user.get("username")).attr("data-tooltip",t)},showPopup:function(e,t){var n,r;return n=$("<div class='hp-popup-overlay'>"+e+"</div>").appendTo("body"),r=function(e){if(t&&t(e.target))return;return void 0,$("body")[0].removeEventListener("click",r,!0),n.remove()},$("body")[0].addEventListener("click",r,!0),n},popupProject:function(){return new c({project:this.scene.project})},popupAsset:function(){return new u({project:this.scene.project})},popupUser:function(){return new h},popupNotify:function(){return new f},popupGuide:function(){return new i},updateNotify:function(){var e,t,n,r,i,s,o;r=App.model.notifications().where({isNew:!0}),i=this.scene.getAwakeSpace(),e={opsModel:null};for(t=s=0,o=r.length;s<o;t=++s){n=r[t],e.opsModel=n.target();if(i&&i.isWorkingOn(e)){n.markAsRead(),r.splice(t,1);break}}this.$header.find(".icon-notification").attr("data-count",r.length||"")},getTabElementById:function(e){return this.$tabbar.find("[data-id='"+e+"']")},updateTabOrder:function(){return this.trigger("wsOrderChanged")},spaceOrder:function(){return _.map(this.$tabbar.find("li"),function(e){return $(e).attr("data-id")})},moveSpace:function(e,t,n){var r,i,s;s=this.getTabElementById(e);if(!s.length)return;t?i=this.$tabbar.children(".ws-fixed-tabs"):(i=this.$tabbar.children(".ws-tabs"),n-=this.$tabbar.children().length),r=i.children().eq(n),r.length?s.insertBefore(r):i.append(s)},awakeSpace:function(e){this.$tabbar.find(".active").removeClass("active"),this.getTabElementById(e).addClass("active")},updateSpace:function(e,t,n){var r;r=this.getTabElementById(e);if(t!==void 0||t!==null)this.tabsWidth-=r.outerWidth(),r.attr("title",t),r.children("span").text(t),this.tabsWidth+=r.outerWidth(),this.ensureTabSize();if(n!==void 0||n!==null)r.hasClass("active")&&(n+=" active"),r.attr("class",n)},onTabClick:function(e){this.trigger("wsClicked",$(e.currentTarget).attr("data-id"))},onTabClose:function(e){return this.trigger("wsClosed",$(e.currentTarget).closest("li").attr("data-id")),!1},removeSpace:function(e){var t;return t=this.getTabElementById(e),this.tabsWidth-=t.outerWidth(),t.remove(),this.ensureTabSize(),t},showLoading:function(){return $("#GlobalLoading").show()},hideLoading:function(){return $("#GlobalLoading").hide()},ensureTabSize:function(){var e,t,n,r;n=this.$tabbar.children(".ws-tabs"),r=$(window).width(),e=r-n.offset().left-this.$tabbar.siblings("nav").width(),t=n.children(),this.tabsWidth<e?t.css("max-width","auto"):(e=Math.floor(e/t.length),t.css("max-width",e))},addSpace:function(e,t,n){var r,i,o;return t==null&&(t=-1),n==null&&(n=!1),n?r=this.$tabbar.children(".ws-fixed-tabs"):r=this.$tabbar.children(".ws-tabs"),o="<li class='"+e.klass+"' data-id='"+e.id+"' title='"+e.title+"'><span class='truncate'>"+e.title+"</span>",e.closable&&(o+='<i class="icon-close" title="'+s.TOOLBAR.TIT_CLOSE_TAB+'"></i>'),i=r.children().eq(t),i.length?i=$(o+"</li>").insertAfter(i):i=$(o+"</li>").appendTo(r),this.tabsWidth+=i.outerWidth(),this.ensureTabSize(),i}})}),define("Workspace",["backbone"],function(){var e,t,n;return n=0,e={},t=Backbone.Model.extend({constructor:function(e,t){void 0,this.scene=t.scene,Backbone.Model.apply(this,arguments),this.set("id","space_"+ ++n),this.scene.addSpace(this)},isAwake:function(){return this.scene.getAwakeSpace()===this},setIndex:function(e){return this.scene.moveSpace(this,e)},index:function(){return this.scene.spaces().indexOf(this)},isRemoved:function(){return!!this.__isRemoved},remove:function(){return this.scene.removeSpace(this,!0)},updateUrl:function(){return this.scene.updateSpace(this)},updateTab:function(){return this.scene.updateSpace(this)},activate:function(){return this.scene.awakeSpace(this)},initialize:function(e){},isFixed:function(){return!1},isModified:function(){return!1},tabClass:function(){return""},title:function(){return""},awake:function(){if(this.view)return this.view.$el.show()},sleep:function(){$(document.activeElement).filter("input, textarea").blur();if(this.view)return this.view.$el.hide()},cleanup:function(){this.view?this.view.remove():void 0},isRemovable:function(){return!0},isWorkingOn:function(e){return!1}},{findSuitableSpace:function(t){var n,r,i;r=null;for(i in e)n=e[i],n.canHandle(t)&&(void 0,r=n);return r},canHandle:function(e){return!1},extend:function(t,n){var r;return r=(window.__detailExtend||Backbone.Model.extend).call(this,t,n),e[t.type]=r,r}}),t});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("scenes/ProjectScene",["Scene","./ProjectView","./ProjectTpl","Workspace","UI.modalplus","i18n!/nls/lang.js","UI.notification"],function(e,t,n,r,i,s){var o,u,a;return a=Backbone.View.extend({events:{"click .do-switch":"switch"},initialize:function(e){return this.toOpenProject=e.project,this.toOpenOpsModel=e.opsmodel,this.modal=new i({template:n.switchConfirm(),title:s.IDE.SWITCH_WORKSPACE_UNSAVED_CHANGES,disableClose:!0,disableFooter:!0,width:"500px"}),this.setElement(this.modal.tpl)},"switch":function(){(new u(this.toOpenProject,this.toOpenOpsModel,{slient:!0})).activate(),this.modal.close()}}),o=!0,u=function(n){function i(t,n,r){var i,s,o,u,f,l,c;o=App.sceneManager.find(t);if(o)return o.activate(),o.loadSpace(n),o;r=r||{};if(!r.slient&&_.some(App.sceneManager.scenes(),function(e){return e.type==="ProjectScene"&&!e.isRemovable()})){App.sceneManager.activeScene().updateUrl(),new a({project:t,opsmodel:n});return}s=App.sceneManager.scenes().filter(function(e){return e.type==="ProjectScene"});for(u=0,l=s.length;u<l;u++)i=s[u],i.removeNotFixedSpaces();e.call(this,{pid:t,opsid:n});for(f=0,c=s.length;f<c;f++)i=s[f],i.remove();return this}return __extends(i,n),i.prototype.type="ProjectScene",i.prototype.initialize=function(e){var n;n=this,this.__spaces=[],this.__awakeSpace=null,this.__spacesById={};if(o){o=!1;if(!e.pid||!App.model.projects().get(e.pid))e.pid=localStorage.getItem("lastws")}this.project=App.model.projects().get(e.pid)||App.model.getPrivateProject(),this.view=new t({scene:this,observer:this.project.amIObserver()}),this.listenTo(this.view,"wsOrderChanged",function(){return this.__updateSpaceOrder()}),this.listenTo(this.view,"wsClicked",function(e){return this.awakeSpace(e)}),this.listenTo(this.view,"wsClosed",function(e){return this.removeSpace(e)}),this.listenTo(this.project,"destroy",this.onProjectDestroy),this.activate(),n.loadDashboard(),n.loadSpace(e.opsid)},i.prototype.becomeActive=function(){return this.view.$el.show(),this.updateUrl(),this.updateTitle(),localStorage.setItem("lastws",this.project.id)},i.prototype.isRemovable=function(){return _.all(this.__spaces,function(e){return!e.isModified()})},i.prototype.becomeInactive=function(){return e.prototype.becomeInactive.call(this)},i.prototype.cleanup=function(){return e.prototype.cleanup.call(this)},i.prototype.isWorkingOn=function(e){return this.project.id===e},i.prototype.title=function(){var e;return e=this.project.get("name"),this.getAwakeSpace()&&(e=this.getAwakeSpace().title()+" on "+e),e},i.prototype.url=function(){var e;return e=this.project.url()+"/",this.getAwakeSpace()&&(e+=this.getAwakeSpace().url()),e.replace(/\/+$/,"")},i.prototype.onProjectDestroy=function(e,t,n){n.manualAction||notification("error",sprintf(s.NOTIFY.INFO_PROJECT_REMOVED,e.get("name"))),this.remove()},i.prototype.loadSpace=function(e){var t,n;if(!e)return this.loadDashboard();t={opsModel:_.isString(e)?this.project.getOpsModel(e):e};if(!t.opsModel)return;(n=this.createSpace(t))!=null&&n.activate()},i.prototype.loadDashboard=function(){return void 0,this.createSpace({type:"Dashboard"}).activate()},i.prototype.createSpace=function(e){var t,n;return n=this.findSpace(e),n?n:(t=r.findSuitableSpace(e),t?new t(e,{scene:this}):(void 0,null))},i.prototype.spaceParentElement=function(){return this.view.$wsparent},i.prototype.__updateSpaceOrder=function(){var e;e=this.__spacesById,this.__spaces=this.view.spaceOrder().map(function(t){return e[t]})},i.prototype.updateSpace=function(e){return e===this.__awakeSpace&&(this.updateUrl(),this.updateTitle()),this.view.updateSpace(e.id,e.title(),e.tabClass()),e},i.prototype.spaces=function(){return this.__spaces.slice(0)},i.prototype.getAwakeSpace=function(){return this.__awakeSpace},i.prototype.getSpace=function(e){return this.__spacesById[e]},i.prototype.findSpace=function(e){return _.find(this.__spaces,function(t){return t.isWorkingOn(e)})},i.prototype.moveSpace=function(e,t){this.view.moveSpace(e.id,e.isFixed(),t),this.__updateSpaceOrder()},i.prototype.addSpace=function(e){if(this.__spacesById[e.id])return;return this.__spacesById[e.id]=e,this.view.addSpace({title:e.title(),id:e.id,closable:!e.isFixed(),klass:e.tabClass()},-1,e.isFixed()),this.__updateSpaceOrder(),this.__spaces.length===1&&this.awakeSpace(e),e},i.prototype.awakeSpace=function(e){var t;if(!e)return;_.isString(e)&&(e=this.__spacesById[e]);if(this.__awakeSpace===e)return;if(e.isRemoved())return;this.__awakeSpace&&this.__awakeSpace.sleep(),this.__awakeSpace=e,this.updateTitle(),this.updateUrl(),this.view.awakeSpace(e.id),t=e.awake(),t&&t.then&&t.isFulfilled&&!t.isFulfilled()?(t.then(function(e){return function(){return e.view.hideLoading()}}(this)),this.view.showLoading()):this.view.hideLoading(),this.trigger("switchWorkspace",e)},i.prototype.removeSpace=function(e,t){var n;if(!e)return;_.isString(e)&&(e=this.__spacesById[e]);if(!t&&!e.isRemovable())return;if(e.__isRemoved)return;return e.__isRemoved=!0,n=e.id,this.view.removeSpace(n),delete this.__spacesById[n],this.__spaces.splice(this.__spaces.indexOf(e),1),e.stopListening(),e.cleanup(),this.__awakeSpace===e&&(this.__awakeSpace=null,this.awakeSpace(this.__spaces[this.__spaces.length-1])),e},i.prototype.removeAllSpaces=function(){var e,t,n,r;r=this.spaces();for(t=0,n=r.length;t<n;t++)e=r[t],this.removeSpace(e,!0)},i.prototype.removeNotFixedSpaces=function(e){var t,n,r,i;i=this.spaces();for(n=0,r=i.length;n<r;n++)t=i[n],!t.isFixed()&&(!e||e(t))&&this.removeSpace(t,!0)},i}(e),e.SetDefaultScene(u),u}),define("scenes/settings/template/TplProject",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\r\n        <a data-id="billing">'+u(n.i18n.call(e,"PAYMENT_BILLING_TAB",{hash:{},data:t}))+'</a>\r\n        <a data-id="credential">'+u(n.i18n.call(e,"PROVIDER_CREDENTIAL",{hash:{},data:t}))+"</a>\r\n        ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<nav id="settings-nav">\r\n    <a class="back-settings">&lt; '+u(n.i18n.call(t,"HEAD_BTN_BACK",{hash:{},data:i}))+'</a>\r\n    <section class="function-list">\r\n        <header class="settings-nav-project-title truncate">'+u((o=t&&t.name,typeof o===a?o.apply(t):o))+'</header>\r\n        <a data-id="basicsettings">'+u(n.i18n.call(t,"BASIC_SETTINGS",{hash:{},data:i}))+'</a>\r\n        <a data-id="team">'+u(n.i18n.call(t,"TEAM",{hash:{},data:i}))+'</a>\r\n        <a data-id="usagereport">'+u(n.i18n.call(t,"USAGE_REPORT",{hash:{},data:i}))+"</a>\r\n        ",o=n["if"].call(t,t&&t.admin,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='\r\n        <a data-id="accesstoken">'+u(n.i18n.call(t,"SETTINGS_LABEL_ACCESSTOKEN",{hash:{},data:i}))+'</a>\r\n    </section>\r\n</nav>\r\n<section class="setting-content">\r\n    <header class="project-title">\r\n        <span id="title-project-name" class="truncate"></span>\r\n        <span id="title-tab-name"></span>\r\n    </header>\r\n    <article class="project-subview"></article>\r\n</section>',s};return e.template(t)}),define("scenes/settings/template/TplBasicSettings",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){var r;return r=n.unless.call(e,e&&e["private"],{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t}),r||r===0?r:""}function c(e,t){return'<button class="icon-edit edit-button"></button>'}function h(e,t){var r="";return r+='\n<dl class="settings-item project-item">\n    <dt>'+a(n.i18n.call(e,"DELETE_WORKSPACE",{hash:{},data:t}))+'</dt>\n    <dd class="delete-project-zone">\n    </dd>\n</dl>\n',r}function p(e,t){var r="";return r+='\n<dl class="settings-item project-item">\n    <dt>'+a(n.i18n.call(e,"LEAVE_WORKSPACE",{hash:{},data:t}))+'</dt>\n    <dd class="leave-project-zone">\n    </dd>\n</dl>\n',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a=this.escapeExpression,f="function";s+='<dl class="settings-item project-name-zone project-item">\n    <dt>'+a(n.i18n.call(t,"WORKSPACE_NAME",{hash:{},data:i}))+'</dt>\n    <dd>\n        <div class="normal-mode">\n            <span class="project-name">'+a((o=t&&t.name,typeof o===f?o.apply(t):o))+'</span>\n        </div>\n        <div class="edit-mode">\n            <input type="text" class="input" id="project-name" value="'+a((o=t&&t.name,typeof o===f?o.apply(t):o))+'">\n            <div class="edit-actions">\n                <button class="btn btn-blue" id="update-name">'+a(n.i18n.call(t,"SETTINGS_LABEL_ACCOUNT_UPDATE",{hash:{},data:i}))+'</button>\n                <a class="cancel-button">'+a(n.i18n.call(t,"SETTINGS_LABEL_ACCOUNT_CANCEL",{hash:{},data:i}))+'</a>\n            </div>\n            <div class="loading-spinner loading-spinner-small" style="display: none;"></div>\n        </div>\n        ',o=n["if"].call(t,t&&t.isAdmin,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n    </dd>\n</dl>\n\n",o=n["if"].call(t,t&&t.isAdmin,{hash:{},inverse:u.noop,fn:u.program(4,h,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n.unless.call(t,t&&t["private"],{hash:{},inverse:u.noop,fn:u.program(6,p,i),data:i});if(o||o===0)s+=o;return s},n.basicSettings=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+="<p>"+o(n.i18n.call(t,"THIS_ACTION_CANNOT_BE_REVERTED",{hash:{},data:i}))+"</p><p>"+o(n.i18n.call(t,"TYPE_THE_WORKSPACE_NAME_TO_CONFIRM",{hash:{},data:i}))+'</p>\n<div class="confirm-action">\n    <input type="text" class="input" id="confirm-project-name"/>\n    <button class="btn btn-red" id="do-delete-project" disabled>'+o(n.i18n.call(t,"CONFIRM_TO_DELETE",{hash:{},data:i}))+'</button>\n    <a class="cancel-delete-confirm">Cancel</a>\n</div>',s},n.confirmToDelete=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+="<p>"+o(n.i18n.call(t,"THIS_ACTION_CANNOT_BE_REVERTED",{hash:{},data:i}))+"</p><p>"+o(n.i18n.call(t,"ARE_YOU_SURE_YOU_WANT_TO_LEAVE_THIS_WORKSPACE",{hash:{},data:i}))+'</p>\n<div class="confirm-action">\n    <button class="btn btn-red" id="do-leave-project">'+o(n.i18n.call(t,"CONFIRM_TO_LEAVE",{hash:{},data:i}))+'</button>\n    <a class="cancel-leave-confirm">Cancel</a>\n</div>',s},n.confirmToLeave=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="loading-spinner"></div>'},n.loading=e.template(t),t=function(e,t,n,r,i){function a(e,t){var r="";return r+="\n<p>"+o(n.i18n.call(e,"FREE_WORKSPACE_CAN_NOT_DELETE",{hash:{},data:t}))+"</p>\n",r}function f(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,e&&e.failedToPay,{hash:{},inverse:u.program(6,c,t),fn:u.program(4,l,t),data:t});if(i||i===0)r+=i;r+='\n    <button class="btn btn-red icon-delete" id="delete-project" ',i=n["if"].call(e,e&&e.failedToPay,{hash:{},inverse:u.noop,fn:u.program(8,h,t),data:t});if(i||i===0)r+=i;return r+=">"+o(n.i18n.call(e,"DELETE_WORKSPACE",{hash:{},data:t}))+"</button>\n\n",r}function l(e,t){var r="";return r+='\n        <div class="cannot-delete">'+o(n.i18n.call(e,"CANT_DELETE_WORKSPACE",{hash:{},data:t}))+"</div>\n        ",r}function c(e,t){var r="";return r+="\n            <p>"+o(n.i18n.call(e,"DELETE_WORKSPACE_WILL_FORGOT_APPS",{hash:{},data:t}))+"</p>\n            <p>"+o(n.i18n.call(e,"IMPORT_JSON_BEFORE_DELETE_WORKSPACE",{hash:{},data:t}))+"</p>\n    ",r}function h(e,t){return'disabled="disabled"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u=this;return s=n["if"].call(t,t&&t["private"],{hash:{},inverse:u.program(3,f,i),fn:u.program(1,a,i),data:i}),s||s===0?s:""},n.delete=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+="<p>"+o(n.i18n.call(t,"LEAVING_WORKSPACE_WILL_NOT_ACCESS",{hash:{},data:i}))+'</p>\n<button class="btn btn-red icon-delete" id="leave-project">'+o(n.i18n.call(t,"LEAVE_WORKSPACE",{hash:{},data:i}))+'</button>\n<!-- <div class="level-error-tip hide">'+o(n.i18n.call(t,"LEAVING_WORKSPACE_WILL_ONLY_ONE_ADMIN",{hash:{},data:i}))+"</div> -->",s},n.leave=e.template(t),n}),define("scenes/settings/models/MemberCollection",["ApiRequest","backbone","crypto"],function(e){var t,n;return n=Backbone.Model.extend({defaults:{id:"",avatar:"",username:"",email:"",role:"",state:"",me:!1,_username:"",_email:"",projectId:""},updateRole:function(t){var n;return n=this,e("project_update_role",{project_id:this.get("projectId"),member_email:this.get("email"),new_role:t}).then(function(){return n.set("role",t)})},cancelInvite:function(){var t;return t=this,e("project_cancel_invitation",{project_id:this.get("projectId"),member_email:this.get("email")}).then(function(){var e;return(e=t.collection)!=null?e.remove(t):void 0})},isAdmin:function(){return this.get("role")==="admin"},isOnlyAdmin:function(){var e,t,n;return n=this,t=n.collection.toJSON(),e=[],_.each(t,function(t){return t.role==="admin"&&t.state==="normal"&&e.push(t.username),null}),e.length===1&&e[0]===this.get("username")?!0:!1}}),t=Backbone.Collection.extend({constructor:function(e){Backbone.Collection.apply(this),this.projectId=e.projectId},model:n,projectId:"",limit:10,fetch:function(){var t;return t=this,e("project_list_member",{project_id:t.projectId}).then(function(e){var n,r;return t.limit=e[0],n=e[1],r=_.map(n,function(e){var n,r,i,s;return s=Base64.decode(e.username||""),r=App.user.get("username"),i=Base64.decode(e.email),n=CryptoJS.MD5(i.trim().toLowerCase()).toString(),new t.model({id:e.id||"fake-"+Math.round(Math.random()*1e5),avatar:"https://www.gravatar.com/avatar/"+n,username:s,email:i,role:e.role,state:e.state,me:s===r,_username:e.username,_email:e.email,projectId:t.projectId})}),t.reset(r)})},removeMember:function(t){var n;return n=this,e("project_remove_members",{project_id:this.projectId,member_ids:t}).then(function(){return n.remove(t)})},inviteMember:function(t){var n;return n=this,e("project_invite",{project_id:this.projectId,member_email:t,member_role:"collaborator"}).then(function(){return n.push(new n.model)})},getCurrentMember:function(){return this.findWhere({username:App.user.get("username")})},isLimitInvite:function(){return this.models.length>=this.limit}}),t}),define("scenes/settings/views/BasicSettingsView",["i18n!/nls/lang.js","../template/TplBasicSettings","UI.modalplus","../models/MemberCollection","UI.notification","backbone"],function(e,t,n,r){return Backbone.View.extend({events:{"click .edit-button":"edit","click .cancel-button":"cancelEdit","click #update-name":"updateName","click #delete-project":"confirmDelete","click #leave-project":"confirmLeave","keyup #project-name":"checkName","keyup #confirm-project-name":"confirmProjectName","paste #confirm-project-name":"deferConfirmProjectName","click #do-delete-project":"doDelete","click #do-leave-project":"doLeave","click .cancel-leave-confirm":"cancelLeaveConfirm","click .cancel-delete-confirm":"cancelDeleteConfirm"},className:"basic-settings",initialize:function(e){return _.extend(this,e),this.memberCol=new r({projectId:this.model.id}),this.listenTo(this.model,"change:name",this.changeNameOnView)},getRenderData:function(){var e;return e=this.model.toJSON(),e.isAdmin=this.model.amIAdmin(),e.isMember=this.model.amIMeber(),e.isObserver=this.model.amIObserver(),e.failedToPay=this.model.shouldPay(),e},render:function(){var e;return e=this.getRenderData(),this.$el.html(t.basicSettings(e)),this.renderLeaveZone(e),e.isAdmin&&this.renderDeleteZone(e),this},renderLeaveZone:function(e,n){var r;return e==null&&(e=this.getRenderData()),n==null&&(n=!1),n?r=t.confirmToLeave:r=t.leave,this.$(".leave-project-zone").html(r(e)),this},renderDeleteZone:function(e,n){var r;return e==null&&(e=this.getRenderData()),n==null&&(n=!1),n?r=t.confirmToDelete:r=t["delete"],this.$(".delete-project-zone").html(r(e)),this},renderLoading:function(){return this.$el.html(t.loading)},deferConfirmProjectName:function(e){return _.defer(_.bind(this.confirmProjectName,this,e))},confirmProjectName:function(e){return e.currentTarget.value===this.model.get("name")?this.$("#do-delete-project").prop("disabled",!1):this.$("#do-delete-project").prop("disabled",!0)},edit:function(e){return $(e.currentTarget).closest(".project-item").addClass("edit")},cancelEdit:function(e){return $(e.currentTarget).closest(".project-item").removeClass("edit")},checkName:function(e){var t;return t=this.$("#update-name"),e.currentTarget.value.length>0?t.prop("disabled",!1):t.prop("disabled",!0)},updateName:function(t){var n,r;return r=this,n=this.$("#project-name").val(),this.updateNameLoading(t),this.model.updateName(n).then(function(){return r.updateNameLoading(t,!0),r.cancelEdit(t)},function(){return r.updateNameLoading(t,!0),notification("error",e.IDE.SETTINGS_ERR_PROJECT_RENAME)})},changeNameOnView:function(){return this.$(".project-name").text(this.model.get("name"))},updateNameLoading:function(e,t){var n,r,i;return t==null&&(t=!1),i=$(e.currentTarget).closest(".project-item"),n=i.find(".edit-actions"),r=i.find(".loading-spinner"),n.toggle(t),r.toggle(!t)},doDelete:function(){var t;return t=this,this.renderLoading(),this.model.destroy().then(function(){return t.remove(),t.settingsView.modal.close()},function(n){return n.error===134?notification("error",e.NOTIFY.HAVE_ONGOINGREQUEST_DELETE_WORKSPACE):notification("error",e.NOTIFY.SETTINGS_ERR_PROJECT_REMOVE),t.render()})},doLeave:function(){var t;return t=this,t.renderLoading(),t.model.amIAdmin()?t.memberCol.fetch().then(function(){var n;return n=t.memberCol.getCurrentMember(),n.isAdmin()?n.isOnlyAdmin()?(t.render(),notification("error",e.IDE.LEAVING_WORKSPACE_WILL_ONLY_ONE_ADMIN)):t.toLeave():t.toLeave()}).fail(function(e){return t.render(),notification("error",e.result||e.msg)}):t.toLeave()},toLeave:function(){var t;return t=this,t.model.leave().then(function(){return t.remove(),t.settingsView.modal.close()},function(){return t.render(),notification("error",e.IDE.SETTINGS_ERR_PROJECT_LEAVE)})},confirmLeave:function(){return this.renderLeaveZone(null,!0)},cancelLeaveConfirm:function(){return this.renderLeaveZone()},confirmDelete:function(){return this.renderDeleteZone(null,!0)},cancelDeleteConfirm:function(){return this.renderDeleteZone()}})}),define("scenes/settings/template/TplAccessToken",["handlebars"],function(e){var t=function(e,t,n,r,i){function f(e,t){var r="";return r+='<button class="btn btn-blue right" id="TokenCreate">'+u(n.i18n.call(e,"SETTINGS_BTN_TOKEN_CREATE",{hash:{},data:t}))+"</button>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this;s+='<section>\r\n    <div id="TokenManager">\r\n        <p class="clearfix">\r\n            ',o=n["if"].call(t,t&&t.isAdmin,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;return s+="\r\n            "+u(n.i18n.call(t,"SETTINGS_INFO_TOKEN",{hash:{},data:i}))+'<a href="http://docs.visualops.io/app_management/reload_states.html" target="_blank">'+u(n.i18n.call(t,"SETTINGS_INFO_TOKEN_LINK",{hash:{},data:i}))+'</a> </p>\r\n        <section class="token-table">\r\n            <header class="clearfix">\r\n                <span class="tokenName">'+u(n.i18n.call(t,"SETTINGS_LABEL_TOKENTABLE_NAME",{hash:{},data:i}))+'</span>\r\n                <span class="tokenToken">'+u(n.i18n.call(t,"SETTINGS_LABEL_TOKENTABLE_TOKEN",{hash:{},data:i}))+'</span>\r\n            </header>\r\n            <div class="scroll-wrap">\r\n                <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\r\n                <ul id="TokenList" class="scroll-content" data-empty="'+u(n.i18n.call(t,"SETTINGS_INFO_TOKEN_EMPTY",{hash:{},data:i}))+'"></ul>\r\n            </div>\r\n        </section>\r\n    </div>\r\n    <div id="TokenRmConfirm" class="hide">\r\n        <h3 id="TokenRmTit"></h3>\r\n        <p>'+u(n.i18n.call(t,"SETTINGS_CONFIRM_TOKEN_RM",{hash:{},data:i}))+'</p>\r\n        <div class="cred-btn-wrap clearfix">\r\n            <button class="right btn btn-modal-close btn-silver" id="TokenRmCancel">'+u(n.i18n.call(t,"SETTINGS_LABEL_ACCOUNT_CANCEL",{hash:{},data:i}))+'</button>\r\n            <button id="TokenRemove" class="btn btn-red right">'+u(n.i18n.call(t,"SETTINGS_BTN_TOKEN_REMOVE",{hash:{},data:i}))+"</button>\r\n        </div>\r\n    </div>\r\n\r\n</section>",s};return e.template(t)}),define("scenes/settings/views/AccessTokenView",["backbone","../template/TplAccessToken","i18n!/nls/lang.js","ApiRequest","UI.scrollbar"],function(e,t,n,r){return e.View.extend({className:"access-token-view",events:{"click #TokenCreate":"createToken","click .tokenControl .icon-edit":"editToken","click .tokenControl .icon-delete":"removeToken","click .tokenControl .tokenDone":"doneEditToken","click #TokenRemove":"confirmRmToken","click #TokenRmCancel":"cancelRmToken"},initialize:function(){return this.tokens=[],this},render:function(){var e,n;return n=this,this.$el.html(MC.template.loadingSpinner()),e=this.model.get("id"),r("token_list",{project_id:e}).then(function(e){var r;return r=n.model.amIAdmin(),n.$el.html(t({isAdmin:r})),n.tokens=e[0].tokens,n.updateTokenList()}),this},editToken:function(e){var t,n;n=$(e.currentTarget),t=n.closest("li").toggleClass("editing",!0),t.children(".tokenName").removeAttr("readonly").focus().select()},removeToken:function(e){var t,r;t=$(e.currentTarget).closest("li"),r=t.children(".tokenName").val(),this.rmToken=t.children(".tokenToken").text(),this.$el.find("#TokenManager").hide(),this.$el.find("#TokenRmConfirm").show(),this.$el.find("#TokenRmTit").text(sprintf(n.IDE.SETTINGS_CONFIRM_TOKEN_RM_TIT,r))},createToken:function(){var e,t,i,s,o,u,a,f,l,c;this.$el.find("#TokenCreate").attr("disabled","disabled"),s=this,u="MyToken",e=1,t={},c=this.tokens;for(f=0,l=c.length;f<l;f++)o=c[f],t[o.name]=!0;for(;;){a=u+e;if(!t[a])break;e+=1}i=this.model.get("id"),r("token_create",{token_name:a,project_id:i}).then(function(e){var t,n;return t=e[0],n=e[1],s.tokens.push({name:t,token:n}),s.updateTokenList(),s.$el.find("#TokenCreate").removeAttr("disabled")},function(){return notification("error",n.NOTIFY.FAIL_TO_CREATE_TOKEN),s.$el.find("#TokenCreate").removeAttr("disabled")})},doneEditToken:function(e){var t,i,s,o,u,a,f,l,c,h,p;a=this,t=$(e.currentTarget).closest("li").removeClass("editing"),t.children(".tokenName").attr("readonly",!0),l=t.children(".tokenToken").text(),s=t.children(".tokenName").val(),p=this.tokens;for(c=0,h=p.length;c<h;c++)f=p[c],f.token===l?o=f.name:f.name===s&&(i=!0);if(!s||i){t.children(".tokenName").val(o);return}u=this.model.get("id"),r("token_update",{token:l,new_token_name:s,project_id:u}).then(function(e){var t,n,r,i,o;i=a.tokens,o=[];for(t=n=0,r=i.length;n<r;t=++n){f=i[t];if(f.token===l){f.name=s;break}o.push(void 0)}return o},function(){return o="",t.children(".tokenName").val(o),notification("error",n.NOTIFY.FAIL_TO_UPDATE_TOKEN)})},confirmRmToken:function(){var e,t,i,s,o,u,a,f,l;this.$el.find("#TokenRemove").attr("disabled","disabled"),i=this,l=this.tokens;for(e=a=0,f=l.length;a<f;e=++a){s=l[e];if(s.token===this.rmToken)break}t=this.model.get("id"),o=this.rmToken,u=s.name,r("token_remove",{project_id:t,token:o,token_name:u}).then(function(t){e=i.tokens.indexOf(s);if(e>=0)return i.tokens.splice(e,1),i.updateTokenList(),i.cancelRmToken()},function(){return notification(n.NOTIFY.FAIL_TO_DELETE_TOKEN),i.cancelRmToken()})},cancelRmToken:function(){this.rmToken="",this.$el.find("#TokenRemove").removeAttr("disabled"),this.$el.find("#TokenManager").show(),this.$el.find("#TokenRmConfirm").hide()},hasNoToken:function(){return this.tokens.length===0||this.tokens.length===1&&!this.tokens[0].name},updateTokenList:function(){var e,t,n;n=this.tokens,e=this.hasNoToken(),this.$el.find("#TokenManager").find(".token-table").toggleClass("empty",e),e?this.$el.find("#TokenList").empty():(t=this.model.amIAdmin(),this.$el.find("#TokenList").html(MC.template.accessTokenTable({tokens:n,isAdmin:t})))}})}),define("scenes/settings/template/TplBilling",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div id="billing-status" class="billing-frame">\n</div>'},n.billingLoadingFrame=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n        <p class="warning-red">'+u(n.i18n.call(e,"PAYMENT_ACCOUNT_IN_LIMITED_STATUS",{hash:{},data:t}))+"</p>\n    ",r}function c(e,t){return'\n        <dl class="billing-history settings-item"></dl>\n    '}function h(e,t){var r="",i;r+='\n        <dl class="billing-history settings-item">\n            <dt>'+u(n.i18n.call(e,"BILLING_HISTORY",{hash:{},data:t}))+'</dt> <span class="payment-next-billing">'+u(n.i18n.call(e,"NEXT_BILLING_ON",{hash:{},data:t}))+" "+u(n.formatTime.call(e,(i=e&&e.paymentUpdate,i==null||i===!1?i:i.nextPeriod),"yyyy-MM-d",{hash:{},data:t}))+'</span>\n            <dd class="table-head-fix">\n                ',i=n["if"].call(e,(i=e&&e.paymentHistory,i==null||i===!1?i:i.length),{hash:{},inverse:f.program(12,g,t),fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;return r+="\n            </div>\n        </div>\n    ",r}function p(e,t){var r="",i;r+='\n                    <table class="table-head">\n                        <thead>\n                        <tr>\n                            <th class="sortable desc-sort" data-row-type="datetime" style="width:25%;">'+u(n.i18n.call(e,"DATE",{hash:{},data:t}))+'</th>\n                            <th data-row-type="string" style="width:25%;">'+u(n.i18n.call(e,"AMOUNT",{hash:{},data:t}))+'</th>\n                            <th data-row-type="string" style="width:25%;">'+u(n.i18n.call(e,"STATUS",{hash:{},data:t}))+'</th>\n                            <th data-row-type="string" style="width:25%;">'+u(n.i18n.call(e,"ACTION",{hash:{},data:t}))+'</th>\n                        </tr>\n                        </thead>\n                    </table>\n                    <div class="scroll-wrap" style="max-height:200px;">\n                        <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n                        <div class="scroll-content">\n                            <table class="table">\n                                <thead>\n                                <tr>\n                                    <th style="width: 25%">\n                                        <div class="th-inner"></div>\n                                    </th>\n                                    <th style="width: 25%">\n                                        <div class="th-inner"></div>\n                                    </th>\n                                    <th style="width: 25%">\n                                        <div class="th-inner"></div>\n                                    </th>\n                                    <th style="width: 25%">\n                                        <div class="th-inner"></div>\n                                    </th>\n                                </tr>\n                                </thead>\n                                <tbody>\n                                ',i=n.each.call(e,e&&e.paymentHistory,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n                                </tbody>\n                            </table>\n                        </div>\n                    </dd>\n                ",r}function d(e,t){var r="",i;r+='\n                                    <tr class="item" data-id="'+u((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'">\n                                        <td>'+u(n.formatTime.call(e,e&&e.updated_at,"yyyy-MM-d",{hash:{},data:t}))+"</td>\n                                        <td>$ "+u(n.or.call(e,e&&e.ending_balance,e&&e.total_balance,{hash:{},data:t}))+"</td>\n                                        <td>",i=n["if"].call(e,e&&e.success,{hash:{},inverse:f.program(10,m,t),fn:f.program(8,v,t),data:t});if(i||i===0)r+=i;return r+='</td>\n                                        <td>\n                                            <a class="payment-receipt" href="#">'+u(n.i18n.call(e,"PAYMENT_VIEW_RECEIPT",{hash:{},data:t}))+"</a></td>\n                                    </tr>\n                                ",r}function v(e,t){var n;return u((n=e&&e.status,typeof n===a?n.apply(e):n))}function m(e,t){var n="",r;return n+='<span class="link-red">'+u((r=e&&e.status,typeof r===a?r.apply(e):r))+"</span>",n}function g(e,t){var r="";return r+='\n                    <div class="full-space">\n                        '+u(n.i18n.call(e,"NO_BILLING_EVENT",{hash:{},data:t}))+"\n                    </div>\n                ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<div id="PaymentBody">\n    ',o=n["if"].call(t,(o=t&&t.paymentUpdate,o==null||o===!1?o:o.failToCharge),{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n    <dl class="settings-item billing-email">\n        <dt class="billing-email-title">'+u(n.i18n.call(t,"PAYMENT_BILLING_EMAIL",{hash:{},data:i}))+'</dt>\n        <dd class="billing-email-text">\n            <p>'+u(n.or.call(t,(o=t&&t.paymentUpdate,o==null||o===!1?o:o.email),"Email not set",{hash:{},data:i}))+'</p>\n            <button class="icon-edit tooltip editEmailBtn" data-tooltip="Click to edit billing email"></button>\n            <input class="input hide" type="text"/>\n            <div id="SettingErrorInfo" class="empty-hide"></div>\n            <div class="editEmailControl hide edit-actions">\n                <button class="btn btn-blue editEmailDone">'+u(n.i18n.call(t,"HEAD_BTN_DONE",{hash:{},data:i}))+'</button>\n                <button class="btn btn-silver modal-close editEmailCancel">'+u(n.i18n.call(t,"HEAD_BTN_CANCEL",{hash:{},data:i}))+"</button>\n            </div>\n        </dd>\n    </dl>\n    ",o=n["if"].call(t,t&&t.noSubscription,{hash:{},inverse:f.program(5,h,i),fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+="\n</div>",s},n.billingTemplate=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n        <p class="warning-red">'+u(n.i18n.call(e,"PAYMENT_ACCOUNT_IN_LIMITED_STATUS",{hash:{},data:t}))+"</p>\n    ",r}function c(e,t){var r="",i;return r+='\n            <p class="renew-points">'+u(n.i18n.call(e,"PAYMENT_RENEW_FREE_INFO",(i=e&&e.payment,i==null||i===!1?i:i.maxQuota),(i=e&&e.payment,i==null||i===!1?i:i.renewDays),{hash:{},data:t}))+"</p>\n        ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<section id="UsageTab">\n    ',o=n["if"].call(t,(o=t&&t.payment,o==null||o===!1?o:o.failToCharge),{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n    <div class="settings-item">\n        <h5>'+u(n.i18n.call(t,"PAYMENT_CURRENT_USAGE",{hash:{},data:i}))+'</h5>\n        <div class="current-usage-block">\n            <h3>'+u((o=(o=t&&t.payment,o==null||o===!1?o:o.currentQuota),typeof o===f?o.apply(t):o))+"</h3>\n            <p>"+u(n.i18n.call(t,"PAYMENT_INSTANT_HOUR",{hash:{},data:i}))+"</p>\n        </div>\n        ",o=n["if"].call(t,(o=t&&t.payment,o==null||o===!1?o:o.isDefault),{hash:{},inverse:a.noop,fn:a.program(3,c,i),data:i});if(o||o===0)s+=o;return s+='\n    </div>\n    <div class="settings-item">\n        <h5>'+u(n.i18n.call(t,"PAYMENT_USAGE",{hash:{},data:i}))+'</h5>\n        <div class="usage-pagination">\n            <button class="btn nav-left"><i class="icon-caret-left"></i></button>\n            <span class="usage-date" data-date="">'+u(n.i18n.call(t,"PAYMENT_LOADING",{hash:{},data:i}))+'</span>\n            <button class="btn nav-right"><i class="icon-caret-right"></i></button>\n        </div>\n        <div class="table-head-fix">\n            <div class="full-space">\n                '+u(n.i18n.call(t,"NO_USAGE_REPORT",{hash:{},data:i}))+"\n            </div>\n        </div>\n    </div>\n</section>",s},n.usage=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n        <tr class="item" data-id="'+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+'">\n            <td>'+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</td>\n            <td>"+a(typeof e===u?e.apply(e):e)+"</td>\n        </tr>\n    ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table-head">\n    <thead>\n    <tr>\n        <th class="sortable desc-sort" data-row-type="string" style="width:50%;">'+a(n.i18n.call(t,"PAYMENT_INSTANCE_ID",{hash:{},data:i}))+'</th>\n        <th class="sortable desc-sort" data-row-type="number" style="width:50%;">'+a(n.i18n.call(t,"PAYMENT_INSTANT_HOUR",{hash:{},data:i}))+'</th>\n    </tr>\n    </thead>\n</table>\n\n<table class="table">\n    <thead>\n    <tr>\n        <th style="width: 50%"><div class="th-inner"></div></th>\n        <th style="width: 50%"><div class="th-inner"></div></th>\n    </tr>\n    </thead>\n    <tbody class="t-m-content">\n    ',o=n.each.call(t,(o=t&&t.result,o==null||o===!1?o:o.history_usage),{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n    </tbody>\n</table>",s},n.usageTable=e.template(t),n}),define("scenes/settings/views/BillingView",["backbone","../template/TplBilling","i18n!/nls/lang.js","ApiRequest","ApiRequestR","scenes/ProjectTpl","UI.parsley"],function(e,t,n,r,i,s){return e.View.extend({events:{"click #PaymentBody a.payment-receipt":"viewPaymentReceipt","click button.update-payment":"showUpdatePayment","click .update-payment-done":"updatePaymentDone","click .update-payment-cancel":"updatePaymentCancel","click .editEmailBtn":"updatePaymentEmail","click .editEmailDone":"updateEmailDone","click .editEmailCancel":"updateEmailCancel","change .billing-email-text>input":"emailInputChange","keyup .billing-email-text>input":"emailInputChange"},className:"billing-view",initialize:function(){return this},render:function(){var e,n;return this.$el.html(t.billingLoadingFrame()),this.$el.find("#billing-status").append(MC.template.loadingSpinner()),n=this,this.$el.find("#PaymentBody").remove(),e=App.user.get("paymentState"),this.model.getPaymentState().then(function(){var e,r;return r=n.model.get("payment"),e=t.billingTemplate({paymentUpdate:r}),n.$el.find("#billing-status").html(e),n.$el.find(".table-head-fix").replaceWith(MC.template.loadingSpinner()),n.getPaymentHistory().then(function(i){var s;return s=_.keys(i).length,r=n.model.get("payment"),e=t.billingTemplate({paymentUpdate:r,paymentHistory:i,hasPaymentHistory:s}),n.$el.find(".billing-history").html($(e).find(".billing-history").html())},function(){return n.renderCache()})},function(e){var r,i;return e.error===-404?(i=!0,r=t.billingTemplate({noSubscription:i}),n.$el.find("#billing-status").html(r)):notification("error","Error while getting user payment info, please try again later.")}),this},renderCache:function(){var e,n,r,i;return i=this,n=this.model.get("paymentHistory")||[],r=this.model.get("payment"),e=t.billingTemplate({paymentUpdate:r,paymentHistory:n}),i.$el.find("#billing-status").html(e),n.length||(i.$el.find(".table-head-fix").replaceWith(MC.template.loadingSpinner()),this.getPaymentHistory().then(function(){return n=i.model.get("paymentHistory"),e=t.billingTemplate({paymentUpdate:r,paymentHistory:n}),i.$el.find("#billing-status").empty().append(e)})),this},getPaymentHistory:function(){var e,t,n;return t=this.model.get("id"),e=new Q.defer,n=this,i("payment_statement",{projectId:t}).then(function(t){var r;return r=[],_.each(t,function(e){return e.ending_balance=e.ending_balance_in_cents/100,e.total_balance=e.total_in_cents/100,e.start_balance=e.starting_balance_in_cents/100,r.push(e)}),r.reverse(),t=_.map(r,function(e){var t;return t=$("<div>").html(e.html),e.status=t.find("#billing_statement_summary_balance_paid_stamp").text(),e.status||(e.status=t.find("#billing_statement_summary_balance_paid_date").find(".billing_statement_summary_value").text()),t.remove(),e.success?e.status||(e.status="Not yet due"):e.status||(e.status="Unpaid"),e}),n.model.set("paymentHistory",t),e.resolve(t)},function(t){return e.reject(t)}),e.promise},showUpdatePayment:function(e){return $(".update-payment-ctrl").show(),this.$el.find(".billing-history").replaceWith(s.updateProject()),$(e.currentTarget).hide()},emailInputChange:function(){var e;return e=this.$el.find(".billing-email-text input").val(),this.isValidEmail(e)},updatePaymentDone:function(){var e,t,i,s,o,u,a,f,l,c,h,p,d;h=this,d=this.$el.find(".update-payment-wrap"),d.find(".billing-info-err").hide(),u=h.$el.find(".update-payment-done"),i=d.find("#new-project-fn"),s=d.find("#new-project-ln"),o=d.find("#new-project-card"),t=d.find("#new-project-date"),e=d.find("#new-project-cvv"),p=!0,t.parsley("custom",function(e){return null}),f=t.val(),l=f.split("/"),f.match(/^\d\d\/\d\d$/g)?f=""+l[0]+"/20"+l[1]:f.match(/^\d\d\d\d$/g)?f=""+f.substr(0,2)+"/20"+f.substr(2,2):f.match(/^\d\d\/\d\d\d\d$/g)?f=f:f.match(/^\d\d\d\d\d\d$/g)?f=""+f.substr(0,2)+"/"+f.substr(2,4):f.match(/^\d\d\d$/g)?f="0"+f.substr(0,1)+"/20"+f.substr(1,2):t.parsley("custom",function(e){return e.indexOf("/")===-1?n.IDE.SETTINGS_CREATE_PROJECT_EXPIRE_FORMAT:null}),d.find("input").each(function(e,t){if(!$(t).parsley("validate"))return p=!1,!1});if(p)return d.find("input, button").attr("disabled","disabled"),c=h.model.get("id"),a={first_name:i.val(),last_name:s.val(),full_number:o.val(),expiration_month:f.split("/")[0],expiration_year:f.split("/")[1],cvv:e.val()},r("project_update_payment",{project_id:c,attributes:a}).then(function(){return h.render()}).fail(function(e){var t,n;d.find("input, button").prop("disabled",!1);try{n=JSON.parse(e.result),_.isArray(n.errors)&&d.find(".update-payment-err").show().html(n.errors.join("<br/>"))}catch(r){t=r,notification("error",e.result)}})},updatePaymentCancel:function(){return $(".parsley-error-list").remove(),this.renderCache()},updatePaymentEmail:function(){return this.$el.find(".billing-email-text>p,.editEmailBtn").hide(),this.$el.find(".editEmailControl,.billing-email-text>input").show(),this.$el.find(".billing-email-text>input").val(this.model.get("payment").email)},updateEmailCancel:function(){return this.renderCache()},isValidEmail:function(e){var t,r;return r=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,t=r.test(e),t?this.$el.find("#SettingErrorInfo").empty():this.$el.find("#SettingErrorInfo").text(n.IDE.SETTING_INVALID_EMAIL),t},updateEmailDone:function(){var e,t,i,s;return i=this.model.get("id"),s=this,t=this.$el.find(".billing-email-text input").val(),this.isValidEmail(t)?(this.$el.find(".editEmailControl button").attr("disabled","disabled"),this.$el.find(".billing-email-text>input").attr("disabled","disabled"),this.$el.find(".editEmailControl .editEmailDone").text(n.IDE.LBL_SAVING),this.$el.find(".editEmailControl .editEmailCancel").hide(),e={email:t},r("project_update_payment",{project_id:i,attributes:e}).then(function(){return s.model.set("payment",null),s.model.set("paymentHistory",null),s.render()},function(e){return void 0,notification("error","Error while updating user payment info, please try again later."),s.renderCache()})):!1},viewPaymentReceipt:function(e){var t,n,r,i,s;return t=$(e.currentTarget),r=t.parent().parent().data("id"),s=this.model.get("paymentHistory")[r],n=".billing_statement_section {\n    display: block;\n    position: relative;\n}\n.billing_statement_section h2 {\n    display: block;\n    background: #E6E6E6;\n    font-size: 16px;\n    padding: 10px;\n    font-weight: bold;\n    margin-bottom: 0;\n    border-bottom: 1px solid #727272;\n}\n.billing_statement_section_content {\n    display: block;\n    position: relative;\n    padding-top: 10px;\n}\ntable {\n    border-collapse: collapse;\n    width: 100%;\n}\ntable, td, th {\n    border: 1px solid #333;\n    padding: 7px;\n    text-align: left;\n    font-size: 14px;\n}\ntable thead {\n    background: #dedede;\n}\ntable tr.billing_statement_listing_tfoot {\n    font-weight: bold;\n    text-align: right;\n}\n#billing_statement {\n    width: 800px;\n    margin: 20px auto;\n    padding-bottom: 50px;\n}\n.billing_statement_section .billing_statement_section_content h3 {\n    font-size: 14px;\n    position: relative;\n    margin: 10px 0;\n    font-weight: bold;\n    margin-bottom: 14px;\n    background: #F3F3F3;\n    padding: 5px;\n}\ndiv#billing_statement_account_information_section {\n    width: 49%;\n    float: left;\n}\ndiv#billing_statement_summary_section {\n    width: 49%;\n    float: right;\n}\ndiv#billing_statement_detail_section {\n    clear: both;\n    padding-top: 10px;\n}\n.billing_statement_section_content .billing_statement_summary_label {\n    font-weight: bold;\n    font-size: 16px;\n    width: 44%;\n    display: inline-block;\n    text-align: right;\n}\n.billing_statement_section_content> div {\n    margin-bottom: 10px;\n}\n.billing_statement_section_content .billing_statement_summary_value {\n    text-align: right;\n    float: right;\n    color: #666;\n}\ndiv#billing_statement_summary_balance_paid_stamp.billing_statement_balance_paid_stamp_paid {\n    float: right;\n    font-size: 30px;\n    color: #50B816;\n    margin-top: 10px;\n}\ndiv#billing_statement_summary_balance_paid_stamp.billing_statement_balance_paid_stamp_unpaid {\n    float: right;\n    font-size: 30px;\n    color: #C70000;\n    margin-top: 10px;\n}\nbody {font-family: 'Lato', 'Helvetica Neue', Arial, sans-serif;}",i=function(){var e,t,r,i;return r=window.open("",""),r.focus(),e=s.html,r.document.write(e),t=r.document.head||r.document.getElementsByTagName("head")[0],i=document.createElement("style"),i.type="text/css",i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n)),t.appendChild(i),r.document.close()},i()}})}),define("scenes/settings/template/TplTeam",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="loading-spinner"></div>'},n.loading=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n    <div class="operate">\n        ',i=n["if"].call(e,e&&e.limit,{hash:{},inverse:a.program(4,h,t),fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;return r+='\n        <button class="btn btn-red" id="delete" disabled>'+u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_REMOVE",{hash:{},data:t}))+"</button>\n    </div>\n    ",r}function c(e,t){var r="";return r+='\n        <div class="limit-member-tip">\n            '+u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_LIMIT",e&&e.number,{hash:{},data:t}))+' <a href="mailto:support@visualops.io" target="_top">support@visualops.io</a>\n        </div>\n        ',r}function h(e,t){var r="";return r+='\n        <div class="invite">\n            <input class="input" placeholder="'+u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_INVITE_TIP",{hash:{},data:t}))+'" id="mail">\n            <div class="search"></div>\n            <button class="btn btn-blue" id="invite">'+u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_INVITE_CONFIRM",{hash:{},data:t}))+"</button>\n        </div>\n        ",r}function p(e,t){var r="",i;r+="\n                    ",i=n["if"].call(e,e&&e.admin,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n                    ",r}function d(e,t){return'\n                    <th class="checkbox-row">\n                        <div class="checkbox">\n                            <input id="t-m-select-all" type="checkbox" value="None">\n                            <label for="t-m-select-all"></label>\n                        </div>\n                    </th>\n                    '}function v(e,t){var r="",i;r+='\n                    <th class="',i=n["if"].call(e,e&&e.sortable,{hash:{},inverse:a.noop,fn:a.program(10,m,t),data:t});if(i||i===0)r+=i;r+='" data-row-type="',i=n["if"].call(e,e&&e.rowType,{hash:{},inverse:a.program(14,y,t),fn:a.program(12,g,t),data:t});if(i||i===0)r+=i;r+='" style="',i=n["if"].call(e,e&&e.width,{hash:{},inverse:a.noop,fn:a.program(16,b,t),data:t});if(i||i===0)r+=i;return r+='">'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+"</th>\n                    ",r}function m(e,t){return"sortable"}function g(e,t){var n;return u((n=e&&e.rowType,typeof n===f?n.apply(e):n))}function y(e,t){return"string"}function b(e,t){var n="",r;return n+="width:"+u((r=e&&e.width,typeof r===f?r.apply(e):r))+";",n}function w(e,t){return"\n        <div>\n            "}function E(e,t){var r="",i;r+='\n            <div class="scroll-wrap" ',i=n["if"].call(e,e&&e.height,{hash:{},inverse:a.noop,fn:a.program(21,S,t),data:t});if(i||i===0)r+=i;return r+='>\n                <div class="scrollbar-veritical-wrap" style="display: block;"><div class="scrollbar-veritical-thumb"></div></div>\n                <div class="scroll-content" style="display:block;">\n                    ',r}function S(e,t){var n="",r;return n+='style="height: '+u((r=e&&e.height,typeof r===f?r.apply(e):r))+'px" ',n}function x(e,t){var r;return r=n.unless.call(e,e&&e.noCheckbox,{hash:{},inverse:a.noop,fn:a.program(24,T,t),data:t}),r||r===0?r:""}function T(e,t){return'<th class="checkbox-row"><div class="th-inner"></div></th>'}function N(e,t){var r="",i;r+='\n                                <th style="',i=n["if"].call(e,e&&e.width,{hash:{},inverse:a.noop,fn:a.program(16,b,t),data:t});if(i||i===0)r+=i;return r+='"><div class="th-inner"></div></th>\n                                ',r}function C(e,t){return"\n                </div>\n                "}function k(e,t){return"\n            </div>\n        </div>\n        "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<div class="hide content" data-bind="true">\n    <div class="title">'+u(n.i18n.call(t,"SETTINGS_MEMBER_LABEL_MEMBER",{hash:{},data:i}))+'<span class="memlist-count"></span></div>\n    ',o=n["if"].call(t,t&&t.admin,{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n    <div class="table-head-fix will-be-covered">\n        <table class="table-head">\n            <thead>\n                <tr>\n                    ',o=n.unless.call(t,t&&t.noCheckbox,{hash:{},inverse:a.noop,fn:a.program(6,p,i),data:i});if(o||o===0)s+=o;s+="\n                    ",o=n.each.call(t,t&&t.columns,{hash:{},inverse:a.noop,fn:a.program(9,v,i),data:i});if(o||o===0)s+=o;s+="\n                </tr>\n            </thead>\n        </table>\n        ",o=n.unless.call(t,t&&t.useCustomScroll,{hash:{},inverse:a.program(20,E,i),fn:a.program(18,w,i),data:i});if(o||o===0)s+=o;s+='\n\n                    <table class="table">\n                        <thead>\n                            <tr>\n                                ',o=n["if"].call(t,t&&t.admin,{hash:{},inverse:a.noop,fn:a.program(23,x,i),data:i});if(o||o===0)s+=o;s+="\n                                ",o=n.each.call(t,t&&t.columns,{hash:{},inverse:a.noop,fn:a.program(26,N,i),data:i});if(o||o===0)s+=o;s+='\n                            </tr>\n                        </thead>\n                        <tbody class="t-m-content">\n                        </tbody>\n                    </table>\n                    ',o=n.unless.call(t,t&&t.useCustomScroll,{hash:{},inverse:a.program(30,k,i),fn:a.program(28,C,i),data:i});if(o||o===0)s+=o;return s+="\n    </div>\n</div>",s},n.main=e.template(t),t=function(e,t,n,r,i){function f(e,t,r){var i="",s;i+='\n<tr class="item memlist-item" data-id="'+u((s=e&&e.id,typeof s===o?s.apply(e):s))+'">\n    ',s=n["if"].call(e,r&&r.admin,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(s||s===0)i+=s;i+='\n    <td>\n        <div class="avatar" style="background-image:url(\''+u((s=e&&e.avatar,typeof s===o?s.apply(e):s))+'\')"></div>\n        <div class="info">\n            <div class="name">'+u((s=e&&e.username,typeof s===o?s.apply(e):s)),s=n["if"].call(e,e&&e.me,{hash:{},inverse:a.noop,fn:a.program(6,p,t),data:t});if(s||s===0)i+=s;i+='</div>\n            <div class="mail">'+u((s=e&&e.email,typeof s===o?s.apply(e):s))+'</div>\n        </div>\n    </td>\n    <td class="'+u((s=e&&e.role,typeof s===o?s.apply(e):s))+'">\n        <span class="memlist-view-mode role">\n            ',s=n.ifCond.call(e,e&&e.role,"admin",{hash:{},inverse:a.noop,fn:a.program(8,d,t),data:t});if(s||s===0)i+=s;i+="\n            ",s=n.ifCond.call(e,e&&e.role,"collaborator",{hash:{},inverse:a.noop,fn:a.program(10,v,t),data:t});if(s||s===0)i+=s;i+="\n            ",s=n.ifCond.call(e,e&&e.role,"observer",{hash:{},inverse:a.noop,fn:a.program(12,m,t),data:t});if(s||s===0)i+=s;i+='\n        </span>\n        <div class="selectbox memlist-edit-mode memtype">\n            <div class="selection">\n                ',s=n.ifCond.call(e,e&&e.role,"admin",{hash:{},inverse:a.noop,fn:a.program(8,d,t),data:t});if(s||s===0)i+=s;i+="\n                ",s=n.ifCond.call(e,e&&e.role,"collaborator",{hash:{},inverse:a.noop,fn:a.program(10,v,t),data:t});if(s||s===0)i+=s;i+="\n                ",s=n.ifCond.call(e,e&&e.role,"observer",{hash:{},inverse:a.noop,fn:a.program(12,m,t),data:t});if(s||s===0)i+=s;i+='\n            </div>\n            <ul class="dropdown">\n                <li data-id="admin" class="item ',s=n.ifCond.call(e,e&&e.role,"admin",{hash:{},inverse:a.noop,fn:a.program(14,g,t),data:t});if(s||s===0)i+=s;i+='">\n                    <div class="name">'+u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_ADMIN",{hash:{},data:t}))+'</div>\n\n                </li>\n                <li data-id="collaborator" class="item ',s=n.ifCond.call(e,e&&e.role,"collaborator",{hash:{},inverse:a.noop,fn:a.program(14,g,t),data:t});if(s||s===0)i+=s;i+='">\n                    <div class="name">'+u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_COLLABORATOR",{hash:{},data:t}))+'</div>\n                </li>\n                <li data-id="observer" class="item ',s=n.ifCond.call(e,e&&e.role,"observer",{hash:{},inverse:a.noop,fn:a.program(14,g,t),data:t});if(s||s===0)i+=s;i+='">\n                    <div class="name">OBSERVER</div>\n                </li>\n            </ul>\n        </div>\n    </td>\n    <td class="memlist-status ',s=n.ifCond.call(e,e&&e.state,"inactive",{hash:{},inverse:a.noop,fn:a.program(16,y,t),data:t});if(s||s===0)i+=s;i+='">\n        ',s=n.ifCond.call(e,e&&e.state,"normal",{hash:{},inverse:a.noop,fn:a.program(18,b,t),data:t});if(s||s===0)i+=s;i+="\n        ",s=n.ifCond.call(e,e&&e.state,"inactive",{hash:{},inverse:a.noop,fn:a.program(20,w,t),data:t});if(s||s===0)i+=s;i+="\n    </td>\n    ",s=n["if"].call(e,r&&r.admin,{hash:{},inverse:a.noop,fn:a.program(22,E,t),data:t});if(s||s===0)i+=s;return i+="\n</tr>\n",i}function l(e,t){var r="",i;r+='\n    <td class="checkbox-row">\n        ',i=n.unless.call(e,e&&e.me,{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;return r+="\n    </td>\n    ",r}function c(e,t){var r="",i;r+='\n        <div class="checkbox">\n            <input id="sslcert-select-'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" type="checkbox" data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" class="one-cb" ',i=n.ifCond.call(e,e&&e.state,"inactive",{hash:{},inverse:a.noop,fn:a.program(4,h,t),data:t});if(i||i===0)r+=i;return r+='>\n            <label for="sslcert-select-'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'"></label>\n        </div>\n        ',r}function h(e,t){return'disabled="disabled"'}function p(e,t){var r="";return r+='<span class="you">('+u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_YOU",{hash:{},data:t}))+")</span>",r}function d(e,t){return u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_ADMIN",{hash:{},data:t}))}function v(e,t){return u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_COLLABORATOR",{hash:{},data:t}))}function m(e,t){return"OBSERVER"}function g(e,t){return"selected"}function y(e,t){return"memlist-pending"}function b(e,t){return u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_ACTIVE",{hash:{},data:t}))}function w(e,t){return u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_PENDING",{hash:{},data:t}))}function E(e,t){var r="",i;r+="\n    <td>",i=n.ifCond.call(e,e&&e.state,"inactive",{hash:{},inverse:a.noop,fn:a.program(23,S,t),data:t});if(i||i===0)r+=i;return r+='</td>\n    <td>\n        <button class="btn btn-blue memlist-edit-mode done">'+u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_DONE",{hash:{},data:t}))+'</button>\n        <button class="icon-edit memlist-view-mode edit"></button>\n    </td>\n    ',r}function S(e,t){var r="";return r+='<button class="cancel link-style">'+u(n.i18n.call(e,"SETTINGS_MEMBER_LABEL_CANCEL_INVITE",{hash:{},data:t}))+"</button>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.memlist,{hash:{},inverse:a.noop,fn:a.programWithDepth(1,f,i,t),data:i}),s||s===0?s:""},n.list=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="info">'+o(n.i18n.call(t,"SETTINGS_MEMBER_LABEL_REMOVE_CONFIRM",t&&t.count,{hash:{},data:i}))+'</div>\n<div class="operate">\n    <button class="confirm btn btn-red">'+o(n.i18n.call(t,"SETTINGS_MEMBER_LABEL_REMOVE",{hash:{},data:i}))+"</button>\n</div>",s},n.deletePopup=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="name">'+a((o=t&&t.name,typeof o===u?o.apply(t):o))+'</div>\n<div class="mail">'+a((o=t&&t.mail,typeof o===u?o.apply(t):o))+"</div>",s},n.match=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+="<span>"+u(n.i18n.call(t,"SETTINGS_MEMBER_LABEL_NO_USER",{hash:{},data:i}))+' "'+u((o=t&&t.name,typeof o===a?o.apply(t):o))+'"</span>',s},n.nomatch=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+="<div>"+o(n.i18n.call(t,"SETTINGS_MEMBER_LABEL_DEFAULT_WORKSPACE_TIP1",{hash:{},data:i}))+".</div>\n<div>"+o(n.i18n.call(t,"SETTINGS_MEMBER_LABEL_DEFAULT_WORKSPACE_TIP2",{hash:{},data:i}))+", "+o(n.i18n.call(t,"SETTINGS_MEMBER_LABEL_CREATE_WORKSPACE",{hash:{},data:i}))+".</div>",s},n.defaultProject=e.template(t),n}),define("scenes/settings/views/TeamView",["backbone","../template/TplTeam","i18n!/nls/lang.js","UI.bubblepopup","ApiRequest","../models/MemberCollection","UI.selectbox","UI.parsley","UI.errortip","UI.table","MC.validate"],function(e,t,n,r,i,s){return e.View.extend({className:"member-setting",events:{"change #t-m-select-all":"__checkAll","change .one-cb":"__checkOne","click #invite":"inviteMember","click #delete":"removeMember","click .done":"doneModify","click .edit":"enterModify","click .cancel":"cancelInvite","focus #mail":"focusMail","blur #mail":"blurMail","keyup #mail":"keyupMail","keypress #mail":"keypressMail"},focusMail:function(){},blurMail:function(){return this.$el.find(".search").hide()},keyupMail:function(){return this.keyupHandle()},keyupHandle:function(){var e,n,r;return r=this,n=r.$el.find("#mail").val(),e=r.$el.find(".search"),n.length>0?i("account_get_userinfo",{user_email:n}).then(function(r){return r?e.html(t.match({name:Base64.decode(r.username),mail:Base64.decode(r.email)})):e.html(t.nomatch({name:n}))}).done(function(){return e.show()}):e.hide()},keypressMail:function(e){if(e.keyCode===13)return this.$el.find("#invite").click()},initialize:function(){return this.keyupHandle=_.throttle(this.keyupHandle,1e3),this.project=this.model,this.memberCol=new s({projectId:this.project.id}),this.projectId=this.model.get("id"),this.isAdmin=!1,this.render()},render:function(){var e;return e=this.model.get("private"),e?this.$el.html(t.defaultProject()):(this.$el.html(t.loading()),this.loadMemList()),this},renderMain:function(){var e,r;r=this,e=[{sortable:!0,name:n.IDE.SETTINGS_MEMBER_COLUMN_MEMBER},{sortable:!0,width:"20%",name:n.IDE.SETTINGS_MEMBER_COLUMN_ROLE},{sortable:!0,width:"10%",name:n.IDE.SETTINGS_MEMBER_COLUMN_STATUS}],r.isAdmin&&(e=e.concat([{sortable:!1,width:"103px",name:""},{sortable:!1,width:"55px",name:n.IDE.SETTINGS_MEMBER_COLUMN_EDIT}])),r.$el.html(t.main({limit:r.memberCol.isLimitInvite(),number:r.memberCol.limit,columns:e,admin:r.isAdmin})),r.memList=r.$el.find(".t-m-content")},loadMemList:function(e){var t,n,r,i;return i=this,r=[],t=null,n=App.user.get("username"),this.memberCol.fetch().then(function(){var e;t=i.memberCol.getCurrentMember(),i.isAdmin=t!=null?t.isAdmin():void 0,e=t!=null?t.get("username"):void 0,r=i.memberCol.toJSON(),r=_.sortBy(r,function(t,n){return e!==t.username||t.state!=="normal"||t.role!=="admin"})}).fail(function(e){return notification("error",e.result||e.msg),i.$el.find(".loading-spinner").addClass("hide")}).done(function(){i.renderMain(),i.$el.find(".content").removeClass("hide"),i.$el.find(".loading-spinner").addClass("hide"),i.renderList(r),i.__processDelBtn();if(e)return e()})},renderList:function(e){var n;return n=this,this.memList.html(t.list({admin:n.isAdmin,memlist:e})),this.$el.find(".memlist-count").text(e.length)},inviteMember:function(){var e,t,r,s,o;o=this,e=this.$el.find("#invite");if(e.prop("disabled")===!1){t=this.$el.find("#mail"),r=$.trim(t.val());if(!r)return;return s=e.text(),e.prop("disabled",!0),e.text(""+s),this.memberCol.inviteMember(r).then(function(){return t.val(""),o.loadMemList(function(){return notification("info",sprintf(n.IDE.SETTING_MEMBER_USER_INVITED,r)),e.text(s),e.prop("disabled",!1)})}).fail(function(t){return t.error===i.Errors.UserNoUser?notification("error",sprintf(n.IDE.SETTING_MEMBER_LABEL_NO_USER,r)):notification("error",t.result),e.text(s),e.prop("disabled",!1)})}},removeMember:function(e){var n,i,s;s=this,n=$(e.currentTarget);if(n.prop("disabled")===!1)return i=[],_.each(s.$el.find(".memlist-item.selected"),function(e){var t;return t=$(e).data("id"),i.push(t)}),r(n,t.deletePopup({count:i.length}),{".confirm":function(){var e;return e=n.text(),n.prop("disabled",!0),n.text(""+e),s.memberCol.removeMember(i).then(function(){return s.loadMemList(function(){return n.text(e)})}).fail(function(t){return notification("error",t.result),n.text(e),n.prop("disabled",!1)})}})},enterModify:function(e){var t;return t=$(e.currentTarget).parents(".memlist-item"),t.addClass("edit")},doneModify:function(e){var t,r,i,s,o,u,a,f;f=this,t=$(e.currentTarget);if(t.prop("disabled")===!1){r=$(e.currentTarget).parents(".memlist-item"),s=r.data("id"),u=r.find(".memtype li.selected").data("id"),o=f.memberCol.get(s),i=f.memberCol.getCurrentMember();if(o===i&&i.isAdmin()&&u!=="admin"&&i.isOnlyAdmin()){notification("error",n.IDE.SETTINGS_MEMBER_LABEL_ONLY_ONE_ADMIN),r.removeClass("edit");return}if(o.get("role")===u){r.removeClass("edit");return}return a=t.text(),t.prop("disabled",!0),t.text(""+a),o.updateRole(u).then(function(){return f.loadMemList(function(){return t.text(a),t.prop("disabled",!1),r.removeClass("edit")})}).fail(function(e){return notification("error",e.result),t.text(a),t.prop("disabled",!1),r.removeClass("edit")})}},cancelInvite:function(e){var t,n,r,i,s,o;o=this,t=$(e.currentTarget);if(t.prop("disabled")===!1)return n=$(e.currentTarget).parents(".memlist-item"),r=n.data("id"),s=t.text(),t.prop("disabled",!0),t.text(""+s),i=o.memberCol.get(r),i.cancelInvite().then(function(){return o.loadMemList(function(){return t.text(s),t.prop("disabled",!1)})}).fail(function(e){return notification("error",e.result),t.text(s),t.prop("disabled",!1)})},__checkOne:function(e){var t,n,r,i;return t=$(e.currentTarget),n=this.$("#t-m-select-all"),r=this.$(".one-cb").length,i=this.$(".one-cb:checked").length,t.closest("tr").toggleClass("selected"),i===r?n.prop("checked",!0):r-i===1&&n.prop("checked",!1),this.__processDelBtn()},__checkAll:function(e){return e.currentTarget.checked?this.$('input[type="checkbox"]:not(:disabled)').prop("checked",!0).parents("tr.item").addClass("selected"):(this.$('input[type="checkbox"]').prop("checked",!1),this.$("tr.item").removeClass("selected")),this.__processDelBtn()},__processDelBtn:function(){var e;return e=this,e.$(".one-cb:checked").length?e.$("#delete").prop("disabled",!1):e.$("#delete").prop("disabled",!0)},getChecked:function(){var e,t;return e=this.$(".one-cb:checked"),t=[],e.each(function(){return t.push({id:this.id,value:this.value,data:$(this).data()})}),t}})}),define("scenes/settings/template/TplCredential",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){var r="";return r+="\n        "+u(n.i18n.call(e,"WORKSPACE_DEMO_TIP",{hash:{},data:t}))+"\n        ",r}function c(e,t){var r="";return r+="\n        "+u(n.i18n.call(e,"CREDENTIAL_LINKED_TO_THIS_WORKSPACE",{hash:{},data:t}))+"\n        ",r}function h(e,t){var r="",i;r+='\n        <li class="aws-credential">\n\n            <div class="credential-name">',i=n["if"].call(e,e&&e.isDemo,{hash:{},inverse:f.program(8,d,t),fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+='</div>\n            <div class="credential-describe">\n                ',i=n["if"].call(e,e&&e.isDemo,{hash:{},inverse:f.program(12,m,t),fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;r+="\n            </div>\n            ",i=n.unless.call(e,e&&e.isDemo,{hash:{},inverse:f.noop,fn:f.program(14,g,t),data:t});if(i||i===0)r+=i;return r+="\n        </li>\n        ",r}function p(e,t){var r="",i;return r+=u((i=e&&e.providerName,typeof i===a?i.apply(e):i))+" "+u(n.i18n.call(e,"PARENTHESES_DEMO",{hash:{},data:t})),r}function d(e,t){var n;return u((n=e&&e.name,typeof n===a?n.apply(e):n))}function v(e,t){var r="";return r+="\n                "+u(n.i18n.call(e,"DEMO_CREDENTIAL_TIP",{hash:{},data:t}))+"\n                ",r}function m(e,t){var n="",r;return n+="\n                "+u((r=e&&e.awsAccessKey,typeof r===a?r.apply(e):r))+"\n                ",n}function g(e,t){var r="",i;r+="\n            ",i=n["if"].call(e,e&&e.isAdmin,{hash:{},inverse:f.noop,fn:f.program(15,y,t),data:t});if(i||i===0)r+=i;return r+="\n            ",r}function y(e,t){var r="",i;return r+='\n            <i class="icon-caret-down show-button-list"></i>\n            <ul class="dropdown-menu button-list">\n                <li class="update-link icon-edit" data-id='+u((i=e&&e.id,typeof i===a?i.apply(e):i))+">"+u(n.i18n.call(e,"HEAD_BTN_UPDATE",{hash:{},data:t}))+'</li>\n                <li class="delete-link icon-delete" data-id='+u((i=e&&e.id,typeof i===a?i.apply(e):i))+">"+u(n.i18n.call(e,"CFM_BTN_REMOVE",{hash:{},data:t}))+"</li>\n            </ul>\n            ",r}function b(e,t){var r="";return r+='\n    <button class="btn btn-primary setup-credential">'+u(n.i18n.call(e,"SET_UP_PROVIDER_CREDENTIAL",{hash:{},data:t}))+"</button>\n    ",r}function w(e,t){var r="";return r+='\n    <div class="demo-note">\n        '+u(n.i18n.call(e,"DEMO_CREDENTIAL_ERROR_NOTE",{hash:{},data:t}))+"\n    </div>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<div>\n    <div class="instruct">\n        ',o=n["if"].call(t,t&&t.hasDemo,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n    </div>\n    <ul class="credential-list">\n        ',o=n.each.call(t,t&&t.credentials,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+="\n    </ul>\n    ",o=n["if"].call(t,t&&t.addable,{hash:{},inverse:f.noop,fn:f.program(17,b,i),data:i});if(o||o===0)s+=o;s+="\n    ",o=n["if"].call(t,t&&t.hasDemo,{hash:{},inverse:f.noop,fn:f.program(19,w,i),data:i});if(o||o===0)s+=o;return s+="\n</div>",s},n.credentialManagement=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="cred-setup-msg warning-red empty-hide"></div>\n<div class="modal-text-major">\n    '+o(n.i18n.call(t,"ARE_YOU_SURE_YOU_WANT_TO_REMOVE_XXX",t&&t.name,{hash:{},data:i}))+'\n    <p class="warning-text mgt10">\n       '+o(n.i18n.call(t,"REMOVE_CREDENTIAL_CONFIRM_TIPS",{hash:{},data:i}))+"\n    </p>\n</div>",s},n.removeConfirm=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="updating-credential">'+o(n.i18n.call(t,"SETTINGS_CRED_UPDATING",{hash:{},data:i}))+"</div>",s},n.updating=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="cred-setup-msg warning-red empty-hide"></div>\n<div id="CredConfirmWrap">\n    <h3>'+o(n.i18n.call(t,"SETTINGS_CRED_UPDATE_CONFIRM_TIT",{hash:{},data:i}))+"</h3>\n    <div>"+o(n.i18n.call(t,"SETTINGS_CRED_UPDATE_CONFIRM_TEXT",{hash:{},data:i}))+"</div>\n</div>",s},n.runningAppConfirm=e.template(t),n}),define("scenes/settings/views/ProviderCredentialView",["constant","i18n!/nls/lang.js","../template/TplCredential","Credential","ApiRequest","UI.modalplus","credentialFormView","UI.tooltip","UI.notification","backbone"],function(e,t,n,r,i,s,o){var u;return u={add:t.IDE.SETTINGS_CRED_ADDING,update:t.IDE.SETTINGS_CRED_UPDATING,remove:t.IDE.SETTINGS_CRED_REMOVING},Backbone.View.extend({events:{"click .setup-credential":"showAddForm","click .update-link":"showUpdateForm","click .show-button-list":"showButtonList","click .delete-link":"showRemoveConfirmModel"},className:"credential",initialize:function(){return this.listenTo(this.model,"update:credential",this.render),this.listenTo(this.model,"change:credential",this.render)},render:function(){var e,t,r;return t=this.model.credentials().models,r=this.model.toJSON(),r.isAdmin=this.model.amIAdmin(),r.isAdmin&&(t.length===0?r.addable=!0:r.addable=!_.some(t,function(e){return!e.isDemo()})),e=this.model.apps(),r.credentials=_.map(t,function(e){var t;return t=e.toJSON(),t.isAdmin=r.isAdmin,t.providerName=e.getProviderName(),t.name=t.alias||t.providerName,t.isDemo&&(r.hasDemo=!0),t}),this.$el.html(n.credentialManagement(r)),this},showButtonList:function(){return this.$(".button-list").toggle(),!1},getCredentialById:function(e){return this.model.credentials().findWhere({id:e})},makeModalLoading:function(e,t){return e.setContent(MC.template.credentialLoading({tip:u[t]})).toggleFooter(!1),this},stopModalLoading:function(e,t){return e.setContent(t).toggleFooter(!0),this},showModalError:function(e,t){return e.$(".cred-setup-msg").text(t)},showAddForm:function(){return this.showFormModal()},showUpdateForm:function(e){var t,n;return n=$(e.currentTarget).data("id"),t=this.getCredentialById(n),this.showFormModal(t)},removeCredential:function(e){var r;return r=this,this.makeModalLoading(this.removeConfirmView,"Remove"),e.destroy().then(function(){var e;return(e=r.removeConfirmView)!=null?e.close():void 0},function(s){var o,u;return s.error===i.Errors.ChangeCredConfirm?u=t.IDE.CRED_REMOVE_FAILD_CAUSEDBY_EXIST_APP:u=t.IDE.SETTINGS_ERR_CRED_REMOVE,o=e.getProviderName(),r.stopModalLoading(r.removeConfirmView,n.removeConfirm({name:o})),r.showModalError(r.removeConfirmView,u)})},showRemoveConfirmModel:function(e){var r,i,o,u;return o=$(e.currentTarget).data("id"),i=this.getCredentialById(o),r=i.getProviderName(),(u=this.removeConfirmView)!=null&&u.close(),this.removeConfirmView=new s({title:t.IDE.REMOVE_CREDENTIAL_CONFIRM_TITLE,template:n.removeConfirm({name:r}),confirm:{text:t.IDE.REMOVE_CREDENTIAL_CONFIRM_BTN,color:"red"}}),this.removeConfirmView.on("confirm",function(){return this.removeCredential(i)},this)},showFormModal:function(e,t){return this.formView=(new o({provider:t,credential:e,model:this.model})).render(),this},remove:function(){var e,t,n;return(e=this.formView)!=null&&e.remove(),(t=this.updateConfirmView)!=null&&t.close(),(n=this.removeConfirmView)!=null&&n.close(),Backbone.View.prototype.remove.apply(this,arguments)}})}),define("scenes/settings/views/UsageReportView",["backbone","../template/TplBilling","ApiRequestR","i18n!/nls/lang.js"],function(e,t,n,r){return e.View.extend({events:{"click .usage-pagination .nav-left":"prevUsage","click .usage-pagination .nav-right":"nextUsage"},className:"usage-report-view",initialize:function(){return this.$el.html(t.billingLoadingFrame()),this.$el.find("#billing-status").html(MC.template.loadingSpinner()),this},render:function(){var e;return e=this,e.model.getPaymentState().then(function(){var n;return n=e.model.get("payment"),e.$el.find("#billing-status").html(t.usage({payment:n})),e.renderUsageData()}),this},getUsage:function(e){var t,r,i,s;return e||(e=new Date),s=this.getStartAndEnd(e),i=s[0],t=s[1],r=this.model.get("id"),i=this.formatDate(new Date(i)),t=this.formatDate(new Date(t)),n("payment_usage",{projectId:r,startDate:i,endDate:t})},getStartAndEnd:function(e){var t,n,r,i;return e=new Date(e),r=e.getMonth(),i=e.getFullYear(),t=new Date(i,r,1),n=new Date(i,r+1,-1),void 0,[t,n]},renderUsageData:function(e){var n,i;return i=this,e||(e=n=new Date),i.$el.find(".table-head-fix").html($(MC.template.loadingSpinner()).css({margin:"80px auto"})),i.$el.find(".usage-pagination button").prop("disabled",!0),this.getUsage(e).then(function(n){var s,o,u,a,f;return a=i.model.get("payment"),_.isEmpty(n!=null?n.history_usage:void 0)?o="<div class='full-space'>"+r.IDE.NO_USAGE_REPORT+"</div>":(f=i.model.get("id"),_.each(n.history_usage,function(e,t){return delete n.history_usage[t],t=t.replace("-"+f,"").replace("RDS-",""),n.history_usage[t]=e}),o=t.usageTable({result:n})),i.$el.find(".table-head-fix").html(o),s=i.formatDate2(e),i.$el.find(".usage-date").text(s.string).data("date",e),u=i.getNewDate(1)>new Date,i.$el.find(".nav-left").prop("disabled",!1),i.$el.find(".nav-right").prop("disabled",u)},function(){return notification("error","Error while getting user payment info, please try again later.")}),this},formatDate:function(e){var t,n,r,i;return i=e.getFullYear(),r=e.getMonth()+1,r<10&&(r="0"+r),t=e.getDate(),t<10&&(t="0"+t),n=e.getHours(),n<10&&(n="0"+n),""+i+r+t+n},formatDate2:function(e){var t,n,r,i;return e=new Date(e),n=["January","February","March","April","May","June","July","August","September","October","November","December"],t=n[e.getMonth()%12],i=e.getFullYear(),void 0,r=""+t+", "+i,{string:r,date:e}},getNewDate:function(e){var t,n,r;return n=new Date($(".usage-date").data("date")),r=n.getFullYear(),t=n.getMonth()+e,new Date(r,t)},nextUsage:function(){var e;return e=this.getNewDate(1),this.renderUsageData(e)},prevUsage:function(){var e;return e=this.getNewDate(-1),this.renderUsageData(e)}})}),define("scenes/settings/ProjectSettings",["i18n!/nls/lang.js","./template/TplProject","./views/BasicSettingsView","./views/AccessTokenView","./views/BillingView","./views/TeamView","./views/ProviderCredentialView","./views/UsageReportView","backbone"],function(e,t,n,r,i,s,o,u){var a,f;return a={basicsettings:n,accesstoken:r,billing:i,team:s,credential:o,usagereport:u},f={basicsettings:"Basic Settings",accesstoken:"API Token",billing:"Billing",team:"Team",credential:"Cloud Access Credential",usagereport:"Usage Report"},Backbone.View.extend({events:{"click .function-list a":"loadSub"},initialize:function(e){var t;return t=this,this.settingsView=e.settingsView,this.listenTo(this.model,"change:name",this.updateProjectName),this.listenTo(this.model,"change:myRole",this.refresh,this)},render:function(e){return e==null&&(e="basicsettings"),this.setElement($(t(_.extend(this.model.toJSON(),{tab:e,admin:this.model.amIAdmin()})))),this.$(".project-subview").html(this.renderSub(e).el),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof Backbone.$?e:Backbone.$(e),this.el=this.$el,t!==!1&&this.delegateEvents(),this},refresh:function(){var e;return e=this.$(".function-list a.active").data("id"),this.settingsView.renderProject(this.model,e)},loadSub:function(e){var t;return t=$(e.currentTarget).data("id"),this.settingsView.navigate(t,this.model.id),this.$(".project-subview").html(this.renderSub(t).el)},renderSub:function(e){return this.setTitle(e),this.activeTab(e),this.subView&&this.subView.remove(),this.subView=new a[e]({model:this.model,settingsView:this.settingsView}),this.subView.render()},setTitle:function(e){var t,n;return t=this.model.get("name"),n=f[e],this.$("#title-project-name").text(t),this.$("#title-tab-name").text(n),this},activeTab:function(e){return this.$(".function-list a").each(function(){return $(this).data("id")===e?$(this).addClass("active"):$(this).removeClass("active")})},updateProjectName:function(){return this.$(".settings-nav-project-title").text(this.model.get("name")),this.$("#title-project-name").text(this.model.get("name"))}})}),define("scenes/settings/template/TplSettings",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\r\n        <a class="truncate" data-id="'+a((r=e&&e.id,typeof r===u?r.apply(e):r))+'">'+a((r=e&&e.name,typeof r===u?r.apply(e):r))+"</a>\r\n        ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<nav id="settings-nav">\r\n    <section>\r\n        <header>'+a(n.i18n.call(t,"HEAD_LABEL_SETTING",{hash:{},data:i}))+'</header>\r\n        <a class="active">'+a(n.i18n.call(t,"HEAD_LABEL_ACCOUNT",{hash:{},data:i}))+'</a>\r\n    </section>\r\n    <section class="project-list">\r\n        <header>'+a(n.i18n.call(t,"MANAGE_WORKSPACE",{hash:{},data:i}))+"</header>\r\n        ",o=n.each.call(t,t&&t.projects,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='\r\n    </section>\r\n</nav>\r\n<section class="setting-content">\r\n    <header>'+a(n.i18n.call(t,"HEAD_LABEL_ACCOUNT",{hash:{},data:i}))+'</header>\r\n    <dl class="settings-item">\r\n        <dt class="avatar"><img src="'+a((o=(o=t&&t.gravatar,o==null||o===!1?o:o.image),typeof o===u?o.apply(t):o))+'"></dt>\r\n        <dd class="change-photo">\r\n            <a id="change-photo" href="'+a((o=(o=t&&t.gravatar,o==null||o===!1?o:o.profile),typeof o===u?o.apply(t):o))+'" target="_blank" >'+a(n.i18n.call(t,"CHANGE_PHOTO",{hash:{},data:i}))+'</a>\r\n        </dd>\r\n    </dl>\r\n    <dl class="settings-item">\r\n        <dt>'+a(n.i18n.call(t,"HEAD_LABEL_ACCOUNT_USERNAME",{hash:{},data:i}))+"</dt><dd>"+a((o=t&&t.username,typeof o===u?o.apply(t):o))+'</dd>\r\n    </dl>\r\n\r\n    <dl class="settings-item accountFullNameRO">\r\n        <dt>'+a(n.i18n.call(t,"HEAD_LABEL_ACCOUNT_FULLNAME",{hash:{},data:i}))+'</dt><dd> <span class="fullNameText">'+a((o=t&&t.firstName,typeof o===u?o.apply(t):o))+" "+a((o=t&&t.lastName,typeof o===u?o.apply(t):o))+' </span> <button class="icon-edit link-style tooltip" data-tooltip=\''+a(n.i18n.call(t,"HEAD_LABEL_ACCOUNT_FULLNAME",{hash:{},data:i}))+'\' id="AccountFullName"></button></dd>\r\n    </dl>\r\n    <div id="AccountFullNameWrap" class="accountEditWrap settings-item">\r\n        <dl>\r\n            <dt>'+a(n.i18n.call(t,"FIRST_NAME",{hash:{},data:i}))+'</dt>\r\n            <dd><input type="text" class="input" id="AccountFirstName"/></dd>\r\n            <dt>'+a(n.i18n.call(t,"LAST_NAME",{hash:{},data:i}))+'</dt>\r\n            <dd><input type="text" class="input" id="AccountLastName"/></dd>\r\n        </dl>\r\n        <div id="AccountFullNameInfo" class="empty-hide"></div>\r\n        <div class="edit-actions">\r\n            <button class="btn btn-blue" id="AccountUpdateFullName" disabled>'+a(n.i18n.call(t,"HEAD_BTN_UPDATE",{hash:{},data:i}))+'</button>\r\n            <span id="AccountCancelFullName" class="cancel-button">'+a(n.i18n.call(t,"HEAD_BTN_CANCEL",{hash:{},data:i}))+'</span>\r\n        </div>\r\n    </div>\r\n\r\n    <dl class="settings-item accountEmailRO">\r\n        <dt>'+a(n.i18n.call(t,"HEAD_LABEL_ACCOUNT_EMAIL",{hash:{},data:i}))+'</dt>\r\n        <dd>\r\n            <span class="email-view">'+a((o=t&&t.email,typeof o===u?o.apply(t):o))+'</span>\r\n            <button class="icon-edit link-style tooltip" data-tooltip=\''+a(n.i18n.call(t,"HEAD_LABEL_NEW_EMAIL",{hash:{},data:i}))+'\' id="AccountEmail"></button>\r\n        </dd>\r\n    </dl>\r\n    <div id="AccountEmailWrap" class="accountEditWrap settings-item">\r\n        <dl>\r\n            <dt>'+a(n.i18n.call(t,"HEAD_LABEL_NEW_EMAIL",{hash:{},data:i}))+'</dt>\r\n            <dd><input type="string" class="input" id="AccountNewEmail" /></dd>\r\n\r\n            <dt>'+a(n.i18n.call(t,"HEAD_LABEL_CURRENT_PASSWORD",{hash:{},data:i}))+'</dt>\r\n            <dd><input type="password" class="input" id="AccountEmailPwd" /></dd>\r\n        </dl>\r\n\r\n      <div id="SettingErrorInfo" class="empty-hide"></div>\r\n\r\n      <div class="edit-actions">\r\n          <button class="btn btn-blue" id="AccountUpdateEmail" disabled>'+a(n.i18n.call(t,"HEAD_BTN_UPDATE",{hash:{},data:i}))+'</button>\r\n          <span id="AccountCancelEmail" class="cancel-button">'+a(n.i18n.call(t,"HEAD_BTN_CANCEL",{hash:{},data:i}))+'</span>\r\n      </div>\r\n    </div>\r\n\r\n    <button id="AccountPwd" class="link-style">'+a(n.i18n.call(t,"HEAD_LABEL_CHANGE_PASSWORD",{hash:{},data:i}))+'</button>\r\n    <div id="AccountPwdWrap" class="accountEditWrap settings-item">\r\n\r\n        <dl>\r\n            <dt>'+a(n.i18n.call(t,"HEAD_LABEL_CURRENT_PASSWORD",{hash:{},data:i}))+'</dt>\r\n            <dd><input type="password" class="input" id="AccountCurrentPwd" /></dd>\r\n\r\n            <dt>'+a(n.i18n.call(t,"HAED_LABEL_NEW_PASSWORD",{hash:{},data:i}))+'</dt>\r\n            <dd><input type="password" class="input" id="AccountNewPwd" /></dd>\r\n        </dl>\r\n\r\n        <div id="AccountInfo" class="empty-hide"></div>\r\n\r\n        <div class="edit-actions">\r\n            <button class="btn btn-blue" id="AccountUpdatePwd" disabled>'+a(n.i18n.call(t,"HEAD_BTN_UPDATE",{hash:{},data:i}))+'</button>\r\n        <span id="AccountCancelPwd" class="cancel-button">'+a(n.i18n.call(t,"HEAD_BTN_CANCEL",{hash:{},data:i}))+"</span>\r\n        </div>\r\n    </div>\r\n</section>",s};return e.template(t)});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("scenes/settings/GenericSettings",["i18n!/nls/lang.js","UI.modalplus","./ProjectSettings","./template/TplSettings","backbone"],function(e,t,n,r){var i;return i=Backbone.View.extend({events:{"click .project-list a":"renderProject","click .back-settings":"backToSettings","click #AccountEmail":"showEmail","click #AccountFullName":"showFullName","click #AccountPwd":"showPwd","click #AccountCancelPwd":"hidePwd","click #AccountUpdatePwd":"changePwd","click #AccountCancelEmail":"hideEmail","click #AccountUpdateEmail":"changeEmail","click #AccountCancelFullName":"hideFullName","change #AccountNewEmail, #AccountEmailPwd":"updateEmailBtn","keyup  #AccountNewEmail, #AccountEmailPwd":"updateEmailBtn","click #AccountUpdateFullName":"changeFullName","change #AccountFirstName, #AccountLastName":"updateFullNameBtn","keyup #AccountFirstName, #AccountLastName":"updateFullNameBtn","change #AccountCurrentPwd, #AccountNewPwd":"updatePwdBtn","keyup  #AccountCurrentPwd, #AccountNewPwd":"updatePwdBtn"},className:"fullpage-settings",initialize:function(e,t){var n,r;return e&&(this.projectId=e.projectId,n=(r=e.tab)!=null?r.toLowerCase():void 0,this.projectId&&!n&&(n=i.TAB.Project.BasicSettings)),this.scene=t.scene,this.projects=App.model.projects(),this.render(n)},render:function(e){var n,r;return e==null&&(e=i.TAB.Account),r=this,e===i.TAB.Account?n=this.renderSettings():n=this.renderProject(this.projects.get(this.projectId),e),n?(this.modal=new t({template:r.el,mode:"fullscreen",disableFooter:!0,compact:!0}),this.modal.on("close",function(){return r.scene.remove()}),this):!1},renderSettings:function(){var e;return e=_.extend({},App.user.toJSON()),e.gravatar=App.user.gravatar(),e.projects=this.projects.toJSON(),this.$el.html(r(e)),this},backToSettings:function(){return this.navigate(),this.renderSettings()},backToDefaultProject:function(){var e;return this.modal.close(),e=App.model.getPrivateProject(),Router.navigate("/workspace/"+e.id,{trigger:!0})},renderProject:function(t,r){var s,o;if(t&&t.currentTarget)s=$(t.currentTarget).data("id"),t=this.projects.get(s),this.navigate(i.TAB.Project.BasicSettings,s);else if(!t||__indexOf.call(_.values(i.TAB.Project),r)<0||!this.auth(t,r))return notification("error",e.IDE.PAGE_NOT_FOUND_WORKSPACE_TAB_NOT_EXIST),Router.navigate("/",{trigger:!0}),!1;return(o=this.projectView)!=null&&o.remove(),this.projectView=new n({model:t,settingsView:this}),this.$el.html(this.projectView.render(r).el)},remove:function(){var e,t;return(e=this.projectView)!=null&&e.remove(),(t=this.modal)!=null&&t.close(),Backbone.View.prototype.remove.apply(this,arguments)},navigate:function(e,t){var n;return n=this.url(e,t),Router.navigate(n)},url:function(e,t){return e?"/settings/"+t+"/"+e:"/settings"},auth:function(e,t){return e.amIAdmin()||t!==i.TAB.Project.Billing&&t!==i.TAB.Project.ProviderCredential},showEmail:function(){this.hideFullName(),$(".accountEmailRO").hide(),$("#AccountEmailWrap").show(),$("#AccountNewEmail").focus()},hideEmail:function(){$(".accountEmailRO").show(),$("#AccountEmailWrap").hide(),$("#AccountNewEmail, #AccountEmailPwd").val(""),$("#SettingErrorInfo").empty()},showFullName:function(){this.hideEmail(),$(".accountFullNameRO").hide(),$("#AccountFullNameWrap").show(),$("#AccountFirstName").val(App.user.get("firstName")||"").focus(),$("#AccountLastName").val(App.user.get("lastName")||"")},hideFullName:function(){return $(".accountFullNameRO").show(),$("#AccountFullNameWrap").hide(),$("#AccountFirstName, #AccountLastName").val(""),$("#AccountUpdateFullName").attr("disabled",!1)},showPwd:function(){this.$("#AccountPwd").hide(),this.$("#AccountPwdWrap").show(),this.$("#AccountCurrentPwd").focus()},hidePwd:function(){this.$("#AccountPwd").show(),this.$("#AccountPwdWrap").hide(),this.$("#AccountCurrentPwd, #AccountNewPwd").val(""),this.$("#AccountInfo").empty()},updatePwdBtn:function(){var e,t;t=this.$("#AccountCurrentPwd").val()||"",e=this.$("#AccountNewPwd").val()||"",t.length&&e.length?this.$("#AccountUpdatePwd").removeAttr("disabled"):this.$("#AccountUpdatePwd").attr("disabled","disabled")},updateEmailBtn:function(){var t,n,r,i;n=$("#AccountNewEmail").val()||"",r=$("#AccountEmailPwd").val()||"",i=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,t=i.test(n),n.length&&r.length>=6&&t?($("#AccountUpdateEmail").removeAttr("disabled"),$("#SettingErrorInfo").text("")):(t?$("#SettingErrorInfo").text(""):$("#SettingErrorInfo").text(e.IDE.SETTING_INVALID_EMAIL),$("#AccountUpdateEmail").attr("disabled","disabled"))},updateFullNameBtn:function(){var e,t;e=$("#AccountFirstName").val()||"",t=$("#AccountLastName").val()||"",e.length&&t.length?$("#AccountUpdateFullName").removeAttr("disabled"):$("#AccountUpdateFullName").attr("disabled","disabled")},changeFullName:function(){var t,n,r;r=this,t=$("#AccountFirstName").val()||"",n=$("#AccountLastName").val()||"";if(t&&n)return $("#AccountUpdateFullName").attr("disabled",!0),App.user.changeName(t,n).then(function(i){r.hideFullName(),$(".fullNameText").text(t+" "+n);if(i)return notification("info",e.NOTIFY.UPDATED_FULLNAME_SUCCESS),App.user.set("firstName",t),App.user.set("lastName",n)},function(t){return notification("error",e.NOTIFY.UPDATED_FULLNAME_FAIL),$("#AccountUpdateFullName").attr("disabled",!1),void 0})},changeEmail:function(){var t,n;t=$("#AccountNewEmail").val()||"",n=$("#AccountEmailPwd").val()||"",$("#SettingErrorInfo").empty(),$("#AccountUpdateEmail").attr("disabled","disabled"),App.user.changeEmail(t,n).then(function(){notification("info",e.NOTIFY.SETTINGS_UPDATE_EMAIL_SUCCESS),$("#AccountCancelEmail").click(),$(".accountEmailRO").find(".email-view").text(App.user.get("email"))},function(t){var n;switch(t.error){case 116:n=e.IDE.SETTINGS_UPDATE_EMAIL_FAIL3;break;case 117:n=e.IDE.SETTINGS_UPDATE_EMAIL_FAIL2;break;default:n=e.IDE.SETTINGS_UPDATE_EMAIL_FAIL1}return $("#SettingErrorInfo").text(n),$("#AccountUpdateEmail").removeAttr("disabled")})},changePwd:function(){var t,n,r;r=this,n=this.$("#AccountCurrentPwd").val()||"",t=this.$("#AccountNewPwd").val()||"";if(t.length<6){this.$("#AccountInfo").text(e.IDE.SETTINGS_ERR_INVALID_PWD);return}this.$("#AccountInfo").empty(),this.$("#AccountUpdatePwd").attr("disabled","disabled"),App.user.changePassword(n,t).then(function(){notification("info",e.NOTIFY.SETTINGS_UPDATE_PWD_SUCCESS),$("#AccountCancelPwd").click()},function(t){return t.error===2?r.modal.$("#AccountInfo").html(""+e.IDE.SETTINGS_ERR_WRONG_PWD+" <a href='/reset/' target='_blank'>"+e.IDE.SETTINGS_INFO_FORGET_PWD+"</a>"):r.modal.$("#AccountInfo").text(e.IDE.SETTINGS_UPDATE_PWD_FAILURE),r.modal.$("#AccountUpdatePwd").removeAttr("disabled")})}}),i.TAB={Account:"account",Project:{BasicSettings:"basicsettings",AccessToken:"accesstoken",Billing:"billing",Team:"team",ProviderCredential:"credential",UsageReport:"usagereport"}},i});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("scenes/Settings",["Scene","./settings/GenericSettings"],function(e,t){var n;return n=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,n),r.prototype.initialize=function(e){return this.view=new t(e,{scene:this}),this.activate()},r.prototype.isRemovable=function(){return!0},r.prototype.becomeActive=function(){return e.prototype.becomeActive.call(this)},r.prototype.becomeInactive=function(){return e.prototype.remove.call(this)},r.prototype.cleanup=function(){},r.prototype.isWorkingOn=function(e){return e==="AppSettings"},r}(e),n});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("scenes/StackStore",["ApiRequest","Scene","i18n!/nls/lang.js","backbone","UI.notification"],function(e,t,n){var r,i;return r=Backbone.View.extend({initialize:function(){return this.setElement($("<div class='global-loading'></div>").appendTo("#scenes"))}}),i=function(i){function s(e){var n;return n=App.sceneManager.find(e.id),n?(n.activate(),n):t.call(this,e)}return __extends(s,i),s.prototype.initialize=function(t){var n;return this.id=t.id,this.view=new r,this.activate(),n=this,e("stackstore_fetch_stackstore",{sub_path:"master/stack/"+this.id+"/"+this.id+".json"}).then(function(e){var t,r;try{r=JSON.parse(e),delete r.id,delete r.signature}catch(i){t=i,r=null,n.onParseError()}if(r)return n.onParseSuccess(r)},function(){return n.onLoadError()})},s.prototype.title=function(){return"Fetching Sample Stack"},s.prototype.url=function(){return"store/"+this.id},s.prototype.isWorkingOn=function(e){return e===this.id},s.prototype.onParseSuccess=function(e){return App.loadUrl(App.model.getPrivateProject().createStackByJson(e).url()),this.remove()},s.prototype.onLoadError=function(){return notification("error",n.NOTIFY.LOAD_SAMPLE_FAIL),this.remove()},s.prototype.onParseError=function(){return notification("error",n.NOTIFY.PARSE_SAMPLE_FAIL),this.remove()},s}(t),i}),define("scenes/CheatsheetTpl",["handlebars"],function(e){var t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="cheatsheet"> <div class="cheatsheet-wrap">\r\n\r\n  <section>\r\n    <h3 class="title">'+o(n.i18n.call(t,"KEY_TIT_STACK_APP_OP",{hash:{},data:i}))+'</h3>\r\n    <ul>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts"> <span class="shortcut">'+o(n.i18n.call(t,"KEY_PROP_KEY",{hash:{},data:i}))+'</span> </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_PROP_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts"> <span class="shortcut">'+o(n.i18n.call(t,"KEY_STAT_KEY",{hash:{},data:i}))+'</span> </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_STAT_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac">'+o(n.i18n.call(t,"KEY_DUPL_KEY_MAC",{hash:{},data:i}))+'</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_DUPL_KEY_MAC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_DUPL_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac">'+o(n.i18n.call(t,"KEY_DEL_KEY_MAC",{hash:{},data:i}))+'</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_DEL_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_DEL_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + S</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_SAVE_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_SAVE_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + '+o(n.i18n.call(t,"KEY_SCRL_KEY_MAC",{hash:{},data:i}))+'</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_SCRL_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_SCRL_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts"> <span class="shortcut">   </span> </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_NUDGE_ITEM_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n    </ul>\r\n  </section>\r\n\r\n  <section>\r\n    <h3 class="title">'+o(n.i18n.call(t,"KEY_TIT_STATE_GEN",{hash:{},data:i}))+'</h3>\r\n    <ul class="keys">\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts"> <span class="shortcut"> </span></div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_FOCUS_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts"> <span class="shortcut">'+o(n.i18n.call(t,"KEY_SELECT_KEY",{hash:{},data:i}))+'</span></div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_SELECT_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts"> <span class="shortcut">'+o(n.i18n.call(t,"KEY_EXPAND_KEY",{hash:{},data:i}))+'</span></div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_EXPAND_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts"> <span class="shortcut">'+o(n.i18n.call(t,"KEY_COLLAPSE_KEY",{hash:{},data:i}))+'</span></div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_COLLAPSE_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts"> <span class="shortcut">'+o(n.i18n.call(t,"KEY_NEXT_KEY",{hash:{},data:i}))+'</span></div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_NEXT_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts"> <span class="shortcut">'+o(n.i18n.call(t,"KEY_PREV_KEY",{hash:{},data:i}))+'</span></div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_PREV_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + E</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_CONTENT_EDITOR_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_CONTENT_EDITOR_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + I</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_INFO_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_INFO_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + L</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_LOG_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_LOG_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n    </ul>\r\n  </section>\r\n\r\n  <section>\r\n    <h3 class="title">'+o(n.i18n.call(t,"KEY_TIT_STATE_EDIT",{hash:{},data:i}))+'</h3>\r\n    <ul>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + A</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_SELECT_ALL_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_SELECT_ALL_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + D</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_DESELECT_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_DESELECT_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + Enter</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_CREATE_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_CREATE_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + Delete</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_DEL_STATE_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_DEL_STATE_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + </span>\r\n          <span class="shortcut mac"> + </span>\r\n          <span class="shortcut pc">Ctrl + </span>\r\n          <span class="shortcut pc">Ctrl + </span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_MOVE_FOCUS_STATE_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + C</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_COPY_STATE_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_COPY_STATE_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + V</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_PASTE_STATE_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_PASTE_STATE_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + Z</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_UNDO_STATE_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_UNDO_STATE_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n      <li class="shortcut-item">\r\n        <div class="shortcuts">\r\n          <span class="shortcut mac"> + Y</span>\r\n          <span class="shortcut pc">'+o(n.i18n.call(t,"KEY_REDO_STATE_KEY_PC",{hash:{},data:i}))+'</span>\r\n        </div>\r\n        <div class="shortcut-desc">'+o(n.i18n.call(t,"KEY_REDO_STATE_ACTION",{hash:{},data:i}))+'</div>\r\n      </li>\r\n    </ul>\r\n  </section>\r\n\r\n</div>\r\n<div class="icon-close-circle"></div>\r\n</div>',s};return e.template(t)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("scenes/Cheatsheet",["./CheatsheetTpl","Scene","i18n!/nls/lang.js"],function(e,t,n){var r,i;return r=Backbone.View.extend({events:{click:"clickBg","click .icon-close-circle":"clickBtn"},initialize:function(){return this.setElement($(e()).appendTo("#scenes"))},clickBg:function(e){$(e.target).hasClass("cheatsheet")&&this.trigger("close")},clickBtn:function(){return this.trigger("close")}}),i=function(e){function n(e){var n;return n=App.sceneManager.find("Cheatsheet"),n?n:t.call(this,e)}return __extends(n,e),n.prototype.initialize=function(){this.view=new r,this.listenTo(this.view,"close",this.remove)},n.prototype.url=function(){return"/cheatsheet"},n.prototype.isWorkingOn=function(e){return e==="Cheatsheet"},n.prototype.cleanup=function(){t.prototype.cleanup.call(this),App.sceneManager.activeScene().updateUrl()},n}(t),i}),define("scenes/Router",["scenes/ProjectScene","scenes/Settings","scenes/StackStore","scenes/Cheatsheet","backbone"],function(e,t,n,r){return Backbone.Router.extend({routes:{"":"openProject","workspace(/:project)":"openProject","workspace/:project/ops(/:ops)":"openProject",settings:"openSettings","settings/:projectId(/:tab)":"openSettings","store/:sampleId":"openStore",cheatsheet:"openCheatsheet"},openStore:function(e){return new n({id:e})},openSettings:function(e,n){return new t({tab:n,projectId:e})},openProject:function(t,n){return new e(t,n)},openCheatsheet:function(){return new r},start:function(){var e;Backbone.history.start({pushState:!0})||(void 0,this.navigate("/",{replace:!0,trigger:!0})),e=this,$(document).on("click","a.route",function(t){return e.onRouteClicked(t)}),this.route("workspace/:project/unsaved(/:ops)","openProject")},onRouteClicked:function(e){var t,n,r,i;n=$(e.currentTarget).attr("href"),t=Backbone.history.fragment,r=n[n.length-1];if(r==="/"||r==="\\")n=n.substring(0,n.length-1);return i=this.navigate(n,{replace:!0,trigger:!0}),i===!0?$(document).trigger("urlroute"):i===!1&&(void 0,this.navigate(t,{replace:!0})),!1}})}),define("scenes/Scenes",function(){});