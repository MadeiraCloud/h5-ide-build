(function(){define(["MC","event","handlebars","i18n!nls/lang.js","./view","canvas_layout","header","navigation","tabbar","dashboard","design_module","process","WS","constant","base_model","common_handle","validation","aws_handle"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){return{initialize:function(){var n,v,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,D,P,H,B,j,F,I,q;_.delay(function(){void 0;if(!e.data.is_loading_complete&&$("#loading-bar-wrapper").html().trim()!=="")return t.trigger(t.SWITCH_MAIN),notification("error",r.ide.IDE_MSG_ERR_CONNECTION,!0)},5e4),e.data.current_tab_id="dashboard",e.data.config={},B=p.REGION_KEYS;for(N=0,A=B.length;N<A;N++)y=B[N],e.data.config[y]={};e.data.dict_ami={},e.data.stack_list={},j=p.REGION_KEYS;for(C=0,O=j.length;C<O;C++)y=j[C],e.data.stack_list[y]=[];e.data.app_list={},F=p.REGION_KEYS;for(k=0,M=F.length;k<M;k++)y=F[k],e.data.app_list[y]=[];e.data.nav_new_stack_list={},e.data.nav_app_list={},e.data.nav_stack_list={},e.data.resource_list={},I=p.REGION_KEYS;for(L=0,D=I.length;L<D;L++)y=I[L],e.data.resource_list[y]={};e.data.untitled=0,e.tab={},e.process={},e.data.process={},e.storage.remove("process"),e.data.loading_wrapper_html=null,e.data.is_loading_complete=!1,e.data.resouceapi=[],e.data.ide_available_count=0,e.data.account_attribute={},q=p.REGION_KEYS;for(H=0,P=q.length;H<P;H++)y=q[H],e.data.account_attribute[y]={support_platform:"",default_vpc:"",default_subnet:{}};return e.data.demo_stack_list=p.DEMO_STACK_NAME_LIST,e.open_failed_list={},e.ta={},e.ta=m,e.ta.list=[],e.ta.state_list={},e.data.state={},e.data.stateClipboard=[],e.data.running_app_list={},e.data.open_tab_data={},h.websocketInit(),T=new h.WebSocket,n=!0,b=function(){return void 0,t.trigger(t.SWITCH_MAIN),require(["component/session/SessionDialog"],function(e){return new e})},w=function(){return T.status(!1,function(){return i.showDisconnected()}),T.status(!0,function(){return i.hideDisconnected()})},setTimeout(w,15e3),x=function(e){return void 0,void 0,b(),null},E=function(){return void 0,t.trigger(t.WS_COLLECTION_READY_REQUEST)},S=function(){return void 0,T.sub("request",$.cookie("usercode"),$.cookie("session_id"),null,E,x),T.sub("stack",$.cookie("usercode"),$.cookie("session_id"),null,null,null),T.sub("app",$.cookie("usercode"),$.cookie("session_id"),null,null,null),T.sub("status",$.cookie("usercode"),$.cookie("session_id"),null,null,null),T.sub("imports",$.cookie("usercode"),$.cookie("session_id"),null,null,null)},S(),e.data.websocket=T,t.onLongListen(t.RETURN_OVERVIEW_TAB,function(){return i.showOverviewTab()}),t.onLongListen(t.RETURN_REGION_TAB,function(){return i.showRegionTab()}),t.onLongListen(t.SWITCH_TAB,function(){return i.showTab()}),t.onLongListen(t.SWITCH_DASHBOARD,function(){return i.showDashbaordTab()}),t.onLongListen(t.SWITCH_PROCESS,function(){return i.showProcessTab()}),t.onLongListen(t.SWITCH_MAIN,function(){return i.showMain()}),t.onLongListen(t.SWITCH_LOADING_BAR,function(e,t){return i.showLoading(e,t)}),t.onLongListen(t.SWITCH_WAITING_BAR,function(){return i.toggleWaiting()}),t.onLongListen(t.HIDE_STATUS_BAR,function(){return i.hideStatubar()}),t.onLongListen(t.IDE_AVAILABLE,function(){void 0,e.data.ide_available_count=e.data.ide_available_count+1,void 0;if(e.data.ide_available_count===4)return t.trigger(t.SWITCH_MAIN)}),t.onLongListen(t.RECONNECT_WEBSOCKET,function(){return S()}),o.loadModule(),a.loadModule(),f.loadModule(),t.onListen(t.DASHBOARD_COMPLETE,function(){return void 0,u.loadModule()}),t.onListen(t.NAVIGATION_COMPLETE,function(){return void 0,l.loadModule(),setTimeout(function(){return void 0,s.canvas_initialize()},2e3)}),t.onListen(t.DESIGN_COMPLETE,function(){return void 0,c.loadModule()}),d.sub(function(e){var n,i,s;void 0;if(e.return_code===p.RETURN_CODE.E_SESSION)b(),e.param[0].method==="info"&&((s=e.param[0].url)==="/stack/"||s==="/app/")&&t.trigger(t.CLOSE_DESIGN_TAB,e.param[4][0]);else{i="ERROR_CODE_"+e.return_code+"_MESSAGE",void 0;if(e.error_message.indexOf("AWS was not able to validate the provided access credentials")!==-1)return;if(e.param[0].url==="/session/"&&e.param[0].method==="login")return;if(e.return_code===-1&&e.error_message==="200")return e.param[0].url==="/aws/"&&e.param[0].method==="resource"?notification("warning",r.service["ERROR_CODE_-1_MESSAGE_AWS_RESOURCE"]):notification("warning",r.service[i]),null;r.service[i]?n=r.service[i]+"("+e.return_code+")":n="unknown error ("+e.return_code+")",n&&$(".error_item").text().indexOf(n)===-1&&notification("error",n,!1)}return null}),g=function(){var n,r;return void 0,e.data.websocket.collection.request.find().fetch(),r=e.data.websocket.collection.request.find(),n=r.observeChanges({added:function(e,n){return t.trigger(t.UPDATE_REQUEST_ITEM,e,n)},changed:function(e,n){return t.trigger(t.UPDATE_REQUEST_ITEM,e,n)}}),null},g(),v=function(){var n,r;return void 0,e.data.websocket.collection.imports.find().fetch(),r=e.data.websocket.collection.imports.find(),n=r.observe({added:function(e,n){return t.trigger(t.UPDATE_IMPORT_ITEM,e)},changed:function(e,n){return t.trigger(t.UPDATE_IMPORT_ITEM,e)}}),null},v(),null}}})}).call(this);