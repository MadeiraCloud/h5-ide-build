(function(){define(["jquery","handlebars","MC","session_model","i18n!nls/lang.js","text!./js/login/template.html","common_handle","crypto"],function(e,t,n,r,i,s,o){return n.login=function(t){var s,u;return t.preventDefault(),e("#error-msg-1").removeClass("show"),e("#error-msg-2").removeClass("show"),e(".control-group").removeClass("error"),u=e("#login-user").val(),s=e("#login-password").val(),u===""?(t.preventDefault(),e(".error-msg").removeClass("show"),e(".control-group").first().removeClass("error"),e("#error-msg-2").addClass("show"),e(".control-group").first().addClass("error"),!1):(e("#login-btn").attr("value",i.login.login_waiting),e("#login-btn").attr("disabled",!0),r.login({sender:this},u,s),r.once("SESSION_LOGIN_RETURN",function(r){var i,s;return n.common.other.verify500(r),r.is_error?(t.preventDefault(),e(".error-msg").removeClass("show"),e(".control-group").first().removeClass("error"),e("#error-msg-1").addClass("show"),e("#login-btn").attr("value","Log In"),e("#login-btn").attr("disabled",!1),!1):(s=r.resolved_data,o.cookie.deleteCookie(),o.cookie.setCookie(s),o.cookie.setIDECookie(s),localStorage.setItem("email",n.base64Decode(o.cookie.getCookieByName("email"))),localStorage.setItem("user_name",o.cookie.getCookieByName("username")),i=function(){var t,r;return r="4tGsMJzq_2gJmwGDQgtP2En1rFlZEvBhWQWEOTKE",t=CryptoJS.HmacSHA256(n.base64Decode(e.cookie("email")),r),console.log("hash.toString(CryptoJS.enc.Hex) = "+t.toString(CryptoJS.enc.Hex)),t.toString(CryptoJS.enc.Hex)},localStorage.setItem("user_hash",i()),window.location.href="/ide.html",!0)}))},{ready:function(){var r;return t.registerHelper("i18n",function(e){return new t.SafeString(i.login[e])}),r={english:e.cookie("lang")==="en-us"},e("#main-body").html(t.compile(s)(r)),e("#login-btn").removeAttr("disabled"),e("#login-btn").addClass("enabled"),e("#login-form").submit(n.login),e("#footer .version").text("Version "+version),e("#footer .lang a").click(function(t){return e.cookie("lang",e(this).data("lang")),n.storage.set("language",e(this).data("lang")),window.location.reload(),!1}),!0}}})}).call(this);