(function(){define(["jquery","event","base_main","constant","UI.tabbar","UI.modal"],function(e,t,n,r){var i,s,o;return i=function(){return _.extend(this,n),null},i(),s=function(){return require(["tabbar_view","tabbar_model"],function(e,n){var i,o,u,a,f,l,c,h,p,d,v,m,g;g=loadSuperModule(s,"tabbar",e,null);if(!g)return;return g.on("SWITCH_DASHBOARD",function(e,t){return void 0,void 0,void 0,n.refresh(e,t,"dashboard")}),g.on("SWITCH_NEW_STACK_TAB",function(e,t,r){return void 0,void 0,void 0,void 0,n.set("tab_name",r),n.refresh(e,t,"new")}),g.on("SWITCH_STACK_TAB",function(e,t){return void 0,void 0,void 0,n.refresh(e,t,"stack")}),g.on("SWITCH_APP_TAB",function(e,t){return void 0,void 0,void 0,n.refresh(e,t,"app")}),g.on("SWTICH_PROCESS_TAB",function(e,t){return void 0,void 0,void 0,n.refresh(e,t,t.split("-")[0])}),g.on("SELECE_PLATFORM",function(e){return void 0,void 0,void 0,n.set("stack_region_name",g.temp_region_name),n.set("current_platform",e),MC.common.other.checkRepeatStackName(),Tabbar.add("new-"+MC.data.untitled+"-"+g.temp_region_name,"untitled-"+MC.data.untitled+" - stack"),modal.close()}),n.on("SWITCH_DASHBOARD",function(e){return void 0,t.trigger(t.SWITCH_DASHBOARD,null)}),n.on("OPEN_PROCESS",function(e){var n;return void 0,t.trigger(t.SWITCH_PROCESS,"OPEN_PROCESS",e),MC.common.other.processType(e)==="appview"?n="visualization":MC.common.other.processType(e)==="process"&&(n="pending"),t.trigger(t.UPDATE_DESIGN_TAB_ICON,n,e)}),n.on("OLD_STACK",function(e){return void 0,t.trigger(t.SWITCH_TAB,"OLD_STACK",e)}),n.on("OLD_PROCESS",function(e){return void 0,t.trigger(t.SWITCH_PROCESS,"OLD_PROCESS",e)}),n.on("OLD_APP",function(e){return void 0,t.trigger(t.SWITCH_TAB,"OLD_APP",e)}),n.on("SAVE_DESIGN_MODULE",function(e){return void 0,t.trigger(t.ADD_TAB_DATA,e)}),u=function(e){return void 0,void 0,void 0,void 0,void 0,t.trigger(t.SWITCH_LOADING_BAR,e),t.trigger(t.SWITCH_TAB,"NEW_STACK",n.get("tab_name").replace(" - stack",""),n.get("stack_region_name"),e,n.get("current_platform")),t.trigger(t.UPDATE_DESIGN_TAB_ICON,"stack",e),MC.data.nav_new_stack_list[e]={region:n.get("stack_region_name"),platform:n.get("current_platform"),tab_name:n.get("tab_name").replace(" - stack","")},null},c=function(e){var r;return void 0,e&&e.split("-")&&e.split("-")[0]&&(t.trigger(t.SWITCH_LOADING_BAR,e),e.split("-")[0]==="stack"?(n.once("GET_STACK_COMPLETE",function(r){return void 0,void 0,MC.common.other.isResultRight(r)===!0?(t.trigger(t.SWITCH_TAB,"OPEN_STACK",e,n.get("stack_region_name"),r,r.resolved_data[0].platform),t.trigger(t.UPDATE_DESIGN_TAB_ICON,"stack",e)):(t.trigger(t.CLOSE_DESIGN_TAB,r.param[4][0]),t.trigger(t.SWITCH_MAIN))}),n.getStackInfo(e)):e.split("-")[0]==="import"&&(r=this.get("import_stack"),e=e.replace("import","new"),r.resolved_data[0].id=e,MC.data.current_tab_id=e,g.updateCurrentTab(e,r.resolved_data[0].name+" - stack"),t.trigger(t.SWITCH_TAB,"OPEN_STACK",e,n.get("stack_region_name"),r,r.resolved_data[0].platform),t.trigger(t.UPDATE_DESIGN_TAB_ICON,"stack",e))),null},f=function(e){return void 0,n.once("GET_APP_COMPLETE",function(n){return void 0,void 0,MC.common.other.isResultRight(n)===!0?(t.trigger(t.SWITCH_TAB,"OPEN_APP",e,n.resolved_data[0].region,n,n.resolved_data[0].platform),t.trigger(t.UPDATE_DESIGN_TAB_ICON,n.resolved_data[0].state,e)):(t.trigger(t.CLOSE_DESIGN_TAB,n.param[4][0]),t.trigger(t.SWITCH_MAIN))}),n.getAppInfo(e),t.trigger(t.SWITCH_LOADING_BAR,e),null},n.on("NEW_STACK",u),n.on("OPEN_STACK",c),n.on("OPEN_APP",f),a=function(e){var t;return void 0,g.temp_region_name=e,t=n.checkPlatform(e),t===null?modal(MC.template.createNewStackErrorAndReload(),!0):g.openNewStackDialog(),null},h=function(e,t,r){return void 0,n.set("stack_region_name",t),Tabbar.open(r.toLowerCase(),e+" - stack"),null},l=function(e,t,r){return void 0,n.set("app_region_name",t),Tabbar.open(r.toLowerCase(),e+" - app"),null},o=function(e,t,n,r){var i,s,o,u;void 0;if(r==="process")return o="process-"+n+"-"+t,MC.common.other.addProcess(o,{tab_id:e,app_name:t,region:n,flag_list:{is_pending:!0}}),Tabbar.add(o,t+" - app");if(r==="appview")return s=MC.common.other.searchCacheMap({key:"origin_id",value:e}),_.isEmpty(s)?(u=MC.common.other.createUID(),i="process-"+u,MC.common.other.addCacheMap(u,i,e,n,"process")):i=s.type+"-"+s.uid,Tabbar.open(i,t+" - visualization")},v=function(e,t,r){return void 0,n.set("tab_name",e),n.set("stack_region_name",t),n.set("current_platform",r),u(e)},m=function(e,t){return void 0,n.set("stack_region_name",t),c(e)},p=function(e,t){return void 0,n.set("app_region_name",t),f(e)},d=function(e,n,r){var i;return void 0,i=MC.common.other.searchCacheMap({key:"origin_id",value:e}),void 0,t.trigger(t.SWITCH_TAB,"OPEN_APP",r,n,i.data,i.data.resolved_data[0].platform),t.trigger(t.UPDATE_DESIGN_TAB_ICON,"visualization",r),null},i=function(e){return void 0,n.set("stack_region_name",e.resolved_data[0].region),n.set("import_stack",e),Tabbar.open(e.resolved_data[0].id,e.resolved_data[0].name+" - stack"),null},t.onLongListen(t.OPEN_DESIGN_TAB,function(e,t,n,r){void 0;switch(e){case"NEW_STACK":return a(n);case"OPEN_STACK":return h(t,n,r);case"OPEN_APP":return l(t,n,r);case"NEW_PROCESS":return o(r,t,n,"process");case"NEW_APPVIEW":return o(r,t,n,"appview");case"RELOAD_STACK":return m(r,n);case"RELOAD_APP":return p(r,n);case"RELOAD_APPVIEW":return d(t,n,r);case"RELOAD_NEW_STACK":return v(r,n,t);case"IMPORT_STACK":return i(t);default:return void 0}}),t.onLongListen(t.CLOSE_DESIGN_TAB,function(e){return void 0,g.closeTab(e),null}),t.onLongListen(t.UPDATE_DESIGN_TAB,function(e,n,r){var i;return void 0,(MC.data.current_tab_id===r||r===void 0)&&MC.common.other.setCurrentTabId(e),i=g.updateCurrentTab(e,n,r),void 0,i!==e&&(t.trigger(t.ADD_TAB_DATA,e),t.trigger(t.DELETE_TAB_DATA,i)),null}),t.onLongListen(t.UPDATE_DESIGN_TAB_TYPE,function(e,t){return void 0,Tabbar.updateState(e,t)}),t.onLongListen(t.NAVIGATION_TO_DASHBOARD_REGION,function(){return void 0,Tabbar.open("dashboard"),null}),t.onLongListen(t.RETURN_REGION_TAB,function(e){return void 0,g.changeDashboardTabname(e),null}),t.onLongListen(t.RETURN_OVERVIEW_TAB,function(){return void 0,g.changeDashboardTabname("Global"),null}),t.onLongListen(t.UPDATE_APP_STATE,function(e,n){return void 0,e===r.APP_STATE.APP_STATE_TERMINATED&&(t.trigger(t.CLOSE_DESIGN_TAB,n),MC.common.other.deleteProcess(n)),null}),t.onLongListen(t.UPDATE_TAB_DATA,function(e,t){return g.updateCurrentTab(e,null,t),null}),g.render()})},o=function(){},{loadModule:s,unLoadModule:o}})}).call(this);