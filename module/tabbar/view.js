(function(){define(["event","./module/tabbar/template","backbone","jquery","handlebars","UI.tabbar"],function(e,t){var n;return n=Backbone.View.extend({el:$("#tab-bar"),template:t,events:{OPEN_TAB:"openTabEvent",CLOSE_TAB:"closeTabEvent",CLOSE_TAB_RESTRICTION:"closeTabRestrictionEvent"},initialize:function(){return $(document.body).on("click","#reload-account-attributes",this,this.reloadAccountAttributes),$(document.body).on("click","#close-tab-confirm",this,this.closeTabConfirmEvent),this.listenTo(e,"UPDATE_DESIGN_TAB_ICON",this.updateTabIcon)},render:function(){return void 0,$(this.el).html(this.template())},reloadAccountAttributes:function(){return window.location.reload()},openTabEvent:function(e,t,n){var r;void 0,void 0;if(t===n)return;MC.common.other.setCurrentTabId(n),r=n.split("-")[0];switch(r){case"dashboard":this.trigger("SWITCH_DASHBOARD",t,n);break;case"new":this.trigger("SWITCH_NEW_STACK_TAB",t,n,$("#tab-bar-"+n).find("a").attr("title"));break;case"stack":case"import":this.trigger("SWITCH_STACK_TAB",t,n);break;case"app":case"appview":this.trigger("SWITCH_APP_TAB",t,n);break;case"process":this.trigger("SWTICH_PROCESS_TAB",t,n);break;default:void 0}return null},updateCurrentTab:function(t,n,r){var i;return void 0,i=null,_.each($(".tabbar-group").children(),function(s){var o;void 0;if(r&&$(s).attr("id")!=="tab-bar-"+r)return;if(!r&&$(s).attr("class")!=="active")return;return $(s).attr("id","tab-bar-"+t),o=$($(s).find("a")[0]),i=o.attr("data-tab-id"),n&&o.attr("title",n),o.attr("data-tab-id",t),o.attr("href","#tab-content-"+t),n&&o.html(o.find("i").get(0).outerHTML+n),MC.common.other.isCurrentTab(t)&&e.trigger(e.UPDATE_DESIGN_TAB_TYPE,t,t.split("-")[0]),null}),i},updateTabIcon:function(e,t){return void 0,_.each($(".tabbar-group").children(),function(n){var r,i;r=$(n);if(r.attr("id")==="tab-bar-"+t){switch(e){case"stack":i="icon-stack-tabbar";break;case"visualization":i="icon-"+e+"-tabbar";break;default:i="icon-app-"+e.toLowerCase()}return r.find("i").removeClass(),r.find("i").addClass("icon-tabbar-label "+i)}})},updateTabCloseState:function(e){var t;return void 0,t=$("#tab-bar-"+e).children(".icon-close"),t.removeClass("close-restriction"),t.addClass("close-tab"),t.addClass("auto-close")},closeTabEvent:function(t,n){return void 0,e.trigger(e.DELETE_TAB_DATA,n),null},closeTabRestrictionEvent:function(e,t,n,r){var i,s;void 0;if((s=r.split("-")[0])==="process"||s==="appview"||r===MC.data.current_tab_id&&Tabbar.current==="app"){this.directCloseTab(r);return}return i=!0,MC.common.other.isCurrentTab(r)?i=MC.common.other.canvasData.isModified():i=MC.tab[r].design_model.isModified(),i?modal(MC.template.closeTabRestriction({tab_name:n,tab_id:r},!0)):this.directCloseTab(r),null},closeTabConfirmEvent:function(e){return void 0,e.data.directCloseTab($(e.currentTarget).attr("data-tab-id")),modal.close()},directCloseTab:function(t){return void 0,this.updateTabCloseState(t),_.delay(function(){return e.trigger(e.CLOSE_DESIGN_TAB,t)},150),null},closeTab:function(e){var t;void 0;if($("#tab-bar-"+e).length===0)return;return t=$($("#tab-bar-"+e).find("a")[1]),t.attr("class").indexOf("close-restriction")!==-1&&this.updateTabCloseState(e),_.delay(function(){return t.trigger("click")},150),null},changeDashboardTabname:function(e){return void 0,$("#tab-bar-dashboard").children().html('<i class="icon-dashboard icon-tabbar-label"></i>'+e),null},openNewStackDialog:function(){return void 0,this.trigger("SELECE_PLATFORM","ec2-vpc"),null}}),n})}).call(this);