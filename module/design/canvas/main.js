(function(){define(["event","i18n!nls/lang.js","constant"],function(e,t,n){var r,i;return r=function(){return require(["./module/design/canvas/view"],function(r){var i;return i=new r,i.render(),e.onLongListen(e.CREATE_DESIGN_OBJ,function(n,r,s,o,u){var a,f;void 0,i.reRender();if(r==="OPEN_STACK"||r==="OPEN_APP")if(MC.common.other.canvasData.get("bad")){notification("error",t.ide.IDE_MSG_ERR_OPEN_OLD_STACK_APP_TAB,!0),e.trigger(e.SWITCH_MAIN),o&&e.trigger(e.CLOSE_DESIGN_TAB,o);return}return f={mode:Tabbar.current==="new"?Design.MODE.Stack:Tabbar.current},Tabbar.current==="appview"?(MC.common.other.canvasData.init(u.resolved_data[0]),f.autoFinish=!1,MC.canvas.layout.init(),a=new Design(MC.common.other.canvasData.data(!0),f),void 0,MC.canvas.analysis(),a.finishDeserialization()):(MC.canvas.layout.init(),new Design(MC.common.other.canvasData.data(!0),f),void 0,r==="NEW_STACK"&&MC.aws.aws.enableStackAgent(!0),MC.common.other.canvasData.origin(MC.common.other.canvasData.data()),MC.ta.list=[]),e.trigger(e.OPEN_SUB_DESIGN,n,r,s,o,u),null}),e.onLongListen(e.RESTORE_CANVAS,function(){var e;return void 0,i.render(),e={mode:Tabbar.current},MC.canvas.layout.init(),new Design(MC.common.other.canvasData.origin(),e),void 0,MC.common.other.canvasData.origin(MC.common.other.canvasData.data()),null}),e.onLongListen(e.UPDATE_APP_STATE,function(e,t){return void 0,(e===n.APP_STATE.APP_STATE_STARTING||e===n.APP_STATE.APP_STATE_STOPPING||e===n.APP_STATE.APP_STATE_TERMINATING||e===n.APP_STATE.APP_STATE_UPDATING)&&MC.common.other.isCurrentTab(t)&&MC.common.other.canvasData.set("state",e),null})})},i=function(){},{loadModule:r,unLoadModule:i}})}).call(this);