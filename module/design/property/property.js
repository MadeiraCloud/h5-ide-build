(function(){define("module/design/property/base/main",["event","backbone"],function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p;return i=null,s=null,o=null,l=[].slice,e.onLongListen("all",function(e){var t,n;if((!i||!i.ideEvents)&&(!s||!s.ideEvents))return;return i&&i.ideEvents&&i.ideEvents.hasOwnProperty(e)&&(t=l.call(arguments,1),n=i.ideEvents[e],_.isString(n)&&(n=i[n]),n.apply(i,t)),s&&s.ideEvents&&s.ideEvents.hasOwnProperty(e)&&(t||(t=l.call(arguments,1)),n=s.ideEvents[e],_.isString(n)&&(n=s[n]),n.apply(s,t)),null}),a={},f=[],a.DEFAULT_TYPE="default",u={},r=function(){return this.type=r.TYPE.Stack,null},r.TYPE=r.prototype.TYPE={Stack:"Stack",App:"App",AppEdit:"AppEdit"},r.prototype.loadSubPanel=function(e,t){var r,s;s=u[e];if(!s)return;return r=new n,r.uid=t,r.property=s,r.type=e,r.tabType=i.type,h(r),null},r.extend=function(e,n){var i,s,o,l,c,h,p;o=t.Model.extend.call(r,e,n),s=new o;if(s.subPanelID)return u[s.subPanelID]=s,o;e.handleTypes===""?i=[a.DEFAULT_TYPE]:_.isString(e.handleTypes)||!e.handleTypes.hasOwnProperty("length")?i=[e.handleTypes]:i=e.handleTypes;for(h=0,p=i.length;h<p;h++){l=i[h];if(!l.hasOwnProperty("length")){f.push({regexp:l,prop:s});continue}l.indexOf(">")&&(c=l.split(">"),c.length===2&&c[1].length>0&&(a[c[1]+">"+c[0]]=s)),a[l]=s}return o},r.prototype.activeModule=function(){return i},r.prototype.activeSubModule=function(){return s},r.activeModule=r.prototype.activeModule,r.activeSubModule=r.prototype.activeSubModule,r.loadSubPanel=r.prototype.loadSubPanel,n=function(){var e;return e=this,_.each({_type:a.DEFAULT_TYPE,_uid:null,tabType:"",restore:!1,property:null},function(t,n){return e[n]=t,null}),Object.defineProperty(this,"type",{set:function(e){return e?(this._type=e,null):(this._uid="",null)},get:function(){return this._type}}),Object.defineProperty(this,"uid",{set:function(e){if(this._uid!=="")return this._uid=e,null},get:function(){return this._uid}}),void 0},r.load=function(e,t,r){var i,s;s=new n;if(arguments.length>1)s.type=e,s.uid=t,s.tabType=r;else{if(arguments.length!==1||!_.isObject(arguments[0]))return;_.each(arguments[0],function(e,t){return s[t]=e,null})}s.property=c(s),i=h(s);if(i!==!0)return i===!1?s.type="missing_resource":void 0,s.property=c(s),h(s)},c=function(e){var t,n,r,i,s,o,u,l;t=e.type,n=e.uid,o=e.tabType,r=t,i=a[t],i||(r=o+":"+t,i=a[r]);if(!i&&t.indexOf(!1))for(u=0,l=f.length;u<l;u++){s=f[u];if(t.match(s.regexp)){r=s.regexp,i=s.prop;break}}if(!i)return;return i.handle=r,i},h=function(e){var t,n,u,a,f,l;t=e.type,a=e.property,n=e.uid,l=e.tabType;if(!a)return!1;a.type=l,u="init"+a.type;if(!a[u])return;a.uid=n,f=a[u].call(a,n);if(f===!1)return;return u="setup"+a.type,a[u]&&(a[u].call(a),a[u]=null),a.subPanelID?(s=a,o=t):(s=null,o=null,i=a,i.comType=t),a.model.clear({silent:!0}),a.model.init(n)===!1?!1:(p(e.restore,a.model),a.view.model=a.model,a.view._isSub=!!a.subPanelID,a.view.__restore=r.__restore,r.__restore=!1,a.subPanelID?a.view._loadAsSub(a.subPanelID):a.view._load(),u="afterLoad"+a.type,a[u]&&a[u].call(a),!0)},p=function(e,t){var n,r;n=t.get("mid"),r=t.get("uid");if(e&&n)return n.length===38?MC.canvas.instanceList.selectById(r,n):MC.canvas.asgList.selectById(r,n)},r.onUnloadSubPanel=function(){return i.onUnloadSubPanel&&i.onUnloadSubPanel(s.subPanelID),s=null,o=null,null},r.snapshot=function(e){var t;return t={activeModuleType:i.comType,activeSubModuleType:o,activeModuleId:i.uid,activeSubModuleId:s?s.uid:null,tab_type:i.type,propertyTab:e.currentTab},t},r.restore=function(e,t){var n;return n={type:e.activeModuleType,uid:e.activeModuleId,tabType:e.tab_type,restore:!0},r.load(n),e.activeSubModuleType?(r.__restore=!0,r.loadSubPanel(e.activeSubModuleType,e.activeSubModuleId,!0),r.__restore=!1):r.event.trigger(r.event.HIDE_SUB_PANEL),null},r.event=_.extend({},t.Events),r.event.FORCE_SHOW="forceshow",r.event.HIDE_SUB_PANEL="hidesubpanel",r})}).call(this),define("module/design/property/template",["handlebars"],function(e){var t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<section class="property-panel-wrapper" id="property-first-panel">\n\n  <header class="property-sidebar-title sidebar-title truncate" id=\'property-title\'></header>\n  <div class="scroll-wrap scrollbar-auto-hide">\n    <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n    <div class="scroll-content property-content property-details"></div>\n  </div>\n</section>\n\n<section class="property-panel-wrapper" id="property-second-panel">\n  <div class="property-sidebar-title sidebar-title">\n    <a class="back tooltip icon-btn-back" data-tooltip="" href="#" id="hide-second-panel"></a><span id=\'property-second-title\' class="truncate"></span>\n  </div>\n  <div class="scroll-wrap scrollbar-auto-hide">\n    <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n    <div class="scroll-content property-content"></div>\n  </div>\n</section>\n'};return e.template(t)}),function(){define("module/design/property/view",["event","./base/main","constant","./template","Design","backbone","jquery","handlebars"],function(e,t,n,r,i){var s;return s=Backbone.View.extend({propertyHeadStateMap:{},events:{click:"test"},currentTab:"property",uid:null,type:null,initialize:function(){return $(document.body).on("click","#hide-property-panel",this.togglePropertyPanel).on("click",".option-group-head",_.bind(this.toggleOption,this)).on("click","#hide-second-panel",_.bind(this.hideSecondPanel,this)).on("click","#btn-switch-state, #btn-switch-property",_.bind(this.switchTab,this)),null},switchTab:function(e){var t;return t=e.currentTarget,t.id==="btn-switch-state"?this.currentTab!=="state"&&this.renderState(this.uid,this.type,!0):this.currentTab==="state"&&this.renderProperty(this.uid,this.type),this.renderStateCount(i.instance().component(this.uid))},showProperty:function(){return $("#property-panel").removeClass("state")},showState:function(){return $("#property-panel").addClass("state")},__hideResourcePanel:function(){var e;e=$("#hide-resource-panel");if(e.hasClass("icon-caret-left"))return e.click()},storeLast:function(e,t){return e&&(this.uid=e),t&&(this.type=t),null},renderProperty:function(e,t,n){var r;return $("#property-panel").removeClass("state").removeClass("state-wide"),!t&&e&&(r=i.instance().component(e),r&&(t=r.type)),this.initProperty(t,e,n),this.currentTab="property",this.showProperty(),this.storeLast(e,t),this},renderStateCount:function(e){var t;if(e)return t=e.get("state")&&e.get("state").length||0,$("#btn-switch-state b").text("("+t+")")},renderState:function(t,r,s){var o,u,a,f,l;this.__hideResourcePanel(),this.showState(),this.storeLast(t,r),this.currentTab="state",u=null,t||(t=i.instance().canvas.selectedNode[0],t&&(u=i.instance().component(t)));if(t){o=i.instance().component(t);if(o){r=o.type;if(!_.contains([n.RESTYPE.LC,n.RESTYPE.INSTANCE],r)){this.renderProperty(t);return}if(_.contains([n.RESTYPE.LC],r)){if(i.instance().modeIsApp()){a=i.instance().get("state"),a==="Stopped"&&e.trigger(e.OPEN_STATE_EDITOR,t);return}e.trigger(e.OPEN_STATE_EDITOR,t);return}}else i.instance().modeIsApp()&&(l=t,f=i.modelClassForType(n.RESTYPE.INSTANCE).getEffectiveId(l),t=f.uid)}return e.trigger(e.OPEN_STATE_EDITOR,t,l),s&&this.forceShow(),this},initProperty:function(e,n,r){var s,o,u,a;this.render(),this.load(),o=i.instance(),n?(s=o.component(n),s&&s.type===e&&o.modeIsApp()&&s.get("appId")&&!s.hasAppResource()&&(e="Missing_Resource")):e="Stack",o.modeIsApp()||o.modeIsAppView()?a=t.TYPE.App:o.modeIsStack()?a=t.TYPE.Stack:!s||s.get("appId")?a=t.TYPE.AppEdit:a=t.TYPE.Stack;try{t.load(e,n,a),this.afterLoad(),r&&this.forceShow()}catch(f){u=f,void 0}finally{}return null},render:function(){return $(document.activeElement).filter("input, textarea").blur(),$("#property-panel .sub-property").html(r()).removeClass("state state-wide"),this},restore:function(e){var t,n,r,i;return r=this.type=e.activeModuleType,t=this.currentTab=e.propertyTab,i=this.uid=e.activeModuleId,n=this.processState(i,r),t==="state"&&n?this.renderState(i):this.showProperty(),null},getModeAvai:function(e){var t;return t=null,i.instance().modeIsAppEdit()?e==="component_server_group"&&(t=!0):i.instance().modeIsApp()&&(e===n.RESTYPE.LC&&(t=!1),e==="component_server_group"&&(t=!1),i.instance().get("state")==="Stopped"&&(e===n.RESTYPE.LC?t=!0:e==="component_server_group"&&(t=!1))),t},processState:function(e,t){var r,s,o,u,a;return u=$("#property-panel"),e?(r=i.instance().component(e),!t&&r&&(t=r.type),a=_.contains([n.RESTYPE.LC,n.RESTYPE.INSTANCE,"component_server_group"],t),o=i.instance().get("agent").enabled,s=this.getModeAvai(t),o&&a&&this.renderStateCount(r),o&&(s===null&&a||s)?(setTimeout(function(){return u.removeClass("no-state")},0),!0):(setTimeout(function(){return u.addClass("no-state")},0),!1)):(setTimeout(function(){return u.addClass("no-state")},0),!1)},getCurrentCompUid:function(){var e;return e={},this.trigger("GET_CURRENT_UID",e),e.uid},togglePropertyPanel:function(e){return void 0,$("#property-panel").toggleClass("hidden").toggleClass("transition",!0),$("#hide-property-panel").toggleClass("icon-caret-left"),$("#hide-property-panel").toggleClass("icon-caret-right"),$("#status-bar-modal").toggleClass("toggle"),!1},toggleOption:function(e){var t,n,r,s,o,u,a,f,l;n=$(e.currentTarget);if(n.is("button")||n.is("a"))return;return a=n.hasClass("expand"),t=n.next(),a?t.css("display","block").slideUp(200):t.slideDown(200),n.toggleClass("expand"),f=i.instance().get("id"),this.propertyHeadStateMap[f]||(this.propertyHeadStateMap[f]={}),$("#property-second-panel").is(":hidden")&&(o=$("#property-panel").find(".option-group-head"),u=[],s=this.getCurrentCompUid(),s||(s=f),_.each(o,function(e){var t,n;return t=$(e),n=t.hasClass("expand"),u.push(n),null}),s&&(l=this.propertyHeadStateMap[f],l[s]=u,r=i.instance().component(s),r&&(l[r.type]=u))),!1},optionToggle:function(e){var t,n;t=$(this),n=t.prev();if(n.hasClass("expand"))return t.removeClass("transition").css({"max-height":"100000px",overflow:"visible"})},forceShow:function(e){return e==="property"?this.showProperty():e==="state"&&this.showState(),$("#property-panel").removeClass("hidden transition"),$("#hide-property-panel").removeClass("icon-caret-left").addClass("icon-caret-right"),null},showSecondPanel:function(){return $("#hide-second-panel").data("tooltip","Back to "+$("#property-title").text()),$("#property-second-panel").show().animate({left:"0%"},200),$("#property-first-panel").animate({left:"-30%"},200,function(){return $("#property-first-panel").hide()})},immShowSecondPanel:function(){return $("#hide-second-panel").data("tooltip","Back to "+$("#property-title").text()),$("#property-second-panel").show().css({left:"0%"}),$("#property-first-panel").css({left:"-30%",display:"none"}),null},hideSecondPanel:function(){var e;return e=$("#property-second-panel"),e.animate({left:"100%"},200,function(){return $("#property-second-panel").hide()}),$("#property-first-panel").show().animate({left:"0%"},200),this.trigger("HIDE_SUBPANEL"),!1},immHideSecondPanel:function(){return $("#property-second-panel").css({display:"none",left:"100%"}).children(".scroll-wrap").children(".property-content").empty(),$("#property-first-panel").css({display:"block",left:"0px"}),null},load:function(){return $(document.activeElement).filter("input, textarea").blur(),this.immHideSecondPanel(),null},afterLoad:function(){var e,t,n,r,s,o,u,a,f;o=MC.canvas_data.id;if($("#property-second-panel").is(":hidden")){n=this.getCurrentCompUid(),n||(n=o),s=null,u=this.propertyHeadStateMap[o],u&&(s=u[n],t=i.instance().component(n),!s&&t&&(s=u[t.type])),s&&(r=$("#property-panel").find(".option-group-head"),_.each(r,function(e,t){var n;return n=$(e),s[t]?n.addClass("expand"):n.removeClass("expand"),null})),f=this.propertyHeadStateMap[o];if(f)for(e in f){a=f[e];if(i.instance().component(e))continue;if(e===o||e.indexOf("i-")===0)continue;delete f[e]}}return null},showPropertyPanel:function(){void 0;if($("#hide-property-panel").hasClass("icon-caret-left"))return $("#hide-property-panel").trigger("click")}}),s})}.call(this),function(){define("module/design/property/base/view",["constant","i18n!nls/lang.js","backbone","jquery","handlebars","UI.selectbox","UI.notification","UI.multiinputbox","UI.modal","UI.selectbox","MC.validate","UI.parsley","UI.tooltip","UI.sortable","UI.tablist"],function(e,t){var n;return n=Backbone.View.extend({setTitle:function(e){$(this._isSub?"#property-second-title":"#property-title").text(e)},prependTitle:function(e){$(this._isSub?"#property-second-title":"#property-title").prepend(e)},forceShow:function(){return n.event.trigger(n.event.FORCE_SHOW),null},disabledAllOperabilityArea:function(e){var t;if(e){if($("#resource-panel").children(".disabled-event-layout").length)return;return t='<div class="disabled-event-layout"></div>',$("#resource-panel").append(t),$("#canvas").append(t),$("#tabbar-wrapper").append(t)}return $(".disabled-event-layout").remove()},checkResName:function(e,n){var r,i;return e.length||(e=$(e)),i=e.val(),n||(n=i),i&&!MC.validate("awsName",i)&&(r=sprintf(t.ide.PARSLEY_THIS_VALUE_SHOULD_BE_A_VALID_TYPE_NAME,n)),!r&&this.model.isNameDup(i)&&(r=sprintf(t.ide.PARSLEY_TYPE_NAME_CONFLICT,n,i)),!r&&this.model.isReservedName(i)&&(r=sprintf(t.ide.PARSLEY_TYPE_NAME_CONFLICT,n,i)),i.indexOf("elbsg-")===0&&(r=t.ide.PARSLEY_RESOURCE_NAME_ELBSG_RESERVED),e.parsley("custom",function(){return r}),e.parsley("validate")},_load:function(){var e,t;return t=$("#property-first-panel").find(".property-details"),e=$("<div class='scroll-content property-content property-details'></div>").insertAfter(t),t.empty().remove(),this.setElement(e),this.render(),this.focusImportantInput(),null},_loadAsSub:function(e){var t;return this.__restore?n.event.trigger(n.event.OPEN_SUBPANEL_IMM):n.event.trigger(n.event.OPEN_SUBPANEL),this.setElement($("#property-second-panel .property-content")),this.render(),t=this,setTimeout(function(){return t.focusImportantInput()},200),null},_render:function(){var t,n,r;r=this._originalRender(),selectbox.init();if(!_.isString(r))return r;n=this.model.get("uid");if(n){t=Design.instance().component(n);if(t&&t.type===e.RESTYPE.SG)return null}return this.setTitle(r),null},focusImportantInput:function(){var e,t;return t=this,e=t.$el.find("input[data-empty-remove]").filter(function(){return!this.value.length}),e.length&&setTimeout(function(){return t.forceShow(),e.focus(),t.disabledAllOperabilityArea(!0)},0),null}}),n.event=_.extend({},Backbone.Events),n.event.FORCE_SHOW="forceshow",n.event.OPEN_SUBPANEL="opensubpanel",n.event.OPEN_SUBPANEL_IMM="opensubpanelimm",n.extend=function(e,t){return e.render&&(e._originalRender=e.render,e.render=n.prototype._render),Backbone.View.extend.call(this,e,t)},n})}.call(this),function(){define("module/design/property/base/model",["backbone","Design"],function(e,t){var n;return n=e.Model.extend({init:function(){return null},setName:function(e){var n;return n=this.get("uid"),void 0,t.instance().component(n).setName(e),this.set("name",e),null},isNameDup:function(e){var n,r,i;return i=this.get("uid"),void 0,n=t.instance().component(i),n.get("name")===e?!1:(r=!1,t.instance().eachComponent(function(t){if(t.get("name")===e)return r=!0,!1}),r)},isReservedName:function(e){var t;t=!1;if(e==="self"||e==="this"||e==="global"||e==="meta"||e==="madeira")t=!0;return t}}),n})}.call(this),function(){define("module/design/property/stack/model",["../base/model","constant","Design"],function(e,t,n){var r,i;return i={"ec2-classic":"EC2 Classic","ec2-vpc":"EC2 VPC","default-vpc":"Default VPC","custom-vpc":"Custom VPC"},r=e.extend({init:function(){var e,r,s;return r=n.instance(),e=r.get("agent"),this.set({name:r.get("name").replace(/\s+/g,""),id:r.get("id"),usage:r.get("usage"),description:r.get("description"),type:i[r.type()],region:t.REGION_SHORT_LABEL[r.region()],isApp:this.isApp,isAppEdit:this.isAppEdit,isStack:this.isStack,isImport:r.modeIsAppView(),opsEnable:e.enabled}),s=n.modelClassForType(t.RESTYPE.VPC).theVPC(),s&&this.set("vpcid",s.get("appId")),this.getNetworkACL(),this.isApp?this.getAppSubscription():this.getSubscription(),this.isStack&&this.set("isStack",!0),this.set(n.instance().getCost()),null},addSubscription:function(e){var r,i,s,o,u,a,f;r=n.modelClassForType(t.RESTYPE.SUBSCRIPTION),u=this.get("subscription");if(!e.uid)o=new r(e),s=o.toJSON(),s.confirmed=!0,u.push(s);else{o=n.instance().component(e.uid),o.set("protocol",e.protocol),o.set("endpoint",e.endpoint);for(i=a=0,f=u.length;a<f;i=++a){s=u[i];if(s.id===e.uid){s.protocol=e.protocol,s.endpoint=e.endpoint,s.confirmed=e.confirmed;break}}}return null},deleteSNS:function(e){var t,r,i,s,o;i=this.get("subscription");for(t=s=0,o=i.length;s<o;t=++s){r=i[t];if(r.id===e){i.splice(t,1);break}}return n.instance().component(e).remove(),null},getSubscription:function(){var e,r,i,s,o,u,a;e=n.modelClassForType(t.RESTYPE.SUBSCRIPTION),r=n.modelClassForType(t.RESTYPE.TOPIC),o=_.map(e.allObjects(),function(e){return e.toJSON()}),s=this.getSubState();for(u=0,a=o.length;u<a;u++)i=o[u],s&&s[i.protocol+"-"+i.endpoint]===!1?i.confirmed=!1:i.confirmed=!0;return this.set("subscription",o),this.set("has_asg",r.isTopicNeeded()),null},getSubState:function(){var e,r,i,s,o,u,a,f;e=n.modelClassForType(t.RESTYPE.TOPIC),o=e.allObjects()[0],o&&(u=o.get("appId")),i=MC.data.resource_list[n.instance().region()].Subscriptions,s={};if(u&&i)for(a=0,f=i.length;a<f;a++)r=i[a],r.TopicArn===u&&(s[r.Protocol+"-"+r.Endpoint]=r.SubscriptionArn!=="PendingConfirmation");return s},getAppSubscription:function(){var e,r,i,s,o,u,a,f;e=n.modelClassForType(t.RESTYPE.TOPIC),o=e.allObjects()[0],o&&(u=o.get("appId"),this.set("snstopic",{name:o.get("name"),arn:u})),i=MC.data.resource_list[n.instance().region()].Subscriptions,s=[];if(u&&i)for(a=0,f=i.length;a<f;a++)r=i[a],r.TopicArn===u&&s.push({protocol:r.Protocol,endpoint:r.Endpoint,arn:r.SubscriptionArn,confirmed:r.SubscriptionArn!=="PendingConfirmation"});return this.set("subscription",s)},createAcl:function(){var e;return e=n.modelClassForType(t.RESTYPE.ACL),(new e).id},getNetworkACL:function(){var e,r,i;return e=n.modelClassForType(t.RESTYPE.ACL),i=[],r=null,_.each(e.allObjects(),function(e){return function(t){var n,s;return s=!0,e.isApp?s=!1:t.isDefault()?s=!1:e.isAppEdit&&(s=!t.get("appId")),n={uid:t.id,name:t.get("name"),rule:t.getRuleCount(),association:t.getAssoCount(),deletable:s},t.isDefault()?r=n:i.splice(_.sortedIndex(i,n,"name"),0,n),null}}(this)),r&&i.splice(0,0,r),this.set("networkAcls",i),null},removeAcl:function(e){return n.instance().component(e).remove(),this.getNetworkACL(),null}}),new r})}.call(this),define("module/design/property/stack/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <dl class="dl-horizontal dl-region-type property-control-group">\n    <dt><label>'+u(n.i18n.call(e,"PROP_STACK_LBL_REGION",{hash:{},data:t}))+"</label></dt>\n    <dd>"+u((i=e&&e.region,typeof i===a?i.apply(e):i))+"</dd>\n    <dt><label>"+u(n.i18n.call(e,"PROP_STACK_LBL_TYPE",{hash:{},data:t}))+"</label></dt>\n    <dd>"+u((i=e&&e.type,typeof i===a?i.apply(e):i))+"</dd>\n    ",i=n["if"].call(e,e&&e.usage,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n    <dt><label>"+u(n.i18n.call(e,"PROP_STACK_LBL_DESC",{hash:{},data:t}))+"</label></dt>\n    <dd>"+u((i=e&&e.description,typeof i===a?i.apply(e):i))+"</dd>\n  </dl>\n  ",r}function c(e,t){var r="",i;return r+="\n    <dt><label>"+u(n.i18n.call(e,"PROP_STACK_LBL_USAGE",{hash:{},data:t}))+'</label></dt>\n    <dd style="text-transform: capitalize">'+u((i=e&&e.usage,typeof i===a?i.apply(e):i))+"</dd>\n    ",r}function h(e,t){var r="",i;return r+='\n	<section class="property-control-group" data-bind="true">\n		<label class="left" for="property-stack-name">'+u(n.i18n.call(e,"PROP_STACK_LBL_NAME",{hash:{},data:t}))+'</label>\n		<input class="input" type="text" data-ignore="true" data-required-rollback="true" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-stack-name">\n	</section>\n    <section class="property-control-group" data-bind="true">\n        <label for="property-stack-description">'+u(n.i18n.call(e,"PROP_STACK_LBL_DESCRIPTION",{hash:{},data:t}))+'</label>\n        <textarea name="" id="property-stack-description" cols="30" rows="7">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+'</textarea>\n    </section>\n	<dl class="dl-horizontal dl-region-type property-control-group">\n		<dt><label>'+u(n.i18n.call(e,"PROP_STACK_LBL_REGION",{hash:{},data:t}))+"</label></dt><dd>"+u((i=e&&e.region,typeof i===a?i.apply(e):i))+"</dd>\n		<dt><label>"+u(n.i18n.call(e,"PROP_STACK_LBL_TYPE",{hash:{},data:t}))+"</label></dt><dd>"+u((i=e&&e.type,typeof i===a?i.apply(e):i))+"</dd>\n	</dl>\n  ",r}function p(e,t){var r="",i;r+='\n	<div class="option-group-head pos-r">'+u(n.i18n.call(e,"PROP_STACK_TIT_ACL",{hash:{},data:t}))+'<span class="property-head-num-wrap">('+u((i=(i=e&&e.networkAcls,i==null||i===!1?i:i.length),typeof i===a?i.apply(e):i))+')</span>\n	</div>\n	<div class="option-group">\n    <ul class="acl-sg-info-list acl-info-list property-list" id="stack-property-acl-list"></ul>\n    ',i=n.unless.call(e,e&&e.isApp,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n  </div>\n	",r}function d(e,t){var r="";return r+='<a href="#" class="add-to-list action-link" id="stack-property-new-acl">'+u(n.i18n.call(e,"PROP_STACK_BTN_CREATE_NEW_ACL",{hash:{},data:t}))+"</a>",r}function v(e,t){var r="",i;r+='\n  <div class="option-group-head">'+u(n.i18n.call(e,"PROP_STACK_TIT_SNS",{hash:{},data:t}))+'<span class="property-head-num-wrap">(',i=n["if"].call(e,e&&e.subscription,{hash:{},inverse:f.program(12,g,t),fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;r+=')</span></div>\n  <div class="option-group">\n    ',i=n["if"].call(e,e&&e.subscription,{hash:{},inverse:f.program(20,S,t),fn:f.program(14,y,t),data:t});if(i||i===0)r+=i;return r+="\n  </div>\n  ",r}function m(e,t){var n;return u((n=(n=e&&e.subscription,n==null||n===!1?n:n.length),typeof n===a?n.apply(e):n))}function g(e,t){return"0"}function y(e,t){var r="",i;r+='\n    <div class="property-group-head">SNS Topic</div>\n    <div class="property-control-group">\n      <dl class="dl-vertical">\n        <dt>SNS Topic Name</dt>\n        <dd>'+u((i=(i=e&&e.snstopic,i==null||i===!1?i:i.name),typeof i===a?i.apply(e):i))+'</dd>\n        <dt>SNS Topic ARN</dt>\n        <dd class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:t}))+'">'+u((i=(i=e&&e.snstopic,i==null||i===!1?i:i.arn),typeof i===a?i.apply(e):i))+'</dd>\n      </dl>\n    </div>\n    <div class="property-group-head">Subscription</div>\n    <ul class="property-list">\n    ',i=n.each.call(e,e&&e.subscription,{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+="\n    </ul>\n    ",r}function b(e,t){var r="",i;r+='\n      <li>\n        <dl class="dl-horizontal dl-region-type">\n          <dt><label>Protocol</label></dt><dd class="protocol">'+u((i=e&&e.protocol,typeof i===a?i.apply(e):i))+'</dd>\n          <dt><label>Endpoint</label></dt><dd class="endpoint truncate">'+u((i=e&&e.endpoint,typeof i===a?i.apply(e):i))+'</dd>\n          <dt><label>Confirmed</label></dt><dd class="">',i=n["if"].call(e,e&&e.confirmed,{hash:{},inverse:f.program(18,E,t),fn:f.program(16,w,t),data:t});if(i||i===0)r+=i;return r+="</dd>\n        </dl>\n      </li>\n    ",r}function w(e,t){return"True"}function E(e,t){return"False"}function S(e,t){var r="";return r+='\n    <div class="property-control-group">\n      <p class="property-info tac">'+u(n.i18n.call(e,"PROP_APP_SNS_NONE",{hash:{},data:t}))+"</p>\n    </div>\n    ",r}function x(e,t){var r="",i;r+='\n	<div class="option-group-head">'+u(n.i18n.call(e,"PROP_STACK_TIT_SNS",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-stack-sns-num">'+u((i=(i=e&&e.subscription,i==null||i===!1?i:i.length),typeof i===a?i.apply(e):i))+'</span>)</span></div>\n  <div class="option-group">\n\n  	<ul id="property-sub-list" class="property-list">\n      <li class="pos-r hide">\n      	<dl class="dl-horizontal dl-region-type">\n	        <dt><label>Protocol</label></dt><dd class="protocol"></dd>\n	        <dt><label>Endpoint</label></dt><dd class="endpoint truncate"></dd>\n        </dl>\n        <div class="sns-action">\n          ',i=n["if"].call(e,e&&e.isStack,{hash:{},inverse:f.program(25,N,t),fn:f.program(23,T,t),data:t});if(i||i===0)r+=i;r+="\n        </div>\n      </li>\n      ",i=n.each.call(e,e&&e.subscription,{hash:{},inverse:f.noop,fn:f.program(30,L,t),data:t});if(i||i===0)r+=i;return r+='\n  	</ul>\n\n    <section class="property-sns-info property-control-group">\n      <div id="property-sns-no-sub-no-asg" class="property-info" >\n        <p>SNS is available for auto scaling group notification and scaling policy.</p>\n        <p>You can enable auto scaling group to send notification via SNS Topic</p>\n      </div>\n\n      <div id="property-sns-no-asg" class="property-info"><p>There is no auto scaling group in this stack using notification. If there is no usage of SNS topic, the topic will not be created when the stack runs into an app.</p></div>\n\n      <div id="property-sns-no-sub"><p class="property-warning">There is auto scaling group relay on SNS Topic to receive notification. Yet no subscription is set up. </p></div>\n    </section>\n	<div class="tac property-control-group"><button id="property-create-asg" class="btn btn-blue" style="width:180px">'+u(n.i18n.call(e,"PROP_STACK_BTN_ADD_SUB",{hash:{},data:t}))+"</button></div>\n  </div>\n  ",r}function T(e,t){return'\n            <i class="icon-del icon-remove"></i>\n          '}function N(e,t){var r="",i;r+="\n            ",i=n["if"].call(e,e&&e.confirmed,{hash:{},inverse:f.program(28,k,t),fn:f.program(26,C,t),data:t});if(i||i===0)r+=i;return r+="\n          ",r}function C(e,t){return'\n              <i class="icon-del icon-remove"></i>\n            '}function k(e,t){var r="";return r+='\n              <i class="icon-pending tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_STACK_PENDING_CONFIRM",{hash:{},data:t}))+'" ></i>\n            ',r}function L(e,t){var r="",i;r+='\n      <li class="pos-r" data-uid="'+u((i=e&&e.id,typeof i===a?i.apply(e):i))+'">\n        <dl class="dl-horizontal dl-region-type">\n	        <dt><label>Protocol</label></dt><dd class="protocol">'+u((i=e&&e.protocol,typeof i===a?i.apply(e):i))+'</dd>\n	        <dt><label>Endpoint</label></dt><dd class="endpoint truncate">'+u((i=e&&e.endpoint,typeof i===a?i.apply(e):i))+'</dd>\n        </dl>\n        <div class="sns-action">\n          ',i=n["if"].call(e,e&&e.isStack,{hash:{},inverse:f.program(25,N,t),fn:f.program(23,T,t),data:t});if(i||i===0)r+=i;return r+="\n        </div>\n      </li>\n      ",r}function A(e,t){var r="",i;r+="$"+u((i=e&&e.totalFee,typeof i===a?i.apply(e):i))+"/",i=n.i18n.call(e,"PROP_STACK_LBL_COST_CYCLE",{hash:{},data:t});if(i||i===0)r+=i;return r+=" ",r}function O(e,t){var n="",r;return n+="\n        <tr> <td>"+u((r=e&&e.resource,typeof r===a?r.apply(e):r))+"</td> <td>"+u((r=e&&e.type,typeof r===a?r.apply(e):r))+"</td> <td>"+u((r=e&&e.formatedFee,typeof r===a?r.apply(e):r))+"</td> </tr>\n      ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+="<article>\n\n  ",o=n.unless.call(t,t&&t.isStack,{hash:{},inverse:f.program(4,h,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n	<!-- SG, ACL, COST -->\n	<div class="option-group-head">'+u(n.i18n.call(t,"PROP_STACK_TIT_SG",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n\n\n	',o=n["if"].call(t,t&&t.networkAcls,{hash:{},inverse:f.noop,fn:f.program(6,p,i),data:i});if(o||o===0)s+=o;s+="\n\n\n  ",o=n["if"].call(t,t&&t.isApp,{hash:{},inverse:f.program(22,x,i),fn:f.program(9,v,i),data:i});if(o||o===0)s+=o;s+='\n\n\n	<div class="option-group-head">\n		'+u(n.i18n.call(t,"PROP_STACK_TIT_COST_ESTIMATION",{hash:{},data:i}))+'\n		<span class="cost-counter right">',o=n["if"].call(t,t&&t.totalFee,{hash:{},inverse:f.noop,fn:f.program(32,A,i),data:i});if(o||o===0)s+=o;s+='</span>\n	</div>\n	<div class="option-group">\n		<table class="table cost-estimation-table">\n			<thead> <tr>\n					<th>'+u(n.i18n.call(t,"PROP_STACK_COST_COL_RESOURCE",{hash:{},data:i}))+'</th>\n          <th style="min-width:70px;">'+u(n.i18n.call(t,"PROP_STACK_COST_COL_SIZE_TYPE",{hash:{},data:i}))+'</th>\n          <th style="min-width:60px;">'+u(n.i18n.call(t,"PROP_STACK_COST_COL_FEE",{hash:{},data:i}))+"</th>\n			</tr> </thead>\n			<tbody> ",o=n.each.call(t,t&&t.costList,{hash:{},inverse:f.noop,fn:f.program(34,O,i),data:i});if(o||o===0)s+=o;return s+=' </tbody>\n\n		</table>\n		<div class="property-control-group tac">\n			<a target="_blank" href="http://aws.amazon.com/ec2/pricing/" class="goto-outsite tac" target="_blank">AWS EC2 Pricing</a>\n		</div>\n	</div>\n\n</article>\n\n\n',s};return e.template(t)}),define("module/design/property/stack/template/acl",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='<li data-uid="'+a((i=e&&e.uid,typeof i===u?i.apply(e):i))+'">\n<div class="col3 edit icon-btn-details tooltip" data-tooltip=\''+a(n.i18n.call(e,"PROP_STACK_ACL_TIP_DETAIL",{hash:{},data:t}))+'\' ></div>\n<div class="col2">\n	<div class="col2-1 truncate">'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'</div>\n	<div class="col2-2 truncate">'+a((i=e&&e.rule,typeof i===u?i.apply(e):i))+" "+a(n.i18n.call(e,"PROP_STACK_ACL_LBL_RULE",{hash:{},data:t}))+", "+a((i=e&&e.association,typeof i===u?i.apply(e):i))+" "+a(n.i18n.call(e,"PROP_STACK_ACL_LBL_ASSOC",{hash:{},data:t}))+" ",i=n["if"].call(e,e&&e.deletable,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+=" </div>\n</div>\n</li>",r}function c(e,t){var r="",i;return r+=' | <a class="sg-list-delete-btn" data-name="'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'" data-count="'+a((i=e&&e.association,typeof i===u?i.apply(e):i))+'">'+a(n.i18n.call(e,"PROP_STACK_ACL_BTN_DELETE",{hash:{},data:t}))+"</a>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;o=n.each.call(t,t&&t.networkAcls,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n",s};return e.template(t)}),define("module/design/property/stack/template/sub",["handlebars"],function(e){var t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div style="width:420px">\n   <div class="modal-header">\n      <h3>'+a((o=t&&t.title,typeof o===u?o.apply(t):o))+' SNS Subscription</h3>\n      <i class="modal-close">&times;</i>\n   </div>\n   <div class="modal-body" id="property-asg-sns-modal" data-uid='+a((o=t&&t.uid,typeof o===u?o.apply(t):o))+'>\n      <div class="modal-control-group modal-sns-protocol">\n        <label class="label-short">Protocol</label>\n        <div class="selectbox">\n          <div class="selection">'+a((o=t&&t.protocol,typeof o===u?o.apply(t):o))+'</div>\n          <ul class="dropdown" tabindex="-1">\n            <li class="item" data-id="https">HTTPS</li>\n            <li class="item" data-id="http">HTTP</li>\n            <li class="item" data-id="email">Email</li>\n            <li class="item" data-id="email-json">Email-JSON</li>\n            <li class="item" data-id="sms">SMS</li>\n            <li class="item" data-id="arn">Application</li>\n            <li class="item" data-id="sqs">Amazon SQS</li>\n          </ul>\n        </div>\n      </div>\n      <div class="modal-control-group">\n        <label class="label-short" for="property-asg-endpoint">Endpoint</label>\n        <div class="property-asg-ep" data-bind="true">\n          <input type="text" class="input" id="property-asg-endpoint" value="'+a((o=t&&t.endpoint,typeof o===u?o.apply(t):o))+'" max-length="255" data-required="true" data-trigger="change">\n        </div>\n      </div>\n\n    </section>\n\n   </div>\n   <div class="modal-footer">\n      <button id="property-asg-sns-done" class="btn btn-blue">Done</button>\n      <button class="btn modal-close btn-silver">Cancel</button>\n   </div>\n</div>\n',s};return e.template(t)}),function(){define("module/design/property/stack/view",["../base/view","./template/stack","./template/acl","./template/sub","event","i18n!nls/lang.js"],function(e,t,n,r,i,s){var o;return o=e.extend({events:{"change #property-stack-name":"stackNameChanged","change #property-stack-description":"stackDescriptionChanged","click #stack-property-new-acl":"createAcl","click #stack-property-acl-list .edit":"openAcl","click .sg-list-delete-btn":"deleteAcl","click #property-sub-list .icon-edit":"editSNS","click #property-sub-list .icon-del":"delSNS","click #property-create-asg":"openSNSModal"},render:function(){var e,n,r;return n=t,this.model.isApp||this.model.isAppEdit?this.model.attributes.isImport?(e='<header class="property-sidebar-title sidebar-title truncate" id="property-title">Visualization - '+this.model.attributes.vpcid+'<i class="icon-info tooltip property-header-info" data-tooltip="Currently you can rearrange the layout of visualisation and export it as PNG image file. Future version will include the feature to import VPC resource as an app. "></i></header>',$("#property-title").html(e)):r="App - "+this.model.get("name"):r="Stack - "+this.model.get("name"),void 0,this.$el.html(t(this.model.attributes)),r&&this.setTitle(r),this.refreshACLList(),this.model.isApp||this.updateSNSList(this.model.get("subscription"),!0),null},stackDescriptionChanged:function(){var e,t,n;t=$("#property-stack-description"),n=this.model.get("id"),e=t.val();if(t.parsley("validate"))return this.trigger("STACK_DESC_CHANGED",e)},stackNameChanged:function(){var e,t,n;return n=$("#property-stack-name"),t=this.model.get("id"),e=n.val(),n.parsley("custom",function(n){if(!MC.validate("awsName",n))return s.ide.PARSLEY_SHOULD_BE_A_VALID_STACK_NAME;if(!MC.aws.aws.checkStackName(t,n))return sprintf(s.ide.PARSLEY_TYPE_NAME_CONFLICT,"Stack",e)}),n.parsley("validate")&&(this.trigger("STACK_NAME_CHANGED",e),this.setTitle("Stack - "+e)),null},refreshACLList:function(){return $("#stack-property-acl-list").html(n(this.model.attributes))},createAcl:function(){return this.trigger("OPEN_ACL",this.model.createAcl())},openAcl:function(e){return this.trigger("OPEN_ACL",$(e.currentTarget).closest("li").attr("data-uid")),null},updateSNSList:function(e,t){var n,r,i,s,o,u,a;s=this.model.get("has_asg"),$(".property-sns-info").children().hide(),!e||!e.length?s?$("#property-sns-no-sub").show():$("#property-sns-no-sub-no-asg").show():s||$("#property-sns-no-asg").show();if(t)return;r=$("#property-sub-list"),r.find("li:not(.hide)").remove(),i=r.find(".hide");for(u=0,a=e.length;u<a;u++)o=e[u],n=i.clone().removeClass("hide").appendTo(r),n.attr("data-uid",o.id),n.find(".protocol").html(o.protocol),n.find(".endpoint").html(o.endpoint),o.confirmed!==null&&o.confirmed===!1?n.find(".sns-action").html('<i class="icon-pending tooltip" data-tooltip="pendingConfirm" ></i>'):n.find(".sns-action").html('<i class="icon-del icon-remove"></i>');return $("#property-stack-sns-num").html(e.length),null},delSNS:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.attr("data-uid"),t.remove(),this.updateSNSList($("#property-sub-list").children(":not(.hide)"),!0),this.model.deleteSNS(n)},editSNS:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n={title:"Edit",uid:t.attr("data-uid"),protocol:t.find(".protocol").text(),endpoint:t.find(".endpoint").text()},this.openSNSModal(e,n),null},saveSNS:function(e){var t;e.uid&&(t=$("#property-sub-list").children("li[data-uid='"+e.uid+"']"),t.find(".protocol").html(e.protocol),t.find(".endpoint").html(e.endpoint),e.confirmed!==null&&e.confirmed===!1?t.find(".sns-action").html('<i class="icon-pending tooltip" data-tooltip="pendingConfirm" ></i>'):t.find(".sns-action").html('<i class="icon-del icon-remove"></i>')),this.model.addSubscription(e);if(!e.uid)return this.updateSNSList(this.model.get("subscription"))},openSNSModal:function(e,t){var n,i,o;return t||(t={protocol:"email",title:"Add"}),modal(r(t)),n=$("#property-asg-sns-modal"),n.find(".dropdown").find(".item").each(function(){if($(this).data("id")===t.protocol)return $(this).addClass("selected").parent().siblings().text($(this).text())}),o=function(e){var t,r,i,o,u;t=$(".property-asg-ep");switch(n.find(".selected").data("id")){case"sqs":o=s.ide.PROP_STACK_AMAZON_ARN,u=s.ide.PROP_STACK_SQS,i=s.ide.PARSLEY_PLEASE_PROVIDE_A_VALID_AMAZON_SQS_ARN;break;case"arn":o=s.ide.PROP_STACK_AMAZON_ARN,u=s.ide.PROP_STACK_ARN,i=s.ide.PARSLEY_PLEASE_PROVIDE_A_VALID_APPLICATION_ARN;break;case"email":o=s.ide.PROP_STACK_EXAMPLE_EMAIL,u=s.ide.PROP_STACK_EMAIL,i=s.ide.HEAD_MSG_ERR_UPDATE_EMAIL3;break;case"email-json":o=s.ide.PROP_STACK_EXAMPLE_EMAIL,u=s.ide.PROP_STACK_EMAIL,i=s.ide.HEAD_MSG_ERR_UPDATE_EMAIL3;break;case"sms":o=s.ide.PROP_STACK_E_G_1_206_555_6423,u=s.ide.PROP_STACK_USPHONE,i=s.ide.PARSLEY_PLEASE_PROVIDE_A_VALID_PHONE_NUMBER;break;case"http":o=s.ide.PROP_STACK_HTTP_WWW_EXAMPLE_COM,u=s.ide.PROP_STACK_HTTP,i=s.ide.PARSLEY_PLEASE_PROVIDE_A_VALID_URL;break;case"https":o=s.ide.PROP_STACK_HTTPS_WWW_EXAMPLE_COM,u=s.ide.PROP_STACK_HTTPS,i=s.ide.PARSLEY_PLEASE_PROVIDE_A_VALID_URL}return r=$("#property-asg-endpoint"),r.attr("placeholder",o),r.parsley("custom",function(e){if(u&&e&&!MC.validate(u,e))return i}),r.val().length&&r.parsley("validate"),null},o(),n.on("OPTION_CHANGE",o),i=this,$("#property-asg-sns-done").on("click",function(){var e;return e=$("#property-asg-endpoint"),e.parsley("validate")&&(t={uid:n.attr("data-uid"),protocol:n.find(".selected").data("id"),endpoint:e.val()},modal.close(),i.saveSNS(t)),null})},deleteAcl:function(e){var t,n,r,i,s,o;return t=$(e.currentTarget),i=parseInt(t.attr("data-count"),10),r=t.closest("li").attr("data-uid"),i?(o=this,n=t.attr("data-name"),s=MC.template.modalDeleteSGOrACL({title:"Delete Network ACL",main_content:"Are you sure you want to delete "+n+"?",desc_content:"Subnets associated with "+n+" will use DefaultACL."}),modal(s,!1,function(){return $("#modal-confirm-delete").click(function(){return o.model.removeAcl(r),o.refreshACLList(),modal.close()})})):(this.model.removeAcl(r),this.refreshACLList())}}),new o})}.call(this),function(){define("module/design/property/sglist/model",["Design","constant"],function(e,t){var n;return n=Backbone.Model.extend({getSGInfoList:function(){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;u=e.instance(),p=this.parent_model,d=!1,u.modeIsApp()||u.modeIsAppView()?d=!0:u.modeIsAppEdit()&&p.isSGListReadOnly&&(d=p.isSGListReadOnly()),m=p.get("uid"),v=u.component(m),v?(l=v.type===t.RESTYPE.ELB,c=!1,m=v.id):(l=!1,c=!0,m=""),S=[],a={},f=[],n=e.modelClassForType("SgAsso"),_=e.modelClassForType(t.RESTYPE.SG).allObjects();for(T=0,L=_.length;T<L;T++){b=_[T];if(b.isElbSg()&&!l&&!c)continue;w=!!n.findExisting(b,v),h=c||!d||w;if(!h)continue;b.isDefault()||d||b.get("appId")?o=!1:o=!0,s=b.connections("SgAsso");for(N=0,A=s.length;N<A;N++){i=s[N];if(i.connectsTo(m)){a[b.id]=!0,f.push(b);break}}S.push({uid:b.id,color:b.color,name:b.get("name"),desc:b.get("description"),ruleCount:b.ruleCount(),memberCount:b.getMemberList().length,hideCheck:d||c,deletable:o,used:a[b.id]})}E=[];for(C=0,O=f.length;C<O;C++){x=f[C],g=x.connections("SgRuleSet");for(k=0,M=g.length;k<M;k++)y=g[k],E=E.concat(y.toPlainObjects(x.id))}return r=e.modelClassForType("SgRuleSet"),this.set({is_stack_sg:c,only_one_sg:f.length===1,sg_list:S,sg_length:c?S.length:f.length,readonly:d,sg_rule_list:r.getPlainObjFromRuleSets(E)}),this.sortSGList(),this.sortSGRule(),null},sortSGList:function(){return this.attributes.sg_list=this.attributes.sg_list.sort(function(e,t){if(e.name==="DefaultSG")return-1;if(t.name==="DefaultSG")return 1;if(e.name<t.name)return-1;if(e.name===t.name)return 0;if(e.name>t.name)return 1}),this.attributes.sg_list},sortSGRule:function(e){var t;return t=_.sortBy(this.attributes.sg_rule_list,e||"direction"),this.set("sg_rule_list",t),null},assignSG:function(t,n){var r,i,s,o;return r=e.modelClassForType("SgAsso"),s=e.instance(),o=this.parent_model.get("uid"),void 0,i=new r(s.component(o),s.component(t)),n===!1&&i.remove(),null},deleteSG:function(t){return e.instance().component(t).remove(),null},isElbSg:function(t){return e.instance().component(t).isElbSg()},getElbNameBySgId:function(n){var r,i,s,o,u;i=e.instance().component(n);if(i.isElbSg()){u=e.modelClassForType(t.RESTYPE.ELB).allObjects();for(s=0,o=u.length;s<o;s++){r=u[s];if(r.getElbSg()===i)return r.get("name")}}return""},createNewSG:function(){var n,r,i,s;return r=e.modelClassForType(t.RESTYPE.SG),s=new r,i=e.instance().component(this.parent_model.get("uid")),i&&(n=e.modelClassForType("SgAsso"),new n(s,i)),s.id}}),new n})}.call(this),define("module/design/property/sglist/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n<ul class="tab sg-info-list-tab">\n	<li data-tab-target="#item-group" class="active">'+u(n.i18n.call(e,"PROP_SGLIST_TAB_GROUP",{hash:{},data:t}))+'</li>\n	<li data-tab-target="#item-rule">'+u(n.i18n.call(e,"PROP_SGLIST_TAB_RULE",{hash:{},data:t}))+"</li>\n</ul>\n",r}function c(e,t){var r="",i;r+='\n			<li class="clearfix" data-uid="'+u((i=e&&e.uid,typeof i===f?i.apply(e):i))+'">\n				',i=n.unless.call(e,e&&e.hideCheck,{hash:{},inverse:a.noop,fn:a.program(4,h,t),data:t});if(i||i===0)r+=i;r+='\n				<div class="col3 sg-edit-icon tooltip icon-btn-details" data-tooltip=\''+u(n.i18n.call(e,"PROP_SGLIST_TIP_VIEW_DETAIL",{hash:{},data:t}))+'\'></div>\n\n				<div class="col2">\n					<div class="col2-1 truncate"><div class="sg-color" style="background-color:'+u((i=e&&e.color,typeof i===f?i.apply(e):i))+'" ></div><span class="sg-name">'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'</span></div>\n					<div class="col2-2 truncate">'+u((i=e&&e.desc,typeof i===f?i.apply(e):i))+'</div>\n					<div class="col2-3 truncate">'+u((i=e&&e.ruleCount,typeof i===f?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP_SGLIST_LBL_RULE",{hash:{},data:t}))+", "+u((i=e&&e.memberCount,typeof i===f?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP_SGLIST_LBL_MEMBER",{hash:{},data:t})),i=n["if"].call(e,e&&e.deletable,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="</div>\n				</div>\n			</li>\n			",r}function h(e,t){var r="",i;r+='\n					<div class="checkbox-wrap col1">\n						<div class="checkbox">\n							<input class="sg-list-association-check" type="checkbox" ',i=n["if"].call(e,e&&e.used,{hash:{},inverse:a.noop,fn:a.program(5,p,t),data:t});if(i||i===0)r+=i;return r+=' id="sg-list-'+u((i=t==null||t===!1?t:t.index,typeof i===f?i.apply(e):i))+'"/>\n							<label for="sg-list-'+u((i=t==null||t===!1?t:t.index,typeof i===f?i.apply(e):i))+'"></label>\n						</div>\n					</div>\n				',r}function p(e,t){return'checked="checked"'}function d(e,t){var r="",i;return r+=' | <a class="sg-list-delete-btn" data-name="'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" data-count="'+u((i=e&&e.memberCount,typeof i===f?i.apply(e):i))+'">'+u(n.i18n.call(e,"PROP_SGLIST_LNK_DELETE",{hash:{},data:t}))+"</a>",r}function v(e,t){var r="";return r+='<a href="javascript:void(0)" class="add-to-list action-link" id="add-sg-btn">'+u(n.i18n.call(e,"PROP_SGLIST_BTN_CREATE_NEW_SG",{hash:{},data:t}))+"</a>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";o=n.unless.call(t,t&&t.is_stack_sg,{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n<div class="tab-content">\n	<div id="item-group" class="active tab-item pos-r">\n		<ul class="acl-sg-info-list property-list" id="sg-info-list">\n			',o=n.each.call(t,t&&t.sg_list,{hash:{},inverse:a.noop,fn:a.program(3,c,i),data:i});if(o||o===0)s+=o;s+="\n		</ul>\n		",o=n.unless.call(t,t&&t.readonly,{hash:{},inverse:a.noop,fn:a.program(9,v,i),data:i});if(o||o===0)s+=o;return s+='\n	</div>\n\n	<div id="item-rule" class="tab-item">\n		<div class="rule-list-sort property-control-group">\n			<h5>'+u(n.i18n.call(t,"PROP_SG_RULE_SORT_BY",{hash:{},data:i}))+'</h5>\n			<div class="selectbox" id="sg-rule-filter-select">\n				<div class="selection">'+u(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</div>\n				<ul class="dropdown" tabindex="-1">\n					<li class="item selected" data-id="direction">'+u(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</li>\n					<li class="item" data-id="relation">'+u(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_SRC_DEST",{hash:{},data:i}))+'</li>\n					<li class="item" data-id="protocol">'+u(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_PROTOCOL",{hash:{},data:i}))+'</li>\n				</ul>\n			</div>\n		</div>\n		<ul class="sg-rule-list property-list" id="sglist-rule-list"> </ul>\n	</div>\n</div>\n',s};return e.template(t)}),function(){define("module/design/property/sglist/view",["./template/stack"],function(e){var t;return t=Backbone.View.extend({events:{"click #sg-info-list .sg-edit-icon":"openSgPanel","click #add-sg-btn":"openSgPanel","click .sg-list-association-check":"assignSGToComp","click .sg-list-delete-btn":"deleteSGFromComp","OPTION_CHANGE #sg-rule-filter-select":"sortSgRule"},render:function(){return this.model.getSGInfoList(),this.setElement($(".sg-group")),this.$el.html(e(this.model.attributes)),$("#sglist-rule-list").html(MC.template.sgRuleList(this.model.attributes.sg_rule_list)),$("#property-head-sg-num").text(this.model.attributes.sg_length)},openSgPanel:function(e){var t;return e.currentTarget.id==="add-sg-btn"?t=this.model.createNewSG():t=$(e.currentTarget).closest("li").attr("data-uid"),this.trigger("OPEN_SG",t)},refreshSGList:function(){return this.render()},assignSGToComp:function(e){var t,n,r,i;return n=$(e.currentTarget),t=n.closest("#sg-info-list").find(":checked"),t.length===0?!1:(i=n.closest("li").attr("data-uid"),r=n.prop("checked"),this.model.assignSG(i,r),this.render(),null)},deleteSGFromComp:function(e){var t,n,r,i,s,o,u,a;return u=this,t=$(e.currentTarget),o=t.closest("li").attr("data-uid"),i=Number(t.attr("data-count")),s=t.attr("data-name"),i&&(r="Are you sure you want to delete "+s+"?",n="The firewall settings of "+s+"'s member will be affected. Member only has this security group will be using DefaultSG."),r?(a=MC.template.modalDeleteSGOrACL({title:"Delete Security Group",main_content:r,desc_content:n}),modal(a,!1,function(){return $("#modal-confirm-delete").click(function(){return u.model.deleteSG(o),u.render(),modal.close()})})):(this.model.deleteSG(o),this.render())},sortSgRule:function(e){var t,n;return t=$("#sglist-rule-list"),n=$(e.target).find(".selected").attr("data-id"),this.model.sortSGRule(n),$("#sglist-rule-list").html(MC.template.sgRuleList(this.model.attributes.sg_rule_list))}}),new t})}.call(this),function(){define("module/design/property/sglist/main",["../base/main","./model","./view","event"],function(e,t,n,r){var i,s,o;return n.on("OPEN_SG",function(t){return e.loadSubPanel("SG",t),null}),n.model=t,o=function(){return n.render(),null},i=function(e){return t.parent_model=e,n.render(),null},s=function(e){if(e==="SG")return n.render()},{loadModule:i,refresh:o,onUnloadSubPanel:s}})}.call(this),function(){define("module/design/property/stack/main",["../base/main","./model","./view","../sglist/main","event","Design"],function(e,t,n,r,i,s){var o,u;return n.on("STACK_NAME_CHANGED",function(e){var t;return t=s.instance(),t.set("name",e),i.trigger(i.UPDATE_DESIGN_TAB,t.get("id"),e+" - stack"),null}),n.on("STACK_DESC_CHANGED",function(e){var t;return t=s.instance(),t.set("description",e),null}),n.on("OPEN_ACL",function(t){return e.loadSubPanel("ACL",t),null}),u={},u[i.RESOURCE_QUICKSTART_READY]=function(){return i.trigger(i.OPEN_PROPERTY),null},o=e.extend({ideEvents:u,handleTypes:["Stack","default"],onUnloadSubPanel:function(e){r.onUnloadSubPanel(e);if(e==="ACL")return this.model.getNetworkACL(),this.view.refreshACLList()},initStack:function(e){return this.model=t,this.model.isApp=!1,this.model.isAppEdit=!1,this.model.isStack=!0,this.view=n,null},afterLoadStack:function(){return r.loadModule(this.model),null},initApp:function(e){return this.model=t,this.model.isApp=!0,this.model.isAppEdit=!1,this.model.isStack=!1,this.view=n,null},afterLoadApp:function(){return r.loadModule(this.model),null},initAppEdit:function(){return this.model=t,this.model.isApp=!1,this.model.isAppEdit=!0,this.model.isStack=!1,this.view=n,null},afterLoadAppEdit:function(){return r.loadModule(this.model),null}}),null})}.call(this),function(){define("module/design/property/instance/model",["../base/model","constant","event","i18n!nls/lang.js"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var n,r,i,s,o,u;return i=Design.instance().component(e),r=i.toJSON(),r.uid=e,r.classic_stack=!1,r.can_set_ebs=i.isEbsOptimizedEnabled(),r.instance_type=i.getInstanceTypeList(),r.tenancy=i.isDefaultTenancy(),r.displayCount=r.count-1,o=i.getEmbedEni(),r.number_disable=o&&o.connections("RTB_Route").length>0,u=Design.modelClassForType(t.RESTYPE.VPC).allObjects()[0],r.force_tenacy=u&&!u.isDefaultTenancy(),s=Design.instance(),n=s.get("agent"),r.stackAgentEnable=n.enabled,this.set(r),this.getAmi(),this.getKeyPair(),this.getEni(),null},getKeyPair:function(){var e;return e=Design.instance().component(this.get("uid")).connectionTargets("KeypairUsage")[0],e&&this.set("keypair",e.getKPList()),null},addKP:function(e){var n,r,i,s,o;n=Design.modelClassForType(t.RESTYPE.KP),o=n.allObjects();for(i=0,s=o.length;i<s;i++){r=o[i];if(r.get("name")===e)return!1}return r=new n({name:e}),r.id},deleteKP:function(e){return Design.instance().component(e).remove(),null},setKP:function(e){var t,n;return t=Design.instance(),n=t.component(this.get("uid")),t.component(e).assignTo(n),null},setCount:function(e){return Design.instance().component(this.get("uid")).setCount(e)},setEbsOptimized:function(e){return Design.instance().component(this.get("uid")).set("ebsOptimized",e)},setTenancy:function(e){return Design.instance().component(this.get("uid")).setTenancy(e)},setMonitoring:function(e){return Design.instance().component(this.get("uid")).set("monitoring",e)},setUserData:function(e){return Design.instance().component(this.get("uid")).set("userData",e)},setEniDescription:function(e){return Design.instance().component(this.get("uid")).getEmbedEni().set("description",e)},setSourceCheck:function(e){return Design.instance().component(this.get("uid")).getEmbedEni().set("sourceDestCheck",e)},setPublicIp:function(e){Design.instance().component(this.get("uid")).getEmbedEni().set("assoPublicIp",e);if(e)return Design.modelClassForType(t.RESTYPE.IGW).tryCreateIgw()},getAmi:function(){var e,t,n,r,i,s,o;return t=this.get("imageId"),n=Design.instance().component(this.get("uid")),e=n.getAmi(),e?r={name:e.name,icon:e.osType+"."+e.architecture+"."+e.rootDeviceType+".png"}:r={name:t+" is not available.",icon:"ami-not-available.png",unavailable:!0},this.set("instance_ami",r),e&&e.blockDeviceMapping&&(s=e.rootDeviceName,i=e.blockDeviceMapping[s],s&&!i&&_.each(e.blockDeviceMapping,function(e,t){return s.indexOf(t)!==-1&&!i&&(i=e,s=t),null}),o={name:s,size:parseInt(n.get("rdSize"),10),iops:n.get("rdIops")},o.size<10&&(o.iops="",o.iopsDisabled=!0),this.set("rootDevice",o)),this.set("min_volume_size",n.getAmiRootDeviceVolumeSize()),null},canSetInstanceType:function(e){var t,n,i,s;return i=Design.instance().component(this.get("uid")),n=i.connectionTargets("EniAttachment").length+1,t=i.getInstanceTypeConfig(e),s=t?t.eni:2,n<=2||n<=s?!0:sprintf(r.ide.PROP_WARN_EXCEED_ENI_LIMIT,e,s)},setInstanceType:function(e){var t;return t=Design.instance().component(this.get("uid")),t.setInstanceType(e),this.getEni(),t.isEbsOptimizedEnabled()},getEni:function(){var e,t,n;n=Design.instance().component(this.get("uid")),e=n.getEmbedEni();if(!e)return;return t=e.toJSON(),t.ips=e.getIpArray(),t.ips[0].unDeletable=!0,this.set("eni",t),this.set("multi_enis",n.connections("EniAttachment").length>0),null},attachEip:function(e,n){return Design.instance().component(this.get("uid")).getEmbedEni().setIp(e,null,null,n),this.attributes.eni.ips[e].hasEip=n,n&&Design.modelClassForType(t.RESTYPE.IGW).tryCreateIgw(),null},removeIp:function(e){return Design.instance().component(this.get("uid")).getEmbedEni().removeIp(e),null},addIp:function(){var e,t;return e=Design.instance().component(this.get("uid")).getEmbedEni(),e.addIp(),t=e.getIpArray(),t[0].unDeletable=!0,this.get("eni").ips=t,null},isValidIp:function(e){return Design.instance().component(this.get("uid")).getEmbedEni().isValidIp(e)},canAddIP:function(){return Design.instance().component(this.get("uid")).getEmbedEni().canAddIp()},setIp:function(e,t,n){return Design.instance().component(this.get("uid")).getEmbedEni().setIp(e,t,n),null},getStateData:function(){return Design.instance().component(this.get("uid")).getStateData()},setIops:function(e){return Design.instance().component(this.get("uid")).set("rdIops",e),null},setVolumeSize:function(e){return Design.instance().component(this.get("uid")).set("rdSize",e),null}}),new i})}.call(this),define("module/design/property/instance/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return"single"}function c(e,t){var r="";return r+='disabled="disabled" data-tooltip="'+u(n.i18n.call(e,"PROP_INSTANCE_TIP_YOU_CANNOT_SPECIFY_INSTANCE_NUMBER",{hash:{},data:t}))+'"',r}function h(e,t){var r="";return r+='data-tooltip="'+u(n.i18n.call(e,"PROP_INSTANCE_TIP_IF_THE_QUANTITY_IS_MORE_THAN_1",{hash:{},data:t}))+'"',r}function p(e,t){return'style="color:red;"'}function d(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left">'+u(n.i18n.call(e,"PROP_INSTANCE_TYPE",{hash:{},data:t}))+'</label>\n			<div class="selectbox selectbox-mega" id="instance-type-select">\n				<div class="selection"></div>\n				<ul class="dropdown"> ',i=n.each.call(e,e&&e.instance_type,{hash:{},inverse:a.noop,fn:a.program(10,v,t),data:t});if(i||i===0)r+=i;return r+=" </ul>\n			</div>\n		</section>\n		",r}function v(e,t){var r="",i;r+='\n					<li class="',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(11,m,t),data:t});if(i||i===0)r+=i;r+='tooltip item" tabindex="-1" data-tooltip="'+u((i=e&&e.main,typeof i===f?i.apply(e):i))+'" data-id="'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.hide,{hash:{},inverse:a.noop,fn:a.program(13,g,t),data:t});if(i||i===0)r+=i;return r+='>\n						<div class="main truncate">'+u((i=e&&e.main,typeof i===f?i.apply(e):i))+'</div>\n						<div class="sub"><span>'+u((i=e&&e.ecu,typeof i===f?i.apply(e):i))+"</span> <span>"+u((i=e&&e.core,typeof i===f?i.apply(e):i))+"</span> <span>"+u((i=e&&e.mem,typeof i===f?i.apply(e):i))+"</span></div>\n					</li>\n				",r}function m(e,t){return"selected "}function g(e,t){return'style="display:none;"'}function y(e,t){return'checked="checked"'}function b(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left">'+u(n.i18n.call(e,"PROP_INSTANCE_TENANCY",{hash:{},data:t}))+'</label>\n			<div class="selectbox" id="tenancy-select">\n				<div class="selection">',i=n["if"].call(e,e&&e.tenancy,{hash:{},inverse:a.program(20,E,t),fn:a.program(18,w,t),data:t});if(i||i===0)r+=i;r+='</div>\n				<ul class="dropdown" tabindex="-1">\n					',i=n.unless.call(e,e&&e.force_tenacy,{hash:{},inverse:a.noop,fn:a.program(22,S,t),data:t});if(i||i===0)r+=i;r+='\n					<li class="item ',i=n.unless.call(e,e&&e.tenancy,{hash:{},inverse:a.noop,fn:a.program(23,x,t),data:t});if(i||i===0)r+=i;return r+='" data-id="dedicated">'+u(n.i18n.call(e,"PROP_INSTANCE_TENANCY_DELICATED",{hash:{},data:t}))+"</li>\n				</ul>\n			</div>\n		</section>\n		",r}function w(e,t){return"Default"}function E(e,t){return"Dedicated"}function S(e,t){var r="",i;r+='\n					<li class="item ',i=n["if"].call(e,e&&e.tenancy,{hash:{},inverse:a.noop,fn:a.program(23,x,t),data:t});if(i||i===0)r+=i;return r+='" data-id="default">'+u(n.i18n.call(e,"PROP_INSTANCE_TENANCY_DEFAULT",{hash:{},data:t}))+"</li>\n					",r}function x(e,t){return"selected"}function T(e,t){return'\n				<input id="property-instance-enable-cloudwatch" type="checkbox" checked="true" value="None" name="property-instance-enable-cloudwatch" />\n				'}function N(e,t){return'\n				<input id="property-instance-enable-cloudwatch" type="checkbox" value="None" name="property-instance-enable-cloudwatch" />\n				'}function C(e,t){return"hide"}function k(e,t){var r="";return r+='\n			<div class="property-info">User Data is disabled to allow installing OpsAgent for VisualOps. <a href="'+u(n.i18n.call(e,"PROP_AGENT_USER_DATA_URL",{hash:{},data:t}))+'" target="_blank">View content</a>.</div>\n			',r}function L(e,t){var r="",i;return r+='\n			<label for="property-instance-user-data">'+u(n.i18n.call(e,"PROP_INSTANCE_USER_DATA",{hash:{},data:t}))+'</label>\n			<textarea id="property-instance-user-data">'+u((i=e&&e.userData,typeof i===f?i.apply(e):i))+"</textarea>\n			",r}function A(e,t){var r="",i;r+='\n	<div class="option-group-head">Root Device</div>\n	<div class="option-group">\n    <section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP_VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</label>\n      <div>"+u((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.name),typeof i===f?i.apply(e):i))+'</div>\n    </section>\n    <section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP_VOLUME_SIZE",{hash:{},data:t}))+'</label>\n      <div class="ranged-number-input">\n          <label for="volume-size-ranged"></label>\n          <input id="volume-size-ranged" type="text" class="input" value="'+u((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.size),typeof i===f?i.apply(e):i))+'" name="volume-size-ranged" data-ignore="true" maxlength="4" data-required="true" data-required="true" data-type="number"/>\n      <label for="volume-property-ranged-number" >GB</label>\n      </div>\n    </section>\n\n    <section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP_VOLUME_TYPE",{hash:{},data:t}))+'</label>\n      <div id="volume-type-radios">\n      <div>\n      	<div class="radio">\n          <input id="radio-standard" type="radio" name="volume-type" ',i=n.unless.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),{hash:{},inverse:a.noop,fn:a.program(15,y,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="radio-standard"></label>\n        </div>\n        <label for="radio-standard">'+u(n.i18n.call(e,"PROP_VOLUME_TYPE_STANDARD",{hash:{},data:t}))+"</label>\n      </div>\n      <div ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:a.noop,fn:a.program(36,O,t),data:t});if(i||i===0)r+=i;r+=' data-tooltip="'+u(n.i18n.call(e,"PROP_VOLUME_MSG_WARN",{hash:{},data:t}))+'">\n        <div class="radio">\n          <input id="radio-iops" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),{hash:{},inverse:a.noop,fn:a.program(15,y,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:a.noop,fn:a.program(38,M,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="radio-iops"></label>\n        </div>\n        <label for="radio-iops">'+u(n.i18n.call(e,"PROP_VOLUME_TYPE_IOPS",{hash:{},data:t}))+'</label>\n      </div>\n      </div>\n    </section>\n\n    <section class="property-control-group" id="iops-group" ',i=n.unless.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),{hash:{},inverse:a.noop,fn:a.program(40,_,t),data:t});if(i||i===0)r+=i;return r+='>\n        <label>IOPS</label>\n        <div class="ranged-number-input">\n          <label for="iops-ranged"></label>\n          <input id="iops-ranged" type="text" class="input" min="100" max="2000" value="'+u((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),typeof i===f?i.apply(e):i))+'">\n        </div>\n    </section>\n	</div>\n  ',r}function O(e,t){return'class="tooltip"'}function M(e,t){return"disabled"}function _(e,t){return'style="display:none"'}function D(e,t){var r="",i;r+='\n	<div class="option-group-head">'+u(n.i18n.call(e,"PROP_INSTANCE_ENI_DETAIL",{hash:{},data:t}))+'</div>\n	<div class="option-group" data-bind="true">\n		<section class="property-control-group">\n			<label class="left" for="property-instance-ni-description">'+u(n.i18n.call(e,"PROP_INSTANCE_ENI_DESC",{hash:{},data:t}))+'</label>\n			<textarea id="property-instance-ni-description" data-type="ascii" data-ignore="true" class="input">'+u((i=(i=e&&e.eni,i==null||i===!1?i:i.description),typeof i===f?i.apply(e):i))+'</textarea>\n		</section>\n		<section class="property-control-group">\n			<div class="checkbox">\n				',i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.sourceDestCheck),{hash:{},inverse:a.program(45,H,t),fn:a.program(43,P,t),data:t});if(i||i===0)r+=i;r+='\n				<label for="property-instance-source-check"></label>\n			</div>\n			<label for="property-instance-source-check">'+u(n.i18n.call(e,"PROP_INSTANCE_ENI_SOURCE_DEST_CHECK",{hash:{},data:t}))+"</label>\n		</section>\n		<section ",i=n["if"].call(e,e&&e.multi_enis,{hash:{},inverse:a.program(49,j,t),fn:a.program(47,B,t),data:t});if(i||i===0)r+=i;r+='>\n			<div class="checkbox">\n				<input id="property-instance-public-ip" type="checkbox" ',i=n["if"].call(e,e&&e.multi_enis,{hash:{},inverse:a.noop,fn:a.program(51,F,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.assoPublicIp),{hash:{},inverse:a.noop,fn:a.program(53,I,t),data:t});if(i||i===0)r+=i;return r+=' value="None" name="property-instance-public-ip" />\n				<label for="property-instance-public-ip"></label>\n			</div>\n			<label for="property-instance-public-ip">'+u(n.i18n.call(e,"PROP_INSTANCE_ENI_AUTO_PUBLIC_IP",{hash:{},data:t}))+'</label>\n		</section>\n		<section class="property-control-group">\n			<div class="network-list-wrap">\n				<div class="network-list-header clearfix">\n					'+u(n.i18n.call(e,"PROP_INSTANCE_ENI_IP_ADDRESS",{hash:{},data:t}))+'\n					<button id="instance-ip-add" class="right btn btn-blue btn-small tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ENI_TIP_ADD_IP_ADDRESS",{hash:{},data:t}))+'">'+u(n.i18n.call(e,"PROP_INSTANCE_ENI_ADD_IP",{hash:{},data:t}))+'</button>\n				</div>\n				<ul class="network-list" id="property-network-list" data-bind="true"></ul>\n			</div>\n		</section>\n	</div>\n	',r}function P(e,t){return'\n				<input id="property-instance-source-check" type="checkbox" checked="true" value="None" name="property-instance-source-check" />\n				'}function H(e,t){return'\n				<input id="property-instance-source-check" type="checkbox" value="None" name="property-instance-source-check" />\n				'}function B(e,t){var r="";return r+='class="property-control-group tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_INSTANCE_TIP_PUBLIC_IP_CANNOT_BE_ASSOCIATED",{hash:{},data:t}))+'"',r}function j(e,t){return'class="property-control-group"'}function F(e,t){return'disabled="disabled"'}function I(e,t){return'checked="checked" '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<article>\n\n	<div class="option-group-head expand">'+u(n.i18n.call(t,"PROP_INSTANCE_DETAIL",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-instance-name" >'+u(n.i18n.call(t,"PROP_INSTANCE_HOSTNAME",{hash:{},data:i}))+'</label>\n			<span class="required-input right">'+u(n.i18n.call(t,"PROP_INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n\n			<div class="property-instance-name-wrap ',o=n.ifCond.call(t,t&&t.count,1,{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='">\n				<div class="name-count-wrap">\n					-[0-<span id="property-instance-name-count">'+u((o=t&&t.displayCount,typeof o===f?o.apply(t):o))+'</span>]\n				</div>\n				<div class="fitfloat">\n					<input class="input instance-name"  type="text" value="'+u((o=t&&t.name,typeof o===f?o.apply(t):o))+'" id="property-instance-name" data-ignore="true" data-required-rollback="true"/>\n				</div>\n			</div>\n\n		</section>\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-instance-count" >'+u(n.i18n.call(t,"PROP_INSTANCE_NUMBER",{hash:{},data:i}))+'</label>\n			<span class="required-input right">'+u(n.i18n.call(t,"PROP_INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n			<input class="input tooltip" type="text" value="'+u((o=t&&t.count,typeof o===f?o.apply(t):o))+'" id="property-instance-count" data-ignore="true" data-required="true" data-type="digits" ',o=n["if"].call(t,t&&t.number_disable,{hash:{},inverse:a.program(5,h,i),fn:a.program(3,c,i),data:i});if(o||o===0)s+=o;s+='/>\n		</section>\n		<section class="property-control-group">\n			<label>'+u(n.i18n.call(t,"PROP_INSTANCE_AMI",{hash:{},data:i}))+'</label>\n			<div id="property-ami" class="property-block-wrap clearfix" data-uid=\''+u((o=t&&t.imageId,typeof o===f?o.apply(t):o))+'\'>\n				<img class="property-ami-icon left" src="./assets/images/ide/ami/'+u((o=(o=t&&t.instance_ami,o==null||o===!1?o:o.icon),typeof o===f?o.apply(t):o))+'">\n				<div class="property-ami-label" ',o=n["if"].call(t,(o=t&&t.instance_ami,o==null||o===!1?o:o.unavailable),{hash:{},inverse:a.noop,fn:a.program(7,p,i),data:i});if(o||o===0)s+=o;s+=">"+u((o=(o=t&&t.instance_ami,o==null||o===!1?o:o.name),typeof o===f?o.apply(t):o))+"</div>\n			</div>\n		</section>\n		",o=n["if"].call(t,(o=t&&t.instance_type,o==null||o===!1?o:o.length),{hash:{},inverse:a.noop,fn:a.program(9,d,i),data:i});if(o||o===0)s+=o;s+='\n		<section class="property-control-group" ',o=n.unless.call(t,t&&t.can_set_ebs,{hash:{},inverse:a.noop,fn:a.program(13,g,i),data:i});if(o||o===0)s+=o;s+='>\n			<div class="checkbox">\n				<input id="property-instance-ebs-optimized" type="checkbox" value="None" ',o=n["if"].call(t,t&&t.ebsOptimized,{hash:{},inverse:a.noop,fn:a.program(15,y,i),data:i});if(o||o===0)s+=o;s+=' name="ebs-optimized" />\n				<label for="property-instance-ebs-optimized"></label>\n			</div>\n			<label for="property-instance-ebs-optimized">EBS Optimized</label>\n		</section>\n		',o=n.unless.call(t,t&&t.classic_stack,{hash:{},inverse:a.noop,fn:a.program(17,b,i),data:i});if(o||o===0)s+=o;s+='\n		<section class="property-control-group">\n			<label class="left">'+u(n.i18n.call(t,"PROP_INSTANCE_KEY_PAIR",{hash:{},data:i}))+'</label>\n			<i class="icon-info tooltip default-kp-info" data-tooltip="'+u(n.i18n.call(t,"POP_INSTANCE_KEYPAIR_INFO_TIP",{hash:{},data:i}))+'"></i>\n            <div id="kp-placeholder"></div>\n		</section>\n	</div>\n\n	<div class="option-group-head">'+u(n.i18n.call(t,"PROP_INSTANCE_ADVANCED_DETAIL",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group">\n			<div class="checkbox">\n				',o=n["if"].call(t,t&&t.monitoring,{hash:{},inverse:a.program(27,N,i),fn:a.program(25,T,i),data:i});if(o||o===0)s+=o;s+='\n				<label for="property-instance-enable-cloudwatch"></label>\n			</div>\n			<label for="property-instance-enable-cloudwatch" >'+u(n.i18n.call(t,"PROP_INSTANCE_CW_ENABLED",{hash:{},data:i}))+'</label>\n\n			<p class="',o=n.unless.call(t,t&&t.monitoring,{hash:{},inverse:a.noop,fn:a.program(29,C,i),data:i});if(o||o===0)s+=o;s+=' property-info" id="property-cloudwatch-warn">'+u(n.i18n.call(t,"PROP_INSTANCE_CW_WARN",{hash:{},data:i}))+'<a target="_blank" href="http://aws.amazon.com/cloudwatch">Amazon Cloud Watch product page</a></p>\n		</section>\n		<section class="property-control-group">\n			',o=n["if"].call(t,t&&t.stackAgentEnable,{hash:{},inverse:a.program(33,L,i),fn:a.program(31,k,i),data:i});if(o||o===0)s+=o;s+="\n		</section>\n	</div>\n\n  ",o=n["if"].call(t,t&&t.rootDevice,{hash:{},inverse:a.noop,fn:a.program(35,A,i),data:i});if(o||o===0)s+=o;s+="\n\n	",o=n["if"].call(t,t&&t.eni,{hash:{},inverse:a.noop,fn:a.program(42,D,i),data:i});if(o||o===0)s+=o;return s+='\n\n	<div class="option-group-head" id="sg-head">'+u(n.i18n.call(t,"PROP_INSTANCE_SG_DETAIL",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n</article>\n',s};return e.template(t)}),function(){define("module/design/property/instance/view",["../base/view","./template/stack","i18n!nls/lang.js","constant","kp"],function(e,t,n,r,i){var s,o;return o=function(){return null},s=e.extend({events:{"change .instance-name":"instanceNameChange","change #property-instance-count":"countChange","change #property-instance-ebs-optimized":"ebsOptimizedSelect","change #property-instance-enable-cloudwatch":"cloudwatchSelect","change #property-instance-user-data":"userdataChange","change #property-instance-ni-description":"eniDescriptionChange","change #property-instance-source-check":"sourceCheckChange","change #property-instance-public-ip":"publicIpChange","OPTION_CHANGE #instance-type-select":"instanceTypeSelect","OPTION_CHANGE #tenancy-select":"tenancySelect","click #property-ami":"openAmiPanel","OPTION_CHANGE #keypair-select":"setKP","EDIT_UPDATE #keypair-select":"addKP","click #keypair-select .icon-remove":"deleteKP","EDIT_FINISHED #keypair-select":"updateKPSelect","click .toggle-eip":"setEip","click #instance-ip-add":"addIp","click #property-network-list .icon-remove":"removeIp","change .input-ip":"syncIPList","click #volume-type-radios input":"changeVolumeType","keyup #iops-ranged":"changeIops","keyup #volume-size-ranged":"sizeChanged"},changeVolumeType:function(e){var t,n,r;t=$(e.currentTarget);if(t.is(":disabled"))return;return $("#iops-group").toggle(t.attr("id")==="radio-iops"),t.attr("id")==="radio-iops"?(r=parseInt($("#volume-size-ranged").val(),10),n=r*10,$("#iops-ranged").val(n).keyup()):(this.model.setIops(""),$("#iops-ranged").val(""))},changeIops:function(){return $("#iops-ranged").parsley("validate")&&this.model.setIops($("#iops-ranged").val()),null},sizeChanged:function(e){var t,n,r,i;if(!$("#volume-size-ranged").parsley("validate"))return;return i=parseInt($("#volume-size-ranged").val(),10),this.model.setVolumeSize(i),i<10&&(this.model.setIops(""),r=!0),t=$("#volume-type-radios").children("div").last().toggleClass("tooltip",r).find("input"),r?(t.attr("disabled","disabled"),$("#radio-standard").click(),$("#iops-group").hide()):t.removeAttr("disabled"),n=parseInt($("#iops-ranged").val(),10)||0,n&&(n>i*10&&(n=i*10,$("#iops-ranged").val(n)),$("#iops-ranged").keyup()),null},render:function(){var e,r;return this.$el.html(t(this.model.attributes)),e=Design.instance().component(this.model.get("uid")),this.$("#kp-placeholder").html(i.load(e).el),this.refreshIPList(),r=this,$("#volume-size-ranged").parsley("custom",function(e){e=+e;if(!e||e>1024||e<r.model.attributes.min_volume_size)return sprintf(n.ide.PARSLEY_VOLUME_SIZE_OF_ROOTDEVICE_MUST_IN_RANGE,r.model.attributes.min_volume_size)}),$("#iops-ranged").parsley("custom",function(e){var t;e=+e,t=parseInt($("#volume-size-ranged").val(),10);if(e>4e3||e<100)return n.ide.PARSLEY_IOPS_MUST_BETWEEN_100_4000;if(e>10*t)return n.ide.PARSLEY_IOPS_MUST_BE_LESS_THAN_10_TIMES_OF_VOLUME_SIZE}),this.model.attributes.name},instanceNameChange:function(e){var t,n;return n=$(e.currentTarget),t=n.val(),this.checkResName(n,"Instance")&&(this.model.setName(t),this.setTitle(t)),null},countChange:function(e){var t,r,i;t=$(e.currentTarget),r=this,t.parsley("custom",function(e){if(isNaN(e)||e>99||e<1)return n.ide.PARSLEY_THIS_VALUE_MUST_BETWEEN_1_99});if(t.parsley("validate"))return this.refreshIPList(),i=+t.val(),this.model.setCount(i),$(".property-instance-name-wrap").toggleClass("single",i===1),$("#property-instance-name-count").text(i-1),this.setEditableIP(i===1)},setEditableIP:function(e){var t;return t=$("#property-network-list"),e?t.find(".input-ip-wrap").removeClass("disabled").find(".name").data("tooltip",n.ide.PROP_INSTANCE_IP_MSG_1).find(".input-ip").prop("disabled",""):t.find(".input-ip-wrap").addClass("disabled").find(".name").data("tooltip",n.ide.PROP_INSTANCE_IP_MSG_2).find(".input-ip").attr("disabled","disabled"),null},instanceTypeSelect:function(e,t){var n,r,i;r=this.model.canSetInstanceType(t);if(r!==!0){notification("error",r),e.preventDefault();return}return i=this.model.setInstanceType(t),n=$("#property-instance-ebs-optimized"),n.closest(".property-control-group").toggle(i),i||n.prop("checked",!1),this.refreshIPList()},ebsOptimizedSelect:function(e){return this.model.setEbsOptimized(e.target.checked),null},tenancySelect:function(e,t){var n,r,i;return r=$("#instance-type-select"),n=r.find("[data-id='t1.micro']"),n.length&&(i=t!=="dedicated",n.toggle(i),n.hasClass("selected")&&!i&&r.find(".item:not([data-id='t1.micro'])").eq(0).click()),this.model.setTenancy(t),null},cloudwatchSelect:function(e){return this.model.setMonitoring(e.target.checked),$("#property-cloudwatch-warn").toggle($("#property-instance-enable-cloudwatch").is(":checked"))},userdataChange:function(e){return this.model.setUserData(e.target.value),null},eniDescriptionChange:function(e){return this.model.setEniDescription(e.target.value),null},sourceCheckChange:function(e){return this.model.setSourceCheck(e.target.checked),null},publicIpChange:function(e){return this.model.setPublicIp(e.target.checked),null},updateKPSelect:function(){return $("#keypair-select").find(".item:last-child").append('<span class="icon-remove"></span>'),null},openAmiPanel:function(e){return this.trigger("OPEN_AMI",$("#property-ami").attr("data-uid")),null},validateIpItem:function(e){var t,n;return n=this,e.parsley("custom",function(t){var r,i,s,o,u,a,f;f=e,i=f.val(),s=f.siblings(".input-ip-prefix").text(),r=s+i,u=s.split("."),o=!1,u.length===4?i==="x"?o=!0:MC.validate("ipaddress",s+i)&&(o=!0):i==="x.x"?o=!0:MC.validate("ipaddress",s+i)&&(o=!0);if(!o)return"Invalid IP address";a=n.model.isValidIp(r);if(a!==!0)return a}),t=e.parsley("validate"),e.parsley("custom",o),t},addIp:function(){if($("#instance-ip-add").hasClass("disabled"))return;return this.model.addIp(),this.refreshIPList(),null},removeIp:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.index(),t.remove(),this.model.removeIp(n),this.updateIPAddBtnState(!0),null},setEip:function(e){var t,r,i,s;return t=$(e.currentTarget),i=t.closest("li").index(),r=!t.hasClass("associated"),r?s=n.ide.PROP_INSTANCE_IP_MSG_4:s=n.ide.PROP_INSTANCE_IP_MSG_3,t.toggleClass("associated",r).data("tooltip",s),this.model.attachEip(i,r),null},syncIPList:function(e){var t,n,r,i,s;i=$("#property-network-list .input-ip-item"),t=$(e.currentTarget);if(!this.validateIpItem(t))return;return s=t.val(),r=t.siblings(".input-ip-prefix").text()+s,n=s==="x"||s==="x.x",this.model.setIp(t.closest("li").index(),r,n),null},refreshIPList:function(){if(!this.model.attributes.eni)return;return $("#property-network-list").html(MC.template.propertyIpList(this.model.attributes.eni.ips)),this.updateIPAddBtnState(),null},updateIPAddBtnState:function(e){var t;return e===void 0&&(e=this.model.canAddIP()),e===!0?t="Add IP Address":(_.isString(e)?t=e:t="Cannot add IP address",e=!1),$("#instance-ip-add").toggleClass("disabled",!e).data("tooltip",t),null},disableUserDataInput:function(e){var t;t=$("#property-instance-user-data");if(e===!0)return t.attr("disabled","disabled"),t.addClass("tooltip").attr("data-tooltip",n.ide.PROP_INSTANCE_USER_DATA_DISABLE);if(e===!1)return t.removeAttr("disabled"),t.removeClass("tooltip").removeAttr("data-tooltip")}}),new s})}.call(this),function(){define("module/design/property/instance/app_model",["../base/model","keypair_model","keypair_service","instance_model","instance_service","constant","i18n!nls/lang.js","Design"],function(e,t,n,r,i,s,o,u){var a;return a=e.extend({defaults:{id:null},setOsTypeAndLoginCmd:function(e){var t,n,r,i,s,o;o=u.instance().region(),n=MC.data.resource_list[o][e],n&&n.imageId&&(s=MC.data.dict_ami[n.imageId].osType);if(!s)return;"win|windows".indexOf(s)>0?this.set("osType","windows"):this.set("osType",s),n&&(r=n.instanceState.name);if(r==="running")switch(s){case"amazon":i="ec2-user";break;case"ubuntu":i="ubuntu";break;case"redhat":i="ec2-user";break;default:i="root"}return t=sprintf("ssh -i %s.pem %s@%s",n.keyName,i,n.ipAddress||n.privateIpAddress),this.set("loginCmd",t)},init:function(e){var t,n,r,i,o,a,f,l,c,h,p,d;this.set("id",e),this.set("uid",e),a=u.instance().component(e),a?e=a.get("appId"):(r=u.modelClassForType(s.RESTYPE.INSTANCE).getEffectiveId(e),a=u.instance().component(r.uid),this.set("uid",r.uid),this.set("mid",r.mid)),a||void 0,t=MC.data.resource_list[u.instance().region()];if(!t[e])return!1;o=$.extend(!0,{},t[e]),o.name=a?a.get("name"):e,f=a.getAmiRootDeviceName(),o.state=MC.capitalize(o.instanceState.name),o.blockDevice="";if(o.blockDeviceMapping&&o.blockDeviceMapping.item){n=[],d=o.blockDeviceMapping.item;for(h=0,p=d.length;h<p;h++)i=d[h],n.push(i.deviceName),f===i.deviceName&&(l=i);o.blockDevice=n.join(", "),l&&(c=MC.data.resource_list[u.instance().region()][l.ebs.volumeId],c&&(c.attachmentSet&&(c.name=c.attachmentSet.item[0].device),this.set("rootDevice",c)))}return o.eni=this.getEniData(o),o.app_view=MC.canvas.getState()==="appview"?!0:!1,this.set(o),this.resModel=a,this.setOsTypeAndLoginCmd(e),null},getEniData:function(e){var t,n,r,i,o,a,f,l,c,h,p,d,v,m,g,y,b;if(!e.networkInterfaceSet)return null;y=e.networkInterfaceSet.item;for(h=0,v=y.length;h<v;h++){l=y[h];if(l.attachment.deviceIndex==="0"){c=l.networkInterfaceId,a=l;break}}n=s.RESTYPE.ENI;if(!c)return null;t=u.modelClassForType(n),r=t&&t.allObjects()||[];for(p=0,m=r.length;p<m;p++){f=r[p];if(f.get("appId"===c)){o=f;break}}i=MC.data.resource_list[u.instance().region()],i[c]?a=$.extend(!0,{},i[c]):a=$.extend(!0,{},a),a.name=o?o.get("name"):c,a.status==="in-use"&&(a.isInUse=!0),a.sourceDestCheck=a.sourceDestCheck?"enabled":"disabled",b=a.privateIpAddressesSet.item;for(d=0,g=b.length;d<g;d++)l=b[d],l.primary=l.primary===!0;return a},genPasswordHandler:function(e){var t;return t=this,function(n){var r,i,s,u,a,f,l,c;l=n.param[3],s=n.param[4],a=n.param[5],i=null,u=null,c=null,f=null,r=t.get("instanceId");if(r!==s)return;return n.is_error?(notification("error",o.ide.PROP_MSG_ERR_GET_PASSWD_FAILED),a=null,null):(n.resolved_data&&(c=n.resolved_data.passwordData),e==="check"?t.trigger("PASSWORD_STATE",!!c):e==="download"?t.trigger("KEYPAIR_DOWNLOAD",!0,c,n.param[5]):t.trigger("PASSWORD_GOT",c),null)}},getPasswordData:function(e,t){var n,r,s,o;return r=this.get("instanceId"),o=$.cookie("usercode"),s=$.cookie("session_id"),n=this.genPasswordHandler(t?"check":void 0),i.GetPasswordData(null,o,s,u.instance().region(),r,e).then(n),null},downloadKp:function(e){var t,r,s,o,a;return o=this,a=$.cookie("usercode"),s=$.cookie("session_id"),r=u.instance().region(),t=this.genPasswordHandler("download"),n.download(null,a,s,r,e).then(function(e){var n,u;return e.is_error?o.trigger("KEYPAIR_DOWNLOAD",!1,e.resolved_data):o.get("osType")==="windows"?(n=o.get("instanceId"),u=e.resolved_data,i.GetPasswordData(null,a,s,r,n,u).then(t)):o.trigger("KEYPAIR_DOWNLOAD",!0,e.resolved_data)}),null},getAMI:function(e){return MC.data.dict_ami[e]},getEni:function(){var e,t,n;n=u.instance().component(this.get("uid")),e=n.getEmbedEni();if(!e)return;return t=e.toJSON(),t.ips=e.getIpArray(),t.ips[0].unDeletable=!0,this.set("eni",t),this.set("multi_enis",n.connections("EniAttachment").length>0),null}}),new a})}.call(this),define("module/design/property/instance/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n      <dd>",i=n["if"].call(e,e&&e.keyName,{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="</dd>\n      ",r}function c(e,t){var n;return a((n=e&&e.keyName,typeof n===u?n.apply(e):n))}function h(e,t){return"No Key Pair"}function p(e,t){var r="",i;r+="\n      <dd>\n        ",i=n["if"].call(e,e&&e.keyName,{hash:{},inverse:f.program(12,g,t),fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n      </dd>\n      ",r}function d(e,t){var r="",i;r+="\n            ",i=n["if"].call(e,e&&e.windows,{hash:{},inverse:f.program(10,m,t),fn:f.program(8,v,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function v(e,t){var n="",r;return n+="\n                "+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+'\n                <button class="btn btn-blue" id="property-app-keypair">Get Windows Password</button>\n            ',n}function m(e,t){var n="",r;return n+='\n                <a href="#" id="property-app-keypair">'+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+"</a>\n            ",n}function g(e,t){return"\n          No Key Pair\n        "}function y(e,t){var r="",i;r+='\n  <div class="option-group-head">Root Device</div>\n  <div class="option-group">\n    <article class="property-app">\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP_VOLUME_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.volumeId),{hash:{},data:t}))+"</dd>\n        <dt>"+a(n.i18n.call(e,"PROP_VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.name),{hash:{},data:t}))+"</dd>\n        <dt>"+a(n.i18n.call(e,"PROP_VOLUME_STATE",{hash:{},data:t}))+'</dt>\n        <dd><i class="status status-'+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.status),typeof i===u?i.apply(e):i))+'"></i>'+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.status),typeof i===u?i.apply(e):i))+"</dd>\n        <dt>"+a(n.i18n.call(e,"PROP_VOLUME_CREATE_TIME",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.timeStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.createTime),{hash:{},data:t}))+'</dd>\n      </dl>\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP_VOLUME_TYPE",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.volumeType),{hash:{},data:t}))+"</dd>\n        ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.snapshotId),{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;r+="\n        <dt>"+a(n.i18n.call(e,"PROP_VOLUME_SIZE",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.size),{hash:{},data:t}))+" GB</dd>\n        ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),{hash:{},inverse:f.noop,fn:f.program(17,w,t),data:t});if(i||i===0)r+=i;return r+='\n      </dl>\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP_VOLUME_ATTACHMENT_STATE",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=(i=(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.attachmentSet),i==null||i===!1?i:i.item),i==null||i===!1?i:i[0]),i==null||i===!1?i:i.status),{hash:{},data:t}))+"</dd>\n        <dt>"+a(n.i18n.call(e,"PROP_VOLUME_INSTANCE_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=(i=(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.attachmentSet),i==null||i===!1?i:i.item),i==null||i===!1?i:i[0]),i==null||i===!1?i:i.instanceId),{hash:{},data:t}))+"</dd>\n        <dt>"+a(n.i18n.call(e,"PROP_VOLUME_ATTACHMENT_TIME",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.timeStr.call(e,(i=(i=(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.attachmentSet),i==null||i===!1?i:i.item),i==null||i===!1?i:i[0]),i==null||i===!1?i:i.attachTime),{hash:{},data:t}))+"</dd>\n      </dl>\n    </article>\n  </div>\n  ",r}function b(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP_VOLUME_SNAPSHOT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.snapshotId),typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function w(e,t){var n="",r;return n+="\n        <dt>IOPS</dt>\n        <dd>"+a((r=(r=e&&e.rootDevice,r==null||r===!1?r:r.iops),typeof r===u?r.apply(e):r))+"</dd>\n        ",n}function E(e,t){var r="",i;r+='\n  <div class="option-group-head">'+a(n.i18n.call(e,"PROP_INSTANCE_ENI_DETAIL",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(e,"PROP_ENI_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n      <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.name),typeof i===u?i.apply(e):i))+"</dd>\n\n      <dt>"+a(n.i18n.call(e,"PROP_ENI_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.networkInterfaceId),typeof i===u?i.apply(e):i))+"</dd>\n\n      <dt>"+a(n.i18n.call(e,"PROP_ENI_STATE",{hash:{},data:t}))+'</dt>\n      <dd><i class="status status-'+a((i=(i=e&&e.eni,i==null||i===!1?i:i.status),typeof i===u?i.apply(e):i))+'"></i>'+a((i=(i=e&&e.eni,i==null||i===!1?i:i.status),typeof i===u?i.apply(e):i))+"</dd>\n\n      ",i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.description),{hash:{},inverse:f.noop,fn:f.program(20,S,t),data:t});if(i||i===0)r+=i;r+="\n\n      <dt>"+a(n.i18n.call(e,"PROP_INSTANCE_ENI_SOURCE_DEST_CHECK_DISP",{hash:{},data:t}))+"</dt>\n      <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.sourceDestCheck),typeof i===u?i.apply(e):i))+'</dd>\n    </dl>\n\n    <div class="hidden-details">\n      <a href="#" class="toggle-details js-toggle-dropdown" data-toggle="self-only"><span class="details-off">+ '+a(n.i18n.call(e,"PROP_ENI_SHOW_DETAIL",{hash:{},data:t}))+'</span><span class="details-on">- '+a(n.i18n.call(e,"PROP_ENI_HIDE_DETAIL",{hash:{},data:t}))+'</span></a>\n\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP_ENI_VPC_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.vpcId),typeof i===u?i.apply(e):i))+"</dd>\n\n        <dt>"+a(n.i18n.call(e,"PROP_ENI_SUBNET_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.subnetId),typeof i===u?i.apply(e):i))+"</dd>\n\n        ",i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.attachment),{hash:{},inverse:f.noop,fn:f.program(22,x,t),data:t});if(i||i===0)r+=i;r+='\n      </dl>\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP_ENI_MAC_ADDRESS",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.eni,i==null||i===!1?i:i.macAddress),{hash:{},data:t}))+"</dd>\n\n        ",i=n["if"].call(e,(i=(i=e&&e.eni,i==null||i===!1?i:i.association),i==null||i===!1?i:i.publicDnsName),{hash:{},inverse:f.noop,fn:f.program(24,T,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.privateDnsName),{hash:{},inverse:f.noop,fn:f.program(26,N,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.ownerId),{hash:{},inverse:f.noop,fn:f.program(28,C,t),data:t});if(i||i===0)r+=i;r+='\n      </dl>\n    </div>\n    <table class="table table-small">\n      <tr>\n        <th>'+a(n.i18n.call(e,"PROP_INSTANCE_ENI_IP_ADDRESS",{hash:{},data:t}))+"</th>\n        <th>"+a(n.i18n.call(e,"PROP_INSTANCE_PUBLIC_IP",{hash:{},data:t}))+"</th>\n      </tr>\n      ",i=n.each.call(e,(i=(i=e&&e.eni,i==null||i===!1?i:i.privateIpAddressesSet),i==null||i===!1?i:i.item),{hash:{},inverse:f.noop,fn:f.program(30,k,t),data:t});if(i||i===0)r+=i;return r+="\n    </table>\n\n  </div>\n  ",r}function S(e,t){var r="",i;return r+="\n      <dt>"+a(n.i18n.call(e,"PROP_ENI_LBL_DESC",{hash:{},data:t}))+"</dt>\n      <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.description),typeof i===u?i.apply(e):i))+"</dd>\n      ",r}function x(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP_ENI_ATTACHMENT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=(i=e&&e.eni,i==null||i===!1?i:i.attachment),i==null||i===!1?i:i.attachmentId),{hash:{},data:t}))+"</dd>\n\n        <dt>"+a(n.i18n.call(e,"PROP_ENI_Attachment_OWNER",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.eni,i==null||i===!1?i:i.instanceOwnerId),{hash:{},data:t}))+"</dd>\n\n        <dt>"+a(n.i18n.call(e,"PROP_ENI_Attachment_STATE",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=(i=e&&e.eni,i==null||i===!1?i:i.attachment),i==null||i===!1?i:i.status),{hash:{},data:t}))+"</dd>\n        ",r}function T(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP_INSTANCE_PUBLIC_DNS",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=(i=e&&e.eni,i==null||i===!1?i:i.association),i==null||i===!1?i:i.publicDnsName),typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function N(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP_INSTANCE_PRIVATE_DNS",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.privateDnsName),typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function C(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP_ENI_IP_OWNER",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.ownerId),typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function k(e,t){var r="",i;r+="\n      <tr>\n        <td>"+a((i=e&&e.privateIpAddress,typeof i===u?i.apply(e):i)),i=n["if"].call(e,e&&e.primary,{hash:{},inverse:f.noop,fn:f.program(31,L,t),data:t});if(i||i===0)r+=i;r+="</td>\n        <td>",i=n["if"].call(e,(i=e&&e.association,i==null||i===!1?i:i.publicIp),{hash:{},inverse:f.program(35,O,t),fn:f.program(33,A,t),data:t});if(i||i===0)r+=i;return r+="</td>\n      </tr>\n      ",r}function L(e,t){return"<span>(Primary)</span>"}function A(e,t){var n;return a((n=(n=e&&e.association,n==null||n===!1?n:n.publicIp),typeof n===u?n.apply(e):n))}function O(e,t){return"-"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article class="property-app">\n  <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP_INSTANCE_DETAIL",{hash:{},data:i}))+'\n  <a href="#" class="icon-syslog tooltip property-btn-get-system-log action-link" data-tooltip="'+a(n.i18n.call(t,"PROP_INSTANCE_TIP_GET_SYSTEM_LOG",{hash:{},data:i}))+'" ></a>\n</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP_INSTANCE_INSTANCE_ID",{hash:{},data:i}))+"</dt>\n      <dd>"+a((o=t&&t.instanceId,typeof o===u?o.apply(t):o))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_STATE",{hash:{},data:i}))+'</dt>\n      <dd><i class="status status-'+a((o=t&&t.state,typeof o===u?o.apply(t):o))+'"></i>'+a((o=t&&t.state,typeof o===u?o.apply(t):o))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_LAUNCH_TIME",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.timeStr.call(t,t&&t.launchTime,{hash:{},data:i}))+'</dd>\n    </dl>\n\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP_INSTANCE_PRIMARY_PUBLIC_IP",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.ipAddress,{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_PUBLIC_DNS",{hash:{},data:i}))+'</dt>\n      <dd class="click-select tooltip" data-tooltip="'+a(n.i18n.call(t,"PROP_ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:i}))+'">'+a(n.emptyStr.call(t,t&&t.dnsName,{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_PRIMARY_PRIVATE_IP",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.privateIpAddress,{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_PRIVATE_DNS",{hash:{},data:i}))+'</dt>\n      <dd class="click-select tooltip" data-tooltip="'+a(n.i18n.call(t,"PROP_ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:i}))+'">'+a(n.emptyStr.call(t,t&&t.privateDnsName,{hash:{},data:i}))+'</dd>\n    </dl>\n\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP_INSTANCE_AMI",{hash:{},data:i}))+'</dt>\n      <dd><a href="#" data-uid="'+a((o=t&&t.imageId,typeof o===u?o.apply(t):o))+'" id="property-app-ami">'+a((o=t&&t.imageId,typeof o===u?o.apply(t):o))+"</a><dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_TYPE",{hash:{},data:i}))+"</dt>\n      <dd>"+a((o=t&&t.instanceType,typeof o===u?o.apply(t):o))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_KEY_PAIR",{hash:{},data:i}))+"</dt>\n      ",o=n["if"].call(t,t&&t.app_view,{hash:{},inverse:f.program(6,p,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n    </dl>\n\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP_INSTANCE_EBS_OPTIMIZED",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.ebsOptimized,{hash:{},data:i}))+"<dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_TENANCY",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,(o=t&&t.placement,o==null||o===!1?o:o.tenancy),{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_ROOT_DEVICE_TYPE",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.rootDeviceType,{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_BLOCK_DEVICE",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.blockDevice,{hash:{},data:i}))+"</dd>\n    </dl>\n  </div>\n\n  ",o=n["if"].call(t,t&&t.rootDevice,{hash:{},inverse:f.noop,fn:f.program(14,y,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n["if"].call(t,t&&t.eni,{hash:{},inverse:f.noop,fn:f.program(19,E,i),data:i});if(o||o===0)s+=o;return s+='\n\n  <div class="option-group-head"> '+a(n.i18n.call(t,"PROP_INSTANCE_SG_DETAIL",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n\n</article>\n',s};return e.template(t)}),function(){define("module/design/property/instance/app_view",["../base/view","./template/app","i18n!nls/lang.js","instance_model","kp_upload","Design","component/exporter/JsonExporter"],function(e,t,n,r,i,s,o){var u,a,f;return a=o.download,f=function(e,t){return function(){var n;return $("body").hasClass("safari")?n=null:n=new Blob([t]),n?(a(n,e),null):{data:"data://text/plain;,"+t,name:e}}},u=e.extend({__kpUpload:null,events:{"click #property-app-keypair":"keyPairClick","click #property-app-ami":"openAmiPanel","click .property-btn-get-system-log":"openSysLogModal"},kpModalClosed:!1,render:function(){var e;return e=this.model.toJSON(),e.windows=this.model.get("osType")==="windows",this.$el.html(t(e)),this.model.attributes.name},keyPairClick:function(e){return this.proccessKpStuff()},proccessKpStuff:function(e){var t,n,r,i,o;return o=this.model.get("keyName"),n=!1,e||(i=this.model.resModel.connectionTargets("KeypairUsage")[0],t=i&&i.isDefault()&&i.get("appId")==="DefaultKP---"+s.instance().get("id"),r=i&&!i.isDefault(),n=t||r,n&&this.model.downloadKp(o)),!n&&this.model.get("osType")==="windows"?this.decryptPassword(n):this.loginPrompt(n)},loginPrompt:function(e){var t,n;return t=this.model.get("keyName"),modal(MC.template.modalDownloadKP({name:t,loginCmd:this.model.get("loginCmd"),isOldKp:e,windows:this.model.get("osType")==="windows"})),n=this,$("#keypair-cmd").off("click").on("click",function(e){return e.currentTarget.select&&e.currentTarget.select(),e.stopPropagation()}),!1},decryptPassword:function(e){var t,n;return n=this,t=this.model.get("keyName"),e||this.model.getPasswordData(null,"check"),modal(MC.template.modalDecryptPassword({name:t,isOldKp:e})),$("#modal-wrap").on("closed",function(){return n.kpModalClosed=!0,null}),$("#do-kp-decrypt").off("click").on("click",function(e){return n.model.getPasswordData(n.__kpUpload.getData())}),this.kpModalClosed=!1,!1},updateKPModal:function(e,t,n,r){var s,o,u,a,l;if(this.kpModalClosed)return;if(e==="check")return t?(this.__kpUpload&&this.__kpUpload.remove(),this.__kpUpload=new i,this.__kpUpload.on("load",function(){return $("#do-kp-decrypt").prop("disabled",!1)}),$("#modal-box .import-zone").html(this.__kpUpload.render().el),$("#modal-box .decrypt-action").show()):($("#modal-box .import-zone").html(""),$("#modal-box .no-password").show());if(e==="got")return $("#do-kp-decrypt").prop("disabled",!0),s=$("#keypair-pwd"),u=s.get(0),s.val(t),u.select(),u.focus(),$("#do-kp-decrypt").text("Decrypted"),$(".change-pw-recommend").show();if(e==="download"){l=t,a=n,o=r||n,$("#keypair-kp-download").off("click").on("click",f(""+this.model.get("keyName")+".pem",o)),$("#keypair-loading").hide(),$("#keypair-body").show();if(this.model.get("osType")==="windows")return $("#keypair-pwd-old").val(a).off("click").on("click",function(){return this.select()}),$("#keypair-show").one("click",function(){return $("#keypair-pwd-old").prop("type","input")})}},openAmiPanel:function(e){return this.trigger("OPEN_AMI",$(e.target).data("uid")),!1},openSysLogModal:function(){var e,t,n;return t=this.model.get("instanceId"),n=this,e=MC.canvas_data.region,r.GetConsoleOutput({sender:n},$.cookie("usercode"),$.cookie("session_id"),e,t),modal(MC.template.modalInstanceSysLog({instance_id:t,log_content:""},!0)),n.off("EC2_INS_GET_CONSOLE_OUTPUT_RETURN").on("EC2_INS_GET_CONSOLE_OUTPUT_RETURN",function(e){return e.is_error||void 0,n.refreshSysLog(e.resolved_data)}),!1},refreshSysLog:function(e){var t,n;return $("#modal-instance-sys-log .instance-sys-log-loading").hide(),e&&e.output?(n=MC.base64Decode(e.output),t=$("#modal-instance-sys-log .instance-sys-log-content"),t.html(MC.template.convertBreaklines({content:n})),t.show()):$("#modal-instance-sys-log .instance-sys-log-info").show(),modal.position()}}),new u})}.call(this),function(){define("module/design/property/instance/main",["../base/main","./model","./view","./app_model","./app_view","../sglist/main","constant","event"],function(e,t,n,r,i,s,o,u){var a,f;return f={},f[u.PROPERTY_REFRESH_ENI_IP_LIST]=function(){return this.model.getEni&&this.model.getEni(),this.view.refreshIPList&&this.view.refreshIPList(),null},a=e.extend({ideEvents:f,handleTypes:[o.RESTYPE.INSTANCE,"component_asg_instance"],onUnloadSubPanel:function(e){return s.onUnloadSubPanel(e),null},setupStack:function(){return this.view.on("OPEN_AMI",function(t){return e.loadSubPanel("STATIC",t)}),null},initStack:function(){return this.model=t,this.view=n,null},afterLoadStack:function(){return s.loadModule(this.model),null},setupApp:function(){var t;return t=this,this.model.on("KEYPAIR_DOWNLOAD",function(e,n,r){return t.view.updateKPModal("download",e,n,r)}),this.model.on("PASSWORD_STATE",function(e){return t.view.updateKPModal("check",e)}),this.model.on("PASSWORD_GOT",function(e){return t.view.updateKPModal("got",e)}),this.view.on("OPEN_AMI",function(t){return e.loadSubPanel("STATIC",t)}),null},initApp:function(){return this.model=r,this.view=i,null},afterLoadApp:function(){return s.loadModule(this.model),null}}),null})}.call(this),function(){define("module/design/property/servergroup/app_model",["../base/model","../instance/model","constant","i18n!nls/lang.js","Design"],function(e,t,n,r,i){var s;return s=e.extend({init:function(e){var t,n,s,o,u,a;return this.set("uid",e),this.set("readOnly",!this.isAppEdit),s=i.instance().component(e),n=s.get("imageId"),t=s.getAmi()||s.get("cachedAmi"),t?(this.set("ami",{id:n,name:t.name,icon:""+t.osType+"."+t.architecture+"."+t.rootDeviceType+".png"}),this.set("type_editable",t.rootDeviceType!=="instance-store")):notification("warning",sprintf(r.ide.PROP_MSG_ERR_AMI_NOT_FOUND,n)),o=s.getBlockDeviceMapping(),o.length===1&&this.set("rootDevice",o[0]),a=s.get(!0),this.set("instance_type",s.getInstanceTypeList()),this.set("ebs_optimized",s.get("ebsOptimized")),this.set("can_set_ebs",s.isEbsOptimizedEnabled()),u=s.connectionTargets("RTB_Route").length,u&&this.set("number_disable",!0),this.set("number",s.get("count")),this.set("name",s.get("name")),this.getGroupList(),this.getEni(),null},setCount:function(e){var t;return t=this.get("uid"),i.instance().component(t).setCount(e),this.getGroupList(),null},getGroupList:function(){var e,t,n,r,s,o,u,a,f,l,c,h,p,d,v,m,g,y;p=this.get("uid"),t=i.instance().component(p),h=MC.data.resource_list[i.instance().region()],e=h[t.get("appId")],c=t.get("name"),o=[{appId:t.get("appId"),name:c+"-0",status:e?e.instanceState.name:"Unknown",launchTime:e?e.launchTime:""}],n=t.get("count"),t.groupMembers().length>n-1?l=t.groupMembers().slice(0,n-1):l=t.groupMembers();for(a=d=0,m=l.length;d<m;a=++d)f=l[a],o.push({name:c+"-"+(a+1),appId:f.appId,status:h[f.appId]?h[f.appId].instanceState.name:"Unknown",isNew:!f.appId,isOld:f.appId&&a+1>=n});while(o.length<n)o.push({name:c+"-"+o.length,isNew:!0,status:"Unknown"});s=0,y=t.groupMembers();for(u=v=0,g=y.length;v<g;u=++v){r=y[u];if(!r.appId)break;s=u+1}return s+=1,o.length>1?(this.set("group",o),s>n?o.increment="-"+(s-n):s<n&&(o.increment="+"+(n-s))):this.set("group",o[0]),null},getEni:t.getEni,setEbsOptimized:t.setEbsOptimized,canSetInstanceType:t.canSetInstanceType,setInstanceType:t.setInstanceType,setIp:t.setIp,canAddIP:t.canAddIP,isValidIp:t.isValidIp,addIp:t.addIp,removeIp:t.removeIp,attachEip:t.attachEip}),new s})}.call(this),define("module/design/property/servergroup/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return'class="expand"'}function c(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP_INSTANCE_DETAIL",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-instance-count" >'+u(n.i18n.call(e,"PROP_INSTANCE_NUMBER",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP_INSTANCE_REQUIRE",{hash:{},data:t}))+'</span>\n      <input class="input tooltip" type="text" value="'+u((i=e&&e.number,typeof i===a?i.apply(e):i))+'" id="property-instance-count" data-ignore="true" data-required="true" data-type="digits" ',i=n["if"].call(e,e&&e.number_disable,{hash:{},inverse:f.program(6,p,t),fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+="/>\n    </section>\n\n    ",i=n["if"].call(e,e&&e.ami,{hash:{},inverse:f.noop,fn:f.program(8,d,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n["if"].call(e,e&&e.type_editable,{hash:{},inverse:f.program(21,S,t),fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;r+="\n  </div>\n\n  ",i=n["if"].call(e,e&&e.rootDevice,{hash:{},inverse:f.noop,fn:f.program(23,x,t),data:t});if(i||i===0)r+=i;r+="\n\n  ",i=n["if"].call(e,e&&e.eni,{hash:{},inverse:f.noop,fn:f.program(28,C,t),data:t});if(i||i===0)r+=i;return r+='\n\n  <div class="option-group-head"> '+u(n.i18n.call(e,"PROP_INSTANCE_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n  ',r}function h(e,t){var r="";return r+='disabled="disabled" data-tooltip="'+u(n.i18n.call(e,"PROP_INSTANCE_TIP_YOU_CANNOT_SPECIFY_INSTANCE_NUMBER",{hash:{},data:t}))+'"',r}function p(e,t){var r="";return r+='data-tooltip="'+u(n.i18n.call(e,"PROP_INSTANCE_TIP_IF_THE_QUANTITY_IS_MORE_THAN_1",{hash:{},data:t}))+'"',r}function d(e,t){var r="",i;return r+='\n    <section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP_INSTANCE_AMI",{hash:{},data:t}))+'</label>\n      <div id="property-ami" class="property-block-wrap clearfix" data-uid=\''+u((i=(i=e&&e.ami,i==null||i===!1?i:i.id),typeof i===a?i.apply(e):i))+'\'>\n        <img class="property-ami-icon left" src="./assets/images/ide/ami/'+u((i=(i=e&&e.ami,i==null||i===!1?i:i.icon),typeof i===a?i.apply(e):i))+'" / >\n        <div class="property-ami-label">'+u((i=(i=e&&e.ami,i==null||i===!1?i:i.name),typeof i===a?i.apply(e):i))+"</div>\n      </div>\n    </section>\n    ",r}function v(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,(i=e&&e.instance_type,i==null||i===!1?i:i.length),{hash:{},inverse:f.noop,fn:f.program(11,m,t),data:t});if(i||i===0)r+=i;return r+="\n    ",r}function m(e,t){var r="",i;r+='\n    <section class="property-control-group">\n      <label class="left">'+u(n.i18n.call(e,"PROP_INSTANCE_TYPE",{hash:{},data:t}))+'</label>\n      <div class="selectbox selectbox-mega" id="instance-type-select">\n        <div class="selection"></div>\n        <ul class="dropdown">\n          ',i=n.each.call(e,e&&e.instance_type,{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;r+='\n        </ul>\n      </div>\n    </section>\n    <section class="property-control-group ',i=n.unless.call(e,e&&e.can_set_ebs,{hash:{},inverse:f.noop,fn:f.program(17,w,t),data:t});if(i||i===0)r+=i;r+='">\n      <div class="checkbox">\n        <input id="property-instance-ebs-optimized" type="checkbox" value="None" ',i=n["if"].call(e,e&&e.ebs_optimized,{hash:{},inverse:f.noop,fn:f.program(19,E,t),data:t});if(i||i===0)r+=i;return r+=' name="ebs-optimized" />\n        <label for="property-instance-ebs-optimized"></label>\n      </div>\n      <label for="property-instance-ebs-optimized">EBS Optimized</label>\n    </section>\n    ',r}function g(e,t){var r="",i;r+='\n          <li class="',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:f.noop,fn:f.program(13,y,t),data:t});if(i||i===0)r+=i;r+='tooltip item" data-tooltip="'+u((i=e&&e.main,typeof i===a?i.apply(e):i))+'" data-id="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.hide,{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+='>\n            <div class="main truncate">'+u((i=e&&e.main,typeof i===a?i.apply(e):i))+'</div>\n            <div class="sub"><span>'+u((i=e&&e.ecu,typeof i===a?i.apply(e):i))+"</span> <span>"+u((i=e&&e.core,typeof i===a?i.apply(e):i))+"</span> <span>"+u((i=e&&e.mem,typeof i===a?i.apply(e):i))+"</span></div>\n          </li>\n          ",r}function y(e,t){return"selected "}function b(e,t){return'style="display:none;"'}function w(e,t){return"hide"}function E(e,t){return'checked="checked"'}function S(e,t){var r="";return r+='\n    <section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP_INSTANCE_TYPE",{hash:{},data:t}))+'</label>\n      <p class="property-info">Updating instance type is disabled for instances using instance store for root device.</p>\n    </section>\n    ',r}function x(e,t){var r="",i;r+='\n  <div class="option-group-head">Root Device</div>\n  <div class="option-group">\n    <article class="property-app">\n      <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(e,"PROP_VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.DeviceName),{hash:{},data:t}))+"</dd>\n        <dt>"+u(n.i18n.call(e,"PROP_VOLUME_TYPE",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.emptyStr.call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.VolumeType),{hash:{},data:t}))+"</dd>\n        ",i=n["if"].call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.SnapshotId),{hash:{},inverse:f.noop,fn:f.program(24,T,t),data:t});if(i||i===0)r+=i;r+="\n        <dt>"+u(n.i18n.call(e,"PROP_VOLUME_SIZE",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.emptyStr.call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.VolumeSize),{hash:{},data:t}))+" GB</dd>\n        ",i=n["if"].call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.Iops),{hash:{},inverse:f.noop,fn:f.program(26,N,t),data:t});if(i||i===0)r+=i;return r+="\n      </dl>\n    </article>\n  </div>\n  ",r}function T(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP_VOLUME_SNAPSHOT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.SnapshotId),typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function N(e,t){var n="",r;return n+="\n        <dt>IOPS</dt>\n        <dd>"+u((r=(r=(r=e&&e.rootDevice,r==null||r===!1?r:r.Ebs),r==null||r===!1?r:r.Iops),typeof r===a?r.apply(e):r))+"</dd>\n        ",n}function C(e,t){var r="";return r+='\n  <div class="option-group-head">'+u(n.i18n.call(e,"PROP_INSTANCE_ENI_DETAIL",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <section class="property-control-group">\n      <div class="network-list-wrap">\n        <div class="network-list-header clearfix">\n          '+u(n.i18n.call(e,"PROP_INSTANCE_ENI_IP_ADDRESS",{hash:{},data:t}))+'\n          <button id="instance-ip-add" class="right btn btn-blue btn-small tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ENI_TIP_ADD_IP_ADDRESS",{hash:{},data:t}))+'">'+u(n.i18n.call(e,"PROP_INSTANCE_ENI_ADD_IP",{hash:{},data:t}))+'</button>\n        </div>\n        <ul class="network-list" id="property-network-list" data-bind="true"></ul>\n      </div>\n    </section>\n  </div>\n  ',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n  <div id="prop-appedit-ami-list" ',o=n["if"].call(t,t&&t.readOnly,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+=">\n\n  </div>\n  ",o=n.unless.call(t,t&&t.readOnly,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+="\n</article>\n",s};return e.template(t)}),define("module/design/property/servergroup/template/ami_list",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n",i=n.unless.call(e,(i=e&&e.group,i==null||i===!1?i:i.length),{hash:{},inverse:u.program(5,p,t),fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){var r="",i;r+='\n<div class="option-group-head ',i=n["if"].call(e,e&&e.readOnly,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;return r+='">Instance Summary</div>\n<div class="option-group">\n  <dl class="dl-vertical">\n    <dt>'+a(n.i18n.call(e,"PROP_INSTANCE_INSTANCE_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+a((i=(i=e&&e.group,i==null||i===!1?i:i.appId),typeof i===f?i.apply(e):i))+"</dd>\n\n    <dt>"+a(n.i18n.call(e,"PROP_INSTANCE_STATE",{hash:{},data:t}))+'</dt>\n    <dd><i class="status status-'+a((i=(i=e&&e.group,i==null||i===!1?i:i.status),typeof i===f?i.apply(e):i))+' icon-label"></i>'+a((i=(i=e&&e.group,i==null||i===!1?i:i.status),typeof i===f?i.apply(e):i))+"</dd>\n\n    <dt>"+a(n.i18n.call(e,"PROP_INSTANCE_LAUNCH_TIME",{hash:{},data:t}))+"</dt>\n    <dd>"+a(n.timeStr.call(e,(i=e&&e.group,i==null||i===!1?i:i.launchTime),{hash:{},data:t}))+"</dd>\n  </dl>\n<div>\n",r}function h(e,t){return"expand"}function p(e,t){var r="",i;r+='\n<div class="option-group-head ',i=n["if"].call(e,e&&e.readOnly,{hash:{},inverse:u.noop,fn:u.program(3,h,t),data:t});if(i||i===0)r+=i;r+='">Server Group Members<span class="property-head-num-wrap">('+a((i=(i=e&&e.group,i==null||i===!1?i:i.length),typeof i===f?i.apply(e):i))+')</span> <span class="appedit-head-meta appedit-head-meta-add">'+a((i=(i=e&&e.group,i==null||i===!1?i:i.increment),typeof i===f?i.apply(e):i))+'</span></div>\n<ul class="option-group property-list">\n  ',i=n.each.call(e,e&&e.group,{hash:{},inverse:u.noop,fn:u.program(6,d,t),data:t});if(i||i===0)r+=i;return r+="\n</ul>\n",r}function d(e,t){var r="",i;r+='\n    <li>\n      <i class="status status-'+a((i=e&&e.status,typeof i===f?i.apply(e):i))+' icon-label tooltip" data-tooltip="'+a((i=e&&e.status,typeof i===f?i.apply(e):i))+'"></i>'+a((i=e&&e.name,typeof i===f?i.apply(e):i))+"\n      ",i=n["if"].call(e,e&&e.appId,{hash:{},inverse:u.noop,fn:u.program(7,v,t),data:t});if(i||i===0)r+=i;r+="\n      ",i=n["if"].call(e,e&&e.isNew,{hash:{},inverse:u.program(11,g,t),fn:u.program(9,m,t),data:t});if(i||i===0)r+=i;return r+="\n    </li>\n  ",r}function v(e,t){var n="",r;return n+='<span class="subtitle">('+a((r=e&&e.appId,typeof r===f?r.apply(e):r))+")</span>",n}function m(e,t){return'<div class="subtitle subtitle-launch">Launch after applying updates</div>\n      '}function g(e,t){var r="",i;i=n["if"].call(e,e&&e.isOld,{hash:{},inverse:u.noop,fn:u.program(12,y,t),data:t});if(i||i===0)r+=i;return r+="\n      ",r}function y(e,t){return'<div class="subtitle subtitle-terminate">Terminate after applying updates</div>'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a=this.escapeExpression,f="function";o=n["if"].call(t,t&&t.group,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n",s};return e.template(t)}),function(){define("module/design/property/servergroup/app_view",["../base/view","../instance/view","./template/app","./template/ami_list","i18n!nls/lang.js"],function(e,t,n,r,i){var s;return s=e.extend({events:{"change #property-instance-count":"countChange","click #property-ami":"openAmiPanel","OPTION_CHANGE #instance-type-select":"instanceTypeSelect","change #property-instance-ebs-optimized":"ebsOptimizedSelect","click .toggle-eip":"setEip","click #instance-ip-add":"addIp","click #property-network-list .icon-remove":"removeIp","change .input-ip":"syncIPList"},render:function(){return this.$el.html(n(this.model.attributes)),this.updateInstanceList(),this.refreshIPList(),this.model.attributes.name},openAmiPanel:function(e){return this.trigger("OPEN_AMI",$(e.currentTarget).data("uid")),!1},updateInstanceList:function(){return $("#prop-appedit-ami-list").html(r(this.model.attributes)),null},countChange:function(e){var t,n;t=$(e.currentTarget),t.parsley("custom",function(e){if(isNaN(e)||e>99||e<1)return i.ide.PARSLEY_THIS_VALUE_MUST_BETWEEN_1_99});if(!t.parsley("validate"))return;return n=+t.val(),this.model.setCount(n),this.updateInstanceList(),this.setEditableIP(n===1),null},ebsOptimizedSelect:function(e){return this.model.setEbsOptimized(e.target.checked),null},instanceTypeSelect:t.instanceTypeSelect,addIp:t.addIp,removeIp:t.removeIp,setEip:t.setEip,syncIPList:t.syncIPList,refreshIPList:t.refreshIPList,updateIPAddBtnState:t.updateIPAddBtnState,setEditableIP:t.setEditableIP,validateIpItem:t.validateIpItem}),new s})}.call(this),function(){define("module/design/property/servergroup/main",["../base/main","./app_model","./app_view","../sglist/main","constant","event"],function(e,t,n,r,i,s){var o,u;return u={},u[s.PROPERTY_REFRESH_ENI_IP_LIST]=function(){return this.model.getEni(),this.view.refreshIPList(),null},o=e.extend({ideEvents:u,handleTypes:"component_server_group",onUnloadSubPanel:function(e){return r.onUnloadSubPanel(e),null},initApp:function(){return this.model=t,this.model.isAppEdit=!1,this.view=n,null},setupAppEdit:function(){return this.view.on("OPEN_AMI",function(t){return e.loadSubPanel("STATIC",t)}),null},initAppEdit:function(){return this.model=t,this.model.isAppEdit=!0,this.view=n,null},afterLoadAppEdit:function(){return r.loadModule(this.model),null}}),null})}.call(this),function(){define("module/design/property/connection/model",["../base/model","Design","constant"],function(e,t,n){var r;return r=e.extend({init:function(e){var r,i;return i=t.instance().component(e),i?(i.type==="EniAttachment"?r={name:"Instance-ENI Attachment",eniAsso:{instance:i.getTarget(n.RESTYPE.INSTANCE).get("name"),eni:i.getTarget(n.RESTYPE.ENI).get("name")}}:i.type==="ElbSubnetAsso"&&(r={name:"Load Balancer-Subnet Association",subnetAsso:{elb:i.getTarget(n.RESTYPE.ELB).get("name"),subnet:i.getTarget(n.RESTYPE.SUBNET).get("name")}}),this.set(r)):!1}}),new r})}.call(this),define("module/design/property/connection/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n	<div class="property-control-group">This is an attachment of '+a((r=(r=e&&e.eniAsso,r==null||r===!1?r:r.instance),typeof r===u?r.apply(e):r))+" to "+a((r=(r=e&&e.eniAsso,r==null||r===!1?r:r.eni),typeof r===u?r.apply(e):r))+"</div>\n",n}function c(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e&&e.subnetAsso,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function h(e,t){var n="",r;return n+='\n  <div class="property-control-group">A Virtual Network Interface is placed in '+a((r=(r=e&&e.subnetAsso,r==null||r===!1?r:r.subnet),typeof r===u?r.apply(e):r))+" for "+a((r=(r=e&&e.subnetAsso,r==null||r===!1?r:r.elb),typeof r===u?r.apply(e):r))+" to allow traffic be routed to this availability zone.</div>\n  ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+="<article>\n\n",o=n["if"].call(t,t&&t.eniAsso,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/connection/view",["../base/view","./template/stack"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name}}),new n})}.call(this),function(){define("module/design/property/connection/main",["../base/main","./model","./view"],function(e,t,n){var r;return r=e.extend({handleTypes:["EniAttachment","ElbSubnetAsso"],initStack:function(){return this.model=t,this.view=n,null},initApp:function(){return this.model=t,this.view=n,null},initAppEdit:function(){return this.model=t,this.view=n,null}}),null})}.call(this),function(){define("module/design/property/staticsub/model",["../base/model","constant","../base/main"],function(e,t,n){var r;return r=e.extend({init:function(e){var t,n,r,i,s,o;this.set("isApp",this.isApp),t=MC.data.dict_ami[e];if(t){this.set(t),this.set("instance_type",MC.aws.ami.getInstanceType(t).join(", ")),this.set("ami",!0),this.set("name",t.name);return}if(e.indexOf("ami-")===0){this.set("ami",{unavailable:!0}),this.set("name",e);return}this.set("name",e),r=MC.data.config[Design.instance().region()].snapshot_list;if(r&&r.item){o=r.item;for(i=0,s=o.length;i<s;i++){n=o[i];if(n.snapshotId===e){this.set(n);return}}}return!1},canChangeAmi:function(e){var t,r,i;return t=Design.instance().component(n.activeModule().uid),i=t.getAmi()||t.get("cachedAmi"),r=MC.data.dict_ami[e],!i&&!r?"Ami info is missing, please reopen stack and try again.":i.osType==="windows"&&r.osType!=="windows"?"Changing AMI platform is not supported. To use a "+r.osFamily+" AMI, please create a new instance instead.":i.osType!=="windows"&&r.osType==="windows"?"Changing AMI platform is not supported. To use a "+r.osFamily+" AMI, please create a new instance instead.":(r.instance_type||r.instanceType||"").indexOf(t.get("instanceType"))===-1?""+r.name+" does not support previously used instance type "+t.get("instanceType")+". Please change another AMI.":!0},getAmiPngName:function(e){var t;return t=MC.data.dict_ami[e],t?""+t.osType+"."+t.architecture+"."+t.rootDeviceType:"ami-not-available"},getAmiName:function(e){var t;return t=MC.data.dict_ami[e],t?t.name:""},changeAmi:function(e){return Design.instance().component(n.activeModule().uid).setAmi(e),this.init(e),null},getInstanceName:function(){return Design.instance().component(n.activeModule().uid).get("name")}}),new r})}.call(this),define("module/design/property/staticsub/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n\n",i=n["if"].call(e,e&&e.isApp,{hash:{},inverse:a.program(5,p,t),fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n.unless.call(e,(i=e&&e.ami,i==null||i===!1?i:i.unavailable),{hash:{},inverse:a.noop,fn:a.program(8,v,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,(i=e&&e.ami,i==null||i===!1?i:i.unavailable),{hash:{},inverse:a.noop,fn:a.program(3,h,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function h(e,t){var r="";return r+='\n    <div class="property-control-group property-ami-info">\n        <p>'+u(n.i18n.call(e,"PROP_AMI_APP_NOT_AVAILABLE",{hash:{},data:t}))+"</p>\n    </div>\n    ",r}function p(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,(i=e&&e.ami,i==null||i===!1?i:i.unavailable),{hash:{},inverse:a.noop,fn:a.program(6,d,t),data:t});if(i||i===0)r+=i;return r+='\n    <div class="property-control-group property-ami-info">\n        <div class="property-control-group tac">\n            <button id="changeAmi" class="btn btn-blue"><i class="icon-edit icon-label"></i>Change AMI</button>\n        </div>\n    </div>\n    <div class="property-control-group hide" id="changeAmiPanel">\n        <p>Drag image from Resource Panel and drop below to change AMI.</p>\n        <div id="changeAmiDropZone">\n            <p>Drop AMI Here</p>\n            <div class="resource-icon resource-icon-instance">\n                <img src="assets/images/ide/ami/amazon.i386.ebs.png" width="39" height="27">\n                <div class="resource-label"></div>\n            </div>\n        </div>\n        <div class="hide" id="confirmChangeAmiWrap">\n            <p id="changeAmiWarning"></p>\n            <button id="confirmChangeAmi" class="btn btn-blue">Confirm Change AMI</button>\n        </div>\n        <button id="cancelChangeAmi" class="btn-link">Cancel</button>\n    </div>\n',r}function d(e,t){var r="";return r+='\n    <div class="property-control-group property-ami-info">\n        '+u(n.i18n.call(e,"PROP_AMI_STACK_NOT_AVAILABLE",{hash:{},data:t}))+"\n    </div>\n    ",r}function v(e,t){var r="",i;return r+='\n    <dl class="dl-vertical property-ami-info">\n    <dt>'+u(n.i18n.call(e,"PROP_INSTANCE_AMI_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.imageId,typeof i===f?i.apply(e):i))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_AMI_NAME",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.name,typeof i===f?i.apply(e):i))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_AMI_DESC",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.description,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_ROOT_DEVICE_TYPE",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.rootDeviceType,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_AMI_ARCHITECH",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.architecture,typeof i===f?i.apply(e):i))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_AMI_VIRTUALIZATION",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.virtualizationType,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_AMI_KERNEL_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.kernelId,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_AMI_OS_TYPE",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.osType,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_AMI_SUPPORT_INSTANCE_TYPE",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.instance_type,{hash:{},data:t}))+"</dd>\n    </dl>\n    ",r}function m(e,t){var r="",i;return r+='\n    <dl class="dl-vertical">\n    <dt>Snapshot ID</dt>\n    <dd>'+u((i=e&&e.snapshotId,typeof i===f?i.apply(e):i))+"</dd>\n    <dt>Volume ID</dt>\n    <dd>"+u((i=e&&e.volumeId,typeof i===f?i.apply(e):i))+"</dd>\n    <dt>Description</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.description,{hash:{},data:t}))+"</dd>\n    <dt>Capacity</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.volumeSize,{hash:{},data:t}))+"GB</dd>\n    <dt>Owner</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.ownerId,{hash:{},data:t}))+"</dd>\n    <dt>Started</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.startTime,{hash:{},data:t}))+"</dd>\n    </dl>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<article class="property-app">\n',o=n["if"].call(t,t&&t.ami,{hash:{},inverse:a.program(10,m,i),fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/staticsub/view",["../base/view","./template/stack"],function(e,t){var n;return n=e.extend({events:{"click #changeAmi":"showChangeAmiPanel","click #confirmChangeAmi":"changeAmi","click #cancelChangeAmi":"hideChangeAmiPanel","drop  #changeAmiDropZone":"onDropAmi"},render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name},showChangeAmiPanel:function(){return $("#changeAmiPanel").show().siblings(".property-ami-info").hide(),$("#changeAmiDropZone").children().hide().filter("p").show(),$("#confirmChangeAmiWrap").hide(),null},hideChangeAmiPanel:function(){return $("#changeAmiPanel").hide().siblings(".property-ami-info").show(),null},onDropAmi:function(e,t){var n;return $("#changeAmiPanel").data("amiId",t),$("#confirmChangeAmiWrap").show(),n=this.model.canChangeAmi(t),n===!0?($("#changeAmiWarning").hide(),$("#confirmChangeAmi").show()):($("#changeAmiWarning").html(n).show(),$("#confirmChangeAmi").hide()),$("#changeAmiDropZone").children().show().filter("p").hide(),$("#changeAmiDropZone").find("img").attr("src","./assets/images/ide/ami/"+this.model.getAmiPngName(t)+".png"),$("#changeAmiDropZone").find(".resource-label").html(this.model.getAmiName(t)),null},changeAmi:function(){var e;return e=$("#changeAmiPanel").data("amiId"),this.model.changeAmi(e),this.trigger("AMI_CHANGE"),null}}),new n})}.call(this),function(){define("module/design/property/staticsub/main",["../base/main","./model","./view","event","Design"],function(e,t,n,r,i){var s;return n.on("AMI_CHANGE",function(){var t;return t=i.instance().component(e.activeModule().uid),r.trigger(r.OPEN_PROPERTY,t.type,t.id),null}),s=e.extend({subPanelID:"STATIC",initStack:function(){return this.model=t,this.view=n,this.model.isApp=!1,null},initApp:function(){return this.model=t,this.view=n,this.model.isApp=!0,null},initAppEdit:function(){return this.model=t,this.view=n,this.model.isApp=!0,null}}),null})}.call(this),function(){define("module/design/property/missing/main",["../base/main","../base/model","../base/view","constant"],function(e,t,n,r){var i,s,o,u,a;return s=n.extend({render:function(){var e,t;return e=Design.instance().component(this.model.get("uid")),(t=Design.instance().get("state"))!=="Stopped"&&t!=="Stopping"||e.type!==r.RESTYPE.ASG?(this.$el.html(MC.template.missingPropertyPanel()),"Resource Unavailable"):(this.$el.html(MC.template.missingAsgWhenStop({asgName:e.get("name")})),""+e.get("name")+" Deleted")}}),a=new s,o=t.extend({init:function(e){return this.set("uid",e)}}),u=new o,i=e.extend({handleTypes:"Missing_Resource",initApp:function(){return this.model=u,this.view=a,null},initAppEdit:function(){return this.model=u,this.view=a,null}}),null})}.call(this),function(){define("module/design/property/sg/model",["../base/model","Design","constant","event"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var n,r,i,s,o,u,a,f;this.component=n=t.instance().component(e);if(this.isReadOnly){this.appInit(e);return}o=[],f=n.connections("SgRuleSet");for(u=0,a=f.length;u<a;u++)s=f[u],o=o.concat(s.toPlainObjects(e,!0));return i=_.map(n.getMemberList(),function(e){return e.get("name")}),this.set({uid:e,name:n.get("name"),description:n.get("description"),members:i,rules:o,color:n.color,ruleEditable:!0}),this.sortSGRule(),n.isElbSg()?r=!0:this.isAppEdit&&(r=n.get("appId")),(r||n.isDefault())&&this.set("nameReadOnly",!0),r&&this.set("descReadOnly",!0),null},setDescription:function(e){return t.instance().component(this.get("uid")).set("description",e),null},sortSGRule:function(e){return this.attributes.rules=_.sortBy(this.attributes.rules,e||"direction"),null},addRule:function(e){var n,r,i,s,o,u,a,f,l,c;a=this.get("uid"),i=t.instance().component(a),e.relation[0]==="@"?u=t.instance().component(e.relation.substr(1)):u=i.createIpTarget(e.relation),n=t.modelClassForType("SgRuleSet"),o=new n(i,u),r=o.ruleCount(i.id),o.addRawRule(i.id,e.direction,e);if(r<o.ruleCount(i.id)){s=[],c=i.connections("SgRuleSet");for(f=0,l=c.length;f<l;f++)e=c[f],s=s.concat(e.toPlainObjects(a,!0));return this.attributes.rules=s,this.sortSGRule(),!0}return!1},createSGRuleData:function(){var e;return e=_.map(t.modelClassForType(n.RESTYPE.SG).allObjects(),function(e){return{id:e.id,color:e.color,name:e.get("name")}}),{isClassic:!1,sgList:e}},removeRule:function(e){var n;return n=t.instance().component(e.ruleSetId),n.removeRuleByPlainObj(e),null},appInit:function(e){var n,r,i,s,o,u,a,f,l,c;r=t.instance().region(),i=this.component.get("appId"),n=MC.data.resource_list[r][i],u=[],c=this.component.connections("SgRuleSet");for(f=0,l=c.length;f<l;f++)o=c[f],u=u.concat(o.toPlainObjects(e));return s=_.map(this.component.connectionTargets("SgAsso"),function(e){return e.get("name")}),a={uid:e,name:this.component.get("name"),color:this.component.color,groupName:n.groupName,description:n.groupDescription,groupId:n.groupId,ownerId:n.ownerId,vpcId:n.vpcId,members:s,rules:u},this.set(a),this.sortSGRule(),null}}),new i})}.call(this),define("module/design/property/sg/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return'disabled="disabled"'}function c(e,t){var r="";return r+='\n		<a href="#" class="icon-add tooltip add-rule action-link" id="sg-add-rule-icon" data-tooltip=\''+u(n.i18n.call(e,"PROP_SG_TIP_CREATE_RULE",{hash:{},data:t}))+"' ></a>\n		",r}function h(e,t){var n="";return n+='<li class="sg-member-name">'+u(typeof e===a?e.apply(e):e)+"</li>",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article>\n	<div class="option-group-head expand">'+u(n.i18n.call(t,"PROP_SG_TIT_DETAIL",{hash:{},data:i}))+'</div>\n	<div class="option-group" data-bind="true">\n		<div class="property-control-group">\n			<label for="securitygroup-name" >'+u(n.i18n.call(t,"PROP_SG_DETAIL_LBL_NAME",{hash:{},data:i}))+'</label>\n			<span class="required-input right">'+u(n.i18n.call(t,"PROP_LBL_REQUIRED",{hash:{},data:i}))+'</span>\n			<input class="input"  type="text" id="securitygroup-name" ',o=n["if"].call(t,t&&t.nameReadOnly,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+=' value="'+u((o=t&&t.name,typeof o===a?o.apply(t):o))+'" maxlength="255" data-ignore="true" data-required-rollback="true"/>\n		</div>\n		<div class="property-control-group">\n			<label for="securitygroup-description" >'+u(n.i18n.call(t,"PROP_SG_DETAIL_LBL_DESCRIPTION",{hash:{},data:i}))+'</label>\n			<input class="input" type="text" id="securitygroup-description" ',o=n["if"].call(t,t&&t.descReadOnly,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+=' value="'+u((o=t&&t.description,typeof o===a?o.apply(t):o))+'" maxlength="255" data-type="ascii" data-ignore="true"/>\n		</div>\n	</div>\n\n	<div class="option-group-head expand">'+u(n.i18n.call(t,"PROP_SG_TIT_RULE",{hash:{},data:i}))+'\n		<span class="property-head-num-wrap">(<span id="rule-count">'+u((o=(o=t&&t.rules,o==null||o===!1?o:o.length),typeof o===a?o.apply(t):o))+"</span>)</span>\n		",o=n["if"].call(t,t&&t.ruleEditable,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n	</div>\n	<div class="option-group">\n		<div class="rule-list-sort property-control-group">\n			<h5>'+u(n.i18n.call(t,"PROP_SG_RULE_SORT_BY",{hash:{},data:i}))+'</h5>\n			<div class="selectbox" id="sg-rule-filter-select">\n				<div class="selection">'+u(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</div>\n				<ul class="dropdown" tabindex="-1">\n					<li class="item selected" data-id="direction">'+u(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</li>\n					<li class="item" data-id="relation">'+u(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_SRC_DEST",{hash:{},data:i}))+'</li>\n					<li class="item" data-id="protocol">'+u(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_PROTOCOL",{hash:{},data:i}))+'</li>\n				</ul>\n			</div>\n		</div>\n\n		<ul class="sg-rule-list property-list" id="sg-rule-list"></ul>\n	</div>\n\n	<div class="option-group-head">'+u(n.i18n.call(t,"PROP_SG_TIT_MEMBER",{hash:{},data:i}))+'<span class="property-head-num-wrap">('+u((o=(o=t&&t.members,o==null||o===!1?o:o.length),typeof o===a?o.apply(t):o))+')</span>	</div>\n	<div class="option-group">\n		<ul class="sg-member-list property-list">\n			',o=n.each.call(t,t&&t.members,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;return s+="\n		</ul>\n	</div>\n\n</article>\n",s};return e.template(t)}),define("module/design/property/sg/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var n="";return n+=' <li class="sg-member-name">'+a(typeof e===u?e.apply(e):e)+"</li> ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article>\n  <dl class="dl-vertical">\n    <dt>'+a(n.i18n.call(t,"PROP_SG_APP_SG_NAME",{hash:{},data:i}))+"</dt>\n    <dd>"+a((o=t&&t.groupName,typeof o===u?o.apply(t):o))+"</dd>\n\n    <dt>"+a(n.i18n.call(t,"PROP_SG_APP_SG_ID",{hash:{},data:i}))+"</dt>\n    <dd>"+a((o=t&&t.groupId,typeof o===u?o.apply(t):o))+"</dd>\n\n    <dt>"+a(n.i18n.call(t,"PROP_SG_DETAIL_LBL_DESCRIPTION",{hash:{},data:i}))+"</dt>\n    <dd>"+a((o=t&&t.description,typeof o===u?o.apply(t):o))+"</dd>\n\n    <dt>"+a(n.i18n.call(t,"PROP_SG_APP_VPC_ID",{hash:{},data:i}))+"</dt>\n    <dd>"+a((o=t&&t.vpcId,typeof o===u?o.apply(t):o))+'</dd>\n  </dl>\n\n  <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP_SG_TIT_RULE",{hash:{},data:i}))+'\n    <span class="property-head-num-wrap">(<span id="rule-count">'+a((o=(o=t&&t.rules,o==null||o===!1?o:o.length),typeof o===u?o.apply(t):o))+'</span>)</span>\n  </div>\n  <div class="option-group">\n\n    <div class="rule-list-sort property-control-group">\n      <h5>'+a(n.i18n.call(t,"PROP_SG_RULE_SORT_BY",{hash:{},data:i}))+'</h5>\n      <div class="selectbox" id="sg-rule-filter-select">\n        <div class="selection">'+a(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</div>\n        <ul class="dropdown" tabindex="-1">\n          <li class="item selected" data-id="direction">'+a(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</li>\n          <li class="item" data-id="relation">'+a(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_SRC_DEST",{hash:{},data:i}))+'</li>\n          <li class="item" data-id="protocol">'+a(n.i18n.call(t,"PROP_SG_RULE_SORT_BY_PROTOCOL",{hash:{},data:i}))+'</li>\n        </ul>\n      </div>\n    </div>\n\n    <ul class="sg-rule-list property-list" id="sg-rule-list"></ul>\n  </div>\n\n  <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP_SG_TIT_MEMBER",{hash:{},data:i}))+'\n    <span class="property-head-num-wrap">(<span>'+a((o=(o=t&&t.members,o==null||o===!1?o:o.length),typeof o===u?o.apply(t):o))+'</span>)</span>\n  </div>\n  <div class="option-group">\n    <ul class="sg-member-list property-list">\n      ',o=n.each.call(t,t&&t.members,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n    </ul>\n  </div>\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/sg/view",["../base/view","./template/stack","./template/app","constant","i18n!nls/lang.js"],function(e,t,n,r,i){var s;return s=e.extend({events:{"click #sg-add-rule-icon":"showCreateRuleModal","click .sg-rule-delete":"removeRulefromList","change #securitygroup-name":"setSGName","change #securitygroup-description":"setSGDescription","OPTION_CHANGE #sg-rule-filter-select":"sortSgRule"},render:function(){var e;return e=this.model.isReadOnly?n:t,this.$el.html(e(this.model.toJSON())),this.refreshSgruleList(),this.setTitle(this.model.get("name")),this.prependTitle('<span class="sg-color" style="background-color:'+this.model.get("color")+'" ></span>'),this.forceShow(),setTimeout(function(){return $("#securitygroup-name").focus()},200),this.model.get("name")},refreshSgruleList:function(){var e;return e=this.model.get("rules"),e.deletable=this.model.get("ruleEditable"),$("#sg-rule-list").html(MC.template.sgRuleList(e))},showCreateRuleModal:function(e){return modal(MC.template.modalSGRule(this.model.createSGRuleData())),$("#sg-modal-direction").on("click","input",this.radioSgModalChange),$("#modal-protocol-select").on("OPTION_CHANGE",this.sgModalSelectboxChange),$("#protocol-icmp-main-select").on("OPTION_CHANGE",this.icmpMainSelect),$("#sg-protocol-select-result").on("OPTION_CHANGE",".protocol-icmp-sub-select",this.icmpSubSelect),$("#sg-modal-save").on("click",_.bind(this.saveSgModal,this)),$("#sg-add-model-source-select").on("OPTION_CHANGE",this.modalRuleSourceSelected),!1},radioSgModalChange:function(e){return $("#sg-modal-direction input:checked").val()==="inbound"?$("#rule-modal-ip-range").text("Source"):$("#rule-modal-ip-range").text("Destination")},sgModalSelectboxChange:function(e,t){return $("#sg-protocol-select-result").find(".show").removeClass("show"),$(".sg-protocol-option-input").removeClass("show"),$("#sg-protocol-"+t).addClass("show"),$(".protocol-icmp-sub-select").removeClass("shown"),$("#modal-protocol-select").data("protocal-type",t),null},icmpMainSelect:function(e,t){return $("#protocol-icmp-main-select").data("protocal-main",t),t==="3"||t==="5"||t==="11"||t==="12"?($(".protocol-icmp-sub-select").removeClass("shown"),$("#protocol-icmp-sub-select-"+t).addClass("shown")):$(".protocol-icmp-sub-select").removeClass("shown")},icmpSubSelect:function(e,t){return $("#protocol-icmp-main-select").data("protocal-sub",t)},modalRuleSourceSelected:function(e){var t,n;return n=$.trim($(e.target).find(".selected").attr("data-id")),t=n==="custom",$("#securitygroup-modal-description").toggle(t),$("#sg-add-model-source-select .selection").width(t?69:322),null},setSGName:function(e){var t,n,r;return r=$(e.currentTarget),t=r.val(),this.checkResName(r,"SG")&&(n=this.model.get("name"),this.model.setName(t),this.setTitle(this.model.get("name")),this.prependTitle('<span class="sg-color" style="background-color:'+this.model.get("color")+'" ></span>'),$("#sg-rule-list").children().find(".rule-reference").each(function(){$(this).text()===n&&$(this).html(title)})),null},setSGDescription:function(e){return this.model.setDescription(e.target.value),null},sortSgRule:function(e){return this.model.sortSGRule($(e.target).find(".selected").attr("data-id")),this.refreshSgruleList(),null},removeRulefromList:function(e){var t,n,r;return t=$(e.target).closest("li"),n={ruleSetId:t.attr("data-uid"),port:t.attr("data-port"),protocol:t.attr("data-protocol"),direction:t.attr("data-direction"),relation:t.attr("data-relationid")},t.remove(),r=$("#sg-rule-list").children().length,$("#rule-count").text(r),this.model.removeRule(n),!1},saveSgModal:function(e){var t,n,r,s,o,u,a,f,l,c,h,p,d,v;c=$("#sg-modal-direction input:checked").val(),n=$("#securitygroup-modal-description"),p=$("#sg-protocol-tcp input"),d=$("#sg-protocol-udp input"),t=$("#sg-protocol-custom input"),o=$("#modal-protocol-select").data("protocal-type"),h=$.trim($("#sg-add-model-source-select").find(".selected").attr("data-id")),v={custom:{dom:t,method:function(e){return MC.validate.portRange(e)?Number(e)<0||Number(e)>255?i.ide.PARSLEY_THE_PROTOCOL_NUMBER_RANGE_MUST_BE_0_255:null:i.ide.PARSLEY_MUST_BE_A_VALID_FORMAT_OF_NUMBER}},tcp:{dom:p,method:function(e){var t;return t=[],t=MC.validate.portRange(e),t?MC.validate.portValidRange(t)?null:i.ide.PARSLEY_PORT_RANGE_BETWEEN_0_65535:i.ide.PARSLEY_MUST_BE_A_VALID_FORMAT_OF_PORT_RANGE}},udp:{dom:d,method:function(e){var t;return t=[],t=MC.validate.portRange(e),t?MC.validate.portValidRange(t)?null:i.ide.PARSLEY_PORT_RANGE_BETWEEN_0_65535:i.ide.PARSLEY_MUST_BE_A_VALID_FORMAT_OF_PORT_RANGE}}},o in v&&(r=v[o],r.dom.parsley("custom",r.method)),n.parsley("custom",function(e){return MC.validate("cidr",e)?null:i.ide.PARSLEY_MUST_BE_CIDR_BLOCK});if(h==="custom"&&!n.parsley("validate")||r&&!r.dom.parsley("validate"))return;l={protocol:o,direction:c||"inbound",fromPort:"",toPort:""};switch(o){case"tcp":case"udp":s=$("#sg-protocol-"+o+" input").val().split("-"),l.fromPort=s[0].trim(),s.length>=2&&(l.toPort=s[1].trim());break;case"icmp":u=$("#protocol-icmp-main-select").data("protocal-main"),a=$("#protocol-icmp-main-select").data("protocal-sub"),l.fromPort=u,l.toPort=a;break;case"custom":l.protocol=$("#sg-protocol-custom input").val()}return h==="custom"?l.relation=n.val():l.relation="@"+$("#sg-add-model-source-select").children("ul").children(".selected").attr("data-uid"),f=this.model.addRule(l),f?(this.refreshSgruleList(),modal.close()):notification("warning",i.ide.PROP_WARN_SG_RULE_EXIST)}}),new s})}.call(this),function(){define("module/design/property/sg/main",["../base/main","./model","./view"],function(e,t,n){var r;return r=e.extend({subPanelID:"SG",initStack:function(){return this.model=t,this.model.isReadOnly=!1,this.model.isAppEdit=!1,this.view=n,null},initApp:function(){return this.model=t,this.model.isReadOnly=!0,this.model.isAppEdit=!1,this.view=n,null},initAppEdit:function(){return this.model=t,this.model.isReadOnly=!1,this.model.isAppEdit=!0,this.view=n,null}}),null})}.call(this),function(){define("module/design/property/sgrule/model",["../base/model","Design"],function(e,t){var n;return n=e.extend({init:function(e){var n,r,i;i=t.instance().component(e);if(!i)return;return n=t.modelClassForType("SgRuleSet"),r=n.getRelatedSgRuleSets(i.port1Comp(),i.port2Comp()),this.set({uid:e,groups:n.getGroupedObjFromRuleSets(r),readOnly:this.isApp}),null}}),new n})}.call(this),define("module/design/property/sgrule/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var n="",r;n+='\n  <div class="property-group-head truncate"><span class="sg-color sg-color-rule-header" style="background-color:'+a((r=e&&e.ownerColor,typeof r===u?r.apply(e):r))+'"></span>'+a((r=e&&e.ownerName,typeof r===u?r.apply(e):r))+'</div>\n  <ul class="property-group sg-rule-list property-list">',r=(r=e&&e.ruleListTpl,typeof r===u?r.apply(e):r);if(r||r===0)n+=r;return n+="</ul>\n  ",n}function c(e,t){var r="";return r+='\n  <div class="tac property-control-group">\n    <button class="btn" id="sg-edit-rule-button" style="width:180px;"><i class="icon-edit icon-label"></i>'+a(n.i18n.call(e,"PROP_SGRULE_BTN_EDIT_RULE",{hash:{},data:t}))+"</button>\n  </div>\n  ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article>\n  <section class="property-info" style="margin-top:0;">\n    <div class="property-control-group">'+a(n.i18n.call(t,"PROP_SGRULE_DESCRIPTION",{hash:{},data:i}))+"</div>\n  </section>\n\n	",o=n.each.call(t,t&&t.groups,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n.unless.call(t,t&&t.readOnly,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>\n\n",s};return e.template(t)}),function(){define("module/design/property/sgrule/view",["../base/view","./template/stack","component/sgrule/SGRulePopup"],function(e,t,n){var r;return r=e.extend({events:{"click #sg-edit-rule-button":"onEditRule"},render:function(){var e,n,r,i;i=this.model.attributes.groups;for(n=0,r=i.length;n<r;n++)e=i[n],e.ruleListTpl=MC.template.sgRuleList(e.rules);return this.$el.html(t(this.model.attributes)),"Security Group Rule"},onEditRule:function(e){return new n(this.model.get("uid")),!1}}),new r})}.call(this),function(){define("module/design/property/sgrule/main",["../base/main","./model","./view"],function(e,t,n){var r;return r=e.extend({handleTypes:["ElbAmiAsso","SgRuleLine"],initStack:function(){return this.model=t,this.model.isApp=!1,this.view=n,null},initApp:function(){return this.model=t,this.model.isApp=!0,this.view=n,null},initAppEdit:function(){return this.model=t,this.model.isApp=!1,this.view=n,null}}),null})}.call(this),function(){define("module/design/property/volume/model",["../base/model","constant","Design"],function(e,t,n){var r;return r=e.extend({init:function(e){var t,r,i,s,o,u,a,f;t=n.instance().component(e),i=t.attributes;if(!i.owner)return void 0,!1;o={isWin:i.name[0]!=="/",isStandard:i.volumeType==="standard",iops:i.iops,volume_size:i.volumeSize,snapshot_id:i.snapshotId,name:i.name},o.isWin?o.editName=o.name.slice(-1):o.editName=o.name.slice(5);if(o.snapshot_id){s=MC.data.config[n.instance().region()].snapshot_list;if(s&&s.item){f=s.item;for(u=0,a=f.length;u<a;u++){r=f[u];if(r.snapshotId===o.snapshot_id){o.snapshot_size=r.volumeSize,o.snapshot_desc=r.description;break}}}}return o.volume_size<10&&(o.iopsDisabled=!0),this.set("volume_detail",o),this.set("uid",e),null},setDeviceName:function(e){var r,i,s,o,u,a,f,l,c,h,p,d,v;l=this.get("uid"),h=n.instance().component(l);if(!h){f=l.split("_"),i=f[2],o=f[0],s=n.instance().component(o),p=n.modelClassForType(t.RESTYPE.VOL),r=p&&p.allObjects()||[];for(d=0,v=r.length;d<v;d++){c=r[d];if(c.get("owner")===s&&c.get("name")===i){u=h.genFullName(e),a=""+f+"_volume_"+e,c.set("name",u),MC.canvas.update(l,"text","volume_name",u),MC.canvas.update(f,"id","volume_"+i,a),this.attributes.volume_detail.name=u,this.attributes.volume_detail.editName=e,this.set("uid",a);break}}}else u=h.genFullName(e),h.set("name",u),MC.canvas.update(l,"text","volume_name",u),this.attributes.volume_detail.name=u;return null},setVolumeSize:function(e){var r,i,s,o,u,a,f,l,c,h,p;a=this.get("uid"),l=n.instance().component(a);if(!l){u=a.split("_"),i=u[2],o=u[0],s=n.instance().component(o),c=n.modelClassForType(t.RESTYPE.VOL),r=c&&c.allObjects()||[];for(h=0,p=r.length;h<p;h++){f=r[h];if(f.get("owner")===s&&f.get("name")===i){f.set("volumeSize",e);break}}}else l.set("volumeSize",e);return null},setVolumeTypeStandard:function(){var e,t;return e=this.get("uid"),t=n.instance().component(e),t.set({volumeType:"standard",iops:""})},setVolumeTypeIops:function(e){var t,r;return t=this.get("uid"),r=n.instance().component(t),r.set({volumeType:"io1",iops:e})},setVolumeIops:function(e){var t;return t=this.get("uid"),n.instance().component(t).set("iops",e),null},genFullName:function(e){if(comp.name[0]!=="/"){if(comp.name==="xvd"+e)return!0}else if(comp.name.indexOf(e)!==-1)return!0},isDuplicate:function(e){var r,i,s,o,u,a,f,l,c,h,p;a=this.get("uid"),l=n.instance().component(a),c=n.modelClassForType(t.RESTYPE.VOL),r=c&&c.allObjects()||[];if(!l){u=a.split("_"),i=u[2],o=u[0],s=n.instance().component(o);for(h=0,p=r.length;h<p;h++){f=r[h];if(f.get("owner")===s){l=f;break}}}return _.some(r,function(t){var n;n=t.genFullName(e);if(t!==l&&t.get("name")===n)return!0})}}),new r})}.call(this),define("module/design/property/volume/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n            <label for="volume-device">xvd</label>\n            <input class="input input-device"  type="text" value="'+a((r=(r=e&&e.volume_detail,r==null||r===!1?r:r.editName),typeof r===u?r.apply(e):r))+'" id="volume-device" data-ignore="true" data-required-rollback="true" maxlength="1"/>\n            ',n}function c(e,t){var n="",r;return n+='\n            <label for="volume-device">/dev/</label>\n            <input class="input input-device"  type="text" value="'+a((r=(r=e&&e.volume_detail,r==null||r===!1?r:r.editName),typeof r===u?r.apply(e):r))+'" id="volume-device" data-ignore="true" data-required-rollback="true" maxlength="5"/>\n            ',n}function h(e,t){var r="",i;return r+='\n    <section class="property-control-group">\n        <label>'+a(n.i18n.call(e,"PROP_VOLUME_SNAPSHOT",{hash:{},data:t}))+'</label>\n        <div id="snapshot-info-group" class="clearfix property-block-wrap" data-uid=\''+a((i=(i=e&&e.volume_detail,i==null||i===!1?i:i.snapshot_id),typeof i===u?i.apply(e):i))+"'>\n            <div>"+a((i=(i=e&&e.volume_detail,i==null||i===!1?i:i.snapshot_id),typeof i===u?i.apply(e):i))+' <span class="mgl5">'+a((i=(i=e&&e.volume_detail,i==null||i===!1?i:i.snapshot_size),typeof i===u?i.apply(e):i))+"GB</span> </div>\n            <div><span>"+a((i=(i=e&&e.volume_detail,i==null||i===!1?i:i.snapshot_desc),typeof i===u?i.apply(e):i))+"</span></div>\n        </div>\n    </section>\n    ",r}function p(e,t){return'checked="checked"'}function d(e,t){var r="";return r+='class="tooltip" data-tooltip="'+a(n.i18n.call(e,"PROP_VOLUME_MSG_WARN",{hash:{},data:t}))+'"',r}function v(e,t){var n="";return n}function m(e,t){return"disabled"}function g(e,t){return'style="display:none"'}function y(e,t){return'style="display:block"'}function b(e,t){return'\n            <input id="iops-ranged" type="text" class="input" value="100" name="iops-ranged" min="100" max="2000" required="">\n            '}function w(e,t){var n="",r;return n+='\n            <input class="input" id="iops-ranged" type="text" value="'+a((r=(r=e&&e.volume_detail,r==null||r===!1?r:r.iops),typeof r===u?r.apply(e):r))+'" name="iops-ranged" min="100" max="2000" required="">\n            ',n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article id=\'property-panel-volume\' data-bind="true" data-focus="none">\n    <section class="property-control-group">\n        <label>'+a(n.i18n.call(t,"PROP_VOLUME_DEVICE_NAME",{hash:{},data:i}))+'</label>\n        <div class="name">\n            ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.isWin),{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n        </div>\n    </section>\n    <section class="property-control-group">\n        <label>'+a(n.i18n.call(t,"PROP_VOLUME_SIZE",{hash:{},data:i}))+'</label>\n        <div class="ranged-number-input">\n            <label for="volume-size-ranged"></label>\n            <input id="volume-size-ranged" type="text" class="input" value="'+a((o=(o=t&&t.volume_detail,o==null||o===!1?o:o.volume_size),typeof o===u?o.apply(t):o))+'" name="volume-size-ranged" data-ignore="true" maxlength="4" data-required="true" data-required="true" data-type="number"/>\n        <label for="volume-property-ranged-number" >GB</label>\n        </div>\n    </section>\n\n    ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.snapshot_id),{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+='\n\n    <section class="property-control-group">\n        <label>'+a(n.i18n.call(t,"PROP_VOLUME_TYPE",{hash:{},data:i}))+'</label>\n        <div class="context" id="volume-type-radios">\n            <div>\n            <div class="radio">\n                <input id="radio-standard" type="radio" name="volume-type" ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.isStandard),{hash:{},inverse:f.noop,fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+=' value="radio-standard"/>\n                <label for="radio-standard"></label>\n            </div>\n            <label for="radio-standard">'+a(n.i18n.call(t,"PROP_VOLUME_TYPE_STANDARD",{hash:{},data:i}))+"</label>\n            </div>\n            <div ",o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.iopsDisabled),{hash:{},inverse:f.noop,fn:f.program(9,d,i),data:i});if(o||o===0)s+=o;s+='>\n            <div class="radio">\n                <input id="radio-iops" type="radio" name="volume-type" ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.isStandard),{hash:{},inverse:f.program(7,p,i),fn:f.program(11,v,i),data:i});if(o||o===0)s+=o;s+=' value="radio-iops" ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.iopsDisabled),{hash:{},inverse:f.noop,fn:f.program(13,m,i),data:i});if(o||o===0)s+=o;s+='/>\n                <label for="radio-iops"></label>\n            </div>\n            <label for="radio-iops">'+a(n.i18n.call(t,"PROP_VOLUME_TYPE_IOPS",{hash:{},data:i}))+'</label>\n            </div>\n        </div>\n    </section>\n\n    <section class="property-control-group" id="iops-group" ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.isStandard),{hash:{},inverse:f.program(17,y,i),fn:f.program(15,g,i),data:i});if(o||o===0)s+=o;s+='>\n        <label>IOPS</label>\n        <div class="ranged-number-input">\n            <label for="iops-ranged"></label>\n            ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.isStandard),{hash:{},inverse:f.program(21,w,i),fn:f.program(19,b,i),data:i});if(o||o===0)s+=o;return s+='\n        <label for="volume-property-ranged-number" ></label>\n        </div>\n    </section>\n</article>\n',s};return e.template(t)}),function(){define("module/design/property/volume/view",["../base/view","./template/stack","event","i18n!nls/lang.js"],function(e,t,n,r){var i;return i=e.extend({events:{"click #volume-type-radios input":"volumeTypeChecked","change #volume-device":"deviceNameChanged","keyup #volume-size-ranged":"sizeChanged","keyup  #volume-size-ranged":"processIops","keyup #iops-ranged":"sizeChanged","click #snapshot-info-group":"showSnapshotDetail"},render:function(){return void 0,this.$el.html(t(this.model.attributes)),$("#volume-size-ranged").parsley("custom",function(e){e=+e;if(!e||e>1024||e<1)return r.ide.PARSLEY_VOLUME_SIZE_MUST_IN_1_1024}),$("#iops-ranged").parsley("custom",function(e){var t;e=+e,t=parseInt($("#volume-size-ranged").val(),10);if(e>4e3||e<100)return r.ide.PARSLEY_IOPS_MUST_BETWEEN_100_4000;if(e>10*t)return r.ide.PARSLEY_IOPS_MUST_BE_LESS_THAN_10_TIMES_OF_VOLUME_SIZE}),this.model.attributes.volume_detail.name},volumeTypeChecked:function(e){return this.processIops(),$("#volume-type-radios input:checked").val()==="radio-standard"?($("#iops-group").hide(),this.model.setVolumeTypeStandard()):($("#iops-group").show(),this.model.setVolumeTypeIops($("#iops-ranged").val())),this.sizeChanged()},deviceNameChanged:function(e){var t,n,i,s,o;s=$(e.currentTarget),n=s.val(),t=s.prev("label").text(),o=t==="/dev/"?"linux":"windows",i=this,s.parsley("custom",function(e){if(!MC.validate.deviceName(e,o,!0))return o==="linux"?r.ide.PARSLEY_DEVICENAME_LINUX:r.ide.PARSLEY_DEVICENAME_WINDOWS;if(i.model.isDuplicate(e))return sprintf(r.ide.PARSLEY_VOLUME_NAME_INUSE,e)});if(s.parsley("validate"))return this.model.setDeviceName(n),this.setTitle(this.model.attributes.volume_detail.name)},processIops:function(e){var t,n;return n=parseInt($("#volume-size-ranged").val(),10),t=$("#radio-iops").is(":checked"),n>=10?this.enableIops():t||this.disableIops(),null},enableIops:function(){return $("#volume-type-radios > div").last().data("tooltip","").find("input").removeAttr("disabled")},disableIops:function(){return $("#volume-type-radios > div").last().data("tooltip","Volume size must be at least 10 GB to use Provisioned IOPS volume type.").find("input").attr("disabled","")},sizeChanged:function(e){var t,n,r,i;return r=parseInt($("#volume-size-ranged").val(),10),n=!0,i=$("#volume-size-ranged").parsley("validate"),t=$("#radio-iops").is(":checked"),t&&(n=$("#iops-ranged").parsley("validate")),i&&n&&(this.trigger("VOLUME_SIZE_CHANGED",r),t&&this.model.setVolumeIops($("#iops-ranged").val())),null},showSnapshotDetail:function(e){return this.trigger("OPEN_SNAPSHOT",$("#snapshot-info-group").data("uid")),null}}),new i})}.call(this),function(){define("module/design/property/volume/app_model",["../base/model","Design"],function(e,t){var n;return n=e.extend({init:function(e){var n,r,i;return r=t.instance().component(e),r?n=r.get("appId"):n=e,i=MC.data.resource_list[t.instance().region()][n],i?(i.attachmentSet&&(i.name=i.attachmentSet.item[0].device),this.set(i)):!1}}),new n})}.call(this),define("module/design/property/volume/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+="\n    <dt>"+u(n.i18n.call(e,"PROP_VOLUME_SNAPSHOT_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.snapshotId,typeof i===a?i.apply(e):i))+"</dd>\n    ",r}function c(e,t){var n="",r;return n+="\n    <dt>IOPS</dt>\n    <dd>"+u((r=e&&e.iops,typeof r===a?r.apply(e):r))+"</dd>\n    ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(t,"PROP_VOLUME_ID",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,t&&t.volumeId,{hash:{},data:i}))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP_VOLUME_DEVICE_NAME",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,t&&t.name,{hash:{},data:i}))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP_VOLUME_STATE",{hash:{},data:i}))+'</dt>\n    <dd><i class="status status-'+u((o=t&&t.status,typeof o===a?o.apply(t):o))+'"></i>'+u((o=t&&t.status,typeof o===a?o.apply(t):o))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP_VOLUME_CREATE_TIME",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.timeStr.call(t,t&&t.createTime,{hash:{},data:i}))+'</dd>\n  </dl>\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(t,"PROP_VOLUME_TYPE",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,t&&t.volumeType,{hash:{},data:i}))+"</dd>\n    ",o=n["if"].call(t,t&&t.snapshotId,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n    <dt>"+u(n.i18n.call(t,"PROP_VOLUME_SIZE",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,t&&t.size,{hash:{},data:i}))+" GB</dd>\n    ",o=n["if"].call(t,t&&t.iops,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+='\n  </dl>\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(t,"PROP_VOLUME_ATTACHMENT_STATE",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,(o=(o=(o=t&&t.attachmentSet,o==null||o===!1?o:o.item),o==null||o===!1?o:o[0]),o==null||o===!1?o:o.status),{hash:{},data:i}))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP_VOLUME_INSTANCE_ID",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,(o=(o=(o=t&&t.attachmentSet,o==null||o===!1?o:o.item),o==null||o===!1?o:o[0]),o==null||o===!1?o:o.instanceId),{hash:{},data:i}))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP_VOLUME_ATTACHMENT_TIME",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.timeStr.call(t,(o=(o=(o=t&&t.attachmentSet,o==null||o===!1?o:o.item),o==null||o===!1?o:o[0]),o==null||o===!1?o:o.attachTime),{hash:{},data:i}))+"</dd>\n  </dl>\n</article>\n\n",s};return e.template(t)}),function(){define("module/design/property/volume/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name}}),new n})}.call(this),function(){define("module/design/property/volume/main",["../base/main","./model","./view","./app_model","./app_view","constant"],function(e,t,n,r,i,s){var o;return o=e.extend({handleTypes:[s.RESTYPE.VOL,"component_asg_volume"],setupStack:function(){var n;return n=this,this.view.on("VOLUME_SIZE_CHANGED",function(e){return n.model.setVolumeSize(e),MC.canvas.update(t.attributes.uid,"text","volume_size",e+"GB")}),this.model.once("REFRESH_PANEL",function(){return n.view.render()}),this.view.on("OPEN_SNAPSHOT",function(t){return e.loadSubPanel("STATIC",t),null}),null},initStack:function(){return this.model=t,this.view=n,null},initApp:function(){return this.model=r,this.view=i,null},initAppEdit:function(){return this.model=r,this.view=i,null}}),null})}.call(this),function(){define("module/design/property/elb/model",["../base/model","event","Design","constant"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;l=n.instance().component(e),this.getAppData(e),o=l.toJSON(),o.uid=e,o.isVpc=!0,v=l.getHealthCheckTarget(),o.pingProtocol=v[0],o.pingPort=v[1],o.pingPath=v[2],o.sslCert&&(o.sslCert=o.sslCert.toJSON()),T=o.listeners;for(y=0,E=T.length;y<E;y++){d=T[y];if(d.protocol==="SSL"||d.protocol==="HTTPS"){o.showCert=!0;break}}if(!o.isVpc){t=n.modelClassForType(r.RESTYPE.AZ),c={},N=l.connectionTargets("ElbAmiAsso");for(b=0,S=N.length;b<S;b++)s=N[b],s.parent().type===r.RESTYPE.ASG?u=s.parent().parent():u=s.parent(),c[u.get("name")]=!0;m=/-[\w]/g,g=function(e){return" "+e[1].toUpperCase()},p=function(e){return e.type===r.RESTYPE.INSTANCE},a=t.allPossibleAZ();for(w=0,x=a.length;w<x;w++)u=a[w],c[u.name]?(u.disabled=c[u.name],u.selected=!0):(u.disabled=!1,u.selected=o.AvailabilityZones.indexOf(u.name)!==-1),u.displayName=u.name.replace(m,g),u.displayName=u.displayName[0].toUpperCase()+u.displayName.substr(1),u.id&&(f=n.instance().component(u.id),u.instanceCount=_.filter(f.children(),p).length);o.azArray=a}return h=l.connectionTargets("SslCertUsage")[0],i=n.modelClassForType(r.RESTYPE.IAM).allObjects(),o.noSSLCert=!0,o.sslCertItem=_.map(i,function(e){var t;return h===e&&(o.noSSLCert=!1),t=!1,e.get("certId")&&e.get("arn")&&(t=!0),{uid:e.id,name:e.get("name"),selected:h===e,disableCertEdit:t}}),o.ConnectionDraining&&(o.ConnectionDraining.Enabled===!0?(o.connectionDrainingEnabled=!0,o.connectionDrainingTimeout=o.ConnectionDraining.Timeout):o.connectionDrainingEnabled=!1),this.set(o),null},getAppData:function(e){var t,r,i;e=e||this.get("uid"),i=n.instance().component(e),t=MC.data.resource_list[n.instance().region()],r=t[i.get("appId")];if(!r)return;return this.set({appData:!0,isInternet:r.Scheme==="internet-facing",DNSName:r.DNSName,CanonicalHostedZoneNameID:r.CanonicalHostedZoneNameID}),null},setScheme:function(e){return e=e==="internal",n.instance().component(this.get("uid")).setInternal(e),e||n.modelClassForType(r.RESTYPE.IGW).tryCreateIgw(),null},setElbCrossAZ:function(e){return n.instance().component(this.get("uid")).set("crossZone",!!e),null},setHealthProtocol:function(e){return n.instance().component(this.get("uid")).setHealthCheckTarget(e),null},setHealthPort:function(e){return n.instance().component(this.get("uid")).setHealthCheckTarget(void 0,e),null},setHealthPath:function(e){return n.instance().component(this.get("uid")).setHealthCheckTarget(void 0,void 0,e),null},setHealthInterval:function(e){return n.instance().component(this.get("uid")).set("healthCheckInterval",e),null},setHealthTimeout:function(e){return n.instance().component(this.get("uid")).set("healthCheckTimeout",e),null},setHealthUnhealth:function(e){return n.instance().component(this.get("uid")).set("unHealthyThreshold",e),null},setHealthHealth:function(e){return n.instance().component(this.get("uid")).set("healthyThreshold",e),null},setListener:function(e,t){return n.instance().component(this.get("uid")).setListener(e,t),null},removeListener:function(e){return n.instance().component(this.get("uid")).removeListener(e),null},setCert:function(e){return n.instance().component(this.get("uid")).connectionTargets("SslCertUsage")[0].set(e),null},addCert:function(e){var t;return t=n.modelClassForType(r.RESTYPE.IAM),(new t(e)).assignTo(n.instance().component(this.get("uid"))),null},removeCert:function(e){return n.instance().component(e).remove(),null},updateElbAZ:function(e){return n.instance().component(this.get("uid")).set("AvailabilityZones",e),null},changeCert:function(e){var t,r,i,s,o;r=n.instance();if(e)r.component(e).assignTo(r.component(this.get("uid")));else{o=r.component(this.get("uid")).connections("SslCertUsage");for(i=0,s=o.length;i<s;i++)t=o[i],t.remove()}return null},updateCert:function(e,t){return n.instance().component(e).updateValue(t),null},getOtherCertName:function(e){var t,i;return t=n.modelClassForType(r.RESTYPE.IAM).allObjects(),i=[],_.each(t,function(t){var n;n=t.get("name");if(e!==n)return i.push(n)}),i},setConnectionDraining:function(e,t){var r;return e||(t=null),r=n.instance().component(this.get("uid")),r.set("ConnectionDraining",{Enabled:e,Timeout:t})},setAdvancedProxyProtocol:function(e,t){var r;return r=n.instance().component(this.get("uid")),r.setPolicyProxyProtocol(e,t)}}),new i})}.call(this),define("module/design/property/elb/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n    <dl class="dl-vertical property-app">\n      <dt>'+u(n.i18n.call(e,"PROP_ELB_SCHEME",{hash:{},data:t}))+"</dt>\n      <dd>",i=n["if"].call(e,e&&e.isInternet,{hash:{},inverse:a.program(4,h,t),fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_ELB_DNS_NAME",{hash:{},data:t}))+'</dt>\n      <dd>\n        <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:t}))+'">(A)'+u((i=e&&e.DNSName,typeof i===f?i.apply(e):i))+'</div>\n        <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:t}))+'">(AAAA)ipv6.'+u((i=e&&e.DNSName,typeof i===f?i.apply(e):i))+'</div>\n        <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:t}))+'">(A/AAAA)dualstack.'+u((i=e&&e.DNSName,typeof i===f?i.apply(e):i))+"</div>\n      </dd>\n      <dt>"+u(n.i18n.call(e,"PROP_ELB_HOST_ZONE_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.CanonicalHostedZoneNameID,typeof i===f?i.apply(e):i))+"<dd>\n    </dl>\n	",r}function c(e,t){return"Internet Facing"}function h(e,t){return"Internal"}function p(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left" for="property-elb-name" >'+u(n.i18n.call(e,"PROP_ELB_NAME",{hash:{},data:t}))+'</label>\n			<span class="required-input right">'+u(n.i18n.call(e,"PROP_ELB_REQUIRED",{hash:{},data:t}))+'</span>\n			<input data-ignore="true" data-required-rollback="true" maxlength="17" class="input elb-name"  type="text" value="'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" id="property-elb-name"/>\n		</section>\n\n		',i=n["if"].call(e,e&&e.isVpc,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function d(e,t){var r="",i;r+='\n		<section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP_ELB_SCHEME",{hash:{},data:t}))+'</label>\n      <div class="mgt5">\n        <div class="radio">\n            <input type="radio" ',i=n.unless.call(e,e&&e.internal,{hash:{},inverse:a.noop,fn:a.program(8,v,t),data:t});if(i||i===0)r+=i;r+=' value="internet" id="elb-scheme-select1" name="elb-schema-select"/>\n            <label for="elb-scheme-select1"></label>\n        </div>\n        <label for="elb-scheme-select1">Internet-facing</label>\n      </div>\n      <div class="mgt5">\n        <div class="radio">\n            <input type="radio" ',i=n["if"].call(e,e&&e.internal,{hash:{},inverse:a.noop,fn:a.program(8,v,t),data:t});if(i||i===0)r+=i;return r+=' value="internal" id="elb-scheme-select2" name="elb-schema-select"/>\n            <label for="elb-scheme-select2"></label>\n        </div>\n        <label for="elb-scheme-select2">Internal</label>\n    	</div>\n		</section>\n		',r}function v(e,t){return'checked="checked"'}function m(e,t){return"hide"}function g(e,t){var n;return u((n=e&&e.connectionDrainingTimeout,typeof n===f?n.apply(e):n))}function y(e,t){return"300"}function b(e,t){var r="",i;r+='\n		<li class="elb-property-listener">\n			<div class="elb-property-listener-item-remove icon-remove tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ELB_TIP_REMOVE_LISTENER",{hash:{},data:t}))+'" ',i=n.unless.call(e,t==null||t===!1?t:t.index,{hash:{},inverse:a.noop,fn:a.program(17,w,t),data:t});if(i||i===0)r+=i;r+='></div>\n\n			<div class="property-control-group clearfix">\n				<div class="elb-property-listener-item-1">\n					<label class="left">Load Balancer Protocol</label>\n					<div class="selectbox elb-property-elb-protocol">\n						<div class="selection">'+u((i=e&&e.protocol,typeof i===f?i.apply(e):i))+'</div>\n						<ul class="dropdown">\n							<li data-id="HTTP" class="item ',i=n.ifCond.call(e,e&&e.protocol,"HTTP",{hash:{},inverse:a.noop,fn:a.program(19,E,t),data:t});if(i||i===0)r+=i;r+='">HTTP</li>\n							<li data-id="HTTPS" class="item ',i=n.ifCond.call(e,e&&e.protocol,"HTTPS",{hash:{},inverse:a.noop,fn:a.program(19,E,t),data:t});if(i||i===0)r+=i;r+='">HTTPS</li>\n							<li data-id="TCP" class="item ',i=n.ifCond.call(e,e&&e.protocol,"TCP",{hash:{},inverse:a.noop,fn:a.program(19,E,t),data:t});if(i||i===0)r+=i;r+='">TCP</li>\n							<li data-id="SSL" class="item ',i=n.ifCond.call(e,e&&e.protocol,"SSL",{hash:{},inverse:a.noop,fn:a.program(19,E,t),data:t});if(i||i===0)r+=i;r+='">SSL</li>\n						</ul>\n					</div>\n				</div>\n				<div class="elb-property-listener-item-2">\n					<label class="left">Port</label>\n					<input class="input elb-property-elb-port tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ELB_TIP_25_80_443OR1024TO65535",{hash:{},data:t}))+'" type="text" value="'+u((i=e&&e.port,typeof i===f?i.apply(e):i))+'" data-ignore="true" data-required="true" data-type="digits" maxlength="5"/>\n				</div>\n			</div>\n\n			<div class="property-control-group clearfix">\n				<div class="left elb-property-listener-item-1">\n					<label class="left">Instance Protocol</label>\n					<div class="selectbox elb-property-instance-protocol">\n						<div class="selection">'+u((i=e&&e.instanceProtocol,typeof i===f?i.apply(e):i))+'</div>\n						<ul class="dropdown">\n							<li data-id="HTTP" class="item ',i=n.ifCond.call(e,e&&e.instanceProtocol,"HTTP",{hash:{},inverse:a.noop,fn:a.program(19,E,t),data:t});if(i||i===0)r+=i;r+='">HTTP</li>\n							<li data-id="HTTPS" class="item ',i=n.ifCond.call(e,e&&e.instanceProtocol,"HTTPS",{hash:{},inverse:a.noop,fn:a.program(19,E,t),data:t});if(i||i===0)r+=i;r+='">HTTPS</li>\n							<li data-id="TCP" class="item ',i=n.ifCond.call(e,e&&e.instanceProtocol,"TCP",{hash:{},inverse:a.noop,fn:a.program(19,E,t),data:t});if(i||i===0)r+=i;r+='">TCP</li>\n							<li data-id="SSL" class="item ',i=n.ifCond.call(e,e&&e.instanceProtocol,"SSL",{hash:{},inverse:a.noop,fn:a.program(19,E,t),data:t});if(i||i===0)r+=i;return r+='">SSL</li>\n						</ul>\n					</div>\n				</div>\n				<div class="left elb-property-listener-item-2">\n					<label class="left">Port</label>\n					<input class="input elb-property-instance-port tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ELB_TIP_1_65535",{hash:{},data:t}))+'" type="text" value="'+u((i=e&&e.instancePort,typeof i===f?i.apply(e):i))+'" data-ignore="true" data-required="true" data-type="digits" maxlength="5"/>\n				</div>\n			</div>\n		</li>\n		',r}function w(e,t){return'style="display:none;"'}function E(e,t){return"selected"}function S(e,t){return" selected"}function x(e,t){var r="",i;r+='\n								<li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(21,S,t),data:t});if(i||i===0)r+=i;r+='" data-id="'+u((i=e&&e.uid,typeof i===f?i.apply(e):i))+'">\n									'+u((i=e&&e.name,typeof i===f?i.apply(e):i)),i=n.unless.call(e,e&&e.disableCertEdit,{hash:{},inverse:a.noop,fn:a.program(24,T,t),data:t});if(i||i===0)r+=i;return r+='<span class="icon-remove"></span>\n								</li>\n							',r}function T(e,t){return'<span class="icon-edit"></span>'}function N(e,t){return'disabled="disabled"'}function C(e,t){var r="";return r+='\n	<div class="option-group-head expand">'+u(n.i18n.call(e,"PROP_ELB_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n	<div class="option-group sg-group"></div>\n\n	',r}function k(e,t){var r="",i;r+="\n		",i=n["if"].call(e,e&&e.azArray,{hash:{},inverse:a.noop,fn:a.program(31,L,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function L(e,t){var r="",i;r+='\n		<div class="option-group-head"> '+u(n.i18n.call(e,"PROP_ELB_AVAILABILITY_ZONE",{hash:{},data:t}))+' </div>\n		<div class="option-group" id="property-elb-az-cb-group">\n			',i=n.each.call(e,e&&e.azArray,{hash:{},inverse:a.noop,fn:a.program(32,A,t),data:t});if(i||i===0)r+=i;return r+="\n		</div>\n		",r}function A(e,t){var r="",i;r+='\n			<section class="property-control-group">\n				<div class="checkbox">\n					<input class="property-elb-az-checkbox" type="checkbox" ',i=n["if"].call(e,e&&e.disabled,{hash:{},inverse:a.noop,fn:a.program(26,N,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(8,v,t),data:t});if(i||i===0)r+=i;return r+=' data-name="'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" id="property-elb-az-'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'"/>\n					<label for="property-elb-az-'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'"></label>\n				</div>\n				<label for="property-elb-az-'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" class="checkbox-label-main">\n					<span>'+u((i=e&&e.displayName,typeof i===f?i.apply(e):i))+'</span></label>\n				<label for="property-elb-az-'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" class="checkbox-label-minor">'+u((i=e&&e.instanceCount,typeof i===f?i.apply(e):i))+" instances</label>\n			</section>\n			",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<article id="stack-elb-property-panel">\n\n	<div class="option-group-head expand">'+u(n.i18n.call(t,"PROP_ELB_DETAILS",{hash:{},data:i}))+'</div>\n	<div class="option-group" data-bind="true" >\n	',o=n["if"].call(t,t&&t.appData,{hash:{},inverse:a.program(6,p,i),fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n		<section class="property-control-group">\n			<div class="checkbox">\n				<input id="elb-cross-az-select" type="checkbox" ',o=n["if"].call(t,t&&t.crossZone,{hash:{},inverse:a.noop,fn:a.program(8,v,i),data:i});if(o||o===0)s+=o;s+='/>\n				<label for="elb-cross-az-select"></label>\n			</div>\n			<label for="elb-cross-az-select" >Enable cross-zone load balancing</label>\n			<a class="elb-info-icon tooltip icon-info" href="https://aws.amazon.com/about-aws/whats-new/2013/11/06/elastic-load-balancing-adds-cross-zone-load-balancing/" data-tooltip="'+u(n.i18n.call(t,"PROP_ELB_TIP_CLICK_TO_READ_RELATED_AWS_DOCUMENT",{hash:{},data:i}))+'" target="_blank"></a>\n		</section>\n		<section class="property-control-group">\n			<div class="checkbox">\n				<input id="elb-connection-draining-select" type="checkbox" ',o=n["if"].call(t,t&&t.connectionDrainingEnabled,{hash:{},inverse:a.noop,fn:a.program(8,v,i),data:i});if(o||o===0)s+=o;s+='/>\n				<label for="elb-connection-draining-select"></label>\n			</div>\n			<label for="elb-connection-draining-select" >Enable Connection Draining</label>\n			<a class="elb-info-icon tooltip icon-info" href="http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/conﬁg-conn-drain.html" data-tooltip="'+u(n.i18n.call(t,"PROP_ELB_TIP_CLICK_TO_READ_RELATED_AWS_DOCUMENT",{hash:{},data:i}))+'" target="_blank"></a>\n			<div class="elb-connection-draining-input-group ',o=n.unless.call(t,t&&t.connectionDrainingEnabled,{hash:{},inverse:a.noop,fn:a.program(10,m,i),data:i});if(o||o===0)s+=o;s+='">\n				<label for="elb-connection-draining-input" class="left">Timeout</label>\n				<input id="elb-connection-draining-input" class="input parsley-validated" type="text" value="',o=n["if"].call(t,t&&t.connectionDrainingTimeout,{hash:{},inverse:a.program(14,y,i),fn:a.program(12,g,i),data:i});if(o||o===0)s+=o;s+='" data-ignore="true" data-required="true" data-type="number">\n				<label for="elb-connection-draining-input">seconds</label>\n			</div>\n		</section>\n	</div>\n\n	<!--\n	<div class="option-group-head">Advanced Configuration</div>\n	<div class="option-group" data-bind="true"> <ul id="elb-property-listener-list" class="property-list">\n		<section class="property-control-group">\n			<label>Proxy Protocol</label>\n			<div class="mgt5">\n				<div class="checkbox">\n					<input id="elb-advanced-proxy-protocol-select" type="checkbox" ',o=n["if"].call(t,(o=t&&t.otherPoliciesMap,o==null||o===!1?o:o.EnableProxyProtocol),{hash:{},inverse:a.noop,fn:a.program(8,v,i),data:i});if(o||o===0)s+=o;s+='/>\n					<label for="elb-advanced-proxy-protocol-select"></label>\n				</div>\n				<label for="elb-advanced-proxy-protocol-select">Enable Proxy Protocol</label>\n				<div id="elb-advanced-proxy-protocol-select-tip" class="property-info ',o=n.unless.call(t,(o=t&&t.otherPoliciesMap,o==null||o===!1?o:o.EnableProxyProtocol),{hash:{},inverse:a.noop,fn:a.program(10,m,i),data:i});if(o||o===0)s+=o;s+='">If you have a Proxy Protocol enabled proxy server in front of your load balancer, then you must not enable Proxy Protocol on your load balancer.</div>\n			</div>\n		</section>\n	</div>\n	-->\n\n	<div class="option-group-head"> '+u(n.i18n.call(t,"PROP_ELB_LISTENER_DETAIL",{hash:{},data:i}))+' </div>\n	<div class="option-group" data-bind="true"> <ul id="elb-property-listener-list" class="property-list">\n		',o=n.each.call(t,t&&t.listeners,{hash:{},inverse:a.noop,fn:a.program(16,b,i),data:i});if(o||o===0)s+=o;s+='\n		</ul>\n		<a href="#" id="elb-property-listener-content-add" class="add-to-list action-link">'+u(n.i18n.call(t,"PROP_ELB_BTN_ADD_LISTENER",{hash:{},data:i}))+'</a>\n		<section class="property-control-group" id="property-control-group-cert-setting">\n			<label class="left">'+u(n.i18n.call(t,"PROP_ELB_SERVER_CERTIFICATE",{hash:{},data:i}))+'</label>\n			<div class="selectbox" id="sslcert-select">\n				<div class="selection"></div>\n				<div style="height: 120px; width:260px;" class="dropdown scroll-wrap scrollbar-auto-hide  clearfix">\n					<div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n					<div class="scroll-content">\n						<ul>\n							<li class="item',o=n["if"].call(t,t&&t.noSSLCert,{hash:{},inverse:a.noop,fn:a.program(21,S,i),data:i});if(o||o===0)s+=o;s+='">None</li>\n							',o=n.each.call(t,t&&t.sslCertItem,{hash:{},inverse:a.noop,fn:a.program(23,x,i),data:i});if(o||o===0)s+=o;s+='\n						</ul>\n					</div>\n				</div>\n				<div class="editor">\n					<a href="#" class="editbtn">Add New Certiﬁcate...</a>\n				</div>\n			</div>\n		</section>\n	</div>\n\n	<div class="option-group-head"> '+u(n.i18n.call(t,"PROP_ELB_HEALTH_CHECK_DETAILS",{hash:{},data:i}))+' </div>\n	<div class="option-group" data-bind="true" data-validate="parsley" >\n		<section class="property-control-group">\n			<label>'+u(n.i18n.call(t,"PROP_ELB_PING_PROTOCOL",{hash:{},data:i}))+'</label>\n			<div class="selectbox mgt5" id="elb-property-health-protocol-select">\n				<div class="selection">'+u((o=t&&t.pingProtocol,typeof o===f?o.apply(t):o))+'</div>\n				<ul class="dropdown" tabindex="-1">\n					<li class="item',o=n.ifCond.call(t,t&&t.pingProtocol,"TCP",{hash:{},inverse:a.noop,fn:a.program(21,S,i),data:i});if(o||o===0)s+=o;s+='" data-id="TCP">TCP</li>\n					<li class="item',o=n.ifCond.call(t,t&&t.pingProtocol,"HTTP",{hash:{},inverse:a.noop,fn:a.program(21,S,i),data:i});if(o||o===0)s+=o;s+='" data-id="HTTP">HTTP</li>\n					<li class="item',o=n.ifCond.call(t,t&&t.pingProtocol,"HTTPS",{hash:{},inverse:a.noop,fn:a.program(21,S,i),data:i});if(o||o===0)s+=o;s+='" data-id="HTTPS">HTTPS</li>\n					<li class="item',o=n.ifCond.call(t,t&&t.pingProtocol,"SSL",{hash:{},inverse:a.noop,fn:a.program(21,S,i),data:i});if(o||o===0)s+=o;s+='" data-id="SSL">SSL</li>\n				</ul>\n			</div>\n		</section>\n		<section class="property-control-group" data-bind="true">\n			<label for="property-elb-health-port" >'+u(n.i18n.call(t,"PROP_ELB_PING_PORT",{hash:{},data:i}))+'</label>\n			<input class="input mgt5" tooltip="1-65535" type="text" value="'+u((o=t&&t.pingPort,typeof o===f?o.apply(t):o))+'" name="property-elb-health-port" id="property-elb-health-port" data-required="true" data-type="digits" data-ignore="true" maxlength="5"/>\n		</section>\n		<section class="property-control-group">\n			<label for="property-elb-health-path" >'+u(n.i18n.call(t,"PROP_ELB_PING_PATH",{hash:{},data:i}))+'</label>\n			<div class="pos-r mgt5">\n				<input class="input" ',o=n.ifCond.call(t,t&&t.pingProtocol,"SSL",{hash:{},inverse:a.noop,fn:a.program(26,N,i),data:i});if(o||o===0)s+=o;o=n.ifCond.call(t,t&&t.pingProtocol,"TCP",{hash:{},inverse:a.noop,fn:a.program(26,N,i),data:i});if(o||o===0)s+=o;s+='type="text" value="'+u((o=t&&t.pingPath,typeof o===f?o.apply(t):o))+'" name="property-elb-health-path" id="property-elb-health-path" />\n				<span class="elb-pingpath-prefix">/</span>\n			</div>\n		</section>\n\n		<section class="property-control-group">\n			<label for="property-elb-health-interval" >'+u(n.i18n.call(t,"PROP_ELB_HEALTH_CHECK_INTERVAL",{hash:{},data:i}))+'</label>\n			<input class="input input-short mgt5"  type="text" value="'+u((o=t&&t.healthCheckInterval,typeof o===f?o.apply(t):o))+'" name="property-elb-health-interval" id="property-elb-health-interval" data-required="true" data-type="digits" data-ignore="true"/>\n			<label class="elb-property-right-text" for="property-elb-health-interval" >'+u(n.i18n.call(t,"PROP_ELB_HEALTH_CHECK_INTERVAL_SECONDS",{hash:{},data:i}))+'</label>\n		</section>\n		<section class="property-control-group">\n			<label for="property-elb-health-timout" >'+u(n.i18n.call(t,"PROP_ELB_HEALTH_CHECK_RESPOND_TIMEOUT",{hash:{},data:i}))+'</label>\n			<input class="input input-short mgt5"  type="text" value="'+u((o=t&&t.healthCheckTimeout,typeof o===f?o.apply(t):o))+'" name="property-elb-health-timeout" id="property-elb-health-timeout" data-required="true" data-type="digits" data-ignore="true"/>\n			<label class="elb-property-right-text" for="property-elb-health-timeout" >'+u(n.i18n.call(t,"PROP_ELB_HEALTH_CHECK_INTERVAL_SECONDS",{hash:{},data:i}))+'</label>\n		</section>\n\n		<section class="property-control-group">\n			<label>'+u(n.i18n.call(t,"PROP_ELB_UNHEALTH_THRESHOLD",{hash:{},data:i}))+'</label>\n			<div class="slider" id="elb-property-slider-unhealthy">\n				<a class="thumb"></a>\n				<ul class="marker"><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li></ul>\n			</div>\n		</section>\n		<section class="property-control-group">\n			<label>'+u(n.i18n.call(t,"PROP_ELB_HEALTH_THRESHOLD",{hash:{},data:i}))+'</label>\n			<div class="slider" id="elb-property-slider-healthy">\n				<a class="thumb"></a>\n				<ul class="marker"><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li></ul>\n			</div>\n		</section>\n	</div>\n\n	',o=n["if"].call(t,t&&t.isVpc,{hash:{},inverse:a.program(30,k,i),fn:a.program(28,C,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>\n",s};return e.template(t)}),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("module/design/property/elb/view",["../base/view","./template/stack","event","i18n!nls/lang.js"],function(t,n,r,i){var s,o;return o={makeInRange:function(e,t,n,r){var i,s;return i=t[0],s=t[1],isFinite(e)?(e=+e,e<i?e=i:e>s&&(e=s)):e=r,n.val(e),e}},s=t.extend({events:{"change #property-elb-name":"elbNameChange","change #elb-scheme-select1":"schemeSelectChange","change #elb-scheme-select2":"schemeSelectChange","OPTION_CHANGE #elb-property-health-protocol-select":"healthProtocolSelect","change #property-elb-health-port":"healthPortChanged","change #property-elb-health-path":"healthPathChanged","change #property-elb-health-interval":"healthIntervalChanged","change #property-elb-health-timeout":"healthTimeoutChanged","OPTION_CHANGE .elb-property-elb-protocol":"protocolChanged","OPTION_CHANGE .elb-property-instance-protocol":"protocolChanged","change .elb-property-elb-port":"portChanged","change .elb-property-instance-port":"portChanged","click #elb-property-listener-content-add":"listenerItemAddClicked","click .elb-property-listener-item-remove":"listenerItemRemovedClicked","change #elb-property-cert-name-input":"listenerCertChanged","change #elb-property-cert-privatekey-input":"listenerCertChanged","change #elb-property-cert-publickey-input":"listenerCertChanged","change #elb-property-cert-chain-input":"listenerCertChanged","change .property-elb-az-checkbox":"azCheckChanged","mousedown .slider .thumb":"sliderMouseDown","mousedown .slider li":"sliderSelect","SLIDER_CHANGE .slider":"sliderChanged","change #elb-cross-az-select":"elbCrossAZSelect","click .editbtn":"elbSSLCertAdd","click #sslcert-select .item":"changeSSLCert","click #sslcert-select .item .icon-edit":"elbSSLCertEdit","click #sslcert-select .item .icon-remove":"elbSSLCertRemove","click #elb-connection-draining-select":"elbConnectionDrainSelectChange","change #elb-connection-draining-input":"elbConnectionDrainTimeoutChange","click #elb-advanced-proxy-protocol-select":"elbAdvancedProxyProtocolSelectChange"},render:function(){return this.$el.html(n(this.model.attributes)),this.updateSlider($("#elb-property-slider-unhealthy"),this.model.get("unHealthyThreshold")-2),this.updateSlider($("#elb-property-slider-healthy"),this.model.get("healthyThreshold")-2),this.updateCertView(),this.model.attributes.name},elbNameChange:function(e){var t,n,r,i;i=$(e.currentTarget),t=i.val(),r=this.model.get("name");if(this.checkResName(i,"Load Balancer"))return this.model.setName(t),this.setTitle(t),r+="-sg",n=t+"-sg",$("#sg-info-list").children().each(function(){var e;e=$(this).find(".sg-name");if(e.text()===r)return e.text(n),!1})},schemeSelectChange:function(e){return this.model.setScheme(e.currentTarget.value),null},healthProtocolSelect:function(e,t){return t==="TCP"||t==="SSL"?$("#property-elb-health-path").attr("disabled","disabled"):$("#property-elb-health-path").removeAttr("disabled"),this.model.setHealthProtocol(t)},healthPortChanged:function(e){var t,n;return t=$(e.currentTarget),n=t.val(),n=o.makeInRange(n,[1,65535],t,1),this.model.setHealthPort(n)},healthPathChanged:function(e){return this.model.setHealthPath($(e.currentTarget).val())},healthIntervalChanged:function(e){var t,n,r;t=$(e.currentTarget),r=o.makeInRange(t.val(),[5,300],t,30),n=$("#property-elb-health-timeout"),t.parsley("custom",function(e){var t,r;return t=Number(e),r=Number(n.val()),t<r?i.ide.PROP_ELB_HEALTH_INTERVAL_VALID:null});if(!t.parsley("validate"))return;return n.parsley("validate"),this.model.setHealthInterval(r)},healthTimeoutChanged:function(e){var t,n,r;n=$(e.currentTarget),r=o.makeInRange(n.val(),[2,60],n,5),t=$("#property-elb-health-interval"),n.parsley("custom",function(e){var n,r;return n=Number(t.val()),r=Number(e),n<r?i.ide.PROP_ELB_HEALTH_INTERVAL_VALID:null});if(!n.parsley("validate"))return;return t.parsley("validate"),this.model.setHealthTimeout(r)},sliderChanged:function(e,t){var n,r;return r=$(e.target),n=e.target.id,t+=2,n==="elb-property-slider-unhealthy"?this.model.setHealthUnhealth(t):this.model.setHealthHealth(t)},listenerItemAddClicked:function(e){var t,n;return t=$("#elb-property-listener-list").children().eq(0).clone(),t.find(".elb-property-listener-item-remove").show(),n=t.find("ul"),n.children(".selected").removeClass("selected"),n.children(":first-child").addClass("selected"),n.prev(".selection").text("HTTP"),$("#elb-property-listener-list").append(t),this.updateListener(t),!1},updateListener:function(e){var t;return t={port:e.find(".elb-property-elb-port").val(),protocol:e.find(".elb-property-elb-protocol .selected").text(),instancePort:e.find(".elb-property-instance-port").val(),instanceProtocol:e.find(".elb-property-instance-protocol .selected").text()},this.model.setListener(e.index(),t),this.updateCertView(),null},protocolChanged:function(e){var t,n,r,i,s,o,u,a,f,l,c,h;return n=$(e.currentTarget),e&&(c=$(e.target),h=c.find(".selection").text(),h&&(l=null,a=null,f=c.parents(".elb-property-listener"),c.hasClass("elb-property-elb-protocol")?(l=f.find(".elb-property-elb-port"),a=f.find(".elb-property-instance-protocol")):(l=f.find(".elb-property-instance-port"),a=f.find(".elb-property-elb-protocol")),h==="HTTPS"||h==="SSL"?l.val("443"):l.val("80"),s={HTTP:"application",HTTPS:"application",TCP:"transport",SSL:"transport"},i=h,u=a.find(".selection").text(),s[i]!==s[u]&&(a.find(".selection").text(i),t=a.find(".item"),t.removeClass("selected"),r=a.find("[data-id="+i+"]"),r.addClass("selected")),a.hasClass("elb-property-elb-protocol")?l=f.find(".elb-property-elb-port"):l=f.find(".elb-property-instance-port"),o=a.find(".selection").text(),o==="HTTPS"||o==="SSL"?l.val("443"):l.val("80"))),this.updateListener(n.closest("li")),null},portChanged:function(e){var t,n;return t=$(e.currentTarget),t.hasClass("elb-property-elb-port")?n=function(e){e=parseInt(e,10);if(!(e===25||e===80||e===443||1023<e&&e<65536))return i.ide.PARSLEY_LOAD_BALANCER_PORT_MUST_BE_SOME_PROT}:n=function(e){e=parseInt(e,10);if(!(0<e&&e<65536))return i.ide.PARSLEY_INSTANCE_PORT_MUST_BE_BETWEEN_1_AND_65535},t.parsley("custom",n),t.parsley("validate")&&this.updateListener(t.closest("li")),null},listenerItemChanged:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v;return e&&(d=$(e.target),v=d.find(".selection").text(),v&&(p=null,c=null,h=d.parents(".elb-property-listener-main"),d.hasClass("elb-property-listener-elb-protocol-select")?(p=h.find(".elb-property-listener-elb-port-input"),c=h.find(".elb-property-listener-instance-protocol-select")):(p=h.find(".elb-property-listener-instance-port-input"),c=h.find(".elb-property-listener-elb-protocol-select")),v==="HTTPS"||v==="SSL"?p.val("443"):p.val("80"),i={HTTP:"application",HTTPS:"application",TCP:"transport",SSL:"transport"},t=v,l=c.find(".selection").text(),i[t]!==i[l]&&c.find(".selection").text(t),c.hasClass("elb-property-listener-elb-protocol-select")?p=h.find(".elb-property-listener-elb-port-input"):p=h.find(".elb-property-listener-instance-port-input"),f=c.find(".selection").text(),f==="HTTPS"||f==="SSL"?p.val("443"):p.val("80"))),a=this,o=$("#accordion-group-elb-property-listener"),u=o.find(".elb-property-listener-main"),s=[],r=!1,n=!1,u.each(function(e,t){var n,i,o,u,a,f,l,c;c=$(this),o=$.trim(c.find(".elb-property-listener-elb-protocol-select .selection").text()),i=c.find(".elb-property-listener-elb-port-input").val(),f=$.trim(c.find(".elb-property-listener-instance-protocol-select .selection").text()),a=c.find(".elb-property-listener-instance-port-input").val(),n=c.find(".elb-property-listener-elb-port-input"),u=c.find(".elb-property-listener-instance-port-input"),elbPortValidate&&instancePortValidate&&!isNaN(parseInt(i,10))&&!isNaN(parseInt(a,10))&&(l={Listener:{LoadBalancerPort:i,InstanceProtocol:f,Protocol:o,SSLCertificateId:"",InstancePort:a},PolicyNames:""},s.push(l));if(o==="HTTPS"||o==="SSL")r=!0;return null}),this.model.setListenerAry(idx,listener),this.updateCertView(),null},listenerItemRemovedClicked:function(e){var t;return t=$(e.currentTarget).closest("li"),this.model.removeListener(t.index()),t.remove(),this.updateCertView(),!1},listenerCertChanged:function(e){return this.model.setCert({name:$("#elb-property-cert-name-input").val(),key:$("#elb-property-cert-privatekey-input").val(),body:$("#elb-property-cert-publickey-input").val(),chain:$("#elb-property-cert-chain-input").val()}),null},updateCertView:function(){var e,t;return t=!1,$("#elb-property-listener-list").children().each(function(){var e;e=$(this).find(".elb-property-elb-protocol .selected").text();if(e==="HTTPS"||e==="SSL")return t=!0,!1}),e=$("#property-control-group-cert-setting"),t?e.show():e.hide(),null},azCheckChanged:function(e){var t;return t=_.map($("#property-elb-az-cb-group").find("input:checked"),function(e){return $(e).attr("data-name")}),this.model.updateElbAZ(t),null},updateSlider:function(e,t){var n,r,i;return r=e.children(".marker").children().length-1,i=e.width(),n=t*Math.floor(i/r),e.data("value",t).children(".thumb").css("left",n),null},sliderSelect:function(e){var t,n,r;return n=$(e.currentTarget),t=n.closest(".slider"),r=n.index(),this.updateSlider(t,r),t.trigger("SLIDER_CHANGE",r),null},sliderMouseDown:function(e){var t,n,r,i,s,o,u,a,f,l,c,h;return t=$("body"),r=$(e.currentTarget),n=r.closest(".slider"),a=n.children(".marker").children().length-1,h=n.width(),f=Math.floor(h/a),u=e.clientX,l=r.position().left,c=n.data("value"),i=0,s=function(e){var t,n,s,o,p;return p=e.clientX-u,t=Math.abs(p),s=f/2,t>=s?(t+=s,n=p>0?1:-1,i=Math.floor(t/f)*n,o=l+i*f,o<0?(o=0,i=-c):o>h&&(o=h,i=a-c)):(o=l,i=0),r.css("left",o),!1},o=function(){var e;return t.off("mousemove",s),e=c+i,n.data("value",e).trigger("SLIDER_CHANGE",e),null},t.on("mousemove",s),t.one("mouseup",o),!1},elbCrossAZSelect:function(e){return this.model.setElbCrossAZ(e.target.checked),null},elbSSLCertAdd:function(e){var t;return t=this,t.popSSLCertModal(!1),!1},elbSSLCertEdit:function(e){var t,n,r,i;return i=this,t=$(e.currentTarget),n=t.parents(".item"),r=n.attr("data-id"),r&&i.popSSLCertModal(!0,r),!1},elbSSLCertRemove:function(e){var t,n,i,s,o,u;return u=this,t=$(e.currentTarget),n=t.parents(".item"),o=n.attr("data-id"),i=Design.instance().component(o),i&&(s=i.get("name"),modal(MC.template.modalDeleteELBCert({cert_name:s},!0)),$("#modal-confirm-elb-cert-delete").one("click",function(){return u.model.removeCert(o),r.trigger(r.REFRESH_PROPERTY),modal.close()})),!1},changeSSLCert:function(e){var t,n,i;return i=this,t=$(e.currentTarget),n=t.attr("data-id"),i.model.changeCert(n),r.trigger(r.REFRESH_PROPERTY)},popSSLCertModal:function(t,n){var s,o,u,a,f,l,c,h;return h=this,modal(MC.template.modalSSLCertSetting({},!0)),o=$("#elb-ssl-cert-name-input"),u=$("#elb-ssl-cert-privatekey-input"),a=$("#elb-ssl-cert-publickey-input"),s=$("#elb-ssl-cert-chain-input"),l="",t&&n&&(f=Design.instance().component(n),f&&(l=f.get("name"),o.val(l),u.val(f.get("key")),a.val(f.get("body")),s.val(f.get("chain")))),c=h.model.getOtherCertName(l),$("#elb-ssl-cert-confirm").off("click").on("click",function(){var f,l,p,d,v;return l=!1,o.parsley("custom",function(t){return e.call(c,t)>=0?i.ide.PARSLEY_THIS_NAME_IS_ALREADY_IN_USING:null}),p=o.parsley("validate"),d=u.parsley("validate"),v=a.parsley("validate"),p&&d&&v&&(l=!0),l&&(f={name:o.val(),key:u.val(),body:a.val(),chain:s.val()},t&&n?h.model.updateCert(n,f):h.model.addCert(f),r.trigger(r.REFRESH_PROPERTY),modal.close()),null})},elbConnectionDrainSelectChange:function(e){var t,n,r,i,s,o;s=this,n=s.$("#elb-connection-draining-select"),t=s.$(".elb-connection-draining-input-group"),r=s.$("#elb-connection-draining-input"),i=n.prop("checked"),i?t.removeClass("hide"):t.addClass("hide"),o=Number(r.val()),i&&o&&s.model.setConnectionDraining(!0,o);if(!i)return s.model.setConnectionDraining(!1)},elbConnectionDrainTimeoutChange:function(e){var t,n,r,s,o;s=this,n=s.$("#elb-connection-draining-input"),t=s.$("#elb-connection-draining-select"),r=t.prop("checked"),o=Number(n.val()),n.parsley("custom",function(e){var t;return t=Number(n.val()),t>=1&&t<3600?null:i.ide.PROP_ELB_CONNECTION_DRAIN_TIMEOUT_INVALID});if(!n.parsley("validate"))return;if(r&&o)return s.model.setConnectionDraining(!0,o)},elbAdvancedProxyProtocolSelectChange:function(e){var t,n,r,i;return i=this,t=i.$("#elb-advanced-proxy-protocol-select"),n=$("#elb-advanced-proxy-protocol-select-tip"),r=t.prop("checked"),r?n.removeClass("hide"):n.addClass("hide"),i.model.setAdvancedProxyProtocol(r,[80])}}),new s})}.call(this),function(){define("module/design/property/elb/app_model",["../base/model","constant","Design"],function(e,t,n){var r;return r=e.extend({defaults:{id:null},init:function(e){var r,i,s,o,u,a,f,l;return this.set("id",e),this.set("uid",e),u=n.instance().component(e),r=MC.data.resource_list[n.instance().region()],i=r[u.get("appId")],i.ConnectionDraining?i.ConnectionDraining.Enabled?i.ConnectionDrainingInfo="Enabled; Timeout: "+i.ConnectionDraining.Timeout+" seconds":i.ConnectionDrainingInfo="Disabled":i.ConnectionDrainingInfo="Disabled",i?(i=$.extend(!0,{},i),i.name=u.get("name"),i.isInternet=i.Scheme==="internet-facing",l=i.HealthCheck.Target,f=l.indexOf(":"),i.HealthCheck.protocol=l.substring(0,f),l=l.substring(f+1),a=parseInt(l,10),isNaN(a)&&(a=80),i.HealthCheck.port=a,i.HealthCheck.path=l.replace(/[^\/]+\//,"/"),i.CrossZone=u.get("crossZone")?"Enabled":"Disabled",i.listenerDisplay=[],i.ListenerDescriptions.member&&$.each(i.ListenerDescriptions.member,function(e,t){i.listenerDisplay.push(t);if(t.Listener.SSLCertificateId)return i.server_certificate=t.Listener.SSLCertificateId.split("/")[1],null}),i.isClassic=!1,i.defaultVPC=!1,i.distribution=[],s={},o=i.InstanceState,_.each(o,function(e){var r,i,o,u,a,f,l,c,h,p,d,v;try{return u=e.InstanceId,l=e.ReasonCode,f=e.State,c=e.Description,o=n.modelClassForType(t.RESTYPE.INSTANCE).getEffectiveId(u),h=o.uid,i=n.instance().component(h),d="",i&&(a=i.get("name"),a===u&&(a=null),v={instance_name:a,instance_id:u,instance_state:f==="InService",instance_state_desc:c},p=null,i.parent()&&i.parent().parent()&&(p=i.parent().parent(),i.type===t.RESTYPE.LC&&(p=i.parent().parent().parent())),p&&(d=p.get("name"))),s[d]=s[d]||[],s[d].push(v)}catch(m){return r=m,void 0}}),_.each(s,function(e,t){var n;return n=!0,_.each(e,function(e){return e.instance_state||(n=!1),null}),i.distribution.push({zone:t,instance:e,health:n})}),i.distribution=i.distribution.sort(function(e,t){return e.zone>t.zone}),this.set(i),this.set("componentUid",u.id)):!1}}),new r})}.call(this),define("module/design/property/elb/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return"Internet Facing"}function c(e,t){return"Internal"}function h(e,t){var r="",i;return r+='\n      <li class="clearfix">\n        <div class="app-panel-li-col2-1">\n          <label>'+u(n.i18n.call(e,"PROP_ELB_ELB_PROTOCOL",{hash:{},data:t}))+"</label>\n          <div>"+u((i=(i=e&&e.Listener,i==null||i===!1?i:i.Protocol),typeof i===a?i.apply(e):i))+'</div>\n        </div>\n\n        <div class="app-panel-li-col2-2">\n          <label>'+u(n.i18n.call(e,"PROP_ELB_PORT",{hash:{},data:t}))+"</label>\n          <div>"+u((i=(i=e&&e.Listener,i==null||i===!1?i:i.LoadBalancerPort),typeof i===a?i.apply(e):i))+'</div>\n        </div>\n\n        <div class="app-panel-li-col2-1">\n          <label>'+u(n.i18n.call(e,"PROP_ELB_INSTANCE_PROTOCOL",{hash:{},data:t}))+"</label>\n          <div>"+u((i=(i=e&&e.Listener,i==null||i===!1?i:i.InstanceProtocol),typeof i===a?i.apply(e):i))+'</div>\n        </div>\n\n        <div class="app-panel-li-col2-2">\n          <label>'+u(n.i18n.call(e,"PROP_ELB_PORT",{hash:{},data:t}))+"</label>\n          <div>"+u((i=(i=e&&e.Listener,i==null||i===!1?i:i.InstancePort),typeof i===a?i.apply(e):i))+"</div>\n        </div>\n      </li>\n    ",r}function p(e,t){var r="",i;return r+='\n      <li class="clearfix">\n        <p class="app-panel-li-main">'+u(n.i18n.call(e,"PROP_ELB_SERVER_CERTIFICATE",{hash:{},data:t}))+'</p>\n        <p class="app-panel-li-sub">'+u((i=e&&e.server_certificate,typeof i===a?i.apply(e):i))+"</p>\n      </li>\n    ",r}function d(e,t){var r="",i;r+='\n      <li>\n        <div class="list-row">\n            <i class="status status-',i=n["if"].call(e,e&&e.health,{hash:{},inverse:f.program(12,m,t),fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;r+=' icon-label"></i>\n            <span class="app-panel-li-main">'+u((i=e&&e.zone,typeof i===a?i.apply(e):i))+'</span>\n        </div>\n        <div class="list-row">\n          <ul class="elb-property-instance-list">\n            ',i=n.each.call(e,e&&e.instance,{hash:{},inverse:f.noop,fn:f.program(14,g,t),data:t});if(i||i===0)r+=i;return r+="\n          </ul>\n        </div>\n      </li>\n    ",r}function v(e,t){return"green"}function m(e,t){return"red"}function g(e,t){var r="",i;r+='\n              <li>\n                <div class="instance-info">\n                  ',i=n["if"].call(e,e&&e.instance_name,{hash:{},inverse:f.noop,fn:f.program(15,y,t),data:t});if(i||i===0)r+=i;r+='\n                  <div class="instance-id ',i=n.unless.call(e,e&&e.instance_name,{hash:{},inverse:f.noop,fn:f.program(17,b,t),data:t});if(i||i===0)r+=i;r+='">('+u((i=e&&e.instance_id,typeof i===a?i.apply(e):i))+')</div>\n                </div>\n                <div class="instance-state">\n                  ',i=n["if"].call(e,e&&e.instance_state,{hash:{},inverse:f.program(21,E,t),fn:f.program(19,w,t),data:t});if(i||i===0)r+=i;r+="\n                  ",i=n.unless.call(e,e&&e.instance_state,{hash:{},inverse:f.noop,fn:f.program(23,S,t),data:t});if(i||i===0)r+=i;return r+="\n                </div>\n              </li>\n            ",r}function y(e,t){var n="",r;return n+='<div class="instance-name">'+u((r=e&&e.instance_name,typeof r===a?r.apply(e):r))+"</div>",n}function b(e,t){return"instance-id-down"}function w(e,t){return"InService"}function E(e,t){return"OutOfService"}function S(e,t){var n="",r;return n+='<a class="elb-info-icon tooltip icon-info" data-tooltip="'+u((r=e&&e.instance_state_desc,typeof r===a?r.apply(e):r))+'"></a>',n}function x(e,t){var r="";return r+='\n  <div class="option-group-head">'+u(n.i18n.call(e,"PROP_ELB_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span> </div>\n  <div class="option-group sg-group">Loading...</div>\n  ',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP_ELB_DETAILS",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n      <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(t,"PROP_ELB_SCHEME",{hash:{},data:i}))+"</dt>\n        <dd>",o=n["if"].call(t,t&&t.isInternet,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="</dd>\n        <dt>"+u(n.i18n.call(t,"PROP_ELB_DNS_NAME",{hash:{},data:i}))+'</dt>\n        <dd>\n          <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP_ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:i}))+'">(A)'+u((o=t&&t.DNSName,typeof o===a?o.apply(t):o))+'</div>\n          <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP_ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:i}))+'">(AAAA)ipv6.'+u((o=t&&t.DNSName,typeof o===a?o.apply(t):o))+'</div>\n          <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP_ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:i}))+'">(A/AAAA)dualstack.'+u((o=t&&t.DNSName,typeof o===a?o.apply(t):o))+"</div>\n        </dd>\n        <dt>"+u(n.i18n.call(t,"PROP_ELB_HOST_ZONE_ID",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=t&&t.CanonicalHostedZoneNameID,typeof o===a?o.apply(t):o))+"<dd>\n        <dt>"+u(n.i18n.call(t,"PROP_ELB_CROSS_ZONE",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=t&&t.CrossZone,typeof o===a?o.apply(t):o))+"<dd>\n        <dt>"+u(n.i18n.call(t,"PROP_ELB_CONNECTION_DRAIN",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=t&&t.ConnectionDrainingInfo,typeof o===a?o.apply(t):o))+'<dd>\n      </dl>\n  </div>\n\n  <div class="option-group-head">'+u(n.i18n.call(t,"PROP_ELB_LISTENER_DETAIL",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n    <ul class="property-list">\n    ',o=n.each.call(t,t&&t.listenerDisplay,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+="\n    ",o=n["if"].call(t,t&&t.server_certificate,{hash:{},inverse:f.noop,fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+='\n    </ul>\n  </div>\n\n  <div class="option-group-head">'+u(n.i18n.call(t,"PROP_ELB_HEALTH_CHECK_DETAILS",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n      <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(t,"PROP_ELB_PING_PROTOCOL",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.protocol),typeof o===a?o.apply(t):o))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP_ELB_PING_PORT",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.port),typeof o===a?o.apply(t):o))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP_ELB_PING_PATH",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.path),typeof o===a?o.apply(t):o))+"</dd>\n\n        <dt>"+u(n.i18n.call(t,"PROP_ELB_HEALTH_CHECK_INTERVAL",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.Interval),typeof o===a?o.apply(t):o))+" "+u(n.i18n.call(t,"PROP_ELB_HEALTH_CHECK_INTERVAL_SECONDS",{hash:{},data:i}))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP_ELB_HEALTH_CHECK_RESPOND_TIMEOUT",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.Timeout),typeof o===a?o.apply(t):o))+" "+u(n.i18n.call(t,"PROP_ELB_HEALTH_CHECK_INTERVAL_SECONDS",{hash:{},data:i}))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP_ELB_UNHEALTH_THRESHOLD",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.UnhealthyThreshold),typeof o===a?o.apply(t):o))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP_ELB_HEALTH_THRESHOLD",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.HealthyThreshold),typeof o===a?o.apply(t):o))+'</dd>\n      </dl>\n  </div>\n\n  <div class="option-group-head">'+u(n.i18n.call(t,"PROP_ELB_INSTANCES",{hash:{},data:i}))+'</div>\n  <ul class="option-group property-list">\n    ',o=n.each.call(t,t&&t.distribution,{hash:{},inverse:f.noop,fn:f.program(9,d,i),data:i});if(o||o===0)s+=o;s+="\n  </ul>\n\n  ",o=n.unless.call(t,t&&t.isclassic,{hash:{},inverse:f.noop,fn:f.program(25,x,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/elb/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name}}),new n})}.call(this),function(){define("module/design/property/elb/main",["../base/main","./model","./view","./app_model","./app_view","../sglist/main","constant","event"],function(e,t,n,r,i,s,o,u){var a;return a=e.extend({handleTypes:o.RESTYPE.ELB,onUnloadSubPanel:function(e){return s.onUnloadSubPanel(e),null},initStack:function(){return this.model=t,this.view=n,null},afterLoadStack:function(){return s.loadModule(this.model),null},initApp:function(){return this.model=r,this.view=i,null},afterLoadApp:function(){return s.loadModule(this.model),null},initAppEdit:function(){return this.model=t,this.view=n,null},afterLoadAppEdit:function(){return s.loadModule(t),null}}),null})}.call(this),function(){define("module/design/property/az/model",["module/design/property/base/model","Design","constant"],function(e,t,n){var r;return r=e.extend({reInit:function(){return this.init(this.get("uid")),null},init:function(e){var n,r,i,s;return n=MC.data.config[t.instance().region()],i=t.instance().component(e),!i||!n?!1:(r=i.get("name"),s={uid:e,name:r},n&&n.zone?s.az_list=this.possibleAZList(n.zone.item,r):s.az_list=[{name:r,selected:!0}],this.set(s),null)},possibleAZList:function(e,r){var i,s,o,u,a,f;if(!e)return;u={},i=t.modelClassForType(n.RESTYPE.AZ),_.each(i.allObjects(),function(e){return u[e.get("name")]=!0,null}),o=[];for(a=0,f=e.length;a<f;a++)s=e[a],(s.zoneName===r||!u[s.zoneName])&&o.push({name:s.zoneName,selected:s.zoneName===r});return o}}),new r})}.call(this),define("module/design/property/az/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n        <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+f((i=e&&e.name,typeof i===a?i.apply(e):i))+'">'+f((i=e&&e.name,typeof i===a?i.apply(e):i))+"</li>\n      ",r}function c(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<section class="property-control-group">\n  <label class="left">'+f(n.i18n.call(t,"PROP_AZ_LBL_SWITCH",{hash:{},data:i}))+'</label>\n  <div class="selectbox selectbox-mega" id="az-quick-select">\n    <div class="selection">'+f((o=(o=t&&t.component,o==null||o===!1?o:o.name),typeof o===a?o.apply(t):o))+'</div>\n    <ul class="dropdown" tabindex="-1">\n      ',o=n.each.call(t,t&&t.az_list,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n    </ul>\n  </div>\n</section>\n",s};return e.template(t)}),function(){define("module/design/property/az/view",["../base/view","./template/stack"],function(e,t){var n;return n=e.extend({events:{"OPTION_CHANGE #az-quick-select":"azSelect"},render:function(){return this.$el.html(t(this.model.attributes)),"Availability Zone"},azSelect:function(e,t){return this.trigger("SELECT_AZ",t)}}),new n})}.call(this),function(){define("module/design/property/az/main",["../base/main","./model","./view","constant","event"],function(e,t,n,r,i){var s,o;return o={},o[i.RELOAD_AZ]=function(e){var t;if(!e)return;return t=this,setTimeout(function(){return t.model.reInit(),t.view.render()},0),null},s=e.extend({ideEvents:o,handleTypes:"Stack:"+r.RESTYPE.AZ,setupStack:function(){var e;return e=this,this.view.on("SELECT_AZ",function(t){var n,s,o,u;return o=e.model.get("name"),e.model.setName(t),u=r.RESTYPE.AZ,n=function(e){return e.option.name===s},s=o,i.trigger(i.ENABLE_RESOURCE_ITEM,u,n),s=t,i.trigger(i.DISABLE_RESOURCE_ITEM,u,n)}),null},initStack:function(){if(Design.instance().modeIsAppEdit())throw new Error("Cannot open az property panel in AppEdit mode.");return this.model=t,this.view=n,null}}),null})}.call(this),function(){define("module/design/property/subnet/model",["../base/model","constant","Design"],function(e,t,n){var r;return r=e.extend({defaults:{isAppEdit:!1},init:function(e){var r,i,s,o,u,a,f,l,c,h;return h=n.instance().component(e),h?(r=n.modelClassForType(t.RESTYPE.ACL),c=h.connectionTargets("AclAsso")[0],s=null,a=[],_.each(r.allObjects(),function(e){var t;return t={uid:e.id,name:e.get("name"),isUsed:e===c,rule:e.getRuleCount(),association:e.getAssoCount()},e.isDefault()?(s=t,t.isDefault=!0):a.splice(_.sortedIndex(a,t,"name"),0,t),null}),s&&a.splice(0,0,s),this.set({uid:e,name:h.get("name"),networkACL:a,isAppEdit:this.isAppEdit}),this.isAppEdit&&(i=MC.data.resource_list[n.instance().region()],l=i[h.get("appId")],l=$.extend(!0,{},l),f=h.connectionTargets("RTB_Asso")[0],u=f.get("appId"),f.get("main")&&(o=f.get("appId")),l.routeTable=u?u:o,this.set(l)),this.getCidr(),null):!1},getCidr:function(){var e,t,r;return t=n.instance().component(this.get("uid")),r=t.get("cidr"),e=this.genCIDRDivAry(t.parent().parent().get("cidr"),r),this.set("CIDRPrefix",e[0]),this.set("CIDR",r?e[1]:""),null},genCIDRDivAry:function(e,t){var n,r,i,s,o,u;return t||(t=e),u=Number(e.split("/")[1]),s=t.split("/"),o=Number(s[1]),i=s[0].split("."),u>23?(n=i[0]+"."+i[1]+"."+i[2]+".",r=i[3]+"/"+o):(n=i[0]+"."+i[1]+".",r=i[2]+"."+i[3]+"/"+o),[n,r]},createAcl:function(){var e,r;return e=n.modelClassForType(t.RESTYPE.ACL),r=new e,this.setACL(r.id),r.id},removeAcl:function(e){return n.instance().component(e).remove(),null},setCidr:function(e){return n.instance().component(this.get("uid")).setCidr(e)},setACL:function(e){return n.instance().component(this.get("uid")).setAcl(e),null},isValidCidr:function(e){return n.instance().component(this.get("uid")).isValidCidr(e)}}),new r})}.call(this),define("module/design/property/subnet/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP_SUBNET_APP_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.subnetId,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP_SUBNET_APP_STATE",{hash:{},data:t}))+'</dt>\n      <dd><i class="status status-'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'"></i>'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP_SUBNET_APP_CIDR",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.cidrBlock,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP_SUBNET_APP_AVAILABLE_IP",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.availableIpAddressCount,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP_SUBNET_APP_VPC_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP_SUBNET_APP_RT_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.routeTable,typeof i===a?i.apply(e):i))+"</dd>\n    </dl>\n  </div>\n\n  ",r}function c(e,t){var r="",i;return r+='\n  <div class="option-group">\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-subnet-name">'+u(n.i18n.call(e,"PROP_SUBNET_DETAIL_LBL_NAME",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP_LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <input class="input" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" lastValue="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-subnet-name" maxlength="255" data-required-rollback="true" data-ignore="true"/>\n    </section>\n\n    <section class="property-control-group">\n      <label class="left" for="property-cidr-block">'+u(n.i18n.call(e,"PROP_SUBNET_DETAIL_LBL_CIDR_BLOCK",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP_LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <div class="subnet-cidr-wrapper">\n        <span class="cidr-prefix" id="property-cidr-prefix">'+u((i=e&&e.CIDRPrefix,typeof i===a?i.apply(e):i))+'</span>\n        <input data-ignore="true" data-ignore-regexp="^[0-9./]*$" class="input cidr-rest tooltip" type="text" value="'+u((i=e&&e.CIDR,typeof i===a?i.apply(e):i))+'" lastValue="'+u((i=e&&e.CIDR,typeof i===a?i.apply(e):i))+'" id="property-cidr-block" data-empty-remove="true" data-tooltip="'+u(n.i18n.call(e,"PROP_SUBNET_TIP_CIDR_BLOCK",{hash:{},data:t}))+'"/>\n      </div>\n    </section>\n  </div>\n  ',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article data-bind="true">\n  <div class="option-group-head expand" id="subnet-property-detail">'+u(n.i18n.call(t,"PROP_SUBNET_TIT_DETAIL",{hash:{},data:i}))+"</div>\n  ",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='\n\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP_SUBNET_TIT_ASSOC_ACL",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n    <ul id="networkacl-list" class="acl-sg-info-list acl-info-list property-list stack-property-acl-list"></ul>\n    <a href="#" class="add-to-list action-link" id="networkacl-create">'+u(n.i18n.call(t,"PROP_SUBNET_BTN_CREATE_NEW_ACL",{hash:{},data:i}))+"</a>\n  </div>\n</article>\n\n",s};return e.template(t)}),define("module/design/property/subnet/template/acl",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n<li class="clearfix" data-uid="'+a((i=e&&e.uid,typeof i===u?i.apply(e):i))+'">\n  <div class="col1"> <div class="radio">\n    <input id="ppty-acl-'+a((i=t==null||t===!1?t:t.index,typeof i===u?i.apply(e):i))+'" class="ppty-acl-cb" type="radio" ',i=n["if"].call(e,e&&e.isUsed,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+='/>\n    <label for="ppty-acl-'+a((i=t==null||t===!1?t:t.index,typeof i===u?i.apply(e):i))+'"></label>\n  </div> </div>\n  <div class="col3 tooltip icon-btn-details" data-tooltip=\''+a(n.i18n.call(e,"PROP_SUBNET_ACL_TIP_DETAIL",{hash:{},data:t}))+'\'></div>\n  <div class="col2">\n    <div class="col2-1 truncate">'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'</div>\n    <div class="col2-2 truncate">'+a((i=e&&e.rule,typeof i===u?i.apply(e):i))+" "+a(n.i18n.call(e,"PROP_SUBNET_ACL_LBL_RULE",{hash:{},data:t}))+", "+a((i=e&&e.association,typeof i===u?i.apply(e):i))+" "+a(n.i18n.call(e,"PROP_SUBNET_ACL_LBL_ASSOC",{hash:{},data:t})),i=n.unless.call(e,e&&e.isDefault,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="</div>\n  </div>\n</li>\n",r}function c(e,t){return'checked="checked"'}function h(e,t){var r="",i;return r+=' | <a class="sg-list-delete-btn" data-name="'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'" data-count="'+a((i=e&&e.association,typeof i===u?i.apply(e):i))+'">'+a(n.i18n.call(e,"PROP_SUBNET_ACL_BTN_DELETE",{hash:{},data:t}))+"</a>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;o=n.each.call(t,t&&t.networkACL,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n",s};return e.template(t)}),function(){define("module/design/property/subnet/view",["../base/view","./template/stack","./template/acl","event","Design"],function(e,t,n,r,i){var s;return s=e.extend({events:{"change #property-subnet-name":"onChangeName","focus #property-cidr-block":"onFocusCIDR","keypress #property-cidr-block":"onPressCIDR","blur #property-cidr-block":"onBlurCIDR","click #networkacl-create":"createAcl","click .icon-btn-details":"openAcl","click .ppty-acl-cb":"changeAcl","click .sg-list-delete-btn":"deleteAcl"},render:function(){return this.$el.html(t(this.model.attributes)),this.refreshACLList(),this.model.attributes.name},onChangeName:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(this.checkResName(n,"Subnet"))return this.model.setName(t),this.setTitle(t)},onPressCIDR:function(e){return e.keyCode===13&&$("#property-cidr-block").blur(),null},onFocusCIDR:function(e){return this.disabledAllOperabilityArea(!0),null},onBlurCIDR:function(e){var t,n,r,s,o,u,a,f;return t=$("#property-cidr-prefix").html(),n=$("#property-cidr-block").val(),a=t+n,u="Remove Subnet",n?MC.validate("cidr",a)?(s=this.model.isValidCidr(a),s!==!0&&(o=s.error,r=s.detail,s.shouldRemove===!1&&(u=""))):(o=""+a+" is not a valid form of CIDR block.",r="Please provide a valid IP range. For example, 10.0.0.1/24."):(o="CIDR block is required.",r="Please provide a subset of IP ranges of this VPC."),o?(f=this,modal(MC.template.setupCIDRConfirm({main_content:o,desc_content:r,remove_content:u}),!1,null,{$source:$(e.target)}),$(".modal-close").click(function(){return $("#property-cidr-block").focus()}),$("#cidr-remove").click(function(){return $canvas.clearSelected(),i.instance().component(f.model.get("uid")).remove(),f.disabledAllOperabilityArea(!1),modal.close()})):(this.model.setCidr(a),this.disabledAllOperabilityArea(!1))},createAcl:function(){return this.trigger("OPEN_ACL",this.model.createAcl())},openAcl:function(e){var t;return t=$(e.currentTarget).closest("li").attr("data-uid"),this.trigger("OPEN_ACL",t),null},deleteAcl:function(e){var t,n,r,i,s,o;return t=$(e.currentTarget),i=parseInt(t.attr("data-count"),10),r=t.closest("li").attr("data-uid"),i?(o=this,n=t.attr("data-name"),s=MC.template.modalDeleteSGOrACL({title:"Delete Network ACL",main_content:"Are you sure you want to delete "+n+"?",desc_content:"Subnets associated with "+n+" will use DefaultACL."}),modal(s,!1,function(){return $("#modal-confirm-delete").click(function(){return o.model.removeAcl(r),o.refreshACLList(),modal.close()})})):(this.model.removeAcl(r),this.refreshACLList())},changeAcl:function(e){return this.model.setACL($(e.currentTarget).closest("li").attr("data-uid")),this.refreshACLList()},refreshACLList:function(){return this.model.init(this.model.get("uid")),$("#networkacl-list").html(n(this.model.attributes))}}),new s})}.call(this),function(){define("module/design/property/subnet/app_model",["../base/model","constant","Design"],function(e,t,n){var r;return r=e.extend({init:function(e){var t,r,i,s,o,u;return s=n.instance().component(e),t=MC.data.resource_list[n.instance().region()],u=t[s.get("appId")],u?(u=$.extend(!0,{},u),u.name=s.get("name"),u.acl=this.getACL(e),u.uid=e,o=s.connectionTargets("RTB_Asso")[0],i=o.get("appId"),o.get("main")&&(r=o.get("appId")),u.routeTable=i?i:r,this.set(u),null):!1},getACL:function(e){var t;return t=n.instance().component(e).connectionTargets("AclAsso")[0],t?{id:t.id,name:t.get("name"),rule:t.getRuleCount(),association:t.getAssoCount()}:null}}),new r})}.call(this),define("module/design/property/subnet/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP_SUBNET_TIT_ASSOC_ACL",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <ul class="acl-sg-info-list property-list acl-info-list">\n      <li>\n        <div class="col3 tooltip icon-btn-details" data-uid="'+u((i=(i=e&&e.acl,i==null||i===!1?i:i.id),typeof i===a?i.apply(e):i))+"\" data-tooltip='"+u(n.i18n.call(e,"PROP_SUBNET_ACL_TIP_DETAIL",{hash:{},data:t}))+'\'></div>\n        <div class="col2">\n          <div class="col2-1 truncate">'+u((i=(i=e&&e.acl,i==null||i===!1?i:i.name),typeof i===a?i.apply(e):i))+'</div>\n          <div class="col2-2 truncate">'+u((i=(i=e&&e.acl,i==null||i===!1?i:i.rule),typeof i===a?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP_SUBNET_ACL_LBL_RULE",{hash:{},data:t}))+", "+u((i=(i=e&&e.acl,i==null||i===!1?i:i.association),typeof i===a?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP_SUBNET_ACL_LBL_ASSOC",{hash:{},data:t}))+"</div>\n        </div>\n      </li>\n    </ul>\n  </div>\n  ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP_SUBNET_TIT_DETAIL",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(t,"PROP_SUBNET_APP_ID",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.subnetId,typeof o===a?o.apply(t):o))+"</dd>\n\n      <dt>"+u(n.i18n.call(t,"PROP_SUBNET_APP_STATE",{hash:{},data:i}))+'</dt>\n      <dd><i class="status status-'+u((o=t&&t.state,typeof o===a?o.apply(t):o))+'"></i>'+u((o=t&&t.state,typeof o===a?o.apply(t):o))+"</dd>\n\n      <dt>"+u(n.i18n.call(t,"PROP_SUBNET_APP_CIDR",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.cidrBlock,typeof o===a?o.apply(t):o))+"</dd>\n\n      <dt>"+u(n.i18n.call(t,"PROP_SUBNET_APP_AVAILABLE_IP",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.availableIpAddressCount,typeof o===a?o.apply(t):o))+"</dd>\n\n      <dt>"+u(n.i18n.call(t,"PROP_SUBNET_APP_VPC_ID",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.vpcId,typeof o===a?o.apply(t):o))+"</dd>\n\n      <dt>"+u(n.i18n.call(t,"PROP_SUBNET_APP_RT_ID",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.routeTable,typeof o===a?o.apply(t):o))+"</dd>\n    </dl>\n  </div>\n\n  ",o=n["if"].call(t,t&&t.acl,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/subnet/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({events:{"click .acl-sg-info-list .icon-btn-details":"showACLDetail"},render:function(){return this.$el.html(t(this.model.toJSON())),this.setTitle(this.model.get("name")),null},showACLDetail:function(e){return this.trigger("OPEN_ACL",$(e.currentTarget).data("uid")),null}}),new n})}.call(this),function(){define("module/design/property/subnet/main",["../base/main","./model","./view","./app_model","./app_view","constant"],function(e,t,n,r,i,s){var o;return i.on("OPEN_ACL",function(t){return e.loadSubPanel("ACL",t)}),n.on("OPEN_ACL",function(t){return e.loadSubPanel("ACL",t),null}),o=e.extend({handleTypes:s.RESTYPE.SUBNET,onUnloadSubPanel:function(e){if(e==="ACL"&&this.view.refreshACLList)return this.view.refreshACLList()},initStack:function(){return this.view=n,this.model=t,this.model.isAppEdit=!1,null},initApp:function(){return this.view=i,this.model=r,null},initAppEdit:function(){return this.view=n,this.model=t,this.model.isAppEdit=!0,null}}),null})}.call(this),function(){define("module/design/property/vpc/model",["../base/model","Design","constant"],function(e,t,n){var r;return r=e.extend({defaults:{isAppEdit:!1},init:function(e){var r,i,s,o,u,a,f,l,c,h,p;return a=t.instance().component(e),c=a.get("dhcp"),l=$.extend({},c.attributes),l.none=c.isNone(),l["default"]=c.isDefault(),l.hasDhcp=!l.none&&!l["default"],f={uid:e,dnsSupport:a.get("dnsSupport"),dnsHosts:a.get("dnsHostnames"),defaultTenancy:a.isDefaultTenancy(),name:a.get("name"),cidr:a.get("cidr"),dhcp:l,isAppEdit:this.isAppEdit},this.isAppEdit&&(h=t.instance().component(e),u=MC.data.resource_list[t.instance().region()],p=u[h.get("appId")],p=$.extend(!0,{},p),o=n.RESTYPE.RT,s=n.RESTYPE.ACL,i=t.modelClassForType(o),r=t.modelClassForType(s),p.mainRTB=i.getMainRouteTable(),p.mainRTB&&(p.mainRTB=p.mainRTB.get("appId"),p.defaultACL=r.getDefaultAcl()),p.defaultACL&&(p.defaultACL=p.defaultACL.get("appId")),this.set(p)),this.set(f),null},setCidr:function(e){return t.instance().component(this.get("uid")).setCidr(e)?(this.attributes.cidr=e,!0):!1},setTenancy:function(e){return t.instance().component(this.get("uid")).setTenancy(e),null},setDnsSupport:function(e){var n;return n=this.get("uid"),t.instance().component(n).set("dnsSupport",e),null},setDnsHosts:function(e){var n;return n=this.get("uid"),t.instance().component(n).set("dnsHostnames",e),null},setAmazonDns:function(e){var n;return n=this.get("uid"),t.instance().component(n).get("dhcp").set("amazonDNS",e),null},removeDhcp:function(e){var n,r;return r=this.get("uid"),n=t.instance().component(r).get("dhcp"),e?n.setDefault():n.setNone(),null},useDhcp:function(){var e;return e=this.get("uid"),t.instance().component(e).get("dhcp").setCustom(),null},setDHCPOptions:function(e){var n,r;return r=this.get("uid"),n=t.instance().component(r).get("dhcp"),n.set(e),null}}),new r})}.call(this),define("module/design/property/vpc/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP_VPC_APP_VPC_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_VPC_APP_STATE",{hash:{},data:t}))+'</dt>\n      <dd><i class="status status-'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'"></i>'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_VPC_APP_CIDR",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.cidrBlock,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_VPC_DETAIL_LBL_TENANCY",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.instanceTenancy,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_VPC_APP_MAIN_RT",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.mainRTB,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_VPC_APP_DEFAULT_ACL",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.defaultACL,typeof i===a?i.apply(e):i))+'</dd>\n    </dl>\n    <section class="property-control-group">\n      <div class="checkbox">\n        <input id="property-dns-resolution" type="checkbox"',i=n["if"].call(e,e&&e.dnsSupport,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+=' name="dns-resolution">\n        <label for="property-dns-resolution"></label>\n      </div>\n      <label for="property-dns-resolution">'+u(n.i18n.call(e,"PROP_VPC_DETAIL_LBL_ENABLE_DNS_RESOLUTION",{hash:{},data:t}))+'</label>\n    </section>\n\n\n    <section class="property-control-group">\n      <div class="checkbox">\n        <input id="property-dns-hostname" type="checkbox"',i=n["if"].call(e,e&&e.dnsHosts,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+=' name="dns-hostname">\n        <label for="property-dns-hostname"></label>\n      </div>\n      <label for="property-dns-hostname">'+u(n.i18n.call(e,"PROP_VPC_DETAIL_LBL_ENABLE_DNS_HOSTNAME_SUPPORT",{hash:{},data:t}))+"</label>\n    </section>\n  </div>\n\n\n  ",r}function c(e,t){return' checked="checked"'}function h(e,t){var r="",i;r+='\n  <div class="option-group" data-bind="true">\n    <section class="property-control-group clearfix">\n      <label class="left" for="property-vpc-name">'+u(n.i18n.call(e,"PROP_VPC_DETAIL_LBL_NAME",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP_LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <input class="input vpc-name" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-vpc-name" maxlength="255" data-ignore="true" data-required-rollback="true"/>\n    </section>\n\n    <section class="property-control-group clearfix">\n      <label class="left" for="property-cidr-block">'+u(n.i18n.call(e,"PROP_VPC_DETAIL_LBL_CIDR_BLOCK",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP_LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <input class="input cidr-block tooltip" type="text" value="'+u((i=e&&e.cidr,typeof i===a?i.apply(e):i))+'" id="property-cidr-block" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_EG_10_0_0_0_16",{hash:{},data:t}))+'" maxlength="255" data-ignore="true" data-required-rollback="true" data-trigger="change" data-type="awsCidr"/>\n    </section>\n\n    <section class="property-control-group">\n      <label class="left">'+u(n.i18n.call(e,"PROP_VPC_DETAIL_LBL_TENANCY",{hash:{},data:t}))+'</label>\n      <div class="selectbox selectbox-mega" id="property-tenancy">\n        <div class="selection">',i=n["if"].call(e,e&&e.defaultTenancy,{hash:{},inverse:f.program(7,d,t),fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;r+='</div>\n        <ul class="dropdown" tabindex="-1">\n          <li class="item',i=n["if"].call(e,e&&e.defaultTenancy,{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+='" data-id="default">'+u(n.i18n.call(e,"PROP_VPC_DETAIL_TENANCY_LBL_DEFAULT",{hash:{},data:t}))+'</li>\n          <li class="item',i=n.unless.call(e,e&&e.defaultTenancy,{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+='" data-id="dedicated">'+u(n.i18n.call(e,"PROP_VPC_DETAIL_TENANCY_LBL_DEDICATED",{hash:{},data:t}))+'</li>\n        </ul>\n      </div>\n      <div id="desc-dedicated" class="property-info">Selecting \'Dedicated\' forces all instances launched into this VPC to run on single-tenant hardware. <a target="_blank" href="http://aws.amazon.com/dedicated-instances/">Additional charges will apply.</a></div>\n    </section>\n\n    <section class="property-control-group">\n      <div class="checkbox">\n        <input id="property-dns-resolution" type="checkbox"',i=n["if"].call(e,e&&e.dnsSupport,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+=' name="dns-resolution">\n        <label for="property-dns-resolution"></label>\n      </div>\n      <label for="property-dns-resolution">'+u(n.i18n.call(e,"PROP_VPC_DETAIL_LBL_ENABLE_DNS_RESOLUTION",{hash:{},data:t}))+'</label>\n    </section>\n\n\n    <section class="property-control-group">\n      <div class="checkbox">\n        <input id="property-dns-hostname" type="checkbox"',i=n["if"].call(e,e&&e.dnsHosts,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+=' name="dns-hostname">\n        <label for="property-dns-hostname"></label>\n      </div>\n      <label for="property-dns-hostname">'+u(n.i18n.call(e,"PROP_VPC_DETAIL_LBL_ENABLE_DNS_HOSTNAME_SUPPORT",{hash:{},data:t}))+"</label>\n    </section>\n  </div>\n\n  ",r}function p(e,t){var r;return r=n.i18n.call(e,"PROP_VPC_DETAIL_TENANCY_LBL_DEFAULT",{hash:{},data:t}),r||r===0?r:""}function d(e,t){return"Dedicated"}function v(e,t){return" selected"}function m(e,t){return'checked="checked"  '}function g(e,t){var r="",i;r+="\n      ",i=n["if"].call(e,(i=e&&e.dhcp,i==null||i===!1?i:i["default"]),{hash:{},inverse:f.noop,fn:f.program(14,y,t),data:t});if(i||i===0)r+=i;return r+="\n    ",r}function y(e,t){var r="",i;r+='\n      <section class="property-control-group">\n        <div class="radio property-dhcp">\n          <input id="property-dhcp-default" type="radio" name="dhcp-opts" ',i=n["if"].call(e,(i=e&&e.dhcp,i==null||i===!1?i:i["default"]),{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+='value="none" />\n          <label for="property-dhcp-default"></label>\n        </div>\n        <label for="property-dhcp-default">'+u(n.i18n.call(e,"PROP_VPC_DHCP_LBL_DEFAULT",{hash:{},data:t}))+"</label>\n      </section>\n      ",r}function b(e,t){return'checked="checked" '}function w(e,t){var r="",i;r+='\n      <section class="property-control-group">\n        <div class="radio property-dhcp">\n          <input id="property-dhcp-default" type="radio" name="dhcp-opts" ',i=n["if"].call(e,(i=e&&e.dhcp,i==null||i===!1?i:i["default"]),{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+='value="none" />\n          <label for="property-dhcp-default"></label>\n        </div>\n        <label for="property-dhcp-default">'+u(n.i18n.call(e,"PROP_VPC_DHCP_LBL_DEFAULT",{hash:{},data:t}))+"</label>\n      </section>\n    ",r}function E(e,t){return'checked="checked"'}function S(e,t){return"hide"}function x(e,t){return"3"}function T(e,t){return"4"}function N(e,t){var r="";return r+='\n          <div class="multi-ipt-row">\n            <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n            <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_DNS",{hash:{},data:t}))+'" value="'+u(typeof e===a?e.apply(e):e)+'" type="text" maxlength="255" placeholder="'+u(n.i18n.call(e,"PROP_VPC_TIP_EG_172_16_16_16",{hash:{},data:t}))+'" data-type="ipv4" data-ignore="true"></span>\n          </div>\n          ',r}function C(e,t){var r="";return r+='\n          <div class="multi-ipt-row">\n            <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n            <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_DNS",{hash:{},data:t}))+'"  placeholder="'+u(n.i18n.call(e,"PROP_VPC_TIP_EG_172_16_16_16",{hash:{},data:t}))+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n          </div>\n          ',r}function k(e,t){var r="";return r+='\n          <div class="multi-ipt-row">\n            <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n            <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_NTP",{hash:{},data:t}))+'" value="'+u(typeof e===a?e.apply(e):e)+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n          </div>\n          ',r}function L(e,t){var r="";return r+='\n          <div class="multi-ipt-row">\n            <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n            <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_NTP",{hash:{},data:t}))+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n          </div>\n          ',r}function A(e,t){var r="";return r+='\n          <div class="multi-ipt-row">\n            <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n            <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_NETBIOS",{hash:{},data:t}))+'" value="'+u(typeof e===a?e.apply(e):e)+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n          </div>\n          ',r}function O(e,t){var r="";return r+='\n          <div class="multi-ipt-row">\n            <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n            <span class="ipt-wrapper"><input class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_VPC_TIP_ENTER_UP_TO_4_NETBIOS",{hash:{},data:t}))+'" type="text" maxlength="255" data-type="ipv4" data-ignore="true"></span>\n          </div>\n          ',r}function M(e,t){var r;return r=n.i18n.call(e,"PROP_VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE_NOT_SPECIFIED",{hash:{},data:t}),r||r===0?r:""}function _(e,t){var r="",i;r+='\n            <li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+u((i=e&&e.id,typeof i===a?i.apply(e):i))+'">'+u((i=e&&e.value,typeof i===a?i.apply(e):i))+"</li>\n            ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article>\n  <div class="option-group-head expand" id="vpc-property-detail">'+u(n.i18n.call(t,"PROP_VPC_TIT_DETAIL",{hash:{},data:i}))+"</div>\n\n  ",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.program(4,h,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n  <div class="option-group-head">'+u(n.i18n.call(t,"PROP_VPC_TIT_DHCP_OPTION",{hash:{},data:i}))+'</div>\n  <div class="option-group" id="dhcp-property-detail" data-type="true">\n    <section class="property-control-group">\n      <div class="radio property-dhcp">\n        <input id="property-dhcp-none" type="radio" name="dhcp-opts" ',o=n["if"].call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.none),{hash:{},inverse:f.noop,fn:f.program(11,m,i),data:i});if(o||o===0)s+=o;s+='value="none" />\n        <label for="property-dhcp-none"></label>\n      </div>\n      <label for="property-dhcp-none">'+u(n.i18n.call(t,"PROP_VPC_DHCP_LBL_NONE",{hash:{},data:i}))+"</label>\n    </section>\n\n    ",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.program(17,w,i),fn:f.program(13,g,i),data:i});if(o||o===0)s+=o;s+='\n    <section class="property-control-group">\n      <div class="radio property-dhcp">\n        <input id="property-dhcp-spec" type="radio" name="dhcp-opts" ',o=n["if"].call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.hasDhcp),{hash:{},inverse:f.noop,fn:f.program(19,E,i),data:i});if(o||o===0)s+=o;s+=' value="specified"/>\n        <label for="property-dhcp-spec"></label>\n      </div>\n      <label for="property-dhcp-spec">'+u(n.i18n.call(t,"PROP_VPC_DHCP_LBL_SPECIFIED",{hash:{},data:i}))+'</label>\n\n      <div class="property-info ',o=n["if"].call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.hasDhcp),{hash:{},inverse:f.noop,fn:f.program(21,S,i),data:i});if(o||o===0)s+=o;s+='" id="property-dhcp-desc">Specify Domain Name, DNS Server, NTP server NetBIOS Name Server or NetBIOS Node Type.</div>\n    </section>\n\n    <section id="property-dhcp-options" data-bind="true" class="property-control-group-sub ',o=n.unless.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.hasDhcp),{hash:{},inverse:f.noop,fn:f.program(21,S,i),data:i});if(o||o===0)s+=o;s+='">\n      <div class="property-control-group">\n        <label class="left" for="property-dhcp-domain">'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME",{hash:{},data:i}))+'</label>\n        <input class="input tooltip" type="text" value="'+u((o=(o=t&&t.dhcp,o==null||o===!1?o:o.domainName),typeof o===a?o.apply(t):o))+'" data-tooltip="'+u(n.i18n.call(t,"PROP_VPC_TIP_ENTER_THE_DOMAIN_NAME",{hash:{},data:i}))+'" id="property-dhcp-domain" maxlength="255" data-type="domain" data-ignore="true"/>\n      </div>\n\n      <div class="property-control-group">\n        <label>'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME_SERVER",{hash:{},data:i}))+'</label>\n        <div>\n          <div class="checkbox left">\n            <input id="property-amazon-dns" ',o=n["if"].call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.amazonDNS),{hash:{},inverse:f.noop,fn:f.program(19,E,i),data:i});if(o||o===0)s+=o;s+='type="checkbox">\n            <label for="property-amazon-dns"></label>\n          </div>\n          <label for="property-amazon-dns">'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_AMZN_PROVIDED_DNS",{hash:{},data:i}))+'</label>\n        </div>\n\n        <div id="property-domain-server" class="multi-input" data-max-row="',o=n["if"].call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.amazonDNS),{hash:{},inverse:f.program(25,T,i),fn:f.program(23,x,i),data:i});if(o||o===0)s+=o;s+='">\n          ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.domainServers),{hash:{},inverse:f.program(29,C,i),fn:f.program(27,N,i),data:i});if(o||o===0)s+=o;s+='\n        </div>\n      </div>\n\n      <div class="property-control-group">\n        <label>'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_NTP_SERVER",{hash:{},data:i}))+'</label>\n        <div id="property-ntp-server" class="multi-input" data-max-row="4">\n          ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.ntpServers),{hash:{},inverse:f.program(33,L,i),fn:f.program(31,k,i),data:i});if(o||o===0)s+=o;s+='\n        </div>\n      </div>\n\n      <div class="property-control-group">\n        <label>'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_NETBIOS_NAME_SERVER",{hash:{},data:i}))+'</label>\n        <div id="property-netbios-server" class="multi-input" data-max-row="4">\n          ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.netbiosServers),{hash:{},inverse:f.program(37,O,i),fn:f.program(35,A,i),data:i});if(o||o===0)s+=o;s+='\n        </div>\n      </div>\n\n      <div class="property-control-group">\n        <label>'+u(n.i18n.call(t,"PROP_VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE",{hash:{},data:i}))+'</label>\n        <div class="selectbox selectbox-mega" id="property-netbios-type">\n          <div class="selection tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP_VPC_TIP_SELECT_NETBIOS_NODE",{hash:{},data:i}))+'">',o=n.unless.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.netbiosType),{hash:{},inverse:f.noop,fn:f.program(39,M,i),data:i});if(o||o===0)s+=o;s+='</div>\n          <ul class="dropdown" tabindex="-1">\n            ',o=n.each.call(t,(o=t&&t.dhcp,o==null||o===!1?o:o.netbiosTypes),{hash:{},inverse:f.noop,fn:f.program(41,_,i),data:i});if(o||o===0)s+=o;return s+="\n          </ul>\n        </div>\n      </div>\n\n    </section>\n  </div>\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/vpc/view",["../base/view","./template/stack","i18n!nls/lang.js"],function(e,t,n){var r,i,s;return i=function(e){var t,n,r,i,s;t=$(e),r=[];for(i=0,s=t.length;i<s;i++)n=t[i],n.value&&r.push(n.value);return r},s=function(){var e;return e=$("#property-domain-server").children().length,e>3?$("#property-amazon-dns").attr("disabled",!0):$("#property-amazon-dns").removeAttr("disabled")},r=e.extend({events:{"change #property-vpc-name":"onChangeName","change #property-cidr-block":"onChangeCidr","change #property-dns-resolution":"onChangeDnsSupport","change #property-dns-hostname":"onChangeDnsHostname","OPTION_CHANGE #property-tenancy":"onChangeTenancy","click #property-dhcp-none":"onRemoveDhcp","click #property-dhcp-default":"onRemoveDhcp","click #property-dhcp-spec":"onUseDHCP","click #property-amazon-dns":"onChangeAmazonDns","change .property-control-group-sub .input":"onChangeDhcpOptions","OPTION_CHANGE #property-netbios-type":"onChangeDhcpOptions","REMOVE_ROW #property-dhcp-options":"onChangeDhcpOptions","ADD_ROW .multi-input":"processParsley"},render:function(){var e,r;return e=this.model.attributes,r=e.dhcp.netbiosType||0,e.dhcp.netbiosTypes=[{id:"default",value:n.ide.PROP_VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE_NOT_SPECIFIED,selected:r===0},{id:1,value:1,selected:r===1},{id:2,value:2,selected:r===2},{id:4,value:4,selected:r===4},{id:8,value:8,selected:r===8}],this.$el.html(t(e)),$("#property-domain-server").on("ADD_ROW REMOVE_ROW",s),s(),multiinputbox.update($("#property-domain-server")),e.name},processParsley:function(e){return $(e.currentTarget).find("input").last().removeClass("parsley-validated").removeClass("parsley-error").next(".parsley-error-list").remove()},onChangeName:function(e){var t,n;return n=$(e.currentTarget),t=n.val(),this.checkResName(n,"Route Table")&&(this.model.setName(t),this.setTitle(t)),null},onChangeCidr:function(e){var t,r;return r=$(e.currentTarget),t=r.val(),r.parsley("validate")&&(this.model.setCidr(t)||(r.val(this.model.get("cidr")),notification(n.ide.NOTIFY_MSG_WARN_CANNT_AUTO_ASSIGN_CIDR_FOR_SUBNET))),null},onChangeTenancy:function(e,t){return this.model.setTenancy(t),null},onChangeDnsSupport:function(e){return this.model.setDnsSupport(e.target.checked),null},onChangeDnsHostname:function(e){return this.model.setDnsHosts(e.target.checked),null},onRemoveDhcp:function(e){var t;return t=$(e.currentTarget).closest("section").find("input").attr("id")==="property-dhcp-default",$("#property-dhcp-desc").show(),$("#property-dhcp-options").hide(),this.model.removeDhcp(t),null},onChangeAmazonDns:function(e){var t,n,r,i;return i=$("#property-amazon-dns").is(":checked"),r=i?3:4,t=$("#property-domain-server").attr("data-max-row",r),n=t.children(),t.toggleClass("max",n.length>=r),this.model.setAmazonDns(i),null},onUseDHCP:function(e){return $("#property-dhcp-desc").hide(),$("#property-dhcp-options").show(),this.model.useDhcp(),null},onChangeDhcpOptions:function(e){var t;if(e&&!$(e.currentTarget).closest("[data-bind=true]").parsley("validate"))return;return t={domainName:$("#property-dhcp-domain").val(),domainServers:i("#property-domain-server .input"),ntpServers:i("#property-ntp-server .input"),netbiosServers:i("#property-netbios-server .input"),netbiosType:parseInt($("#property-netbios-type .selection").html(),10)||0},void 0,this.model.setDHCPOptions(t),null}}),new r})}.call(this),function(){define("module/design/property/vpc/app_model",["../base/model","Design","constant"],function(e,t,n){var r;return r=e.extend({init:function(e){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;p=t.instance().component(e),u=MC.data.resource_list[t.instance().region()],v=u[p.get("appId")];if(!v)return!1;v=$.extend(!0,{},v),v.name=p.get("name"),o=n.RESTYPE.RT,s=n.RESTYPE.ACL,i=t.modelClassForType(o),r=t.modelClassForType(s),v.mainRTB=i.getMainRouteTable(),v.mainRTB&&(v.mainRTB=v.mainRTB.get("appId")),v.defaultACL=r.getDefaultAcl(),v.defaultACL&&(v.defaultACL=v.defaultACL.get("appId"));if(v.dhcpOptionsId)if(!u[v.dhcpOptionsId])v.default_dhcp=!0;else{f=u[v.dhcpOptionsId].dhcpConfigurationSet.item,a={};for(m=0,y=f.length;m<y;m++){l=f[m];if(l.key==="domain-name-servers"){w=l.valueSet;for(c=g=0,b=w.length;g<b;c=++g){h=w[c];if(h==="AmazonProvidedDNS"){d=l.valueSet[0],l.valueSet[0]=h,l.valueSet[c]=d;break}}}a[MC.camelCase(l.key)]=l.valueSet}v.dhcp=a}return this.set(v),null}}),new r})}.call(this),define("module/design/property/vpc/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n  <div class="property-control-group">\n    <p>'+u(n.i18n.call(e,"PROP_VPC_DHCP_LBL_DEFAULT",{hash:{},data:t}))+"</p>\n  ",r}function c(e,t){var r="",i;r+="\n  ",i=n.unless.call(e,e&&e.dhcp,{hash:{},inverse:f.program(6,p,t),fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n  ",r}function h(e,t){var r="";return r+="\n    <p>"+u(n.i18n.call(e,"PROP_VPC_DHCP_LBL_NONE",{hash:{},data:t}))+"</p>\n </div>\n    ",r}function p(e,t){var r="",i;r+='\n\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(e,"PROP_VPC_DHCP_OPTION_SET_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.dhcpOptionsId,typeof i===a?i.apply(e):i))+"</dd>\n\n    ",i=n["if"].call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.domainName),{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n["if"].call(e,(i=(i=e&&e.dhcp,i==null||i===!1?i:i.domainNameServers),i==null||i===!1?i:i.length),{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n["if"].call(e,(i=(i=e&&e.dhcp,i==null||i===!1?i:i.ntpServers),i==null||i===!1?i:i.length),{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;r+="\n\n\n    ",i=n["if"].call(e,(i=(i=e&&e.dhcp,i==null||i===!1?i:i.netbiosNameServers),i==null||i===!1?i:i.length),{hash:{},inverse:f.noop,fn:f.program(14,y,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n["if"].call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.netbiosNodeType),{hash:{},inverse:f.noop,fn:f.program(16,b,t),data:t});if(i||i===0)r+=i;return r+="\n\n  </dl>\n\n  ",r}function d(e,t){var r="",i;return r+="\n    <dt>"+u(n.i18n.call(e,"PROP_VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=(i=(i=e&&e.dhcp,i==null||i===!1?i:i.domainName),i==null||i===!1?i:i[0]),typeof i===a?i.apply(e):i))+"</dd>\n    ",r}function v(e,t){var r="",i;r+="\n    <dt>"+u(n.i18n.call(e,"PROP_VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME_SERVER",{hash:{},data:t}))+"</dt>\n    <dd>",i=n.each.call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.domainNameServers),{hash:{},inverse:f.noop,fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;return r+="\n    </dd>\n    ",r}function m(e,t){var n="";return n+="<p>"+u(typeof e===a?e.apply(e):e)+"</p>",n}function g(e,t){var r="",i;r+="\n    <dt>"+u(n.i18n.call(e,"PROP_VPC_DHCP_SPECIFIED_LBL_NTP_SERVER",{hash:{},data:t}))+"</dt>\n    <dd>",i=n.each.call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.ntpServers),{hash:{},inverse:f.noop,fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;return r+="\n    </dd>\n    ",r}function y(e,t){var r="",i;r+="\n    <dt>"+u(n.i18n.call(e,"PROP_VPC_DHCP_SPECIFIED_LBL_NETBIOS_NAME_SERVER",{hash:{},data:t}))+"</dt>\n    <dd>",i=n.each.call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.netbiosNameServers),{hash:{},inverse:f.noop,fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;return r+="\n    </dd>\n    ",r}function b(e,t){var r="",i;return r+="\n    <dt>"+u(n.i18n.call(e,"PROP_VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=(i=(i=e&&e.dhcp,i==null||i===!1?i:i.netbiosNodeType),i==null||i===!1?i:i[0]),typeof i===a?i.apply(e):i))+"</dd>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP_VPC_TIT_DETAIL",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(t,"PROP_VPC_APP_VPC_ID",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.vpcId,typeof o===a?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP_VPC_APP_STATE",{hash:{},data:i}))+'</dt>\n      <dd><i class="status status-'+u((o=t&&t.state,typeof o===a?o.apply(t):o))+'"></i>'+u((o=t&&t.state,typeof o===a?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP_VPC_APP_CIDR",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.cidrBlock,typeof o===a?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP_VPC_DETAIL_LBL_TENANCY",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.instanceTenancy,typeof o===a?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP_VPC_APP_MAIN_RT",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.mainRTB,typeof o===a?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP_VPC_APP_DEFAULT_ACL",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.defaultACL,typeof o===a?o.apply(t):o))+'</dd>\n    </dl>\n  </div>\n\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP_VPC_TIT_DHCP_OPTION",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n\n  ',o=n["if"].call(t,t&&t.default_dhcp,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n\n  </div>\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/vpc/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name}}),new n})}.call(this),function(){define("module/design/property/vpc/main",["../base/main","./model","./view","./app_model","./app_view","constant"],function(e,t,n,r,i,s){var o;return o=e.extend({handleTypes:s.RESTYPE.VPC,initStack:function(){return this.model=t,this.model.isAppEdit=!1,this.view=n,null},initApp:function(){return this.model=r,this.view=i,null},initAppEdit:function(){return this.model=t,this.model.isAppEdit=!0,this.view=n,null}}),null})}.call(this),function(){define("module/design/property/rtb/model",["../base/model","Design","constant"],function(e,t,n){var r;return r=e.extend({defaults:{isAppEdit:!1},setMainRT:function(){return t.instance().component(this.get("uid")).setMain(),this.isAppEdit&&(this.setMainMessage(this.get("uid")),this.set("isMain",t.instance().component(this.get("uid")).get("main"))),null},reInit:function(){return this.init(this.get("uid")),null},init:function(e){var r,i,s,o,u,a,f,l,c,h,p,d;u=t.instance(),s=u.component(e),a=n.RESTYPE;if(s.node_line){l=s.getTarget(a.SUBNET),s=s.getTarget(a.RT);if(l){this.set({title:"Subnet-RT Association",association:{subnet:l.get("name"),rtb:s.get("name")}});return}}r=t.modelClassForType(a.VPC),f=[],o={uid:s.id,title:s.get("name"),isMain:s.get("main"),local_route:r.theVPC().get("cidr"),routes:f,isAppEdit:this.isAppEdit},d=s.connections();for(h=0,p=d.length;h<p;h++){i=d[h];if(i.type!=="RTB_Route")continue;c=i.getOtherTarget(a.RT),f.push({name:c.get("name"),type:c.type,ref:i.id,isVgw:c.type===a.VGW,isProp:i.get("propagate"),cidr_set:i.get("routes")})}return f=_.sortBy(f,"type"),this.isAppEdit&&(this.set("vpcId",s.parent().get("appId")),this.set("routeTableId",s.get("appId")),this.setMainMessage(e)),this.set(o),!0},setMainMessage:function(e){var r,i,s,o,u,a,f,l,c;o=t.instance().component(e),a=MC.data.resource_list[t.instance().region()],r=a[o.get("appId")],s=!1;if(r&&r.associationSet&&r.associationSet.item){c=r.associationSet.item;for(f=0,l=c.length;f<l;f++)i=c[f],i.main===!0&&(s=!0)}return u=t.modelClassForType(n.RESTYPE.RT).getMainRouteTable(),s&&u.id!==o.id?this.set("main","Yes (Set as No after applying updates)"):s&&u.id===o.id?this.set("main","Yes"):!s&&u.id===o.id?this.set("main","No (Set as Yes after applying updates)"):this.set("main","No")},setPropagation:function(e){var r,i;return i=t.instance().component(this.get("uid")),r=_.find(i.connections(),function(e){return e.getTarget(n.RESTYPE.VGW)!==null}),r.setPropagate(e),null},setRoutes:function(e,n){return t.instance().component(e).set("routes",n),null},isCidrConflict:function(e,r){return t.modelClassForType(n.RESTYPE.SUBNET).isCidrConflict(e,r)}}),new r})}.call(this),define("module/design/property/rtb/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n	<div class="property-control-group">'+u(n.i18n.call(e,"PROP_RT_ASSOCIATION",{hash:{},data:t}))+" "+u((i=(i=e&&e.association,i==null||i===!1?i:i.subnet),typeof i===a?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP_RT_ASSOCIATION_TO",{hash:{},data:t}))+" "+u((i=(i=e&&e.association,i==null||i===!1?i:i.rtb),typeof i===a?i.apply(e):i))+"</div>\n",r}function c(e,t){var r="",i;r+='\n	<div class="property-control-group" data-bind="true">\n		<label class="left" for="rt-name">'+u(n.i18n.call(e,"PROP_RT_NAME",{hash:{},data:t}))+'</label>\n		<input class="input" type="text" data-required="true" data-ignore="true" data-required-rollback="true" ',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+=' value="'+u((i=e&&e.title,typeof i===a?i.apply(e):i))+'" id="rt-name">\n	</div>\n\n	',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:f.program(9,v,t),fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+='\n\n\n\n	<div class="option-group-head expand">'+u(n.i18n.call(e,"PROP_RT_LBL_ROUTE",{hash:{},data:t}))+'</div>\n	<div class="option-group" data-bind="true">\n		<ul class="property-list property-list-no-padding route-list">\n			<li><table class="table-no-style">\n			  <tr class="route-target">\n			    <td class="route-label">'+u(n.i18n.call(e,"PROP_RT_TARGET",{hash:{},data:t}))+'</td>\n			    <td class="route-target-resource">'+u(n.i18n.call(e,"PROP_RT_LOCAL",{hash:{},data:t}))+'</td>\n			  </tr>\n			  <tr>\n			    <td class="route-label">'+u(n.i18n.call(e,"PROP_RT_DESTINATION",{hash:{},data:t}))+'</td>\n			    <td class="route-destination-input">\n			    	<div class="route-destination-input multi-input"><input class="input" disabled="disabled" value="'+u((i=e&&e.local_route,typeof i===a?i.apply(e):i))+'"></div>\n			    </td>\n			  </tr>\n			</table></li>\n\n			',i=n.each.call(e,e&&e.routes,{hash:{},inverse:f.noop,fn:f.program(14,y,t),data:t});if(i||i===0)r+=i;return r+="\n		</ul>\n	</div>\n",r}function h(e,t){return'disabled="disabled"'}function p(e,t){var r="",i;r+='\n	  <dl class="dl-vertical">\n	    <dt>'+u(n.i18n.call(e,"PROP_RT_ID",{hash:{},data:t}))+"</dt>\n	    <dd>"+u((i=e&&e.routeTableId,typeof i===a?i.apply(e):i))+"</dd>\n\n	    <dt>"+u(n.i18n.call(e,"PROP_RT_LBL_MAIN_RT",{hash:{},data:t}))+"</dt>\n	    <dd>"+u((i=e&&e.main,typeof i===a?i.apply(e):i))+"</dd>\n\n	    <dt>"+u(n.i18n.call(e,"PROP_RT_VPC_ID",{hash:{},data:t}))+"</dt>\n	    <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+"</dd>\n	  </dl>\n\n	  	",i=n.unless.call(e,e&&e.isMain,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n\n	",r}function d(e,t){var r="";return r+='\n	  	<div class="tac property-control-group">\n			<button class="btn btn-primary" id="set-main-rt" style="width: 200px;">'+u(n.i18n.call(e,"PROP_RT_SET_MAIN",{hash:{},data:t}))+'</button>\n			<p class="hide">'+u(n.i18n.call(e,"PROP_RT_LBL_MAIN_RT",{hash:{},data:t}))+"</p>\n		</div>\n		",r}function v(e,t){var r="",i;r+='\n		<div class="tac property-control-group">\n			',i=n["if"].call(e,e&&e.isMain,{hash:{},inverse:f.program(12,g,t),fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;return r+="\n		</div>\n	",r}function m(e,t){var r="";return r+="\n			<p>"+u(n.i18n.call(e,"PROP_RT_LBL_MAIN_RT",{hash:{},data:t}))+"</p>\n			",r}function g(e,t){var r="";return r+='\n			<button class="btn btn-primary" id="set-main-rt" style="width: 200px;">'+u(n.i18n.call(e,"PROP_RT_SET_MAIN",{hash:{},data:t}))+'</button>\n			<p class="hide">'+u(n.i18n.call(e,"PROP_RT_LBL_MAIN_RT",{hash:{},data:t}))+"</p>\n			",r}function y(e,t){var r="",i;r+='\n			<li><table class="table-no-style">\n			  <tr class="route-target">\n			    <td class="route-label">'+u(n.i18n.call(e,"PROP_RT_TARGET",{hash:{},data:t}))+'</td>\n			    <td class="route-target-resource">'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'</td>\n			  </tr>\n\n			  <tr>\n			    <td class="route-label">'+u(n.i18n.call(e,"PROP_RT_DESTINATION",{hash:{},data:t}))+'</td>\n			    <td class="route-destination-input">\n			    	<div class="route-destination-input multi-input" data-ref="'+u((i=e&&e.ref,typeof i===a?i.apply(e):i))+'">\n\n						',i=n.each.call(e,e&&e.cidr_set,{hash:{},inverse:f.program(17,w,t),fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;r+="\n				    </div>\n\n				    ",i=n["if"].call(e,e&&e.isVgw,{hash:{},inverse:f.noop,fn:f.program(19,E,t),data:t});if(i||i===0)r+=i;return r+="\n			    </td>\n			  </tr>\n			</table></li>\n			",r}function b(e,t){var n="";return n+='\n						<div class="multi-ipt-row">\n		          <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n		          <span class="ipt-wrapper"><input class="ip-main-input input" data-ignore="true" data-ignore-regexp="^[0-9./]*$" data-type="cidr" data-trigger="change" placeholder="eg. 0.0.0.0/0" value="'+u(typeof e===a?e.apply(e):e)+'" type="text"></span>\n		        </div>\n						',n}function w(e,t){return'\n						<div class="multi-ipt-row">\n		          <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n		          <span class="ipt-wrapper"><input class="input tooltip" data-ignore="true" data-ignore-regexp="^[0-9./]*$" placeholder="eg. 0.0.0.0/0" data-empty-remove="true" type="text"></span>\n		        </div>\n			      '}function E(e,t){var r="",i;r+='\n				    <div class="property-control-group">\n							<div class="checkbox">\n								<input id="propagate_'+u((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'" type="checkbox" class="propagation" ',i=n["if"].call(e,e&&e.isProp,{hash:{},inverse:f.noop,fn:f.program(20,S,t),data:t});if(i||i===0)r+=i;return r+='>\n								<label for="propagate_'+u((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'"></label>\n							</div>\n							<label for="propagate_'+u((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'">Allow propagation</label>\n						</div>\n						',r}function S(e,t){return'checked="true"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+="<article>\n",o=n["if"].call(t,t&&t.association,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/rtb/view",["../base/view","./template/stack"],function(e,t){var n;return n=e.extend({events:{"REMOVE_ROW  .multi-input":"removeIp","ADD_ROW     .multi-input":"processParsley","BEFORE_REMOVE_ROW  .multi-input":"beforeRemoveIp","change #rt-name":"changeName","click #set-main-rt":"setMainRT","change .propagation":"changePropagation","focus .ipt-wrapper .input":"onFocusCIDR","keypress .ipt-wrapper .input":"onPressCIDR","blur .ipt-wrapper .input":"onBlurCIDR"},render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.title},processParsley:function(e){return $(e.currentTarget).find("input").last().focus().removeClass("parsley-validated").removeClass("parsley-error").next(".parsley-error-list").remove(),null},beforeRemoveIp:function(e){var t;return t=$(e.currentTarget).find("input").filter(function(){return this.value.length}),t.length<=1&&e.value?!1:null},removeIp:function(e){var t,n;return t=$(e.currentTarget),n=_.map(t.find("input"),function(e){return e.value}),this.model.setRoutes(t.attr("data-ref"),_.uniq(n)),null},changeName:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(this.checkResName(n,"Route Table"))return this.model.setName(t),this.setTitle(t)},setMainRT:function(){return this.model.isAppEdit?(this.model.setMainRT(),this.render()):($("#set-main-rt").hide().parent().find("p").show(),this.model.setMainRT()),null},changePropagation:function(e){return this.model.setPropagation($(e.target).is(":checked")),null},onPressCIDR:function(e){if(e.keyCode===13)return $(e.currentTarget).blur()},onFocusCIDR:function(e){return this.disabledAllOperabilityArea(!0),null},onBlurCIDR:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p;o=$(e.currentTarget),u=o.val(),l=o.closest(".multi-input"),r=l.attr("data-ref"),a=[],l.find("input").each(function(){return this!==e.currentTarget&&this.value&&a.push(this.value),null}),t=_.uniq(a),l.closest("li").siblings().each(function(){var e;return e=[],$(this).find("input").each(function(){return this.value&&e.push(this.value),null}),t=t.concat(_.uniq(e)),null});if(!u)o.closest(".multi-ipt-row").siblings().length===0&&(f="CIDR block is required.",i="Please provide a IP ranges for this route.");else if(!MC.validate("cidr",u))f=""+u+" is not a valid form of CIDR block.",i="Please provide a valid IP range. For example, 10.0.0.1/24.";else for(h=0,p=t.length;h<p;h++){n=t[h];if(u===n||n!=="0.0.0.0/0"&&this.model.isCidrConflict(u,n)){f=""+u+" conflicts with other route.",i="Please choose a CIDR block not conflicting with existing route.";break}}if(!f){u&&a.push(u),this.model.setRoutes(r,_.uniq(a)),this.disabledAllOperabilityArea(!1);return}return s=MC.template.setupCIDRConfirm({remove_content:"Remove Route",main_content:f,desc_content:i}),c=this,modal(s,!1,function(){return $(".modal-close").click(function(){return o.focus()}),$("#cidr-remove").click(function(){return $canvas.clearSelected(),Design.instance().component(r).remove(),c.disabledAllOperabilityArea(!1),modal.close()})},{$source:$(e.target)}),null}}),new n})}.call(this),function(){define("module/design/property/rtb/app_model",["../base/model","constant","Design"],function(e,t,n){var r;return r=e.extend({processTarget:function(e){return void 0,e.routeSet.item=_.map(e.routeSet.item,function(e){return e.target=e.instanceId||e.networkInterfaceId||e.gatewayId,e.target!=="local"&&n.instance().eachComponent(function(t){if(t.get("appId")===e.target){e.target=t.get("name");return}return null}),e}),null},init:function(e){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k;d=n.instance().component(e);if(d.type===t.RESTYPE.RT)h=d;else{o={},s=d.getOtherTarget(t.RESTYPE.RT),h=d.getTarget(t.RESTYPE.RT),s.type===t.RESTYPE.SUBNET&&(o.subnet=s.get("name"),a=!0),o.rtb=h.get("name"),e=h.id;if(a){this.set("association",o),this.set("name","Subnet-RT Association");return}}r=MC.data.resource_list[n.instance().region()],p=r[h.get("appId")];if(!p)return!1;p=$.extend(!0,{},p),p.name=h.get("name"),u=!1;if(p.associationSet&&p.associationSet.item){T=p.associationSet.item;for(m=0,w=T.length;m<w;m++)i=T[m],i.main===!0&&(u=!0)}u?p.main="Yes":p.main="No",N=p.routeSet.item;for(g=0,E=N.length;g<E;g++)f=N[g],f.state==="active"&&(f.active=!0);c={};if(p.propagatingVgwSet&&p.propagatingVgwSet.item){C=p.propagatingVgwSet.item;for(y=0,S=C.length;y<S;y++)f=C[y],c[f.gatewayId]=!0}k=p.routeSet.item;for(l=b=0,x=k.length;b<x;l=++b)v=k[l],c[v.gatewayId]&&(v.propagate=!0);return this.processTarget(p),this.set(p)}}),new r})}.call(this),define("module/design/property/rtb/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n  <div class="property-control-group">'+u(n.i18n.call(e,"PROP_RT_ASSOCIATION",{hash:{},data:t}))+" "+u((i=(i=e&&e.association,i==null||i===!1?i:i.subnet),typeof i===a?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP_RT_ASSOCIATION_TO",{hash:{},data:t}))+" "+u((i=(i=e&&e.association,i==null||i===!1?i:i.rtb),typeof i===a?i.apply(e):i))+"</div>\n  ",r}function c(e,t){var r="",i;r+='\n\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(e,"PROP_RT_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.routeTableId,typeof i===a?i.apply(e):i))+"</dd>\n\n    <dt>"+u(n.i18n.call(e,"PROP_RT_LBL_MAIN_RT",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.main,typeof i===a?i.apply(e):i))+"</dd>\n\n    <dt>"+u(n.i18n.call(e,"PROP_RT_VPC_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+'</dd>\n  </dl>\n\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP_RT_LBL_ROUTE",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <table class="table table-small">\n      <thead>\n        <tr>\n          <th></th>\n          <th>'+u(n.i18n.call(e,"PROP_RT_DESTINATION",{hash:{},data:t}))+"</th>\n          <th>"+u(n.i18n.call(e,"PROP_RT_TARGET",{hash:{},data:t}))+"</th>\n          <th></th>\n        </tr>\n      </thead>\n      ",i=n.each.call(e,(i=e&&e.routeSet,i==null||i===!1?i:i.item),{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n    </table>\n  </div>\n  ",r}function h(e,t){var r="",i;r+="\n      <tr>\n        ",i=n["if"].call(e,e&&e.active,{hash:{},inverse:f.program(7,d,t),fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;r+="\n        <td>"+u((i=e&&e.destinationCidrBlock,typeof i===a?i.apply(e):i))+"</td>\n        <td>"+u((i=e&&e.target,typeof i===a?i.apply(e):i))+"</td>\n        ",i=n["if"].call(e,e&&e.propagate,{hash:{},inverse:f.program(11,m,t),fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;return r+="\n      </tr>\n      ",r}function p(e,t){var r="";return r+='\n        <td><i class="status status-green tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_RT_TIP_ACTIVE",{hash:{},data:t}))+'"></i></td>\n        ',r}function d(e,t){var r="";return r+='\n        <td><i class="status status-red tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_RT_TIP_BLACKHOLE",{hash:{},data:t}))+'"></i></td>\n        ',r}function v(e,t){var r="";return r+='\n        <td><i class="icon-info tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_RT_TIP_PROPAGATED",{hash:{},data:t}))+'"></i></td>\n        ',r}function m(e,t){return"\n        <td></td>\n        "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n\n  ',o=n["if"].call(t,t&&t.association,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/rtb/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name}}),new n})}.call(this),function(){define("module/design/property/rtb/main",["../base/main","./model","./view","./app_model","./app_view","event","constant"],function(e,t,n,r,i,s,o){var u,a;return a={},a[s.CANVAS_DELETE_OBJECT]=function(){return this.model.reInit(),this.view.render()},a[s.CANVAS_CREATE_LINE]=function(){return this.model.reInit(),this.view.render()},u=e.extend({handleTypes:[o.RESTYPE.RT,"RTB_Route","RTB_Asso"],initStack:function(){return this.model=t,this.model.isAppEdit=!1,this.view=n,null},initApp:function(){return this.model=r,this.view=i,null},initAppEdit:function(){return this.model=t,this.model.isAppEdit=!0,this.view=n,null}}),null})}.call(this),function(){define("module/design/property/static/model",["module/design/property/base/model","Design","constant"],function(e,t,n){var r;return r=e.extend({init:function(e){var r,i,s,o,u,a,f,l;return s=t.instance().component(e),u=s.type===n.RESTYPE.IGW,this.set("isIGW",u),this.isApp&&(this.set("readOnly",!0),r=MC.data.resource_list[t.instance().region()],i=s.get("appId"),o=r[i],o&&(u?o.attachmentSet&&o.attachmentSet.item.length&&(a=o.attachmentSet.item[0]):a=o),a?a.attachments&&a.attachments.item&&a.attachments.item.length?(this.set("state",a.state),this.set("attachment_state",a.attachments.item[0].state),l=a.attachments.item[0].vpcId):(this.set("state",a.state),l=a.vpcId):this.set("state","unavailable"),f=r[l],f&&(l+=" ("+f.cidrBlock+")"),this.set("id",e),this.set("appId",s.get("appId")),this.set("vpc",l)),null}}),new r})}.call(this),define("module/design/property/static/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <article class="property-app">\n  <dl class="dl-vertical">\n    <dt>',i=n["if"].call(e,e&&e.isIGW,{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+=" ID</dt>\n    <dd>"+a(n.emptyStr.call(e,e&&e.appId,{hash:{},data:t}))+"</dd>\n    ",i=n["if"].call(e,e&&e.isIGW,{hash:{},inverse:f.program(8,d,t),fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+="\n    ",i=n["if"].call(e,e&&e.type,{hash:{},inverse:f.noop,fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;return r+="\n    <dt>VPC</dt>\n    <dd>"+a(n.emptyStr.call(e,e&&e.vpc,{hash:{},data:t}))+"</dd>\n  </dl>\n",r}function c(e,t){return"Internet Gateway"}function h(e,t){return"VPN Gateway"}function p(e,t){var n="",r;return n+='\n      <dt>State</dt>\n      <dd><i class="status status-xgw-'+a((r=e&&e.state,typeof r===u?r.apply(e):r))+'"></i>'+a((r=e&&e.state,typeof r===u?r.apply(e):r))+"</dd>\n    ",n}function d(e,t){var n="",r;return n+='\n      <dt>State</dt>\n      <dd><i class="status status-xgw-'+a((r=e&&e.state,typeof r===u?r.apply(e):r))+'"></i>'+a((r=e&&e.state,typeof r===u?r.apply(e):r))+'</dd>\n      <dt>Attachment State</dt>\n      <dd><i class="status status-xgw-'+a((r=e&&e.attachment_state,typeof r===u?r.apply(e):r))+'"></i>'+a((r=e&&e.attachment_state,typeof r===u?r.apply(e):r))+"</dd>\n    ",n}function v(e,t){var n="",r;return n+="\n    <dt>type</dt>\n    <dd>"+a((r=e&&e.type,typeof r===u?r.apply(e):r))+"</dd>\n    ",n}function m(e,t){var r="",i;r+='\n  <article>\n  <div  class="property-control-group">\n  ',i=n["if"].call(e,e&&e.isIGW,{hash:{},inverse:f.program(15,y,t),fn:f.program(13,g,t),data:t});if(i||i===0)r+=i;return r+="\n  </div>\n",r}function g(e,t){var r="";return r+="\n    "+a(n.i18n.call(e,"PROP_IGW_TXT_DESCRIPTION",{hash:{},data:t}))+"\n  ",r}function y(e,t){var r="";return r+="\n    "+a(n.i18n.call(e,"PROP_VGW_TXT_DESCRIPTION",{hash:{},data:t}))+"\n  ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;o=n["if"].call(t,t&&t.readOnly,{hash:{},inverse:f.program(12,m,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/static/view",["../base/view","./template/stack"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.get("isIGW")?"Internet-gateway":"VPN-gateway"}}),new n})}.call(this),function(){define("module/design/property/static/main",["../base/main","./model","./view","constant"],function(e,t,n,r){var i;return i=e.extend({handleTypes:[r.RESTYPE.VGW,r.RESTYPE.IGW],initStack:function(){return this.model=t,this.view=n,this.model.isApp=!1,null},initApp:function(){return this.model=t,this.view=n,this.model.isApp=!0,null},initAppEdit:function(){return this.model=t,this.view=n,this.model.isApp=!0,null}}),null})}.call(this),function(){define("module/design/property/cgw/model",["../base/model","Design","constant"],function(e,t,n){var r;return r=e.extend({init:function(e){var n;return n=t.instance().component(e),this.set({uid:e,name:n.get("name"),BGP:n.get("bgpAsn"),ip:n.get("ip")}),null},setIP:function(e){return t.instance().component(this.get("uid")).set("ip",e),null},setBGP:function(e){return t.instance().component(this.get("uid")).set("bgpAsn",e),null}}),new r})}.call(this),define("module/design/property/cgw/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return'checked="checked" '}function c(e,t){return'style="display:none;"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article id="property-cgw" data-bind="true">\n	<div class="property-control-group clearfix">\n		<label class="left" for="property-cgw-name">'+u(n.i18n.call(t,"PROP_CGW_LBL_NAME",{hash:{},data:i}))+'</label>\n		<span class="required-input right">'+u(n.i18n.call(t,"PROP_LBL_REQUIRED",{hash:{},data:i}))+'</span>\n		<input class="input" type="text" value="'+u((o=t&&t.name,typeof o===a?o.apply(t):o))+'" id="property-cgw-name" data-ignore="true"/>\n	</div>\n\n	<div class="property-control-group clearfix">\n		<label class="left" for="property-cgw-ip">'+u(n.i18n.call(t,"PROP_CGW_LBL_IPADDR",{hash:{},data:i}))+'</label>\n		<span class="required-input right">'+u(n.i18n.call(t,"PROP_LBL_REQUIRED",{hash:{},data:i}))+'</span>\n		<input class="input tooltip" type="text" value="'+u((o=t&&t.ip,typeof o===a?o.apply(t):o))+'" data-ignore="true" data-ignore-regexp="^[0-9.]*$" id="property-cgw-ip" data-empty-remove="true" data-tooltip="'+u(n.i18n.call(t,"PROP_CGW_TIP_THIS_ADDRESS_MUST_BE_STATIC",{hash:{},data:i}))+'"/>\n	</div>\n\n	<div class="property-control-group clearfix cgw-routing">\n		<label>'+u(n.i18n.call(t,"PROP_CGW_LBL_ROUTING",{hash:{},data:i}))+'</label>\n		<p></p>\n		<div class="radio">\n			<input id="property-routing-static" type="radio" name="routing-type" ',o=n.unless.call(t,t&&t.BGP,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='value="static" />\n			<label for="property-routing-static"></label>\n		</div>\n		<label for="property-routing-static">'+u(n.i18n.call(t,"PROP_CGW_LBL_STATIC",{hash:{},data:i}))+'</label>\n	</div>\n\n	<div class="property-control-group clearfix cgw-routing">\n		<div class="radio">\n			<input id="property-routing-dynamic" type="radio" name="routing-type" ',o=n["if"].call(t,t&&t.BGP,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='value="dynamic" />\n			<label for="property-routing-dynamic"></label>\n		</div>\n		<label for="property-routing-dynamic">'+u(n.i18n.call(t,"PROP_CGW_LBL_DYNAMIC",{hash:{},data:i}))+'</label>\n	</div>\n\n	<div class="property-control-group clearfix" ',o=n.unless.call(t,t&&t.BGP,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+=' id="property-cgw-bgp-wrapper">\n		<label class="left" for="property-cgw-bgp">'+u(n.i18n.call(t,"PROP_CGW_LBL_BGP_ASN",{hash:{},data:i}))+'</label>\n		<span class="required-input right">'+u(n.i18n.call(t,"PROP_LBL_REQUIRED",{hash:{},data:i}))+'</span>\n		<input class="input tooltip" type="text" value="'+u((o=t&&t.BGP,typeof o===a?o.apply(t):o))+'" id="property-cgw-bgp" maxlength="5" data-tooltip="'+u(n.i18n.call(t,"PROP_CGW_TIP_1TO65534",{hash:{},data:i}))+'" data-type="digits" />\n	</div>\n\n</article>\n',s};return e.template(t)}),function(){define("module/design/property/cgw/view",["i18n!nls/lang.js","../base/view","./template/stack","event","constant","Design"],function(e,t,n,r,i,s){var o;return o=t.extend({events:{"click #property-cgw .cgw-routing input":"onChangeRouting","change #property-cgw-bgp":"onChangeBGP","change #property-cgw-name":"onChangeName","focus #property-cgw-ip":"onFocusIP","keypress #property-cgw-ip":"onPressIP","blur #property-cgw-ip":"onBlurIP"},render:function(){return this.$el.html(n(this.model.toJSON())),this.model.get("name")},onChangeRouting:function(){return $("#property-cgw-bgp-wrapper").toggle($("#property-routing-dynamic").is(":checked")),this.model.setBGP("")},onChangeBGP:function(t){var n,r;n=$(t.currentTarget),r=s.instance().region();if(!n.val()){this.model.setBGP("");return}return n.parsley("custom",function(t){t=+t;if(t<1||t>65534)return e.ide.PARSLEY_MUST_BE_BETWEEN_1_AND_65534;if(t===7224&&r==="us-east-1")return e.ide.PARSLEY_ASN_NUMBER_7224_RESERVED;if(t===9059&&r==="eu-west-1")return e.ide.PARSLEY_ASN_NUMBER_9059_RESERVED_IN_IRELAND}),n.parsley("validate")&&this.model.setBGP(n.val()),null},onChangeName:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(this.checkResName(n,"Customer Gateway"))return this.model.setName(t),this.setTitle(t)},onPressIP:function(e){if(e.keyCode===13)return $("#property-cgw-ip").blur()},onFocusIP:function(e){return this.disabledAllOperabilityArea(!0),null},onBlurIP:function(e){var t,n,r,i,o,u;i=$("#property-cgw-ip").val(),r=!0,i?MC.validate("ipv4",i)?MC.aws.aws.isValidInIPRange(i,"private")?(o="IP Address "+i+" is invalid for customer gateway.",t="The address must be static and can't be behind a device performing network address translation (NAT)."):r=!1:(o=""+i+" is not a valid IP Address.",t="Please provide a valid IP Address. For example, 192.168.1.1."):(o="IP Address is required.",t="Please provide a IP Address of this Customer Gateway.");if(!r){this.model.setIP(e.target.value),this.disabledAllOperabilityArea(!1);return}return n=MC.template.setupCIDRConfirm({remove_content:"Remove Customer Gateway",main_content:o,desc_content:t}),u=this,modal(n,!1,function(){return $(".modal-close").click(function(){return $("#property-cgw-ip").focus()}),$("#cidr-remove").click(function(){return $canvas.clearSelected(),s.instance().component(u.model.get("uid")).remove(),u.disabledAllOperabilityArea(!1),modal.close()})},{$source:$(e.target)})}}),new o})}.call(this),function(){define("module/design/property/cgw/app_model",["../base/model","Design","constant"],function(e,t,n){var r;return r=e.extend({init:function(e){var n,r,i;return i=t.instance().component(e),n=MC.data.resource_list[t.instance().region()],r=n[i.get("appId")],r?(r=$.extend(!0,{},r),r.name=i.get("name"),this.set(r),null):!1}}),new r})}.call(this),define("module/design/property/cgw/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+='<article class="property-app">\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(t,"PROP_CGW_APP_CGW_LBL_ID",{hash:{},data:i}))+"</dt>\n    <dd>"+u((o=t&&t.customerGatewayId,typeof o===a?o.apply(t):o))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP_CGW_APP_CGW_LBL_STATE",{hash:{},data:i}))+'</dt>\n    <dd><i class="status status-xgw-'+u((o=t&&t.state,typeof o===a?o.apply(t):o))+'"></i>'+u((o=t&&t.state,typeof o===a?o.apply(t):o))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP_CGW_LBL_IPADDR",{hash:{},data:i}))+"</dt>\n    <dd>"+u((o=t&&t.ipAddress,typeof o===a?o.apply(t):o))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP_CGW_APP_CGW_LBL_TYPE",{hash:{},data:i}))+"</dt>\n    <dd>"+u((o=t&&t.type,typeof o===a?o.apply(t):o))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP_CGW_LBL_BGP_ASN",{hash:{},data:i}))+"</dt>\n    <dd>"+u((o=t&&t.bgpAsn,typeof o===a?o.apply(t):o))+"</dd>\n  </dl>\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/cgw/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.toJSON())),this.model.get("name")}}),new n})}.call(this),function(){define("module/design/property/cgw/main",["../base/main","./model","./view","./app_model","./app_view","constant"],function(e,t,n,r,i,s){var o;return o=e.extend({handleTypes:s.RESTYPE.CGW,setupStack:function(){var e;return e=this,this.view.on("CHANGE_NAME",function(t){return e.model.setName(t),MC.canvas.update(uid,"text","name",t),null})},initStack:function(){return this.model=t,this.view=n,null},initApp:function(){return this.model=r,this.view=i,null},initAppEdit:function(){return this.model=r,this.view=i,null}}),null})}.call(this),function(){define("module/design/property/vpn/model",["../base/model","Design","constant"],function(e,t,n){var r,i;return i=function(e,t){var n,r;return n="{}",t.customerGatewayConfiguration?(t=$.xml2json($.parseXML(t.customerGatewayConfiguration)),t?(t=t.vpn_connection,r=_.map(e,function(e){var n,r;return n={vpnConnectionId:t["@attributes"].id||"",vpnGatewayId:t.vpn_gateway_id||"",customerGatewayId:t.customer_gateway_id||""},n.tunnel=_.map(t.ipsec_tunnel,function(e,t){var n;return n={},n.number=t+1,n.ike_protocol_method=e.ike.authentication_protocol||"",n.ike_pre_shared_key=e.ike.pre_shared_key||"",n.ike_authentication_protocol_algorithm=e.ike.authentication_protocol||"",n.ike_encryption_protocol=e.ike.encryption_protocol||"",n.ike_lifetime=e.ike.lifetime||"",n.ike_mode=e.ike.mode||"",n.ike_perfect_forward_secrecy=e.ike.perfect_forward_secrecy||"",n.ipsec_protocol=e.ipsec.protocol||"",n.ipsec_authentication_protocol=e.ipsec.authentication_protocol||"",n.ipsec_encryption_protocol=e.ipsec.encryption_protocol||"",n.ipsec_lifetime=e.ipsec.lifetime||"",n.ipsec_mode=e.ipsec.mode||"",n.ipsec_perfect_forward_secrecy=e.ipsec.perfect_forward_secrecy||"",n.ipsec_interval=e.ipsec.dead_peer_detection.interval||"",n.ipsec_retries=e.ipsec.dead_peer_detection.retries||"",n.tcp_mss_adjustment=e.ipsec.tcp_mss_adjustment||"",n.clear_df_bit=e.ipsec.clear_df_bit||"",n.fragmentation_before_encryption=e.ipsec.fragmentation_before_encryption||"",n.customer_gateway_outside_address=e.customer_gateway.tunnel_outside_address.ip_address||"",n.vpn_gateway_outside_address=e.vpn_gateway.tunnel_outside_address.ip_address||"",n.customer_gateway_inside_address=e.customer_gateway.tunnel_inside_address.ip_address+"/"+e.customer_gateway.tunnel_inside_address.network_cidr||"",n.vpn_gateway_inside_address=e.vpn_gateway.tunnel_inside_address.ip_address+"/"+e.customer_gateway.tunnel_inside_address.network_cidr||"",n.next_hop=e.vpn_gateway.tunnel_inside_address.ip_address||"",n.isStaticRouting=!0,e.customer_gateway.bgp&&e.customer_gateway.bgp.asn&&(n.isStaticRouting=!1,n.customer_gateway_bgp_asn=e.customer_gateway.bgp.asn||"",n.vpn_gateway_bgp_asn=e.vpn_gateway.bgp.asn||"",n.neighbor_ip_address=e.vpn_gateway.tunnel_inside_address.ip_address||"",n.customer_gateway_bgp_hold_time=e.customer_gateway.bgp.hold_time||""),n}),r=n.vpnConnectionId||"download_configuration",n=MC.template.configurationDownload(n),'{"download":true, "filecontent":"'+window.btoa(n)+'", "filename":"'+r+'", "btnname":"'+e.name+'"}'}),"[ "+r.join(",")+" ]"):n):n},r=e.extend({init:function(e){var r,i,s;return s=t.instance().component(e),i=s.getTarget(n.RESTYPE.VGW),r=s.getTarget(n.RESTYPE.CGW),(this.isApp||this.isAppEdit)&&this.getAppData(s.get("appId")),this.set({uid:e,name:"vpn:"+r.get("name"),ips:s.get("routes"),dynamic:r.isDynamic()}),null},updateIps:function(e){return t.instance().component(this.get("uid")).set("routes",e),null},getAppData:function(e){var n,r,s,o;return n=MC.data.resource_list[t.instance().region()],r=$.extend(!0,{},n[e]),r&&(o=i([{type:"download_configuration",name:"Download Configuration"}],r),s=JSON.parse(o),s&&s.length>0&&this.set("vpncfg",s[0])),r.vgwTelemetry&&r.vgwTelemetry.item&&(r.vgwTelemetry=_.map(r.vgwTelemetry.item,function(e,t){return e=$.extend(!0,{},e),e.index=t+1,e})),r.isApp=this.isApp,this.set(r)},isCidrConflict:function(e,r){return t.modelClassForType(n.RESTYPE.SUBNET).isCidrConflict(e,r)}}),new r})}.call(this),define("module/design/property/vpn/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <div class="option-group-head expand">VPN Summary</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(e,"PROP_CGW_APP_VPN_LBL_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+a((i=e&&e.vpnConnectionId,typeof i===u?i.apply(e):i))+"</dd>\n\n      <dt>"+a(n.i18n.call(e,"PROP_CGW_APP_VPN_LBL_STATE",{hash:{},data:t}))+'</dt>\n      <dd><i class="status status-xgw-'+a((i=e&&e.state,typeof i===u?i.apply(e):i))+'"></i>'+a((i=e&&e.state,typeof i===u?i.apply(e):i))+"</dd>\n\n      <dt>"+a(n.i18n.call(e,"PROP_CGW_APP_VPN_LBL_TYPE",{hash:{},data:t}))+"</dt>\n      <dd>"+a((i=e&&e.type,typeof i===u?i.apply(e):i))+"</dd>\n\n      <dt>"+a(n.i18n.call(e,"PROP_CGW_LBL_ROUTING",{hash:{},data:t}))+"</dt>\n      <dd>",i=n["if"].call(e,(i=e&&e.options,i==null||i===!1?i:i.staticRoutesOnly),{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+="</dd>\n\n      <a class='btn btn-primary vpn-download' href=\"data://text/plain;base64,",i=(i=(i=e&&e.vpncfg,i==null||i===!1?i:i.filecontent),typeof i===u?i.apply(e):i);if(i||i===0)r+=i;r+='" download="',i=(i=(i=e&&e.vpncfg,i==null||i===!1?i:i.filename),typeof i===u?i.apply(e):i);if(i||i===0)r+=i;r+='.txt" style="padding:8px;">'+a(n.i18n.call(e,"PROP_CGW_APP_TIT_DOWNLOAD_CONF",{hash:{},data:t}))+"</a>\n\n    </dl>\n  </div>\n\n  ",i=n["if"].call(e,e&&e.vgwTelemetry,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+="\n\n\n  ",i=n["if"].call(e,e&&e.isApp,{hash:{},inverse:f.noop,fn:f.program(14,y,t),data:t});if(i||i===0)r+=i;return r+="\n\n",r}function c(e,t){return"Static"}function h(e,t){return"Dynamic"}function p(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+a(n.i18n.call(e,"PROP_CGW_APP_VPN_LBL_TUNNEL",{hash:{},data:t}))+'</div>\n  <div class="option-group"> <table class="table">\n    <thead> <tr>\n      <th style="width:20px">'+a(n.i18n.call(e,"PROP_CGW_APP_VPN_COL_TUNNEL",{hash:{},data:t}))+'</th>\n      <th style="width:100px">'+a(n.i18n.call(e,"PROP_CGW_APP_VPN_COL_IP",{hash:{},data:t}))+"</th>\n    </tr> </thead>\n    <tbody>\n    ",i=n.each.call(e,e&&e.vgwTelemetry,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n    </tbody>\n  </table> </div>\n  ",r}function d(e,t){var r="",i;r+='\n      <tr>\n        <td><i class="status status-'+a((i=e&&e.status,typeof i===u?i.apply(e):i))+' icon-label tooltip" data-tooltip="',i=n.ifCond.call(e,e&&e.status,"DOWN",{hash:{},inverse:f.program(10,m,t),fn:f.program(8,v,t),data:t});if(i||i===0)r+=i;r+=" since "+a((i=e&&e.lastStatusChange,typeof i===u?i.apply(e):i)),i=n["if"].call(e,e&&e.statusMessage,{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;return r+='"></i>'+a((i=e&&e.index,typeof i===u?i.apply(e):i))+"</td>\n        <td>"+a((i=e&&e.outsideIpAddress,typeof i===u?i.apply(e):i))+"</td>\n      </tr>\n    ",r}function v(e,t){return"DOWN"}function m(e,t){return"UP"}function g(e,t){var n="",r;return n+="because "+a((r=e&&e.statusMessage,typeof r===u?r.apply(e):r)),n}function y(e,t){var r="",i;r+=" ",i=n["if"].call(e,(i=e&&e.routes,i==null||i===!1?i:i.item),{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+=" ",r}function b(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+a(n.i18n.call(e,"PROP_CGW_APP_VPN_LBL_STATUS_RT",{hash:{},data:t}))+'</div>\n  <div class="option-group"> <table class="table">\n    <thead> <tr>\n      <th style="width:100px">'+a(n.i18n.call(e,"PROP_CGW_APP_VPN_COL_IP_PREFIX",{hash:{},data:t}))+'</th>\n      <th style="width:100px">'+a(n.i18n.call(e,"PROP_CGW_APP_VPN_COL_SOURCE",{hash:{},data:t}))+"</th>\n    </tr> </thead>\n    <tbody>\n      ",i=n.each.call(e,(i=e&&e.routes,i==null||i===!1?i:i.item),{hash:{},inverse:f.noop,fn:f.program(16,w,t),data:t});if(i||i===0)r+=i;return r+="\n    </tbody>\n  </table> </div>\n  ",r}function w(e,t){var n="",r;return n+='\n      <tr>\n        <td><i class="status status-'+a((r=e&&e.state,typeof r===u?r.apply(e):r))+' icon-label tooltip" data-tooltip="'+a((r=e&&e.state,typeof r===u?r.apply(e):r))+'"></i>'+a((r=e&&e.destinationCidrBlock,typeof r===u?r.apply(e):r))+"</td>\n        <td>"+a((r=e&&e.source,typeof r===u?r.apply(e):r))+"</td>\n      </tr>\n      ",n}function E(e,t){var r="",i;r+="\n  ",i=n["if"].call(e,e&&e.dynamic,{hash:{},inverse:f.noop,fn:f.program(19,S,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function S(e,t){return'\n    <section class="property-control-group"> Since the Customer Gateway this VPN is connected to has dynamic routing enabled no configuration is necessary. </section>\n  '}function x(e,t){var r="",i;r+=" ",i=n.unless.call(e,e&&e.dynamic,{hash:{},inverse:f.noop,fn:f.program(22,T,t),data:t});if(i||i===0)r+=i;return r+=" ",r}function T(e,t){var r="",i;r+="\n  ",i=n["if"].call(e,e&&e.vpnConnectionId,{hash:{},inverse:f.noop,fn:f.program(23,N,t),data:t});if(i||i===0)r+=i;r+='\n  <section class="property-control-group">\n    <div class="clearfix">\n      <label class="left" for="property-vpc-ips">'+a(n.i18n.call(e,"PROP_VPN_LBL_IP_PREFIX",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+a(n.i18n.call(e,"PROP_LBL_REQUIRED",{hash:{},data:t}))+'</span>\n    </div>\n    <div id="property-vpn-ips" class="multi-input" data-max-row="100" data-bind="true">\n      ',i=n.each.call(e,e&&e.ips,{hash:{},inverse:f.program(27,k,t),fn:f.program(25,C,t),data:t});if(i||i===0)r+=i;r+="\n    </div>\n  </section>\n",i=n["if"].call(e,e&&e.vpnConnectionId,{hash:{},inverse:f.noop,fn:f.program(29,L,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function N(e,t){var r="";return r+='\n  <div class="option-group-head expand">'+a(n.i18n.call(e,"PROP_CGW_APP_VPN_LBL_STATUS_RT",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n  ',r}function C(e,t){var r="";return r+='\n      <div class="multi-ipt-row">\n        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n        <span class="ipt-wrapper"><input data-ignore="true" data-ignore-regexp="^[0-9./]*$" class="input tooltip" data-tooltip="'+a(n.i18n.call(e,"PROP_VPN_TIP_EG_192_168_0_0_16",{hash:{},data:t}))+'" placeholder="'+a(n.i18n.call(e,"PROP_VPN_TIP_EG_192_168_0_0_16",{hash:{},data:t}))+'" value="'+a(typeof e===u?e.apply(e):e)+'" type="text"></span>\n      </div>\n      ',r}function k(e,t){var r="";return r+='\n      <div class="multi-ipt-row">\n        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n        <span class="ipt-wrapper"><input data-ignore="true" data-empty-remove="true" data-ignore-regexp="^[0-9./]*$" class="input tooltip" data-tooltip="'+a(n.i18n.call(e,"PROP_VPN_TIP_EG_192_168_0_0_16",{hash:{},data:t}))+'" placeholder="'+a(n.i18n.call(e,"PROP_VPN_TIP_EG_192_168_0_0_16",{hash:{},data:t}))+'" type="text"></span>\n      </div>\n      ',r}function L(e,t){return" </div> "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+="<article>\n",o=n["if"].call(t,t&&t.vpnConnectionId,{hash:{},inverse:f.program(18,E,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n.unless.call(t,t&&t.isApp,{hash:{},inverse:f.noop,fn:f.program(21,x,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/vpn/view",["../base/view","./template/stack"],function(e,t){var n;return n=e.extend({events:{"BEFORE_REMOVE_ROW #property-vpn-ips":"beforeRemoveIP","REMOVE_ROW #property-vpn-ips":"removeIP","ADD_ROW #property-vpn-ips":"addIP","focus #property-vpn-ips input":"onFocusCIDR","keypress #property-vpn-ips input":"onPressCIDR","blur #property-vpn-ips input":"onBlurCIDR"},render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name},addIP:function(){return $("#property-vpn-ips input").last().focus(),null},beforeRemoveIP:function(e){var t;return e.value&&(t=$("#property-vpn-ips").find("input").filter(function(){return this.value.length>0}),t.length<2&&e.preventDefault()),null},removeIP:function(e,t){var n;if(!t)return;return n=[],$("#property-vpn-ips input").each(function(){return n.push($(this).val())}),this.model.updateIps(n),null},onPressCIDR:function(e){return e.keyCode===13&&$(e.currentTarget).blur(),null},onFocusCIDR:function(e){return this.disabledAllOperabilityArea(!0),null},onBlurCIDR:function(e){var t,n,r,i,s,o,u,a,f,l,c;s=$(e.currentTarget),o=s.val(),u=[],$("#property-vpn-ips input").each(function(){return this.value&&u.push(this.value),null}),t=_.uniq(u);if(!o)s.parents(".multi-ipt-row").siblings().length===0&&(a="CIDR block is required.",r="Please provide a IP ranges for this IP Prefix.");else if(!MC.validate("cidr",o))a=""+o+" is not a valid form of CIDR block.",r="Please provide a valid IP range. For example, 10.0.0.1/24.";else for(l=0,c=t.length;l<c;l++){n=t[l];if(n!==o&&this.model.isCidrConflict(o,n)){a=""+o+" conflicts with other IP Prefix.",r="Please choose a CIDR block not conflicting with existing IP Prefix.";break}}if(!a){this.model.updateIps(t),this.disabledAllOperabilityArea(!1);return}return i=MC.template.setupCIDRConfirm({remove_content:"Remove Connection",main_content:a,desc_content:r}),f=this,modal(i,!1,function(){return $(".modal-close").click(function(){return s.focus()}),$("#cidr-remove").click(function(){return $canvas.clearSelected(),Design.instance().component(f.model.get("uid")).remove(),f.disabledAllOperabilityArea(!1),modal.close()})},{$source:$(e.target)})}}),new n})}.call(this),function(){define("module/design/property/vpn/main",["../base/main","./model","./view","constant","event"],function(e,t,n,r,i){var s;return s=e.extend({handleTypes:r.RESTYPE.VPN,initStack:function(){return this.view=n,this.model=t,this.model.isApp=!1,this.model.isAppEdit=!1,null},initApp:function(){return this.view=n,this.model=t,this.model.isApp=!0,this.model.isAppEdit=!1,null},initAppEdit:function(){return this.view=n,this.model=t,this.model.isApp=!1,this.model.isAppEdit=!0,null}}),null})}.call(this),function(){define("module/design/property/eni/model",["../base/model","constant","Design","event","i18n!nls/lang.js"],function(e,t,n,r,i){var s;return s=e.extend({defaults:{uid:null,isAppEdit:!1},init:function(e){var t,r;return t=n.instance().component(e),r={uid:e,name:t.get("name"),desc:t.get("description"),sourceDestCheck:t.get("sourceDestCheck"),isAppEdit:this.isAppEdit,isGroupMode:this.isGroupMode,attached:t.connections("EniAttachment").length>0},this.set(r),this.getIpList(),this.isAppEdit&&this.getEniGroup(e),null},getIpList:function(){var e;return e=n.instance().component(this.get("uid")).getIpArray(),e[0].unDeletable=!0,this.isAppEdit&&(e[0].editable=!1),this.set("ips",e),null},setEniDesc:function(e){return n.instance().component(this.get("uid")).set("description",e),null},setSourceDestCheck:function(e){return n.instance().component(this.get("uid")).set("sourceDestCheck",e),null},attachEip:function(e,r){return n.instance().component(this.get("uid")).setIp(e,null,null,r),this.attributes.ips[e].hasEip=r,r&&n.modelClassForType(t.RESTYPE.IGW).tryCreateIgw(),null},removeIp:function(e){return n.instance().component(this.get("uid")).removeIp(e),null},getEniGroup:function(e){var t,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;s=n.instance().component(e),p=MC.data.resource_list[n.instance().region()],t=p[s.get("appId")],h=s.get("name"),u=[{appId:s.get("appId"),name:h+"-0",desc:s.get("description"),status:t?t.status:"Unknown",sourceDestCheck:s.get("sourceDestCheck")?"enabled":"disabled"}],r=s.serverGroupCount(),s.groupMembers().length>r-1?c=s.groupMembers().slice(0,r-1):c=s.groupMembers();for(f=d=0,m=c.length;d<m;f=++d)l=c[f],u.push({name:h+"-"+(f+1),appId:l.appId,status:p[l.appId]?p[l.appId].status:"Unknown",isNew:!l.appId,isOld:l.appId&&f+1>=r});while(u.length<r)u.push({name:h+"-"+u.length,isNew:!0,status:"Unknown"});o=0,y=s.groupMembers();for(a=v=0,g=y.length;v<g;a=++v){i=y[a];if(!i.appId)break;o=a+1}return o+=1,u.length>1?(this.set("group",u),o>r?u.increment="-"+(o-r):o<r&&(u.increment="+"+(r-o))):this.set("group",u[0]),this.set("readOnly",!1),null},addIp:function(){var e,t;return e=n.instance().component(this.get("uid")),e.addIp(),t=e.getIpArray(),t[0].unDeletable=!0,this.set("ips",t),null},isValidIp:function(e){return n.instance().component(this.get("uid")).isValidIp(e)},canAddIP:function(){return n.instance().component(this.get("uid")).canAddIp()},setIp:function(e,t,r){return n.instance().component(this.get("uid")).setIp(e,t,r),null}}),new s})}.call(this),define("module/design/property/eni/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n<article class="property-control-group">'+u(n.i18n.call(e,"PROP_ENI_LBL_ATTACH_WARN",{hash:{},data:t}))+"</article>\n",r}function c(e,t){var r="",i;r+='\n\n<article>\n  <div id="prop-appedit-eni-list" class="expand"></div>\n\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP_ENI_LBL_DETAIL",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n',i=n.unless.call(e,e&&e.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+='\n\n    <section class="property-control-group">\n      <div class="network-list-wrap">\n        <div class="network-list-header">\n          '+u(n.i18n.call(e,"PROP_ENI_IP_ADDRESS",{hash:{},data:t}))+'\n          <button id="property-eni-ip-add" class="right btn btn-blue btn-small tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ENI_TIP_ADD_IP_ADDRESS",{hash:{},data:t}))+'">'+u(n.i18n.call(e,"PROP_ENI_ADD_IP",{hash:{},data:t}))+'</button>\n        </div>\n        <ul class="network-list" id="property-eni-list" data-bind="true">\n        </ul>\n      </div>\n    </section>\n  </div>\n\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP_ENI_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n</article>\n\n',r}function h(e,t){var r="",i;r+='\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-eni-desc">'+u(n.i18n.call(e,"PROP_ENI_LBL_DESC",{hash:{},data:t}))+'</label>\n      <textarea id="property-eni-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.desc,typeof i===a?i.apply(e):i))+'</textarea>\n    </section>\n\n    <section class="property-control-group">\n      <div class="checkbox">\n        <input id="property-eni-source-check" type="checkbox" ',i=n["if"].call(e,e&&e.sourceDestCheck,{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;return r+=' />\n        <label for="property-eni-source-check"></label>\n      </div>\n      <label for="property-eni-source-check">'+u(n.i18n.call(e,"PROP_ENI_SOURCE_DEST_CHECK",{hash:{},data:t}))+"</label>\n    </section>\n",r}function p(e,t){return'checked="checked"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;o=n.unless.call(t,t&&t.attached,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n",s};return e.template(t)}),define("module/design/property/eni/template/eni_list",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n",i=n.unless.call(e,(i=e&&e.group,i==null||i===!1?i:i.length),{hash:{},inverse:f.program(7,d,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){var r="",i;r+='\n<div class="option-group-head ',i=n["if"].call(e,e&&e.readOnly,{hash:{},inverse:f.noop,fn:f.program(3,h,t),data:t});if(i||i===0)r+=i;r+='">Network Interface Summary</div>\n<div class="option-group">\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(e,"PROP_ENI_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=(i=e&&e.group,i==null||i===!1?i:i.name),typeof i===a?i.apply(e):i))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP_ENI_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=(i=e&&e.group,i==null||i===!1?i:i.appId),typeof i===a?i.apply(e):i))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP_ENI_STATE",{hash:{},data:t}))+'</dt>\n    <dd><i class="status status-'+u((i=(i=e&&e.group,i==null||i===!1?i:i.status),typeof i===a?i.apply(e):i))+'"></i>'+u((i=(i=e&&e.group,i==null||i===!1?i:i.status),typeof i===a?i.apply(e):i))+"</dd>\n    ",i=n["if"].call(e,(i=e&&e.group,i==null||i===!1?i:i.description),{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;return r+="\n    <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_ENI_SOURCE_DEST_CHECK_DISP",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=(i=e&&e.group,i==null||i===!1?i:i.sourceDestCheck),typeof i===a?i.apply(e):i))+"</dd>\n  </dl>\n<div>\n\n",r}function h(e,t){return"expand"}function p(e,t){var r="",i;return r+="\n    <dt>"+u(n.i18n.call(e,"PROP_ENI_LBL_DESC",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=(i=e&&e.group,i==null||i===!1?i:i.desc),typeof i===a?i.apply(e):i))+"</dd>\n    ",r}function d(e,t){var r="",i;r+='\n<div class="option-group-head ',i=n["if"].call(e,e&&e.readOnly,{hash:{},inverse:f.noop,fn:f.program(3,h,t),data:t});if(i||i===0)r+=i;r+='">Network Interface Group Members<span class="property-head-num-wrap">('+u((i=(i=e&&e.group,i==null||i===!1?i:i.length),typeof i===a?i.apply(e):i))+')</span> <span class="appedit-head-meta appedit-head-meta-add">'+u((i=(i=e&&e.group,i==null||i===!1?i:i.increment),typeof i===a?i.apply(e):i))+'</span></div>\n<ul class="option-group property-list">\n  ',i=n.each.call(e,e&&e.group,{hash:{},inverse:f.noop,fn:f.program(8,v,t),data:t});if(i||i===0)r+=i;return r+="\n</ul>\n",r}function v(e,t){var r="",i;r+='\n    <li>\n      <i class="status status-'+u((i=e&&e.status,typeof i===a?i.apply(e):i))+' icon-label tooltip" data-tooltip="'+u((i=e&&e.status,typeof i===a?i.apply(e):i))+'"></i>'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+"\n      ",i=n["if"].call(e,e&&e.appId,{hash:{},inverse:f.noop,fn:f.program(9,m,t),data:t});if(i||i===0)r+=i;r+="\n      ",i=n["if"].call(e,e&&e.isNew,{hash:{},inverse:f.program(13,y,t),fn:f.program(11,g,t),data:t});if(i||i===0)r+=i;return r+="\n    </li>\n  ",r}function m(e,t){var n="",r;return n+='<span class="subtitle">('+u((r=e&&e.appId,typeof r===a?r.apply(e):r))+")</span>",n}function g(e,t){return'<div class="subtitle subtitle-launch">Create after applying updates</div>\n      '}function y(e,t){var r="",i;i=n["if"].call(e,e&&e.isOld,{hash:{},inverse:f.noop,fn:f.program(14,b,t),data:t});if(i||i===0)r+=i;return r+="\n      ",r}function b(e,t){return'<div class="subtitle subtitle-terminate">Delete after applying updates</div>'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;o=n["if"].call(t,t&&t.group,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n",s};return e.template(t)}),function(){define("module/design/property/eni/view",["../base/view","./template/stack","./template/eni_list","i18n!nls/lang.js"],function(e,t,n,r){var i,s;return s=function(){return null},i=e.extend({events:{"change #property-eni-desc":"setEniDesc","change #property-eni-source-check":"setEniSourceDestCheck","click .toggle-eip":"setEip","click #property-eni-ip-add":"addIp","click #property-eni-list .icon-remove":"removeIp","blur .input-ip":"syncIPList"},render:function(){return this.$el.html(t(this.model.attributes)),this.refreshIpList(),$("#prop-appedit-eni-list").html(n(this.model.attributes)),this.model.attributes.name},setEniDesc:function(e){return this.model.setEniDesc(e.target.value),null},setEniSourceDestCheck:function(e){return this.model.setSourceDestCheck(e.target.checked),null},addIp:function(){if($("#property-eni-ip-add").hasClass("disabled"))return;return this.model.addIp(),this.refreshIpList(),null},setEip:function(e){var t,n,i,s;return t=$(e.currentTarget),i=t.closest("li").index(),n=!t.hasClass("associated"),n?s=r.ide.PROP_INSTANCE_IP_MSG_4:s=r.ide.PROP_INSTANCE_IP_MSG_3,t.toggleClass("associated",n).data("tooltip",s),this.model.attachEip(i,n),null},removeIp:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.index(),t.remove(),this.model.removeIp(n),this.updateIPAddBtnState(!0),null},syncIPList:function(e){var t,n,r,i,s;i=$("#property-eni-list .input-ip-item"),t=$(e.currentTarget);if(!this.validateIpItem(t))return;return s=t.val(),r=t.siblings(".input-ip-prefix").text()+s,n=s==="x"||s==="x.x",this.model.setIp(t.closest(".input-ip-item").index(),r,n),null},refreshIpList:function(e){return $("#property-eni-list").html(MC.template.propertyIpList(this.model.attributes.ips)),this.updateIPAddBtnState(),null},validateIpItem:function(e){var t,n;return n=this,e.parsley("custom",function(t){var i,s,o,u,a,f,l;return l=e,s=l.val(),o=l.siblings(".input-ip-prefix").text(),i=o+s,a=o.split("."),u=!1,a.length===4?s==="x"?u=!0:MC.validate("ipaddress",o+s)&&(u=!0):s==="x.x"?u=!0:MC.validate("ipaddress",o+s)&&(u=!0),u?(f=n.model.isValidIp(i),f!==!0?f:null):r.ide.PARSLEY_INVALID_IP_ADDRESS}),t=e.parsley("validate"),e.parsley("custom",s),t},updateIPAddBtnState:function(e){var t;return e===void 0&&(e=this.model.canAddIP()),e===!0?t="Add IP Address":(_.isString(e)?t=e:t="Cannot add IP address",e=!1),$("#property-eni-ip-add").toggleClass("disabled",!e).data("tooltip",t),null}}),new i})}.call(this),function(){define("module/design/property/eni/app_model",["../base/model","Design","constant"],function(e,t,n){var r;return r=e.extend({init:function(e){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;a=[],d=t.instance().component(e);if(!d){n=t.modelClassForType("AWS.VPC.NetworkInterface").allObjects();for(m=0,y=n.length;m<y;m++){i=n[m];if(i.get("appId")===e){d=i,v=i.toJSON();break}w=i.groupMembers();for(h in w){c=w[h];if(c.appId===e){p=+h+1,d=i,v=c;break}}}}else v=d.toJSON();r=MC.data.resource_list[t.instance().region()],this.isGroupMode?a=[v].concat(d.groupMembers()):a.push(v),u=[];for(l in a){o=a[l],r[o.appId]?s=$.extend(!0,{},r[o.appId]):s={privateIpAddressesSet:{item:[]}},E=s.privateIpAddressesSet.item;for(g=0,b=E.length;g<b;g++)f=E[g],f.primary=f.primary===!0;s.id=o.appId,s.name=o.name?""+o.name+"-0":""+d.get("name")+"-"+(p||l),s.idx=p||l,s.sourceDestCheck=s.sourceDestCheck?"enabled":"disabled",u.push(s)}return this.isGroupMode?(this.set("group",_.sortBy(u,"idx")),this.set("readOnly",!0),this.set("isGroupMode",!0),this.set("name",d.get("name"))):(s=u[0],s.readOnly=!0,s.isGroupMode=!1,s.id=e,s.uid=d?d.id:e,this.set(s)),null}}),new r})}.call(this),define("module/design/property/eni/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <div class="option-group-head expand">Network Interface Details</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP_ENI_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.name,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_ENI_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.networkInterfaceId,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_ENI_STATE",{hash:{},data:t}))+'</dt>\n      <dd><i class="status status-'+u((i=e&&e.status,typeof i===a?i.apply(e):i))+'"></i>'+u((i=e&&e.status,typeof i===a?i.apply(e):i))+"</dd>\n      ",i=n["if"].call(e,e&&e.description,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+="\n      <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_ENI_SOURCE_DEST_CHECK_DISP",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.sourceDestCheck,typeof i===a?i.apply(e):i))+'</dd>\n    </dl>\n    <div class="hidden-details">\n      <a href="#" class="toggle-details js-toggle-dropdown" data-toggle="self-only"><span class="details-off">+ '+u(n.i18n.call(e,"PROP_ENI_SHOW_DETAIL",{hash:{},data:t}))+'</span><span class="details-on">- '+u(n.i18n.call(e,"PROP_ENI_HIDE_DETAIL",{hash:{},data:t}))+'</span></a>\n      <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(e,"PROP_ENI_VPC_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+"</dd>\n        <dt>"+u(n.i18n.call(e,"PROP_ENI_SUBNET_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.subnetId,typeof i===a?i.apply(e):i))+"</dd>\n        ",i=n["if"].call(e,e&&e.attachment,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+="\n        <dt>"+u(n.i18n.call(e,"PROP_ENI_MAC_ADDRESS",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.macAddress,typeof i===a?i.apply(e):i))+"</dd>\n        ",i=n["if"].call(e,(i=e&&e.association,i==null||i===!1?i:i.publicDnsName),{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,e&&e.privateDnsName,{hash:{},inverse:f.noop,fn:f.program(8,d,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,e&&e.ownerId,{hash:{},inverse:f.noop,fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;r+='\n      </dl>\n    </div>\n\n    <table class="table">\n      <tr>\n        <th>'+u(n.i18n.call(e,"PROP_INSTANCE_ENI_IP_ADDRESS",{hash:{},data:t}))+"</th>\n        <th>"+u(n.i18n.call(e,"PROP_INSTANCE_PUBLIC_IP",{hash:{},data:t}))+"</th>\n      </tr>\n      ",i=n.each.call(e,(i=e&&e.privateIpAddressesSet,i==null||i===!1?i:i.item),{hash:{},inverse:f.noop,fn:f.program(12,m,t),data:t});if(i||i===0)r+=i;return r+='\n    </table>\n  </div>\n\n\n  <div class="option-group-head">'+u(n.i18n.call(e,"PROP_ENI_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n\n  ',r}function c(e,t){var r="",i;return r+="\n      <dt>"+u(n.i18n.call(e,"PROP_ENI_LBL_DESC",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.description,typeof i===a?i.apply(e):i))+"</dd>\n      ",r}function h(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP_ENI_ATTACHMENT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=e&&e.attachment,i==null||i===!1?i:i.attachmentId),typeof i===a?i.apply(e):i))+"</dd>\n        <dt>"+u(n.i18n.call(e,"PROP_ENI_Attachment_OWNER",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=e&&e.attachment,i==null||i===!1?i:i.instanceOwnerId),typeof i===a?i.apply(e):i))+"</dd>\n        <dt>"+u(n.i18n.call(e,"PROP_ENI_Attachment_STATE",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=e&&e.attachment,i==null||i===!1?i:i.status),typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function p(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_PUBLIC_DNS",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=e&&e.association,i==null||i===!1?i:i.publicDnsName),typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function d(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP_INSTANCE_PRIVATE_DNS",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.privateDnsName,typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function v(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP_ENI_IP_OWNER",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.ownerId,typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function m(e,t){var r="",i;r+="\n      <tr>\n        <td>"+u((i=e&&e.privateIpAddress,typeof i===a?i.apply(e):i)),i=n["if"].call(e,e&&e.primary,{hash:{},inverse:f.noop,fn:f.program(13,g,t),data:t});if(i||i===0)r+=i;r+="</td>\n        <td>",i=n["if"].call(e,(i=e&&e.association,i==null||i===!1?i:i.publicIp),{hash:{},inverse:f.program(17,b,t),fn:f.program(15,y,t),data:t});if(i||i===0)r+=i;return r+="</td>\n      </tr>\n      ",r}function g(e,t){return"<span>(Primary)</span>"}function y(e,t){var n;return u((n=(n=e&&e.association,n==null||n===!1?n:n.publicIp),typeof n===a?n.apply(e):n))}function b(e,t){return"-"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n  <div id="prop-appedit-eni-list" class="expand"></div>\n\n  ',o=n.unless.call(t,t&&t.isGroupMode,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/eni/app_view",["../base/view","./template/app","./template/eni_list"],function(e,t,n){var r;return r=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.isGroupMode&&$("#prop-appedit-eni-list").html(n(this.model.attributes)),this.model.attributes.name}}),new r})}.call(this),function(){define("module/design/property/eni/main",["../base/main","./model","./view","./app_model","./app_view","../sglist/main","event","constant"],function(e,t,n,r,i,s,o,u){var a,f;return f={},f[o.PROPERTY_REFRESH_ENI_IP_LIST]=function(){return this.model.getIpList(),this.view.refreshIpList(),null},a=e.extend({ideEvents:f,handleTypes:[u.RESTYPE.ENI,"component_eni_group"],onUnloadSubPanel:function(e){return s.onUnloadSubPanel(e),null},initStack:function(){return this.model=t,this.model.isAppEdit=!1,this.model.isGroupMode=!1,this.view=n,null},afterLoadStack:function(){if(!this.model.attributes.association)return s.loadModule(this.model)},initApp:function(){return this.model=r,this.model.isGroupMode=this.handle==="component_eni_group",this.view=i,null},afterLoadApp:function(){return this.model.isGroupMode||s.loadModule(this.model),null},initAppEdit:function(){return this.model=t,this.model.isAppEdit=!0,this.view=n,null},afterLoadAppEdit:function(){return s.loadModule(this.model),null}}),null})}.call(this),function(){define("module/design/property/acl/model",["../base/model","Design","constant","i18n!nls/lang.js"],function(e,t,n,r){var i,s,o;return o={0:"Echo Reply(0)",3:"Destination Unreachable(3)",4:"Source Quench(4)",5:"Redirect Message(5)",6:"Alternate Host Address(6)",8:"Echo Request(8)",9:"Router Advertisement(9)",10:"Router Solicitation(10)",11:"Time Exceeded(11)",12:"Parameter Problem: Bad IP header(12)",13:"Timestamp(13)",14:"Timestamp Reply(14)",15:"Information Request(15)",16:"Information Reply(16)",17:"Address Mask Request(17)",18:"Address Mask Reply(18)",30:"Traceroute(30)",31:"Datagram Conversion Error(31)",32:"Mobile Host Redirect(32)",33:"Where Are You(33)",34:"Here I Am(34)",35:"Mobile Registration Request(35)",36:"Mobile Registration Reply(36)",37:"Domain Name Request(37)",38:"Domain Name Reply(38)",39:"SKIP Algorithm Discovery Protocol(39)",40:"Photuris Security Failures(40)","-1":"All(-1)"},s={3:{"-1":"All(-1)",0:"destination network unreachable(0)",1:"destination host unreachable(1)",2:"destination protocol unreachable(2)",3:"destination port unreachable(3)",4:"fragmentation required and DF flag set(4)",5:"source route failed(5)",6:"destination network unknown(6)",7:"destination host unknown(7)",8:"source host isolated(8)",9:"network administratively prohibited(9)",10:"host administratively prohibited(10)",11:"network unreachable for TOS(11)",12:"host unreachable for TOS(12)",13:"communication administratively prohibited(13)"},5:{"-1":"All(-1)",0:"redirect datagram for the network(0)",1:"redirect datagram for the host(1)",2:"redirect datagram for the TOS & network(2)",3:"redirect datagram for the TOS & host(3)"},11:{"-1":"All(-1)",0:"TTL expired transit(0)",1:"fragmentation reasembly time exceeded(1)"},12:{"-1":"All(-1)",0:"pointer indicates the error(0)",1:"missing a required option(1)",2:"bad length(2)"}},i=e.extend({init:function(e){var r,i;return r=t.instance().component(e),i=_.map(r.connectionTargets("AclAsso"),function(e){return{name:e.get("name"),cidr:e.get("cidr")}}),this.set({uid:e,isDefault:r.isDefault(),appId:r.get("appId"),name:r.get("name"),vpcId:t.modelClassForType(n.RESTYPE.VPC).theVPC().get("appId"),rules:null,isApp:this.isApp,associations:_.sortBy(i,name)}),this.getRules(),this.sortRules(),null},getRules:function(){var e,n,r;return r=$.extend(!0,[],t.instance().component(this.get("uid")).get("rules")),n=this.get("isDefault"),e=this.isApp,_.each(r,function(t){var r,i,u,a;t.port||(t.port="All");if(t.number===32767)t.number="*",t.readOnly=!0;else if(t.number===100&&n||e)t.readOnly=!0;switch(t.protocol){case-1:t.protocol="ALL";break;case 1:t.protocol="ICMP";break;case 6:t.protocol="TCP";break;case 17:t.protocol="UDP"}t.tooltip="Port";try{t.protocol==="ICMP"?(u=t.port.split("/"),a="",u[0]&&(a=o[u[0]]),r="",u[1]&&(s[u[0]]?r=s[u[0]][u[1]]:r="All(-1)"),a&&!r?t.tooltip="Type: "+a:a&&r&&(t.tooltip="Type: "+a+", "+"Code: "+r)):t.tooltip="Port: "+t.port}catch(f){i=f,void 0}return null}),this.set("rules",r)},sortRules:function(){var e,t;return t=this.get("sortKey")||"number",t==="number"?e=function(e,t){var n,r;n=parseInt(e.number,10)||-1,r=parseInt(t.number,10)||-1;if(n>r)return 1;if(n===r)return 0;if(n<r)return-1}:e=function(e,n){if(e[t]>n[t])return 1;if(e[t]===n[t])return 0;if(e[t]<n[t])return-1},this.attributes.rules=this.attributes.rules.sort(e),null},setSortOption:function(e){return this.set("sortKey",e),this.sortRules(),null},removeAclRule:function(e){return t.instance().component(this.get("uid")).removeRule(e)},addAclRule:function(e){return t.instance().component(this.get("uid")).addRule(e),this.getRules(),this.sortRules(),this.trigger("REFRESH_RULE_LIST"),null},checkRuleNumber:function(e){var n;return e=parseInt(e,10),0<e&&e<32768?this.get("isDefault")&&e===100?r.ide.PARSLEY_RULE_NUMBER_100_HAS_EXISTED:(n=_.find(t.instance().component(this.get("uid")).get("rules"),function(t){return t.number===e}),n?sprintf(r.ide.PARSLEY_RULENUMBER_ALREADY_EXISTS,e):!0):r.ide.PARSLEY_VALID_RULE_NUMBER_1_TO_32767}}),new i})}.call(this),define("module/design/property/acl/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n  <section class="property-control-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP_ACL_APP_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.appId,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP_ACL_APP_IS_DEFAULT",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.isDefault,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP_ACL_APP_VPC_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+"</dd>\n    </dl>\n  </section>\n  ",r}function c(e,t){var r="",i;r+='\n  <section class="property-control-group" data-bind="true">\n    <label class="left" for="property-acl-name">'+u(n.i18n.call(e,"PROP_ACL_LBL_NAME",{hash:{},data:t}))+'</label>\n    <span class="required-input right">'+u(n.i18n.call(e,"PROP_LBL_REQUIRED",{hash:{},data:t}))+'</span>\n    <input class="input" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.isDefault,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+=' id="property-acl-name" maxlength="255" data-ignore="true" data-required-rollback="true"/>\n  </section>\n  ',r}function h(e,t){return'disabled="disabled"'}function p(e,t){var r="";return r+='\n    <a href="#" class="icon-add add-rule tooltip action-link" id="acl-add-rule-icon" data-tooltip=\''+u(n.i18n.call(e,"PROP_ACL_BTN_CREATE_NEW_RULE",{hash:{},data:t}))+"'></a>\n    ",r}function d(e,t){var n="",r;return n+="<li>"+u((r=e&&e.name,typeof r===a?r.apply(e):r))+" ("+u((r=e&&e.cidr,typeof r===a?r.apply(e):r))+")</li>",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+="<article>\n  ",o=n["if"].call(t,t&&t.appId,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n\n  <div class="option-group-head acl-header expand">'+u(n.i18n.call(t,"PROP_ACL_TIT_RULE",{hash:{},data:i}))+'\n    <span class="property-head-num-wrap">(<span id="acl-rule-count">'+u((o=(o=t&&t.rules,o==null||o===!1?o:o.length),typeof o===a?o.apply(t):o))+"</span>)</span>\n    ",o=n.unless.call(t,t&&t.isApp,{hash:{},inverse:f.noop,fn:f.program(6,p,i),data:i});if(o||o===0)s+=o;s+='\n  </div>\n  <div class="option-group">\n    <div class="rule-list-sort property-control-group">\n      <h5>'+u(n.i18n.call(t,"PROP_ACL_RULE_SORT_BY",{hash:{},data:i}))+'</h5>\n      <div class="selectbox" id="acl-sort-rule-select">\n        <div class="selection">'+u(n.i18n.call(t,"PROP_ACL_RULE_SORT_BY_NUMBER",{hash:{},data:i}))+'</div>\n        <ul class="dropdown" tabindex="-1">\n          <li data-id="number" class="item selected">'+u(n.i18n.call(t,"PROP_ACL_RULE_SORT_BY_NUMBER",{hash:{},data:i}))+'</li>\n          <li data-id="action" class="item">'+u(n.i18n.call(t,"PROP_ACL_RULE_SORT_BY_ACTION",{hash:{},data:i}))+'</li>\n          <li data-id="direction" class="item">'+u(n.i18n.call(t,"PROP_ACL_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</li>\n          <li data-id="source/destination" class="item">'+u(n.i18n.call(t,"PROP_ACL_RULE_SORT_BY_SRC_DEST",{hash:{},data:i}))+'</li>\n        </ul>\n      </div>\n    </div>\n    <ul class="property-list acl-rule-list" id="acl-rule-list">'+u((o=t&&t.acl_list,typeof o===a?o.apply(t):o))+'</ul>\n  </div>\n\n  <div class="option-group-head acl-header expand">'+u(n.i18n.call(t,"PROP_ACL_TIT_ASSOC",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="acl-assn-count">'+u((o=(o=t&&t.associations,o==null||o===!1?o:o.length),typeof o===a?o.apply(t):o))+'</span>)</span>\n  </div>\n\n  <ul class="option-group property-list">',o=n.each.call(t,t&&t.associations,{hash:{},inverse:f.noop,fn:f.program(8,d,i),data:i});if(o||o===0)s+=o;return s+="</ul>\n</article>\n\n",s};return e.template(t)}),define("module/design/property/acl/template/rule_item",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n<li data-uid="'+u((i=e&&e.id,typeof i===a?i.apply(e):i))+'">\n  <div class="acl-rule-number"><span class="tooltip" data-tooltip=\''+u(n.i18n.call(e,"PROP_ACL_TIP_RULE_NUMBER",{hash:{},data:t}))+"'>"+u((i=e&&e.number,typeof i===a?i.apply(e):i))+'</span></div>\n\n  <div class="acl-rule-details">\n    <div class="rule-list-row">\n      <div class="acl-rule-allow-cb tooltip icon-'+u((i=e&&e.action,typeof i===a?i.apply(e):i))+"\" data-tooltip='",i=n.ifCond.call(e,e&&e.action,"deny",{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+="'></div>\n      ",i=n["if"].call(e,e&&e.egress,{hash:{},inverse:f.program(8,d,t),fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+='\n      <span class="tooltip" data-tooltip=\''+u(n.i18n.call(e,"PROP_ACL_TIP_CIDR_BLOCK",{hash:{},data:t}))+"'>"+u((i=e&&e.cidr,typeof i===a?i.apply(e):i))+'</span>\n    </div>\n    <div class="rule-list-row">\n      <div><span class="rule-protocol tooltip" data-tooltip=\''+u(n.i18n.call(e,"PROP_ACL_TIP_PROTOCOL",{hash:{},data:t}))+"'>"+u((i=e&&e.protocol,typeof i===a?i.apply(e):i))+'</span></div>\n      <div class="tooltip" data-tooltip=\''+u((i=e&&e.tooltip,typeof i===a?i.apply(e):i))+"'>"+u((i=e&&e.port,typeof i===a?i.apply(e):i))+"</div>\n    </div>\n    ",i=n.unless.call(e,e&&e.readOnly,{hash:{},inverse:f.noop,fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;return r+="\n  </div>\n</li>\n",r}function c(e,t){var r;return r=n.i18n.call(e,"PROP_ACL_TIP_ACTION_DENY",{hash:{},data:t}),r||r===0?r:""}function h(e,t){var r;return r=n.i18n.call(e,"PROP_ACL_TIP_ACTION_ALLOW",{hash:{},data:t}),r||r===0?r:""}function p(e,t){var r="",i;r+='<span class="icon-outbound tooltip" data-tooltip=\'',i=n.i18n.call(e,"PROP_ACL_TIP_OUTBOUND",{hash:{},data:t});if(i||i===0)r+=i;return r+="'></span>\n      ",r}function d(e,t){var r="",i;r+='<span class="icon-inbound tooltip" data-tooltip=\'',i=n.i18n.call(e,"PROP_ACL_TIP_INBOUND",{hash:{},data:t});if(i||i===0)r+=i;return r+="'></span>\n      ",r}function v(e,t){var r="";return r+='<a class="icon-remove rule-remove-icon tooltip" data-tooltip=\''+u(n.i18n.call(e,"PROP_ACL_TIP_REMOVE_RULE",{hash:{},data:t}))+"'></a>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;o=n.each.call(t,t,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n",s};return e.template(t)}),define("module/design/property/acl/template/dialog",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n				<li class="item tooltip" data-id="'+a((r=e&&e.cidr,typeof r===u?r.apply(e):r))+'"><div class="main truncate">'+a((r=e&&e.name,typeof r===u?r.apply(e):r))+"</div></li>\n			",n}function c(e,t){var r="";return r+='\n			  <li class="item" data-id="custom">'+a(n.i18n.call(e,"POP_ACLRULE_PROTOCOL_CUSTOM",{hash:{},data:t}))+'</li>\n			  <li class="item" data-id="all">'+a(n.i18n.call(e,"POP_ACLRULE_PROTOCOL_ALL",{hash:{},data:t}))+"</li>\n			  ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div id="modal-acl-rule" data-bind="true">\n  <div class="modal-header"><h3>'+a(n.i18n.call(t,"POP_ACLRULE_TITLE_ADD",{hash:{},data:i}))+'</h3><i class="modal-close">&times;</i></div>\n  <div class="modal-body" style="width:450px;">\n	<div class="modal-control-group clearfix">\n	  <label class="label-short" for="modal-acl-number">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_RULE_NUMBER",{hash:{},data:i}))+'</label>\n	  <div class="prefix-input left">\n  		<label for="modal-acl-number">#</label>\n  		<input class="input" type="text" id="modal-acl-number" required data-ignore="true" data-ignore-regexp="^[0-9]*$" data-required="true" autofocus>\n	  </div>\n	</div>\n	<div class="modal-control-group clearfix">\n		<label class="label-short">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_ACTION",{hash:{},data:i}))+'</label>\n		<div class="radio-group-horizontal">\n			<div class="radio">\n				<input type="radio" id="acl-add-model-action-allow" checked="checked" name="acl-add-model-action-select"/>\n				<label for="acl-add-model-action-allow"></label>\n			</div>\n			<label class="radio-label" for="acl-add-model-action-allow">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_ACTION_ALLOW",{hash:{},data:i}))+'</label>\n		</div>\n		<div class="radio-group-horizontal">\n			<div class="radio">\n				<input type="radio" id="acl-add-model-action-deny" name="acl-add-model-action-select"/>\n				<label for="acl-add-model-action-deny"></label>\n			</div>\n			<label class="radio-label" for="acl-add-model-action-deny">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_ACTION_DENY",{hash:{},data:i}))+'</label>\n		</div>\n	</div>\n	<div class="modal-control-group clearfix">\n		<label class="label-short">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_DIRECTION",{hash:{},data:i}))+'</label>\n		<div class="radio-group-horizontal">\n			<div class="radio">\n				<input type="radio" id="acl-add-model-direction-inbound" checked="checked" name="acl-add-model-direction-select"/>\n				<label for="acl-add-model-direction-inbound"></label>\n			</div>\n			<label class="radio-label" for="acl-add-model-direction-inbound">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_INBOUND",{hash:{},data:i}))+'</label>\n		</div>\n		<div class="radio-group-horizontal">\n			<div class="radio">\n				<input type="radio" id="acl-add-model-direction-outbound" name="acl-add-model-direction-select"/>\n				<label for="acl-add-model-direction-outbound"></label>\n			</div>\n			<label class="radio-label" for="acl-add-model-direction-outbound">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_OUTBOUND",{hash:{},data:i}))+'</label>\n		</div>\n	</div>\n	<div class="modal-control-group acl-source-dest clearfix">\n	  <label class="label-short" id="acl-add-model-bound-label">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_SOURCE",{hash:{},data:i}))+'</label>\n		<div class="selectbox" id="acl-add-model-source-select">\n			<div class="selection">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_CUSTOM",{hash:{},data:i}))+'</div>\n			<ul class="dropdown">\n			<li class="item tooltip selected" data-id="custom">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_CUSTOM",{hash:{},data:i}))+"</li>\n			",o=n.each.call(t,t&&t.subnets,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n			</ul>\n	  </div>\n	  <input class="input" type="text" id="modal-acl-source-input" data-ignore="true" data-ignore-regexp="^[0-9./]*$" data-required="true" placeholder=\''+a(n.i18n.call(t,"POP_ACLRULE_PLACEHOLD_SOURCE",{hash:{},data:i}))+'\' >\n	</div>\n\n	<div class="modal-control-group clearfix">\n	  <label class="label-short" >'+a(n.i18n.call(t,"POP_ACLRULE_LBL_PROTOCOL",{hash:{},data:i}))+'</label>\n		  <div class="selectbox modal-protocol-select" id="modal-protocol-select"  data-protocal-type="tcp">\n			<div class="selection">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_TCP",{hash:{},data:i}))+'</div>\n			<ul class="dropdown scroll-wrap scrollbar-auto-hide context-wrap" tabindex="-1">\n			  <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n			  <li class="selected item" data-id="tcp">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_TCP",{hash:{},data:i}))+'</li>\n			  <li class="item" data-id="udp">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_UDP",{hash:{},data:i}))+'</li>\n			  <li class="item" data-id="icmp">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_ICMP",{hash:{},data:i}))+"</li>\n			  ",o=n.unless.call(t,t&&t.classic,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+='\n			</ul>\n		  </div>\n\n	  <div id="sg-protocol-select-result">\n		  <div class="sg-protocol-option-input show" id="sg-protocol-tcp">\n			<input class="input" type="text" placeholder=\''+a(n.i18n.call(t,"POP_ACLRULE_PLACEHOLD_PORT_RANGE",{hash:{},data:i}))+'\' required data-ignore="true" data-ignore-regexp="^[0-9-]*$" data-required="true"/>\n		  </div>\n		  <div class="sg-protocol-option-input" id="sg-protocol-udp">\n			<input class="input" type="text" placeholder=\''+a(n.i18n.call(t,"POP_ACLRULE_PLACEHOLD_PORT_RANGE",{hash:{},data:i}))+'\' required data-ignore="true" data-ignore-regexp="^[0-9-]*$" data-required="true"/>\n		  </div>\n		  <div class="sg-protocol-option-input" id="sg-protocol-icmp">\n			<div class="selectbox" id="protocol-icmp-main-select" data-protocal-main="0"  data-protocal-sub="-1">\n			  <div class="selection">Echo Reply(0)</div>\n			  <div class="dropdown scroll-wrap scrollbar-auto-hide context-wrap" style="height:300px;">\n				<div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n				<ul tabindex="-1" class="scroll-content">\n				  <li class="item selected" data-id="0">Echo Reply(0)</li>\n				  <li class="item" data-id="3">Destination Unreachable(3) ...</li>\n				  <li class="item" data-id="4">Source Quench(4)</li>\n				  <li class="item" data-id="5">Redirect Message(5) ...</li>\n				  <li class="item" data-id="6">Alternate Host Address(6)</li>\n				  <li class="item" data-id="8">Echo Request(8)</li>\n				  <li class="item" data-id="9">Router Advertisement(9)</li>\n				  <li class="item" data-id="10">Router Solicitation(10)</li>\n				  <li class="item" data-id="11">Time Exceeded(11) ...</li>\n				  <li class="item" data-id="12">Parameter Problem: Bad IP header(12) ...</li>\n				  <li class="item" data-id="13">Timestamp(13)</li>\n				  <li class="item" data-id="14">Timestamp Reply(14)</li>\n				  <li class="item" data-id="15">Information Request(15)</li>\n				  <li class="item" data-id="16">Information Reply(16)</li>\n				  <li class="item" data-id="17">Address Mask Request(17)</li>\n				  <li class="item" data-id="18">Address Mask Reply(18)</li>\n				  <li class="item" data-id="30">Traceroute(30)</li>\n				  <li class="item" data-id="31">Datagram Conversion Error(31)</li>\n				  <li class="item" data-id="32">Mobile Host Redirect(32)</li>\n				  <li class="item" data-id="33">Where Are You(33)</li>\n				  <li class="item" data-id="34">Here I Am(34)</li>\n				  <li class="item" data-id="35">Mobile Registration Request(35)</li>\n				  <li class="item" data-id="36">Mobile Registration Reply(36)</li>\n				  <li class="item" data-id="37">Domain Name Request(37)</li>\n				  <li class="item" data-id="38">Domain Name Reply(38)</li>\n				  <li class="item" data-id="39">SKIP Algorithm Discovery Protocol(39)</li>\n				  <li class="item" data-id="40">Photuris Security Failures(40)</li>\n				  <li class="item" data-id="-1">All(-1)</li>\n				</ul>\n			  </div>\n		  </div>\n		  <div class="selectbox protocol-icmp-sub-select" id="protocol-icmp-sub-select-3">\n			<div class="selection">All(-1)</div>\n			<div class="dropdown scroll-wrap scrollbar-auto-hide context-wrap" style="height:300px;">\n				<div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n				<ul class="scroll-content" tabindex="-1">\n				  <li class="item selected" data-id="-1">All(-1)</li>\n				  <li class="item" data-id="0">destination network unreachable(0)</li>\n				  <li class="item" data-id="1">destination host unreachable(1)</li>\n				  <li class="item" data-id="2">destination protocol unreachable(2)</li>\n				  <li class="item" data-id="3">destination port unreachable(3)</li>\n				  <li class="item" data-id="4">fragmentation required and DF flag set(4)</li>\n				  <li class="item" data-id="5">source route failed(5)</li>\n				  <li class="item" data-id="6">destination network unknown(6)</li>\n				  <li class="item" data-id="7">destination host unknown(7)</li>\n				  <li class="item" data-id="8">source host isolated(8)</li>\n				  <li class="item" data-id="9">network administratively prohibited(9)</li>\n				  <li class="item" data-id="10">host administratively prohibited(10)</li>\n				  <li class="item" data-id="11">network unreachable for TOS(11)</li>\n				  <li class="item" data-id="12">host unreachable for TOS(12)</li>\n				  <li class="item" data-id="13">communication administratively prohibited(13)</li>\n				</ul>\n			</div>\n		  </div>\n		  <div class="selectbox protocol-icmp-sub-select" id="protocol-icmp-sub-select-5">\n			<div class="selection">All(-1)</div>\n			<ul class="dropdown" tabindex="-1">\n			  <li class="selected item" data-id="-1">All(-1)</li>\n			  <li class="item" data-id="0">redirect datagram for the network(0)</li>\n			  <li class="item" data-id="1">redirect datagram for the host(1)</li>\n			  <li class="item" data-id="2">redirect datagram for the TOS & network(2)</li>\n			  <li class="item" data-id="3">redirect datagram for the TOS & host(3)</li>\n			</ul>\n		  </div>\n		  <div class="selectbox protocol-icmp-sub-select" id="protocol-icmp-sub-select-11">\n			<div class="selection">All(-1)</div>\n			<ul class="dropdown" tabindex="-1">\n			  <li class="item selected" data-id="-1">All(-1)</li>\n			  <li class="item" data-id="0">TTL expired transit(0)</li>\n			  <li class="item" data-id="1">fragmentation reasembly time exceeded(1)</li>\n			</ul>\n		  </div>\n		  <div class="selectbox protocol-icmp-sub-select" id="protocol-icmp-sub-select-12">\n			<div class="selection">All(-1)</div>\n			<ul class="dropdown" role="menu">\n			  <li class="item selected" data-id="-1">All(-1)</li>\n			  <li class="item" data-id="0">pointer indicates the error(0)</li>\n			  <li class="item" data-id="1">missing a required option(1)</li>\n			  <li class="item" data-id="2">bad length(2)</li>\n			</ul>\n		  </div>\n		  </div>\n		  <div class="sg-protocol-option-input" id="sg-protocol-custom">\n				<input class="input" type="string" value="1" min="1" max="255" required="" required data-ignore="true" data-ignore-regexp="^[0-9-]*$" data-required="true">\n		  </div>\n		  <div class="sg-protocol-option-input" id="sg-protocol-all" required data-ignore="true" data-ignore-regexp="^[0-9-]*$"> '+a(n.i18n.call(t,"POP_ACLRULE_LBL_PORT_RANGE_ALL",{hash:{},data:i}))+' </div>\n	  </div>\n	  <ul class="simple-protocol-select">\n			<li>SSH</li>\n			<li>SMTP</li>\n			<li>DNS</li>\n			<li>HTTP</li>\n			<li>POP3</li>\n			<li>IMAP</li>\n			<li>LDAP</li>\n			<li>HTTPS</li>\n			<li>SMTPS</li>\n			<li>IMAPS</li>\n			<li>POP3S</li>\n			<li>MS SQL</li>\n			<li>MYSQL</li>\n			<li>RDP</li>\n		</ul>\n	</div>\n\n  </div>\n  <div class="modal-footer">\n	<button class="btn btn-blue" id="acl-modal-rule-save-btn">'+a(n.i18n.call(t,"POP_ACLRULE_BTN_SAVE",{hash:{},data:i}))+'</button>\n	<button class="btn btn-silver modal-close">'+a(n.i18n.call(t,"POP_ACLRULE_BTN_CANCEL",{hash:{},data:i}))+"</button>\n  </div>\n</div>\n",s};return e.template(t)}),function(){define("module/design/property/acl/view",["../base/view","Design","constant","./template/stack","./template/rule_item","./template/dialog","i18n!nls/lang.js"],function(e,t,n,r,i,s,o){var u;return u=e.extend({events:{"change #property-acl-name":"aclNameChanged","click #acl-add-rule-icon":"showCreateRuleModal","OPTION_CHANGE #acl-sort-rule-select":"sortAclRule","click .acl-rule-details .rule-remove-icon":"removeAclRule"},render:function(){return this.$el.html(r(this.model.attributes)),this.refreshRuleList(),this.model.attributes.name},aclNameChanged:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(this.checkResName(n,"ACL"))return this.model.setName(t),this.setTitle(t)},sortAclRule:function(e){var t,n;return t=$("#acl-rule-list"),n=$(e.target).find(".selected").attr("data-id"),this.model.setSortOption(n),this.refreshRuleList(),null},refreshRuleList:function(){return $("#acl-rule-list").html(i(this.model.attributes.rules)),$("#acl-rule-count").text(this.model.attributes.rules.length),null},removeAclRule:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.attr("data-uid"),this.model.removeAclRule(n)&&t.remove(),null},showCreateRuleModal:function(){var e,r;return e=t.modelClassForType(n.RESTYPE.SUBNET),r={classic:!1,subnets:_.map(e.allObjects(),function(e){return{name:e.get("name"),cidr:e.get("cidr")}})},modal(s(r)),$("#acl-modal-rule-save-btn").on("click",_.bind(this.saveRule,this)),$("#acl-add-model-source-select").on("OPTION_CHANGE",this.modalRuleSourceSelected),$("#modal-protocol-select").on("OPTION_CHANGE",this.modalRuleProtocolSelected),$("#protocol-icmp-main-select").on("OPTION_CHANGE",this.modalRuleICMPSelected),$("#acl-add-model-direction-outbound").on("change",this.changeBoundInModal),$("#acl-add-model-direction-inbound").on("change",this.changeBoundInModal),$(".simple-protocol-select li").on("click",this.clickSimpleProtocolSelect),!1},saveRule:function(){var e,t,n,r,i,s,u,a,f,l,c,h;n=$("#modal-acl-number"),u=$("#modal-acl-number").val(),l=this.model.checkRuleNumber(u),n.parsley("custom",function(e){return _.isString(l)?l:null});if(!n.parsley("validate"))return;c=$("#acl-add-model-source-select").find(".selected").attr("data-id");if(c==="custom"){e=$("#modal-acl-source-input"),e.parsley("custom",function(e){return MC.validate("cidr",e)?null:o.ide.PARSLEY_MUST_BE_CIDR_BLOCK});if(!e.parsley("validate"))return;c=e.val()}t=$("#modal-protocol-select").find(".selected"),f=t.attr("data-id"),h={tcp:{dom:$("#sg-protocol-tcp input"),method:function(e){var t;return t=[],t=MC.validate.portRange(e),t?MC.validate.portValidRange(t)?null:"Port range needs to be a number or a range of numbers between 0 and 65535.":"Must be a valid format of port range."}},udp:{dom:$("#sg-protocol-udp input"),method:function(e){var t;return t=[],t=MC.validate.portRange(e),t?MC.validate.portValidRange(t)?null:"Port range needs to be a number or a range of numbers between 0 and 65535.":"Must be a valid format of port range."}},custom:{dom:$("#sg-protocol-custom input"),method:function(e){return MC.validate.port(e)?null:"Must be a valid format of port."}}};if(h[f]){s=h[f],s.dom.parsley("custom",s.method);if(!s.dom.parsley("validate"))return}return f==="tcp"?(a=$("#sg-protocol-"+f+" input").val(),f="6"):f==="udp"?(a=$("#sg-protocol-"+f+" input").val(),f="17"):f==="icmp"?(i=$("#protocol-icmp-main-select").find(".selected").attr("data-id"),r=$("#protocol-icmp-sub-select-"+i).find(".selected").attr("data-id")||"-1",f="1",a=i+"/"+r):f==="custom"?(f=$("#sg-protocol-"+f+" input").val(),a=""):f==="all"&&(f="-1",a=""),this.model.addAclRule({number:u,action:$("#acl-add-model-action-allow").is(":checked")?"allow":"deny",egress:$("#acl-add-model-direction-outbound").is(":checked"),cidr:c,protocol:f,port:a}),modal.close(),null},modalRuleSourceSelected:function(e){var t;return t=$.trim($(e.target).find(".selected").attr("data-id")),t==="custom"?($("#modal-acl-source-input").show(),$("#acl-add-model-source-select .selection").width(68)):($("#modal-acl-source-input").hide(),$("#acl-add-model-source-select .selection").width(322))},modalRuleProtocolSelected:function(e){var t,n,r,i;return r=$(e.target),i=r.find(".selected").attr("data-id"),i&&($("#sg-protocol-custom").hide(),$("#sg-protocol-all").hide(),$("#sg-protocol-select-result .sg-protocol-option-input").hide(),$("#sg-protocol-"+i).show(),t=$("#protocol-icmp-main-select"),n=t.find(".selected").attr("data-id"),n!=="3"&&n!=="5"&&n!=="11"&&n!=="12"&&$(".protocol-icmp-sub-select").hide()),null},modalRuleICMPSelected:function(e){var t,n,r;return t=$(e.target),n=t.find(".selected").attr("data-id"),r=$("#protocol-icmp-sub-select-"+n),$(".protocol-icmp-sub-select").hide(),r.show(),null},changeBoundInModal:function(e){var t;return t=$("#acl-add-model-direction-inbound").prop("checked"),t?$("#acl-add-model-bound-label").text(o.ide.POP_ACLRULE_LBL_SOURCE):$("#acl-add-model-bound-label").text(o.ide.POP_ACLRULE_LBL_DEST)},clickSimpleProtocolSelect:function(e){var t,n,r,i;return n=$(e.currentTarget).text(),i=function(e){var t,n;return t=e.toLowerCase(),n=$("#modal-protocol-select"),n.find("li.item").removeClass("selected"),n.find("li.item[data-id="+t+"]").addClass("selected"),n.find(".selection").text(e),n.trigger("OPTION_CHANGE")},t={SSH:22,SMTP:25,DNS:53,HTTP:80,POP3:110,IMAP:143,LDAP:289,HTTPS:443,SMTPS:465,IMAPS:993,POP3S:995,"MS SQL":1433,MYSQL:3306,RDP:3389},r=t[n],n==="DNS"?(i("UDP"),$("#sg-protocol-udp input").val(r)):(i("TCP"),$("#sg-protocol-tcp input").val(r))}}),new u})}.call(this),function(){define("module/design/property/acl/main",["../base/main","./model","./view","event"],function(e,t,n){var r;return t.on("REFRESH_RULE_LIST",function(){return n.refreshRuleList()}),r=e.extend({subPanelID:"ACL",initStack:function(){return this.model=t,this.model.isApp=!1,this.view=n,null},initApp:function(){return this.model=t,this.model.isApp=!0,this.view=n,null},initAppEdit:function(){return this.model=t,this.model.isApp=!1,this.view=n,null}}),null})}.call(this),function(){define("module/design/property/launchconfig/model",["../base/model","keypair_model","constant","Design"],function(e,t,n,r){var i;return i=e.extend({initialize:function(){var e;return e=this,this.on("EC2_KPDOWNLOAD_RETURN",function(t){var n,r;r=t.param[3],n=t.param[4];if(e.get("keyName")!==n)return;return e.trigger("KP_DOWNLOADED",t.resolved_data),null})},downloadKP:function(e){var n,i;return i=$.cookie("usercode"),n=$.cookie("session_id"),t.download({sender:this},i,n,r.instance().region(),e),null},init:function(e){var t,n,i,s,o;this.lc=r.instance().component(e),n=this.lc.toJSON(),n.uid=e,n.isEditable=this.isAppEdit,n.app_view=r.instance().modeIsAppView(),this.set(n),this.set("displayAssociatePublicIp",!0),this.set("monitorEnabled",this.isMonitoringEnabled()),this.set("can_set_ebs",this.lc.isEbsOptimizedEnabled()),this.getInstanceType(),this.getAmi(),this.getKeyPair(),i=r.instance(),t=i.get("agent"),this.set("stackAgentEnable",t.enabled);if(this.isApp){this.getAppLaunch(e),s=this.lc.connectionTargets("KeypairUsage")[0],this.set("keyName",s&&s.get("appId")||this.lc.get("keyName")),o=this.lc.getBlockDeviceMapping(),o.length===1&&this.set("rootDevice",o[0]);return}return null},getInstanceType:function(e,t){var r,i,s;return i=MC.aws.ami.getInstanceType(this.lc.getAmi()),i&&(r=this.lc.get("instanceType"),s=_.map(i,function(e){return{main:n.INSTANCE_TYPE[e][0],ecu:n.INSTANCE_TYPE[e][1],core:n.INSTANCE_TYPE[e][2],mem:n.INSTANCE_TYPE[e][3],name:e,selected:r===e}})),this.set("instance_type",s),null},isMonitoringEnabled:function(){var e,t,n,r;r=this.lc.parent().get("policies");for(t=0,n=r.length;t<n;t++){e=r[t];if(e.get("alarmData").metricName==="StatusCheckFailed")return!1}return!0},setEbsOptimized:function(e){return this.lc.set("ebsOptimized",e)},setCloudWatch:function(e){return this.lc.set("monitoring",e)},setUserData:function(e){return this.lc.set("userData",e)},setPublicIp:function(e){this.lc.set("publicIp",e);if(e)return r.modelClassForType(n.RESTYPE.IGW).tryCreateIgw()},setInstanceType:function(e){return this.lc.setInstanceType(e),this.lc.isEbsOptimizedEnabled()},getAmi:function(){var e,t,n,i,s,o,u;return t=this.get("imageId"),n=r.instance().component(this.get("uid")),e=this.lc.getAmi(),e?i={name:e.name,icon:e.osType+"."+e.architecture+"."+e.rootDeviceType+".png"}:i={name:t+" is not available.",icon:"ami-not-available.png",unavailable:!0},this.set("instance_ami",i),e&&e.blockDeviceMapping&&(o=e.rootDeviceName,s=e.blockDeviceMapping[o],o&&!s&&(_.each(e.blockDeviceMapping,function(e,t){if(o.indexOf(t)!==-1&&!s)return s=e,o=t}),null),u={name:o,size:parseInt(n.get("rdSize"),10),iops:n.get("rdIops")},u.size<10&&(u.iops="",u.iopsDisabled=!0),this.set("rootDevice",u)),this.set("min_volume_size",n.getAmiRootDeviceVolumeSize()),null},getKeyPair:function(){var e;return e=r.instance().component(this.get("uid")).connectionTargets("KeypairUsage")[0],e&&this.set("keypair",e.getKPList()),null},addKP:function(e){var t,i,s,o,u;t=r.modelClassForType(n.RESTYPE.KP),u=t.allObjects();for(s=0,o=u.length;s<o;s++){i=u[s];if(i.get("name")===e)return!1}return i=new t({name:e}),i.id},deleteKP:function(e){return r.instance().component(e).remove(),null},setKP:function(e){var t,n;return t=r.instance(),n=t.component(this.get("uid")),t.component(e).assignTo(n),null},isSGListReadOnly:function(){if(this.get("appId"))return!0},getAppLaunch:function(e){var t;return t=MC.data.resource_list[r.instance().region()][this.lc.get("appId")],this.set("ebsOptimized",this.lc.get("ebsOptimized")+""),this.set("name",this.lc.get("name")),this.set("lc",t),this.set("uid",e),null},getStateData:function(){return r.instance().component(this.get("uid")).getStateData()},setIops:function(e){return r.instance().component(this.get("uid")).set("rdIops",e),null},setVolumeSize:function(e){return r.instance().component(this.get("uid")).set("rdSize",e),null}}),new i})}.call(this),define("module/design/property/launchconfig/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return'style="color:red;"'}function c(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left">'+f(n.i18n.call(e,"PROP_INSTANCE_TYPE",{hash:{},data:t}))+'</label>\n			<div class="selectbox selectbox-mega" id="instance-type-select">\n				<div class="selection"></div>\n				<ul class="dropdown">\n					',i=n.each.call(e,e&&e.instance_type,{hash:{},inverse:u.noop,fn:u.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n				</ul>\n			</div>\n		</section>\n		",r}function h(e,t){var r="",i;r+='\n					<li class="',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(5,p,t),data:t});if(i||i===0)r+=i;return r+='tooltip item" data-tooltip="'+f((i=e&&e.main,typeof i===a?i.apply(e):i))+'" data-id="'+f((i=e&&e.name,typeof i===a?i.apply(e):i))+'">\n						<div class="main  truncate">'+f((i=e&&e.main,typeof i===a?i.apply(e):i))+'</div>\n						<div class="sub"><span>'+f((i=e&&e.ecu,typeof i===a?i.apply(e):i))+"</span> <span>"+f((i=e&&e.core,typeof i===a?i.apply(e):i))+"</span> <span>"+f((i=e&&e.mem,typeof i===a?i.apply(e):i))+"</span></div>\n					</li>\n					",r}function p(e,t){return"selected "}function d(e,t){return"hide"}function v(e,t){return'\n				<input id="property-instance-ebs-optimized" type="checkbox" value="None" checked="true" name="ebs-optimized" />\n				'}function m(e,t){return'\n				<input id="property-instance-ebs-optimized" type="checkbox" value="None" name="ebs-optimized" />\n				'}function g(e,t){var r="",i;r+='\n			<section class="property-control-group">\n				<div class="checkbox">\n					<input id="property-instance-public-ip" type="checkbox" ',i=n["if"].call(e,e&&e.publicIp,{hash:{},inverse:u.noop,fn:u.program(14,y,t),data:t});if(i||i===0)r+=i;return r+=' value="None" name="property-instance-public-ip" />\n					<label for="property-instance-public-ip"></label>\n				</div>\n				<label for="property-instance-public-ip">'+f(n.i18n.call(e,"PROP_INSTANCE_ENI_AUTO_PUBLIC_IP",{hash:{},data:t}))+"</label>\n			</section>\n		",r}function y(e,t){return'checked="checked"'}function b(e,t){var r;return r=n["if"].call(e,e&&e.monitoring,{hash:{},inverse:u.noop,fn:u.program(17,w,t),data:t}),r||r===0?r:""}function w(e,t){return'checked="true"'}function E(e,t){return'disabled="disabled"'}function S(e,t){var r="";return r+='\n			<div class="property-info"> User Data is disabled to allow installing OpsAgent for VisualOps. <a href="'+f(n.i18n.call(e,"PROP_AGENT_USER_DATA_URL",{hash:{},data:t}))+'" target="_blank">View content</a>.\n			</div>\n			',r}function x(e,t){var r="",i;return r+='\n				<label for="property-instance-user-data">'+f(n.i18n.call(e,"PROP_INSTANCE_USER_DATA",{hash:{},data:t}))+'</label>\n				<textarea id="property-instance-user-data">'+f((i=e&&e.userData,typeof i===a?i.apply(e):i))+"</textarea>\n			",r}function T(e,t){var r="",i;r+='\n	<div class="option-group-head">Root Device</div>\n	<div class="option-group">\n    <section class="property-control-group">\n      <label>'+f(n.i18n.call(e,"PROP_VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</label>\n      <div>"+f((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.name),typeof i===a?i.apply(e):i))+'</div>\n    </section>\n    <section class="property-control-group">\n      <label>'+f(n.i18n.call(e,"PROP_VOLUME_SIZE",{hash:{},data:t}))+'</label>\n      <div class="ranged-number-input">\n          <label for="volume-size-ranged"></label>\n          <input id="volume-size-ranged" type="text" class="input" value="'+f((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.size),typeof i===a?i.apply(e):i))+'" name="volume-size-ranged" data-ignore="true" maxlength="4" data-required="true" data-required="true" data-type="number"/>\n      <label for="volume-property-ranged-number" >GB</label>\n      </div>\n    </section>\n\n    <section class="property-control-group">\n      <label>'+f(n.i18n.call(e,"PROP_VOLUME_TYPE",{hash:{},data:t}))+'</label>\n      <div id="volume-type-radios">\n      <div>\n      	<div class="radio">\n          <input id="radio-standard" type="radio" name="volume-type" ',i=n.unless.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),{hash:{},inverse:u.noop,fn:u.program(14,y,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="radio-standard"></label>\n        </div>\n        <label for="radio-standard">'+f(n.i18n.call(e,"PROP_VOLUME_TYPE_STANDARD",{hash:{},data:t}))+"</label>\n      </div>\n      <div ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:u.noop,fn:u.program(26,N,t),data:t});if(i||i===0)r+=i;r+=' data-tooltip="'+f(n.i18n.call(e,"PROP_VOLUME_MSG_WARN",{hash:{},data:t}))+'">\n        <div class="radio">\n          <input id="radio-iops" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),{hash:{},inverse:u.noop,fn:u.program(14,y,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:u.noop,fn:u.program(28,C,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="radio-iops"></label>\n        </div>\n        <label for="radio-iops">'+f(n.i18n.call(e,"PROP_VOLUME_TYPE_IOPS",{hash:{},data:t}))+'</label>\n      </div>\n      </div>\n    </section>\n\n    <section class="property-control-group" id="iops-group" ',i=n.unless.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),{hash:{},inverse:u.noop,fn:u.program(30,k,t),data:t});if(i||i===0)r+=i;return r+='>\n        <label>IOPS</label>\n        <div class="ranged-number-input">\n          <label for="iops-ranged"></label>\n          <input id="iops-ranged" type="text" class="input" min="100" max="2000" value="'+f((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),typeof i===a?i.apply(e):i))+'">\n        </div>\n    </section>\n	</div>\n  ',r}function N(e,t){return'class="tooltip"'}function C(e,t){return"disabled"}function k(e,t){return'style="display:none"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<article>\n\n	<div class="option-group-head expand">'+f(n.i18n.call(t,"PROP_LC_TITLE",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-instance-name" >'+f(n.i18n.call(t,"PROP_LC_NAME",{hash:{},data:i}))+'</label>\n			<span class="required-input right">'+f(n.i18n.call(t,"PROP_INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n			<input class="input launch-configuration-name"  type="text" value="'+f((o=t&&t.name,typeof o===a?o.apply(t):o))+'" name="property-instance-name" id="property-instance-name" maxlength="240" data-required-rollback="true" data-ignore="true"/>\n		</section>\n		<section class="property-control-group">\n			<label>'+f(n.i18n.call(t,"PROP_INSTANCE_AMI",{hash:{},data:i}))+'</label>\n			<div id="property-ami" class="property-block-wrap clearfix" data-uid="'+f((o=t&&t.imageId,typeof o===a?o.apply(t):o))+'">\n				<img class="property-ami-icon left" src="./assets/images/ide/ami/'+f((o=(o=t&&t.instance_ami,o==null||o===!1?o:o.icon),typeof o===a?o.apply(t):o))+'" / >\n				<div class="property-ami-label" ',o=n["if"].call(t,(o=t&&t.instance_ami,o==null||o===!1?o:o.unavailable),{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+=">"+f((o=(o=t&&t.instance_ami,o==null||o===!1?o:o.name),typeof o===a?o.apply(t):o))+"</div>\n			</div>\n		</section>\n		",o=n["if"].call(t,(o=t&&t.instance_type,o==null||o===!1?o:o.length),{hash:{},inverse:u.noop,fn:u.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n		<section class="property-control-group ',o=n.unless.call(t,t&&t.can_set_ebs,{hash:{},inverse:u.noop,fn:u.program(7,d,i),data:i});if(o||o===0)s+=o;s+='">\n			<div class="checkbox">\n				',o=n["if"].call(t,t&&t.ebsOptimized,{hash:{},inverse:u.program(11,m,i),fn:u.program(9,v,i),data:i});if(o||o===0)s+=o;s+='\n				<label for="property-instance-ebs-optimized"></label>\n			</div>\n			<label for="property-instance-ebs-optimized">EBS Optimized</label>\n		</section>\n		<section class="property-control-group">\n			<label class="left">'+f(n.i18n.call(t,"PROP_INSTANCE_KEY_PAIR",{hash:{},data:i}))+'</label>\n			<i class="icon-info tooltip default-kp-info" data-tooltip="'+f(n.i18n.call(t,"POP_INSTANCE_KEYPAIR_INFO_TIP",{hash:{},data:i}))+'"></i>\n            <div id="kp-placeholder"></div>\n		</section>\n		',o=n["if"].call(t,t&&t.displayAssociatePublicIp,{hash:{},inverse:u.noop,fn:u.program(13,g,i),data:i});if(o||o===0)s+=o;s+='\n	</div>\n\n	<div class="option-group-head">'+f(n.i18n.call(t,"PROP_INSTANCE_ADVANCED_DETAIL",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group">\n			<div class="checkbox">\n				<input id="property-instance-enable-cloudwatch" type="checkbox" ',o=n["if"].call(t,t&&t.monitorEnabled,{hash:{},inverse:u.program(19,E,i),fn:u.program(16,b,i),data:i});if(o||o===0)s+=o;s+=' value="None" name="property-instance-enable-cloudwatch" />\n				<label for="property-instance-enable-cloudwatch"></label>\n			</div>\n			<label for="property-instance-enable-cloudwatch">'+f(n.i18n.call(t,"PROP_INSTANCE_CW_ENABLED",{hash:{},data:i}))+'</label>\n\n			<p class="',o=n.unless.call(t,t&&t.monitoring,{hash:{},inverse:u.noop,fn:u.program(7,d,i),data:i});if(o||o===0)s+=o;s+=' property-info" id="property-cloudwatch-warn">'+f(n.i18n.call(t,"PROP_INSTANCE_CW_WARN",{hash:{},data:i}))+'<a target="_blank" href="http://aws.amazon.com/cloudwatch">Amazon Cloud Watch product page</a></p>\n		</section>\n		<section class="property-control-group">\n			',o=n["if"].call(t,t&&t.stackAgentEnable,{hash:{},inverse:u.program(23,x,i),fn:u.program(21,S,i),data:i});if(o||o===0)s+=o;s+="\n		</section>\n	</div>\n\n	",o=n["if"].call(t,t&&t.rootDevice,{hash:{},inverse:u.noop,fn:u.program(25,T,i),data:i});if(o||o===0)s+=o;return s+='\n\n	<div class="option-group-head">'+f(n.i18n.call(t,"PROP_INSTANCE_SG_DETAIL",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n</article>\n',s};return e.template(t)}),function(){define("module/design/property/launchconfig/view",["../base/view","./template/stack","event","constant","i18n!nls/lang.js","kp"],function(e,t,n,r,i,s){var o;return o=e.extend({events:{"change .launch-configuration-name":"lcNameChange","change .instance-type-select":"instanceTypeSelect","change #property-instance-ebs-optimized":"ebsOptimizedSelect","change #property-instance-enable-cloudwatch":"cloudwatchSelect","change #property-instance-user-data":"userdataChange","change #property-instance-public-ip":"publicIpChange","OPTION_CHANGE #instance-type-select":"instanceTypeSelect","OPTION_CHANGE #keypair-select":"setKP","EDIT_UPDATE #keypair-select":"addKP","EDIT_FINISHED #keypair-select":"updateKPSelect","click #property-ami":"openAmiPanel","click #volume-type-radios input":"changeVolumeType","keyup #iops-ranged":"changeIops","keyup #volume-size-ranged":"sizeChanged"},changeVolumeType:function(e){var t,n,r;t=$(e.currentTarget);if(t.is(":disabled"))return;return $("#iops-group").toggle(t.attr("id")==="radio-iops"),t.attr("id")==="radio-iops"?(r=parseInt($("#volume-size-ranged").val(),10),n=r*10,$("#iops-ranged").val(n).keyup()):(this.model.setIops(""),$("#iops-ranged").val(""))},changeIops:function(){return $("#iops-ranged").parsley("validate")&&this.model.setIops($("#iops-ranged").val()),null},sizeChanged:function(e){var t,n,r,i;if(!$("#volume-size-ranged").parsley("validate"))return;return i=parseInt($("#volume-size-ranged").val(),10),this.model.setVolumeSize(i),i<10&&(this.model.setIops(""),r=!0),t=$("#volume-type-radios").children("div").last().toggleClass("tooltip",r).find("input"),r?(t.attr("disabled","disabled"),$("#radio-standard").click(),$("#iops-group").hide()):t.removeAttr("disabled"),n=parseInt($("#iops-ranged").val(),10)||0,n&&(n>i*10&&(n=i*10,$("#iops-ranged").val(n)),$("#iops-ranged").keyup()),null},render:function(){var e,n;return this.$el.html(t(this.model.attributes)),e=Design.instance().component(this.model.get("uid")),this.$("#kp-placeholder").html(s.load(e).el),n=this,$("#volume-size-ranged").parsley("custom",function(e){e=+e;if(!e||e>1024||e<n.model.attributes.min_volume_size)return sprintf(i.ide.PARSLEY_VOLUME_SIZE_OF_ROOTDEVICE_MUST_IN_RANGE,n.model.attributes.min_volume_size)}),$("#iops-ranged").parsley("custom",function(e){var t;e=+e,t=parseInt($("#volume-size-ranged").val(),10);if(e>4e3||e<100)return i.ide.PARSLEY_IOPS_MUST_BETWEEN_100_4000;if(e>10*t)return i.ide.PARSLEY_IOPS_MUST_BE_LESS_THAN_10_TIMES_OF_VOLUME_SIZE}),this.model.attributes.name},publicIpChange:function(e){return this.model.setPublicIp(e.currentTarget.checked),null},lcNameChange:function(e){var t,n;return n=$(e.currentTarget),t=n.val(),this.checkResName(n,"LaunchConfiguration")&&(this.model.setName(t),this.setTitle(t)),null},instanceTypeSelect:function(e,t){var n,r;r=this.model.setInstanceType(t),n=$("#property-instance-ebs-optimized"),n.closest(".property-control-group").toggle(r);if(!r)return n.prop("checked",!1)},ebsOptimizedSelect:function(e){return this.model.setEbsOptimized(e.target.checked),null},cloudwatchSelect:function(e){return this.model.setCloudWatch(e.target.checked),$("#property-cloudwatch-warn").toggle($("#property-instance-enable-cloudwatch").is(":checked"))},userdataChange:function(e){return this.model.setUserData(e.target.value)},setKP:function(e,t){return this.model.setKP(t)},addKP:function(e,t){var n;n=this.model.addKP(t);if(!n)return notification("error",i.ide.NOTIFY_MSG_WARN_KEYPAIR_NAME_ALREADY_EXISTS),n},updateKPSelect:function(){return $("#keypair-select").find(".item:last-child").append('<span class="icon-remove"></span>')},openAmiPanel:function(e){return this.trigger("OPEN_AMI",$("#property-ami").attr("data-uid")),null},deleteKP:function(e){var t,n,r,i,s,o;return r=this,t=$(e.currentTarget).closest("li"),s=t.hasClass("selected"),o=o==="true"?!0:s,i=function(){return t.remove(),s&&$("#keypair-select").find(".item").eq(0).click(),r.model.deleteKP(t.attr("data-id"))},o?(n={title:"Delete Key Pair",confirm:"Delete",color:"red",body:"<p class='modal-text-major'>Are you sure to delete "+t.text()+"?</p><p class='modal-text-minor'>Resources using this key pair will change automatically to use DefaultKP.</p>"},modal(MC.template.modalApp(n)),$("#btn-confirm").one("click",function(){return i(),modal.close()})):i(),!1},disableUserDataInput:function(e){var t;t=$("#property-instance-user-data");if(e===!0)return t.attr("disabled","disabled"),t.addClass("tooltip").attr("data-tooltip",i.ide.PROP_INSTANCE_USER_DATA_DISABLE);if(e===!1)return t.removeAttr("disabled"),t.removeClass("tooltip").removeAttr("data-tooltip")}}),new o})}.call(this),define("module/design/property/launchconfig/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+="\n      <dd>"+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+"</dd>\n      ",n}function c(e,t){var r="",i;r+='\n  <div class="option-group-head">Root Device</div>\n  <div class="option-group">\n    <article class="property-app">\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP_VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.DeviceName),{hash:{},data:t}))+'</dd>\n      </dl>\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP_VOLUME_TYPE",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.VolumeType),{hash:{},data:t}))+"</dd>\n        ",i=n["if"].call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.SnapshotId),{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+="\n        <dt>"+a(n.i18n.call(e,"PROP_VOLUME_SIZE",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.VolumeSize),{hash:{},data:t}))+" GB</dd>\n        ",i=n["if"].call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.Iops),{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;return r+="\n      </dl>\n    </article>\n  </div>\n  ",r}function h(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP_VOLUME_SNAPSHOT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.SnapshotId),typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function p(e,t){var n="",r;return n+="\n        <dt>IOPS</dt>\n        <dd>"+a((r=(r=(r=e&&e.rootDevice,r==null||r===!1?r:r.Ebs),r==null||r===!1?r:r.Iops),typeof r===u?r.apply(e):r))+"</dd>\n        ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article class="property-app">\n  <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP_LC_TITLE",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP_LC_CREATE_TIME",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.timeStr.call(t,(o=t&&t.lc,o==null||o===!1?o:o.CreatedTime),{hash:{},data:i}))+'</dd>\n    </dl>\n\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP_INSTANCE_AMI",{hash:{},data:i}))+"</dt>\n      <dd>"+a((o=t&&t.imageId,typeof o===u?o.apply(t):o))+"<dd>\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_TYPE",{hash:{},data:i}))+"</dt>\n      <dd>"+a((o=t&&t.instanceType,typeof o===u?o.apply(t):o))+"</dd>\n      <dt>"+a(n.i18n.call(t,"PROP_INSTANCE_KEY_PAIR",{hash:{},data:i}))+"</dt>\n      ",o=n["if"].call(t,t&&t.app_view,{hash:{},inverse:f.program(1,l,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n    </dl>\n\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP_INSTANCE_EBS_OPTIMIZED",{hash:{},data:i}))+"</dt>\n      <dd>"+a((o=t&&t.ebsOptimized,typeof o===u?o.apply(t):o))+"<dd>\n    </dl>\n  </div>\n\n  ",o=n["if"].call(t,t&&t.rootDevice,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+='\n\n  <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP_INSTANCE_SG_DETAIL",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n</article>\n',s};return e.template(t)}),function(){define("module/design/property/launchconfig/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({events:{"change #property-instance-enable-cloudwatch":"cloudwatchSelect","change #property-instance-user-data":"userdataChange"},kpModalClosed:!1,render:function(){var e;return e=this.model.toJSON(),this.$el.html(t(e)),e.name},cloudwatchSelect:function(e){return this.model.setCloudWatch(e.target.checked),$("#property-cloudwatch-warn").toggle($("#property-instance-enable-cloudwatch").is(":checked"))},userdataChange:function(e){return this.model.setUserData(e.target.value)}}),new n})}.call(this),function(){define("module/design/property/launchconfig/main",["../base/main","./model","./view","./app_view","../sglist/main","constant","event"],function(e,t,n,r,i,s,o){var u;return t.on("KP_DOWNLOADED",function(e,t){return r.updateKPModal(e,t)}),r.on("OPEN_AMI",function(t){return e.loadSubPanel("STATIC",t)}),n.on("OPEN_AMI",function(t){return e.loadSubPanel("STATIC",t)}),u=e.extend({handleTypes:s.RESTYPE.LC,onUnloadSubPanel:function(e){return i.onUnloadSubPanel(e),null},initStack:function(){return this.model=t,this.model.isApp=!1,this.view=n,null},afterLoadStack:function(){return i.loadModule(this.model),null},initApp:function(){return this.model=t,this.model.isApp=!0,this.view=r,null},initAppEdit:function(){return this.model=t,this.model.isApp=!0,this.view=r,null},afterLoadApp:function(){return i.loadModule(this.model),null},afterLoadAppEdit:function(){return i.loadModule(this.model),null}}),null})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("module/design/property/asg/model",["../base/model","constant","Design"],function(t,n,r){var i;return i=t.extend({init:function(e){var t,i,s,o;t=r.instance().component(e),t.type==="ExpandedAsg"&&(t=t.get("originalAsg")),i=t.toJSON(),i.uid=e,this.set(i),s=t.get("lc");if(!s){this.set("emptyAsg",!0);return}return this.set("has_elb",!!t.get("lc").connections("ElbAmiAsso").length),this.set("isEC2HealthCheck",t.isEC2HealthCheckType()),this.set("detail_monitor",!!s.get("monitoring")),o=t.getNotification(),this.set("notification",o),this.set("has_notification",o.instanceLaunch||o.instanceLaunchError||o.instanceTerminate||o.instanceTerminateError||o.test),this.set("has_sns_sub",!!r.modelClassForType(n.RESTYPE.SUBSCRIPTION).allObjects().length),this.set("policies",_.map(i.policies,function(e){return i=$.extend(!0,{},e.attributes),i.cooldown=Math.round(i.cooldown/60),i.alarmData.period=Math.round(i.alarmData.period/60),i})),null},setHealthCheckType:function(e){return r.instance().component(this.get("uid")).set("healthCheckType",e)},setASGMin:function(e){return r.instance().component(this.get("uid")).set("minSize",e)},setASGMax:function(e){return r.instance().component(this.get("uid")).set("maxSize",e)},setASGDesireCapacity:function(e){return r.instance().component(this.get("uid")).set("capacity",e)},setASGCoolDown:function(e){return r.instance().component(this.get("uid")).set("cooldown",e)},setHealthCheckGrace:function(e){return r.instance().component(this.get("uid")).set("healthCheckGracePeriod",e)},setNotification:function(e){return r.instance().component(this.get("uid")).setNotification(e)},setTerminatePolicy:function(e){return r.instance().component(this.get("uid")).set("terminationPolicies",e),this.set("terminationPolicies",e),null},delPolicy:function(e){return r.instance().component(e).remove(),null},isDupPolicyName:function(e,t){return _.some(r.instance().component(this.get("uid")).get("policies"),function(n){if(n.id!==e&&n.get("name")===t)return!0})},defaultScalingPolicyName:function(){var t,n,i,s,o;t=r.instance().component(this.get("uid")),t.type==="ExpandedAsg"&&(t=t.get("originalAsg")),o=t.get("policies"),n=o.length,s=""+this.attributes.name+"-policy-"+n,i=_.map(o,function(e){return e.get("name")});while(e.call(i,s)>=0)s=""+this.attributes.name+"-policy-"+ ++n;return s},getPolicy:function(e){var t;return t=$.extend(!0,{},r.instance().component(e).attributes),t.cooldown=Math.round(t.cooldown/60),t.alarmData.period=Math.round(t.alarmData.period/60),t},setPolicy:function(e){var t,i,s,o;return s=r.instance().component(this.get("uid")),s.type==="ExpandedAsg"&&(s=s.get("originalAsg")),e.sendNotification&&r.modelClassForType(n.RESTYPE.TOPIC).ensureExistence(),e.uid?(o=r.instance().component(e.uid),i=e.alarmData,o.setAlarm(i),delete e.alarmData,o.set(e),e.alarmData=i):(t=r.modelClassForType(n.RESTYPE.SP),o=new t(e),s.addScalingPolicy(o),e.uid=o.id,this.get("policies").push(o.toJSON())),null}}),new i})}.call(this),define("module/design/property/asg/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n  <div class="property-control-group">'+u(n.i18n.call(e,"PROP_ASG_MSG_DROP_LC",{hash:{},data:t}))+"</div>\n  ",r}function c(e,t){var r="",i;r+='\n	<div class="option-group-head expand">'+u(n.i18n.call(e,"PROP_ASG_DETAILS",{hash:{},data:t}))+'</div>\n	<div class="option-group" data-bind="true">\n		<section class="property-control-group">\n			<label class="left" for="property-asg-name" >'+u(n.i18n.call(e,"PROP_ASG_NAME",{hash:{},data:t}))+'</label>\n			<span class="required-input right">'+u(n.i18n.call(e,"PROP_ASG_REQUIRED",{hash:{},data:t}))+'</span>\n			<input class="input" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-asg-name" maxlength="255" data-ignore="true" data-required-rollback="true"/>\n		</section>\n\n		<section class="property-control-group clearfix">\n			<div class="left property-asg-size">\n				<label class="left" for="property-asg-min">'+u(n.i18n.call(e,"PROP_ASG_MIN_SIZE",{hash:{},data:t}))+'</label>\n				<input class="input" type="text" id="property-asg-min" value="'+u((i=e&&e.minSize,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true" data-required-rollback="true">\n			</div>\n			<div class="right property-asg-size">\n				<label class="left" for="property-asg-max">'+u(n.i18n.call(e,"PROP_ASG_MAX_SIZE",{hash:{},data:t}))+'</label>\n				<input class="input" type="text" id="property-asg-max" value="'+u((i=e&&e.maxSize,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true" data-required-rollback="true">\n			</div>\n	  </section>\n\n		<section class="property-control-group property-asg-size">\n			<label class="left" for="property-asg-capacity">'+u(n.i18n.call(e,"PROP_ASG_DESIRE_CAPACITY",{hash:{},data:t}))+'</label>\n			<input class="input" type="text" id="property-asg-capacity" value="'+u((i=e&&e.capacity,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true">\n		</section>\n\n		<section class="property-control-group">\n			<label class="left" for="property-asg-cooldown">'+u(n.i18n.call(e,"PROP_ASG_COOL_DOWN",{hash:{},data:t}))+'</label>\n			<input class="input input-short" type="text" id="property-asg-cooldown" value="'+u((i=e&&e.cooldown,typeof i===a?i.apply(e):i))+'" data-type="digits" max="86400">\n			<span>'+u(n.i18n.call(e,"PROP_ASG_UNIT_SECONDS",{hash:{},data:t}))+'</span>\n		</section>\n\n		<section class="property-control-group clearfix">\n			<label clas="left">'+u(n.i18n.call(e,"PROP_ASG_HEALTH_CHECK_TYPE",{hash:{},data:t}))+'</label>\n			<div class="asg-radio-group">\n				<div class="radio">\n					<input id="property-asg-ec2" type="radio" value="ec2" ',i=n["if"].call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+=' name="property-asg-hc-option" />\n					<label for="property-asg-ec2"></label>\n				</div>\n				<label for="property-asg-ec2">EC2</label>\n			</div>\n			<div ',i=n.unless.call(e,e&&e.has_elb,{hash:{},inverse:f.program(8,d,t),fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+='>\n				<div class="radio">\n					<input id="property-asg-elb" type="radio" ',i=n.unless.call(e,e&&e.has_elb,{hash:{},inverse:f.noop,fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;r+=' value="elb" ',i=n.unless.call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+=' name="property-asg-hc-option" />\n					<label for="property-asg-elb"></label>\n				</div>\n				<label for="property-asg-elb">ELB</label>\n                <p id="property-asg-elb-warn" class="hide property-info" ',i=n.unless.call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(12,m,t),data:t});if(i||i===0)r+=i;r+=">"+u(n.i18n.call(e,"PROPERTY_ASG_ELB_WARN",{hash:{},data:t}))+'</p>\n			</div>\n		</section>\n\n		<section class="property-control-group">\n			<label class="left" for="property-asg-healthcheck">'+u(n.i18n.call(e,"PROP_ASG_HEALTH_CHECK_CRACE_PERIOD",{hash:{},data:t}))+'</label>\n			<input class="input input-short" type="text" id="property-asg-healthcheck" value="'+u((i=e&&e.healthCheckGracePeriod,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true">\n			<span>'+u(n.i18n.call(e,"PROP_ASG_UNIT_SECONDS",{hash:{},data:t}))+'</span>\n		</section>\n	</div>\n\n	<div class="option-group-head">'+u(n.i18n.call(e,"PROP_ASG_POLICY",{hash:{},data:t}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group pos-r property-term-p">\n			<h5>'+u(n.i18n.call(e,"PROP_ASG_TERMINATION_POLICY",{hash:{},data:t}))+'</h5>\n			<div class="termination-policy-brief">'+u((i=e&&e.term_policy_brief,typeof i===a?i.apply(e):i))+'</div>\n			<div class="asg-p-action"><i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_TERMINATION_EDIT",{hash:{},data:t}))+'" id="property-asg-term-edit"></i></div>\n		</section>\n\n		<ul id="property-asg-policies" class="property-list">\n			<li class="pos-r hide">\n        <h5 class="property-asg-policy-name name"></h5>\n				<span class="asg-p-metric asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ALARM_METRIC",{hash:{},data:t}))+'"></span>\n        <span class="asg-p-eval asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_THRESHOLD",{hash:{},data:t}))+'"></span>\n        <span class="asg-p-periods asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_PERIOD",{hash:{},data:t}))+'"></span>\n        <span class="asg-p-trigger asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ACTION",{hash:{},data:t}))+'"></span>\n        <span class="asg-p-adjust asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ADJUSTMENT",{hash:{},data:t}))+'"></span>\n        <div class="asg-p-action">\n	        <i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_EDIT",{hash:{},data:t}))+'"></i>\n	        <i class="icon-remove icon-del tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_REMOVE",{hash:{},data:t}))+'"></i>\n        </div>\n      </li>\n      ',i=n.each.call(e,e&&e.policies,{hash:{},inverse:f.noop,fn:f.program(14,g,t),data:t});if(i||i===0)r+=i;r+='\n\n		</ul>\n		<div class="property-control-group tac">\n			<button class="btn btn-blue ',i=n.unless.call(e,e&&e.can_add_policy,{hash:{},inverse:f.noop,fn:f.program(16,y,t),data:t});if(i||i===0)r+=i;r+='" id="property-asg-policy-add" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_TIP_YOU_CAN_ONLY_ADD_25_SCALING_POLICIES",{hash:{},data:t}))+'">'+u(n.i18n.call(e,"PROP_ASG_BTN_ADD_SCALING_POLICY",{hash:{},data:t}))+'</button>\n		</div>\n	</div>\n\n	<div class="option-group-head">'+u(n.i18n.call(e,"PROP_ASG_LBL_NOTIFICATION",{hash:{},data:t}))+'</div>\n	<div class="option-group" id="property-asg-sns">\n		<div class="property-control-group property-asg-notification-wrap">\n			<p>'+u(n.i18n.call(e,"PROP_ASG_LBL_SEND_NOTIFICATION",{hash:{},data:t}))+'</p>\n			<div><div class="checkbox">\n				<input id="property-asg-sns1" type="checkbox" data-key="instanceLaunch" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceLaunch),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;r+='/>\n				<label for="property-asg-sns1"></label>\n			</div>\n			<label for="property-asg-sns1">'+u(n.i18n.call(e,"PROP_ASG_LBL_SUCCESS_INSTANCES_LAUNCH",{hash:{},data:t}))+'</label></div>\n\n			<div><div class="checkbox">\n				<input id="property-asg-sns2" type="checkbox" data-key="instanceLaunchError" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceLaunchError),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;r+='/>\n				<label for="property-asg-sns2"></label>\n			</div>\n			<label for="property-asg-sns2">'+u(n.i18n.call(e,"PROP_ASG_LBL_FAILED_INSTANCES_LAUNCH",{hash:{},data:t}))+'</label></div>\n\n			<div><div class="checkbox">\n				<input id="property-asg-sns3" type="checkbox" data-key="instanceTerminate" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceTerminate),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;r+='/>\n				<label for="property-asg-sns3"></label>\n			</div>\n			<label for="property-asg-sns3">'+u(n.i18n.call(e,"PROP_ASG_LBL_SUCCESS_INSTANCES_TERMINATE",{hash:{},data:t}))+'</label></div>\n\n			<div><div class="checkbox">\n				<input id="property-asg-sns4" type="checkbox" data-key="instanceTerminateError" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceTerminateError),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;r+='/>\n				<label for="property-asg-sns4"></label>\n			</div>\n			<label for="property-asg-sns4">'+u(n.i18n.call(e,"PROP_ASG_LBL_FAILED_INSTANCES_TERMINATE",{hash:{},data:t}))+'</label></div>\n\n			<div><div class="checkbox">\n				<input id="property-asg-sns5" type="checkbox" data-key="test" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.test),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;r+='/>\n				<label for="property-asg-sns5"></label>\n			</div>\n			<label for="property-asg-sns5">'+u(n.i18n.call(e,"PROP_ASG_LBL_VALIDATE_SNS",{hash:{},data:t}))+"</label></div>\n\n	    ",i=n.unless.call(e,e&&e.has_sns_sub,{hash:{},inverse:f.noop,fn:f.program(20,w,t),data:t});if(i||i===0)r+=i;return r+="\n\n		</div>\n	</div>\n	",r}function h(e,t){return'checked="true"'}function p(e,t){var r="";return r+='data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_HAS_ELB_WARN",{hash:{},data:t}))+'" class="asg-radio-group tooltip"',r}function d(e,t){return'class="asg-radio-group"'}function v(e,t){return'disabled="disabled"'}function m(e,t){return' style="display: block"'}function g(e,t){var r="",i;return r+='\n      <li class="pos-r" data-uid="'+u((i=e&&e.id,typeof i===a?i.apply(e):i))+'">\n        <h5 class="property-asg-policy-name name" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_NAME",{hash:{},data:t}))+'">'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'</h5>\n      	<span class="asg-p-metric asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ALARM_METRIC",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.metricName),typeof i===a?i.apply(e):i))+'</span>\n        <span class="asg-p-eval asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_THRESHOLD",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.comparisonOperator),typeof i===a?i.apply(e):i))+" "+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.threshold),typeof i===a?i.apply(e):i))+u((i=e&&e.unit,typeof i===a?i.apply(e):i))+'</span>\n        <span class="asg-p-periods asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_PERIOD",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.evaluationPeriods),typeof i===a?i.apply(e):i))+"x"+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.period),typeof i===a?i.apply(e):i))+'m</span>\n        <span class="asg-p-trigger asg-p-tag asg-p-trigger-'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ACTION",{hash:{},data:t}))+'">'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'</span>\n        <span class="asg-p-adjust asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ADJUSTMENT",{hash:{},data:t}))+'">'+u((i=e&&e.adjustment,typeof i===a?i.apply(e):i))+" "+u((i=e&&e.adjustmentType,typeof i===a?i.apply(e):i))+'</span>\n        <div class="asg-p-action">\n	        <i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_EDIT",{hash:{},data:t}))+'"></i>\n	        <i class="icon-remove icon-del tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_REMOVE",{hash:{},data:t}))+'"></i>\n        </div>\n      </li>\n      ',r}function y(e,t){return"disabled tooltip"}function b(e,t){return'checked="checked"'}function w(e,t){var r="",i;r+='\n			<p class="property-warning ',i=n.unless.call(e,e&&e.has_notification,{hash:{},inverse:f.noop,fn:f.program(21,E,t),data:t});if(i||i===0)r+=i;return r+='" id="property-asg-sns-info"> '+u(n.i18n.call(e,"PROP_ASG_MSG_SNS_WARN",{hash:{},data:t}))+" </p>\n	    ",r}function E(e,t){return"hide"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+="<article>\n  ",o=n["if"].call(t,t&&t.emptyAsg,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>\n",s};return e.template(t)}),define("module/design/property/asg/template/policy",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return"readonly"}function c(e,t){return'\n								<li data-id="StatusCheckFailed" class="item">Status Check Failed (Any)</li>\n								<li data-id="StatusCheckFailed_Instance" class="item">Status Check Failed (Instance)</li>\n								<li data-id="StatusCheckFailed_System" class="item">Status Check Failed (System)</li>\n								'}function h(e,t){return'checked="checked"'}function p(e,t){var r="",i;r+='\n						<p class="',i=n.unless.call(e,e&&e.sendNotification,{hash:{},inverse:u.noop,fn:u.program(8,d,t),data:t});if(i||i===0)r+=i;return r+=' property-warning" id="asg-policy-no-sns">'+a(n.i18n.call(e,"PROP_ASG_MSG_SNS_WARN",{hash:{},data:t}))+"</p>\n						",r}function d(e,t){return"hide"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a=this.escapeExpression,f="function";s+='<div id="asg-termination-policy" style="width:480px;"  data-bind="true">\n	 <div class="modal-header">\n			<h3>'+a((o=t&&t.title,typeof o===f?o.apply(t):o))+" "+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_TITLE_CONTENT",{hash:{},data:i}))+'</h3>\n			<i class="modal-close">&times;</i>\n	 </div>\n	<div class="scroll-wrap" style="max-height:500px;">\n		<div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n		 <div class="modal-body scroll-content" id="property-asg-policy" data-uid="'+a((o=t&&t.uid,typeof o===f?o.apply(t):o))+'">\n\n			<label for="asg-policy-name" class="modal-text-major">'+a(n.i18n.call(t,"PROP_ASG_POLICY_TLT_NAME",{hash:{},data:i}))+'</label>\n			<input type="text" class="input" value="'+a((o=t&&t.name,typeof o===f?o.apply(t):o))+'" id="asg-policy-name" data-required-rollback="true" data-ignore="true" maxlength="255" data-required="true" ',o=n["if"].call(t,t&&t.isOld,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+='>\n\n\n				<section class="modal-control-group">\n					<h5>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ALARM",{hash:{},data:i}))+'</h5>\n					<div class="control-sentence">\n						<span>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_WHEN",{hash:{},data:i}))+'</span>\n\n						<div class="selectbox" id="asg-policy-metric">\n							<div class="selection">CPU Utillization</div>\n							<ul class="dropdown" tabindex="-1">\n								<li data-id="CPUUtilization" class="item selected">CPU Utilization</li>\n								<li data-id="DiskReadBytes" class="item">Disk Reads</li>\n								<li data-id="DiskReadOps" class="item">Disk Read Operations</li>\n								<li data-id="DiskWriteBytes" class="item">Disk Writes</li>\n								<li data-id="DiskWriteOps" class="item">Disk Write Operations</li>\n								<li data-id="NetworkIn" class="item">Network In</li>\n								<li data-id="NetworkOut" class="item">Network Out</li>\n								',o=n.unless.call(t,t&&t.detail_monitor,{hash:{},inverse:u.noop,fn:u.program(3,c,i),data:i});if(o||o===0)s+=o;s+="\n							</ul>\n						</div>\n\n						<span>"+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_IS",{hash:{},data:i}))+'</span>\n\n						<div class="selectbox" id="asg-policy-eval">\n							<div class="selection">&gt;=</div>\n							<ul class="dropdown" tabindex="-1">\n								<li data-id=">" class="item">&gt;</li>\n								<li data-id=">=" class="item selected">&gt;=</li>\n								<li data-id="<" class="item">&lt;</li>\n								<li data-id="<=" class="item">&lt;=</li>\n							</ul>\n						</div>\n\n						<input type="text" class="input" id="asg-policy-threshold" value="'+a((o=(o=t&&t.alarmData,o==null||o===!1?o:o.threshold),typeof o===f?o.apply(t):o))+'" placeholder="'+a(n.i18n.call(t,"PROP_ASG_POLICY_TLT_THRESHOLD",{hash:{},data:i}))+'" data-ignore="true" data-ignore-regexp="^[0-9]*\\.?[0-9]*$" data-required="true">\n\n						<span id="asg-policy-unit">'+a((o=t&&t.unit,typeof o===f?o.apply(t):o))+"</span>\n\n						<br />\n\n						<span>"+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_FOR",{hash:{},data:i}))+'</span>\n\n						<input type="text" class="input" id="asg-policy-periods" value="'+a((o=(o=t&&t.alarmData,o==null||o===!1?o:o.evaluationPeriods),typeof o===f?o.apply(t):o))+'" data-required="true" data-ignore="true" data-type="digits">\n\n						<span>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_PERIOD",{hash:{},data:i}))+'</span>\n\n						<input type="text" class="input" id="asg-policy-second" value="'+a((o=(o=t&&t.alarmData,o==null||o===!1?o:o.period),typeof o===f?o.apply(t):o))+'" data-required="true" data-ignore="true" data-type="digits">\n\n						<span>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_SECONDS",{hash:{},data:i}))+"</span>\n\n						<br />\n\n						<span>"+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_START_SCALING",{hash:{},data:i}))+'</span>\n\n						<div class="selectbox" id="asg-policy-trigger">\n							<div class="selection">ALARM</div>\n							<ul class="dropdown" tabindex="-1">\n								<li data-id="ALARM" class="item selected">ALARM</li>\n								<li data-id="INSUFFICIANT_DATA" class="item">INSUFFICIANT_DATA</li>\n								<li data-id="OK" class="item">OK</li>\n							</ul>\n						</div>\n\n						<span>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_STATE",{hash:{},data:i}))+'</span>\n					</div>\n				</section>\n\n				<section class="modal-control-group">\n					<h5>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_SCALING_ACTIVITY",{hash:{},data:i}))+'</h5>\n					<div class="control-sentence">\n						<span>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADJUSTMENT",{hash:{},data:i}))+'</span>\n						<div class="selectbox" id="asg-policy-adjust-type">\n							<div class="selection">Change in Capacity</div>\n							<ul class="dropdown" tabindex="-1">\n								<li data-id="ChangeInCapacity" class="item selected">Change in Capacity</li>\n								<li data-id="ExactCapacity" class="item">Exact Capacity</li>\n								<li data-id="PercentChangeInCapacity" class="item">Percent Change in Capacity</li>\n							</ul>\n						</div>\n						<span>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADJUSTMENT_OF",{hash:{},data:i}))+'</span>\n						<input type="text" class="input tooltip" id="asg-policy-adjust" data-required="true" value="'+a((o=t&&t.adjustment,typeof o===f?o.apply(t):o))+'" placeholder="e.g. -1" data-ignore="true" data-ignore-regexp="^-?[0-9]*$">\n						<span class="hide pecentcapcity">%</span>\n						<span>.</span>\n					</div>\n				</section>\n\n				<h5>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED",{hash:{},data:i}))+'</h5>\n				<div class="asg-policy-advanced">\n					<section id="asg-policy-statistics" class="modal-control-group">\n						<h5>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_ALARM_OPTION",{hash:{},data:i}))+'</h5>\n						<div class="clearfix">\n							<label>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_STATISTIC",{hash:{},data:i}))+'</label>\n							<div class="selectbox" id="asg-policy-statistics">\n							<div class="selection">'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_STATISTIC_AVG",{hash:{},data:i}))+'</div>\n							<ul class="dropdown" tabindex="-1">\n								<li data-id="Average" class="item selected">'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_STATISTIC_AVG",{hash:{},data:i}))+'</li>\n								<li data-id="Minimum" class="item">'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_STATISTIC_MIN",{hash:{},data:i}))+'</li>\n								<li data-id="Maximum" class="item">'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_STATISTIC_MAX",{hash:{},data:i}))+'</li>\n								<li data-id="SampleCount" class="item">'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_STATISTIC_SAMPLE",{hash:{},data:i}))+'</li>\n								<li data-id="Sum" class="item">'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_STATISTIC_SUM",{hash:{},data:i}))+'</li>\n							</ul>\n						</div>\n					</div>\n					</section>\n\n					<section id="asg-policy-scaling" class="modal-control-group">\n						<h5>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_SCALING_OPTION",{hash:{},data:i}))+'</h5>\n						<div class="clearfix">\n							<label for="asg-policy-cooldown">'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_COOLDOWN_PERIOD",{hash:{},data:i}))+'</label>\n							<input type="text" class="input tooltip" data-tooltip="'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_TIP_COOLDOWN_PERIOD",{hash:{},data:i}))+'" value="'+a((o=t&&t.cooldown,typeof o===f?o.apply(t):o))+'" maxlength="5" placeholder="'+a(n.i18n.call(t,"PROP_ASG_DEFAULT_COOL_DOWN",{hash:{},data:i}))+'" data-ignore="true" data-type="digits" id="asg-policy-cooldown">\n							<span>'+a(n.i18n.call(t,"PROP_ASG_UNIT_MINS",{hash:{},data:i}))+'</span>\n						</div>\n\n						<div id="asg-policy-step-wrapper" class="hide clearfix pecentcapcity">\n							<label>'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_MIN_ADJUST_STEP",{hash:{},data:i}))+'</label>\n							<input type="text" class="input tooltip" data-tooltip="'+a(n.i18n.call(t,"PROP_ASG_ADD_POLICY_ADVANCED_TIP_MIN_ADJUST_STEP",{hash:{},data:i}))+'" id="asg-policy-step" value="'+a((o=t&&t.minAdjustStep,typeof o===f?o.apply(t):o))+'" data-ignore="true" maxlength="5" data-type="digits">\n						</div>\n					</section>\n\n					<section class="modal-control-group">\n						<h5>'+a(n.i18n.call(t,"PROP_ASG_LBL_NOTIFICATION",{hash:{},data:i}))+'</h5>\n						<div class="checkbox">\n							<input id="asg-policy-notify" type="checkbox" ',o=n["if"].call(t,t&&t.sendNotification,{hash:{},inverse:u.noop,fn:u.program(5,h,i),data:i});if(o||o===0)s+=o;s+='/>\n							<label for="asg-policy-notify"></label>\n						</div>\n						<label id="asg-policy-notify-label" for="asg-policy-notify">'+a(n.i18n.call(t,"PROP_ASG_LBL_SEND_NOTIFICATION_D",{hash:{},data:i}))+"</label>\n\n						",o=n["if"].call(t,t&&t.noSNS,{hash:{},inverse:u.noop,fn:u.program(7,p,i),data:i});if(o||o===0)s+=o;return s+='\n					</section>\n				</div>\n		 </div>\n		</div>\n	 </div>\n	 <div class="modal-footer">\n			<button id="property-asg-policy-done" class="btn btn-blue">Done</button>\n			<button class="btn modal-close btn-silver">Cancel</button>\n	 </div>\n</div>\n',s};return e.template(t)}),define("module/design/property/asg/template/term",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n          <li ",i=n["if"].call(e,e&&e.checked,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;r+='>\n            <div class="checkbox">\n              <input id="property-asg-term'+f((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'" type="checkbox" ',i=n["if"].call(e,e&&e.checked,{hash:{},inverse:u.noop,fn:u.program(4,h,t),data:t});if(i||i===0)r+=i;return r+='/>\n              <label for="property-asg-term'+f((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'"></label>\n            </div>\n            <label for="property-asg-term'+f((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'" class="list-name">'+f((i=e&&e.name,typeof i===a?i.apply(e):i))+'</label>\n            <span class="drag-handle tooltip icon-sort" data-tooltip="'+f(n.i18n.call(e,"PROP_ASG_TERMINATION_MSG_DRAG",{hash:{},data:t}))+'"></span>\n          </li>\n          ',r}function c(e,t){return'class="enabled"'}function h(e,t){return'checked="checked"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<div style="width:420px">\n   <div class="modal-header">\n      <h3>'+f(n.i18n.call(t,"PROP_ASG_TERMINATION_EDIT",{hash:{},data:i}))+'</h3>\n      <i class="modal-close">&times;</i>\n   </div>\n   <div class="modal-body" id="property-asg-term">\n\n      <p class="modal-text-minor">'+f(n.i18n.call(t,"PROP_ASG_TERMINATION_TEXT_WARN",{hash:{},data:i}))+'</p>\n      <div class="drag-sort-list-wrap">\n        <ul class="drag-sort-list" id="property-term-list">\n          ',o=n.each.call(t,t,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n        </ul>\n\n        <ul class="drag-sort-list">\n          <li ',o=n["if"].call(t,t&&t.useDefault,{hash:{},inverse:u.noop,fn:u.program(2,c,i),data:i});if(o||o===0)s+=o;s+='>\n            <div class="checkbox">\n              <input id="property-asg-term-def" type="checkbox" ',o=n["if"].call(t,t&&t.useDefault,{hash:{},inverse:u.noop,fn:u.program(4,h,i),data:i});if(o||o===0)s+=o;return s+='/>\n              <label for="property-asg-term-def"></label>\n            </div>\n            <span>Default</span>\n          </li>\n        </ul>\n      </div>\n   </div>\n   <div class="modal-footer">\n      <button id="property-asg-term-done" class="btn btn-blue">Done</button>\n      <button class="btn modal-close btn-silver">Cancel</button>\n   </div>\n</div>\n',s};return e.template(t)}),function(){define("module/design/property/asg/view",["../base/view","./template/stack","./template/policy","./template/term","i18n!nls/lang.js"],function(e,t,n,r,i){var s,o,u,a,f,l;return f={CPUUtilization:"CPU Utilization",DiskReadBytes:"Disk Reads",DiskReadOps:"Disk Read Operations",DiskWriteBytes:"Disk Writes",DiskWriteOps:"Disk Write Operations",NetworkIn:"Network In",NetworkOut:"Network Out",StatusCheckFailed:"Status Check Failed (Any)",StatusCheckFailed_Instance:"Status Check Failed (Instance)",StatusCheckFailed_System:"Status Check Failed (System)"},o={ChangeInCapacity:"Change in Capacity",ExactCapacity:"Exact Capacity",PercentChangeInCapacity:"Percent Change in Capacity"},a={ChangeInCapacity:"eg. -1",ExactCapacity:"eg. 5",PercentChangeInCapacity:"eg. -30"},u={ChangeInCapacity:"Increase or decrease existing capacity by integer you input here. A positive value adds to the current capacity and a negative value removes from the current capacity.",ExactCapacity:"Change the current capacity of your Auto Scaling group to the exact value specified.",PercentChangeInCapacity:"Increase or decrease the desired capacity by a percentage of the desired capacity. A positive value adds to the current capacity and a negative value removes from the current capacity"},l={CPUUtilization:"%",DiskReadBytes:"B",DiskWriteBytes:"B",NetworkIn:"B",NetworkOut:"B"},s=e.extend({events:{"click #property-asg-term-edit":"showTermPolicy","click #property-asg-sns input[type=checkbox]":"setNotification","change #property-asg-elb":"setHealthyCheckELBType","change #property-asg-ec2":"setHealthyCheckEC2Type","change #property-asg-name":"setASGName","change #property-asg-min":"setSizeGroup","change #property-asg-max":"setSizeGroup","change #property-asg-capacity":"setSizeGroup","change #property-asg-cooldown":"setASGCoolDown","change #property-asg-healthcheck":"setHealthCheckGrace","click #property-asg-policy-add":"addScalingPolicy","click #property-asg-policies .icon-edit":"editScalingPolicy","click #property-asg-policies .icon-del":"delScalingPolicy"},render:function(){var e,n,r,i,s;e=this.model.toJSON(),s=e.policies;for(r=0,i=s.length;r<i;r++)n=s[r],n.unit=l[n.alarmData.metricName],n.alarmData.metricName=f[n.alarmData.metricName],n.adjustmentType=o[n.adjustmentType];return e.term_policy_brief=e.terminationPolicies.join(" > "),e.can_add_policy=e.policies.length<25,this.$el.html(t(e)),e.name},setASGCoolDown:function(e){var t;t=$(e.target),t.parsley("custom",function(e){return _.isNumber(+e)&&+e>86400?i.ide.PARSLEY_MAX_VALUE_86400:null});if(t.parsley("validate"))return this.model.setASGCoolDown(t.val())},setASGName:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(this.checkResName(n,"ASG"))return this.model.setName(t),this.setTitle(t)},setSizeGroup:function(e){var t,n,r,s;s=this,r=this.$el.find("#property-asg-min"),n=this.$el.find("#property-asg-max"),t=this.$el.find("#property-asg-capacity"),r.parsley("custom",function(e){return+e>+n.val()?i.ide.PARSLEY_MINIMUM_SIZE_MUST_BE_LESSTHAN_MAXIMUM_SIZE:s.constantCheck(e)}),n.parsley("custom",function(e){return+e<+r.val()?i.ide.PARSLEY_MAXIMUM_SIZE_MUST_BE_MORETHAN_MINIMUM_SIZE:s.constantCheck(e)}),t.parsley("custom",function(e){return+e<+r.val()||+e>+n.val()?i.ide.PARSLEY_DESIRED_CAPACITY_IN_ALLOW_SCOPE:s.constantCheck(e)});if($(e.currentTarget).parsley("validateForm"))return this.model.setASGMin(r.val()),this.model.setASGMax(n.val()),this.model.setASGDesireCapacity(t.val())},constantCheck:function(e){return e=+e,e<1?sprintf(i.ide.PARSLEY_VALUE_MUST_BE_GREATERTHAN_VAR,1):e>65534?sprintf(i.ide.PARSLEY_VALUE_MUST_BE_LESSTHAN_VAR,65534):null},setHealthCheckGrace:function(e){var t;t=$(e.currentTarget),t.parsley("custom",function(e){e=+e;if(e<0||e>86400)return sprintf(i.ide.PARSLEY_VALUE_MUST_IN_ALLOW_SCOPE,0,86400)});if(t.parsley("validate"))return this.model.setHealthCheckGrace(t.val())},showTermPolicy:function(){var e,t,n,s,o,u,a,f,l,c,h;t=[],e={},c=this.model.get("terminationPolicies");for(u=0,f=c.length;u<f;u++)s=c[u],s==="Default"?t.useDefault=!0:(t.push({name:s,checked:!0}),e[s]=!0);h=[i.ide.PROP_ASG_TERMINATION_POLICY_OLDEST,i.ide.PROP_ASG_TERMINATION_POLICY_NEWEST,i.ide.PROP_ASG_TERMINATION_POLICY_OLDEST_LAUNCH,i.ide.PROP_ASG_TERMINATION_POLICY_CLOSEST];for(a=0,l=h.length;a<l;a++)n=h[a],e[n]||t.push({name:n,checked:!1});return modal(r(t),!0),o=this,$("#property-asg-term").on("click","input",function(){var t,n;return t=$("#property-asg-term").find("input:checked"),t.length===0?!1:(n=$(this),e=n.is(":checked"),n.closest("li").toggleClass("enabled",e))}),$("#property-asg-term-done").on("click",function(){return o.onEditTermPolicy(),modal.close()}),$("#property-asg-term").on("mousedown",".drag-handle",function(){return $(this).trigger("mouseleave")}),$("#property-term-list").sortable({handle:".drag-handle"})},onEditTermPolicy:function(){var e;return e=[],$("#property-term-list .list-name").each(function(){var t;return t=$(this),t.closest("li").hasClass("enabled")&&e.push(t.text()),null}),$("#property-asg-term-def").is(":checked")&&e.push("Default"),$(".termination-policy-brief").text(e.join(" > ")),this.model.setTerminatePolicy(e)},delScalingPolicy:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.data("uid"),t.remove(),$("#property-asg-policy-add").removeClass("tooltip disabled"),this.model.delPolicy(n)},updateScalingPolicy:function(e){var t,n,r,i,s;i=f[e.alarmData.metricName],r=o[e.adjustmentType],s=l[e.alarmData.metricName]||"";if(!e.uid){void 0;return}return n=$("#property-asg-policies"),t=n.children("[data-uid='"+e.uid+"']"),t.length===0&&(t=n.children(".hide").clone().attr("data-uid",e.uid).removeClass("hide").appendTo(n),$("#property-asg-policy-add").toggleClass("tooltip disabled",$("#property-asg-policies").children().length>=26)),t.find(".name").html(e.name),t.find(".asg-p-metric").html(i),t.find(".asg-p-eval").html(e.alarmData.comparisonOperator+" "+e.alarmData.threshold+s),t.find(".asg-p-periods").html(e.alarmData.evaluationPeriods+"x"+Math.round(e.alarmData.period/60)+"m"),t.find(".asg-p-trigger").html(e.state).attr("class","asg-p-trigger asg-p-tag asg-p-trigger-"+e.state),t.find(".asg-p-adjust").html(e.adjustment+" "+e.adjustmentType)},editScalingPolicy:function(e){var t,n,r,s,o,u,a,f,l,c,h,p;f=$(e.currentTarget).closest("li").data("uid"),s=this.model.getPolicy(f),s.uid=f,s.title=i.ide.PROP_ASG_ADD_POLICY_TITLE_EDIT,this.showScalingPolicy(s),a={metric:s.alarmData.metricName,eval:s.alarmData.comparisonOperator,trigger:s.state,"adjust-type":s.adjustmentType,statistics:s.alarmData.statistic};for(u in a){l=a[u],n=$("#asg-policy-"+u),r=null,p=n.find(".item");for(c=0,h=p.length;c<h;c++){o=p[c],t=$(o);if(t.data("id")===l){r=t;break}}r&&(n.find(".selected").removeClass("selected"),n.find(".selection").html(r.addClass("selected").html()))}return $(".pecentcapcity").toggle($("#asg-policy-adjust-type").find(".selected").data("id")==="PercentChangeInCapacity")},addScalingPolicy:function(e){return $(e.currentTarget).hasClass("disabled")?!1:(this.showScalingPolicy(),!1)},showScalingPolicy:function(e){var t;return e||(e={title:i.ide.PROP_ASG_ADD_POLICY_TITLE_ADD,name:this.model.defaultScalingPolicyName(),minAdjustStep:1,alarmData:{evaluationPeriods:2,period:5}}),e.alarmData&&e.alarmData.metricName?e.unit=l[e.alarmData.metricName]:e.unit="%",e.noSNS=!this.model.attributes.has_sns_sub,e.detail_monitor=this.model.attributes.detail_monitor,modal(n(e),!0),t=this,$("#property-asg-policy-done").on("click",function(){var e;return e=$("#asg-termination-policy").parsley("validate"),e===!1?!1:(t.onPolicyDone(),modal.close())}),$("#asg-policy-name").parsley("custom",function(e){var n;n=$("#property-asg-policy").data("uid");if(t.model.isDupPolicyName(n,e))return"Duplicated policy name in this autoscaling group"}),$("#asg-policy-periods").on("change",function(){var e;e=parseInt($(this).val(),10),(!e||e<1)&&$(this).val("1");if(e>86400)return $(this).val(86400)}),$("#asg-policy-second").on("change",function(){var e;e=parseInt($(this).val(),10),(!e||e<1)&&$(this).val("1");if(e>1440)return $(this).val(1440)}),$("#asg-policy-adjust-type").on("OPTION_CHANGE",function(){var e;return e=$(this).find(".selected").data("id"),$(".pecentcapcity").toggle(e==="PercentChangeInCapacity"),$("#asg-policy-adjust").attr("placeholder",a[e]).data("tooltip",u[e]).trigger("change")}),$("#asg-policy-adjust").on("change",function(){var e,t;return e=$("#asg-policy-adjust-type").find(".selected").data("id"),t=parseInt($(this).val(),10),e==="ExactCapacity"?(!t||t<1)&&$(this).val("1"):e==="PercentChangeInCapacity"&&(t?t<-100&&$(this).val("-100"):$(this).val("0")),t<-65534?$(this).val(-65534):t>65534&&$(this).val(65534),$("#").data("tooltip",u[e]).trigger("change")}),$("#asg-policy-cooldown").on("change",function(){var e,t;e=$("#asg-policy-cooldown"),t=parseInt(e.val(),10);if(isNaN(t))return;return t<0?t=0:t>1440&&(t=1440),e.val(t)}),$("#asg-policy-step").on("change",function(){var e,t;e=$("#asg-policy-step"),t=parseInt(e.val(),10);if(isNaN(t))return;return t<0?t=0:t>65534&&(t=65534),e.val(t)}),$("#asg-policy-threshold").on("change",function(){var e,t;e=$("#asg-policy-metric .selected").data("id"),t=parseInt($(this).val(),10);if(e==="CPUUtilization"){if(isNaN(t)||t<1)return $(this).val("1");if(t>100)return $(this).val("100")}}),$("#asg-policy-notify").on("click",function(e){return $("#asg-policy-no-sns").toggle($("#asg-policy-notify").is(":checked")),e.stopPropagation(),null}),$("#asg-policy-metric").on("OPTION_CHANGE",function(){return $("#asg-policy-unit").html(l[$(this).find(".selected").data("id")]||""),$("#asg-policy-threshold").val("")}),null},onPolicyDone:function(){var e;return e={uid:$("#property-asg-policy").data("uid"),name:$("#asg-policy-name").val(),cooldown:$("#asg-policy-cooldown").val()*60,minAdjustStep:$("#asg-policy-step").val(),adjustment:$("#asg-policy-adjust").val(),adjustmentType:$("#asg-policy-adjust-type .selected").data("id"),state:$("#asg-policy-trigger .selected").data("id"),sendNotification:$("#asg-policy-notify").is(":checked"),alarmData:{metricName:$("#asg-policy-metric .selected").data("id"),comparisonOperator:$("#asg-policy-eval .selected").data("id"),period:$("#asg-policy-second").val()*60,evaluationPeriods:$("#asg-policy-periods").val(),statistic:$("#asg-policy-statistics .selected").data("id"),threshold:$("#asg-policy-threshold").val()}},this.model.setPolicy(e),this.updateScalingPolicy(e),null},setNotification:function(){var e,t;return e={},t=!1,$("#property-asg-sns input[type = checkbox]").each(function(){var n;return n=$(this).is(":checked"),e[$(this).attr("data-key")]=n,n&&(t=!0),null}),t?$("#property-asg-sns-info").show():$("#property-asg-sns-info").hide(),this.model.setNotification(e)},setHealthyCheckELBType:function(e){return this.model.setHealthCheckType("ELB"),$("#property-asg-elb-warn").toggle($("#property-asg-elb").is(":checked"))},setHealthyCheckEC2Type:function(e){return this.model.setHealthCheckType("EC2"),$("#property-asg-elb-warn").toggle($("#property-asg-elb").is(":checked"))}}),new s})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("module/design/property/asg/app_model",["../base/model","constant","Design"],function(t,n,r){var i;return i=t.extend({init:function(e){var t,i,s,o,u,a,f;t=s=r.instance().component(e),o={uid:e,name:t.get("name"),minSize:t.get("minSize"),maxSize:t.get("maxSize"),capacity:t.get("capacity"),isEditable:this.isAppEdit},this.set(o),f=MC.data.resource_list[r.instance().region()],i=f[t.get("appId")],i&&(this.set("hasData",!0),this.set("awsResName",i.AutoScalingGroupName),this.set("arn",i.AutoScalingGroupARN),this.set("createTime",i.CreatedTime),i.TerminationPolicies&&i.TerminationPolicies.member&&this.set("term_policy_brief",i.TerminationPolicies.member.join(" > ")),this.handleInstance(t,f,i));if(!this.isAppEdit){if(!i)return!1;this.set("lcName",i.LaunchConfigurationName),this.set("cooldown",i.DefaultCooldown),this.set("healCheckType",i.HealthCheckType),this.set("healthCheckGracePeriod",i.HealthCheckGracePeriod),this.handlePolicy(t,f,i),this.handleNotify(t,f,i)}else{o=s.toJSON(),o.uid=e,this.set(o),u=t.get("lc");if(!u){this.set("emptyAsg",!0);return}this.set("has_elb",!!s.get("lc").connections("ElbAmiAsso").length),this.set("isEC2HealthCheck",s.isEC2HealthCheckType()),this.set("detail_monitor",!!u.get("monitoring")),a=s.getNotification(),this.set("notification",a),this.set("has_notification",a.instanceLaunch||a.instanceLaunchError||a.instanceTerminate||a.instanceTerminateError||a.test),this.set("has_sns_sub",!!r.modelClassForType(n.RESTYPE.SUBSCRIPTION).allObjects().length),this.set("policies",_.map(o.policies,function(e){return o=$.extend(!0,{},e.attributes),o.cooldown=Math.round(o.cooldown/60),o.alarmData.period=Math.round(o.alarmData.period/60),o}))}return null},handleInstance:function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p;u=0,a=[],l={};if(n.Instances&&n.Instances.member){u=n.Instances.member.length,p=n.Instances.member;for(s=c=0,h=p.length;c<h;s=++c)o=p[s],r={status:o.HealthStatus==="Healthy"?"green":"red",healthy:o.HealthStatus,name:o.InstanceId},i=o.AvailabilityZone,l[i]?l[i].push(r):l[i]=[r];for(i in l)f=l[i],a.push({name:i,instances:f})}else u=0;return this.set("instance_groups",a),this.set("instance_count",u)},handleNotify:function(e,t,n){var r,i,s,o,u,a,f;o=t.NotificationConfigurations,u=!1,r=[!1,!1,!1,!1,!1],i={"autoscaling:EC2_INSTANCE_LAUNCH":0,"autoscaling:EC2_INSTANCE_LAUNCH_ERROR":1,"autoscaling:EC2_INSTANCE_TERMINATE":2,"autoscaling:EC2_INSTANCE_TERMINATE_ERROR":3,"autoscaling:TEST_NOTIFICATION":4};if(o)for(a=0,f=o.length;a<f;a++)s=o[a],s.AutoScalingGroupName===n.AutoScalingGroupName&&(r[i[s.NotificationType]]=!0,u=!0);return this.set("notifies",r),this.set("sendNotify",u)},handlePolicy:function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x;l=[],u={},E=e.get("policies"),x=[];for(v=0,y=E.length;v<y;v++){p=E[v],a=p.id,h=t[p.get("appId")];if(!h)continue;c={adjusttype:h.AdjustmentType,adjustment:h.ScalingAdjustment,step:h.MinAdjustmentStep,cooldown:h.Cooldown,name:h.PolicyName,arn:p.get("appId")},o=t[p.get("alarmData").appId];if(o){s=[o.InsufficientDataActions,o.OKActions,o.AlarmActions],d=["INSUFFICIANT_DATA","OK","ALARM"];for(f=m=0,b=s.length;m<b;f=++m){i=s[f];if(!i)continue;S=i.member;for(g=0,w=S.length;g<w;g++){r=S[g];if(r!==c.arn)continue;c.arn="",c.evaluation=p.get("alarmData").comparisonOperator,c.metric=o.MetricName,c.notify=i.length===2,c.periods=o.EvaluationPeriods,c.minute=Math.round(o.Period/60),c.statistics=o.Statistic,c.threshold=o.Threshold,c.trigger=d[f]}}}else void 0;l.push(c),x.push(this.set("policies",_.sortBy(l,"name")))}return x},setHealthCheckType:function(e){return r.instance().component(this.get("uid")).set("healthCheckType",e)},setASGMin:function(e){var t;return t=this.get("uid"),r.instance().component(t).set("minSize",e),null},setASGMax:function(e){var t;return t=this.get("uid"),r.instance().component(t).set("maxSize",e),null},setASGDesireCapacity:function(e){var t;return t=this.get("uid"),r.instance().component(t).set("capacity",e),null},setASGCoolDown:function(e){return r.instance().component(this.get("uid")).set("cooldown",e)},setHealthCheckGrace:function(e){return r.instance().component(this.get("uid")).set("healthCheckGracePeriod",e)},setNotification:function(e){return r.instance().component(this.get("uid")).setNotification(e)},setTerminatePolicy:function(e){return r.instance().component(this.get("uid")).set("terminationPolicies",e),this.set("terminationPolicies",e),null},delPolicy:function(e){return r.instance().component(e).remove(),null},isDupPolicyName:function(e,t){return _.some(r.instance().component(this.get("uid")).get("policies"),function(n){if(n.id!==e&&n.get("name")===t)return!0})},defaultScalingPolicyName:function(){var t,n,i,s,o;t=r.instance().component(this.get("uid")),t.type==="ExpandedAsg"&&(t=t.get("originalAsg")),o=t.get("policies"),n=o.length,s=""+this.attributes.name+"-policy-"+n,i=_.map(o,function(e){return e.get("name")});while(e.call(i,s)>=0)s=""+this.attributes.name+"-policy-"+ ++n;return s},getPolicy:function(e){var t;return t=$.extend(!0,{},r.instance().component(e).attributes),t.cooldown=Math.round(t.cooldown/60),t.alarmData.period=Math.round(t.alarmData.period/60),t},setPolicy:function(e){var t,i,s,o;return s=r.instance().component(this.get("uid")),s.type==="ExpandedAsg"&&(s=s.get("originalAsg")),e.sendNotification&&r.modelClassForType(n.RESTYPE.TOPIC).ensureExistence(),e.uid?(o=r.instance().component(e.uid),i=e.alarmData,o.setAlarm(i),delete e.alarmData,o.set(e),e.alarmData=i):(t=r.modelClassForType(n.RESTYPE.SP),o=new t(e),s.addScalingPolicy(o),e.uid=o.id,this.get("policies").push(o.toJSON())),null}}),new i})}.call(this),define("module/design/property/asg/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP_ASG_SUMMARY",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP_ASG_NAME",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.awsResName,typeof i===a?i.apply(e):i))+'</dd>\n      <dt>Auto Scaling Group ARN</dt>\n      <dd class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_TIP_CLICK_TO_SELECT",{hash:{},data:t}))+'">'+u((i=e&&e.arn,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_ASG_CREATE_TIME",{hash:{},data:t}))+"</dt>\n      <dd>"+u(n.timeStr.call(e,e&&e.createTime,{hash:{},data:t}))+"</dd>\n\n    ",i=n["if"].call(e,e&&e.isEditable,{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n  </div>\n  ",r}function c(e,t){return"\n    </dl>\n    "}function h(e,t){var r="",i;return r+="\n      <dt>"+u(n.i18n.call(e,"PROP_LC_TITLE",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.lcName,typeof i===a?i.apply(e):i))+'</dd>\n    </dl>\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP_ASG_MIN_SIZE",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.minSize,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_ASG_MAX_SIZE",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.maxSize,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_ASG_DESIRE_CAPACITY",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.capacity,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_ASG_COOL_DOWN",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.cooldown,typeof i===a?i.apply(e):i))+'</dd>\n    </dl>\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP_ASG_HEALTH_CHECK_TYPE",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.healCheckType,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP_ASG_HEALTH_CHECK_CRACE_PERIOD",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.healthCheckGracePeriod,typeof i===a?i.apply(e):i))+"</dd>\n    </dl>\n    ",r}function p(e,t){var n="",r;return n+='\n  <div class="property-control-group">\n    <p class="property-info tac">Auto Scaling Group '+u((r=e&&e.name,typeof r===a?r.apply(e):r))+" is deleted in stopped app.</p>\n  </div>\n  ",n}function d(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP_ASG_DETAILS",{hash:{},data:t}))+'</div>\n  <div class="option-group" data-bind="true">\n    <section class="property-control-group clearfix">\n      <div class="left property-asg-size">\n        <label class="left" for="property-asg-min">'+u(n.i18n.call(e,"PROP_ASG_MIN_SIZE",{hash:{},data:t}))+'</label>\n        <input class="input" type="text" id="property-asg-min" value="'+u((i=e&&e.minSize,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true" data-required-rollback="true">\n      </div>\n      <div class="right property-asg-size">\n        <label class="left" for="property-asg-max">'+u(n.i18n.call(e,"PROP_ASG_MAX_SIZE",{hash:{},data:t}))+'</label>\n        <input class="input" type="text" id="property-asg-max" value="'+u((i=e&&e.maxSize,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true" data-required-rollback="true">\n      </div>\n    </section>\n\n    <section class="property-control-group property-asg-size">\n      <label class="left" for="property-asg-capacity">'+u(n.i18n.call(e,"PROP_ASG_DESIRE_CAPACITY",{hash:{},data:t}))+'</label>\n      <input class="input" type="text" id="property-asg-capacity" value="'+u((i=e&&e.capacity,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true">\n    </section>\n\n    <section class="property-control-group">\n      <label class="left" for="property-asg-cooldown">'+u(n.i18n.call(e,"PROP_ASG_COOL_DOWN",{hash:{},data:t}))+'</label>\n      <input class="input input-short" type="text" id="property-asg-cooldown" value="'+u((i=e&&e.cooldown,typeof i===a?i.apply(e):i))+'" data-type="digits" max="86400">\n      <span>'+u(n.i18n.call(e,"PROP_ASG_UNIT_SECONDS",{hash:{},data:t}))+'</span>\n    </section>\n\n    <section class="property-control-group clearfix">\n      <label clas="left">'+u(n.i18n.call(e,"PROP_ASG_HEALTH_CHECK_TYPE",{hash:{},data:t}))+'</label>\n      <div class="asg-radio-group">\n        <div class="radio">\n          <input id="property-asg-ec2" type="radio" value="ec2" ',i=n["if"].call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+=' name="property-asg-hc-option" />\n          <label for="property-asg-ec2"></label>\n        </div>\n        <label for="property-asg-ec2">EC2</label>\n      </div>\n      <div ',i=n.unless.call(e,e&&e.has_elb,{hash:{},inverse:f.program(13,g,t),fn:f.program(11,m,t),data:t});if(i||i===0)r+=i;r+='>\n        <div class="radio">\n          <input id="property-asg-elb" type="radio" ',i=n.unless.call(e,e&&e.has_elb,{hash:{},inverse:f.noop,fn:f.program(15,y,t),data:t});if(i||i===0)r+=i;r+=' value="elb" ',i=n.unless.call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+=' name="property-asg-hc-option" />\n          <label for="property-asg-elb"></label>\n        </div>\n        <label for="property-asg-elb">ELB</label>\n        <p id="property-asg-elb-warn" class="hide property-info" ',i=n.unless.call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(17,b,t),data:t});if(i||i===0)r+=i;return r+=">"+u(n.i18n.call(e,"PROPERTY_ASG_ELB_WARN",{hash:{},data:t}))+'</p>\n      </div>\n    </section>\n\n    <section class="property-control-group">\n      <label class="left" for="property-asg-healthcheck">'+u(n.i18n.call(e,"PROP_ASG_HEALTH_CHECK_CRACE_PERIOD",{hash:{},data:t}))+'</label>\n      <input class="input input-short" type="text" id="property-asg-healthcheck" value="'+u((i=e&&e.healthCheckGracePeriod,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true">\n      <span>'+u(n.i18n.call(e,"PROP_ASG_UNIT_SECONDS",{hash:{},data:t}))+"</span>\n    </section>\n\n  </div>\n  ",r}function v(e,t){return'checked="true"'}function m(e,t){var r="";return r+='data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_HAS_ELB_WARN",{hash:{},data:t}))+'" class="asg-radio-group tooltip"',r}function g(e,t){return'class="asg-radio-group"'}function y(e,t){return'disabled="disabled"'}function b(e,t){return' style="display: block"'}function w(e,t){var r="",i;r+='\n    <div class="option-group-head">'+u(n.i18n.call(e,"PROP_ASG_INSTANCE",{hash:{},data:t}))+' <span class="property-head-num-wrap">('+u((i=e&&e.instance_count,typeof i===a?i.apply(e):i))+')</span></div>\n    <div class="option-group">\n      ',i=n.each.call(e,e&&e.instance_groups,{hash:{},inverse:f.noop,fn:f.program(20,E,t),data:t});if(i||i===0)r+=i;return r+="\n    </div>\n  ",r}function E(e,t){var r="",i;r+='\n      <div class="property-group-head">'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'</div>\n      <ul class="property-list">\n        ',i=n.each.call(e,e&&e.instances,{hash:{},inverse:f.noop,fn:f.program(21,S,t),data:t});if(i||i===0)r+=i;return r+="\n      </ul>\n      ",r}function S(e,t){var n="",r;return n+='\n          <li><i class="status status-'+u((r=e&&e.status,typeof r===a?r.apply(e):r))+' icon-label tooltip" data-tooltip="'+u((r=e&&e.healthy,typeof r===a?r.apply(e):r))+'" ></i>'+u((r=e&&e.name,typeof r===a?r.apply(e):r))+"</li>\n        ",n}function x(e,t){var r="",i;r+='\n      <section class="property-control-group pos-r">\n        <h5>'+u(n.i18n.call(e,"PROP_ASG_TERMINATION_POLICY",{hash:{},data:t}))+'</h5>\n        <p class="termination-policy-brief">'+u(n.emptyStr.call(e,e&&e.term_policy_brief,{hash:{},data:t}))+'</p>\n      </section>\n      <ul id="property-asg-policies" class="property-list">\n        ',i=n.each.call(e,e&&e.policies,{hash:{},inverse:f.noop,fn:f.program(24,T,t),data:t});if(i||i===0)r+=i;return r+="\n      </ul>\n    ",r}function T(e,t){var r="",i;r+='\n          <li class="pos-r" data-uid="'+u((i=e&&e.uid,typeof i===a?i.apply(e):i))+'">\n            <div class="property-asg-policy-name" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_NAME",{hash:{},data:t}))+'">'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+"</div>\n            ",i=n["if"].call(e,e&&e.arn,{hash:{},inverse:f.program(27,C,t),fn:f.program(25,N,t),data:t});if(i||i===0)r+=i;return r+="\n\n          </li>\n\n        ",r}function N(e,t){var r="",i;return r+='\n            <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_TIP_CLICK_TO_SELECT",{hash:{},data:t}))+'">'+u((i=e&&e.arn,typeof i===a?i.apply(e):i))+"</div>\n            ",r}function C(e,t){var r="",i;return r+='\n            <span class="asg-p-metric asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ALARM_METRIC",{hash:{},data:t}))+'">'+u((i=e&&e.metric,typeof i===a?i.apply(e):i))+'</span>\n            <span class="asg-p-eval asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_THRESHOLD",{hash:{},data:t}))+'">'+u((i=e&&e.evaluation,typeof i===a?i.apply(e):i))+" "+u((i=e&&e.threshold,typeof i===a?i.apply(e):i))+u((i=e&&e.unit,typeof i===a?i.apply(e):i))+'</span>\n            <span class="asg-p-periods asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_PERIOD",{hash:{},data:t}))+'">'+u((i=e&&e.periods,typeof i===a?i.apply(e):i))+"x"+u((i=e&&e.minute,typeof i===a?i.apply(e):i))+'m</span>\n            <span class="asg-p-trigger asg-p-tag asg-p-trigger-'+u((i=e&&e.trigger,typeof i===a?i.apply(e):i))+'" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ACTION",{hash:{},data:t}))+'">'+u((i=e&&e.trigger,typeof i===a?i.apply(e):i))+'</span>\n            <span class="asg-p-adjust asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ADJUSTMENT",{hash:{},data:t}))+'">'+u((i=e&&e.adjustment,typeof i===a?i.apply(e):i))+" "+u((i=e&&e.adjusttype,typeof i===a?i.apply(e):i))+"</span>\n            ",r}function k(e,t){var r="",i;r+='\n      <section class="property-control-group pos-r property-term-p">\n        <h5>'+u(n.i18n.call(e,"PROP_ASG_TERMINATION_POLICY",{hash:{},data:t}))+'</h5>\n        <div class="termination-policy-brief">'+u((i=e&&e.term_policy_brief,typeof i===a?i.apply(e):i))+'</div>\n        <div class="asg-p-action"><i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_TERMINATION_EDIT",{hash:{},data:t}))+'" id="property-asg-term-edit"></i></div>\n      </section>\n      <ul id="property-asg-policies" class="property-list">\n        <li class="pos-r hide">\n          <h5 class="property-asg-policy-name name"></h5>\n          <span class="asg-p-metric asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ALARM_METRIC",{hash:{},data:t}))+'"></span>\n          <span class="asg-p-eval asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_THRESHOLD",{hash:{},data:t}))+'"></span>\n          <span class="asg-p-periods asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_PERIOD",{hash:{},data:t}))+'"></span>\n          <span class="asg-p-trigger asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ACTION",{hash:{},data:t}))+'"></span>\n          <span class="asg-p-adjust asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ADJUSTMENT",{hash:{},data:t}))+'"></span>\n          <div class="asg-p-action">\n            <i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_EDIT",{hash:{},data:t}))+'"></i>\n            <i class="icon-remove icon-del tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_REMOVE",{hash:{},data:t}))+'"></i>\n          </div>\n        </li>\n        ',i=n.each.call(e,e&&e.policies,{hash:{},inverse:f.noop,fn:f.program(30,L,t),data:t});if(i||i===0)r+=i;r+='\n\n      </ul>\n      <div class="property-control-group tac">\n        <button class="btn btn-blue ',i=n.unless.call(e,e&&e.can_add_policy,{hash:{},inverse:f.noop,fn:f.program(32,A,t),data:t});if(i||i===0)r+=i;return r+='" id="property-asg-policy-add" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_TIP_YOU_CAN_ONLY_ADD_25_SCALING_POLICIES",{hash:{},data:t}))+'">'+u(n.i18n.call(e,"PROP_ASG_BTN_ADD_SCALING_POLICY",{hash:{},data:t}))+"</button>\n      </div>\n    ",r}function L(e,t){var r="",i;return r+='\n        <li class="pos-r" data-uid="'+u((i=e&&e.id,typeof i===a?i.apply(e):i))+'" data-old="true">\n          <h5 class="property-asg-policy-name name" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_NAME",{hash:{},data:t}))+'">'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'</h5>\n          <span class="asg-p-metric asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ALARM_METRIC",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.metricName),typeof i===a?i.apply(e):i))+'</span>\n          <span class="asg-p-eval asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_THRESHOLD",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.comparisonOperator),typeof i===a?i.apply(e):i))+" "+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.threshold),typeof i===a?i.apply(e):i))+u((i=e&&e.unit,typeof i===a?i.apply(e):i))+'</span>\n          <span class="asg-p-periods asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_PERIOD",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.evaluationPeriods),typeof i===a?i.apply(e):i))+"x"+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.period),typeof i===a?i.apply(e):i))+'m</span>\n          <span class="asg-p-trigger asg-p-tag asg-p-trigger-'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ACTION",{hash:{},data:t}))+'">'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'</span>\n          <span class="asg-p-adjust asg-p-tag" title="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_ADJUSTMENT",{hash:{},data:t}))+'">'+u((i=e&&e.adjustment,typeof i===a?i.apply(e):i))+" "+u((i=e&&e.adjustmentType,typeof i===a?i.apply(e):i))+'</span>\n          <div class="asg-p-action">\n            <i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_EDIT",{hash:{},data:t}))+'"></i>\n            <i class="icon-remove icon-del tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP_ASG_POLICY_TLT_REMOVE",{hash:{},data:t}))+'"></i>\n          </div>\n        </li>\n        ',r}function A(e,t){return"disabled tooltip"}function O(e,t){var r="",i;r+='\n      <div class="property-asg-notification-wrap property-control-group">\n        ',i=n["if"].call(e,e&&e.sendNotify,{hash:{},inverse:f.program(46,j,t),fn:f.program(35,M,t),data:t});if(i||i===0)r+=i;return r+="\n      </div>\n\n    ",r}function M(e,t){var r="",i;r+="\n        <label>"+u(n.i18n.call(e,"PROP_ASG_LBL_SEND_NOTIFICATION",{hash:{},data:t}))+"</label>\n        <section>\n          ",i=n["if"].call(e,(i=e&&e.notifies,i==null||i===!1?i:i[0]),{hash:{},inverse:f.noop,fn:f.program(36,_,t),data:t});if(i||i===0)r+=i;r+="\n          ",i=n["if"].call(e,(i=e&&e.notifies,i==null||i===!1?i:i[1]),{hash:{},inverse:f.noop,fn:f.program(38,D,t),data:t});if(i||i===0)r+=i;r+="\n          ",i=n["if"].call(e,(i=e&&e.notifies,i==null||i===!1?i:i[2]),{hash:{},inverse:f.noop,fn:f.program(40,P,t),data:t});if(i||i===0)r+=i;r+="\n          ",i=n["if"].call(e,(i=e&&e.notifies,i==null||i===!1?i:i[3]),{hash:{},inverse:f.noop,fn:f.program(42,H,t),data:t});if(i||i===0)r+=i;r+="\n          ",i=n["if"].call(e,(i=e&&e.notifies,i==null||i===!1?i:i[4]),{hash:{},inverse:f.noop,fn:f.program(44,B,t),data:t});if(i||i===0)r+=i;return r+="\n        </section>\n        ",r}function _(e,t){var r="";return r+="<p>"+u(n.i18n.call(e,"PROP_ASG_LBL_SUCCESS_INSTANCES_LAUNCH",{hash:{},data:t}))+"</p>",r}function D(e,t){var r="";return r+="<p>"+u(n.i18n.call(e,"PROP_ASG_LBL_FAILED_INSTANCES_LAUNCH",{hash:{},data:t}))+"</p>",r}function P(e,t){var r="";return r+="<p>"+u(n.i18n.call(e,"PROP_ASG_LBL_SUCCESS_INSTANCES_TERMINATE",{hash:{},data:t}))+"</p>",r}function H(e,t){var r="";return r+="<p>"+u(n.i18n.call(e,"PROP_ASG_LBL_FAILED_INSTANCES_TERMINATE",{hash:{},data:t}))+"</p>",r}function B(e,t){var r="";return r+="<p>"+u(n.i18n.call(e,"PROP_ASG_LBL_VALIDATE_SNS",{hash:{},data:t}))+"</p>",r}function j(e,t){var r="";return r+='\n        <p class="property-info tac">'+u(n.i18n.call(e,"PROP_ASG_MSG_NO_NOTIFICATION_WARN",{hash:{},data:t}))+"</p>\n        ",r}function F(e,t){var r="",i;r+='\n      <div class="property-control-group property-asg-notification-wrap">\n        <p>'+u(n.i18n.call(e,"PROP_ASG_LBL_SEND_NOTIFICATION",{hash:{},data:t}))+'</p>\n        <div><div class="checkbox">\n          <input id="property-asg-sns1" type="checkbox" data-key="instanceLaunch" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceLaunch),{hash:{},inverse:f.noop,fn:f.program(49,I,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="property-asg-sns1"></label>\n        </div>\n        <label for="property-asg-sns1">'+u(n.i18n.call(e,"PROP_ASG_LBL_SUCCESS_INSTANCES_LAUNCH",{hash:{},data:t}))+'</label></div>\n\n        <div><div class="checkbox">\n          <input id="property-asg-sns2" type="checkbox" data-key="instanceLaunchError" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceLaunchError),{hash:{},inverse:f.noop,fn:f.program(49,I,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="property-asg-sns2"></label>\n        </div>\n        <label for="property-asg-sns2">'+u(n.i18n.call(e,"PROP_ASG_LBL_FAILED_INSTANCES_LAUNCH",{hash:{},data:t}))+'</label></div>\n\n        <div><div class="checkbox">\n          <input id="property-asg-sns3" type="checkbox" data-key="instanceTerminate" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceTerminate),{hash:{},inverse:f.noop,fn:f.program(49,I,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="property-asg-sns3"></label>\n        </div>\n        <label for="property-asg-sns3">'+u(n.i18n.call(e,"PROP_ASG_LBL_SUCCESS_INSTANCES_TERMINATE",{hash:{},data:t}))+'</label></div>\n\n        <div><div class="checkbox">\n          <input id="property-asg-sns4" type="checkbox" data-key="instanceTerminateError" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceTerminateError),{hash:{},inverse:f.noop,fn:f.program(49,I,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="property-asg-sns4"></label>\n        </div>\n        <label for="property-asg-sns4">'+u(n.i18n.call(e,"PROP_ASG_LBL_FAILED_INSTANCES_TERMINATE",{hash:{},data:t}))+'</label></div>\n\n        <div><div class="checkbox">\n          <input id="property-asg-sns5" type="checkbox" data-key="test" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.test),{hash:{},inverse:f.noop,fn:f.program(49,I,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="property-asg-sns5"></label>\n        </div>\n        <label for="property-asg-sns5">'+u(n.i18n.call(e,"PROP_ASG_LBL_VALIDATE_SNS",{hash:{},data:t}))+"</label></div>\n\n        ",i=n.unless.call(e,e&&e.has_sns_sub,{hash:{},inverse:f.noop,fn:f.program(51,q,t),data:t});if(i||i===0)r+=i;return r+="\n\n      </div>\n    ",r}function I(e,t){return'checked="checked"'}function q(e,t){var r="",i;r+='\n        <p class="property-warning ',i=n.unless.call(e,e&&e.has_notification,{hash:{},inverse:f.noop,fn:f.program(52,R,t),data:t});if(i||i===0)r+=i;return r+='" id="property-asg-sns-info"> '+u(n.i18n.call(e,"PROP_ASG_MSG_SNS_WARN",{hash:{},data:t}))+" </p>\n        ",r}function R(e,t){return"hide"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n  ',o=n["if"].call(t,t&&t.hasData,{hash:{},inverse:f.program(6,p,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n["if"].call(t,t&&t.isEditable,{hash:{},inverse:f.noop,fn:f.program(8,d,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n["if"].call(t,t&&t.hasData,{hash:{},inverse:f.noop,fn:f.program(19,w,i),data:i});if(o||o===0)s+=o;s+='\n\n  <div class="option-group-head">'+u(n.i18n.call(t,"PROP_ASG_POLICY",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n\n    ',o=n.unless.call(t,t&&t.isEditable,{hash:{},inverse:f.program(29,k,i),fn:f.program(23,x,i),data:i});if(o||o===0)s+=o;s+='\n\n\n  </div>\n\n  <div class="option-group-head">'+u(n.i18n.call(t,"PROP_ASG_LBL_NOTIFICATION",{hash:{},data:i}))+'</div>\n  <div class="option-group" id="property-asg-sns">\n\n    ',o=n.unless.call(t,t&&t.isEditable,{hash:{},inverse:f.program(48,F,i),fn:f.program(34,O,i),data:i});if(o||o===0)s+=o;return s+="\n\n  </div>\n\n</article>\n",s};return e.template(t)}),function(){define("module/design/property/asg/app_view",["../base/view","./template/app","./template/policy","./template/term","i18n!nls/lang.js"],function(e,t,n,r,i){var s,o,u,a,f,l;return f={CPUUtilization:"CPU Utilization",DiskReadBytes:"Disk Reads",DiskReadOps:"Disk Read Operations",DiskWriteBytes:"Disk Writes",DiskWriteOps:"Disk Write Operations",NetworkIn:"Network In",NetworkOut:"Network Out",StatusCheckFailed:"Status Check Failed (Any)",StatusCheckFailed_Instance:"Status Check Failed (Instance)",StatusCheckFailed_System:"Status Check Failed (System)"},o={ChangeInCapacity:"Change in Capacity",ExactCapacity:"Exact Capacity",PercentChangeInCapacity:"Percent Change in Capacity"},a={ChangeInCapacity:"eg. -1",ExactCapacity:"eg. 5",PercentChangeInCapacity:"eg. -30"},u={ChangeInCapacity:"Increase or decrease existing capacity by integer you input here. A positive value adds to the current capacity and a negative value removes from the current capacity.",ExactCapacity:"Change the current capacity of your Auto Scaling group to the exact value specified.",PercentChangeInCapacity:"Increase or decrease the desired capacity by a percentage of the desired capacity. A positive value adds to the current capacity and a negative value removes from the current capacity"},l={CPUUtilization:"%",DiskReadBytes:"B",DiskWriteBytes:"B",NetworkIn:"B",NetworkOut:"B"},s=e.extend({events:{"change #property-asg-min":"setSizeGroup","change #property-asg-max":"setSizeGroup","change #property-asg-capacity":"setSizeGroup","click #property-asg-term-edit":"showTermPolicy","click #property-asg-sns input[type=checkbox]":"setNotification","change #property-asg-elb":"setHealthyCheckELBType","change #property-asg-ec2":"setHealthyCheckEC2Type","change #property-asg-cooldown":"setASGCoolDown","change #property-asg-healthcheck":"setHealthCheckGrace","click #property-asg-policy-add":"addScalingPolicy","click #property-asg-policies .icon-edit":"editScalingPolicy","click #property-asg-policies .icon-del":"delScalingPolicy"},setASGCoolDown:function(e){var t;t=$(e.target),t.parsley("custom",function(e){return _.isNumber(+e)&&+e>86400?i.ide.PARSLEY_MAX_VALUE_86400:null});if(t.parsley("validate"))return this.model.setASGCoolDown(t.val())},setHealthCheckGrace:function(e){return this.model.setHealthCheckGrace(e.target.value)},showTermPolicy:function(){var e,t,n,s,o,u,a,f,l,c,h;t=[],e={},c=this.model.get("terminationPolicies");for(u=0,f=c.length;u<f;u++)s=c[u],s==="Default"?t.useDefault=!0:(t.push({name:s,checked:!0}),e[s]=!0);h=[i.ide.PROP_ASG_TERMINATION_POLICY_OLDEST,i.ide.PROP_ASG_TERMINATION_POLICY_NEWEST,i.ide.PROP_ASG_TERMINATION_POLICY_OLDEST_LAUNCH,i.ide.PROP_ASG_TERMINATION_POLICY_CLOSEST];for(a=0,l=h.length;a<l;a++)n=h[a],e[n]||t.push({name:n,checked:!1});return modal(r(t),!0),o=this,$("#property-asg-term").on("click","input",function(){var t,n;return t=$("#property-asg-term").find("input:checked"),t.length===0?!1:(n=$(this),e=n.is(":checked"),n.closest("li").toggleClass("enabled",e))}),$("#property-asg-term-done").on("click",function(){return o.onEditTermPolicy(),modal.close()}),$("#property-asg-term").on("mousedown",".drag-handle",function(){return $(this).trigger("mouseleave")}),$("#property-term-list").sortable({handle:".drag-handle"})},onEditTermPolicy:function(){var e;return e=[],$("#property-term-list .list-name").each(function(){var t;return t=$(this),t.closest("li").hasClass("enabled")&&e.push(t.text()),null}),$("#property-asg-term-def").is(":checked")&&e.push("Default"),$(".termination-policy-brief").text(e.join(" > ")),this.model.setTerminatePolicy(e)},delScalingPolicy:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.data("uid"),t.remove(),$("#property-asg-policy-add").removeClass("tooltip disabled"),this.model.delPolicy(n)},updateScalingPolicy:function(e){var t,n,r,i,s;i=f[e.alarmData.metricName],r=o[e.adjustmentType],s=l[e.alarmData.metricName]||"";if(!e.uid){void 0;return}return n=$("#property-asg-policies"),t=n.children("[data-uid='"+e.uid+"']"),t.length===0&&(t=n.children(".hide").clone().attr("data-uid",e.uid).removeClass("hide").appendTo(n),$("#property-asg-policy-add").toggleClass("tooltip disabled",$("#property-asg-policies").children().length>=26)),t.find(".name").html(e.name),t.find(".asg-p-metric").html(i),t.find(".asg-p-eval").html(e.alarmData.comparisonOperator+" "+e.alarmData.threshold+s),t.find(".asg-p-periods").html(e.alarmData.evaluationPeriods+"x"+Math.round(e.alarmData.period/60)+"m"),t.find(".asg-p-trigger").html(e.state).attr("class","asg-p-trigger asg-p-tag asg-p-trigger-"+e.state),t.find(".asg-p-adjust").html(e.adjustment+" "+e.adjustmentType)},editScalingPolicy:function(e){var t,n,r,s,o,u,a,f,l,c,h,p,d,v;n=$(e.currentTarget).closest("li"),c=n.data("uid"),u=n.data("old"),o=this.model.getPolicy(c),o.uid=c,o.title=i.ide.PROP_ASG_ADD_POLICY_TITLE_EDIT,o.isOld=u,this.showScalingPolicy(o),l={metric:o.alarmData.metricName,eval:o.alarmData.comparisonOperator,trigger:o.state,"adjust-type":o.adjustmentType,statistics:o.alarmData.statistic};for(f in l){h=l[f],r=$("#asg-policy-"+f),s=null,v=r.find(".item");for(p=0,d=v.length;p<d;p++){a=v[p],t=$(a);if(t.data("id")===h){s=t;break}}s&&(r.find(".selected").removeClass("selected"),r.find(".selection").html(s.addClass("selected").html()))}return $(".pecentcapcity").toggle($("#asg-policy-adjust-type").find(".selected").data("id")==="PercentChangeInCapacity")},addScalingPolicy:function(e){return $(e.currentTarget).hasClass("disabled")?!1:(this.showScalingPolicy(),!1)},showScalingPolicy:function(e){var t;return e||(e={title:i.ide.PROP_ASG_ADD_POLICY_TITLE_ADD,name:this.model.defaultScalingPolicyName(),minAdjustStep:1,alarmData:{evaluationPeriods:2,period:5}}),e.alarmData&&e.alarmData.metricName?e.unit=l[e.alarmData.metricName]:e.unit="%",e.noSNS=!this.model.attributes.has_sns_sub,e.detail_monitor=this.model.attributes.detail_monitor,modal(n(e),!0),t=this,$("#property-asg-policy-done").on("click",function(){var e;return e=$("#asg-termination-policy").parsley("validate"),e===!1?!1:(t.onPolicyDone(),modal.close())}),$("#asg-policy-name").parsley("custom",function(e){var n;n=$("#property-asg-policy").data("uid");if(t.model.isDupPolicyName(n,e))return i.ide.PARSLEY_DUPLICATED_POLICY_NAME}),$("#asg-policy-periods").on("change",function(){var e;e=parseInt($(this).val(),10),(!e||e<1)&&$(this).val("1");if(e>86400)return $(this).val(86400)}),$("#asg-policy-second").on("change",function(){var e;e=parseInt($(this).val(),10),(!e||e<1)&&$(this).val("1");if(e>1440)return $(this).val(1440)}),$("#asg-policy-adjust-type").on("OPTION_CHANGE",function(){var e;return e=$(this).find(".selected").data("id"),$(".pecentcapcity").toggle(e==="PercentChangeInCapacity"),$("#asg-policy-adjust").attr("placeholder",a[e]).data("tooltip",u[e]).trigger("change")}),$("#asg-policy-adjust").on("change",function(){var e,t;return e=$("#asg-policy-adjust-type").find(".selected").data("id"),t=parseInt($(this).val(),10),e==="ExactCapacity"?(!t||t<1)&&$(this).val("1"):e==="PercentChangeInCapacity"&&(t?t<-100&&$(this).val("-100"):$(this).val("0")),t<-65534?$(this).val(-65534):t>65534&&$(this).val(65534),$("#").data("tooltip",u[e]).trigger("change")}),$("#asg-policy-cooldown").on("change",function(){var e,t;e=$("#asg-policy-cooldown"),t=parseInt(e.val(),10);if(isNaN(t))return;return t<0?t=0:t>1440&&(t=1440),e.val(t)}),$("#asg-policy-step").on("change",function(){var e,t;e=$("#asg-policy-step"),t=parseInt(e.val(),10);if(isNaN(t))return;return t<0?t=0:t>65534&&(t=65534),e.val(t)}),$("#asg-policy-threshold").on("change",function(){var e,t;e=$("#asg-policy-metric .selected").data("id"),t=parseInt($(this).val(),10);if(e==="CPUUtilization"){if(isNaN(t)||t<1)return $(this).val("1");if(t>100)return $(this).val("100")}}),$("#asg-policy-notify").on("click",function(e){return $("#asg-policy-no-sns").toggle($("#asg-policy-notify").is(":checked")),e.stopPropagation(),null}),$("#asg-policy-metric").on("OPTION_CHANGE",function(){return $("#asg-policy-unit").html(l[$(this).find(".selected").data("id")]||""),$("#asg-policy-threshold").val("")}),null},onPolicyDone:function(){var e;return e={uid:$("#property-asg-policy").data("uid"),name:$("#asg-policy-name").val(),cooldown:$("#asg-policy-cooldown").val()*60,minAdjustStep:$("#asg-policy-step").val(),adjustment:$("#asg-policy-adjust").val(),adjustmentType:$("#asg-policy-adjust-type .selected").data("id"),state:$("#asg-policy-trigger .selected").data("id"),sendNotification:$("#asg-policy-notify").is(":checked"),alarmData:{metricName:$("#asg-policy-metric .selected").data("id"),comparisonOperator:$("#asg-policy-eval .selected").data("id"),period:$("#asg-policy-second").val()*60,evaluationPeriods:$("#asg-policy-periods").val(),statistic:$("#asg-policy-statistics .selected").data("id"),threshold:$("#asg-policy-threshold").val()}},this.model.setPolicy(e),this.updateScalingPolicy(e),null},setNotification:function(){var e,t;return e={},t=!1,$("#property-asg-sns input[type = checkbox]").each(function(){var n;return n=$(this).is(":checked"),e[$(this).attr("data-key")]=n,n&&(t=!0),null}),t?$("#property-asg-sns-info").show():$("#property-asg-sns-info").hide(),this.model.setNotification(e)},setHealthyCheckELBType:function(e){return this.model.setHealthCheckType("ELB"),$("#property-asg-elb-warn").toggle($("#property-asg-elb").is(":checked"))},setHealthyCheckEC2Type:function(e){return this.model.setHealthCheckType("EC2"),$("#property-asg-elb-warn").toggle($("#property-asg-elb").is(":checked"))},render:function(){var e,n,r,i,s;e=this.model.toJSON();if(e.isEditable){s=e.policies;for(r=0,i=s.length;r<i;r++)n=s[r],n.alarmData.metricName=f[n.alarmData.metricName],n.unit=l[n.alarmData.metricName],n.adjustmentType=o[n.adjustmentType],n.isNew=!n.appId;e.term_policy_brief=e.terminationPolicies.join(" > "),e.can_add_policy=e.policies.length<25}return this.$el.html(t(e)),e.name},setSizeGroup:function(e){var t,n,r;r=this.$el.find("#property-asg-min"),n=this.$el.find("#property-asg-max"),t=this.$el.find("#property-asg-capacity"),r.parsley("custom",function(e){if(+e<1)return i.ide.PARSLEY_ASG_SIZE_MUST_BE_EQUAL_OR_GREATER_THAN_1;if(+e>+n.val())return i.ide.PARSLEY_MINIMUM_SIZE_MUST_BE_LESSTHAN_MAXIMUM_SIZE}),n.parsley("custom",function(e){if(+e<1)return i.ide.PARSLEY_ASG_SIZE_MUST_BE_EQUAL_OR_GREATER_THAN_1;if(+e<+r.val())return i.ide.PARSLEY_MINIMUM_SIZE_MUST_BE_LESSTHAN_MAXIMUM_SIZE}),t.parsley("custom",function(e){if(+e<1)return i.ide.PARSLEY_DESIRED_CAPACITY_EQUAL_OR_GREATER_1;if(+e<+r.val()||+e>+n.val())return i.ide.PARSLEY_DESIRED_CAPACITY_IN_ALLOW_SCOPE});if($(e.currentTarget).parsley("validateForm"))return this.model.setASGMin(r.val()),this.model.setASGMax(n.val()),this.model.setASGDesireCapacity(t.val())}}),new s})}.call(this),function(){define("module/design/property/asg/main",["../base/main","./model","./view","constant","./app_model","./app_view"],function(e,t,n,r,i,s){var o;return o=e.extend({handleTypes:[r.RESTYPE.ASG,"ExpandedAsg"],initStack:function(){return this.model=t,this.view=n,null},initApp:function(){return this.model=i,this.model.isAppEdit=!1,this.view=s,null},initAppEdit:function(){return this.model=i,this.model.isAppEdit=!0,this.view=s,null}}),null})}.call(this),function(){define("property",["event","constant","MC","./module/design/property/view","./module/design/property/base/main","./module/design/property/base/view","Design","i18n!nls/lang.js","./module/design/property/stack/main","./module/design/property/instance/main","./module/design/property/servergroup/main","./module/design/property/connection/main","./module/design/property/staticsub/main","./module/design/property/missing/main","./module/design/property/sg/main","./module/design/property/sgrule/main","./module/design/property/volume/main","./module/design/property/elb/main","./module/design/property/az/main","./module/design/property/subnet/main","./module/design/property/vpc/main","./module/design/property/rtb/main","./module/design/property/static/main","./module/design/property/cgw/main","./module/design/property/vpn/main","./module/design/property/eni/main","./module/design/property/acl/main","./module/design/property/launchconfig/main","./module/design/property/asg/main"],function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v;return v=null,a=function(){return v=new r,e.trigger(e.DESIGN_SUB_COMPLETE),e.onLongListen(e.REFRESH_PROPERTY,function(){return $canvas($canvas.selected_node()).select(),null}),e.onLongListen(e.FORCE_OPEN_PROPERTY,function(e){return v.forceShow(e),null}),s.event.on(s.event.FORCE_SHOW,function(e){return v.forceShow(e),null}),s.event.on(s.event.OPEN_SUBPANEL_IMM,function(){return v.immShowSecondPanel(),null}),i.event.on(i.event.HIDE_SUB_PANEL,function(){return v.immHideSecondPanel(),null}),s.event.on(s.event.OPEN_SUBPANEL,function(){return v.showSecondPanel(),null}),e.onLongListen(e.SHOW_STATE_EDITOR,function(e){return v.renderState(e,null,!0),null}),v.on("HIDE_SUBPANEL",function(){return i.onUnloadSubPanel(),null}),v.on("GET_CURRENT_UID",function(e){var t;return t=i.activeModule(),e.uid=t?t.uid:"",null}),e.onLongListen(e.OPEN_PROPERTY,f)},f=function(e,t,n,r){var i;i=v.processState(t,e);if(l(r,t))return;return v.currentTab==="state"&&i?(v.renderState(t,e),d(t,e),null):v.renderProperty(t,e,n)},d=function(e,t){var n;return n=i.activeModule(),n.uid=e,n.comType=t,null},l=function(e,t){return e==="property"?(v.renderProperty(t),!0):e==="state"?(v.renderState(t),!0):!1},p=function(){return null},h=function(){return i.snapshot(v)},c=function(e){return v.restore(e),i.restore(e,v)},{loadModule:a,unLoadModule:p,snapshot:h,restore:c}})}.call(this);