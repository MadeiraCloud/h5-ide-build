define("workspaces/osdashboard/DashboardTpl",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div>\n\n<header class="dash-header">\n  <button class="icon-refresh" id="OsReloadResource">'+o(n.i18n.call(t,"DASH_TPL_JUST_NOW",{hash:{},data:i}))+'</button>\n  <button class="btn btn-primary icon-new-stack">'+o(n.i18n.call(t,"DASH_CREATE_NEW_STACK",{hash:{},data:i}))+'</button>\n</header>\n\n<div class="dash-body nano"> <div class="nano-content">\n\n  <section class="dash-ops-list-wrapper">\n    <nav>\n      <button class="on stack ops-list-switcher"><span class="count"></span> <small>'+o(n.i18n.call(t,"DASH_LBL_STACK",{hash:{},data:i}))+'</small></button>\n      <button class="ops-list-switcher"><span class="count">0</span> <small>'+o(n.i18n.call(t,"DASH_LBL_APP",{hash:{},data:i}))+'</small></button>\n    </nav>\n    <ul class="clearfix dash-ops-list"></ul>\n  </section>\n  <section class="dash-ops-resource-list"></section>\n\n</div></div>\n\n</div>',s},n.frame=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='<li data-id="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'">',i=n["if"].call(e,e&&e.progressing,{hash:{},inverse:o.program(5,h,t),fn:o.program(2,l,t),data:t});if(i||i===0)r+=i;return r+="</li>\n",r}function l(e,t){var r="",i;r+='\n  <div class="thumbnail app-thumbnail"></div>\n  <div class="region-resource-progess',i=n.unless.call(e,e&&e.progress,{hash:{},inverse:o.noop,fn:o.program(3,c,t),data:t});if(i||i===0)r+=i;return r+='" style="width:'+a((i=e&&e.progress,typeof i===u?i.apply(e):i))+'%;"></div>\n  <div class="region-resource-info truncate">\n      <div class="loading-spinner loading-spinner-small"></div>'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+" - "+a((i=e&&e.stateDesc,typeof i===u?i.apply(e):i))+"...\n  </div>\n",r}function c(e,t){return" hide"}function h(e,t){var r="",i;r+="\n  ",i=n["if"].call(e,e&&e.usage,{hash:{},inverse:o.noop,fn:o.program(6,p,t),data:t});if(i||i===0)r+=i;r+='\n  <div class="thumbnail app-thumbnail"><img src="'+a((i=e&&e.thumbnail,typeof i===u?i.apply(e):i))+'" ',i=n.unless.call(e,e&&e.thumbnail,{hash:{},inverse:o.noop,fn:o.program(8,d,t),data:t});if(i||i===0)r+=i;r+='/></div>\n  <div class="region-resource-info">\n    <i class="icon-terminate terminate-app"></i>\n    ',i=n.ifCond.call(e,e&&e.stateDesc,"Running",{hash:{},inverse:o.program(12,m,t),fn:o.program(10,v,t),data:t});if(i||i===0)r+=i;r+='\n    <span class="',i=n.ifCond.call(e,e&&e.stateDesc,"Running",{hash:{},inverse:o.program(16,y,t),fn:o.program(14,g,t),data:t});if(i||i===0)r+=i;return r+=' truncate">'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+"</span>\n  </div>\n",r}function p(e,t){var n="",r;return n+='<i class="icon-app-type-'+a((r=e&&e.usage,typeof r===u?r.apply(e):r))+'"></i>',n}function d(e,t){return'class="hide"'}function v(e,t){return'<i class="icon-stop stop-app"></i>'}function m(e,t){return'<i class="icon-play start-app"></i>'}function g(e,t){return"running"}function y(e,t){return"stopped"}function b(e,t){var r="";return r+='\n  <div class="blank-widget"><div>'+a(n.i18n.call(e,"DASH_LBL_NO_APP",{hash:{},data:t}))+"</div></div>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this,u="function",a=this.escapeExpression;return s=n.each.call(t,t,{hash:{},inverse:o.program(18,b,i),fn:o.program(1,f,i),data:i}),s||s===0?s:""},n.appList=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='<li data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'">\n    <div class="thumbnail"><img src="'+u((i=e&&e.thumbnail,typeof i===o?i.apply(e):i))+'" ',i=n.unless.call(e,e&&e.thumbnail,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+='/></div>\n    <div class="region-resource-info">\n      <i class="icon-delete delete-stack"></i>\n      <i class="icon-duplicate duplicate-stack"></i>\n      <span class="truncate">'+u((i=e&&e.name,typeof i===o?i.apply(e):i))+"</span>\n    </div>\n  </li>\n",r}function l(e,t){return'class="hide"'}function c(e,t){var r="";return r+='\n  <div class="blank-widget"><div>'+u(n.i18n.call(e,"DASH_LBL_NO_STACK",{hash:{},data:t}))+"</div></div>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t,{hash:{},inverse:a.program(4,c,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.stackList=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<nav class="clearfix resource-list-nav">\n  <div class="resource-tab servers on" data-type="OSSERVER">\n    <span class="resource-count">Server</span>\n    <p class="count"><span class="count-usage">-</span><span class="count-quota">-</span></p>\n  </div>\n  <div class="resource-tab volumes" data-type="OSVOL">\n    <span class="resource-count">Volume</span>\n    <p class="count"><span class="count-usage">-</span><span class="count-quota">-</span></p>\n\n  </div>\n  <div class="resource-tab snaps" data-type="OSSNAP">\n    <span class="resource-count">Snapshot</span>\n    <p class="count"><span class="count-usage">-</span><span class="count-quota">-</span></p>\n  </div>\n  <div class="resource-tab fips" data-type="OSFIP">\n    <span class="resource-count">Floating IP</span>\n    <p class="count"><span class="count-usage">-</span><span class="count-quota">-</span></p>\n  </div>\n  <div class="resource-tab rts" data-type="OSRT">\n    <span class="resource-count">Router</span>\n    <p class="count"><span class="count-usage">-</span><span class="count-quota">-</span></p>\n\n  </div>\n  <div class="resource-tab elbs" data-type="OSLISTENER">\n    <span class="resource-count">Load Balancer</span>\n    <p class="count"><span class="count-usage">-</span><span class="count-quota">-</span></p>\n\n  </div>\n</nav>\n<div class="resource-list-body table-head-fix"></div>'},n.resourceList=e.template(t),n}),define("workspaces/osdashboard/DashboardTplData",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+="<dt>"+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</dt><dd>"+a(typeof e===u?e.apply(e):e)+"</dd>",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="bubble-head">'+a((o=t&&t.id,typeof o===u?o.apply(t):o))+'</div>\n<div class="bubble-content">\n<dl class="dl-horizontal">',o=n.each.call(t,t&&t.data,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="</dl>\n</div>",s},n.bubbleResourceInfo=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+="\n              <tr>\n                  <td>\n                    <div>"+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'</div>\n                  </td>\n                  <td class="os-status os-status-'+a((i=e&&e.status,typeof i===u?i.apply(e):i))+'">'+a((i=e&&e.status,typeof i===u?i.apply(e):i))+'</td>\n                  <td><img src="/assets/images/ide/ami/openstack/'+a((i=(i=e&&e.system_metadata,i==null||i===!1?i:i.image_os_distro),typeof i===u?i.apply(e):i))+"."+a((i=(i=e&&e.system_metadata,i==null||i===!1?i:i.image_architecture),typeof i===u?i.apply(e):i))+'.png">\n            <span class="bubble" data-bubble-template="osDashboardBubble" data-bubble-data="{&quot;type&quot;:&quot;OSSERVER&quot;,&quot;id&quot;:&quot;'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'&quot;}">'+a((i=(i=e&&e.system_metadata,i==null||i===!1?i:i.image_image_name),typeof i===u?i.apply(e):i))+"</span></td>\n                  <td>"+a((i=e&&e.accessIPv4,typeof i===u?i.apply(e):i))+"</td>\n                  <td>"+a(n.timeStr.call(e,e&&e["OS-SRV-USG:launched_at"],{hash:{},data:t}))+"</td>\n              </tr>\n          ",r}function c(e,t){var r="";return r+='\n              <div class="blank-widget">'+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_LEFT",{hash:{},data:t}))+"Server"+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_RIGHT",{hash:{},data:t}))+".</div>\n          ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table-head">\n    <thead>\n    <tr>\n        <th class="sortable">Name</th>\n        <th class="sortable" style="width:10%">Status</th>\n        <th class="sortable" style="width:32%">'+a(n.i18n.call(t,"DASH_LBL_AMI",{hash:{},data:i}))+'</th>\n        <th class="sortable" style="width:12%">'+a(n.i18n.call(t,"DASH_LBL_PUBLIC_IP",{hash:{},data:i}))+'</th>\n        <th class="sortable" style="width:18%" data-row-type="datetime">'+a(n.i18n.call(t,"DASH_LBL_LAUNCH_TIME",{hash:{},data:i}))+'</th>\n    </tr>\n    </thead>\n</table>\n<div class="scroll-wrap">\n  <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n  <div class="scroll-content">\n    <table class="table">\n        <thead>\n            <tr>\n                <th></th>\n                <th style="width: 10%"></th>\n                <th style="width: 32%"></th>\n                <th style="width: 12%"></th>\n                <th style="width: 18%"></th>\n            </tr>\n        </thead>\n      <tbody>\n          ',o=n.each.call(t,t&&t.servers,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n      </tbody>\n    </table>\n  </div>\n</div>",s},n.resource_OSSERVER=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n              <tr>\n                  <td>\n                    <div>"+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'</div>\n                  </td>\n                  <td class="os-status os-status-'+a((i=e&&e.status,typeof i===u?i.apply(e):i))+'">'+a((i=e&&e.status,typeof i===u?i.apply(e):i))+"</td>\n                  <td>"+a((i=e&&e.size,typeof i===u?i.apply(e):i))+" GiB</td>\n                  <td>",i=n.each.call(e,e&&e.attachments,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="</td>\n                  <td>"+a(n.timeStr.call(e,e&&e.created_at,{hash:{},data:t}))+"</td>\n              </tr>\n          ",r}function c(e,t){var n="",r;return n+=a((r=e&&e.device,typeof r===u?r.apply(e):r))+" ",n}function h(e,t){var r="";return r+='\n              <div class="blank-widget">'+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_LEFT",{hash:{},data:t}))+"Volume"+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_RIGHT",{hash:{},data:t}))+".</div>\n          ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table-head">\n    <thead>\n    <tr>\n        <th class="sortable">Name</th>\n        <th class="sortable" style="width:20%">Status</th>\n        <th class="sortable" style="width:10%">Volume Size</th>\n        <th class="sortable" style="width:12%">Device Name</th>\n        <th class="sortable" style="width:30%" data-row-type="datetime">Created Time</th>\n    </tr>\n    </thead>\n</table>\n<div class="scroll-wrap">\n  <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n  <div class="scroll-content">\n    <table class="table">\n        <thead>\n            <tr>\n                <th></th>\n                <th style="width: 20%"></th>\n                <th style="width: 10%"></th>\n                <th style="width: 12%"></th>\n                <th style="width: 30%"></th>\n            </tr>\n        </thead>\n      <tbody>\n          ',o=n.each.call(t,t&&t.volumes,{hash:{},inverse:f.program(4,h,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n      </tbody>\n    </table>\n  </div>\n</div>",s},n.resource_OSVOL=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n              <tr>\n                  <td>\n                    <div>"+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'</div>\n                  </td>\n                  <td class="os-status os-status-'+a((i=e&&e.status,typeof i===u?i.apply(e):i))+'">'+a((i=e&&e.status,typeof i===u?i.apply(e):i))+"</td>\n                  <td>"+a((i=e&&e.size,typeof i===u?i.apply(e):i))+" GiB</td>\n                  <td>",i=n["if"].call(e,e&&e.volumeName,{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="</td>\n                  <td>"+a(n.timeStr.call(e,e&&e.created_at,{hash:{},data:t}))+"</td>\n              </tr>\n          ",r}function c(e,t){var n;return a((n=e&&e.volumeName,typeof n===u?n.apply(e):n))}function h(e,t){var n;return a((n=e&&e.volume_id,typeof n===u?n.apply(e):n))}function p(e,t){var r="";return r+='\n              <div class="blank-widget">'+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_LEFT",{hash:{},data:t}))+"Snapshot"+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_RIGHT",{hash:{},data:t}))+".</div>\n          ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table-head">\n    <thead>\n    <tr>\n        <th class="sortable">Name</th>\n        <th class="sortable" style="width:10%">Status</th>\n        <th class="sortable" style="width:10%">Snapshot Size</th>\n        <th class="sortable" style="width:29%">Source Volume</th>\n        <th class="sortable" style="width:28%" data-row-type="datetime">Created Time</th>\n    </tr>\n    </thead>\n</table>\n<div class="scroll-wrap">\n  <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n  <div class="scroll-content">\n    <table class="table">\n        <thead>\n            <tr>\n                <th></th>\n                <th style="width: 10%"></th>\n                <th style="width: 10%"></th>\n                <th style="width: 29%"></th>\n                <th style="width: 28%"></th>\n            </tr>\n        </thead>\n      <tbody>\n          ',o=n.each.call(t,t&&t.snaps,{hash:{},inverse:f.program(6,p,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n      </tbody>\n    </table>\n  </div>\n</div>",s},n.resource_OSSNAP=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n              <tr>\n                  <td>"+a((i=e&&e.floating_ip_address,typeof i===u?i.apply(e):i))+"</td>\n                  <td>"+a((i=e&&e.serverName,typeof i===u?i.apply(e):i)),i=n["if"].call(e,e&&e.portName,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="</td>\n              </tr>\n          ",r}function c(e,t){var n="",r;return n+="("+a((r=e&&e.portName,typeof r===u?r.apply(e):r))+")",n}function h(e,t){var r="";return r+='\n              <div class="blank-widget">'+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_LEFT",{hash:{},data:t}))+"FIP"+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_RIGHT",{hash:{},data:t}))+".</div>\n          ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table-head">\n    <thead>\n    <tr>\n        <th class="sortable">IP Address</th>\n        <th class="sortable" style="width:60%">Associated Server</th>\n    </tr>\n    </thead>\n</table>\n<div class="scroll-wrap">\n  <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n  <div class="scroll-content">\n    <table class="table">\n        <thead>\n            <tr>\n                <th></th>\n                <th style="width: 60%"></th>\n            </tr>\n        </thead>\n      <tbody>\n          ',o=n.each.call(t,t&&t.fips,{hash:{},inverse:f.program(4,h,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n      </tbody>\n    </table>\n  </div>\n</div>",s},n.resource_OSFIP=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n              <tr>\n                  <td>"+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'</td>\n                  <td class="os-status os-status-'+a((i=e&&e.status,typeof i===u?i.apply(e):i))+'">'+a((i=e&&e.status,typeof i===u?i.apply(e):i))+"</td>\n                  <td>",i=n["if"].call(e,e&&e.externalNetworkName,{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="</td>\n              </tr>\n          ",r}function c(e,t){var n;return a((n=e&&e.externalNetworkName,typeof n===u?n.apply(e):n))}function h(e,t){var n;return a((n=(n=e&&e.external_gateway_info,n==null||n===!1?n:n.network_id),typeof n===u?n.apply(e):n))}function p(e,t){var r="";return r+='\n              <div class="blank-widget">'+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_LEFT",{hash:{},data:t}))+"Router"+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_RIGHT",{hash:{},data:t}))+".</div>\n          ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table-head">\n    <thead>\n    <tr>\n        <th class="sortable">Name</th>\n        <th class="sortable" style="width:20%">Status</th>\n        <th class="sortable" style="width:30%">External Network</th>\n    </tr>\n    </thead>\n</table>\n<div class="scroll-wrap">\n  <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n  <div class="scroll-content">\n    <table class="table">\n        <thead>\n            <tr>\n                <th></th>\n                <th style="width: 20%"></th>\n                <th style="width: 30%"></th>\n            </tr>\n        </thead>\n      <tbody>\n          ',o=n.each.call(t,t&&t.rts,{hash:{},inverse:f.program(6,p,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n      </tbody>\n    </table>\n  </div>\n</div>",s},n.resource_OSRT=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+="\n              <tr>\n                  <td>"+a((r=e&&e.poolName,typeof r===u?r.apply(e):r))+'</td>\n                  <td class="os-status os-status-'+a((r=e&&e.status,typeof r===u?r.apply(e):r))+'">'+a((r=e&&e.status,typeof r===u?r.apply(e):r))+"</td>\n                  <td>"+a((r=e&&e.name,typeof r===u?r.apply(e):r))+"</td>\n              </tr>\n          ",n}function c(e,t){var r="";return r+='\n              <div class="blank-widget">'+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_LEFT",{hash:{},data:t}))+"Load Balancer"+a(n.i18n.call(e,"DASH_TIP_NO_RESOURCE_RIGHT",{hash:{},data:t}))+".</div>\n          ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table-head">\n    <thead>\n    <tr>\n        <th class="sortable">Pool Name</th>\n        <th class="sortable" style="width:20%">Status</th>\n        <th class="sortable" style="width:30%">Listener Name</th>\n    </tr>\n    </thead>\n</table>\n<div class="scroll-wrap">\n  <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n  <div class="scroll-content">\n    <table class="table">\n        <thead>\n            <tr>\n                <th></th>\n                <th style="width: 20%"></th>\n                <th style="width: 30%"></th>\n            </tr>\n        </thead>\n      <tbody>\n          ',o=n.each.call(t,t&&t.elbs,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n      </tbody>\n    </table>\n  </div>\n</div>",s},n.resource_OSLISTENER=e.template(t),n}),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("workspaces/osdashboard/DashboardView",["./DashboardTpl","./DashboardTplData","constant","i18n!/nls/lang.js","CloudResources","AppAction","backbone","UI.tooltip","UI.table","UI.bubble","UI.scrollbar","UI.nanoscroller"],function(t,n,r,i,s,o){return Backbone.View.extend({events:{"click #OsReloadResource":"reloadResource","click .icon-new-stack":"createStack","click .ops-list-switcher":"switchAppStack","click .dash-ops-list > li":"openItem","click .dash-ops-list .delete-stack":"deleteStack","click .dash-ops-list .duplicate-stack":"duplicateStack","click .dash-ops-list .start-app":"startApp","click .dash-ops-list .stop-app":"stopApp","click .dash-ops-list .terminate-app":"terminateApp","click .resource-tab":"switchResource"},resourcesTab:"OSSERVER",initialize:function(){var e;this.opsListTab="stack",this.region="guangzhou",this.lastUpdate=+(new Date),this.setElement($(t.frame()).eq(0).appendTo("#main")),this.updateOpsList(),this.updateResList(),this.updateRegionResources(),e=this,setInterval(function(){$("#OsReloadResource").hasClass("reloading")||$("#OsReloadResource").text(MC.intervalDate(e.lastUpdate/1e3))},6e4),MC.template.osDashboardBubble=_.bind(this.osDashboardBubble,this)},awake:function(){this.$el.show().children(".nano").nanoScroller()},sleep:function(){return this.$el.hide()},osDashboardBubble:function(e){var t,i;return t={id:e.id,data:(i=this.model.getOsResDataById(this.region,r.RESTYPE[e.type],e.id))!=null?i.toJSON():void 0},t.data=t.data.system_metadata,_.each(t.data,function(e,n){_.isBoolean(e)&&(t.data[n]=e.toString()),e===""&&(t.data[n]="None"),_.isArray(e)&&e.length===0&&(t.data[n]=["None"]);if(_.isObject(e)&&!_.isArray(e))return delete t.data[n]}),n.bubbleResourceInfo(t)},updateOpsList:function(){var e,n,r,i,s,o,u,a;e=this.$el.find(".dash-ops-list-wrapper"),a={thumbnail:!0},i=function(e){return e.isExisting()},o=function(e){return e.toJSON(a)},u=App.model.stackList().filter(i),r=App.model.appList().filter(i),n=e.children("nav"),n.find(".count").text(r.length),n.find(".stack").find(".count").text(u.length),this.opsListTab==="stack"?s=t.stackList(u.map(o)):s=t.appList(r.map(o)),e.children("ul").html(s)},updateResList:function(){return this.$(".dash-ops-resource-list").html(t.resourceList({}))},updateAppProgress:function(e){var t;if(e.get("region")===this.region&&this.regionOpsTab==="app"){void 0,t=$el.find(".dash-ops-list").children("[data-id='"+e.id+"']");if(!t.length)return;t.children(".region-resource-progess").show().css({width:e.get("progress")+"%"})}},switchAppStack:function(e){var t;t=$(e.currentTarget);if(t.hasClass("on"))return;t.addClass("on").siblings().removeClass("on"),this.opsListTab=t.hasClass("stack")?"stack":"app",this.updateOpsList()},switchResource:function(e){this.$(".resource-list-nav").children().removeClass("on"),this.resourcesTab=$(e.currentTarget).addClass("on").attr("data-type"),this.updateRegionResources()},updateResourceCount:function(e){var t,n,r,i,s;s=this.model.getResourcesCount(this.region),t=$(".resource-list-nav");for(i in s)r=s[i],n=t.children("."+i),this.animateResourceCount(n,r,100)},animateResourceCount:function(e,t,n){void 0;if(t){if(e.data("init")==="active")return!1;e.data("init","active")}else{if(e.data("init")==="quota")return!1;e.data("init","quota"),t=0,e.prepend('<svg class="rotate" viewbox="0 0 250 250">\n  <path class="loader usage-quota" fill="#0099ff" transform="translate(125, 125)"/>\n  <path class="loader usage-active" fill="#0099ff" transform="translate(125, 125)"/>\n  <circle class="cover" cx="50%" cy="50%" r="112" fill="#fcfcfc"></circle>\n  <circle class="blue-dot" cx="6.5" cy="50%" r="6.5" fill="#e6e6e6"></circle>\n  <circle class="gray-dot" cx="50%" cy="6.5" r="6.5" fill="#4c92e5"></circle>\n  <circle class="active-dot" cx="50%" cy="6.5" r="6.5" fill="#4c92e5"></circle>\n</svg>')}return void 0,this.animateUsage(e,t,n)},animateUsage:function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v;return p=2,u=125,a=u-6.5,r=Math.PI,c=e.find(".usage-quota"),i=e.find(".usage-active"),v=e.find(".count-usage"),h=e.find(".count-quota"),s=e.find(".active-dot"),l=270,f=l/n*t,d=p*1e3/360*n/t,i.timeout&&(window.clearTimeout(i.timeout),i.timeout=void 0),o=function(e,l,c){var h,p,m,g,y,b,w,E;g=l*r/180,w=Math.sin(g)*u,E=Math.cos(g)*-u,m=l>180?1:0,b=l/f*t,h=Math.sin(g)*a+125,p=Math.cos(g)*-a+125,y="M 0 0 v -125 A 125 125 1 "+m+" 1 "+w+" "+E+" z",e.attr("d",y),s.attr("cx",h).attr("cy",p);if(!c){b=b>n?n:b,v.text(Math.round(b)||"..."),l+=1;if(l<=f)return i.timeout=window.setTimeout(function(){return o(e,l)},d)}},c.attr("fill","#e6e6e6"),i.attr("fill","#4c92e5"),h.text("/"+n),o(c,270,!0),o(i,0)},updateRegionResources:function(t){var i,s;this.updateResourceCount(t);if(t&&(s=this.resourcesTab,e.call(t,s)<0))return;return t=r.RESTYPE[this.resourcesTab],this.model.isOsResReady(this.region,t)?i=n["resource_"+this.resourcesTab](this.model.getOsResData(this.region,t)):i='<div class="dashboard-loading"><div class="loading-spinner"></div></div>',$(".resource-list-body").html(i)},openItem:function(e){return App.openOps($(e.currentTarget).attr("data-id"))},createStack:function(e){return App.createOps("guangzhou","openstack","awcloud")},markUpdated:function(){this.lastUpdate=+(new Date)},reloadResource:function(){if($("#OsReloadResource").hasClass("reloading"))return;$("#OsReloadResource").addClass("reloading").text(""),App.discardAwsCache().done(function(){return $("#OsReloadResource").removeClass("reloading").text("just now")})},deleteStack:function(e){return o.deleteStack($(e.currentTarget).closest("li").attr("data-id")),!1},duplicateStack:function(e){return o.duplicateStack($(e.currentTarget).closest("li").attr("data-id")),!1},startApp:function(e){return o.startApp($(e.currentTarget).closest("li").attr("data-id")),!1},stopApp:function(e){return o.stopApp($(e.currentTarget).closest("li").attr("data-id")),!1},terminateApp:function(e){return o.terminateApp($(e.currentTarget).closest("li").attr("data-id")),!1}})})}.call(this),function(){define("workspaces/osdashboard/DashboardModel",["ApiRequest","CloudResources","constant","backbone"],function(e,t,n){return Backbone.Model.extend({initialize:function(){var e;return e="guangzhou",this.listenTo(t(n.RESTYPE.OSSERVER,e),"update",this.onRegionResChanged(["OSSERVER","FIP"])),this.listenTo(t(n.RESTYPE.OSPORT,e),"update",this.onRegionResChanged(["FIP"])),this.listenTo(t(n.RESTYPE.OSVOL,e),"update",this.onRegionResChanged(["OSVOL","OSSNAP"])),this.listenTo(t(n.RESTYPE.OSSNAP,e),"update",this.onRegionResChanged(["OSSNAP"])),this.listenTo(t(n.RESTYPE.OSFIP,e),"update",this.onRegionResChanged(["OSFIP"])),this.listenTo(t(n.RESTYPE.OSRT,e),"update",this.onRegionResChanged(["OSRT"])),this.listenTo(t(n.RESTYPE.OSPOOL,e),"update",this.onRegionResChanged(["OSPOOL","OSLISTENER"])),this.listenTo(t(n.RESTYPE.OSLISTENER,e),"update",this.onRegionResChanged(["OSLISTENER"])),this.listenTo(t(n.RESTYPE.OSNETWORK,e),"update",this.onRegionResChanged(["OSRT"]))},onRegionResChanged:function(e){return function(){return this.trigger("change:regionResources",e)}},fetchOsResources:function(e){e==null&&(e="guangzhou"),t(n.RESTYPE.OSSERVER,e).fetch(),t(n.RESTYPE.OSPORT,e).fetch(),t(n.RESTYPE.OSVOL,e).fetch(),t(n.RESTYPE.OSSNAP,e).fetch(),t(n.RESTYPE.OSFIP,e).fetch(),t(n.RESTYPE.OSRT,e).fetch(),t(n.RESTYPE.OSPOOL,e).fetch(),t(n.RESTYPE.OSLISTENER,e).fetch(),t(n.RESTYPE.OSNETWORK,e).fetch()},isOsResReady:function(e,r){switch(r){case n.RESTYPE.OSLISTENER:return t(r,e).isReady()&&t(n.RESTYPE.OSPOOL,e).isReady();case n.RESTYPE.OSPOOL:return t(r,e).isReady()&&t(n.RESTYPE.OSLISTENER,e).isReady();default:return t(r,e).isReady()}},getOsResData:function(e,r){var i,s,o,u,a,f,l,c;return i={servers:(o=t(n.RESTYPE.OSSERVER,e))!=null?o.toJSON():void 0,volumes:(u=t(n.RESTYPE.OSVOL,e))!=null?u.toJSON():void 0,snaps:(a=t(n.RESTYPE.OSSNAP,e))!=null?a.toJSON():void 0,fips:(f=t(n.RESTYPE.OSFIP,e))!=null?f.toJSON():void 0,rts:(l=t(n.RESTYPE.OSRT,e))!=null?l.toJSON():void 0,elbs:(c=t(n.RESTYPE.OSLISTENER,e))!=null?c.toJSON():void 0},_.each(i.fips,function(r){var i,s,o,u,a,f,l;return s=r.port_id,i=(u=t(n.RESTYPE.OSPORT,e))!=null?(a=u.get(s))!=null?a.toJSON():void 0:void 0,i&&(o=(f=t(n.RESTYPE.OSSERVER,e))!=null?(l=f.get(i.device_id))!=null?l.toJSON():void 0:void 0),r.serverName=o!=null?o.name:void 0,r.portName=i!=null?i.name:void 0}),_.each(i.snaps,function(r){var i,s,o;return i=(s=t(n.RESTYPE.OSVOL,e))!=null?(o=s.get(r.volume_id))!=null?o.toJSON():void 0:void 0,r.volumeName=i!=null?i.name:void 0}),_.each(i.elbs,function(r){var i,s,o;return i=(s=t(n.RESTYPE.OSPOOL,e))!=null?(o=s.get(r.pool_id))!=null?o.toJSON():void 0:void 0,r.poolName=i!=null?i.name:void 0}),s=_.map(t(n.RESTYPE.OSNETWORK,e).getExtNetworks(),function(e){return e.toJSON()}),_.each(i.rts,function(e){var t;return t=_.findWhere(s,{id:e.external_gateway_info.network_id}),e.externalNetworkName=t.name}),i},getOsResDataById:function(e,n,r){return t(n,e).get(r)},getResourcesCount:function(e){var r,i,s,o,u,a;o={category:e},s={servers:"OSSERVER",volumes:"OSVOL",snaps:"OSSNAP",fips:"OSFIP",rts:"OSRT",elbs:"OSLISTENER"},i={};for(u in s)a=s[u],r=t(n.RESTYPE[a],e),r.isReady()?i[u]=r.where(o).length:i[u]="";return i}})})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("workspaces/osdashboard/DashboardOs",["Workspace","./DashboardView","./DashboardModel","i18n!/nls/lang.js"],function(e,n,r,i){var s;return s=function(e){function s(){return s.__super__.constructor.apply(this,arguments)}return t(s,e),s.prototype.isFixed=function(){return!0},s.prototype.tabClass=function(){return"icon-dashboard"},s.prototype.title=function(){return i.IDE.NAV_TIT_DASHBOARD},s.prototype.url=function(){return"/"},s.prototype.initialize=function(){var e;this.model=new r,this.view=new n({model:this.model}),e=this,this.listenTo(App.model.stackList(),"update",function(){return e.__renderControl("updateOpsList")}),this.listenTo(App.model.appList(),"update",function(){return e.__renderControl("updateOpsList")}),this.listenTo(App.model.stackList(),"change",function(){return e.__renderControl("updateOpsList",arguments)}),this.listenTo(App.model.appList(),"change",function(){return e.__renderControl("updateOpsList",arguments)}),this.listenTo(this.model,"change:regionResources",function(t){return e.view.markUpdated(),e.__renderControl("updateRegionResources",arguments)}),this.view.listenTo(App.model.appList(),"change:progress",this.view.updateAppProgress),this.model.fetchOsResources(),this.__renderControlMap={}},s.prototype.sleep=function(){this.__renderControlMap={},this.view.sleep()},s.prototype.awake=function(){var e;for(e in this.__renderControlMap)this.view[e]();this.__renderControlMap=null,this.view.awake()},s.prototype.__renderControl=function(e,t){this.__renderControlMap?(void 0,this.__renderControlMap[e]=!0):this.view[e].apply(this.view,t)},s}(e),s})}.call(this);