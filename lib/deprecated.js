(function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("lib/aws/aws",["MC","constant","underscore","jquery","Design"],function(t,n,r,i,s){var o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;return o=function(e,n,s){var o,u;if(!e||!n||!t.data.resource_list)return void 0,null;s&&(t.data.resource_list[n]={});try{e.DescribeVpcs&&r.map(e.DescribeVpcs,function(e,r){return t.data.resource_list[n][e.vpcId]=e,null}),e.DescribeInstances&&r.map(e.DescribeInstances,function(e,r){return t.data.resource_list[n][e.instanceId]=e,null}),e.DescribeVolumes&&r.map(e.DescribeVolumes,function(e,r){return t.data.resource_list[n][e.volumeId]=e,null}),e.DescribeAddresses&&r.map(e.DescribeAddresses,function(e,r){return t.data.resource_list[n][e.publicIp]=e,null}),o={},e.DescribeLoadBalancers&&r.map(e.DescribeLoadBalancers,function(e,t){return o[e.LoadBalancerName]||(o[e.LoadBalancerName]={}),o[e.LoadBalancerName]=r.extend(o[e.LoadBalancerName],e),null}),e.DescribeLoadBalancerAttributes&&r.map(e.DescribeLoadBalancerAttributes,function(e,t){return o[e.LoadBalancerName]||(o[e.LoadBalancerName]={}),o[e.LoadBalancerName]=r.extend(o[e.LoadBalancerName],e),null}),r.map(o,function(e){return t.data.resource_list[n][e.DNSName]=e}),e.DescribeVpnConnections&&r.map(e.DescribeVpnConnections,function(e,r){return t.data.resource_list[n][e.vpnConnectionId]=e,null}),e.DescribeKeyPairs&&r.map(e.DescribeKeyPairs,function(e,r){return t.data.resource_list[n][e.keyFingerprint]=e,null}),e.DescribeSecurityGroups&&r.map(e.DescribeSecurityGroups,function(e,r){return t.data.resource_list[n][e.groupId]=e,null}),e.DescribeDhcpOptions&&r.map(e.DescribeDhcpOptions,function(e,r){return t.data.resource_list[n][e.dhcpOptionsId]=e,null}),e.DescribeSubnets&&r.map(e.DescribeSubnets,function(e,r){return t.data.resource_list[n][e.subnetId]=e,null}),e.DescribeRouteTables&&r.map(e.DescribeRouteTables,function(e,r){return t.data.resource_list[n][e.routeTableId]=e,null}),e.DescribeNetworkAcls&&r.map(e.DescribeNetworkAcls,function(e,r){return t.data.resource_list[n][e.networkAclId]=e,null}),e.DescribeNetworkInterfaces&&r.map(e.DescribeNetworkInterfaces,function(e,r){return t.data.resource_list[n][e.networkInterfaceId]=e,null}),e.DescribeInternetGateways&&r.map(e.DescribeInternetGateways,function(e,r){return t.data.resource_list[n][e.internetGatewayId]=e,null}),e.DescribeVpnGateways&&r.map(e.DescribeVpnGateways,function(e,r){return t.data.resource_list[n][e.vpnGatewayId]=e,null}),e.DescribeCustomerGateways&&r.map(e.DescribeCustomerGateways,function(e,r){return t.data.resource_list[n][e.customerGatewayId]=e,null}),e.DescribeImages&&r.map(e.DescribeImages,function(e,r){var s;try{e.osType||(e=i.extend(!0,{},e),e.osType=t.aws.ami.getOSType(e)),e.osFamily||(e.osFamily=t.aws.aws.getOSFamily(e.osType,e)),p(e),t.data.dict_ami[e.imageId]=e,t.data.resource_list[n][e.imageId]=e}catch(o){s=o,void 0}return null}),e.DescribeAutoScalingGroups&&r.map(e.DescribeAutoScalingGroups,function(e,r){return t.data.resource_list[n][e.AutoScalingGroupARN]=e,null}),e.DescribeLaunchConfigurations&&r.map(e.DescribeLaunchConfigurations,function(e,r){return t.data.resource_list[n][e.LaunchConfigurationARN]=e,null}),e.DescribeNotificationConfigurations&&(t.data.resource_list[n].NotificationConfigurations||(t.data.resource_list[n].NotificationConfigurations=[]),r.map(e.DescribeNotificationConfigurations,function(e,i){var s;return s=null,r.each(t.data.resource_list[n].NotificationConfigurations,function(t){return t.AutoScalingGroupName===e.AutoScalingGroupName&&t.NotificationType===e.NotificationType&&t.TopicARN===e.TopicARN?(s=t,!1):null}),s||t.data.resource_list[n].NotificationConfigurations.push(e),null})),e.DescribePolicies&&r.map(e.DescribePolicies,function(e,r){return t.data.resource_list[n][e.PolicyARN]=e,null}),e.DescribeScheduledActions&&r.map(e.DescribeScheduledActions,function(e,r){return t.data.resource_list[n][e.ScheduledActionARN]=e,null}),e.DescribeAlarms&&r.map(e.DescribeAlarms,function(e,r){return t.data.resource_list[n][e.AlarmArn]=e,null}),e.ListSubscriptions&&(t.data.resource_list[n].Subscriptions||(t.data.resource_list[n].Subscriptions=[]),r.map(e.ListSubscriptions,function(e,i){var s;return s=null,r.each(t.data.resource_list[n].Subscriptions,function(t){return t.Protocol===e.Protocol&&t.Endpoint===e.Endpoint&&t.TopicArn===e.TopicArn?(s=t,!1):null}),s?s.SubscriptionArn=e.SubscriptionArn:t.data.resource_list[n].Subscriptions.push(e),null})),e.ListTopics&&r.map(e.ListTopics,function(e,r){return t.data.resource_list[n][e.TopicArn]=e,null}),e.DescribeAutoScalingInstances&&r.map(e.DescribeAutoScalingInstances,function(e,r){return t.data.resource_list[n][e.AutoScalingGroupName+":"+e.InstanceId]=e,null}),e.DescribeScalingActivities&&r.map(e.DescribeScalingActivities,function(e,r){return t.data.resource_list[n][e.ActivityId]=e,null}),e.DescribeInstanceHealth&&(t.data.resource_list[n].instance_health||(t.data.resource_list[n].instance_health={}),r.map(e.DescribeInstanceHealth,function(e,r){return t.data.resource_list[n].instance_health[e.InstanceId]=e,null}))}catch(a){u=a,void 0}return null},f=function(e,n){var i,s,o;return i=t.canvas_data.component[e],o=i.uid,s=i.type,!r.some(t.canvas_data.component,function(t){var r,i;e=t.uid,i=t.type,r=t.name;if(s===i&&o!==e&&n===r)return!0})},c=function(e,n){var i;return i=r.flatten(r.values(t.data.stack_list)),!r.some(i,function(t){return t.id!==e&&t.name===n})},u=function(e){var n;return n=r.flatten(r.values(t.data.app_list)),!r.contains(n,e)},y=function(e){var n,s,o,u,a,f,l,c,h;e||(e="untitled"),o=0,f=/.*-\d+$/,f.test(e)?(a=e.substr(0,e.lastIndexOf("-")),o=Number(e.substr(e.lastIndexOf("-")+1)),n=a):e.charAt(name.length-1)==="-"?n=e.substr(0,e.length-1):n=e,u=[],l=r.flatten(r.values(t.data.stack_list));for(c=0,h=l.length;c<h;c++)s=l[c],s.name.indexOf(n)===0&&u.push(s.name);o++;while(o<=u.length){if(i.inArray(n+"-"+o,u)===-1)break;o++}return n+"-"+o},a=function(){var e,n;return n=t.canvas_data.region,e=t.data.account_attribute[n],e.support_platform==="VPC"&&t.canvas_data.platform==="default-vpc"?e.default_vpc:!1},b=function(t,r){var i,s,o,u,a;s=this,o="linux";if(t){n.OS_TYPE_MAPPING[t]&&(o=n.OS_TYPE_MAPPING[t]);if(e.call(n.WINDOWS,t)>=0){o="mswin";try{if(r){a=/sql.*?web.*?/,u=/sql.*?standard.*?/;if("name"in r&&r.name.toLowerCase().match(a)||"description"in r&&r.description.toLowerCase().match(a)||"imageLocation"in r&&r.imageLocation.toLowerCase().match(a))o="mswinSQLWeb";else if("name"in r&&r.name.toLowerCase().match(u)||"description"in r&&r.description.toLowerCase().match(u)||"imageLocation"in r&&r.imageLocation.toLowerCase().match(u))o="mswinSQL"}}catch(f){i=f,void 0}}}return o},h=function(e){var r,i,s,o,u,a;o={};for(u in e){r=e[u];if(n.AWS_RESOURCE_KEY[r.type]){o[r.resource[n.AWS_RESOURCE_KEY[r.type]]]=t.aws.aws.genResRef(u,"resource."+n.AWS_RESOURCE_KEY[r.type]),r.type==="AWS.EC2.KeyPair"&&(o[r.resource.KeyName+"-keypair"]=t.aws.aws.genResRef(u,"resource.KeyName")),r.type==="AWS.AutoScaling.Group"&&(o[r.resource.AutoScalingGroupName+"-asg"]=t.aws.aws.genResRef(u,"resource.AutoScalingGroupName")),r.type==="AWS.AutoScaling.LaunchConfiguration"&&(o[r.resource.LaunchConfigurationName+"-lc"]=t.aws.aws.genResRef(u,"resource.LaunchConfigurationName"));if(r.type==="AWS.VPC.NetworkInterface"){a=r.resource.PrivateIpAddressSet;for(i in a)s=a[i],o[s.PrivateIpAddress]=t.aws.aws.genResRef(u,"resource.PrivateIpAddressSet."+i+".PrivateIpAddress")}}}for(u in e)r=e[u],e[u]=E(r,o,n.AWS_RESOURCE_KEY[r.type]);return[e,o]},E=function(e,t,n){var r,i,s,o;switch(typeof e){case"object":for(i in e)o=e[i],typeof o=="string"&&(i==="LaunchConfigurationName"?t[o+"-lc"]&&i!==n&&i!=="name"&&(e[i]=t[o+"-lc"]):i==="AutoScalingGroupName"?t[o+"-asg"]&&i!==n&&i!=="name"&&(e[i]=t[o+"-asg"]):i==="KeyName"?t[o+"-keypair"]&&i!==n&&i!=="name"&&!e.KeyFingerprint&&(e[i]=t[o+"-keypair"]):t[o]&&i!==n&&i!=="name"&&(e[i]=t[o])),typeof o=="object"&&E(e[i],t,n),typeof o=="array"&&E(e[i],t,n);break;case"array":for(r in e)s=e[r],typeof o=="string"&&t[s]&&(e[r]=t[s]),typeof o=="object"&&E(e[r],t,n),typeof o=="array"&&E(e[r],t,n)}return e},m=function(e,t){return"@{"+e+"."+t+"}"},d=function(e){var t;return t=s.instance().get("agent"),t.enabled=e,s.instance().set("agent",t)},g=function(i){var o;return o={parent:null,self:null},s.instance().eachComponent(function(u){var a,f,l,c;a=u.groupMembers&&u.groupMembers(),c=t.data.resource_list[s.instance().region()],(o.parent||o.self)&&null;if(u.get("appId")===i)return a&&a.length?(o.parent=u,o.self=new Backbone.Model({name:""+u.get("name")+"-0"})):o.self=u,null;if(a&&e.call(r.pluck(a,"appId"),i)>=0){if(u.type===n.AWS_RESOURCE_TYPE.AWS_AutoScaling_LaunchConfiguration)o.parent=u.parent();else{o.parent=u;for(f in a){l=a[f];if(l.appId===i){o.self=new Backbone.Model({name:""+u.get("name")+"-"+(+f+1)});break}}}return null}}),o},l=function(e,i,s){var o;return o=!1,r.each(e,function(e){var r,u,a,f;return e.type===n.AWS_RESOURCE_TYPE.AWS_EC2_EIP&&(u=e.resource.NetworkInterfaceId,r=t.extractID(u),i===r&&(f=e.resource.PrivateIpAddress.split("."),a=f[3],Number(a)===s&&(o=!0))),null}),o},v=function(e,i){var s,o,u,a,f,l,c,h,p,d,v,m,g;return f=e.uid,a=e.type,h=!1,u=null,a===n.AWS_RESOURCE_TYPE.AWS_AutoScaling_LaunchConfiguration&&(h=!0),p=!1,d=!1,c=null,l=null,e.number&&(e.number>1?(p=!0,l=e.serverGroupName):(d=!0,c=e.serverGroupName)),i=i||this.get("allCompData"),s=[],o=t.data.state.aws_property,r.each(i,function(e,l){var c,h,p,d,v,m,g,y,b,w,E,S,x,T;v=e.name,g=e.uid,m=e.type,d=!1,g===f&&(v="self"),m===n.AWS_RESOURCE_TYPE.AWS_AutoScaling_Group&&(S=e.resource.LaunchConfigurationName,S&&(E=t.extractID(S),w=i[E],a===n.AWS_RESOURCE_TYPE.AWS_AutoScaling_LaunchConfiguration&&f===E&&(u=v,v="self",h=!0),w.resource.AssociatePublicIpAddress&&(c=!0)));if(m===n.AWS_RESOURCE_TYPE.AWS_EC2_Instance)return;if(m===n.AWS_RESOURCE_TYPE.AWS_VPC_NetworkInterface){if(e.index!==0)return;if(e.serverGroupUid!==g)return;y=e.resource.Attachment.InstanceId;if(!y)return;if((T=e.resource.Attachment.DeviceIndex)==="0"||T===0)b=t.extractID(y),b&&(v=i[b].serverGroupName,g=b,b===f&&(v="self"))}return x=m.replace(/\./ig,"_"),p=o[x],p&&r.each(p,function(o,u){var a,f,l,h,p;f=v+".",a=g+".";if(u==="__array")return;f+=u,a+=u,h=!1;if(u==="PublicIp"){if(m===n.AWS_RESOURCE_TYPE.AWS_AutoScaling_Group&&!c)return;m===n.AWS_RESOURCE_TYPE.AWS_VPC_NetworkInterface&&!t.aws.aws.checkPrivateIPIfHaveEIP(i,e.uid,0)&&!e.resource.AssociatePublicIpAddress&&(h=!0)}h||s.push({name:f,value:a,uid:g});if(o){x==="AWS_AutoScaling_Group"&&u==="AvailabilityZones"&&(l=e.resource.AvailabilityZones,l.length>1&&r.each(l,function(e,t){return s.push({name:f+"["+t+"]",value:a+"["+t+"]",uid:g}),null}));if(x==="AWS_VPC_NetworkInterface")if(u==="PublicDnsName"||u==="PublicIp"||u==="PrivateDnsName"||u==="PrivateIpAddress"){p=e.resource.PrivateIpAddressSet;if(e.index!==0)return;p.length>1&&r.each(p,function(n,r){if(r===0)return;if(u==="PublicIp"&&!t.aws.aws.checkPrivateIPIfHaveEIP(i,e.uid,r))return;return s.push({name:f+"["+r+"]",value:a+"["+r+"]",uid:g}),null})}x==="AWS_ELB"&&u==="AvailabilityZones"&&(l=e.resource.AvailabilityZones,l.length>1&&r.each(l,function(e,t){return s.push({name:f+"["+t+"]",value:a+"["+t+"]",uid:g}),null}))}return null}),null}),v=[],m=[],r.each(s,function(e){var t,n,r,i;if(e.name.indexOf("self.")===0){d&&(r=e.name.replace("self",c),i=e.value.replace("self",c),m.push({name:r,value:i,uid:e.uid}));if(h||p)return t=null,n=null,h?(t=e.name.replace("self",u),n=e.value.replace("self",u)):p&&(t=e.name.replace("self",l),n=e.value.replace("self",l)),v.push({name:t,value:n,uid:e.uid})}}),s=s.concat(v),s=s.concat(m),g=r.map(s,function(e){return e.name.indexOf("self.")===0&&(e.value=e.value.replace(e.uid,"self"),e.uid="self"),{name:""+e.name,value:""+e.name,ref:""+e.value,uid:""+e.uid}}),g=r.filter(g,function(e){return e.name.indexOf("self.")===0?e.name.indexOf(".AvailabilityZones")!==-1?!1:!0:!0}),g=g.sort(function(e,t){if(e.name<t.name)return-1;if(e.name>t.name)return 1}),g},p=function(e){var t,n,r,i,s,o;t={};if(e&&e.blockDeviceMapping&&e.blockDeviceMapping.item){o=e.blockDeviceMapping.item;for(n=i=0,s=o.length;i<s;n=++i)r=o[n],r.ebs?t[r.deviceName]={snapshotId:r.ebs.snapshotId,volumeSize:r.ebs.volumeSize,volumeType:r.ebs.volumeType,deleteOnTermination:r.ebs.deleteOnTermination}:t[r.deviceName]={},e.blockDeviceMapping=t}else void 0;return null},w=function(e,t){var n,i,s,o,u;return u=[{low:"1.0.0.1",high:"126.255.255.254"},{low:"128.1.0.1",high:"191.254.255.254"},{low:"192.0.1.1",high:"223.255.254.254"}],o=[{low:"10.0.0.0",high:"10.255.255.255"},{low:"172.16.0.0",high:"172.31.255.255"},{low:"192.168.0.0",high:"192.168.255.255"}],i=function(e,t,n){var i,s,o,u;return s=e.split("."),o=t.split("."),i=n.split("."),u=!0,r.each(i,function(e,t){return Number(i[t])>=Number(s[t])&&Number(i[t])<=Number(o[t])||(u=!1),null}),u},n=[],t==="public"?n=u:t==="private"&&(n=o),s=!1,r.each(n,function(t){var n,r,o;return o=t.low,n=t.high,r=i(o,n,e),r&&(s=!0),null}),s},{collectReference:h,cacheResource:o,checkIsRepeatName:f,checkStackName:c,checkAppName:u,getDuplicateName:y,checkDefaultVPC:a,getOSFamily:b,genResRef:m,enableStackAgent:d,getCompByResIdForState:g,genAttrRefList:v,isValidInIPRange:w,checkPrivateIPIfHaveEIP:l}})}).call(this),function(){define("aws_handle",["MC","constant","lib/aws/aws"],function(e,t,n){return e.aws={aws:n},e.aws.ami={getOSType:function(e){var t,n,r;if(!e)return"unknown";if(e.osType)return e.osType;r=["centos","redhat","rhel","ubuntu","debian","fedora","gentoo","opensuse","suse","amazon","amzn"],n="linux-other",t=[],e.platform&&e.platform==="windows"?t.push("windows"):(e.name&&(t=r.filter(function(t){return~e.name.toLowerCase().indexOf(t)})),t.length===0&&"description"in e&&e.description&&(t=r.filter(function(t){return~e.description.toLowerCase().indexOf(t)})),t.length===0&&"imageLocation"in e&&e.imageLocation&&(t=r.filter(function(t){return~e.imageLocation.toLowerCase().indexOf(t)}))),t.length>0&&(n=t[0]);switch(n){case"rhel":n="redhat";break;case"amzn":n="amazon"}return n},getInstanceType:function(n){var r,i,s,o,u,a,f,l;if(!n)return[];try{f=e.canvas_data.region,o=e.data.instance_type[f],l=e.data.region_instance_type,i=null,l&&(i=l[f]),r=o,i&&n.osFamily&&(r=i);if(!r)return[];i?(u=n.osFamily,u||(a=n.osType,u=t.OS_TYPE_MAPPING[a]),r=r[u]):n.osType==="windows"?r=r.windows:r=r.linux,n.rootDeviceType==="ebs"?r=r.ebs:r=r["instance store"],n.architecture==="x86_64"?r=r[64]:r=r[32],r=r[n.virtualizationType||"paravirtual"]}catch(c){s=c,r=[]}if(!r||r.length<=0)r=e.data.config[f].region_instance_type;return r||(r=[]),r}},e.aws})}.call(this),function(){define("forge_handle",["MC","constant"],function(e,t){var n,r;return r=function(t){var n,r,i;n="";if(t)try{e.tab[t]?r=e.tab[t].data:r=e.canvas_data,r&&(n=r.name)}catch(s){i=s,void 0,n=""}return n},n=function(e){var t;return void 0,t=[],_.each(e.component,function(e){e.type==="AWS.EC2.Instance"&&e.resource&&e.resource.ImageId&&t.push(e.resource.ImageId);if(e.type==="AWS.AutoScaling.LaunchConfiguration"&&e.resource&&e.resource.ImageId)return t.push(e.resource.ImageId)}),t},e.forge={app:{getNameById:r,getAmis:n}},null})}.call(this),function(){define("lib/common/cookie",["jquery","MC","constant"],function(e,t,n){var r,i,s,o,u,a,f,l;return u=function(r){var i;return document.domain.indexOf("visualops.io")!==-1?i=n.COOKIE_OPTION:i=n.LOCAL_COOKIE_OPTION,e.cookie("usercode",r.usercode,i),e.cookie("username",t.base64Decode(r.usercode),i),e.cookie("email",r.email,i),e.cookie("session_id",r.session_id,i),e.cookie("account_id",r.account_id,i),e.cookie("mod_repo",r.mod_repo,i),e.cookie("mod_tag",r.mod_tag,i),e.cookie("state",r.state,i),e.cookie("has_cred",r.has_cred,i),e.cookie("is_invitated",r.is_invitated,i)},s=function(){var t;return document.domain.indexOf("visualops.io")!==-1?t=n.COOKIE_OPTION:t=n.LOCAL_COOKIE_OPTION,e.cookie("usercode","",t),e.cookie("username","",t),e.cookie("email","",t),e.cookie("session_id","",t),e.cookie("account_id","",t),e.cookie("mod_repo","",t),e.cookie("mod_tag","",t),e.cookie("state","",t),e.cookie("has_cred","",t),e.cookie("is_invitated","",t)},f=function(t){var r;return document.domain.indexOf("visualops.io")!==-1?r=n.COOKIE_OPTION:r=n.LOCAL_COOKIE_OPTION,e.cookie("has_cred",t,r)},l=function(e){var t,r;return document.domain.indexOf("visualops.io")!==-1?r=n.COOKIE_OPTION:r=n.LOCAL_COOKIE_OPTION,t=[e.usercode,e.email,e.session_id,e.account_id,e.mod_repo,e.mod_tag,e.state,e.has_cred,e.is_invitated],null},r=function(){return e.cookie("usercode")&&e.cookie("username")&&e.cookie("session_id")&&e.cookie("account_id")&&e.cookie("mod_repo")&&e.cookie("mod_tag")&&e.cookie("state")&&e.cookie("has_cred")&&e.cookie("is_invitated")?!0:!1},i=function(t){var n;return n={path:t},e.each(e.cookie(),function(t,r){return e.removeCookie(r,n),null})},o=function(t){return e.cookie(t)},a=function(t,r){var i;return document.domain.indexOf("visualops.io")!==-1?i=n.COOKIE_OPTION:i=n.LOCAL_COOKIE_OPTION,e.cookie(t,r,i)},{setCookie:u,deleteCookie:s,setIDECookie:l,setCred:f,checkAllCookie:r,clearV2Cookie:i,getCookieByName:o,setCookieByName:a}})}.call(this),function(){define("lib/common/other",["MC","constant","jquery","underscore"],function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,D,P,H,B,j,F,I,q,R,U,z,W,X,V;return c={init:function(t){return void 0,e.canvas_data=$.extend(!0,{},t)},initSet:function(t,n){return void 0,e.canvas_data[t]=n},data:function(t){var n;return t==null&&(t=!1),_.isString(t)&&t==="origin"?n=e.canvas_data:t?n=$.extend(!0,{},e.canvas_data):_.isEmpty(Design.instance())||(n=Design.instance().serialize()),n},save:function(e){void 0;if(!_.isEmpty(Design.instance()))return Design.instance().save(e)},set:function(e,t){void 0;if(!_.isEmpty(Design.instance()))return Design.instance().set(e,t)},get:function(e){void 0;if(!_.isEmpty(Design.instance()))return Design.instance().get(e)},isModified:function(){void 0;if(!_.isEmpty(Design.instance()))return Design.instance().isModified()},origin:function(t){return _.isEmpty(t)?(void 0,$.extend(!0,{},e.data.origin_canvas_data)):(void 0,e.data.origin_canvas_data=$.extend(!0,{},t))}},d=function(e){var t,n,r;e==null&&(e=8),t=void 0,r=void 0,t="0123456789abcdefghiklmnopqrstuvwxyz".split(""),e||(e=Math.floor(Math.random()*t.length)),r="",n=0;while(n<e)r+=t[Math.floor(Math.random()*t.length)],n++;return r},A=function(t){return void 0,e.data.current_tab_id===t?!0:!1},R=function(t){return void 0,e.data.current_tab_id=t,null},I=function(t){var n,r,i,s,o;void 0,o=null;try{i=t.split("-")[0],i==="appview"?(r=F({key:"id",value:t.replace("appview","process")}),o=r):i==="new"?o=e.data.nav_new_stack_list[t]:i==="stack"||i==="app"?(s=t.split("-")[0]==="stack"?e.data.nav_stack_list:e.data.nav_app_list,_.each(s,function(e){return _.each(e.region_name_group,function(e){return e.id===t&&(o=e),!0})})):void 0}catch(u){n=u,void 0,void 0}return o},O=function(e){return void 0,e&&!e.is_error&&e.resolved_data&&e.resolved_data.length>0?!0:e?e&&e.is_error?"result_error":e&&!e.is_error&&!e.resolved_data?"resolved_data_empty":e&&!e.is_error&&e.resolved_data&&(e.resolved_data.length=0)?"resolved_data_length":"other_error":"result_empty"},j=function(e){return _.isString(e)?e.indexOf("-")===-1?void 0:E(e)&&(e.split("-").length=2)?"appview":e.split("-")[0]==="process"&&e.split("-").length>2?"process":void 0:void 0},V=function(e,t){t==null&&(t=!1),void 0,t&&(e.is_error=!0,e.return_code=-1),e&&e.return_code===-1&&(window.location.href="/500")},h=function(){var t;void 0,t=[];for(;;){e.data.untitled=e.data.untitled+1;if(e.aws.aws.checkStackName(null,"untitled-"+e.data.untitled))break;t.push(void 0)}return t},i=function(t,n){return void 0,e.process[t]=n,null},y=function(t){return void 0,delete e.process[t],delete e.data.process[t],void 0,null},x=function(t){return void 0,e.process[t]},b=function(e){var n,r,i;return void 0,n=this.searchStackAppById(e),r=null,n&&((i=n.state)===t.APP_STATE.APP_STATE_STARTING||i===t.APP_STATE.APP_STATE_STOPPING||i===t.APP_STATE.APP_STATE_TERMINATING||i===t.APP_STATE.APP_STATE_UPDATING)&&(r=n.state),r},N=function(t,n,r){return void 0,e.data.process={},e.data.process=$.extend(!0,{},r),e.data.process&&e.data.process[t]&&(e.data.process[t].state=n),void 0,e.data.process},f={},M=function(){return void 0,f},n=function(e,t,n,r,i,s){return s==null&&(s="OPEN"),void 0,f[t]={uid:e,id:t,origin_id:n,region:r,type:i,state:s,create_time:"",origin_time:new Date}},v=function(e){return void 0,e.split("-")[0]==="appview"&&(e=e.replace("appview","process")),delete f[e],f},q=function(e,t,n,r,i){var s;return void 0,s=null,_.each(f,function(o){if(o.origin_id===e)return t&&(o.data=$.extend(!0,{},t)),n&&(o.state=n),r&&(o.type=r),i&&(o.create_time=i),s=o}),s},E=function(e){return e.split("-")[0]==="appview"&&(e=e.replace("appview","process")),f[e]},F=function(e){var t;return void 0,t=null,_.each(f,function(n){if(n[e.key]===e.value)return t=n}),t},W={},L=function(){return void 0,W={}},H=function(){return void 0,W},u=function(e){return void 0,W=e},g=function(e){var t;void 0;try{_.each(W,function(t){var n;n={},_.each(t,function(r){if(_.indexOf(_.keys(t),e)!==-1)return n=t[e]});if(n)return delete t[e]})}catch(n){t=n,void 0}return W},X={},a=function(e,t){return X[e]=t},T=function(e){return void 0,X[e]},B=function(){return void 0,X},U=[],C=function(){return U=[]},D=function(){return U},s=function(t){var n;return void 0,t&&t.component&&(o(t),n=_.values(t.component),n&&!_.isEmpty(n)&&_.isArray(n)&&(C(),_.each(n,function(e){var t,n;n=e.name,t=_.keys(e.resource);if(t&&!_.isEmpty(t)&&_.isArray(t)&&!_.isEmpty(e.name))return _.each(t,function(e){var t;return t="{"+n+"."+e+"}",U.push({name:t,value:t})})}))),void 0,e.storage.set("state_editor_list",U),U},z={},k=function(){return z={}},P=function(){return z},o=function(t){return void 0,t&&t.component&&(k(),_.each(t.component,function(e){return z[e.name]={uid:e.uid,type:e.type}})),void 0,e.storage.set("state_editor_name_list",z),z},w=function(e){var t,n;return void 0,t=$.extend(!0,{},e),n=/[^@{][-\w\.]+[}]/igm,_.each(t,function(e){return e.parameter.verify_gpg=e.parameter.verify_gpg.replace(n,function(e){var t,n;return void 0,n=e.split("."),t=z[n[0]],t&&t.uid&&n.length>1?t.uid+"."+n[1]:e})}),t},p=function(e){var t,n;return void 0,n=/[^@{][-\w\.]+[}]/igm,t=e.replace(n,function(e){var t,n;return n=e.split("."),t=z[n[0]],t&&t.uid&&n.length>1?t.uid+"."+n[1]:e}),t},l={},r=function(e,t,n){return void 0,l[e]={canvas:t,svg:n}},S=function(e){return l[e]},m=function(e){return delete l[e]},{canvasData:c,isCurrentTab:A,isResultRight:O,setCurrentTabId:R,searchStackAppById:I,processType:j,verify500:V,checkRepeatStackName:h,addProcess:i,getProcess:x,deleteProcess:y,filterProcess:b,initDataProcess:N,createUID:d,addCacheMap:n,delCacheMap:v,setCacheMap:q,getCacheMap:E,searchCacheMap:F,listCacheMap:M,initUnmanaged:L,listUnmanaged:H,addUnmanaged:u,delUnmanaged:g,addUnmanagedVpc:a,getUnmanagedVpc:T,listUnmanagedVpc:B,initSEList:C,listSE:D,addSEList:s,initSENameUIDList:k,listSENameUID:P,addSENameUIDList:o,filterStateData:w,convertUID:p,addCacheThumb:r,getCacheThumb:S,delCacheThumb:m}})}.call(this),function(){define("lib/common/convert",["MC","constant","underscore","jquery"],function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return N=function(e,t){var n,r;for(n in e)r=e[n],typeof r=="string"&&t.resource[n[0].toUpperCase()+n.slice(1)]!==void 0&&(t.resource[n[0].toUpperCase()+n.slice(1)]=r);return t},c=function(t){var n,r,i,s,o,u,a,f,l;n={uid:e.guid(),type:"AWS.VPC.NetworkInterface",name:t.tagSet&&t.tagSet.Name?t.tagSet.Name:t.networkInterfaceId,serverGroupUid:"",serverGroupName:"",number:1,index:0,resource:{PrivateIpAddressSet:[],Status:"",GroupSet:[],PrivateDnsName:"",SourceDestCheck:"",RequestId:"",MacAddress:"",OwnerId:"",RequestManaged:"",SecondPriIpCount:"",Attachment:{DeviceIndex:"",InstanceId:"",AttachmentId:"",AttachTime:""},AvailabilityZone:"",SubnetId:"",Description:"",VpcId:"",PrivateIpAddress:"",NetworkInterfaceId:""}};if(t.attachment&&t.attachment.instanceOwnerId==="amazon-elb")return!1;t.attachment&&(n.resource.Attachment.DeviceIndex=t.attachment.deviceIndex,n.resource.Attachment.InstanceId=t.attachment.instanceId,n.resource.Attachment.AttachmentId=t.attachment.attachmentId,n.resource.Attachment.AttachTime=t.attachment.attachTime),f=t.privateIpAddressesSet.item;for(s=0,u=f.length;s<u;s++)i=f[s],n.resource.PrivateIpAddressSet.push({PrivateIpAddress:i.privateIpAddress,AutoAssign:"false",Primary:i.primary});l=t.groupSet.item;for(o=0,a=l.length;o<a;o++)r=l[o],n.resource.GroupSet.push({GroupId:r.groupId,GroupName:r.groupName});return n=N(t,n),n},p=function(t){var n;return n={uid:e.guid(),type:"AWS.EC2.Instance",name:t.tagSet&&t.tagSet.Name?t.tagSet.Name:t.instanceId,serverGroupUid:"",serverGroupName:"",number:1,index:0,state:"",software:{},resource:{RamdiskId:"",InstanceId:"",DisableApiTermination:"",ShutdownBehavior:"",SecurityGroupId:[],SecurityGroup:[],UserData:{Base64Encoded:"",Data:""},ImageId:"",Placement:{Tenancy:"",AvailabilityZone:"",GroupName:""},PrivateIpAddress:"",BlockDeviceMapping:[],KernelId:"",SubnetId:"",KeyName:"",VpcId:"",InstanceType:"",Monitoring:"",EbsOptimized:"",NetworkInterface:[]}},n.resource.Placement.AvailabilityZone=t.placement.availabilityZone,n.resource.Placement.Tenancy=t.placement.tenancy,n=N(t,n),n},y=function(t){var n,r,i,s,o,u,a,f,l;r={uid:e.guid(),type:"AWS.EC2.SecurityGroup",name:t.groupName,resource:{IpPermissions:[],IpPermissionsEgress:[],GroupId:"",Default:"",VpcId:"",GroupName:"",OwnerId:"",GroupDescription:""}},r=N(t,r);if(t.ipPermissions){f=t.ipPermissions.item;for(s=0,u=f.length;s<u;s++)i=f[s],n="",i.groups&&i.groups.item[0].groupId?n=i.groups.item[0].groupId:i.ipRanges&&(n=i.ipRanges.item[0].cidrIp),n&&r.resource.IpPermissions.push({IpProtocol:i.ipProtocol,IpRanges:n,FromPort:i.fromPort?i.fromPort:"",ToPort:i.toPort?i.toPort:""})}if(t.ipPermissionsEgress){l=t.ipPermissionsEgress.item;for(o=0,a=l.length;o<a;o++)i=l[o],n="",i.groups&&i.groups.item[0].groupId?n=i.groups.item[0].groupId:i.ipRanges&&(n=i.ipRanges.item[0].cidrIp),n&&r.resource.IpPermissionsEgress.push({IpProtocol:i.ipProtocol,IpRanges:n,FromPort:i.fromPort?i.fromPort:"",ToPort:i.toPort?i.toPort:""})}return r},l=function(t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;r={uid:e.guid(),type:"AWS.ELB",name:t.LoadBalancerName,resource:{HealthCheck:{Timeout:"5",Target:"HTTP:80/index.html",HealthyThreshold:"9",UnhealthyThreshold:"4",Interval:"30"},Policies:{AppCookieStickinessPolicies:[],OtherPolicies:[],LBCookieStickinessPolicies:[]},BackendServerDescriptions:[],SecurityGroups:[],CreatedTime:"",CanonicalHostedZoneNameID:"",ListenerDescriptions:[],DNSName:"",Scheme:"",CanonicalHostedZoneName:"",Instances:[],SourceSecurityGroup:{OwnerAlias:"",GroupName:""},Subnets:[],VpcId:"",LoadBalancerName:"",AvailabilityZones:[],CrossZoneLoadBalancing:"false"}},r.resource.HealthCheck.Timeout=t.HealthCheck.Timeout,r.resource.HealthCheck.Interval=t.HealthCheck.Interval,r.resource.HealthCheck.UnhealthyThreshold=t.HealthCheck.UnhealthyThreshold,r.resource.HealthCheck.Target=t.HealthCheck.Target,r.resource.HealthCheck.HealthyThreshold=t.HealthCheck.HealthyThreshold;if(t.SecurityGroups){y=t.SecurityGroups.member;for(a=0,h=y.length;a<h;a++)o=y[a],r.resource.SecurityGroups.push(o)}if(t.Subnets){b=t.Subnets.member;for(f=0,p=b.length;f<p;f++)u=b[f],r.resource.Subnets.push(u)}t.VPCId&&(r.resource.VpcId=t.VPCId);if(t.AvailabilityZones){w=t.AvailabilityZones.member;for(l=0,d=w.length;l<d;l++)n=w[l],r.resource.AvailabilityZones.push(n)}if(t.ListenerDescriptions){E=t.ListenerDescriptions.member;for(c=0,v=E.length;c<v;c++)s=E[c],r.resource.ListenerDescriptions.push({PolicyNames:s.PolicyNames?s.PolicyNames:"",Listener:{LoadBalancerPort:s.Listener.LoadBalancerPort,InstanceProtocol:s.Listener.InstanceProtocol,Protocol:s.Listener.Protocol,SSLCertificateId:s.Listener.SSLCertificateId?s.Listener.SSLCertificateId:"",InstancePort:s.Listener.InstancePort}})}if(t.Instances){S=t.Instances.member;for(g=0,m=S.length;g<m;g++)i=S[g],r.resource.Instances.push(i)}return r=N(t,r),r},i=function(t){var n,r,i,s,o,u,a,f;r={uid:e.guid(),type:"AWS.VPC.NetworkAcl",name:t.networkAclId,resource:{RouteTableId:"",NetworkAclId:"",VpcId:"",Default:"",EntrySet:[],AssociationSet:[]}},a=t.entrySet.item;for(i=0,o=a.length;i<o;i++)n=a[i],r.resource.EntrySet.push({RuleAction:n.ruleAction,Protocol:n.protocol,CidrBlock:n.cidrBlock,Egress:n.egress,IcmpTypeCode:{Type:n.icmpTypeCode?n.icmpTypeCode.type:"",Code:n.icmpTypeCode?n.icmpTypeCode.code:""},PortRange:{To:n.portRange?n.portRange.to:"",From:n.portRange?n.portRange.from:""},RuleNumber:n.ruleNumber});if(t.associationSet){f=t.associationSet.item;for(s=0,u=f.length;s<u;s++)n=f[s],r.resource.AssociationSet.push({NetworkAclAssociationId:n.networkAclAssociationId,NetworkAclId:n.networkAclId,SubnetId:n.subnetId})}return r=N(t,r),r},g=function(t){var n,r,i,s,o,u,a,f,l,c,h,p,d;s={uid:e.guid(),type:"AWS.VPC.RouteTable",name:t.routeTableId,resource:{VpcId:"",PropagatingVgwSet:[],RouteSet:[],RouteTableId:"",AssociationSet:[]}};if(t.associationSet){h=t.associationSet.item;for(o=0,f=h.length;o<f;o++)n=h[o],s.resource.AssociationSet.push({Main:n.main,RouteTableId:n.routeTableId,SubnetId:n.subnetId?n.subnetId:"",RouteTableAssociationId:n.routeTableAssociationId})}p=t.routeSet.item;for(u=0,l=p.length;u<l;u++)i=p[u],s.resource.RouteSet.push({State:i.state,Origin:i.origin,InstanceId:i.instanceId?i.instanceId:"",InstanceOwnerId:i.instanceOwnerId?i.instanceOwnerId:"",GatewayId:i.gatewayId?i.gatewayId:"",NetworkInterfaceId:i.networkInterfaceId?i.networkInterfaceId:"",DestinationCidrBlock:i.destinationCidrBlock});if(t.propagatingVgwSet){d=t.propagatingVgwSet.item;for(a=0,c=d.length;a<c;a++)r=d[a],s.resource.PropagatingVgwSet.push(r.gatewayId)}return s=N(t,s),s},w=function(t){var n;return n={uid:e.guid(),type:"AWS.VPC.Subnet",name:t.tagSet&&t.tagSet.Name?t.tagSet.Name:t.subnetId,resource:{AvailabilityZone:"",CidrBlock:"",SubnetId:"",VpcId:"",AvailableIpAddressCount:"",State:""}},n=N(t,n),n},S=function(t){var n;return n={uid:e.guid(),type:"AWS.VPC.VPC",name:t.tagSet&&t.tagSet.Name?t.tagSet.Name:t.vpcId,resource:{EnableDnsHostnames:"",DhcpOptionsId:"",CidrBlock:"",State:"",InstanceTenancy:"",VpcId:"",IsDefault:"",EnableDnsSupport:""}},n=N(t,n),n},d=function(t){var n;return n={uid:e.guid(),type:"AWS.EC2.KeyPair",name:t.keyName,resource:{KeyFingerprint:t.keyFingerprint,KeyName:t.keyName}},n},T=function(t){var n;return n={uid:e.guid(),type:"AWS.EC2.EBS.Volume",name:t.attachmentSet?t.attachmentSet.item[0].device:"",serverGroupUid:"",serverGroupName:"",number:1,index:0,resource:{VolumeId:"",CreateTime:"",AvailabilityZone:"",Size:"1",Status:"",SnapshotId:"",Iops:"",AttachmentSet:{VolumeId:"",Status:"",AttachTime:"",InstanceId:"",DeleteOnTermination:"",Device:""},VolumeType:"standard"}},t.attachmentSet&&(n.resource.AttachmentSet.AttachTime=t.attachmentSet.item[0].attachTime,n.resource.AttachmentSet.Status=t.attachmentSet.item[0].status,n.resource.AttachmentSet.VolumeId=t.attachmentSet.item[0].volumeId,n.resource.AttachmentSet.InstanceId=t.attachmentSet.item[0].instanceId,n.resource.AttachmentSet.DeleteOnTermination=t.attachmentSet.item[0].deleteOnTermination,n.resource.AttachmentSet.Device=t.attachmentSet.item[0].device),n=N(t,n),n},s=function(t){var n;return n={type:"AWS.AutoScaling.Group",name:t.AutoScalingGroupName,uid:e.guid(),resource:{AutoScalingGroupARN:"",AutoScalingGroupName:"",AvailabilityZones:[],CreatedTime:"",DefaultCooldown:"",DesiredCapacity:"",EnabledMetrics:[],HealthCheckGracePeriod:"",HealthCheckType:"",Instances:[],LaunchConfigurationName:"",LoadBalancerNames:[],MaxSize:"2",MinSize:"1",PlacementGroup:"",Status:"",SuspendedProcesses:[],Tags:"",TerminationPolicies:[],VPCZoneIdentifier:"",InstanceId:"",ShouldDecrementDesiredCapacity:""}},t.LoadBalancerNames&&(n.resource.LoadBalancerNames=t.LoadBalancerNames.member),n.resource.TerminationPolicies=t.TerminationPolicies.member,n.resource.AvailabilityZones=t.AvailabilityZones.member,n=N(t,n),n},v=function(t){var n;return n={name:t.LaunchConfigurationName,uid:e.guid(),type:"AWS.AutoScaling.LaunchConfiguration",resource:{BlockDeviceMapping:[],CreatedTime:"",EbsOptimized:"",IamInstanceProfile:"",ImageId:"",InstanceMonitoring:"",InstanceType:"",KernelId:"",KeyName:"",LaunchConfigurationARN:"",LaunchConfigurationName:"",RamdiskId:"",SecurityGroups:[],SpotPrice:"",UserData:""}},n.resource.SecurityGroups=t.SecurityGroups.member,t.BlockDeviceMappings&&(n.resource.BlockDeviceMapping=t.BlockDeviceMappings.member),n.resource.InstanceMonitoring=t.InstanceMonitoring.Enabled,n=N(t,n),n},f=function(t){var n;return n={uid:e.guid(),type:"AWS.EC2.EIP",name:"",resource:{InstanceId:"",PrivateIpAddress:"",NetworkInterfaceId:"",NetworkInterfaceOwnerId:"",AllowReassociation:"",Domain:"standard",AssociationId:"",PublicIp:"",AllocationId:""}},n=N(t,n),n},u=function(t){var n;return n={uid:e.guid(),type:"AWS.VPC.CustomerGateway",name:t.customerGatewayId,resource:{Type:"",BgpAsn:"",CustomerGatewayId:"",State:"",IpAddress:""}},n=N(t,n),n},h=function(t){var n;return n={uid:e.guid(),type:"AWS.VPC.InternetGateway",name:"InternetGateway",resource:{InternetGatewayId:t.internetGatewayId,AttachmentSet:[{VpcId:t.attachmentSet.item[0].vpcId,State:t.attachmentSet.item[0].state}]}},n},E=function(t){var n;return n={uid:e.guid(),type:"AWS.VPC.VPNGateway",name:"VirtualPrivateGateway",resource:{Attachments:[{VpcId:t.attachments.item[0].vpcId,State:t.attachments.item[0].state}],Type:t.type,VpnGatewayId:t.vpnGatewayId,State:t.state}},n},x=function(t){var n,r,i,s,o;r={uid:e.guid(),type:"AWS.VPC.VPNConnection",name:"VPN",resource:{CustomerGatewayConfiguration:"",Routes:[],State:"",Type:"ipsec.1",VpnGatewayId:"",Options:{StaticRoutesOnly:"true"},CustomerGatewayId:"",VpnConnectionId:""}},t.options&&t.options.staticRoutesOnly&&(r.resource.Options.StaticRoutesOnly=t.options.staticRoutesOnly);if(t.routes){o=t.routes;for(i=0,s=o.length;i<s;i++)n=o[i],r.resource.Routes.push({DestinationCidrBlock:n.destinationCidrBlock,Source:n.source,State:n.state})}return r=N(t,r),r},m=function(t){var n;return n={type:"AWS.AutoScaling.NotificationConfiguration",name:"",uid:e.guid(),resource:{AutoScalingGroupName:t.AutoScalingGroupName,NotificationType:t.NotificationType,TopicARN:t.TopicARN}},n},b=function(t){var n;return n={type:"AWS.AutoScaling.ScalingPolicy",name:t.PolicyName,uid:e.guid(),resource:{AdjustmentType:"",Alarms:[],AutoScalingGroupName:"",Cooldown:"",MinAdjustmentStep:"",PolicyARN:"",PolicyName:"",ScalingAdjustment:""}},t.Alarms&&(n.resource.Alarms=t.Alarms.member),n=N(t,n),n},a=function(t){var n,r,i,s,o,u,a,f,l,c;r={uid:e.guid(),type:"AWS.VPC.DhcpOptions",name:"default",resource:{VpcId:"",DhcpOptionsId:t.dhcpOptionsId,DhcpConfigurationSet:[]}};if(t.dhcpConfigurationSet){l=t.dhcpConfigurationSet.item;for(o=0,a=l.length;o<a;o++){n=l[o],i=[],c=n.valueSet;for(u=0,f=c.length;u<f;u++)s=c[u],i.push({Value:s});r.resource.DhcpConfigurationSet.push({Key:n.key,ValueSet:i})}}return r},o=function(t){var n;return n={uid:e.guid(),type:"AWS.EC2.AvailabilityZone",name:t.zoneName,resource:{ZoneName:t.zoneName,RegionName:t.regionName}},n},{convertAZ:o,convertDHCP:a,convertScalingPolicy:b,convertNC:m,convertVPN:x,convertVGW:E,convertIGW:h,convertCGW:u,convertEIP:f,convertLC:v,convertASG:s,convertVolume:T,convertKP:d,convertVPC:S,convertSubnet:w,convertRTB:g,convertACL:i,convertELB:l,convertSGGroup:y,convertEni:c,convertInstance:p}})}.call(this),function(){define("common_handle",["MC","lib/common/cookie","lib/common/other","lib/common/convert"],function(e,t,n,r){return e.common={cookie:t,other:n,convert:r},e.common})}.call(this),define("lib/deprecated",function(){});