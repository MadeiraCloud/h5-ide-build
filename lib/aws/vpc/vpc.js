(function(){define(["MC","constant","underscore","Design"],function(e,t,n,r){var i,s,o,u,a,f;return a=function(){var e;return e=r.modelClassForType(t.AWS_RESOURCE_TYPE.AWS_VPC_VPC).theVPC(),e?e.id:null},f=function(r,i){var s,o,u,a,f,l,c;return o=!1,l=0,f=[],n.each(e.canvas_data.component,function(e){var n;return e.type===t.AWS_RESOURCE_TYPE.AWS_VPC_Subnet&&(l++,n=e.resource.CidrBlock,f.push(n)),null}),a=[],u=e.aws.subnet.autoAssignSimpleCIDR(r,f,i),u.length?a=u:a=e.aws.subnet.autoAssignAllCIDR(r,l),s=!1,n.each(a,function(t){return e.validate("cidr",t)||(s=!0),null}),s?!1:(n.each(e.canvas_data.component,function(n){var i;return n.type===t.AWS_RESOURCE_TYPE.AWS_VPC_Subnet&&(i=n.resource.CidrBlock,e.aws.subnet.isInVPCCIDR(r,i)||(o=!0)),n.type===t.AWS_RESOURCE_TYPE.AWS_VPC_RouteTable&&(n.resource.RouteSet[0].DestinationCidrBlock=r),null}),o?(c=0,n.each(e.canvas_data.component,function(n){var r;if(n.type===t.AWS_RESOURCE_TYPE.AWS_VPC_Subnet)return r=a[c],e.canvas_data.component[n.uid].resource.CidrBlock=r,e.aws.subnet.updateAllENIIPList(n.uid,!1),e.canvas.update(n.uid,"text","label",n.name+" ("+r+")"),c++}),!0):!0)},i=function(){var t,r,i,s,o;return e.canvas_data.platform!=="default-vpc"?!1:(i=e.canvas_data.region,t=e.data.account_attribute[i],o=t.default_vpc,s=t.default_subnet,o==="none"?!1:!s||n.keys(s).length===0?!1:(r=!0,n.each(s,function(e,t){return e.defaultForAz!=="true"&&(r=!1),e.vpcId!==o&&(r=!1),e.state!=="available"&&(r=!1),null}),r?!0:!1))},u=function(t){var n,r,i,s,o,u,a;return u=e.canvas_data.component[t],o="",u.resource.AvailabilityZone?o=u.resource.AvailabilityZone:o=u.resource.Placement.AvailabilityZone,r=e.canvas_data.region,n=e.data.account_attribute[r],s=n.default_vpc,i=n.default_subnet,a=i[o],a},o=function(t){return e.data.account_attribute[r.instance().region()].default_subnet[t]},s=function(){var r,i,s,o,u,a;return a=t.AWS_RESOURCE_TYPE,u=e.canvas_data.component,s=n.extend(u,{}),o=e.aws.aws.checkDefaultVPC(),r=e.data.config[e.canvas_data.region].zone.item,i={},n.each(r,function(t){var n,r,s,o;return n=t.zoneName,r={},o=e.aws.vpc.getAZSubnetForDefaultVPC(n),s=null,o?s=o.subnetId:s="",i[n]=s,null}),n.each(s,function(t){var r,u,f,l,c,h,p,d,v;return c=t.type,h=t.uid,c===a.AWS_EC2_Instance?(d=t.resource.Placement.AvailabilityZone,s[h].resource.VpcId=o,s[h].resource.SubnetId=i[d]):c===a.AWS_VPC_NetworkInterface?(p=t.resource.AvailabilityZone,s[h].resource.VpcId=o,s[h].resource.SubnetId=i[p]):c===a.AWS_ELB?(s[h].resource.VpcId=o,l=e.aws.elb.getAZAryForDefaultVPC(h),v=n.map(l,function(e){return i[e]}),s[h].resource.Subnets=v):c===a.AWS_EC2_SecurityGroup?s[h].resource.VpcId=o:c===a.AWS_AutoScaling_Group&&(r=t.resource.AvailabilityZones,u=n.map(r,function(e){return i[e]}),f=u.join(" , "),s[h].resource.VPCZoneIdentifier=f),null}),s},{getVPCUID:a,updateAllSubnetCIDR:f,checkFullDefaultVPC:i,getSubnetForDefaultVPC:u,getAZSubnetForDefaultVPC:o,generateComponentForDefaultVPC:s}})}).call(this);