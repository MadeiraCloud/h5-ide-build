(function(){define(["jquery","MC"],function(e,t){var n,r,i;return n=function(n,r){var i,s;return s=t.guid(),i=e.extend(!0,{},t.canvas.VPN_JSON.data),i.uid=s,i.resource.VpnGatewayId=t.aws.aws.genResRef(n,"resource.VpnGatewayId"),i.resource.CustomerGatewayId=t.aws.aws.genResRef(r,"resource.CustomerGatewayId"),t.canvas_data.component[s]=i,null},r=function(e,n){var r,i,s,o,u,a;o=t.aws.aws.genResRef(e,"resource.VpnGatewayId"),r=t.aws.aws.genResRef(n,"resource.CustomerGatewayId"),u=t.canvas_data.component,a=[];for(s in u){i=u[s];if(i.type==="AWS.VPC.VPNConnection"&&i.resource.VpnGatewayId===o&&i.resource.CustomerGatewayId===r){delete t.canvas_data.component[i.uid];break}a.push(void 0)}return a},i=function(n,r){var i,s;return i="{}",r.customerGatewayConfiguration?(r=e.xml2json(e.parseXML(r.customerGatewayConfiguration)),r?(r=r.vpn_connection,s=_.map(n,function(e){var n,i;return n={vpnConnectionId:r["@attributes"].id||"",vpnGatewayId:r.vpn_gateway_id||"",customerGatewayId:r.customer_gateway_id||""},n.tunnel=_.map(r.ipsec_tunnel,function(e,t){var n;return n={},n.number=t+1,n.ike_protocol_method=e.ike.authentication_protocol||"",n.ike_pre_shared_key=e.ike.pre_shared_key||"",n.ike_authentication_protocol_algorithm=e.ike.authentication_protocol||"",n.ike_encryption_protocol=e.ike.encryption_protocol||"",n.ike_lifetime=e.ike.lifetime||"",n.ike_mode=e.ike.mode||"",n.ike_perfect_forward_secrecy=e.ike.perfect_forward_secrecy||"",n.ipsec_protocol=e.ipsec.protocol||"",n.ipsec_authentication_protocol=e.ipsec.authentication_protocol||"",n.ipsec_encryption_protocol=e.ipsec.encryption_protocol||"",n.ipsec_lifetime=e.ipsec.lifetime||"",n.ipsec_mode=e.ipsec.mode||"",n.ipsec_perfect_forward_secrecy=e.ipsec.perfect_forward_secrecy||"",n.ipsec_interval=e.ipsec.dead_peer_detection.interval||"",n.ipsec_retries=e.ipsec.dead_peer_detection.retries||"",n.tcp_mss_adjustment=e.ipsec.tcp_mss_adjustment||"",n.clear_df_bit=e.ipsec.clear_df_bit||"",n.fragmentation_before_encryption=e.ipsec.fragmentation_before_encryption||"",n.customer_gateway_outside_address=e.customer_gateway.tunnel_outside_address.ip_address||"",n.vpn_gateway_outside_address=e.vpn_gateway.tunnel_outside_address.ip_address||"",n.customer_gateway_inside_address=e.customer_gateway.tunnel_inside_address.ip_address+"/"+e.customer_gateway.tunnel_inside_address.network_cidr||"",n.vpn_gateway_inside_address=e.vpn_gateway.tunnel_inside_address.ip_address+"/"+e.customer_gateway.tunnel_inside_address.network_cidr||"",n.next_hop=e.vpn_gateway.tunnel_inside_address.ip_address||"",n}),i=n.vpnConnectionId||"download_configuration",n=t.template.configurationDownload(n),'{"download":true, "filecontent":"'+window.btoa(n)+'", "filename":"'+i+'", "btnname":"'+e.name+'"}'}),"[ "+s.join(",")+" ]"):i):i},{addVPN:n,delVPN:r,generateDownload:i}})}).call(this);