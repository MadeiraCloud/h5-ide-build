(function(){define(["MC","constant"],function(e,t){var n,r,i;return r=function(e){var t,n,r;if(!e)return"unknown";if(e.osType)return e.osType;r=["centos","redhat","rhel","ubuntu","debian","fedora","gentoo","opensuse","suse","amazon","amzn"],n="linux-other",t=[],e.platform&&e.platform==="windows"?t.push("windows"):(e.name&&(t=r.filter(function(t){return~e.name.toLowerCase().indexOf(t)})),t.length===0&&"description"in e&&e.description&&(t=r.filter(function(t){return~e.description.toLowerCase().indexOf(t)})),t.length===0&&"imageLocation"in e&&e.imageLocation&&(t=r.filter(function(t){return~e.imageLocation.toLowerCase().indexOf(t)}))),t.length>0&&(n=t[0]);switch(n){case"rhel":n="redhat";break;case"amzn":n="amazon"}return n},n=function(n){var r,i,s,o,u,a,f,l;if(!n)return[];try{f=e.canvas_data.region,o=e.data.instance_type[f],l=e.data.region_instance_type,i=null,l&&(i=l[f]),r=o,i&&n.osFamily&&(r=i);if(!r)return[];i?(u=n.osFamily,u||(a=n.osType,u=t.OS_TYPE_MAPPING[a]),r=r[u]):n.osType==="windows"?r=r.windows:r=r.linux,n.rootDeviceType==="ebs"?r=r.ebs:r=r["instance store"],n.architecture==="x86_64"?r=r[64]:r=r[32],r=r[n.virtualizationType||"paravirtual"]}catch(c){s=c,r=[]}if(!r||r.length<=0)r=e.data.config[f].region_instance_type;return r||(r=[]),r},i=function(t){var n,r,i,s,o;i=t.component,o=[];for(r in i)n=i[r],(s=n.type)==="AWS.EC2.Instance"||s==="AWS.AutoScaling.LaunchConfiguration"?e.data.dict_ami[n.resource.ImageId]?(t.layout.component.node[r].osType=e.data.dict_ami[n.resource.ImageId].osType,t.layout.component.node[r].architecture=e.data.dict_ami[n.resource.ImageId].architecture,o.push(t.layout.component.node[r].rootDeviceType=e.data.dict_ami[n.resource.ImageId].rootDeviceType)):o.push(void 0):o.push(void 0);return o},{setLayout:i,getOSType:r,getInstanceType:n}})}).call(this);