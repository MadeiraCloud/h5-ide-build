/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */

/*
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/

(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;e="https://api.mc3.io",o=function(e){return window.btoa(unescape(encodeURIComponent(e)))},s=function(e){return decodeURIComponent(escape(window.atob(e)))},c={COOKIE_OPTION:{expires:1,path:"/",domain:".mc3.io"},LOCAL_COOKIE_OPTION:{expires:1,path:"/"}},function(e){function t(e){return e}function n(e){return decodeURIComponent(e.replace(i," "))}function r(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return s.json?JSON.parse(e):e}catch(t){}}var i=/\+/g,s=e.cookie=function(i,o,u){if(void 0!==o){u=e.extend({},s.defaults,u);if("number"==typeof u.expires){var a=u.expires,f=u.expires=new Date;f.setDate(f.getDate()+a)}return o=s.json?JSON.stringify(o):String(o),document.cookie=[s.raw?i:encodeURIComponent(i),"=",s.raw?o:encodeURIComponent(o),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join("")}o=s.raw?t:n,u=document.cookie.split("; ");for(var a=i?void 0:{},f=0,l=u.length;f<l;f++){var c=u[f].split("="),h=o(c.shift()),c=o(c.join("="));if(i&&i===h){a=r(c);break}i||(a[h]=r(c))}return a};s.defaults={},e.removeCookie=function(t,n){return void 0!==e.cookie(t)?(e.cookie(t,"",e.extend({},n,{expires:-1})),!0):!1}}(jQuery);var _=_||function(e,t){var n={},r=n.lib={},i=function(){},s=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=s.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;e=e.sigBytes,this.clamp();if(r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),u=n.enc={},a=u.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16)),n.push((i&15).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return new o.init(n,t/2)}},f=u.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(e.charCodeAt(r)&255)<<24-8*(r%4);return new o.init(n,t)}},l=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(f.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return f.parse(unescape(encodeURIComponent(e)))}},c=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,s=this.blockSize,u=i/(4*s),u=t?e.ceil(u):e.max((u|0)-this._minBufferSize,0);t=u*s,i=e.min(4*t,i);if(t){for(var a=0;a<t;a+=s)this._doProcessBlock(r,a);a=r.splice(0,t),n.sigBytes-=i}return new o.init(a,i)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=c.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return(new e.init(n)).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return(new h.HMAC.init(e,n)).finalize(t)}}});var h=n.algo={};return n}(Math);(function(e){for(var t=_,n=t.lib,r=n.WordArray,i=n.Hasher,n=t.algo,s=[],o=[],u=function(e){return 4294967296*(e-(e|0))|0},a=2,f=0;64>f;){var l;e:{l=a;for(var c=e.sqrt(l),h=2;h<=c;h++)if(!(l%h)){l=!1;break e}l=!0}l&&(8>f&&(s[f]=u(e.pow(a,.5))),o[f]=u(e.pow(a,1/3)),f++),a++}var p=[],n=n.SHA256=i.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],u=n[3],a=n[4],f=n[5],l=n[6],c=n[7],h=0;64>h;h++){if(16>h)p[h]=e[t+h]|0;else{var d=p[h-15],v=p[h-2];p[h]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+p[h-7]+((v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10)+p[h-16]}d=c+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&f^~a&l)+o[h]+p[h],v=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&s^i&s),c=l,l=f,f=a,a=u+d|0,u=s,s=i,i=r,r=d+v|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+u|0,n[4]=n[4]+a|0,n[5]=n[5]+f|0,n[6]=n[6]+l|0,n[7]=n[7]+c|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[(i+64>>>9<<4)+14]=e.floor(r/4294967296),n[(i+64>>>9<<4)+15]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(n),t.HmacSHA256=i._createHmacHelper(n)})(Math),function(){var e=_,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,i=4*r;n.sigBytes>i&&(n=e.finalize(n)),n.clamp();for(var s=this._oKey=n.clone(),o=this._iKey=n.clone(),u=s.words,a=o.words,f=0;f<r;f++)u[f]^=1549556828,a[f]^=909522486;s.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),T=function(e){var t;return document.domain.indexOf("visualops.io")!==-1?t=c.COOKIE_OPTION:t=c.LOCAL_COOKIE_OPTION,$.cookie("usercode",e.usercode,t),$.cookie("username",s(e.usercode),t),$.cookie("email",e.email,t),$.cookie("session_id",e.session_id,t),$.cookie("account_id",e.account_id,t),$.cookie("mod_repo",e.mod_repo,t),$.cookie("mod_tag",e.mod_tag,t),$.cookie("state",e.state,t),$.cookie("has_cred",e.has_cred,t),$.cookie("is_invitated",e.is_invitated,t)},p=function(){var e;return document.domain.indexOf("visualops.io")!==-1?e=c.COOKIE_OPTION:e=c.LOCAL_COOKIE_OPTION,$.cookie("usercode","",e),$.cookie("username","",e),$.cookie("email","",e),$.cookie("session_id","",e),$.cookie("account_id","",e),$.cookie("mod_repo","",e),$.cookie("mod_tag","",e),$.cookie("state","",e),$.cookie("has_cred","",e),$.cookie("is_invitated","",e)},C=function(e){var t;return document.domain.indexOf("visualops.io")!==-1?t=c.COOKIE_OPTION:t=c.LOCAL_COOKIE_OPTION,$.cookie("has_cred",e,t)},L=function(e){var t,n;return document.domain.indexOf("visualops.io")!==-1?n=c.COOKIE_OPTION:n=c.LOCAL_COOKIE_OPTION,t=[e.usercode,e.email,e.session_id,e.account_id,e.mod_repo,e.mod_tag,e.state,e.has_cred,e.is_invitated],null},u=function(){return $.cookie("usercode")&&$.cookie("username")&&$.cookie("session_id")&&$.cookie("account_id")&&$.cookie("mod_repo")&&$.cookie("mod_tag")&&$.cookie("state")&&$.cookie("has_cred")&&$.cookie("is_invitated")?!0:!1},l=function(e){var t;return t={path:e},$.each($.cookie(),function(e,n){return $.removeCookie(n,t),null})},d=function(e){return $.cookie(e)},N=function(e,t){var n;return document.domain.indexOf("visualops.io")!==-1?n=c.COOKIE_OPTION:n=c.LOCAL_COOKIE_OPTION,$.cookie(e,t,n)},w=function(){return document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*lang\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")||"en-us"},h="reset",O=function(e){var t,n,r;return t=window.location.hash.split("#").pop().split("/"),n=window.location.pathname.split("/"),n.shift(),console.log(n,t),typeof e[r=n[0]]=="function"?e[r](n,t):void 0},v=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t,n;return t=Math.random()*16|0,n=e==="x"?t:t&3|8,n.toString(16)}).toUpperCase()},console.log(v()),window.xhr=null,i=function(t){return window.xhr=$.ajax({url:e+t.url,dataType:"json",type:"POST",data:JSON.stringify({jsonrpc:"2.0",id:v(),method:t.method||"",params:t.data||{}}),success:function(e){return t.success(e.result[1],e.result[0])},error:function(e,n,r){return console.log(r),t.error(n,-1)}})},Handlebars.registerHelper("i18n",function(e){return(typeof y=="function"?y(e):void 0)||e}),E=function(e){return $.ajax({url:"./nls/"+w()+"/lang.js",jsonp:!1,dataType:"jsonp",jsonpCallback:"define",beforeSend:function(){var e;return e=Handlebars.compile($("#loading-template").html()),$("#main-body").html(e())},success:function(e){return window.langsrc=e,console.log("Success",e)},error:function(e){return console.log(e,"error"),window.location="/500"}}).done(function(){return console.log("Loaded!",langsrc),e()})},window.onhashchange=function(){return b()},y=function(e){return langsrc[h][e]},S=function(e){var t;return t=Handlebars.compile($(e).html()),$("#main-body").html(t())},b=function(){return O({reset:function(e,n){var r;return h="reset",r=n[0],r==="password"?a(n[1],function(e){return e?(console.log("Right Verify Code!"),S("#password-template"),$("form.box-body").find("input").eq(0).focus(),$("#reset-form").on("submit",function(e){return e.preventDefault(),M()&&($("#reset-password").attr("disabled",!0).val(langsrc.reset.reset_waiting),t(n,$("#reset-pw").val()),console.log("jump...")),!1})):(console.log("Error Verify Code!"),window.location.hash="expire")}):r==="expire"?S("#expire-template"):r==="email"?(S("#email-template"),$("form.box-body").find("input").eq(0).focus()):r==="success"?S("#success-template"):(S("#default-template"),$("#reset-pw-email").focus(),$("#reset-pw-email").keyup(function(){return this.value?$("#reset-btn").removeAttr("disabled"):$("#reset-btn").attr("disabled",!0)}),$("#reset-form").on("submit",function(){return console.log("sendding...."),$("#reset-pw-email").off("keyup"),$("#reset-btn").attr("disabled",!0),$("#reset-pw-email").attr("disabled",!0),$("#reset-btn").val(window.langsrc.reset.reset_waiting),x($("#reset-pw-email").val()),!1}))},login:function(e,t){var r,i,s,o;return u()&&(window.location="/"),h="login",console.log(e,t),S("#login-template"),i=$("#login-user"),r=$("#login-password"),o=$("#login-btn").attr("disabled",!1),$("#login-form input").eq(0).focus(),s=function(){if($(this).val().trim())return $(this).parent().removeClass("error")},i.on("keyup",s),r.on("keyup",s),$("#login-form").on("submit",function(e){return e.preventDefault(),i.val()&&r.val()?($(".error-msg").hide(),$(".control-group").removeClass("error"),o.attr("disabled",!0).val(langsrc.reset.reset_waiting),n([i.val(),r.val()],function(e){return $("#error-msg-1").show(),o.attr("disabled",!1).val(langsrc.login["login-btn"])})):($("#error-msg-2").show(),i.val().trim()?i.parent().removeClass("error"):i.parent().addClass("error"),r.val().trim()?r.parent().removeClass("error"):r.parent().addClass("error"),!1)})},register:function(e,t){var n,i,s,o,a,l,c,p,d,v,m;return u()&&(window.location="/"),h="register",console.log(e,t),t[0]==="success"?(S("#success-template"),$("#register-get-start").click(function(){return window.location="/"}),!1):(S("#register-template"),i=$("#register-form"),i.find("input").eq(0).focus(),o=$("#register-username"),n=$("#register-email"),s=$("#register-password"),m=void 0,$("#register-btn").attr("disabled",!1),d=function(e,t,n){var r,i;return i=o.val(),r=$("#username-verification-status"),i.trim()!==""?/[^A-Za-z0-9\_]{1}/.test(i)!==!0?i.length>40?(r.removeClass("verification-status").addClass("error-status").text(langsrc.register.username_maxlength),t?t(0):!1):(r.hasClass("error-status")&&r.removeClass("verification-status").removeClass("error-status").text(""),t?l(i,r,t):!0):(r.removeClass("verification-status").addClass("error-status").text(langsrc.register.username_not_matched),t?t(0):!1):(r.removeClass("verification-status").addClass("error-status").text(langsrc.register.username_required),t?t(0):!1)},c=function(e,t,r){var i,s,o;return i=n.val(),o=$("#email-verification-status"),s=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,i.trim()!==""?s.test(i)?(o.hasClass("error-status")&&o.removeClass("verification-status").removeClass("error-status").text(""),t?a(i,o,t):!0):(o.removeClass("verification-status").addClass("error-status").text(langsrc.register.email_not_valid),t?t(0):!1):(o.removeClass("verification-status").addClass("error-status").text(langsrc.register.email_required),t?t(0):!1)},p=function(e,t){var n,r;return n=s.val(),r=$("#password-verification-status"),n.trim()!==""?n.length>5?(r.removeClass("verification-status").removeClass("error-status").text(""),t?t(1):!0):(r.removeClass("verification-status").addClass("error-status").text(langsrc.register.password_shorter),t?t(0):!1):(r.removeClass("verification-status").addClass("error-status").text(langsrc.register.password_required),t?t():!1)},l=function(e,t,n){var r;return(r=window.xhr)!=null&&r.abort(),window.clearTimeout(m),console.log("aborted!",m),m=window.setTimeout(function(){return f([e,null],function(e){return e?e==="error"?console.log("Net Work Error while"):(t.removeClass("verification-status").addClass("error-status").text(langsrc.register.username_taken),typeof n=="function"?n(0):void 0):(t.removeClass("error-status").addClass("verification-status").show().text(langsrc.register.username_available),typeof n=="function"?n(1):void 0)})},500)},a=function(e,t,n){var r;return(r=window.xhr)!=null&&r.abort(),window.clearTimeout(m),m=window.setTimeout(function(){return f([null,e],function(e){return e?e==="error"?console.log("NetWork Error"):(t.removeClass("verification-status").addClass("error-status").text(langsrc.register.email_used),typeof n=="function"?n(0):void 0):(t.removeClass("error-status").addClass("verification-status").show().text(langsrc.register.email_available),typeof n=="function"?n(1):void 0)})},500)},v=function(){return $("#register-btn").attr("disabled",!1).val(langsrc.register["register-btn"])},o.on("keyup",function(e){return d(e,function(e){return e||v(),e})}),n.on("keyup",function(e){return c(e,function(e){return e||v(),e})}),s.on("keyup",function(e){return p(e,function(e){return e||v(),e})}),i.on("submit",function(e){return e.preventDefault(),o.next().hasClass("error-status")||n.next().hasClass("error-status")?(console.log("Error Message Exist"),!1):d()&&c()&&p()?($("#register-btn").attr("disabled",!0).val(langsrc.register.reginster_waiting),console.log("check user input here."),d(e,function(t){return t?c(e,function(i){return i?p(e,function(e){if(!e)return v(),!1;if(t&&i&&e)return console.log("Success!!!!!"),r([o.val(),s.val(),n.val()],function(e){return v()})}):(v(),!1)}):(v(),!1)})):!1}))}})},M=function(){var e,t;return e=$("#password-verification-status"),t=$("#reset-pw").val().trim(),e.removeClass("error-status"),t!==""?t.length>5?(e.hide(),!0):(e.addClass("error-status").show().text(langsrc.reset.reset_password_shorter),!1):(e.addClass("error-status").show().text(langsrc.reset.reset_password_required),!1)},A=function(){return console.log("showErrorMessage"),$("#reset-pw-email").attr("disabled",!1),$("#reset-btn").attr("disabled",!1).val(window.langsrc.reset.reset_btn),$("#email-verification-status").removeClass("verification-status").addClass("error-msg").show().text(langsrc.reset.reset_error_state),!1},m=function(e){return console.log("ERROR_CODE_MESSAGE",langsrc.service["ERROR_CODE_"+e+"_MESSAGE"])},g=function(e){return console.log(e),window.location="/500"},a=function(e,t){return i({url:"/account/",method:"check_validation",data:[e,"reset"],success:function(e,n){return n?(m(n),t(!1)):(console.log(e),t(!0))},error:function(e){return g(e)}})},k=function(e){var t,n;return p(),n={},n.usercode=e[0],n.email=e[1],n.session_id=e[2],n.account_id=e[3],n.mod_repo=e[4],n.mod_tag=e[5],n.state=e[6],n.has_cred=e[7],n.is_invitated=e[8],T(n),L(n),localStorage.setItem("email",s(d("email"))),localStorage.setItem("user_name",d("username")),t=function(){var e,t;return t="4tGsMJzq_2gJmwGDQgtP2En1rFlZEvBhWQWEOTKE",e=_.HmacSHA256(s($.cookie("email")),t),console.log("hash.toString(CryptoJS.enc.Hex) = "+e.toString(_.enc.Hex)),e.toString(_.enc.Hex)},localStorage.setItem("user_hash",t())},r=function(e,t){return console.log(e),i({url:"/account/",method:"register",data:e,success:function(e,n){return n?t(n):(console.log("registered successfully"),k(e),window.location.hash="success")},error:function(e){return g(e)}})},n=function(e,t){return i({url:"/session/",method:"login",data:e,success:function(e,n){return n?t(n):(console.log("Login Now!"),k(e),window.location="/")},error:function(e){return g(e)}})},x=function(e){return f([e,null],function(t){return t?i({url:"/account/",method:"reset_password",data:[e],success:function(e,t){return t?(m(t),A(),!1):(console.log(e,t),window.location.hash="email",!0)},error:function(e){return g(e)}}):(A(),!1)})},f=function(e,t){return i({url:"/account/",method:"check_repeat",data:e,success:function(e,n){return console.log(e,n),n?(t(n),!1):t(n)},error:function(e){return console.log("Net Work Error"),t("error")}})},t=function(e,t){return i({url:"/account/",method:"update_password",data:[e[1],t],success:function(e,t){return console.log(e,t),t?m(t):window.location.hash="success"},error:function(e){return g(e)}}),!1},E(b)}).call(this);