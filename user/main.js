(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D;e="api.visualops.io",t="http://",A=!1,y=!0,A=y,t="https://",w=window.location,window.language=window.version="";if(A&&w.protocol==="http:"){window.location=w.href.replace("http:","https:");return}n={expires:30,path:"/"},D=null,a=function(e){return window.btoa(unescape(encodeURIComponent(e)))},u=function(e){return decodeURIComponent(escape(window.atob(e)))},N=function(e){var t;return document.domain.indexOf("visualops.io")!==-1?t=constant.COOKIE_OPTION:t=constant.LOCAL_COOKIE_OPTION,$.cookie("usercode",e.usercode,t),$.cookie("username",u(e.usercode),t),$.cookie("email",e.email,t),$.cookie("session_id",e.session_id,t),$.cookie("account_id",e.account_id,t),$.cookie("mod_repo",e.mod_repo,t),$.cookie("mod_tag",e.mod_tag,t),$.cookie("state",e.state,t),$.cookie("has_cred",e.has_cred,t),$.cookie("is_invitated",e.is_invitated,t)},p=function(){var e;return document.domain.indexOf("visualops.io")!==-1?e=constant.COOKIE_OPTION:e=constant.LOCAL_COOKIE_OPTION,$.cookie("usercode","",e),$.cookie("username","",e),$.cookie("email","",e),$.cookie("session_id","",e),$.cookie("account_id","",e),$.cookie("mod_repo","",e),$.cookie("mod_tag","",e),$.cookie("state","",e),$.cookie("has_cred","",e),$.cookie("is_invitated","",e)},C=function(e){var t;return document.domain.indexOf("visualops.io")!==-1?t=constant.COOKIE_OPTION:t=constant.LOCAL_COOKIE_OPTION,$.cookie("has_cred",e,t)},L=function(e){var t,n;return document.domain.indexOf("visualops.io")!==-1?n=constant.COOKIE_OPTION:n=constant.LOCAL_COOKIE_OPTION,t=[e.usercode,e.email,e.session_id,e.account_id,e.mod_repo,e.mod_tag,e.state,e.has_cred,e.is_invitated],null},f=function(){return $.cookie("usercode")&&$.cookie("username")&&$.cookie("session_id")&&$.cookie("account_id")&&$.cookie("mod_repo")&&$.cookie("mod_tag")&&$.cookie("state")&&$.cookie("has_cred")&&$.cookie("is_invitated")?!0:!1},E=function(){return document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*lang\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")||"en-us"},h="reset",M=function(e){var t,n,r;return t=window.location.hash.split("#").pop().split("/"),n=window.location.pathname.split("/"),n.shift(),console.log(n,t),typeof e[r=n[0]]=="function"?e[r](n,t):void 0},d=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t,n;return t=Math.random()*16|0,n=e==="x"?t:t&3|8,n.toString(16)}).toUpperCase()},o=function(n){return D=$.ajax({url:t+e+n.url,dataType:"json",type:"POST",data:JSON.stringify({jsonrpc:"2.0",id:d(),method:n.method||"",params:n.data||{}}),success:function(e){return n.success(e.result[1],e.result[0])},error:function(e,t,r){return console.log(r),n.error(t,-1)}}),console.log("Sending Ajax Request")},Handlebars.registerHelper("i18n",function(e){return(typeof g=="function"?g(e):void 0)||e}),S=function(e){return $.ajax({url:"./nls/"+E()+"/lang.js",jsonp:!1,dataType:"jsonp",jsonpCallback:"define",beforeSend:function(){var e;return e=Handlebars.compile($("#loading-template").html()),$("#main-body").html(e())},success:function(e){return window.langsrc=e,console.log("Success",e)},error:function(e){return window.location="/500",console.log(e,"error")}}).done(function(){return console.log("Loaded!",langsrc),e()})},window.onhashchange=function(){return b()},g=function(e){return langsrc[h][e]},x=function(e){var t;return t=Handlebars.compile($(e).html()),$("#main-body").html(t())},b=function(){var e,t,n;return n=navigator.userAgent.toLowerCase(),e=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[],t={chrome:10,safari:6,msie:10,mozilla:4,opera:10},(parseInt(e[2],10)||0)>=t[e[1]]||$(document.body).prepend('<div id="unsupported-browser"><p>MadeiraCloud IDE does not support the browser you are using.</p> <p>For a better experience, we suggest you use the latest version of <a href=" https://www.google.com/intl/en/chrome/browser/" target="_blank">Chrome</a>, <a href=" http://www.mozilla.org/en-US/firefox/all/" target="_blank">Firefox</a> or <a href=" http://windows.microsoft.com/en-us/internet-explorer/ie-10-worldwide-languages" target="_blank">IE10</a>.</p></div>'),M({reset:function(e,t){var n;return h="reset",n=t[0],n==="password"?l(t[1],function(e){return e?(console.log("Right Verify Code!"),x("#password-template"),$("form.box-body").find("input").eq(0).focus(),$("#reset-form").on("submit",function(e){return e.preventDefault(),_()&&($("#reset-password").attr("disabled",!0).val(langsrc.reset.reset_waiting),r(t,$("#reset-pw").val()),console.log("jump...")),!1})):(window.location.hash="expire",console.log("Error Verify Code!"))}):n==="expire"?x("#expire-template"):n==="email"?(x("#email-template"),$("form.box-body").find("input").eq(0).focus()):n==="success"?x("#success-template"):(x("#default-template"),$("#reset-pw-email").focus(),$("#reset-pw-email").keyup(function(){return this.value?$("#reset-btn").removeAttr("disabled"):$("#reset-btn").attr("disabled",!0)}),$("#reset-form").on("submit",function(){return console.log("sendding...."),$("#reset-pw-email").off("keyup"),$("#reset-btn").attr("disabled",!0),$("#reset-pw-email").attr("disabled",!0),$("#reset-btn").val(window.langsrc.reset.reset_waiting),T($("#reset-pw-email").val()),!1}))},login:function(e,t){var n,r,s,o;return f()&&(window.location="/"),h="login",console.log(e,t),x("#login-template"),r=$("#login-user"),n=$("#login-password"),o=$("#login-btn").attr("disabled",!1),$("#login-form input").eq(0).focus(),s=function(){if($(this).val().trim())return $(this).parent().removeClass("error")},r.on("keyup",s),n.on("keyup",s),$("#login-form").on("submit",function(e){return e.preventDefault(),r.val()&&n.val()?($(".error-msg").hide(),$(".control-group").removeClass("error"),o.attr("disabled",!0).val(langsrc.reset.reset_waiting),i([r.val(),n.val()],function(e){return $("#error-msg-1").show(),o.attr("disabled",!1).val(langsrc.login["login-btn"])})):($("#error-msg-2").show(),r.val().trim()?r.parent().removeClass("error"):r.parent().addClass("error"),n.val().trim()?n.parent().removeClass("error"):n.parent().addClass("error"),!1)})},register:function(e,t){var n,r,i,o,u,a,l,p,d,v,m;return f()&&(window.location="/"),h="register",console.log(e,t),t[0]==="success"?(x("#success-template"),$("#register-get-start").click(function(){return window.location="/",console.log("Getting start...")}),!1):(x("#register-template"),r=$("#register-form"),r.find("input").eq(0).focus(),o=$("#register-username"),n=$("#register-email"),i=$("#register-password"),m=void 0,$("#register-btn").attr("disabled",!1),d=function(e,t){var n,r;return r=o.val(),n=$("#username-verification-status"),r.trim()!==""?/[^A-Za-z0-9\_]{1}/.test(r)!==!0?r.length>40?(n.removeClass("verification-status").addClass("error-status").text(langsrc.register.username_maxlength),t?t(0):!1):(n.hasClass("error-status")&&n.removeClass("verification-status").removeClass("error-status").text(""),t?a(r,n,t):!0):(n.removeClass("verification-status").addClass("error-status").text(langsrc.register.username_not_matched),t?t(0):!1):(n.removeClass("verification-status").addClass("error-status").text(langsrc.register.username_required),t?t(0):!1)},l=function(e,t,r){var i,s,o;return i=n.val(),o=$("#email-verification-status"),s=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,i.trim()!==""?s.test(i)?(o.hasClass("error-status")&&o.removeClass("verification-status").removeClass("error-status").text(""),t?u(i,o,t):!0):(o.removeClass("verification-status").addClass("error-status").text(langsrc.register.email_not_valid),t?t(0):!1):(o.removeClass("verification-status").addClass("error-status").text(langsrc.register.email_required),t?t(0):!1)},p=function(e,t){var n,r;return n=i.val(),r=$("#password-verification-status"),n!==""?n.length>5?(r.removeClass("verification-status").removeClass("error-status").text(""),t?t(1):!0):(r.removeClass("verification-status").addClass("error-status").text(langsrc.register.password_shorter),t?t(0):!1):(r.removeClass("verification-status").addClass("error-status").text(langsrc.register.password_required),t?t():!1)},a=function(e,t,n){return D!=null&&D.abort(),window.clearTimeout(m),console.log("aborted!",m),m=window.setTimeout(function(){return c([e,null],function(e){return e?e==="error"?console.log("Net Work Error while"):(t.removeClass("verification-status").addClass("error-status").text(langsrc.register.username_taken),typeof n=="function"?n(0):void 0):d()?(t.removeClass("error-status").addClass("verification-status").show().text(langsrc.register.username_available),typeof n=="function"?n(1):void 0):!1})},500),console.log("Setup a new validation request")},u=function(e,t,n){return D!=null&&D.abort(),window.clearTimeout(m),m=window.setTimeout(function(){return c([null,e],function(e){return e?e==="error"?console.log("NetWork Error"):(t.removeClass("verification-status").addClass("error-status").text(langsrc.register.email_used),typeof n=="function"?n(0):void 0):l()?(t.removeClass("error-status").addClass("verification-status").show().text(langsrc.register.email_available),typeof n=="function"?n(1):void 0):!1})},500),console.log("Set up a new validation request")},v=function(e){return e&&($(".verification-status").removeAttr("style"),$(".error-status").removeClass("error-status")),$("#register-btn").attr("disabled",!1).val(langsrc.register["register-btn"])},o.on("keyup",function(e){return d(e,function(e){return e||v(),e})}),n.on("keyup",function(e){return l(e,function(e){return e||v(),e})}),i.on("keyup",function(e){return p(e,function(e){return e||v(),e})}),r.on("submit",function(e){var t,r,u;return e.preventDefault(),$(".error-msg").removeAttr("style"),o.next().hasClass("error-status")||n.next().hasClass("error-status")?(console.log("Error Message Exist"),!1):(u=d(),t=l(),r=p(),u&&t&&r?($("#register-btn").attr("disabled",!0).val(langsrc.register.reginster_waiting),console.log("check user input here."),d(e,function(t){return t?l(e,function(r){return r?p(e,function(e){if(!e)return v(),!1;if(t&&r&&e)return console.log("Success!!!!!"),s([o.val(),i.val(),n.val()],function(e){return v(!0),$("#register-status").show().text(langsrc.service["ERROR_CODE_"+e+"_MESSAGE"]),!1})}):(v(),!1)}):(v(),!1)})):!1)}))}})},_=function(){var e,t;return e=$("#password-verification-status"),t=$("#reset-pw").val(),e.removeClass("error-status"),t!==""?t.length>5?(e.hide(),!0):(e.addClass("error-status").show().text(langsrc.reset.reset_password_shorter),!1):(e.addClass("error-status").show().text(langsrc.reset.reset_password_required),!1)},O=function(){return console.log("showErrorMessage"),$("#reset-pw-email").attr("disabled",!1),$("#reset-btn").attr("disabled",!1).val(window.langsrc.reset.reset_btn),$("#email-verification-status").removeClass("verification-status").addClass("error-msg").show().text(langsrc.reset.reset_error_state),!1},v=function(e){return console.error("ERROR_CODE_MESSAGE",langsrc.service["ERROR_CODE_"+e+"_MESSAGE"])},m=function(e){return window.location="/500",console.error(e,"Net Work Error, Redirecting...")},l=function(e,t){return o({url:"/account/",method:"check_validation",data:[e,"reset"],success:function(e,n){return n?(v(n),t(!1)):(console.log(e),t(!0))},error:function(e){return m(e)}})},k=function(e){var t,r,i,s;i={usercode:e[0],username:u(e[0]),email:e[1],session_id:e[2],account_id:e[3],mod_repo:e[4],mod_tag:e[5],state:e[6],has_cred:e[7],is_invitated:e[8]};for(r in i)s=i[r],$.cookie(r,s,n);return localStorage.setItem("email",u(i.email)),localStorage.setItem("user_name",i.username),t=function(){var e,t;return t="4tGsMJzq_2gJmwGDQgtP2En1rFlZEvBhWQWEOTKE",e=CryptoJS.HmacSHA256(u($.cookie("email")),t),e.toString(CryptoJS.enc.Hex)},localStorage.setItem("user_hash",t())},s=function(e,t){return console.log(e),o({url:"/account/",method:"register",data:e,success:function(e,n){return n?t(n):(k(e),window.location.hash="success",console.log("registered successfully"))},error:function(e){return m(e)}})},i=function(e,t){return o({url:"/session/",method:"login",data:e,success:function(e,n){return n?t(n):(k(e),window.location="/",console.log("Login Now!"))},error:function(e){return m(e)}})},T=function(e){return c([e,null],function(t){return t?o({url:"/account/",method:"reset_password",data:[e],success:function(e,t){return t?(v(t),O(),!1):(console.log(e,t),window.location.hash="email",!0)},error:function(e){return m(e)}}):(O(),!1)})},c=function(e,t){return o({url:"/account/",method:"check_repeat",data:e,success:function(e,n){return console.log(e,n),t(n)},error:function(e){return console.log("Net Work Error"),t("error")}})},r=function(e,t){return o({url:"/account/",method:"update_password",data:[e[1],t],success:function(e,t){return console.log(e,t),t?v(t):(window.location.hash="success",console.log("Password Updated Successfully"))},error:function(e){return m(e)}}),console.log("Updating Password...")},S(b)}).call(this);