/*
#**********************************************************
#* Filename: UI.tooltip
#* Creator: Angel
#* Description: UI.tooltip
#* Date: 20140115
# **********************************************************
# (c) Copyright 2014 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/*
#**********************************************************
#* Filename: UI.scrollbar
#* Creator: Angel
#* Description: UI.scrollbar
#* Date: 20140307
# **********************************************************
# (c) Copyright 2014 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/*
#**********************************************************
#* Filename: UI.bubble
#* Creator: Angel
#* Description: UI.bubble
#* Date: 20140116
# **********************************************************
# (c) Copyright 2014 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/*
#**********************************************************
#* Filename: UI.modal
#* Creator: Angel
#* Description: UI.modal
#* Date: 20140213
# **********************************************************
# (c) Copyright 2014 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/*
#**********************************************************
#* Filename: UI.table
#* Creator: Angel
#* Description: UI.table
#* Date: 20130917
# **********************************************************
# (c) Copyright 2013 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/*
#**********************************************************
#* Filename: UI.tablist
#* Creator: Cinde
#* Description: UI.tablist
#* Date: 20130620
# **********************************************************
# (c) Copyright 2013 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/*
#**********************************************************
#* Filename: UI.selectbox
#* Creator: Cinde
#* Description: UI.selectbox
#* Date: 20130627
# **********************************************************
# (c) Copyright 2013 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/*
#**********************************************************
#* Filename: UI.notification
#* Creator: Cinde
#* Description: UI.notification
#* Date: 20130607
# **********************************************************
# (c) Copyright 2013 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/*
#**********************************************************
#* Filename : UI.multiinputbox
#* Creator  : Morris
#* Desc     : Multiple Input Box
#* Date     : 20130715
# **********************************************************
# (c) Copyright 2013 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * @link   http://www.phpied.com/rgb-color-parser-in-javascript/
 * @license Use it if you like it
 */

/*
 * HTML5 Sortable jQuery Plugin
 * http://farhadi.ir/projects/html5sortable
 *
 * Copyright 2012, Ali Farhadi
 * Released under the MIT license.
 */

/*
#**********************************************************
#* Filename: UI.parsley
#* Creator: Tim
#* Description: UI.parsley
#* Date: 20130813
# **********************************************************
# (c) Copyright 2013 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/*
#**********************************************************
#* Filename: UI.errortip
#* Creator: Tim
#* Description: UI.errortip
#* Date: 20140102
# **********************************************************
# (c) Copyright 2013 Madeiracloud  All Rights Reserved
# **********************************************************
*/

/*!
 * jqPagination, a jQuery pagination plugin (obviously)
 * Version: 1.3 (26th July 2013)
 *
 * Copyright (C) 2013 Ben Everard
 *
 * http://beneverard.github.com/jqPagination
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

// License: http://dragsort.codeplex.com/license

/**
 * @preserve jQuery DateTimePicker plugin v2.3.4
 * @homepage http://xdsoft.net/jqplugins/datetimepicker/
 * (c) 2014, Chupurnov Valeriy.
 */

/*
 * Copyright (C) 2004 Baron Schwartz <baron at sequent dot org>
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as published by the
 * Free Software Foundation, version 2.1.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more
 * details.
 */

/**
 * sifter.js
 * Copyright (c) 2013 Brian Reavis & contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
 * file except in compliance with the License. You may obtain a copy of the License at:
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
 * ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 *
 * @author Brian Reavis <brian@thirdroute.com>
 */

/**
 * microplugin.js
 * Copyright (c) 2013 Brian Reavis & contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
 * file except in compliance with the License. You may obtain a copy of the License at:
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
 * ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 *
 * @author Brian Reavis <brian@thirdroute.com>
 */

/**
 * selectize.js (v0.11.0)
 * Copyright (c) 2013 Brian Reavis & contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
 * file except in compliance with the License. You may obtain a copy of the License at:
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
 * ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 *
 * @author Brian Reavis <brian@thirdroute.com>
 */

/*
Copyright 2012 Igor Vaynberg

Version: 3.4.8 Timestamp: Thu May  1 09:50:32 EDT 2014

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/

define("UI.tooltip",["jquery"],function(){var e=function(t){var n=$(t.currentTarget),r=$.trim(n.attr("data-tooltip")),i=$("#tooltip_box"),s=document.documentElement,o,u,a,f,l,c;return r!==""&&!n.hasClass("parsley-error")&&(i[0]||($(document.body).append('<div id="tooltip_box"></div>'),i=$("#tooltip_box")),n.data("tooltip-type")==="html"?i.html(r).show():i.text(r).show(),n.prop("namespaceURI")==="http://www.w3.org/2000/svg"?(o=n[0].getBoundingClientRect(),f=o.width,l=o.height):(o=n.offset(),f=n.innerWidth(),l=n.innerHeight()),u=i.width(),a=i.height(),i.css({left:o.left+f+u-s.scrollLeft>window.innerWidth?o.left+f-u-20:o.left+5,top:o.top+l+a-s.scrollTop+45>window.innerHeight?o.top-a-15:o.top+l+8}),$(document.body).on("mouseleave",".tooltip",e.clear),e.timer.push(setInterval(function(){n.closest("html").length===0&&e.clear()},1e3))),!0};e.timer=[],e.clear=function(){return $(document.body).off("mouseleave",".tooltip",e.clear),$("#tooltip_box").remove(),$.each(e.timer,function(e,t){clearInterval(t)}),!1},$(document).ready(function(){$(document.body).on("mouseenter",".tooltip",e)})}),define("UI.scrollbar",["jquery"],function(){var e=document.documentElement.style,t=!1,n;$.each(["webkitTransform","MozTransform","OTransform","msTransform","transform"],function(r,i){i in e&&(t=!0,n=i)});var r={init:function(){var e=document.getElementsByClassName("scroll-wrap");return $(document).on("mousewheel",".scroll-wrap",r.wheel).on("DOMMouseScroll",".scroll-wrap",r.wheel).on("mousedown",".scrollbar-veritical-thumb",{direction:"veritical"},r.mousedown).on("mousedown",".scrollbar-horizontal-thumb",{direction:"horizontal"},r.mousedown),setInterval(function(){var i=e.length;while(i--){var s=e[i],o=$(s),u=o.children(),a=u[0]?$(u[0].firstChild):undefined,f=u[1]?$(u[1].firstChild):undefined,l=s.getElementsByClassName("scroll-content")[0],c=s.offsetHeight,h=s.offsetWidth,p,d,v,m;l&&o.css("display")==="block"&&!o.hasClass("scrolling")&&(p=l.scrollHeight>0?c*c/l.scrollHeight:0,d=l.scrollWidth>0?h*h/l.scrollWidth:0,a&&a.hasClass("scrollbar-veritical-thumb")&&(v=o.height(),p<=c*2-l.scrollHeight||p>v?(a.parent().hide(),t?l.style[n]="translate("+(l.realScrollLeft?l.realScrollLeft:0)+", 0)":l.style.top="0px",l.realScrollTop=0,a[0].style.top="0px"):(a.parent().show(),a[0].style.height=p+"px",l.realScrollTop!==0&&v-l.realScrollTop>l.scrollHeight&&r.scrollTop({scroll_content:l,scrollbar_wrap:u[0],thumb:a[0],scroll_target:o},l.scrollHeight))),f&&f.hasClass("scrollbar-horizontal-thumb")&&(m=o.width(),d<=h*2-l.scrollWidth||d>m?(f.parent().hide(),t?l.style[n]="translate(0, "+(l.realScrollTop?l.realScrollTop:0)+"px)":l.style.left="0px",l.realScrollLeft=0,f[0].style.left="0px"):(f.parent().show(),f[0].style.width=d+"px",l.realScrollLeft!==0&&m-l.realScrollLeft>l.scrollWidth&&r.scrollLeft({scroll_content:l,scrollbar_wrap:u[1],thumb:f[0],scroll_target:o},l.scrollWidth))),s.scrollTop!==0&&(r.scrollTop({scroll_content:l,scrollbar_wrap:u[0],thumb:a[0],scroll_target:o},s.scrollTop),s.scrollTop=0),s.scrollLeft!==0&&(r.scrollLeft({scroll_content:l,scrollbar_wrap:u[0],thumb:a[0],scroll_target:o},s.scrollLeft),s.scrollLeft=0))}},800),!0},mousedown:function(e){var t=$(this),n=t.parent().parent(),i=e.data.direction;$(document.body).append('<div id="overlayer"></div>'),n.addClass("scrolling").trigger("scroll"),$(document).on({mousemove:r.mousemove,mouseup:r.mouseup},{scroll_target:n,direction:i,scrollbar_wrap:n.find(".scrollbar-"+i+"-wrap").first(),scroll_content:n.find(".scroll-content").first()[0],thumb:t[0],thumbPos:i==="veritical"?e.clientY-t.offset().top:e.clientX-t.offset().left})},mousemove:function(e){var t=e.data,n=t.scroll_target,i=t.direction,s=t.thumbPos;return i==="veritical"&&r.scrollTop(t,e.clientY-t.scrollbar_wrap.offset().top-s),i==="horizontal"&&r.scrollLeft(t,e.clientX-t.scrollbar_wrap.offset().left-s),!1},mouseup:function(e){return $(document).off({mousemove:r.mousemove,mouseup:r.mouseup}),$("#overlayer").remove(),e.data.scroll_target.removeClass("scrolling"),!0},scrollTo:function(e,t){var n=e.find(".scroll-content").first(),i,s;return t.left>=0&&(s=e.find(".scrollbar-horizontal-thumb").first(),i=e.find(".scrollbar-horizontal-wrap").first(),s[0]&&i[0]&&r.scrollLeft({scroll_content:n[0],scrollbar_wrap:i,thumb:s[0],scroll_target:e},t.left/(n[0].scrollWidth/i.width()))),t.top>=0&&(s=e.find(".scrollbar-veritical-thumb").first(),i=e.find(".scrollbar-veritical-wrap").first(),s[0]&&i[0]&&r.scrollTop({scroll_content:n[0],scrollbar_wrap:i,thumb:s[0],scroll_target:e},t.top/(n[0].scrollHeight/i.height()))),!0},scrollLeft:function(e,r){var i=e.scroll_content,s=e.thumb,o=e.scroll_target.width(),u=i.scrollWidth-o,a=i.scrollWidth/o,f=u/a,l;return u<0?!0:(r>0&&r<f?(s.style.left=r+"px",l=-(r*a)):(r<=0&&(s.style.left="0px",l=0),r>=f&&(s.style.left=f+"px",l=-u)),l=Math.round(l),t?i.style[n]="translate("+l+"px, "+(i.realScrollTop?i.realScrollTop:0)+"px)":i.style.left=l+"px",i.realScrollLeft=l,!0)},scrollTop:function(e,r){var i=e.scroll_content,s=e.thumb,o=e.scroll_target.height(),u=i.scrollHeight-o,a=i.scrollHeight/o,f=u/a,l;return u<0?!0:(r>0&&r<f?(s.style.top=r+"px",l=-(r*a)):(r<=0&&(s.style.top="0px",l=0),r>=f&&(s.style.top=f+"px",l=-u)),l=Math.round(l),t?i.style[n]="translate("+(i.realScrollLeft?i.realScrollLeft:0)+"px, "+l+"px)":i.style.top=l+"px",i.realScrollTop=l,!0)},wheel:function(e,t){var n=$(this),i=e.target,s=e.originalEvent,o=n.find(".scroll-content").first(),u,a,f,l,c,h,p;if(i.tagName.toLowerCase()==="textarea"&&i.scrollHeight>i.offsetHeight)return!0;if(s.wheelDeltaX||s.axis===1){n.trigger("onscroll"),u=n.find(".scrollbar-horizontal-thumb").first();if(u[0])return t=s.wheelDeltaX?s.wheelDeltaX/120:-s.detail/3,a=n.find(".scrollbar-horizontal-wrap").first(),wrap_width=n.width(),scrollLeft=u[0].offsetLeft-t*12,c=o[0].scrollWidth-wrap_width,h=o[0].scrollWidth/wrap_width,p=c/h,a.css("display")==="block"?(r.scrollLeft({scroll_content:o[0],scrollbar_wrap:a,thumb:u[0],scroll_target:n},scrollLeft),scrollLeft<0||scrollLeft>p):!0}if(s.wheelDeltaY||s.wheelDelta||s.detail){n.trigger("scroll"),u=n.find(".scrollbar-veritical-thumb").first();if(u[0])return t=s.wheelDelta?s.wheelDelta/120:s.wheelDeltaY?s.wheelDeltaY/120:-s.detail/3,a=n.find(".scrollbar-veritical-wrap").first(),f=n.height(),l=u[0].offsetTop-t*12,c=o[0].scrollHeight-f,h=o[0].scrollHeight/f,p=c/h,a.css("display")==="block"?(r.scrollTop({scroll_content:o[0],scrollbar_wrap:a,thumb:u[0],scroll_target:n},l),l<0||l>p):!0}}};window.scrollbar=r,$(document).ready(function(){r.init()})}),define("UI.bubble",["jquery"],function(){var e=function(t){if(t.type==="mouseleave")return e.clear(),!1;var n=$(this),r=n.data("bubble-template"),i=n.data("bubble-data"),s=$("#bubble-box"),o={},u=document.documentElement,a,f,l,c,h;$.trim(r)!==""&&(s[0]||($(document.body).append('<div id="bubble-box"><div class="arrow"></div><div id="bubble-content"></div></div>'),s=$("#bubble-box")),$("#bubble-content").html(MC.template[r](i)),l=n.offset(),c=n.innerWidth(),h=n.innerHeight(),a=s.width(),f=s.height(),l.left+c+a-u.scrollLeft>window.innerWidth?(o.left=l.left-a-15,s.addClass("bubble-right")):(o.left=l.left+c+15,s.addClass("bubble-left")),o.top=l.top-(f-h)/2,s.css(o).show()),e.timer=setInterval(function(){n.closest("html").length===0&&e.clear()},1e3)};e.clear=function(){$("#bubble-box").remove(),clearInterval(e.timer)},$(document).ready(function(){$(document.body).on("mouseenter mouseleave",".bubble",e)})}),define("UI.modal",["jquery"],function(){var e=window.modal=function(t,n,r,i){var s=$("#modal-wrap");s[0]||($(document.body).append('<div id="modal-wrap"></div>'),s=$("#modal-wrap")),i&&i.opacity&&s.css("background-color","rgba(0, 0, 0, "+i.opacity+")");var o="",u="",a=null;i&&i.$source&&(a=i.$source);if(a){var f=a.offset().left,l=a.offset().top,c=a.width(),h=a.height();o="overflow:hidden;opacity:0;left:"+f+"px;top:"+l+"px;width:"+c+"px;height:"+h+"px;",u="modal-transition-animation"}return t===Object(t)?s.html('<div id="modal-box" class="'+u+'" style="'+o+'"></div>').find("#modal-box").html(t):s.html('<div id="modal-box" class="'+u+'" style="'+o+'">'+t+"</div>"),$modal=$("#modal-box"),$modal.show(),$modal.children(":first").show(),a&&($modal.css({opacity:1,width:$modal.find("div").width(),height:$modal.find("div").height()}),$modal.on("webkitTransitionEnd transitionend oTransitionEnd",function(){$modal.removeClass("modal-transition-animation")})),e.position(a),n===!0&&($("#modal-wrap").on("click",e.dismiss),$(document).on("keyup",e.keyup)),$("#modal-box").on("click",".modal-close",e.close).on("mousedown",".modal-header",{options:i},e.drag.mousedown),r&&r(),!0};e.open=function(t){var n=$(this),r=n.data("modal-template"),i=n.data("modal-data");return r&&(i===undefined&&(i=""),e(MC.template[r](i),n.data("modal-dismiss")),n.trigger("modal-shown"),$("#modal-wrap").one("closed",function(){n.trigger("modal-closed")})),!0},e.keyup=function(e){return!1},e.dismiss=function(t){t.target.id==="modal-wrap"&&e.close()},e.close=function(t){$(window).off("resize",e.position),$(document).off("keyup",e.keyup),$("#modal-wrap").trigger("closed").remove(),t&&t.target.tagName==="A"&&t.preventDefault&&t.preventDefault()},e.isPopup=function(){return $("#modal-box").html()!==void 0},e.drag={mousedown:function(t){var n=$("#modal-box"),r=n.position();$(document).on({mousemove:e.drag.mousemove,mouseup:e.drag.mouseup},{target:n,left:t.pageX-r.left,top:t.pageY-r.top,options:t.data.options}),t.preventDefault()},mousemove:function(e){return e.data.target.css({top:e.pageY-e.data.top,left:e.pageX-e.data.left}),!1},mouseup:function(t){var n=t.data.target,r=t.data.options,i=n.position(),s=n.height(),o=n.width(),u={};return r&&r.conflict==="loose"?(i.top<0&&(u.top=10),i.left<-o*.8&&(u.left=10),i.top>window.innerHeight-s+s*.7&&(u.top=window.innerHeight-s-10),i.left>window.innerWidth-o+o*.8&&(u.left=window.innerWidth-o-25)):(i.top<0&&(u.top=10),i.left<0&&(u.left=10),i.top>window.innerHeight-s&&(u.top=window.innerHeight-s-10),i.left>window.innerWidth-o&&(u.left=window.innerWidth-o-25)),$.isEmptyObject(u)||n.animate(u,300),$(document).off({mousemove:e.drag.mousemove,mouseup:e.drag.mouseup}),!1}},e.position=function(e){var t=$("#modal-box"),n=0,r=0;return e?(n=(window.innerHeight-t.find("div").height())/2,r=(window.innerWidth-t.find("div").width())/2):(n=(window.innerHeight-t.height())/2,r=(window.innerWidth-t.width())/2,n>250&&(n=250)),t.css({top:n,left:r}),!0},$(document).ready(function(){$(document).on("click",".modal",e.open)})}),define("UI.table",["jquery"],function(){var e={edit:function(e){if(e.target.tagName.toLowerCase()==="input")return!1;var t=$(this),n=t.css("height"),r=t.html('<input class="table-input" type="text" value="'+t.text()+'"/>').children(":first");return $(r).css({color:t.css("color"),"font-size":t.css("font-size")}).focus(),!0},update:function(e){return $(this).parent().text(this.value),!0},sort:function(e){var t=$(this),n=t.index()+1,r=t.parent().parent(),i=r.parent(),s=t.hasClass("desc-sort")?"DESC":"ASC",o=document.createDocumentFragment(),u=[],a="",f,l;return i.attr("data-target")&&(i=$("#"+i.attr("data-target"))),i.hasClass("table-head")?(f=i.parent().find(".table tbody"),l=f.find("tr")):(f=i.find("tbody"),l=f.find("tr")),r.find(".active").removeClass("active"),t.addClass("active"),l.map(function(){u.push({item:this,value:$(this).find("td:nth-child("+n+")").text().toLowerCase()})}),a=t.data("rowType"),s==="DESC"?(u.sort(function(e,t){if(a==="datetime")return new Date(e.value)-new Date(t.value);intA=parseInt(e.value),intB=parseInt(t.value);if(a!=="string"&&!isNaN(intA)&&!isNaN(intB))return intA-intB;if(typeof e.value=="string")return e.value.localeCompare(t.value)}),t.removeClass("desc-sort")):(u.sort(function(e,t){if(a==="datetime")return new Date(t.value)-new Date(e.value);intA=parseInt(e.value),intB=parseInt(t.value);if(a!=="string"&&!isNaN(intA)&&!isNaN(intB))return intB-intA;if(typeof e.value=="string")return t.value.localeCompare(e.value)}),t.addClass("desc-sort")),$.each(u,function(e,t){o.appendChild(t.item)}),f.empty().append(o),o=null,!0}};$(document).ready(function(){$(document.body).on("click",".table td.editable",e.edit).on("click",".table .sortable, .table-head .sortable",e.sort).on("blur",".table-input",e.update)})}),define("UI.tablist",["jquery"],function(){var e=window.tab={update:function(e){var t=$(e.currentTarget);if(t.hasClass("active"))return!1;var n=t.addClass("active").siblings(".active").removeClass("active");return $(n.attr("data-tab-target")).removeClass("active"),$(t.attr("data-tab-target")).addClass("active"),!1}};$(function(){$(document.body).on("click",".tab [data-tab-target]",e.update)})}),define("UI.selectbox",["jquery"],function(){var e=window.selectbox={init:function(){$(".selectbox").each(function(){var e=$(this),t=e.find(".selected");t.length==0&&(t=e.find(".item:first-child").addClass("selected")),e.find(".selection").html(t.html())})}};(function(){function t(e){var t=$(e.currentTarget).closest(".selectbox"),n=t.data("silent-close");if(t.hasClass("open"))return t.removeClass("open"),!1;$(".selectbox.open").not(".multiopen").removeClass("open");var r=t.addClass("open").find(".dropdown");r.find(".focused").removeClass("focused"),r.find(".selected").focus().addClass("focused"),!r.parents(".scroll-wrap").length&&!r.hasClass("scroll-wrap")&&r.outerHeight()>300&&(r.wrap('<div class="dropdown scroll-wrap scrollbar-auto-hide context-wrap" style="height:300px;"></div>'),r.addClass("scroll-content"),r.parents(".scroll-wrap").prepend('<div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>'),r.removeClass("dropdown"));var i=function(e){var r=!0;n&&($(e.target).closest(n).size()||$(e.target).is(":hidden"))&&(r=!1),r&&(t.removeClass("open"),$(document.body).off("click",i))};return $(document.body).on("click",i),t.trigger("OPTION_SHOW"),!1}function n(e){var t=$(e.currentTarget).addClass("selected"),n=t.siblings(".selected").removeClass("selected"),r=t.closest(".selectbox").removeClass("open"),i=r.find(".selection").html(t.html()),s=$.Event("OPTION_CHANGE");return r.trigger(s,[t.attr("data-id"),t.data()]),s.isDefaultPrevented()&&(t.removeClass("selected"),n.addClass("selected"),i.html(n.html())),!0}function r(e){if(!/(38|40|13|27)/.test(e.which))return;var t=$(e.currentTarget);if(e.which==27)return t.closest(".selectbox").removeClass("open"),!1;if(e.which==13)return t.hasClass("selected")||(e.currentTarget=t.find(".focused"),n(e)),!1;var r=t.children(),i=r.filter(".focused").removeClass("focused").index();return e.which==40?i=i<r.length-1?i+1:0:i=i>1?i-1:r.length-1,r.eq(i).addClass("focused").focus(),!1}function i(){return $(this).hide().siblings(".edit").show(),!1}function s(e){var t=$(e.currentTarget).closest(".edit"),n=t.closest(".selectbox"),r=t.find(".input"),i=r.val();if(!i||i.length==0){n.trigger("EDIT_UPDATE","");return}r.val(""),t.hide().siblings(".editbtn").show(),e=$.Event("EDIT_UPDATE"),n.trigger(e,i);if(e.isDefaultPrevented())return;var s=e.id||i;n.find(".selection").html(i);var o=n.find(".dropdown").find(".selected").removeClass("selected");o.parent().append('<li class="item selected" data-id="'+s+'">'+i+"</li>"),n.trigger("EDIT_FINISHED").trigger("OPTION_CHANGE",s).removeClass("open")}function u(e){var t=$(e.currentTarget);if(t.is(".disabled, :disabled"))return;var n=t.attr("data-target");n&&(n=$(n)),n||(n=t.parent());var r=n.hasClass("open");return r?(n.removeClass("open"),t.trigger("DROPDOWN_CLOSE")):(t.attr("data-toggle")!="self-only"&&(o?a():(a(),o=!0,$(document.body).one("click",a))),n.addClass("open"),t.trigger("DROPDOWN_OPEN")),!1}function a(){var e=$(".js-toggle-dropdown");e.each(function(){var e=$(this);if(e.attr("data-toggle")=="self-only")return;var t=e.attr("data-target");t&&(t=$(t)),t||(t=e.parent()),t.hasClass("open")&&(t.removeClass("open"),e.trigger("DROPDOWN_CLOSE"))}),o=!1}$(function(){e.init(),$(document.body).on("click",".selectbox .editor .editbtn",i).on("click",".selectbox .editor .btn",s).on("click",".selectbox .editor",function(e){e.stopPropagation()}).on("click",".selectbox .selection",t).on("click",".selectbox .dropdown .item",n).on("keydown",".selectbox.open .dropdown",r).on("click",".js-toggle-dropdown",u)});var o=!1})()}),define("UI.notification",["jquery"],function(){var e={error:!0,warning:!0,info:!0};window.notification=function(n,r,i){if(!e[n]||!r)return;var s=$("#notification_wrap");if(s.length==0){var o=function(){$(this).closest(".notification_item").addClass("closing").slideUp("fast",function(){$(this).remove()})};s=$('<div id="notification_wrap"></div>').appendTo($(document.body)).on("click",".notification_close",o).on("CLOSE_ITEM",".notification_item",o)}var u=MC.template.notification.item({type:n,template:r,should_stay:i}),a=$(u).appendTo(s);i||t(a,n==="error",r.length);var f=s.children(":not(.closing)"),l=f.length-1;if(l>=3)for(var c=0;c<l;++c){var h=f.eq(c);if(h.children("span").text()===r){to=h.trigger("CLOSE_ITEM").data("close_to"),to&&clearTimeout(to);break}}};var t=function(e,t,n){stay_time=n*80,t&&(stay_time+=2e3);var r=setTimeout(function(){e.trigger("CLOSE_ITEM")},stay_time);e.data("close_to",r)}}),define("UI.multiinputbox",["jquery"],function(e){function n(){var t=e(this).closest(".multi-input"),n=t.data("row-tmpl");if(!n){var r=e("<p>").append(t.children().eq(0).clone());r.find("input").removeAttr("value"),r.find(".multi-ipt-row").removeClass("template"),n=r.html(),t.data("row-tmpl",n)}t.append(n).trigger("ADD_ROW");var i=parseInt(t.attr("data-max-row"));return i&&i<=t.children().length&&t.addClass("max"),!1}function r(){var t=e(this),n=t.closest(".multi-input").removeClass("max"),r=t.closest(".multi-ipt-row"),i=r.find("input").val(),s=e.Event("BEFORE_REMOVE_ROW",{value:i});return n.trigger(s),s.isDefaultPrevented()?!1:(r.remove(),n.trigger("REMOVE_ROW",i),!1)}var t={init:function(t){e(t).on("click",".multi-input .icon-add",n).on("click",".multi-input .icon-del",r)},update:function(t){var n=e(t),r=parseInt(n.attr("data-max-row"));n.toggleClass("max",r&&r<=n.children().length)}};e(function(){t.init(document.body)}),window.multiinputbox=t}),define("UI.canvg",[],function(){function e(e){this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var n in t)e==n&&(e=t[n]);var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}];for(var i=0;i<r.length;i++){var s=r[i].re,o=r[i].process,u=s.exec(e);u&&(channels=o(u),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return e.length==1&&(e="0"+e),t.length==1&&(t="0"+t),n.length==1&&(n="0"+n),"#"+e+t+n}}function t(){var t={};return t.MAX_VIRTUAL_PIXELS=3e4,t.init=function(e){var n=0;t.UniqueId=function(){return n++,"canvg"+n},t.Definitions={},t.Styles={},t.Animations=[],t.Images=[],t.ctx=e,t.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(e,t){this.viewPorts.push({width:e,height:t})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(e){return e!=null&&typeof e=="number"?e:e=="x"?this.width():e=="y"?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},t.init(),t.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},t.compressSpaces=function(e){return e.replace(/[\s\r\t\n]+/gm," ")},t.parseXml=function(e,n){doc=null;try{if(window.DOMParser){var r=new DOMParser;doc=r.parseFromString(e,"text/xml")}else e=e.replace(/<!DOCTYPE svg[^>]*>/,""),doc=new ActiveXObject("Microsoft.XMLDOM"),doc.async="false",doc.loadXML(e)}catch(i){if(n)return console.warn("We still cannot parse the SVG."),t.parseXml("<svg></svg>");console.warn("Retry to parse the svg, this should only happen in IE.");var s=e.match(/<svg[^>]+>/);return s?(s=s[0],newSvgTag=s.replace(/xmlns=[^\s>]+/,"").replace(/[^\s]+:[^=]+=[^\s>]+/g,""),e=e.replace(s,newSvgTag),t.parseXml(e,!0)):null}return doc},t.Property=function(e,t){this.name=e,this.value=t},t.Property.prototype.getValue=function(){return this.value},t.Property.prototype.hasValue=function(){return this.value!=null&&this.value!==""},t.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var e=parseFloat(this.value);return(this.value+"").match(/%$/)&&(e/=100),e},t.Property.prototype.valueOrDefault=function(e){return this.hasValue()?this.value:e},t.Property.prototype.numValueOrDefault=function(e){return this.hasValue()?this.numValue():e},t.Property.prototype.addOpacity=function(n){var r=this.value;if(n!=null&&n!=""&&typeof this.value=="string")if(this.value.indexOf("rgba(")!=-1)i=this.value.split(","),i[3]=parseFloat(i[3])*n,r=i.join(",")+")";else{var i=new e(this.value);i.ok&&(r="rgba("+i.r+", "+i.g+", "+i.b+", "+n+")")}return new t.Property(this.name,r)},t.Property.prototype.getDefinition=function(){var e=this.value.match(/#([^\)'"]+)/);return e&&(e=e[1]),e||(e=this.value),t.Definitions[e]},t.Property.prototype.isUrlDefinition=function(){return this.value.indexOf("url(")==0},t.Property.prototype.getFillStyleDefinition=function(e,n){var r=this.getDefinition();if(r!=null&&r.createGradient)return r.createGradient(t.ctx,e,n);if(r!=null&&r.createPattern){if(r.getHrefAttribute().hasValue()){var i=r.attribute("patternTransform");r=r.getHrefAttribute().getDefinition(),i.hasValue()&&(r.attribute("patternTransform",!0).value=i.value)}return r.createPattern(t.ctx,e)}return null},t.Property.prototype.getDPI=function(e){return 96},t.Property.prototype.getEM=function(e){var n=12,r=new t.Property("fontSize",t.Font.Parse(t.ctx.font).fontSize);return r.hasValue()&&(n=r.toPixels(e)),n},t.Property.prototype.getUnits=function(){var e=this.value+"";return e.replace(/[0-9\.\-]/g,"")},t.Property.prototype.toPixels=function(e,n){if(!this.hasValue())return 0;var r=this.value+"";if(r.match(/em$/))return this.numValue()*this.getEM(e);if(r.match(/ex$/))return this.numValue()*this.getEM(e)/2;if(r.match(/px$/))return this.numValue();if(r.match(/pt$/))return this.numValue()*this.getDPI(e)*(1/72);if(r.match(/pc$/))return this.numValue()*15;if(r.match(/cm$/))return this.numValue()*this.getDPI(e)/2.54;if(r.match(/mm$/))return this.numValue()*this.getDPI(e)/25.4;if(r.match(/in$/))return this.numValue()*this.getDPI(e);if(r.match(/%$/))return this.numValue()*t.ViewPort.ComputeSize(e);var i=this.numValue();return n&&i<1?i*t.ViewPort.ComputeSize(e):i},t.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/s$/)?this.numValue()*1e3:e.match(/ms$/)?this.numValue():this.numValue()},t.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/deg$/)?this.numValue()*(Math.PI/180):e.match(/grad$/)?this.numValue()*(Math.PI/200):e.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)},t.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(e,n,r,i){var s=this.Parse(i?i:t.ctx.font);return e||(e=s.fontStyle||""),n||(n=s.fontWeight||""),r||(r=s.fontSize||""),[e,"normal",n,r,'"Lato", "Helvetica Neue", Arial, sans-serif'].join(" ")};var e=this;this.Parse=function(n){var r={},i=t.trim(t.compressSpaces(n||"")).split(" "),s={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},o="";for(var u=0;u<i.length;u++)!s.fontStyle&&e.Styles.indexOf(i[u])!=-1?(i[u]!="inherit"&&(r.fontStyle=i[u]),s.fontStyle=!0):!s.fontVariant&&e.Variants.indexOf(i[u])!=-1?(i[u]!="inherit"&&(r.fontVariant=i[u]),s.fontStyle=s.fontVariant=!0):!s.fontWeight&&e.Weights.indexOf(i[u])!=-1?(i[u]!="inherit"&&(r.fontWeight=i[u]),s.fontStyle=s.fontVariant=s.fontWeight=!0):s.fontSize?i[u]!="inherit"&&(o+=i[u]):(i[u]!="inherit"&&(r.fontSize=i[u].split("/")[0]),s.fontStyle=s.fontVariant=s.fontWeight=s.fontSize=!0);return o!=""&&(r.fontFamily=o),r}},t.ToNumberArray=function(e){var n=t.trim(t.compressSpaces((e||"").replace(/,/g," "))).split(" ");for(var r=0;r<n.length;r++){var i=parseFloat(n[r]);isNaN(i)&&(i=0),n[r]=i}return n},t.Point=function(e,t){this.x=e,this.y=t},t.Point.prototype.angleTo=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},t.Point.prototype.applyTransform=function(e){var t=this.x*e[0]+this.y*e[2]+e[4],n=this.x*e[1]+this.y*e[3]+e[5];this.x=t,this.y=n},t.CreatePoint=function(e){var n=t.ToNumberArray(e);return new t.Point(n[0],n[1])},t.CreatePath=function(e){var n=t.ToNumberArray(e),r=[];for(var i=0;i<n.length;i+=2)r.push(new t.Point(n[i],n[i+1]));return r},t.BoundingBox=function(e,t,n,r){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(e,t){if(e!=null){if(isNaN(this.x1)||isNaN(this.x2))this.x1=e,this.x2=e;e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)}if(t!=null){if(isNaN(this.y1)||isNaN(this.y2))this.y1=t,this.y2=t;t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t)}},this.addX=function(e){this.addPoint(e,null)},this.addY=function(e){this.addPoint(null,e)},this.addBoundingBox=function(e){this.addPoint(e.x1,e.y1),this.addPoint(e.x2,e.y2)},this.addQuadraticCurve=function(e,t,n,r,i,s){var o=e+2/3*(n-e),u=t+2/3*(r-t),a=o+1/3*(i-e),f=u+1/3*(s-t);this.addBezierCurve(e,t,o,a,u,f,i,s)},this.addBezierCurve=function(e,t,n,r,s,o,u,a){var f=[e,t],l=[n,r],c=[s,o],h=[u,a];this.addPoint(f[0],f[1]),this.addPoint(h[0],h[1]);for(i=0;i<=1;i++){var p=function(e){return Math.pow(1-e,3)*f[i]+3*Math.pow(1-e,2)*e*l[i]+3*(1-e)*Math.pow(e,2)*c[i]+Math.pow(e,3)*h[i]},d=6*f[i]-12*l[i]+6*c[i],v=-3*f[i]+9*l[i]-9*c[i]+3*h[i],m=3*l[i]-3*f[i];if(v==0){if(d==0)continue;var g=-m/d;0<g&&g<1&&(i==0&&this.addX(p(g)),i==1&&this.addY(p(g)));continue}var y=Math.pow(d,2)-4*m*v;if(y<0)continue;var b=(-d+Math.sqrt(y))/(2*v);0<b&&b<1&&(i==0&&this.addX(p(b)),i==1&&this.addY(p(b)));var w=(-d-Math.sqrt(y))/(2*v);0<w&&w<1&&(i==0&&this.addX(p(w)),i==1&&this.addY(p(w)))}},this.isPointInBox=function(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2},this.addPoint(e,t),this.addPoint(n,r)},t.Transform=function(e){var n=this;this.Type={},this.Type.translate=function(e){this.p=t.CreatePoint(e),this.apply=function(e){e.translate(this.p.x||0,this.p.y||0)},this.unapply=function(e){e.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(e){e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(e){var n=t.ToNumberArray(e);this.angle=new t.Property("angle",n[0]),this.cx=n[1]||0,this.cy=n[2]||0,this.apply=function(e){e.translate(this.cx,this.cy),e.rotate(this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.unapply=function(e){e.translate(this.cx,this.cy),e.rotate(-1*this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.applyToPoint=function(e){var t=this.angle.toRadians();e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),e.applyTransform([Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0]),e.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(e){this.p=t.CreatePoint(e),this.apply=function(e){e.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(e){e.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(e){e.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(e){this.m=t.ToNumberArray(e),this.apply=function(e){e.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.applyToPoint=function(e){e.applyTransform(this.m)}},this.Type.SkewBase=function(e){this.base=n.Type.matrix,this.base(e),this.angle=new t.Property("angle",e)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(e){this.base=n.Type.SkewBase,this.base(e),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(e){this.base=n.Type.SkewBase,this.base(e),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(e)},this.unapply=function(e){for(var t=this.transforms.length-1;t>=0;t--)this.transforms[t].unapply(e)},this.applyToPoint=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].applyToPoint(e)};var r=t.trim(t.compressSpaces(e)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/);for(var i=0;i<r.length;i++){var s=t.trim(r[i].split("(")[0]),o=r[i].split("(")[1].replace(")",""),u=new this.Type[s](o);u.type=s,this.transforms.push(u)}},t.AspectRatio=function(e,n,r,i,s,o,u,a,f,l){n=t.compressSpaces(n),n=n.replace(/^defer\s/,"");var c=n.split(" ")[0]||"xMidYMid",h=n.split(" ")[1]||"meet",p=r/i,d=s/o,v=Math.min(p,d),m=Math.max(p,d);h=="meet"&&(i*=v,o*=v),h=="slice"&&(i*=m,o*=m),f=new t.Property("refX",f),l=new t.Property("refY",l),f.hasValue()&&l.hasValue()?e.translate(-v*f.toPixels("x"),-v*l.toPixels("y")):(c.match(/^xMid/)&&(h=="meet"&&v==d||h=="slice"&&m==d)&&e.translate(r/2-i/2,0),c.match(/YMid$/)&&(h=="meet"&&v==p||h=="slice"&&m==p)&&e.translate(0,s/2-o/2),c.match(/^xMax/)&&(h=="meet"&&v==d||h=="slice"&&m==d)&&e.translate(r-i,0),c.match(/YMax$/)&&(h=="meet"&&v==p||h=="slice"&&m==p)&&e.translate(0,s-o)),c=="none"?e.scale(p,d):h=="meet"?e.scale(v,v):h=="slice"&&e.scale(m,m),e.translate(u==null?0:-u,a==null?0:-a)},t.Element={},t.EmptyProperty=new t.Property("EMPTY",""),t.Element.ElementBase=function(e){this.attributes={},this.styles={},this.children=[];if(e!=null&&e.nodeType==1){for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];r.nodeType==1&&this.addChild(r,!0);if(this.captureTextNodes&&r.nodeType==3){var i=r.nodeValue||r.text||"";t.trim(t.compressSpaces(i))!=""&&this.addChild(new t.Element.tspan(r),!1)}}for(var n=0;n<e.attributes.length;n++){var s=e.attributes[n];this.attributes[s.nodeName]=new t.Property(s.nodeName,s.nodeValue)}var o=this.attribute("stylez").value.split(";");for(var n=0;n<o.length;n++)if(o[n].indexOf(":")!=-1){var u=o[n].split(":"),a=t.trim(u[0]);this.styles[a]=new t.Property(a,t.trim(u[1]))}this.attribute("id").hasValue()&&t.Definitions[this.attribute("id").value]==null&&(t.Definitions[this.attribute("id").value]=this)}},t.Element.ElementBase.prototype.attribute=function(e,n){var r=this.attributes[e];return r!=null?r:(n==1&&(r=new t.Property(e,""),this.attributes[e]=r),r||t.EmptyProperty)},t.Element.ElementBase.prototype.getHrefAttribute=function(){for(var e in this.attributes)if(e.match(/:href$/))return this.attributes[e];return this.attributes.href||t.EmptyProperty},t.Element.ElementBase.prototype.style=function(e,n){var r=this.styles[e];if(r!=null)return r;var i=this.attribute(e);return i!=null&&i.hasValue()?(this.styles[e]=i,i):(n==1&&(r=new t.Property(e,""),this.styles[e]=r),r||t.EmptyProperty)},t.Element.ElementBase.prototype.render=function(e){e.save(),this.setContext(e);try{this.renderChildren(e)}catch(t){console.warn("Error occur when rendering svg in canvas",t)}this.clearContext(e),e.restore()},t.Element.ElementBase.prototype.setContext=function(e){},t.Element.ElementBase.prototype.clearContext=function(e){},t.Element.ElementBase.prototype.renderChildren=function(e){for(var t=0;t<this.children.length;t++)this.children[t].render(e)},t.Element.ElementBase.prototype.addChild=function(e,n){var r=e;n&&(r=t.CreateElement(e)),r.parent=this,this.children.push(r)},t.Element.RenderedElementBase=function(e){this.base=t.Element.ElementBase,this.base(e)},t.Element.RenderedElementBase.prototype=new t.Element.ElementBase,t.Element.RenderedElementBase.prototype.setContext=function(e){if(this.style("fill").isUrlDefinition()){var n=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));n!=null&&(e.fillStyle=n)}else if(this.style("fill").hasValue()){var r=this.style("fill");r.value=="currentColor"&&(r.value=this.style("color").value),e.fillStyle=r.value=="none"?"rgba(0,0,0,0)":r.value}fillOpacity=this.style("fill-opacity");if(fillOpacity.hasValue()&&fillOpacity.value+""!="1"){var r=new t.Property("fill",e.fillStyle);r=r.addOpacity(fillOpacity.value),e.fillStyle=r.value}if(this.style("stroke").isUrlDefinition()){var n=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));n!=null&&(e.strokeStyle=n)}else if(this.style("stroke").hasValue()){var i=this.style("stroke");i.value=="currentColor"&&(i.value=this.style("color").value),e.strokeStyle=i.value=="none"?"rgba(0,0,0,0)":i.value}if(this.style("stroke-opacity").hasValue()){var i=new t.Property("stroke",e.strokeStyle);i=i.addOpacity(this.style("stroke-opacity").value),e.strokeStyle=i.value}if(this.style("stroke-width").hasValue()){var s=this.style("stroke-width").toPixels();e.lineWidth=s==0?.001:s}this.style("stroke-linecap").hasValue()&&(e.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(e.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(e.miterLimit=this.style("stroke-miterlimit").value);if(this.style("stroke-dasharray").hasValue()){var o=t.ToNumberArray(this.style("stroke-dasharray").value);if(o.length>1||o[0]!=0){typeof e.setLineDash!="undefined"?e.setLineDash(o):typeof e.webkitLineDash!="undefined"?e.webkitLineDash=o:typeof e.mozDash!="undefined"&&(e.mozDash=o);var u=this.style("stroke-dashoffset").numValueOrDefault(1);typeof e.lineDashOffset!="undefined"?e.lineDashOffset=u:typeof e.webkitLineDashOffset!="undefined"?e.webkitLineDashOffset=u:typeof e.mozDashOffset!="undefined"&&(e.mozDashOffset=u)}}if(this.attribute("transform").hasValue()){var a=new t.Transform(this.attribute("transform").value);a.apply(e)}if(this.style("clip-path").hasValue()){var f=this.style("clip-path").getDefinition();f!=null&&f.apply(e)}this.style("opacity").hasValue()&&(e.globalAlpha=this.style("opacity").numValue())},t.Element.PathElementBase=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.path=function(e){return e!=null&&e.beginPath(),new t.BoundingBox},this.renderChildren=function(e){this.path(e),e.fillStyle!=""&&(this.attribute("fill-rule").hasValue()?e.fill(this.attribute("fill-rule").value):e.fill()),e.strokeStyle!=""&&e.stroke();var t=this.getMarkers();if(t!=null){if(this.style("marker-start").isUrlDefinition()){var n=this.style("marker-start").getDefinition();n.render(e,t[0][0],t[0][1])}if(this.style("marker-mid").isUrlDefinition()){var n=this.style("marker-mid").getDefinition();for(var r=1;r<t.length-1;r++)n.render(e,t[r][0],t[r][1])}if(this.style("marker-end").isUrlDefinition()){var n=this.style("marker-end").getDefinition();n.render(e,t[t.length-1][0],t[t.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},t.Element.PathElementBase.prototype=new t.Element.RenderedElementBase,t.Element.svg=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.baseClearContext=this.clearContext,this.clearContext=function(e){this.baseClearContext(e),t.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(e){e.strokeStyle="rgba(0,0,0,0)",e.lineCap="butt",e.lineJoin="miter",e.miterLimit=4,this.baseSetContext(e),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),e.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var n=t.ViewPort.width(),r=t.ViewPort.height();this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%");if(typeof this.root=="undefined"){n=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");var i=0,s=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(i=-this.attribute("refX").toPixels("x"),s=-this.attribute("refY").toPixels("y")),e.beginPath(),e.moveTo(i,s),e.lineTo(n,s),e.lineTo(n,r),e.lineTo(i,r),e.closePath(),e.clip()}t.ViewPort.SetCurrent(n,r)}},t.Element.svg.prototype=new t.Element.RenderedElementBase,t.Element.rect=function(e){this.base=t.Element.PathElementBase,this.base(e),this.path=function(e){var n=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y"),o=this.attribute("rx").toPixels("x"),u=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(u=o),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(o=u),o=Math.min(o,i/2),u=Math.min(u,s/2),e!=null&&(e.beginPath(),e.moveTo(n+o,r),e.lineTo(n+i-o,r),e.quadraticCurveTo(n+i,r,n+i,r+u),e.lineTo(n+i,r+s-u),e.quadraticCurveTo(n+i,r+s,n+i-o,r+s),e.lineTo(n+o,r+s),e.quadraticCurveTo(n,r+s,n,r+s-u),e.lineTo(n,r+u),e.quadraticCurveTo(n,r,n+o,r),e.closePath()),new t.BoundingBox(n,r,n+i,r+s)}},t.Element.rect.prototype=new t.Element.PathElementBase,t.Element.circle=function(e){this.base=t.Element.PathElementBase,this.base(e),this.path=function(e){var n=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y"),i=this.attribute("r").toPixels();return e!=null&&(e.beginPath(),e.arc(n,r,i,0,Math.PI*2,!0),e.closePath()),new t.BoundingBox(n-i,r-i,n+i,r+i)}},t.Element.circle.prototype=new t.Element.PathElementBase,t.Element.ellipse=function(e){this.base=t.Element.PathElementBase,this.base(e),this.path=function(e){var n=4*((Math.sqrt(2)-1)/3),r=this.attribute("rx").toPixels("x"),i=this.attribute("ry").toPixels("y"),s=this.attribute("cx").toPixels("x"),o=this.attribute("cy").toPixels("y");return e!=null&&(e.beginPath(),e.moveTo(s,o-i),e.bezierCurveTo(s+n*r,o-i,s+r,o-n*i,s+r,o),e.bezierCurveTo(s+r,o+n*i,s+n*r,o+i,s,o+i),e.bezierCurveTo(s-n*r,o+i,s-r,o+n*i,s-r,o),e.bezierCurveTo(s-r,o-n*i,s-n*r,o-i,s,o-i),e.closePath()),new t.BoundingBox(s-r,o-i,s+r,o+i)}},t.Element.ellipse.prototype=new t.Element.PathElementBase,t.Element.line=function(e){this.base=t.Element.PathElementBase,this.base(e),this.getPoints=function(){return[new t.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new t.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(e){var n=this.getPoints();return e!=null&&(e.beginPath(),e.moveTo(n[0].x,n[0].y),e.lineTo(n[1].x,n[1].y)),new t.BoundingBox(n[0].x,n[0].y,n[1].x,n[1].y)},this.getMarkers=function(){var e=this.getPoints(),t=e[0].angleTo(e[1]);return[[e[0],t],[e[1],t]]}},t.Element.line.prototype=new t.Element.PathElementBase,t.Element.polyline=function(e){this.base=t.Element.PathElementBase,this.base(e),this.points=t.CreatePath(this.attribute("points").value),this.path=function(e){var n=new t.BoundingBox(this.points[0].x,this.points[0].y);e!=null&&(e.beginPath(),e.moveTo(this.points[0].x,this.points[0].y));for(var r=1;r<this.points.length;r++)n.addPoint(this.points[r].x,this.points[r].y),e!=null&&e.lineTo(this.points[r].x,this.points[r].y);return n},this.getMarkers=function(){var e=[];for(var t=0;t<this.points.length-1;t++)e.push([this.points[t],this.points[t].angleTo(this.points[t+1])]);return e.push([this.points[this.points.length-1],e[e.length-1][1]]),e}},t.Element.polyline.prototype=new t.Element.PathElementBase,t.Element.polygon=function(e){this.base=t.Element.polyline,this.base(e),this.basePath=this.path,this.path=function(e){var t=this.basePath(e);return e!=null&&(e.lineTo(this.points[0].x,this.points[0].y),e.closePath()),t}},t.Element.polygon.prototype=new t.Element.polyline,t.Element.path=function(e){this.base=t.Element.PathElementBase,this.base(e);var n=this.attribute("d").value;n=n.replace(/,/gm," "),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),n=n.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([0-9])([+\-])/gm,"$1 $2"),n=n.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),n=n.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),n=t.compressSpaces(n),n=t.trim(n),this.PathParser=new function(e){this.tokens=e.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new t.Point(0,0),this.control=new t.Point(0,0),this.current=new t.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:this.tokens[this.i+1].match(/^[A-Za-z]$/)!=null},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var e=new t.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(e)},this.getAsControlPoint=function(){var e=this.getPoint();return this.control=e,e},this.getAsCurrentPoint=function(){var e=this.getPoint();return this.current=e,e},this.getReflectedControlPoint=function(){if(this.previousCommand.toLowerCase()!="c"&&this.previousCommand.toLowerCase()!="s"&&this.previousCommand.toLowerCase()!="q"&&this.previousCommand.toLowerCase()!="t")return this.current;var e=new t.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return e},this.makeAbsolute=function(e){return this.isRelativeCommand()&&(e.x+=this.current.x,e.y+=this.current.y),e},this.addMarker=function(e,t,n){n!=null&&this.angles.length>0&&this.angles[this.angles.length-1]==null&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(e,t==null?null:t.angleTo(e))},this.addMarkerAngle=function(e,t){this.points.push(e),this.angles.push(t)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var e=0;e<this.angles.length;e++)if(this.angles[e]==null)for(var t=e+1;t<this.angles.length;t++)if(this.angles[t]!=null){this.angles[e]=this.angles[t];break}return this.angles}}(n),this.path=function(e){var n=this.PathParser;n.reset();var r=new t.BoundingBox;e!=null&&e.beginPath();while(!n.isEnd()){n.nextCommand();switch(n.command){case"M":case"m":var i=n.getAsCurrentPoint();n.addMarker(i),r.addPoint(i.x,i.y),e!=null&&e.moveTo(i.x,i.y),n.start=n.current;while(!n.isCommandOrEnd()){var i=n.getAsCurrentPoint();n.addMarker(i,n.start),r.addPoint(i.x,i.y),e!=null&&e.lineTo(i.x,i.y)}break;case"L":case"l":while(!n.isCommandOrEnd()){var s=n.current,i=n.getAsCurrentPoint();n.addMarker(i,s),r.addPoint(i.x,i.y),e!=null&&e.lineTo(i.x,i.y)}break;case"H":case"h":while(!n.isCommandOrEnd()){var o=new t.Point((n.isRelativeCommand()?n.current.x:0)+n.getScalar(),n.current.y);n.addMarker(o,n.current),n.current=o,r.addPoint(n.current.x,n.current.y),e!=null&&e.lineTo(n.current.x,n.current.y)}break;case"V":case"v":while(!n.isCommandOrEnd()){var o=new t.Point(n.current.x,(n.isRelativeCommand()?n.current.y:0)+n.getScalar());n.addMarker(o,n.current),n.current=o,r.addPoint(n.current.x,n.current.y),e!=null&&e.lineTo(n.current.x,n.current.y)}break;case"C":case"c":while(!n.isCommandOrEnd()){var u=n.current,a=n.getPoint(),f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,a),r.addBezierCurve(u.x,u.y,a.x,a.y,f.x,f.y,l.x,l.y),e!=null&&e.bezierCurveTo(a.x,a.y,f.x,f.y,l.x,l.y)}break;case"S":case"s":while(!n.isCommandOrEnd()){var u=n.current,a=n.getReflectedControlPoint(),f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,a),r.addBezierCurve(u.x,u.y,a.x,a.y,f.x,f.y,l.x,l.y),e!=null&&e.bezierCurveTo(a.x,a.y,f.x,f.y,l.x,l.y)}break;case"Q":case"q":while(!n.isCommandOrEnd()){var u=n.current,f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,f),r.addQuadraticCurve(u.x,u.y,f.x,f.y,l.x,l.y),e!=null&&e.quadraticCurveTo(f.x,f.y,l.x,l.y)}break;case"T":case"t":while(!n.isCommandOrEnd()){var u=n.current,f=n.getReflectedControlPoint();n.control=f;var l=n.getAsCurrentPoint();n.addMarker(l,f,f),r.addQuadraticCurve(u.x,u.y,f.x,f.y,l.x,l.y),e!=null&&e.quadraticCurveTo(f.x,f.y,l.x,l.y)}break;case"A":case"a":while(!n.isCommandOrEnd()){var u=n.current,c=n.getScalar(),h=n.getScalar(),p=n.getScalar()*(Math.PI/180),d=n.getScalar(),v=n.getScalar(),l=n.getAsCurrentPoint(),m=new t.Point(Math.cos(p)*(u.x-l.x)/2+Math.sin(p)*(u.y-l.y)/2,-Math.sin(p)*(u.x-l.x)/2+Math.cos(p)*(u.y-l.y)/2),g=Math.pow(m.x,2)/Math.pow(c,2)+Math.pow(m.y,2)/Math.pow(h,2);g>1&&(c*=Math.sqrt(g),h*=Math.sqrt(g));var y=(d==v?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(h,2)-Math.pow(c,2)*Math.pow(m.y,2)-Math.pow(h,2)*Math.pow(m.x,2))/(Math.pow(c,2)*Math.pow(m.y,2)+Math.pow(h,2)*Math.pow(m.x,2)));isNaN(y)&&(y=0);var b=new t.Point(y*c*m.y/h,y*-h*m.x/c),w=new t.Point((u.x+l.x)/2+Math.cos(p)*b.x-Math.sin(p)*b.y,(u.y+l.y)/2+Math.sin(p)*b.x+Math.cos(p)*b.y),E=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},S=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(E(e)*E(t))},x=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(S(e,t))},T=x([1,0],[(m.x-b.x)/c,(m.y-b.y)/h]),N=[(m.x-b.x)/c,(m.y-b.y)/h],C=[(-m.x-b.x)/c,(-m.y-b.y)/h],k=x(N,C);S(N,C)<=-1&&(k=Math.PI),S(N,C)>=1&&(k=0);var L=1-v?1:-1,A=T+L*(k/2),O=new t.Point(w.x+c*Math.cos(A),w.y+h*Math.sin(A));n.addMarkerAngle(O,A-L*Math.PI/2),n.addMarkerAngle(l,A-L*Math.PI),r.addPoint(l.x,l.y);if(e!=null){var S=c>h?c:h,M=c>h?1:c/h,_=c>h?h/c:1;e.translate(w.x,w.y),e.rotate(p),e.scale(M,_),e.arc(0,0,S,T,T+k,1-v),e.scale(1/M,1/_),e.rotate(-p),e.translate(-w.x,-w.y)}}break;case"Z":case"z":e!=null&&e.closePath(),n.current=n.start}}return r},this.getMarkers=function(){var e=this.PathParser.getMarkerPoints(),t=this.PathParser.getMarkerAngles(),n=[];for(var r=0;r<e.length;r++)n.push([e[r],t[r]]);return n}},t.Element.path.prototype=new t.Element.PathElementBase,t.Element.pattern=function(e){this.base=t.Element.ElementBase,this.base(e),this.createPattern=function(e,n){var r=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),s=new t.Element.svg;s.attributes.viewBox=new t.Property("viewBox",this.attribute("viewBox").value),s.attributes.width=new t.Property("width",r+"px"),s.attributes.height=new t.Property("height",i+"px"),s.attributes.transform=new t.Property("transform",this.attribute("patternTransform").value),s.children=this.children;var o=document.createElement("canvas");o.width=r,o.height=i;var u=o.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&u.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var a=-1;a<=1;a++)for(var f=-1;f<=1;f++)u.save(),u.translate(a*o.width,f*o.height),s.render(u),u.restore();var l=e.createPattern(o,"repeat");return l}},t.Element.pattern.prototype=new t.Element.ElementBase,t.Element.marker=function(e){this.base=t.Element.ElementBase,this.base(e),this.baseRender=this.render,this.render=function(e,n,r){e.translate(n.x,n.y),this.attribute("orient").valueOrDefault("auto")=="auto"&&e.rotate(r),this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"&&e.scale(e.lineWidth,e.lineWidth),e.save();var i=new t.Element.svg;i.attributes.viewBox=new t.Property("viewBox",this.attribute("viewBox").value),i.attributes.refX=new t.Property("refX",this.attribute("refX").value),i.attributes.refY=new t.Property("refY",this.attribute("refY").value),i.attributes.width=new t.Property("width",this.attribute("markerWidth").value),i.attributes.height=new t.Property("height",this.attribute("markerHeight").value),i.attributes.fill=new t.Property("fill",this.attribute("fill").valueOrDefault("black")),i.attributes.stroke=new t.Property("stroke",this.attribute("stroke").valueOrDefault("none")),i.children=this.children,i.render(e),e.restore(),this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"&&e.scale(1/e.lineWidth,1/e.lineWidth),this.attribute("orient").valueOrDefault("auto")=="auto"&&e.rotate(-r),e.translate(-n.x,-n.y)}},t.Element.marker.prototype=new t.Element.ElementBase,t.Element.defs=function(e){this.base=t.Element.ElementBase,this.base(e),this.render=function(e){}},t.Element.defs.prototype=new t.Element.ElementBase,t.Element.GradientBase=function(e){this.base=t.Element.ElementBase,this.base(e),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var n=0;n<this.children.length;n++){var r=this.children[n];r.type=="stop"&&this.stops.push(r)}this.getGradient=function(){},this.createGradient=function(e,n,r){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition());var s=function(e){if(r.hasValue()){var n=new t.Property("color",e);return n.addOpacity(r.value).value}return e},o=this.getGradient(e,n);if(o==null)return s(i.stops[i.stops.length-1].color);for(var u=0;u<i.stops.length;u++)o.addColorStop(i.stops[u].offset,s(i.stops[u].color));if(this.attribute("gradientTransform").hasValue()){var a=t.ViewPort.viewPorts[0],f=new t.Element.rect;f.attributes.x=new t.Property("x",-t.MAX_VIRTUAL_PIXELS/3),f.attributes.y=new t.Property("y",-t.MAX_VIRTUAL_PIXELS/3),f.attributes.width=new t.Property("width",t.MAX_VIRTUAL_PIXELS),f.attributes.height=new t.Property("height",t.MAX_VIRTUAL_PIXELS);var l=new t.Element.g;l.attributes.transform=new t.Property("transform",this.attribute("gradientTransform").value),l.children=[f];var c=new t.Element.svg;c.attributes.x=new t.Property("x",0),c.attributes.y=new t.Property("y",0),c.attributes.width=new t.Property("width",a.width),c.attributes.height=new t.Property("height",a.height),c.children=[l];var h=document.createElement("canvas");h.width=a.width,h.height=a.height;var p=h.getContext("2d");return p.fillStyle=o,c.render(p),p.createPattern(h,"no-repeat")}return o}},t.Element.GradientBase.prototype=new t.Element.ElementBase,t.Element.linearGradient=function(e){this.base=t.Element.GradientBase,this.base(e),this.getGradient=function(e,t){var n=t.getBoundingBox();!this.attribute("x1").hasValue()&&!this.attribute("y1").hasValue()&&!this.attribute("x2").hasValue()&&!this.attribute("y2").hasValue()&&(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var r=this.gradientUnits=="objectBoundingBox"?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),i=this.gradientUnits=="objectBoundingBox"?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),s=this.gradientUnits=="objectBoundingBox"?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),o=this.gradientUnits=="objectBoundingBox"?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return r==s&&i==o?null:e.createLinearGradient(r,i,s,o)}},t.Element.linearGradient.prototype=new t.Element.GradientBase,t.Element.radialGradient=function(e){this.base=t.Element.GradientBase,this.base(e),this.getGradient=function(e,t){var n=t.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var r=this.gradientUnits=="objectBoundingBox"?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),i=this.gradientUnits=="objectBoundingBox"?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),s=r,o=i;this.attribute("fx").hasValue()&&(s=this.gradientUnits=="objectBoundingBox"?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(o=this.gradientUnits=="objectBoundingBox"?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var u=this.gradientUnits=="objectBoundingBox"?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return e.createRadialGradient(s,o,0,r,i,u)}},t.Element.radialGradient.prototype=new t.Element.GradientBase,t.Element.stop=function(e){this.base=t.Element.ElementBase,this.base(e),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var n=this.style("stop-color");this.style("stop-opacity").hasValue()&&(n=n.addOpacity(this.style("stop-opacity").value)),this.color=n.value},t.Element.stop.prototype=new t.Element.ElementBase,t.Element.font=function(e){this.base=t.Element.ElementBase,this.base(e),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var n=0;n<this.children.length;n++){var r=this.children[n];r.type=="font-face"?(this.fontFace=r,r.style("font-family").hasValue()&&(t.Definitions[r.style("font-family").value]=this)):r.type=="missing-glyph"?this.missingGlyph=r:r.type=="glyph"&&(r.arabicForm!=""?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[r.unicode]=="undefined"&&(this.glyphs[r.unicode]=[]),this.glyphs[r.unicode][r.arabicForm]=r):this.glyphs[r.unicode]=r)}},t.Element.font.prototype=new t.Element.ElementBase,t.Element.fontface=function(e){this.base=t.Element.ElementBase,this.base(e),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},t.Element.fontface.prototype=new t.Element.ElementBase,t.Element.missingglyph=function(e){this.base=t.Element.path,this.base(e),this.horizAdvX=0},t.Element.missingglyph.prototype=new t.Element.path,t.Element.glyph=function(e){this.base=t.Element.path,this.base(e),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},t.Element.glyph.prototype=new t.Element.path,t.Element.text=function(e){this.captureTextNodes=!0,this.base=t.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.style("dominant-baseline").hasValue()&&(e.textBaseline=this.style("dominant-baseline").value),this.style("alignment-baseline").hasValue()&&(e.textBaseline=this.style("alignment-baseline").value),this.style("fill").hasValue()||(e.fillStyle="#000000"),typeof e.font!="undefined"&&(e.font=t.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"12px",this.style("font-family").value))},this.getBoundingBox=function(){return new t.BoundingBox(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"),0,0)},this.renderChildren=function(e){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(e,this,0);for(var t=0;t<this.children.length;t++)this.renderChild(e,this,t)},this.getAnchorDelta=function(e,t,n){var r=this.style("text-anchor").valueOrDefault("start");if(r!="start"){var i=0;for(var s=n;s<t.children.length;s++){var o=t.children[s];if(s>n&&o.attribute("x").hasValue())break;i+=o.measureTextRecursive(e)}return-1*(r=="end"?i:i/2)}return 0},this.renderChild=function(e,t,n){var r=t.children[n];r.attribute("x").hasValue()?r.x=r.attribute("x").toPixels("x")+this.getAnchorDelta(e,t,n):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),r.attribute("dx").hasValue()&&(this.x+=r.attribute("dx").toPixels("x")),r.x=this.x),this.x=r.x+r.measureText(e),r.attribute("y").hasValue()?r.y=r.attribute("y").toPixels("y"):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),r.attribute("dy").hasValue()&&(this.y+=r.attribute("dy").toPixels("y")),r.y=this.y),this.y=r.y,r.render(e);for(var n=0;n<r.children.length;n++)this.renderChild(e,r,n)}},t.Element.text.prototype=new t.Element.RenderedElementBase,t.Element.TextElementBase=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.getGlyph=function(e,t,n){var r=t[n],i=null;if(e.isArabic){var s="isolated";(n==0||t[n-1]==" ")&&n<t.length-2&&t[n+1]!=" "&&(s="terminal"),n>0&&t[n-1]!=" "&&n<t.length-2&&t[n+1]!=" "&&(s="medial"),n>0&&t[n-1]!=" "&&(n==t.length-1||t[n+1]==" ")&&(s="initial"),typeof e.glyphs[r]!="undefined"&&(i=e.glyphs[r][s],i==null&&e.glyphs[r].type=="glyph"&&(i=e.glyphs[r]))}else i=e.glyphs[r];return i==null&&(i=e.missingGlyph),i},this.renderChildren=function(e){var n=this.parent.style("font-family").getDefinition();if(n!=null){var r=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize),i=this.parent.style("font-style").valueOrDefault(t.Font.Parse(t.ctx.font).fontStyle),s=this.getText();n.isRTL&&(s=s.split("").reverse().join(""));var o=t.ToNumberArray(this.parent.attribute("dx").value);for(var u=0;u<s.length;u++){var a=this.getGlyph(n,s,u),f=r/n.fontFace.unitsPerEm;e.translate(this.x,this.y),e.scale(f,-f);var l=e.lineWidth;e.lineWidth=e.lineWidth*n.fontFace.unitsPerEm/r,i=="italic"&&e.transform(1,0,.4,1,0,0),a.render(e),i=="italic"&&e.transform(1,0,-0.4,1,0,0),e.lineWidth=l,e.scale(1/f,-1/f),e.translate(-this.x,-this.y),this.x+=r*(a.horizAdvX||n.horizAdvX)/n.fontFace.unitsPerEm,typeof o[u]!="undefined"&&!isNaN(o[u])&&(this.x+=o[u])}return}e.fillStyle!=""&&e.fillText(t.compressSpaces(this.getText()),this.x,this.y),e.strokeStyle!=""&&e.strokeText(t.compressSpaces(this.getText()),this.x,this.y)},this.getText=function(){},this.measureTextRecursive=function(e){var t=this.measureText(e);for(var n=0;n<this.children.length;n++)t+=this.children[n].measureTextRecursive(e);return t},this.measureText=function(e){var n=this.parent.style("font-family").getDefinition();if(n!=null){var r=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize),i=0,s=this.getText();n.isRTL&&(s=s.split("").reverse().join(""));var o=t.ToNumberArray(this.parent.attribute("dx").value);for(var u=0;u<s.length;u++){var a=this.getGlyph(n,s,u);i+=(a.horizAdvX||n.horizAdvX)*r/n.fontFace.unitsPerEm,typeof o[u]!="undefined"&&!isNaN(o[u])&&(i+=o[u])}return i}var f=t.compressSpaces(this.getText());if(!e.measureText)return f.length*10;e.save(),this.setContext(e);var l=e.measureText(f).width;return e.restore(),l}},t.Element.TextElementBase.prototype=new t.Element.RenderedElementBase,t.Element.tspan=function(e){this.captureTextNodes=!0,this.base=t.Element.TextElementBase,this.base(e),this.text=e.nodeValue||e.text||"",this.getText=function(){return this.text}},t.Element.tspan.prototype=new t.Element.TextElementBase,t.Element.tref=function(e){this.base=t.Element.TextElementBase,this.base(e),this.getText=function(){var e=this.getHrefAttribute().getDefinition();if(e!=null)return e.children[0].getText()}},t.Element.tref.prototype=new t.Element.TextElementBase,t.Element.a=function(e){this.base=t.Element.TextElementBase,this.base(e),this.hasText=!0;for(var n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType!=3&&(this.hasText=!1);this.text=this.hasText?e.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(e){if(this.hasText)this.baseRenderChildren(e);else{var n=new t.Element.g;n.children=this.children,n.parent=this,n.render(e)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){t.ctx.canvas.style.cursor="pointer"}},t.Element.a.prototype=new t.Element.TextElementBase,t.Element.image=function(e){this.base=t.Element.RenderedElementBase,this.base(e);var n=this.getHrefAttribute().value;t.Images.push(this),this.loaded=!1,this.img=document.createElement("img");var r=this;this.img.onerror=this.img.onload=function(){r.loaded=!0,t.onImageLoaded()},this.img.src=n,this.renderChildren=function(e){var n=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y");if(i==0||s==0)return;if(this.img.width==0)return;e.save(),e.translate(n,r),t.AspectRatio(e,this.attribute("preserveAspectRatio").value,i,this.img.width,s,this.img.height,0,0),e.drawImage(this.img,0,0),e.restore()},this.getBoundingBox=function(){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");return new t.BoundingBox(e,n,e+r,n+i)}},t.Element.image.prototype=new t.Element.RenderedElementBase,t.Element.g=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.getBoundingBox=function(){var e=new t.BoundingBox;for(var n=0;n<this.children.length;n++)e.addBoundingBox(this.children[n].getBoundingBox());return e}},t.Element.g.prototype=new t.Element.RenderedElementBase,t.Element.symbol=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e);if(this.attribute("viewBox").hasValue()){var n=t.ToNumberArray(this.attribute("viewBox").value),r=n[0],i=n[1];width=n[2],height=n[3],t.AspectRatio(e,this.attribute("preserveAspectRatio").value,this.attribute("width").toPixels("x"),width,this.attribute("height").toPixels("y"),height,r,i),t.ViewPort.SetCurrent(n[2],n[3])}}},t.Element.symbol.prototype=new t.Element.RenderedElementBase,t.Element.style=function(e){this.base=t.Element.ElementBase,this.base(e);var n="";for(var r=0;r<e.childNodes.length;r++)n+=e.childNodes[r].nodeValue;n=n.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),n=t.compressSpaces(n);var i=n.split("}");for(var r=0;r<i.length;r++)if(t.trim(i[r])!=""){var s=i[r].split("{"),o=s[0].split(","),u=s[1].split(";");for(var a=0;a<o.length;a++){var f=t.trim(o[a]);if(f!=""){var l={};for(var c=0;c<u.length;c++){var h=u[c].indexOf(":"),p=u[c].substr(0,h),d=u[c].substr(h+1,u[c].length-h);p!=null&&d!=null&&(l[t.trim(p)]=new t.Property(t.trim(p),t.trim(d)))}t.Styles[f]=l}}}},t.Element.style.prototype=new t.Element.ElementBase,t.Element.use=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.attribute("x").hasValue()&&e.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&e.translate(0,this.attribute("y").toPixels("y"))},this.getDefinition=function(){var e=this.getHrefAttribute().getDefinition();return this.attribute("width").hasValue()&&(e.attribute("width",!0).value=this.attribute("width").value),this.attribute("height").hasValue()&&(e.attribute("height",!0).value=this.attribute("height").value),e},this.path=function(e){var t=this.getDefinition();t!=null&&t.path(e)},this.getBoundingBox=function(){var e=this.getDefinition();if(e!=null)return e.getBoundingBox()},this.renderChildren=function(e){var t=this.getDefinition();if(t!=null){var n=t.parent;t.parent=null,t.render(e),t.parent=n}}},t.Element.use.prototype=new t.Element.RenderedElementBase,t.Element.mask=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(e,n){var r=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");if(s==0&&o==0){var u=new t.BoundingBox;for(var a=0;a<this.children.length;a++)u.addBoundingBox(this.children[a].getBoundingBox());var r=Math.floor(u.x1),i=Math.floor(u.y1),s=Math.floor(u.width()),o=Math.floor(u.height())}var f=n.attribute("mask").value;n.attribute("mask").value="";var l=document.createElement("canvas");l.width=r+s,l.height=i+o;var c=l.getContext("2d");this.renderChildren(c);var h=document.createElement("canvas");h.width=r+s,h.height=i+o;var p=h.getContext("2d");n.render(p),p.globalCompositeOperation="destination-in",p.fillStyle=c.createPattern(l,"no-repeat"),p.fillRect(0,0,r+s,i+o),e.fillStyle=p.createPattern(h,"no-repeat"),e.fillRect(0,0,r+s,i+o),n.attribute("mask").value=f},this.render=function(e){}},t.Element.mask.prototype=new t.Element.ElementBase,t.Element.clipPath=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(e){for(var n=0;n<this.children.length;n++){var r=this.children[n];if(typeof r.path!="undefined"){var i=null;r.attribute("transform").hasValue()&&(i=new t.Transform(r.attribute("transform").value),i.apply(e)),r.path(e),e.clip(),i&&i.unapply(e)}}},this.render=function(e){}},t.Element.clipPath.prototype=new t.Element.ElementBase,t.Element.filter=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(e,t){var n=t.getBoundingBox(),r=Math.floor(n.x1),i=Math.floor(n.y1),s=Math.floor(n.width()),o=Math.floor(n.height()),u=t.style("filter").value;t.style("filter").value="";var a=0,f=0;for(var l=0;l<this.children.length;l++){var c=this.children[l].extraFilterDistance||0;a=Math.max(a,c),f=Math.max(f,c)}var h=document.createElement("canvas");h.width=s+2*a,h.height=o+2*f;var p=h.getContext("2d");p.translate(-r+a,-i+f),t.render(p);for(var l=0;l<this.children.length;l++)this.children[l].apply(p,0,0,s+2*a,o+2*f);e.drawImage(h,0,0,s+2*a,o+2*f,r-a,i-f,s+2*a,o+2*f),t.style("filter",!0).value=u},this.render=function(e){}},t.Element.filter.prototype=new t.Element.ElementBase,t.Element.feMorphology=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(e,t,n,r,i){}},t.Element.feMorphology.prototype=new t.Element.ElementBase,t.Element.feColorMatrix=function(e){function n(e,t,n,r,i,s){return e[n*r*4+t*4+s]}function r(e,t,n,r,i,s,o){e[n*r*4+t*4+s]=o}this.base=t.Element.ElementBase,this.base(e),this.apply=function(e,t,i,s,o){var u=e.getImageData(0,0,s,o);for(var i=0;i<o;i++)for(var t=0;t<s;t++){var a=n(u.data,t,i,s,o,0),f=n(u.data,t,i,s,o,1),l=n(u.data,t,i,s,o,2),c=(a+f+l)/3;r(u.data,t,i,s,o,0,c),r(u.data,t,i,s,o,1,c),r(u.data,t,i,s,o,2,c)}e.clearRect(0,0,s,o),e.putImageData(u,0,0)}},t.Element.feColorMatrix.prototype=new t.Element.ElementBase,t.Element.feGaussianBlur=function(e){this.base=t.Element.ElementBase,this.base(e),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(e,n,r,i,s){if(typeof stackBlurCanvasRGBA=="undefined"){console&&console.warn&&console.warn("ERROR: StackBlur.js must be included for blur to work");return}e.canvas.id=t.UniqueId(),e.canvas.style.display="none",document.body.appendChild(e.canvas),stackBlurCanvasRGBA(e.canvas.id,n,r,i,s,this.blurRadius),document.body.removeChild(e.canvas)}},t.Element.feGaussianBlur.prototype=new t.Element.ElementBase,t.Element.title=function(e){},t.Element.title.prototype=new t.Element.ElementBase,t.Element.desc=function(e){},t.Element.desc.prototype=new t.Element.ElementBase,t.Element.MISSING=function(e){},t.Element.MISSING.prototype=new t.Element.ElementBase,t.CreateElement=function(e){var n=e.nodeName.replace(/^[^:]+:/,"");n=n.replace(/\-/g,"");var r=null;return typeof t.Element[n]!="undefined"?r=new t.Element[n](e):r=new t.Element.MISSING(e),r.type=e.nodeName,r},t.loadXml=function(e,n){t.loadXmlDoc(e,t.parseXml(n))},t.loadXmlDoc=function(e,n){t.init(e);var r=t.CreateElement(n.documentElement);r.root=!0;var i=!0,s=function(){t.ViewPort.Clear();var n=e.canvas.clientWidth||e.canvas.width,i=e.canvas.clientHeight||e.canvas.height;t.ViewPort.SetCurrent(n,i);if(t.opts["scaleWidth"]!=null&&t.opts["scaleHeight"]!=null){var s=1,o=1,u=t.ToNumberArray(r.attribute("viewBox").value);r.attribute("width").hasValue()?s=r.attribute("width").toPixels("x")/t.opts.scaleWidth:isNaN(u[2])||(s=u[2]/t.opts.scaleWidth),r.attribute("height").hasValue()?o=r.attribute("height").toPixels("y")/t.opts.scaleHeight:isNaN(u[3])||(o=u[3]/t.opts.scaleHeight),r.attribute("width",!0).value=t.opts.scaleWidth,r.attribute("height",!0).value=t.opts.scaleHeight,r.attribute("viewBox",!0).value="0 0 "+n*s+" "+i*o,r.attribute("preserveAspectRatio",!0).value="none"}t.opts.beforeRender&&t.opts.beforeRender(e),r.render(e),t.opts.afterRender&&t.opts.afterRender()};t.imageLoadedCount=0,t.checkImageID=null,t.Images.length?t.onImageLoaded=function(){++t.imageLoadedCount,t.checkImageID&&(clearTimeout(t.checkImageID),t.checkImageID=null),t.imageLoadedCount>=t.Images.length?s():t.checkImageID=setTimeout(s,800)}:(t.onImageLoaded=function(){},s())},t}window.canvg=function(e,n,r){if(!e)return;r=r||{},typeof e=="string"&&(e=document.getElementById(e));var i=t();if(e.childNodes.length!=1||e.childNodes[0].nodeName!="OBJECT")e.svg=i;i.opts=r,i.loadXml(e.getContext("2d"),n)}}),define("UI.sortable",["jquery"],function(e){var t,n=e();e.fn.sortable=function(r){var i=String(r);return r=e.extend({connectWith:!1},r),this.each(function(){if(/^enable|disable|destroy$/.test(i)){var s=e(this).children(e(this).data("items")).attr("draggable",i=="enable");i=="destroy"&&s.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s");return}var o,u,s=e(this).children(r.items),a=e("<"+(/^ul|ol$/i.test(this.tagName)?"li":"div")+' class="sortable-placeholder">');s.find(r.handle).mousedown(function(){o=!0}).mouseup(function(){o=!1}),e(this).data("items",r.items),n=n.add(a),r.connectWith&&e(r.connectWith).add(this).data("connectWith",r.connectWith),s.attr("draggable","true").on("dragstart.h5s",function(n){if(r.handle&&!o)return!1;o=!1;var i=n.originalEvent.dataTransfer;i.effectAllowed="move",i.setData("Text","dummy"),u=(t=e(this)).addClass("sortable-dragging").index()}).on("dragend.h5s",function(){if(!t)return;t.removeClass("sortable-dragging").show(),n.detach(),u!=t.index()&&t.parent().trigger("sortupdate",{item:t}),t=null}).not("a[href], img").on("selectstart.h5s",function(){return this.dragDrop&&this.dragDrop(),!1}).end().add([this,a]).on("dragover.h5s dragenter.h5s drop.h5s",function(i){return!s.is(t)&&r.connectWith!==e(t).parent().data("connectWith")?!0:i.type=="drop"?(i.stopPropagation(),n.filter(":visible").after(t),t.trigger("dragend.h5s"),!1):(i.preventDefault(),i.originalEvent.dataTransfer.dropEffect="move",s.is(this)?(r.forcePlaceholderSize&&a.height(t.outerHeight()),t.hide(),e(this)[a.index()<e(this).index()?"after":"before"](a),n.not(a).detach()):!n.is(this)&&!e(this).children(r.items).length&&(n.detach(),e(this).append(a)),!1)})})}}),define("UI.parsley",["i18n!/nls/lang.js","jquery"],function(e){!function(t){var n={runOnceInSametime:function(e,t){var n=0;return function(){n++,t=t||this;var r=arguments;setTimeout(function(){n--;if(n>0)return;e.apply(t,r)},50)}},getCaretPosition:function(e){var t=0;if(document.selection){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length),t=n.text.length}else if(e.selectionStart||e.selectionStart=="0")t=e.selectionStart;return t},setCaretPosition:function(e,n){e instanceof t&&(e=e.get(0));if(e!=null)if(e.createTextRange){var r=e.createTextRange();r.move("character",n),r.select()}else e.selectionStart?(e.focus(),e.setSelectionRange(n,n)):e.focus()},prefixMatch:function(e,t,n){n=n||"";var r=e.slice(0,1)==="^"?1:0,i=e.slice(-1)==="$"?"":"$";for(var s=r;s<=e.length;s++){var o=e.slice(0,s);try{var u=(new RegExp(o+i,n)).test(t)}catch(a){continue}if(u)return!0}return!1},getCharFromKeyEvent:function(e){var n,r,i=e.which,s=e.shiftKey,o=e.ctrlKey||e.metaKey,u=i>=65&&i<=90,a=i>=48&&i<=57,f=i>=96&&i<=105,l=[8,9,13,16,19,20,27,33,34,35,36,37,38,39,40,45,46,112,113,114,115,116,117,118,119,120,121,122,123,144,145],c=["BackSpace","Tab","Enter","Shift","Pause","CapsLock","Escape","PageUp","PageDown","End","Move","Left","Up","Right","Down","Insert","Delete","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","NumsLock","Home"],h={192:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",189:"_",187:"+",219:"{",221:"}",220:"|",186:":",222:'"',188:"<",190:">",191:"?"},p={106:"*",107:"+",108:"Enter",109:"-",110:".",111:"/",192:"`",189:"-",187:"=",219:"[",221:"]",220:"\\",186:";",222:"'",188:",",190:".",191:"/",32:" "};if(u)o?n="ctrlFunc":n=String.fromCharCode(i);else if(a&&!s)n=String.fromCharCode(i);else if(f)n=String.fromCharCode(i-48);else if(t.inArray(i,l)!==-1){var d=t.inArray(i,l);n=c[d]}else s?n=h[i]:i in p&&(n=p[i]);return n}};!function(t,n){var r=function(t){this.messages={defaultMessage:"This value seems to be invalid.",type:{email:"This value should be a valid email.",url:"This value should be a valid url.",urlstrict:"This value should be a valid url.",number:"This value should be a valid number.",digits:"This value should be digits.",dateIso:"This value should be a valid date (YYYY-MM-DD).",alphanum:"This value should be alphanumeric.",phone:"This value should be a valid phone number.",usPhone:"This value should be a valid US phone number.",ipaddress:"This value should be a valid ip address.",ipv4:"This value should be a valid IPv4 address.",cidr:"This value should be a valid CIDR.",awsCidr:"This value should be a valid CIDR and the netmask ('16') must be between 16 and 28.",awsName:"This value should be a valid AWS name.",domain:"This value should be a valid domain.",database:"This value should be a valid name",ascii:"This value should be a valid ascii."},notnull:"This value should not be null.",notblank:"This value should not be blank.",required:e.PARSLEY.THIS_VALUE_IS_REQUIRED,regexp:"This value seems to be invalid.",min:"This value should be greater than or equal to %s.",max:"This value should be lower than or equal to %s.",range:"This value should be between %s and %s.",minlength:"This value is too short. It should have %s characters or more.",maxlength:"This value is too long. It should have %s characters or less.",rangelength:"This value length is invalid. It should be between %s and %s characters long.",mincheck:"You must select at least %s choices.",maxcheck:"You must select %s choices or less.",rangecheck:"You must select between %s and %s choices.",equalto:"This value should be the same."},this.init(t)};r.prototype={constructor:r,validators:{notnull:function(e){return e.length>0},notblank:function(e){return"string"==typeof e&&""!==e.replace(/^\s+/g,"").replace(/\s+$/g,"")},required:function(e){if("object"==typeof e){for(var t in e)if(this.required(e[t]))return!0;return!1}return this.notnull(e)&&this.notblank(e)},custom:function(e,t,n){var r,i,s;return r=t.thisArg||window,s=t.validator.call(r,e),s?(n.Validator.addMessage("custom",s),!1):!0},type:function(e,t){var n;switch(t){case"number":n=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/;break;case"digits":n=/^\d+$/;break;case"alphanum":n=/^\w+$/;break;case"email":n=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i;break;case"url":e=(new RegExp("(https?|s?ftp|git)","i")).test(e)?e:"http://"+e;case"urlstrict":n=/^(https?|s?ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;break;case"dateIso":n=/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/;break;case"phone":n=/^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$/;break;case"ipaddress":n=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/(\d|[1-2]\d|3[0-2]))?$/;break;case"ipv4":n=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/;break;case"cidr":n=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/(\d|[1-2]\d|3[0-2]))$/;break;case"awsCidr":n=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/([1][6789]|[2]\d|3[0-2]))$/;break;case"awsName":n=/^[a-zA-Z0-9][a-zA-Z0-9-]*$/;break;case"database":n=/(?=[a-zA-Z0-9-]{2,25}$)^[a-zA-Z0-9]+(-[a-zA-Z0-9]+)*$/;break;case"domain":n=/^([a-zA-Z0-9-\u4e00-\u9fa5]+\.)+([a-zA-Z-\u4e00-\u9fa5]+)$/;break;case"ascii":n=/^[\x00-\x7F]+$/;break;case"usPhone":n=/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/;break;default:return!1}return""!==e?n.test(e):!1},regexp:function(e,t,n){return(new RegExp(t,n.options.regexpFlag||"")).test(e)},minlength:function(e,t){return e.length>=t},maxlength:function(e,t){return e.length<=t},rangelength:function(e,t){return this.minlength(e,t[0])&&this.maxlength(e,t[1])},min:function(e,t){return Number(e)>=t},max:function(e,t){return Number(e)<=t},range:function(e,t){return e>=t[0]&&e<=t[1]},equalto:function(e,n,r){return r.options.validateIfUnchanged=!0,e===t(n).val()},remote:function(e,n,r){var i=null,s={},o={};s[r.$element.attr("name")]=e,"undefined"!=typeof r.options.remoteDatatype&&(o={dataType:r.options.remoteDatatype});var u=function(e,n){"undefined"!=typeof n&&"undefined"!=typeof r.Validator.messages.remote&&n!==r.Validator.messages.remote&&t(r.ulError+" .remote").remove(),r.updtConstraint({name:"remote",valid:e},n),r.manageValidationResult()},a=function(e){if("object"==typeof e)return e;try{e=t.parseJSON(e)}catch(n){}return e},f=function(e){return"object"==typeof e&&null!==e?"undefined"!=typeof e.error?e.error:"undefined"!=typeof e.message?e.message:null:null};return t.ajax(t.extend({},{url:n,data:s,type:r.options.remoteMethod||"GET",success:function(e){e=a(e),u(1===e||!0===e||"object"==typeof e&&null!==e&&"undefined"!=typeof e.success,f(e))},error:function(e){e=a(e),u(!1,f(e))}},o)),i},mincheck:function(e,t){return this.minlength(e,t)},maxcheck:function(e,t){return this.maxlength(e,t)},rangecheck:function(e,t){return this.rangelength(e,t)}},init:function(e){var t=e.validators,n=e.messages,r;for(r in t)this.addValidator(r,t[r]);for(r in n)this.addMessage(r,n[r])},formatMesssage:function(e,t){if("object"==typeof t){for(var n in t)e=this.formatMesssage(e,t[n]);return e}return"string"==typeof e?e.replace(new RegExp("%s","i"),t):""},addValidator:function(e,t){this.validators[e]=t},addMessage:function(e,t,n){if("undefined"!=typeof n&&!0===n){this.messages.type[e]=t;return}if("type"===e){for(var r in t)this.messages.type[r]=t[r];return}this.messages[e]=t}};var i=function(e,t,n){this.options=t,this.Validator=new r(t);if(n==="ParsleyFieldMultiple")return this;this.init(e,n||"ParsleyField")};i.prototype={constructor:i,init:function(e,r){this.type=r,this.valid=!0,this.element=e,this.validatedOnce=!1,this.$element=t(e),this.val=this.$element.val(),this.isRequired=!1,this.isRequiredRollback=!1,this.hasCustom=!1,this.constraints={},"undefined"==typeof this.isRadioOrCheckbox&&(this.isRadioOrCheckbox=!1,this.hash=this.generateHash(),this.errorClassHandler=this.options.errors.classHandler(e,this.isRadioOrCheckbox)||this.$element),this.ulErrorManagement(),this.bindHtml5Constraints(),this.addConstraints();if(this.hasConstraints()){this.bindValidationEvents();var i=this.Validator.validators.required(this.val)}var s=this;this.$element.data("required-rollback")===!0&&(this.isRequiredRollback=!0,this.$element.on("focus",function(){t(this).data("pre-value",t(this).val())}).on("blur",function(){var e=s.Validator.validators.required(t(this).val());e||(t(this).val(t(this).data("pre-value")),t(this).parsley("validate"))}));var s=this,o=[8,9,13,16,19,20,27,33,34,35,36,37,38,39,40,45,46,112,113,114,115,116,117,118,119,120,121,122,123,144,145];if(this.$element.data("ignore")===!0){var u,a,f;a={cidr:"^[0-9]?$|^[0-9][0-9./]+$",awsCidr:"^[0-9]?$|^[0-9][0-9./]+$",ipv4:"^[0-9]*$|^[0-9][0-9.]+$",ipaddress:"^[0-9]*$|^[0-9][0-9./]+$",domain:"^[a-zA-Z0-9]+[a-zA-Z0-9.-]*$",digits:"^[0-9]*$",ascii:"^[\0-]*$",number:"^-?[0-9]*$|^-?[0-9]+\\.[0-9]*$"},f=this.options.type,u=u||this.$element.data("ignore-regexp")||a[f]||"^[0-9a-zA-Z]+[0-9a-zA-Z-]*$";var l=[["。","."],["、","/"]],c=this.options.regexp,h=function(e,n,r){var i=function(e){return s.Validator.validators.regexp(e,u,s)};return function(s){if((r-=1)<0)return;var o=t(n).val();if(o==="")return;var u=i(o);u||t(n).val(e).parsley("validate")}};this.$element.on("drop paste",function(e){var n=t(this).val(),r=h(n,this,1);setTimeout(r,1)});var p=function(e){if(e.which===229){var n=t(this).val(),r=h(n,this,1);return t(this).one("keyup",r),!1}},d=function(e){for(var t=0;t<l.length;t++)if(l[t][0]===e)return l[t][1]},v=function(e){var t,r;if(e.which in o)return!0;t=String.fromCharCode(e.which);var i=d(t);i&&(t=i);var s=this.value.split(""),a=n.getCaretPosition(this);s.splice(a,0,t);var f=s.join("");r=(new RegExp(u,"i")).test(f);if(!r)return!1;if(i)return this.value=f,n.setCaretPosition(this,a+1),!1};this.$element.on("keypress",v),this.$element.on("keydown",p)}},setParent:function(e){this.$parent=t(e)},getParent:function(){return this.$parent},bindHtml5Constraints:function(){if(this.$element.hasClass("required")||this.$element.prop("required"))this.options.required=!0;"undefined"!=typeof this.$element.attr("type")&&(new RegExp(this.$element.attr("type"),"i")).test("email url number range")&&(this.options.type=this.$element.attr("type"),(new RegExp(this.options.type,"i")).test("number range")&&(this.options.type="number","undefined"!=typeof this.$element.attr("min")&&this.$element.attr("min").length&&(this.options.min=this.$element.attr("min")),"undefined"!=typeof this.$element.attr("max")&&this.$element.attr("max").length&&(this.options.max=this.$element.attr("max")))),"string"==typeof this.$element.attr("pattern")&&this.$element.attr("pattern").length&&(this.options.regexp=this.$element.attr("pattern"))},addConstraints:function(){for(var e in this.options){var t={};t[e]=this.options[e],this.addConstraint(t,!0)}},addConstraint:function(e,t){for(var n in e)n=n.toLowerCase(),"function"==typeof this.Validator.validators[n]&&(this.constraints[n]={name:n,requirements:e[n],valid:null},n==="required"&&(this.isRequired=!0),n==="custom"&&(this.hasCustom=!0),this.addCustomConstraintMessage(n));"undefined"==typeof t&&this.bindValidationEvents()},updateConstraint:function(e,t){for(var n in e)this.updtConstraint({name:n,requirements:e[n],valid:null},t)},updtConstraint:function(e,n){this.constraints[e.name]=t.extend(!0,this.constraints[e.name],e),"string"==typeof n&&(this.Validator.messages[e.name]=n),this.bindValidationEvents()},removeConstraint:function(e){var e=e.toLowerCase();delete this.constraints[e],e==="required"&&(this.isRequired=!1);if(!this.hasConstraints()){if("ParsleyForm"==typeof this.getParent()){this.getParent().removeItem(this.$element);return}this.destroy();return}this.bindValidationEvents()},addCustomConstraintMessage:function(e){var t=e+("type"===e&&"undefined"!=typeof this.options[e]?this.options[e].charAt(0).toUpperCase()+this.options[e].substr(1):"")+"Message";"undefined"!=typeof this.options[t]&&this.Validator.addMessage("type"===e?this.options[e]:e,this.options[t],"type"===e)},bindValidationEvents:function(){this.valid=null,this.$element.addClass("parsley-validated"),this.$element.off("."+this.type),this.options.remote&&!(new RegExp("change","i")).test(this.options.trigger)&&(this.options.trigger=this.options.trigger?" change":"change");var e=(this.options.trigger?this.options.trigger:"")+((new RegExp("key","i")).test(this.options.trigger)?"":" keyup");this.$element.is("select")&&(e+=(new RegExp("change","i")).test(e)?"":" change"),e=e.replace(/^\s+/g,"").replace(/\s+$/g,""),this.$element.on((e+" ").split(" ").join("."+this.type+" "),!1,t.proxy(this.eventValidation,this))},generateHash:function(){return"parsley-"+(Math.random()+"").substring(2)},getHash:function(){return this.hash},getVal:function(){return this.$element.data("value")||this.$element.val()},eventValidation:function(e){var n=this.getVal();if(e.type==="keyup"&&!/keyup/i.test(this.options.trigger)&&!this.validatedOnce)return!0;if(e.type==="change"&&!/change/i.test(this.options.trigger)&&!this.validatedOnce)return!0;if(!this.isRadioOrCheckbox&&n.length<this.options.validationMinlength&&!this.validatedOnce)return!0;var r=this.validate(),i=t(e.currentTarget);!r&&e.type==="focusout"&&i.data("focus-back")===!0&&i.focus()},isValid:function(){return this.validate(!1)},hasConstraints:function(){for(var e in this.constraints)return!0;return!1},validate:function(e){var t=this.getVal(),n=null;return!this.hasConstraints()&&!this.isRequiredRollback?!0:this.options.listeners.onFieldValidate(this.element,this)||""===t&&!this.isRequired&&!this.isRequiredRollback&&!this.hasCustom?(this.reset(),!0):this.needsValidation(t)?(n=this.applyValidators(),("undefined"!=typeof e?e:this.options.showErrors)&&this.manageValidationResult(),n===null&&(n=!0),n&&this.isRequiredRollback&&(n=this.Validator.validators.required(t)),n):this.valid},validateForm:function(e){var t=this.getParent();t?t=t[0]:(t=this.$element.closest("form, [data-bind=true]"),t=t.parsley());for(var n in t.items){var r=t.items[n];r.options.validateIfUnchanged=!0}return t.validate("undefined"!=typeof e?e:this.options.showErrors)},needsValidation:function(e){return!this.options.validateIfUnchanged&&this.valid!==null&&this.val===e&&this.validatedOnce?!1:(this.val=e,this.validatedOnce=!0)},applyValidators:function(){var e=null;for(var t in this.constraints){var n=this.Validator.validators[this.constraints[t].name](this.val,this.constraints[t].requirements,this);!1===n?(e=!1,this.constraints[t].valid=e,this.options.listeners.onFieldError(this.element,this.constraints,this)):!0===n&&(this.constraints[t].valid=!0,e=!1!==e,this.options.listeners.onFieldSuccess(this.element,this.constraints,this))}return e},manageValidationResult:function(){var e=null;for(var t in this.constraints)!1===this.constraints[t].valid?(this.manageError(this.constraints[t]),e=!1):!0===this.constraints[t].valid&&(this.removeError(this.constraints[t].name),e=!1!==e);return this.valid=e,!0===this.valid?(this.removeErrors(),this.errorClassHandler.removeClass(this.options.errorClass).addClass(this.options.successClass),errortip.purge(this.hash),!0):!1===this.valid?(this.errorClassHandler.removeClass(this.options.successClass).addClass(this.options.errorClass),errortip.first(this.element),!1):e},showError:function(e){e&&(this.options.errorMessage=e),this.manageError({})},hideError:function(){this.removeErrors(),this.errorClassHandler.removeClass(this.options.errorClass).addClass(this.options.successClass)},custom:function(e){var t,n,r;typeof e=="function"?t=e:(t=e.validator,n=e.now,r=e.thisArg);var i={};i.custom={validator:t,thisArg:r},this.addConstraint(i,!0),this.bindValidationEvents(),n&&this.validate()},ulErrorManagement:function(){this.ulError="#"+this.hash,this.ulTemplate=t(this.options.errors.errorsWrapper).attr("id",this.hash).addClass("parsley-error-list")},removeError:function(e){var n=this.ulError+" ."+e,r=this;this.options.animate?t(n).fadeOut(this.options.animateDuration,function(){t(this).remove(),r.ulError&&t(r.ulError).children().length===0&&r.removeErrors()}):t(n).remove(),this.ulError&&t(this.ulError).children().length===0&&this.removeErrors()},addError:function(e){for(var n in e){var r=t(this.options.errors.errorElem).addClass(n);t(this.ulError).append(this.options.animate?t(r).html(e[n]).hide().fadeIn(this.options.animateDuration):t(r).html(e[n]))}},removeErrors:function(){this.options.animate?t(this.ulError).fadeOut(this.options.animateDuration,function(){t(this).remove()}):t(this.ulError).remove()},reset:function(){this.valid=null,this.removeErrors(),this.validatedOnce=!1,this.errorClassHandler.removeClass(this.options.successClass).removeClass(this.options.errorClass);for(var e in this.constraints)this.constraints[e].valid=null;return this},manageError:function(e){t(this.ulError).length||this.manageErrorContainer(),this.ulTemplate.data("uid",(Math.random()+"").substring(2)+t.now());if("required"===e.name&&null!==this.getVal()&&this.getVal().length>0)return;if(!(!this.isRequired||"required"===e.name||null!==this.getVal()&&0!==this.getVal().length))return;var n=e.name,r=!1!==this.options.errorMessage?"custom-error-message":n,i={},s=!1!==this.options.errorMessage?this.options.errorMessage:e.name==="type"?this.Validator.messages[n][e.requirements]:"undefined"==typeof this.Validator.messages[n]?this.Validator.messages.defaultMessage:this.Validator.formatMesssage(this.Validator.messages[n],e.requirements);t(this.ulError+" ."+r).length?r==="custom"&&t(this.ulError+" ."+r).text(s):(i[r]=s,this.addError(i))},manageErrorContainer:function(){var e=this.options.errorContainer||this.options.errors.container(this.element,this.isRadioOrCheckbox),n=this.options.animate?this.ulTemplate.show():this.ulTemplate;if("undefined"!=typeof e){t(e).append(n);return}this.isRadioOrCheckbox?this.$element.parent().after(n):this.$element.after(n)},addListener:function(e){for(var t in e)this.options.listeners[t]=e[t]},destroy:function(){this.$element.removeClass("parsley-validated"),this.reset().$element.off("."+this.type).removeData(this.type)}};var s=function(e,t,n){this.initMultiple(e,t),this.inherit(e,t),this.Validator=new r(t),this.init(e,n||"ParsleyFieldMultiple")};s.prototype={constructor:s,initMultiple:function(e,n){this.element=e,this.$element=t(e),this.group=n.group||!1,this.hash=this.getName(),this.siblings=this.group?'[data-group="'+this.group+'"]':'input[name="'+this.$element.attr("name")+'"]',this.isRadioOrCheckbox=!0,this.isRadio=this.$element.is("input[type=radio]"),this.isCheckbox=this.$element.is("input[type=checkbox]"),this.errorClassHandler=n.errors.classHandler(e,this.isRadioOrCheckbox)||this.$element.parent()},inherit:function(e,t){var n=new i(e,t,"ParsleyFieldMultiple");for(var r in n)"undefined"==typeof this[r]&&(this[r]=n[r])},getName:function(){return this.group?"parsley-"+this.group:"undefined"==typeof this.$element.attr("name")?"parsley-"+(Math.random()+"").substring(2):"parsley-"+this.$element.attr("name").replace(/(:|\.|\[|\])/g,"")},getVal:function(){if(this.isRadio)return t(this.siblings+":checked").val()||"";if(this.isCheckbox){var e=[];return t(this.siblings+":checked").each(function(){e.push(t(this).val())}),e}},bindValidationEvents:function(){this.valid=null,this.$element.addClass("parsley-validated"),this.$element.off("."+this.type);var e=this,n=(this.options.trigger?this.options.trigger:"")+((new RegExp("change","i")).test(this.options.trigger)?"":" change");n=n.replace(/^\s+/g,"").replace(/\s+$/g,""),t(this.siblings).each(function(){t(this).on(n.split(" ").join("."+e.type+" "),!1,t.proxy(e.eventValidation,e))})}};var o=function(e,t,n){this.init(e,t,n||"parsleyForm")};o.prototype={constructor:o,init:function(e,n,r){this.type=r,this.items=[],this.$element=t(e),this.options=n;var i=this;this.$element.find(n.inputs).each(function(){i.addItem(this)}),this.$element.addClass("parsley-validated")},addListener:function(e){for(var t in e)if((new RegExp("Field")).test(t))for(var n=0;n<this.items.length;n++)this.items[n].addListener(e);else this.options.listeners[t]=e[t]},addItem:function(e){if(t(e).is(this.options.excluded))return!1;var n=t(e).parsley(this.options);n.setParent(this),this.items.push(n)},removeItem:function(e){var n=t(e).parsley();for(var r=0;r<this.items.length;r++)if(this.items[r].hash===n.hash)return this.items[r].destroy(),this.items.splice(r,1),!0;return!1},validate:function(e){var t=!0;this.focusedField=!1;var n=e===!0||e===!1?e:!0;for(var r=0;r<this.items.length;r++){if(this.items[r].$element.is(":hidden"))continue;if("undefined"!=typeof this.items[r]&&!1===this.items[r].validate(n)){t=!1;if(!this.focusedField&&"first"===this.options.focus||"last"===this.options.focus)this.focusedField=this.items[r].$element}}return this.focusedField&&!t&&n&&this.focusedField.focus(),this.options.listeners.onFormSubmit(t,e,this),t},isValid:function(){for(var e=0;e<this.items.length;e++)if(!1===this.items[e].isValid())return!1;return!0},removeErrors:function(){for(var e=0;e<this.items.length;e++)this.items[e].parsley("reset")},destroy:function(){for(var e=0;e<this.items.length;e++)this.items[e].destroy();this.$element.off("."+this.type).removeData(this.type)},reset:function(){for(var e=0;e<this.items.length;e++)this.items[e].reset()}},t.fn.parsley=function(e,n){function a(u,a){var f=t(u).data(a);if(!f){switch(a){case"parsleyForm":f=new o(u,r,"parsleyForm");break;case"parsleyField":f=new i(u,r,"parsleyField");break;case"parsleyFieldMultiple":f=new s(u,r,"parsleyFieldMultiple");break;default:return}t(u).data(a,f)}if("string"==typeof e&&"function"==typeof f[e]){var l=f[e](n);return"undefined"!=typeof l?l:t(u)}return f}var r=t.extend(!0,{},t.fn.parsley.defaults,"undefined"!=typeof window.ParsleyConfig?window.ParsleyConfig:{},e,this.data()),u=null;return t(this).is("form")||!0===t(this).data("bind")?u=a(t(this),"parsleyForm"):t(this).is(r.inputs)&&!t(this).is(r.excluded)&&(u=a(t(this),t(this).is("input[type=radio], input[type=checkbox]")?"parsleyFieldMultiple":"parsleyField")),e==="custom"?u:"function"==typeof n?n():u},t.fn.parsley.Constructor=o,t.fn.parsley.defaults={inputs:'input, textarea, select, [contenteditable="true"]',excluded:"input[type=hidden], input[type=file], :disabled",trigger:!1,animate:!1,animateDuration:300,focus:"first",validationMinlength:1,successClass:"parsley-success",errorClass:"parsley-error",errorMessage:!1,validators:{},showErrors:!0,messages:{},validateIfUnchanged:!0,errors:{classHandler:function(e,t){},container:function(e,t){},errorsWrapper:"<ul></ul>",errorElem:"<li></li>"},listeners:{onFieldValidate:function(e,t){return!1},onFormSubmit:function(e,t,n){},onFieldError:function(e,t,n){},onFieldSuccess:function(e,t,n){}}},t(window).on("load",function(){t('[data-validate="parsley"]').each(function(){t(this).parsley()})})}(window.jQuery||window.Zepto,n);var r="focus",i='form[data-validate="parsley"] input, [data-bind="true"] input, form[data-validate="parsley"] textarea, [data-bind="true"] textarea, [data-bind="true"]',s=function(e){return e=e instanceof t?e:t(e),e.hasClass("parsley-validated")},o=function(e){if(e.nodeName==="form"||!0===t(e).data("bind"))n=t(e);else var n=t(e).closest('form, [data-bind="true"]');return n},u=function(e,t){var n=e.data("parsleyForm");for(var r in n.items){var i=n.items[r];if(i.element.get(0)===t)return}n.addItem(t)},a=function(e){var t=o(this);if(!s(t))t.parsley();else{var n=t.find('input[type=text], input[type=radio], input[type=checkbox], [contenteditable="true"]');n.each(function(e){s(this)||u(t,this)})}},f=function(e){if(s(this))return;var n=o(this);n?s(n)?u(n,this):n.parsley({validationMinlength:1}):t(this).parsley({validationMinlength:1})},l=function(e){var t=o(this);t.parsley("validate")};t(document.body).on("click",".parsley-submit",a),t(document.body).on("click",".parsley-submit",l),t(document.body).on(r,i,f)}(window.jQuery)}),define("UI.errortip",["jquery"],function(e){var t=function(t){var r=e(this),i=h(r),s,o,u,a,f,l;if(i.length){id=i.attr("id"),l="errortip-"+id,originTip=e("#"+l);if(originTip.length){originTip.html()!=i.html()&&(originTip.html(i.html()),originTip.show());return}errortip_box=i.clone(),errortip_box.addClass("errortip_box").attr("id",l).css("z-index",i.css("z-index")).appendTo(document.body),s=r.offset(),a=r.innerWidth(),f=r.innerHeight(),errortip_box.css({left:s.left,top:s.top+f+u-document.body.scrollTop+45>window.innerHeight?s.top-u-15+5:s.top+f+5,width:a-8-2}).show(),n[id]=setInterval(function(){i.closest("html").length===0&&w(i.attr("id"))},1e3)}},n={},r={},i=!1,s,o="parsley-error",u="parsley-error-list",a="<ul></ul>",f="<li></li>",l=function(t){return e(t).is("ul."+u)},c=function(){return"parsley-"+(Math.random()+"").substring(2)},h=function(e){return e.next(".parsley-error-list")},p=function(t){return $target=t instanceof e?t:e(t),h($target).attr("id")},d=function(t){var n;return t===Object(t)?n=p(t.currentTarget):n=t,e("#"+n).data("uid")},v=function(e){if(e)clearInterval(n[e]);else for(var e in n)clearInterval(n[e])},m=function(e){s=d(e),t.call(this,e)},g=function(e){s=!1,w.call(this,e)},y=function(e){if(e.parent().prop("tagName")==="BODY")return null;var t=e.parent().css("overflow");return t==="auto"||t==="scroll"?e.parent():y(e.parent())},b=function(n){setTimeout(function(){if(e(n).is(":hidden"))return;t.call(n),id=p(n),r[id]=setTimeout(function(){w({currentTarget:n})},2e3),e(window).one("resize",function(){w({currentTarget:n})}),scrollableParent=y(e(n)),scrollableParent&&scrollableParent.one("scroll",function(){w({currentTarget:n})})},1)},w=function(t){var n,i,o=!1;if(t){var u="errortip-";t===Object(t)?n=h(e(t.currentTarget)).attr("id"):(o=!0,n=t),i=d(n),setTimeout(function(){(s!==i||o)&&e("#"+u+n).remove()},100)}else e(".errortip_box").remove();r[n]&&clearInterval(r[n]),v(n)},E={createError:function(t,n,r){r||(r=c());var i=e(a).attr("id",r).addClass(u).data("uid",(Math.random()+"").substring(2)+e.now()),s=e(f).html(t);i.append(s),e(n).after(i).addClass(o)},changeError:function(t,n){var r=h(e(n));r.find("li").text(t)},removeError:function(t){var n,r;Object.prototype.toString.call(t)==="[object String]"?(r=e("#"+t),n=r.prev()):(n=e(t),r=h(n)),n.removeClass(o),l(r)&&w(r.attr("id"))},hasError:function(t){return e(t).hasClass(o)}};t.first=b,t.purge=w,e.extend(t,E),window.errortip=t,e(document).ready(function(){e(document.body).on("mouseenter",".parsley-error",m),e(document.body).on("mouseleave",".parsley-error",g)})}),define("UI.dnd",["jquery"],function(e){var t,n,r,i,s,o,u,a;return n=function(t){return t.noShadow?e():e("<div id='DndItem'></div>").appendTo(document.body).html(t.source.html()).attr("class",t.source.attr("class").replace("bubble","").replace("tooltip",""))},s=function(){},r={clone:n,eventPrefix:"",minDistance:4,lockToCenter:!0,noShadow:!1,onDragStart:s,onDrag:s,onDragEnd:s},e.fn.dnd=function(n,s){return void 0,void 0,s=e.extend({source:this,startX:n.pageX,startY:n.pageY},r,s),e(document).on({"mousemove.uidnd":i,"mousedown.uidnd":t,"mouseup.uidnd":t,"urlroute.uidnd":t},s),this},t=function(t){var n;e(document).off(".uidnd"),n=t.data,n.shadow&&n.shadow.remove(),n.hoverZone&&n.hoverZone.removeClass("dragOver").triggerHandler(""+n.eventPrefix+"dragleave",n),n.onDragCancel&&t.type==="urlroute"&&n.onDragCancel(t)},i=function(t){var n;return n=t.data,Math.pow(t.pageX-n.startX,2)+Math.pow(t.pageY-n.startY,2)>=4&&(e(document).off("mousemove.uidnd").on({"mousemove.uidnd":o,"mouseup.uidnd":u},n),a(n,t)),!1},a=function(t,n){var r,i;t.shadow=i=t.clone(t),t.onDragStart(t),t.lockToCenter?(t.offsetX=i.outerWidth()/2,t.offsetY=i.outerHeight()/2):(r=t.source.offset(),t.offsetX=t.startX-r.left,t.offsetY=t.startY-r.top),i.css({left:n.pageX-t.offsetX,top:n.pageY-t.offsetY}),t.dropZones=_.map(t.dropTargets,function(t){var n;return n=e(t),r=n.offset(),{x1:r.left,y1:r.top,x2:r.left+n.outerWidth(),y2:r.top+n.outerHeight()}})},o=function(e){var t,n,r,i,s,o,u,a,f,l;t=e.data,t.pageX=e.pageX,t.pageY=e.pageY,a=t.dropZones;for(i=o=0,u=a.length;o<u;i=++o){n=a[i];if(n.x1<=(f=e.pageX)&&f<=n.x2&&n.y1<=(l=e.pageY)&&l<=n.y2){s=t.dropTargets.eq(i),t.zoneDimension=n;break}}return r=t.hoverZone,r&&s&&s[0]===r[0]?s.triggerHandler(""+t.eventPrefix+"dragover",t):(r&&r.removeClass("dragOver").triggerHandler(""+t.eventPrefix+"dragleave",t),s&&s.addClass("dragOver").triggerHandler(""+t.eventPrefix+"dragenter",t),t.shadow.toggleClass("dragOver",!!s),t.hoverZone=s),t.shadow.css({left:e.pageX-t.offsetX,top:e.pageY-t.offsetY}),t.onDrag(e),!1},u=function(e){var n;n=e.data,t(e),n.pageX=e.pageX,n.pageY=e.pageY,n.onDragEnd(e),n.hoverZone&&n.hoverZone.triggerHandler(""+n.eventPrefix+"drop",n)},null}),define("jqpagination",["jquery"],function(e){e.jqPagination=function(t,n){var r=this;r.$el=e(t),r.el=t,r.$input=r.$el.find("input"),r.$el.data("jqPagination",r),r.init=function(){r.options=e.extend({},e.jqPagination.defaultOptions,n),r.options.max_page===null&&(r.$input.data("max-page")!==undefined?r.options.max_page=r.$input.data("max-page"):r.options.max_page=1),r.$input.data("current-page")!==undefined&&r.isNumber(r.$input.data("current-page"))&&(r.options.current_page=r.$input.data("current-page")),r.$input.removeAttr("readonly"),r.updateInput(!0),r.$input.on("focus.jqPagination mouseup.jqPagination",function(t){if(t.type==="focus"){var n=parseInt(r.options.current_page,10);e(this).val(n).select()}if(t.type==="mouseup")return!1}),r.$input.on("blur.jqPagination keydown.jqPagination",function(t){var n=e(this),i=parseInt(r.options.current_page,10);t.keyCode===27&&(n.val(i),n.blur()),t.keyCode===13&&n.blur(),t.type==="blur"&&r.setPage(n.val())}),r.$el.on("click.jqPagination","a",function(t){var n=e(this);if(n.hasClass("disabled"))return!1;!t.metaKey&&!t.ctrlKey&&(t.preventDefault(),r.setPage(n.data("action")))})},r.setPage=function(e,t){if(e===undefined)return r.options.current_page;var n=parseInt(r.options.current_page,10),i=parseInt(r.options.max_page,10);if(isNaN(parseInt(e,10)))switch(e){case"first":e=1;break;case"prev":case"previous":e=n-1;break;case"next":e=n+1;break;case"last":e=i}e=parseInt(e,10);if(isNaN(e)||e<1||e>i)return r.setInputValue(n),!1;r.options.current_page=e,r.$input.data("current-page",e),r.updateInput(t)},r.setMaxPage=function(e,t){if(e===undefined)return r.options.max_page;if(!r.isNumber(e))return console.error("jqPagination: max_page is not a number"),!1;if(e<r.options.current_page)return console.error("jqPagination: max_page lower than current_page"),!1;r.options.max_page=e,r.$input.data("max-page",e),r.updateInput(t)},r.updateInput=function(e){var t=parseInt(r.options.current_page,10);r.setInputValue(t),r.setLinks(t),e!==!0&&r.options.paged(t)},r.setInputValue=function(e){var t=r.options.page_string,n=r.options.max_page;t=t.replace("{current_page}",e).replace("{max_page}",n),r.$input.val(t)},r.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},r.setLinks=function(e){var t=r.options.link_string,n=parseInt(r.options.current_page,10),i=parseInt(r.options.max_page,10);if(t!==""){var s=n-1;s<1&&(s=1);var o=n+1;o>i&&(o=i),r.$el.find("a.first").attr("href",t.replace("{page_number}","1")),r.$el.find("a.prev, a.previous").attr("href",t.replace("{page_number}",s)),r.$el.find("a.next").attr("href",t.replace("{page_number}",o)),r.$el.find("a.last").attr("href",t.replace("{page_number}",i))}r.$el.find("a").removeClass("disabled"),n===i&&r.$el.find(".next, .last").addClass("disabled"),n===1&&r.$el.find(".previous, .first").addClass("disabled")},r.callMethod=function(t,n,i){switch(t.toLowerCase()){case"option":var s={trigger:!0},o=!1;e.isPlainObject(n)&&!i?e.extend(s,n):s[n]=i;var u=s.trigger===!1;return s.max_page!==undefined&&(o=r.setMaxPage(s.max_page,u)),s.current_page!==undefined&&(o=r.setPage(s.current_page,u)),o===!1&&console.error("jqPagination: cannot get / set option "+n),o;case"destroy":r.$el.off(".jqPagination").find("*").off(".jqPagination");break;default:return console.error('jqPagination: method "'+t+'" does not exist'),!1}},r.init()},e.jqPagination.defaultOptions={current_page:1,link_string:"",max_page:null,page_string:"Page {current_page} of {max_page}",paged:function(){}},e.fn.jqPagination=function(){var t=this,n=Array.prototype.slice.call(arguments),r=!1;if(typeof n[0]=="string")return e.each(t,function(){var t=e(this).data("jqPagination");r=t.callMethod(n[0],n[1],n[2])}),r;t.each(function(){new e.jqPagination(this,n[0])})}}),define("jquerysort",["jquery"],function(e){e.browser=e.support,e.fn.dragsort=function(t){if(t=="destroy"){e(this.selector).trigger("dragsort-uninit");return}var n=e.extend({},e.fn.dragsort.defaults,t),r=[],i=null,s=null;return this.each(function(t,o){e(o).is("table")&&e(o).children().size()==1&&e(o).children().is("tbody")&&(o=e(o).children().get(0));var u={draggedItem:null,placeHolderItem:null,pos:null,offset:null,offsetLimit:null,scroll:null,container:o,init:function(){var r=e(this.container).children().size()==0?"li":e(this.container).children(":first").get(0).tagName.toLowerCase();n.itemSelector==""&&(n.itemSelector=r),n.dragSelector==""&&(n.dragSelector=r),n.placeHolderTemplate==""&&(n.placeHolderTemplate="<"+r+">&nbsp;</"+r+">"),e(this.container).attr("data-listidx",t).mousedown(this.grabItem).bind("dragsort-uninit",this.uninit),this.styleDragHandlers(!0)},uninit:function(){var t=r[e(this).attr("data-listidx")];e(t.container).unbind("mousedown",t.grabItem).unbind("dragsort-uninit"),t.styleDragHandlers(!1)},getItems:function(){return e(this.container).children(n.itemSelector)},styleDragHandlers:function(t){this.getItems().map(function(){return e(this).is(n.dragSelector)?this:e(this).find(n.dragSelector).get()})},grabItem:function(t){if(t.which!=1||e(t.target).is(n.dragSelectorExclude)||e(t.target).closest(n.dragSelectorExclude).size()>0||e(t.target).closest(n.itemSelector).size()==0)return;t.preventDefault();var i=t.target;while(!e(i).is(n.dragSelector)){if(i==this)return;i=i.parentNode}e(i).attr("data-cursor",e(i).css("cursor")),e(i).css("cursor","move");var s=r[e(this).attr("data-listidx")],o=this,u=t.pageX,a=t.pageY,f=function(t){Math.pow(t.pageX-u,2)+Math.pow(t.pageY-a,2)>=4&&(e(s.container).unbind("mousemove",f),s.dragStart.call(o,t))};e(s.container).mousemove(f).mouseup(function(){e(s.container).unbind("mousemove",f),e(i).css("cursor",e(i).attr("data-cursor"))})},dragStart:function(t){i!=null&&i.draggedItem!=null&&i.dropItem(),i=r[e(this).attr("data-listidx")],i.draggedItem=e(t.target).closest(n.itemSelector),n.dragStart.apply(i.draggedItem),i.oldIndex=e(i.draggedItem).index(),i.draggedItem.attr("data-origpos",e(this).attr("data-listidx")+"-"+i.getItems().index(i.draggedItem));var s=parseInt(i.draggedItem.css("marginTop")),o=parseInt(i.draggedItem.css("marginLeft"));i.offset=i.draggedItem.offset(),i.offset.top=t.pageY-i.offset.top+(isNaN(s)?0:s)-1,i.offset.left=t.pageX-i.offset.left+(isNaN(o)?0:o)-1;if(!n.dragBetween){var u=e(i.container).outerHeight()==0?Math.max(1,Math.round(.5+i.getItems().size()*i.draggedItem.outerWidth()/e(i.container).outerWidth()))*i.draggedItem.outerHeight():e(i.container).outerHeight();i.offsetLimit=e(i.container).offset(),i.offsetLimit.right=i.offsetLimit.left+e(i.container).outerWidth()-i.draggedItem.outerWidth(),i.offsetLimit.bottom=i.offsetLimit.top+u-i.draggedItem.outerHeight()}var a=i.draggedItem.height(),f=i.draggedItem.width();n.itemSelector=="tr"?(i.draggedItem.children().each(function(){e(this).width(e(this).width())}),i.placeHolderItem=i.draggedItem.clone().attr("data-placeholder",!0),i.draggedItem.after(i.placeHolderItem),i.placeHolderItem.children().each(function(){e(this).css({borderWidth:0,width:e(this).width()+1,height:e(this).height()+1}).html("&nbsp;")})):(i.draggedItem.after(n.placeHolderTemplate),i.placeHolderItem=i.draggedItem.next().css({height:a,width:f}).attr("data-placeholder",!0));if(n.itemSelector=="td"){var l=i.draggedItem.closest("table").get(0);e("<table id='"+l.id+"' style='border-width: 0px;' class='dragSortItem "+l.className+"'><tr></tr></table>").appendTo("body").children().append(i.draggedItem)}var c=i.draggedItem.attr("style");i.draggedItem.attr("data-origstyle",c?c:""),i.draggedItem.css({position:"absolute",opacity:.8,"z-index":999,height:a,width:f}),i.scroll={moveX:0,moveY:0,maxX:e(document).width()-e(window).width(),maxY:e(document).height()-e(window).height()},i.scroll.scrollY=window.setInterval(function(){if(n.scrollContainer!=window){e(n.scrollContainer).scrollTop(e(n.scrollContainer).scrollTop()+i.scroll.moveY);return}var t=e(n.scrollContainer).scrollTop();if(i.scroll.moveY>0&&t<i.scroll.maxY||i.scroll.moveY<0&&t>0)e(n.scrollContainer).scrollTop(t+i.scroll.moveY),i.draggedItem.css("top",i.draggedItem.offset().top+i.scroll.moveY+1)},10),i.scroll.scrollX=window.setInterval(function(){if(n.scrollContainer!=window){e(n.scrollContainer).scrollLeft(e(n.scrollContainer).scrollLeft()+i.scroll.moveX);return}var t=e(n.scrollContainer).scrollLeft();if(i.scroll.moveX>0&&t<i.scroll.maxX||i.scroll.moveX<0&&t>0)e(n.scrollContainer).scrollLeft(t+i.scroll.moveX),i.draggedItem.css("left",i.draggedItem.offset().left+i.scroll.moveX+1)},10),e(r).each(function(e,t){t.createDropTargets(),t.buildPositionTable()}),i.setPos(t.pageX,t.pageY),e(document).bind("mousemove",i.swapItems),e(document).bind("mouseup",i.dropItem),n.scrollContainer!=window&&e(window).bind("DOMMouseScroll mousewheel",i.wheel)},setPos:function(t,r){var s=r-this.offset.top,o=t-this.offset.left;n.dragBetween||(s=Math.min(this.offsetLimit.bottom,Math.max(s,this.offsetLimit.top)),o=Math.min(this.offsetLimit.right,Math.max(o,this.offsetLimit.left))),this.draggedItem.parents().each(function(){if(e(this).css("position")!="static"&&(!e.browser.mozilla||e(this).css("display")!="table")){var t=e(this).offset();return s-=t.top,o-=t.left,!1}});if(n.scrollContainer==window)r-=e(window).scrollTop(),t-=e(window).scrollLeft(),r=Math.max(0,r-e(window).height()+5)+Math.min(0,r-5),t=Math.max(0,t-e(window).width()+5)+Math.min(0,t-5);else{var u=e(n.scrollContainer),a=u.offset();r=Math.max(0,r-u.height()-a.top)+Math.min(0,r-a.top),t=Math.max(0,t-u.width()-a.left)+Math.min(0,t-a.left)}i.scroll.moveX=t==0?0:t*n.scrollSpeed/Math.abs(t),i.scroll.moveY=r==0?0:r*n.scrollSpeed/Math.abs(r),n.horizontal?this.draggedItem.css({left:o+e(this.container).scrollLeft()}):this.draggedItem.css({top:s+e(this.container).scrollTop()})},wheel:function(t){if((e.browser.safari||e.browser.mozilla)&&i&&n.scrollContainer!=window){var r=e(n.scrollContainer),s=r.offset();if(t.pageX>s.left&&t.pageX<s.left+r.width()&&t.pageY>s.top&&t.pageY<s.top+r.height()){var o=t.detail?t.detail*5:t.wheelDelta/-2;r.scrollTop(r.scrollTop()+o),t.preventDefault()}}},buildPositionTable:function(){var t=[];this.getItems().not([i.draggedItem[0],i.placeHolderItem[0]]).each(function(n){var r=e(this).offset();r.right=r.left+e(this).outerWidth(),r.bottom=r.top+e(this).outerHeight(),r.elm=this,t[n]=r}),this.pos=t},dropItem:function(){if(i.draggedItem==null)return;var t=i.draggedItem.attr("data-origstyle");return i.draggedItem.attr("style",t),t==""&&i.draggedItem.removeAttr("style"),i.draggedItem.removeAttr("data-origstyle"),i.styleDragHandlers(!0),i.placeHolderItem.before(i.draggedItem),i.placeHolderItem.remove(),e("[data-droptarget], .dragSortItem").remove(),window.clearInterval(i.scroll.scrollY),window.clearInterval(i.scroll.scrollX),i.draggedItem.attr("data-origpos")!=e(r).index(i)+"-"+i.getItems().index(i.draggedItem)&&n.dragEnd(i.draggedItem,i.oldIndex),i.draggedItem.removeAttr("data-origpos"),i.draggedItem=null,e(document).unbind("mousemove",i.swapItems),e(document).unbind("mouseup",i.dropItem),n.scrollContainer!=window&&e(window).unbind("DOMMouseScroll mousewheel",i.wheel),!1},swapItems:function(t){if(i.draggedItem==null)return!1;i.setPos(t.pageX,t.pageY);var o=i.findPos(t.pageX,t.pageY),u=i;for(var a=0;o==-1&&n.dragBetween&&a<r.length;a++)o=r[a].findPos(t.pageX,t.pageY),u=r[a];if(o==-1)return!1;var f=function(){return e(u.container).children().not(u.draggedItem)},l=f().not(n.itemSelector).each(function(e){this.idx=f().index(this)}),c=e(u.pos[o].elm);return c.hasClass("disabled")?!1:(s==null||s.top>i.draggedItem.offset().top||s.left>i.draggedItem.offset().left?c.before(i.placeHolderItem):c.after(i.placeHolderItem),l.each(function(){var t=f().eq(this.idx).get(0);this!=t&&f().index(this)<this.idx?e(this).insertAfter(t):this!=t&&e(this).insertBefore(t)}),e(r).each(function(e,t){t.createDropTargets(),t.buildPositionTable()}),s=i.draggedItem.offset(),!1)},findPos:function(e,t){for(var n=0;n<this.pos.length;n++)if(this.pos[n].left<e&&this.pos[n].right>e&&this.pos[n].top<t&&this.pos[n].bottom>t)return n;return-1},createDropTargets:function(){if(!n.dragBetween)return;e(r).each(function(){var t=e(this.container).find("[data-placeholder]"),r=e(this.container).find("[data-droptarget]");t.size()>0&&r.size()>0?r.remove():t.size()==0&&r.size()==0&&(n.itemSelector=="td"?e(n.placeHolderTemplate).attr("data-droptarget",!0).appendTo(this.container):e(this.container).append(i.placeHolderItem.removeAttr("data-placeholder").clone().attr("data-droptarget",!0)),i.placeHolderItem.attr("data-placeholder",!0))})}};u.init(),r.push(u)}),this},e.fn.dragsort.defaults={itemSelector:"",dragSelector:"",dragSelectorExclude:"input, textarea, .editable-area",dragEnd:function(){},dragStart:function(){},dragBetween:!1,placeHolderTemplate:"",scrollContainer:window,scrollSpeed:5}}),function(e){typeof define=="function"&&define.amd?define("jqtimepicker",["jquery"],e):e(jQuery)}(function(e){function o(e){e.minTime&&(e.minTime=T(e.minTime)),e.maxTime&&(e.maxTime=T(e.maxTime)),e.durationTime&&typeof e.durationTime!="function"&&(e.durationTime=T(e.durationTime)),e.scrollDefault=="now"?e.scrollDefault=T(new Date):e.scrollDefault?e.scrollDefault=T(e.scrollDefault):e.minTime&&(e.scrollDefault=e.minTime),e.scrollDefault&&(e.scrollDefault=f(e.scrollDefault,e)),e.timeFormat.match(/[gh]/)&&(e._twelveHourTime=!0);if(e.disableTimeRanges.length>0){for(var t in e.disableTimeRanges)e.disableTimeRanges[t]=[T(e.disableTimeRanges[t][0]),T(e.disableTimeRanges[t][1])];e.disableTimeRanges=e.disableTimeRanges.sort(function(e,t){return e[0]-t[0]});for(var t=e.disableTimeRanges.length-1;t>0;t--)e.disableTimeRanges[t][0]<=e.disableTimeRanges[t-1][1]&&(e.disableTimeRanges[t-1]=[Math.min(e.disableTimeRanges[t][0],e.disableTimeRanges[t-1][0]),Math.max(e.disableTimeRanges[t][1],e.disableTimeRanges[t-1][1])],e.disableTimeRanges.splice(t,1))}return e}function u(t){var r=t.data("timepicker-settings"),i=t.data("timepicker-list");i&&i.length&&(i.remove(),t.data("timepicker-list",!1));if(r.useSelect){i=e("<select />",{"class":"ui-timepicker-select"});var o=i}else{i=e("<ul />",{"class":"ui-timepicker-list"});var o=e("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});o.css({display:"none",position:"absolute"}).append(i)}if(r.noneOption){r.noneOption===!0&&(r.noneOption=r.useSelect?"Time...":"None");if(e.isArray(r.noneOption)){for(var u in r.noneOption)if(parseInt(u,10)===u){var f=a(r.noneOption[u],r.useSelect);i.append(f)}}else{var f=a(r.noneOption,r.useSelect);i.append(f)}}r.className&&o.addClass(r.className),(r.minTime!==null||r.durationTime!==null)&&r.showDuration&&(o.addClass("ui-timepicker-with-duration"),o.addClass("ui-timepicker-step-"+r.step));var c=r.minTime;typeof r.durationTime=="function"?c=T(r.durationTime()):r.durationTime!==null&&(c=r.durationTime);var h=r.minTime!==null?r.minTime:0,d=r.maxTime!==null?r.maxTime:h+n-1;d<=h&&(d+=n),d===n-1&&r.timeFormat.indexOf("H")!==-1&&(d=n);var m=r.disableTimeRanges,g=0,b=m.length;for(var u=h;u<=d;u+=r.step*60){var w=u,N=x(w,r.timeFormat);if(r.useSelect){var C=e("<option />",{value:N});C.text(N)}else{var C=e("<li />");C.data("time",w<=86400?w:w%86400),C.text(N)}if((r.minTime!==null||r.durationTime!==null)&&r.showDuration){var k=S(u-c,r.step);if(r.useSelect)C.text(C.text()+" ("+k+")");else{var L=e("<span />",{"class":"ui-timepicker-duration"});L.text(" ("+k+")"),C.append(L)}}g<b&&(w>=m[g][1]&&(g+=1),m[g]&&w>=m[g][0]&&w<m[g][1]&&(r.useSelect?C.prop("disabled",!0):C.addClass("ui-timepicker-disabled"))),i.append(C)}o.data("timepicker-input",t),t.data("timepicker-list",o);if(r.useSelect)i.val(l(t.val(),r)),i.on("focus",function(){e(this).data("timepicker-input").trigger("showTimepicker")}),i.on("blur",function(){e(this).data("timepicker-input").trigger("hideTimepicker")}),i.on("change",function(){y(t,e(this).val(),"select")}),t.hide().after(i);else{var A=r.appendTo;typeof A=="string"?A=e(A):typeof A=="function"&&(A=A(t)),A.append(o),v(t,i),i.on("mousedown","li",function(n){t.off("focus.timepicker"),t.on("focus.timepicker-ie-hack",function(){t.off("focus.timepicker-ie-hack"),t.on("focus.timepicker",s.show)}),p(t)||t[0].focus(),i.find("li").removeClass("ui-timepicker-selected"),e(this).addClass("ui-timepicker-selected"),E(t)&&(t.trigger("hideTimepicker"),o.hide())})}}function a(t,n){var r,i,s;return typeof t=="object"?(r=t.label,i=t.className,s=t.value):typeof t=="string"?r=t:e.error("Invalid noneOption value"),n?e("<option />",{value:s,"class":i,text:r}):e("<li />",{"class":i,text:r}).data("time",s)}function f(t,n){e.isNumeric(t)||(t=T(t));if(t===null)return null;var r=t%(n.step*60);return r>=n.step*30?t+=n.step*60-r:t-=r,t}function l(e,t){e=f(e,t);if(e!==null)return x(e,t.timeFormat)}function c(){return new Date(1970,1,1,0,0,0)}function h(t){var n=e(t.target),r=n.closest(".ui-timepicker-input");r.length===0&&n.closest(".ui-timepicker-wrapper").length===0&&(s.hide(),e(document).unbind(".ui-timepicker"))}function p(e){var t=e.data("timepicker-settings");return(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&t.disableTouchKeyboard}function d(t,n,r){if(!r&&r!==0)return!1;var i=t.data("timepicker-settings"),s=!1,o=i.step*30;return n.find("li").each(function(t,n){var i=e(n);if(typeof i.data("time")!="number")return;var u=i.data("time")-r;if(Math.abs(u)<o||u==o)return s=i,!1}),s}function v(e,t){t.find("li").removeClass("ui-timepicker-selected");var n=T(g(e),e.data("timepicker-settings"));if(n===null)return;var r=d(e,t,n);if(r){var i=r.offset().top-t.offset().top;(i+r.outerHeight()>t.outerHeight()||i<0)&&t.scrollTop(t.scrollTop()+r.position().top-r.outerHeight()),r.addClass("ui-timepicker-selected")}}function m(t){if(this.value==="")return;var n=e(this),r=n.data("timepicker-list");if(n.is(":focus")&&(!t||t.type!="change"))return;var i=T(this.value);if(i===null){n.trigger("timeFormatError");return}var s=n.data("timepicker-settings"),o=!1;s.minTime!==null&&i<s.minTime?o=!0:s.maxTime!==null&&i>s.maxTime&&(o=!0),e.each(s.disableTimeRanges,function(){if(i>=this[0]&&i<this[1])return o=!0,!1});if(s.forceRoundTime){var u=i%(s.step*60);u>=s.step*30?i+=s.step*60-u:i-=u}var a=x(i,s.timeFormat);o?y(n,a,"error")&&n.trigger("timeRangeError"):y(n,a)}function g(e){return e.is("input")?e.val():e.data("ui-timepicker-value")}function y(e,t,n){if(e.is("input")){e.val(t);var r=e.data("timepicker-settings");r.useSelect&&e.data("timepicker-list").val(l(t,r))}return e.data("ui-timepicker-value")!=t?(e.data("ui-timepicker-value",t),n=="select"?e.trigger("selectTime").trigger("changeTime").trigger("change"):n!="error"&&e.trigger("changeTime"),!0):(e.trigger("selectTime"),!1)}function b(t){var n=e(this),r=n.data("timepicker-list");if(!r||!r.is(":visible")){if(t.keyCode!=40)return!0;s.show.call(n.get(0)),r=n.data("timepicker-list"),p(n)||n.focus()}switch(t.keyCode){case 13:return E(n)&&s.hide.apply(this),t.preventDefault(),!1;case 38:var i=r.find(".ui-timepicker-selected");return i.length?i.is(":first-child")||(i.removeClass("ui-timepicker-selected"),i.prev().addClass("ui-timepicker-selected"),i.prev().position().top<i.outerHeight()&&r.scrollTop(r.scrollTop()-i.outerHeight())):(r.find("li").each(function(t,n){if(e(n).position().top>0)return i=e(n),!1}),i.addClass("ui-timepicker-selected")),!1;case 40:return i=r.find(".ui-timepicker-selected"),i.length===0?(r.find("li").each(function(t,n){if(e(n).position().top>0)return i=e(n),!1}),i.addClass("ui-timepicker-selected")):i.is(":last-child")||(i.removeClass("ui-timepicker-selected"),i.next().addClass("ui-timepicker-selected"),i.next().position().top+2*i.outerHeight()>r.outerHeight()&&r.scrollTop(r.scrollTop()+i.outerHeight())),!1;case 27:r.find("li").removeClass("ui-timepicker-selected"),s.hide();break;case 9:s.hide();break;default:return!0}}function w(t){var n=e(this),r=n.data("timepicker-list");if(!r||!r.is(":visible"))return!0;if(!n.data("timepicker-settings").typeaheadHighlight)return r.find("li").removeClass("ui-timepicker-selected"),!0;switch(t.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:v(n,r);break;default:return}}function E(e){var t=e.data("timepicker-settings"),n=e.data("timepicker-list"),r=null,i=n.find(".ui-timepicker-selected");if(i.hasClass("ui-timepicker-disabled"))return!1;i.length&&(r=i.data("time"));if(r!==null)if(typeof r=="string")e.val(r);else{var s=x(r,t.timeFormat);y(e,s,"select")}return!0}function S(e,t){e=Math.abs(e);var n=Math.round(e/60),r=[],s,o;return n<60?r=[n,i.mins]:(s=Math.floor(n/60),o=n%60,t==30&&o==30&&(s+=i.decimal+5),r.push(s),r.push(s==1?i.hr:i.hrs),t!=30&&o&&(r.push(o),r.push(i.mins))),r.join(" ")}function x(e,r){if(e===null)return;var s=new Date(t.valueOf()+e*1e3);if(isNaN(s.getTime()))return;var o="",u,a;for(var f=0;f<r.length;f++){a=r.charAt(f);switch(a){case"a":o+=s.getHours()>11?i.pm:i.am;break;case"A":o+=s.getHours()>11?i.PM:i.AM;break;case"g":u=s.getHours()%12,o+=u===0?"12":u;break;case"G":o+=s.getHours();break;case"h":u=s.getHours()%12,u!==0&&u<10&&(u="0"+u),o+=u===0?"12":u;break;case"H":u=s.getHours(),e===n&&(u=24),o+=u>9?u:"0"+u;break;case"i":var l=s.getMinutes();o+=l>9?l:"0"+l;break;case"s":e=s.getSeconds(),o+=e>9?e:"0"+e;break;default:o+=a}}return o}function T(e,t){if(e==="")return null;if(!e||e+0==e)return e;if(typeof e=="object")return e.getHours()*3600+e.getMinutes()*60+e.getSeconds();e=e.toLowerCase();var r=new Date(0),i;i=e.match(/^([0-2]?[0-9])\W?([0-5][0-9])?\W?([0-5][0-9])?\s*([pa]?)m?$/);if(!i)return null;var s=parseInt(i[1]*1,10),o=i[4],u=s;o&&(s==12?u=i[4]=="p"?12:0:u=s+(i[4]=="p"?12:0));var a=i[2]*1||0,f=i[3]*1||0,l=u*3600+a*60+f;if(!o&&t&&t._twelveHourTime&&t.scrollDefault){var c=l-t.scrollDefault;c<0&&c>=n/-2&&(l=(l+n/2)%n)}return l}function N(e){return("0"+e).slice(-2)}var t=c(),n=86400,r={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:!1,showOnFocus:!0,timeFormat:"g:ia",scrollDefault:null,selectOnBlur:!1,disableTouchKeyboard:!1,forceRoundTime:!1,appendTo:"body",orientation:"ltr",disableTimeRanges:[],closeOnWindowScroll:!1,typeaheadHighlight:!0,noneOption:!1},i={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},s={init:function(t){return this.each(function(){var n=e(this),a=[];for(var f in r)n.data(f)&&(a[f]=n.data(f));var l=e.extend({},r,a,t);l.lang&&(i=e.extend(i,l.lang)),l=o(l),n.data("timepicker-settings",l),n.addClass("ui-timepicker-input"),l.useSelect?u(n):(n.prop("autocomplete","off"),n.on("click.timepicker focus.timepicker",s.show),n.on("change.timepicker",m),n.on("keydown.timepicker",b),n.on("keyup.timepicker",w),m.call(n.get(0)))})},show:function(t){var n=e(this),r=n.data("timepicker-settings");if(t){if(!r.showOnFocus)return!0;t.preventDefault()}if(r.useSelect){n.data("timepicker-list").focus();return}p(n)&&n.blur();var i=n.data("timepicker-list");if(n.prop("readonly"))return;if(!i||i.length===0||typeof r.durationTime=="function")u(n),i=n.data("timepicker-list");if(i.is(":visible"))return;s.hide(),i.show();var o={};r.orientation=="rtl"?o.left=n.offset().left+n.outerWidth()-i.outerWidth()+parseInt(i.css("marginLeft").replace("px",""),10):o.left=n.offset().left+parseInt(i.css("marginLeft").replace("px",""),10),n.offset().top+n.outerHeight(!0)+i.outerHeight()>e(window).height()+e(window).scrollTop()?o.top=n.offset().top-i.outerHeight()+parseInt(i.css("marginTop").replace("px",""),10):o.top=n.offset().top+n.outerHeight()+parseInt(i.css("marginTop").replace("px",""),10),i.offset(o);var a=i.find(".ui-timepicker-selected");a.length||(g(n)?a=d(n,i,T(g(n))):r.scrollDefault&&(a=d(n,i,r.scrollDefault)));if(a&&a.length){var f=i.scrollTop()+a.position().top-a.outerHeight();i.scrollTop(f)}else i.scrollTop(0);return e(document).on("touchstart.ui-timepicker mousedown.ui-timepicker",h),r.closeOnWindowScroll&&e(document).on("scroll.ui-timepicker",h),n.trigger("showTimepicker"),this},hide:function(t){var n=e(this),r=n.data("timepicker-settings");return r&&r.useSelect&&n.blur(),e(".ui-timepicker-wrapper:visible").each(function(){var t=e(this),n=t.data("timepicker-input"),r=n.data("timepicker-settings");r&&r.selectOnBlur&&E(n),t.hide(),n.trigger("hideTimepicker")}),this},option:function(t,n){return this.each(function(){var r=e(this),i=r.data("timepicker-settings"),s=r.data("timepicker-list");if(typeof t=="object")i=e.extend(i,t);else if(typeof t=="string"&&typeof n!="undefined")i[t]=n;else if(typeof t=="string")return i[t];i=o(i),r.data("timepicker-settings",i),s&&(s.remove(),r.data("timepicker-list",!1)),i.useSelect&&u(r)})},getSecondsFromMidnight:function(){return T(g(this))},getTime:function(e){var t=this,n=g(t);if(!n)return null;e||(e=new Date);var r=T(n),i=new Date(e);return i.setHours(r/3600),i.setMinutes(r%3600/60),i.setSeconds(r%60),i.setMilliseconds(0),i},setTime:function(e){var t=this,n=t.data("timepicker-settings");if(n.forceRoundTime)var r=l(e,n);else var r=x(T(e),n.timeFormat);return y(t,r),t.data("timepicker-list")&&v(t,t.data("timepicker-list")),this},remove:function(){var e=this;if(!e.hasClass("ui-timepicker-input"))return;var t=e.data("timepicker-settings");return e.removeAttr("autocomplete","off"),e.removeClass("ui-timepicker-input"),e.removeData("timepicker-settings"),e.off(".timepicker"),e.data("timepicker-list")&&e.data("timepicker-list").remove(),t.useSelect&&e.show(),e.removeData("timepicker-list"),this}};e.fn.timepicker=function(t){if(!this.length)return this;if(s[t])return this.hasClass("ui-timepicker-input")?s[t].apply(this,Array.prototype.slice.call(arguments,1)):this;if(typeof t=="object"||!t)return s.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.timepicker")}}),define("jqdatetimepicker",["jquery"],function(e){(function(e){var t={i18n:{ar:{months:["كانون الثاني","شباط","آذار","نيسان","مايو","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],dayOfWeek:["ن","ث","ع","خ","ج","س","ح"]},ro:{months:["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],dayOfWeek:["l","ma","mi","j","v","s","d"]},id:{months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],dayOfWeek:["Sen","Sel","Rab","Kam","Jum","Sab","Min"]},bg:{months:["Януари","Февруари","Март","Април","Май","Юни","Юли","Август","Септември","Октомври","Ноември","Декември"],dayOfWeek:["Нд","Пн","Вт","Ср","Чт","Пт","Сб"]},fa:{months:["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],dayOfWeek:["یکشنبه","دوشنبه","سه شنبه","چهارشنبه","پنجشنبه","جمعه","شنبه"]},ru:{months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayOfWeek:["Вск","Пн","Вт","Ср","Чт","Пт","Сб"]},uk:{months:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],dayOfWeek:["Ндл","Пнд","Втр","Срд","Чтв","Птн","Сбт"]},en:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},el:{months:["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],dayOfWeek:["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"]},de:{months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dayOfWeek:["So","Mo","Di","Mi","Do","Fr","Sa"]},nl:{months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],dayOfWeek:["zo","ma","di","wo","do","vr","za"]},tr:{months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],dayOfWeek:["Paz","Pts","Sal","Çar","Per","Cum","Cts"]},fr:{months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dayOfWeek:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},es:{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dayOfWeek:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"]},th:{months:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],dayOfWeek:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},pl:{months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],dayOfWeek:["nd","pn","wt","śr","cz","pt","sb"]},pt:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]},ch:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeek:["日","一","二","三","四","五","六"]},se:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeek:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"]},kr:{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayOfWeek:["일","월","화","수","목","금","토"]},it:{months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dayOfWeek:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"]},da:{months:["January","Februar","Marts","April","Maj","Juni","July","August","September","Oktober","November","December"],dayOfWeek:["Søn","Man","Tir","Ons","Tor","Fre","Lør"]},no:{months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],dayOfWeek:["Søn","Man","Tir","Ons","Tor","Fre","Lør"]},ja:{months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["日","月","火","水","木","金","土"]},vi:{months:["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],dayOfWeek:["CN","T2","T3","T4","T5","T6","T7"]},sl:{months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],dayOfWeek:["Ned","Pon","Tor","Sre","Čet","Pet","Sob"]},cs:{months:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],dayOfWeek:["Ne","Po","Út","St","Čt","Pá","So"]},hu:{months:["Január","Február","Március","Április","Május","Június","Július","Augusztus","Szeptember","Október","November","December"],dayOfWeek:["Va","Hé","Ke","Sze","Cs","Pé","Szo"]}},value:"",lang:"en",format:"Y/m/d H:i",formatTime:"H:i",formatDate:"Y/m/d",startDate:!1,step:60,monthChangeSpinner:!0,closeOnDateSelect:!1,closeOnWithoutClick:!0,closeOnInputClick:!0,timepicker:!0,datepicker:!0,weeks:!1,defaultTime:!1,defaultDate:!1,minDate:!1,maxDate:!1,minTime:!1,maxTime:!1,allowTimes:[],opened:!1,initTime:!0,inline:!1,onSelectDate:function(){},onSelectTime:function(){},onChangeMonth:function(){},onChangeDateTime:function(){},onShow:function(){},onClose:function(){},onGenerate:function(){},withoutCopyright:!0,inverseButton:!1,hours12:!1,next:"xdsoft_next",prev:"xdsoft_prev",dayOfWeekStart:0,timeHeightInTimePicker:25,timepickerScrollbar:!0,todayButton:!0,defaultSelect:!0,scrollMonth:!0,scrollTime:!0,scrollInput:!0,lazyInit:!1,mask:!1,validateOnBlur:!0,allowBlank:!0,yearStart:1950,yearEnd:2050,style:"",id:"",fixed:!1,roundTime:"round",className:"",weekends:[],yearOffset:0,beforeShowDay:null};Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var n=t||0,r=this.length;n<r;n++)if(this[n]===e)return n;return-1}),Date.prototype.countDaysInMonth=function(){return(new Date(this.getFullYear(),this.getMonth()+1,0)).getDate()},e.fn.xdsoftScroller=function(t){return this.each(function(){var n=e(this);if(!e(this).hasClass("xdsoft_scroller_box")){var r=function(e){var t={x:0,y:0};if(e.type=="touchstart"||e.type=="touchmove"||e.type=="touchend"||e.type=="touchcancel"){var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];t.x=n.pageX,t.y=n.pageY}else if(e.type=="mousedown"||e.type=="mouseup"||e.type=="mousemove"||e.type=="mouseover"||e.type=="mouseout"||e.type=="mouseenter"||e.type=="mouseleave")t.x=e.pageX,t.y=e.pageY;return t},i=0,s=n.children().eq(0),o=n[0].clientHeight,u=s[0].offsetHeight,a=e('<div class="xdsoft_scrollbar"></div>'),f=e('<div class="xdsoft_scroller"></div>'),l=100,c=!1;a.append(f),n.addClass("xdsoft_scroller_box").append(a),f.on("mousedown.xdsoft_scroller",function(r){o||n.trigger("resize_scroll.xdsoft_scroller",[t]);var s=r.pageY,u=parseInt(f.css("margin-top")),c=a[0].offsetHeight;e(document.body).addClass("xdsoft_noselect"),e([document.body,window]).on("mouseup.xdsoft_scroller",function h(){e([document.body,window]).off("mouseup.xdsoft_scroller",h).off("mousemove.xdsoft_scroller",i).removeClass("xdsoft_noselect")}),e(document.body).on("mousemove.xdsoft_scroller",i=function(e){var t=e.pageY-s+u;t<0&&(t=0),t+f[0].offsetHeight>c&&(t=c-f[0].offsetHeight),n.trigger("scroll_element.xdsoft_scroller",[l?t/l:0])})}),n.on("scroll_element.xdsoft_scroller",function(e,t){o||n.trigger("resize_scroll.xdsoft_scroller",[t,!0]),t=t>1?1:t<0||isNaN(t)?0:t,f.css("margin-top",l*t),s.css("marginTop",-parseInt((u-o)*t))}).on("resize_scroll.xdsoft_scroller",function(e,t,r){o=n[0].clientHeight,u=s[0].offsetHeight;var i=o/u,c=i*a[0].offsetHeight;i>1?f.hide():(f.show(),f.css("height",parseInt(c>10?c:10)),l=a[0].offsetHeight-f[0].offsetHeight,r!==!0&&n.trigger("scroll_element.xdsoft_scroller",[t?t:Math.abs(parseInt(s.css("marginTop")))/(u-o)]))}),n.mousewheel&&n.mousewheel(function(e,t,r,i){var a=Math.abs(parseInt(s.css("marginTop")));return n.trigger("scroll_element.xdsoft_scroller",[(a-t*20)/(u-o)]),e.stopPropagation(),!1}),n.on("touchstart",function(e){c=r(e)}),n.on("touchmove",function(e){if(c){var t=r(e),i=Math.abs(parseInt(s.css("marginTop")));n.trigger("scroll_element.xdsoft_scroller",[(i-(t.y-c.y))/(u-o)]),e.stopPropagation(),e.preventDefault(),c=r(e)}}),n.on("touchend touchcancel",function(e){c=!1})}n.trigger("resize_scroll.xdsoft_scroller",[t])})},e.fn.datetimepicker=function(n){var r=48,i=57,s=96,o=105,u=17,a=46,f=13,l=27,c=8,h=37,p=38,d=39,v=40,m=9,g=116,y=65,b=67,w=86,E=90,S=89,x=!1,T=e.isPlainObject(n)||!n?e.extend(!0,{},t,n):e.extend({},t),N=0,C=function(e){e.on("open.xdsoft focusin.xdsoft mousedown.xdsoft",function t(n){if(e.is(":disabled")||e.is(":hidden")||!e.is(":visible")||e.data("xdsoft_datetimepicker"))return;clearTimeout(N),N=setTimeout(function(){e.data("xdsoft_datetimepicker")||k(e),e.off("open.xdsoft focusin.xdsoft mousedown.xdsoft",t).trigger("open.xdsoft")},100)})},k=function(t){function X(){var e=!1;return T.startDate?e=j.strToDate(T.startDate):(e=T.value?T.value:t&&t.val&&t.val()?t.val():"",e?e=j.strToDateTime(e):T.defaultDate&&(e=j.strToDate(T.defaultDate))),e&&j.isValidDate(e)?n.data("changed",!0):e="",e?e:0}var n=e("<div "+(T.id?'id="'+T.id+'"':"")+" "+(T.style?'style="'+T.style+'"':"")+' class="xdsoft_datetimepicker xdsoft_noselect '+(T.weeks?" xdsoft_showweeks":"")+T.className+'"></div>'),N=e('<div class="xdsoft_copyright"><a target="_blank" href="http://xdsoft.net/jqplugins/datetimepicker/">xdsoft.net</a></div>'),C=e('<div class="xdsoft_datepicker active"></div>'),k=e('<div class="xdsoft_mounthpicker"><button type="button" class="xdsoft_prev"></button><button type="button" class="xdsoft_today_button"></button><div class="xdsoft_label xdsoft_month"><span></span></div><div class="xdsoft_label xdsoft_year"><span></span></div><button type="button" class="xdsoft_next"></button></div>'),L=e('<div class="xdsoft_calendar"></div>'),A=e('<div class="xdsoft_timepicker active"><button type="button" class="xdsoft_prev"></button><div class="xdsoft_time_box"></div><button type="button" class="xdsoft_next"></button></div>'),O=A.find(".xdsoft_time_box").eq(0),M=e('<div class="xdsoft_time_variant"></div>'),_=e('<div class="xdsoft_scrollbar"></div>'),D=e('<div class="xdsoft_scroller"></div>'),P=e('<div class="xdsoft_select xdsoft_monthselect"><div></div></div>'),H=e('<div class="xdsoft_select xdsoft_yearselect"><div></div></div>');k.find(".xdsoft_month span").after(P),k.find(".xdsoft_year span").after(H),k.find(".xdsoft_month,.xdsoft_year").on("mousedown.xdsoft",function(t){k.find(".xdsoft_select").hide();var n=e(this).find(".xdsoft_select").eq(0),r=0,i=0;j.currentTime&&(r=j.currentTime[e(this).hasClass("xdsoft_month")?"getMonth":"getFullYear"]()),n.show();for(var s=n.find("div.xdsoft_option"),o=0;o<s.length;o++){if(s.eq(o).data("value")==r)break;i+=s[0].offsetHeight}return n.xdsoftScroller(i/(n.children()[0].offsetHeight-n[0].clientHeight)),t.stopPropagation(),!1}),k.find(".xdsoft_select").xdsoftScroller().on("mousedown.xdsoft",function(e){e.stopPropagation(),e.preventDefault()}).on("mousedown.xdsoft",".xdsoft_option",function(t){j&&j.currentTime&&j.currentTime[e(this).parent().parent().hasClass("xdsoft_monthselect")?"setMonth":"setFullYear"](e(this).data("value")),e(this).parent().parent().hide(),n.trigger("xchange.xdsoft"),T.onChangeMonth&&T.onChangeMonth.call&&T.onChangeMonth.call(n,j.currentTime,n.data("input"))}),n.setOptions=function(N){T=e.extend(!0,{},T,N),N.allowTimes&&e.isArray(N.allowTimes)&&N.allowTimes.length&&(T.allowTimes=e.extend(!0,[],N.allowTimes)),N.weekends&&e.isArray(N.weekends)&&N.weekends.length&&(T.weekends=e.extend(!0,[],N.weekends)),(T.open||T.opened)&&!T.inline&&t.trigger("open.xdsoft"),T.inline&&(q=!0,n.addClass("xdsoft_inline"),t.after(n).hide()),T.inverseButton&&(T.next="xdsoft_prev",T.prev="xdsoft_next"),T.datepicker?C.addClass("active"):C.removeClass("active"),T.timepicker?A.addClass("active"):A.removeClass("active"),T.value&&(t&&t.val&&t.val(T.value),j.setCurrentTime(T.value)),isNaN(T.dayOfWeekStart)?T.dayOfWeekStart=0:T.dayOfWeekStart=parseInt(T.dayOfWeekStart)%7,T.timepickerScrollbar||_.hide(),T.minDate&&/^-(.*)$/.test(T.minDate)&&(T.minDate=j.strToDateTime(T.minDate).dateFormat(T.formatDate)),T.maxDate&&/^\+(.*)$/.test(T.maxDate)&&(T.maxDate=j.strToDateTime(T.maxDate).dateFormat(T.formatDate)),k.find(".xdsoft_today_button").css("visibility",T.todayButton?"visible":"hidden");if(T.mask){var L,O=function(e){try{if(document.selection&&document.selection.createRange){var t=document.selection.createRange();return t.getBookmark().charCodeAt(2)-2}if(e.setSelectionRange)return e.selectionStart}catch(n){return 0}},M=function(e,t){e=typeof e=="string"||e instanceof String?document.getElementById(e):e;if(!e)return!1;if(e.createTextRange){var n=e.createTextRange();return n.collapse(!0),n.moveEnd(t),n.moveStart(t),n.select(),!0}return e.setSelectionRange?(e.setSelectionRange(t,t),!0):!1},D=function(e,t){var n=e.replace(/([\[\]\/\{\}\(\)\-\.\+]{1})/g,"\\$1").replace(/_/g,"{digit+}").replace(/([0-9]{1})/g,"{digit$1}").replace(/\{digit([0-9]{1})\}/g,"[0-$1_]{1}").replace(/\{digit[\+]\}/g,"[0-9_]{1}");return RegExp(n).test(t)};t.off("keydown.xdsoft");switch(!0){case T.mask===!0:T.mask=T.format.replace(/Y/g,"9999").replace(/F/g,"9999").replace(/m/g,"19").replace(/d/g,"39").replace(/H/g,"29").replace(/i/g,"59").replace(/s/g,"59");case e.type(T.mask)=="string":D(T.mask,t.val())||t.val(T.mask.replace(/[0-9]/g,"_")),t.on("keydown.xdsoft",function(n){var N=this.value,C=n.which;switch(!0){case C>=r&&C<=i||C>=s&&C<=o||C==c||C==a:var k=O(this),L=C!=c&&C!=a?String.fromCharCode(s<=C&&C<=o?C-r:C):"_";(C==c||C==a)&&k&&(k--,L="_");while(/[^0-9_]/.test(T.mask.substr(k,1))&&k<T.mask.length&&k>0)k+=C==c||C==a?-1:1;N=N.substr(0,k)+L+N.substr(k+1);if(e.trim(N)=="")N=T.mask.replace(/[0-9]/g,"_");else if(k==T.mask.length)break;k+=C==c||C==a?0:1;while(/[^0-9_]/.test(T.mask.substr(k,1))&&k<T.mask.length&&k>0)k+=C==c||C==a?-1:1;D(T.mask,N)?(this.value=N,M(this,k)):e.trim(N)==""?this.value=T.mask.replace(/[0-9]/g,"_"):t.trigger("error_input.xdsoft");break;case!!~[y,b,w,E,S].indexOf(C)&&x:case!!~[l,p,v,h,d,g,u,m,f].indexOf(C):return!0}return n.preventDefault(),!1})}}T.validateOnBlur&&t.off("blur.xdsoft").on("blur.xdsoft",function(){T.allowBlank&&!e.trim(e(this).val()).length?(e(this).val(null),n.data("xdsoft_datetime").empty()):Date.parseDate(e(this).val(),T.format)?n.data("xdsoft_datetime").setCurrentTime(e(this).val()):(e(this).val(j.now().dateFormat(T.format)),n.data("xdsoft_datetime").setCurrentTime(e(this).val())),n.trigger("changedatetime.xdsoft")}),T.dayOfWeekStartPrev=T.dayOfWeekStart==0?6:T.dayOfWeekStart-1,n.trigger("xchange.xdsoft").trigger("afterOpen.xdsoft")},n.data("options",T).on("mousedown.xdsoft",function(e){return e.stopPropagation(),e.preventDefault(),H.hide(),P.hide(),!1});var B=A.find(".xdsoft_time_box");B.append(M),B.xdsoftScroller(),n.on("afterOpen.xdsoft",function(){B.xdsoftScroller()}),n.append(C).append(A),T.withoutCopyright!==!0&&n.append(N),C.append(k).append(L),e("body").append(n);var j=new function(){var e=this;e.now=function(t){var n=new Date;if(!t&&T.defaultDate){var r=e.strToDate(T.defaultDate);n.setFullYear(r.getFullYear()),n.setMonth(r.getMonth()),n.setDate(r.getDate())}T.yearOffset&&n.setFullYear(n.getFullYear()+T.yearOffset);if(!t&&T.defaultTime){var i=e.strtotime(T.defaultTime);n.setHours(i.getHours()),n.setMinutes(i.getMinutes())}return n},e.isValidDate=function(e){return Object.prototype.toString.call(e)!=="[object Date]"?!1:!isNaN(e.getTime())},e.setCurrentTime=function(t){e.currentTime=typeof t=="string"?e.strToDateTime(t):e.isValidDate(t)?t:e.now(),n.trigger("xchange.xdsoft")},e.empty=function(){e.currentTime=null},e.getCurrentTime=function(t){return e.currentTime},e.nextMonth=function(){var t=e.currentTime.getMonth()+1;return t==12&&(e.currentTime.setFullYear(e.currentTime.getFullYear()+1),t=0),e.currentTime.setDate(Math.min((new Date(e.currentTime.getFullYear(),t+1,0)).getDate(),e.currentTime.getDate())),e.currentTime.setMonth(t),T.onChangeMonth&&T.onChangeMonth.call&&T.onChangeMonth.call(n,j.currentTime,n.data("input")),n.trigger("xchange.xdsoft"),t},e.prevMonth=function(){var t=e.currentTime.getMonth()-1;return t==-1&&(e.currentTime.setFullYear(e.currentTime.getFullYear()-1),t=11),e.currentTime.setDate(Math.min((new Date(e.currentTime.getFullYear(),t+1,0)).getDate(),e.currentTime.getDate())),e.currentTime.setMonth(t),T.onChangeMonth&&T.onChangeMonth.call&&T.onChangeMonth.call(n,j.currentTime,n.data("input")),n.trigger("xchange.xdsoft"),t},e.strToDateTime=function(t){if(t&&t instanceof Date&&e.isValidDate(t))return t;var n=[],r,i;return(n=/^(\+|\-)(.*)$/.exec(t))&&(n[2]=Date.parseDate(n[2],T.formatDate))?(r=n[2].getTime()-n[2].getTimezoneOffset()*6e4,i=new Date(j.now().getTime()+parseInt(n[1]+"1")*r)):i=t?Date.parseDate(t,T.format):e.now(),e.isValidDate(i)||(i=e.now()),i},e.strToDate=function(t){if(t&&t instanceof Date&&e.isValidDate(t))return t;var n=t?Date.parseDate(t,T.formatDate):e.now(!0);return e.isValidDate(n)||(n=e.now(!0)),n},e.strtotime=function(t){if(t&&t instanceof Date&&e.isValidDate(t))return t;var n=t?Date.parseDate(t,T.formatTime):e.now();return e.isValidDate(n)||(n=e.now(!0)),n},e.str=function(){return e.currentTime.dateFormat(T.format)},e.currentTime=this.now()};k.find(".xdsoft_today_button").on("mousedown.xdsoft",function(){n.data("changed",!0),j.setCurrentTime(0),n.trigger("afterOpen.xdsoft")}).on("dblclick.xdsoft",function(){t.val(j.str()),n.trigger("close.xdsoft")}),k.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var t=e(this),n=0,r=!1;(function i(e){var s=j.currentTime.getMonth();t.hasClass(T.next)?j.nextMonth():t.hasClass(T.prev)&&j.prevMonth(),T.monthChangeSpinner&&!r&&(n=setTimeout(i,e?e:100))})(500),e([document.body,window]).on("mouseup.xdsoft",function s(){clearTimeout(n),r=!0,e([document.body,window]).off("mouseup.xdsoft",s)})}),A.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var t=e(this),n=0,r=!1,i=110;(function s(e){var o=O[0].clientHeight,u=M[0].offsetHeight,a=Math.abs(parseInt(M.css("marginTop")));t.hasClass(T.next)&&u-o-T.timeHeightInTimePicker>=a?M.css("marginTop","-"+(a+T.timeHeightInTimePicker)+"px"):t.hasClass(T.prev)&&a-T.timeHeightInTimePicker>=0&&M.css("marginTop","-"+(a-T.timeHeightInTimePicker)+"px"),O.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(M.css("marginTop"))/(u-o))]),i=i>10?10:i-10,!r&&(n=setTimeout(s,e?e:i))})(500),e([document.body,window]).on("mouseup.xdsoft",function o(){clearTimeout(n),r=!0,e([document.body,window]).off("mouseup.xdsoft",o)})});var F=0;n.on("xchange.xdsoft",function(t){clearTimeout(F),F=setTimeout(function(){var t="",r=new Date(j.currentTime.getFullYear(),j.currentTime.getMonth(),1,12,0,0),i=0,s=j.now();while(r.getDay()!=T.dayOfWeekStart)r.setDate(r.getDate()-1);t+="<table><thead><tr>",T.weeks&&(t+="<th></th>");for(var o=0;o<7;o++)t+="<th>"+T.i18n[T.lang].dayOfWeek[(o+T.dayOfWeekStart)%7]+"</th>";t+="</tr></thead>",t+="<tbody>";var u=!1,a=!1;T.maxDate!==!1&&(u=j.strToDate(T.maxDate),u=new Date(u.getFullYear(),u.getMonth(),u.getDate(),23,59,59,999)),T.minDate!==!1&&(a=j.strToDate(T.minDate),a=new Date(a.getFullYear(),a.getMonth(),a.getDate()));var f,l,c,h,p=[],d,v=!0;while(i<j.currentTime.countDaysInMonth()||r.getDay()!=T.dayOfWeekStart||j.currentTime.getMonth()==r.getMonth())p=[],i++,f=r.getDate(),l=r.getFullYear(),c=r.getMonth(),h=r.getWeekOfYear(),p.push("xdsoft_date"),T.beforeShowDay&&T.beforeShowDay.call?d=T.beforeShowDay.call(n,r):d=null,(u!==!1&&r>u||a!==!1&&r<a||d&&d[0]===!1)&&p.push("xdsoft_disabled"),d&&d[1]!=""&&p.push(d[1]),j.currentTime.getMonth()!=c&&p.push("xdsoft_other_month"),(T.defaultSelect||n.data("changed"))&&j.currentTime.dateFormat(T.formatDate)==r.dateFormat(T.formatDate)&&p.push("xdsoft_current"),s.dateFormat(T.formatDate)==r.dateFormat(T.formatDate)&&p.push("xdsoft_today"),(r.getDay()==0||r.getDay()==6||~T.weekends.indexOf(r.dateFormat(T.formatDate)))&&p.push("xdsoft_weekend"),T.beforeShowDay&&typeof T.beforeShowDay=="function"&&p.push(T.beforeShowDay(r)),v&&(t+="<tr>",v=!1,T.weeks&&(t+="<th>"+h+"</th>")),t+='<td data-date="'+f+'" data-month="'+c+'" data-year="'+l+'"'+' class="xdsoft_date xdsoft_day_of_week'+r.getDay()+" "+p.join(" ")+'">'+"<div>"+f+"</div>"+"</td>",r.getDay()==T.dayOfWeekStartPrev&&(t+="</tr>",v=!0),r.setDate(f+1);t+="</tbody></table>",L.html(t),k.find(".xdsoft_label span").eq(0).text(T.i18n[T.lang].months[j.currentTime.getMonth()]),k.find(".xdsoft_label span").eq(1).text(j.currentTime.getFullYear());var m="",g="",c="",y=function(t,r){var i=j.now();i.setHours(t),t=parseInt(i.getHours()),i.setMinutes(r),r=parseInt(i.getMinutes()),p=[],(T.maxTime!==!1&&j.strtotime(T.maxTime).getTime()<i.getTime()||T.minTime!==!1&&j.strtotime(T.minTime).getTime()>i.getTime())&&p.push("xdsoft_disabled"),(T.initTime||T.defaultSelect||n.data("changed"))&&parseInt(j.currentTime.getHours())==parseInt(t)&&(T.step>59||Math[T.roundTime](j.currentTime.getMinutes()/T.step)*T.step==parseInt(r))&&(T.defaultSelect||n.data("changed")?p.push("xdsoft_current"):T.initTime&&p.push("xdsoft_init_time")),parseInt(s.getHours())==parseInt(t)&&parseInt(s.getMinutes())==parseInt(r)&&p.push("xdsoft_today"),m+='<div class="xdsoft_time '+p.join(" ")+'" data-hour="'+t+'" data-minute="'+r+'">'+i.dateFormat(T.formatTime)+"</div>"};if(!T.allowTimes||!e.isArray(T.allowTimes)||!T.allowTimes.length)for(var i=0,o=0;i<(T.hours12?12:24);i++)for(o=0;o<60;o+=T.step)g=(i<10?"0":"")+i,c=(o<10?"0":"")+o,y(g,c);else for(var i=0;i<T.allowTimes.length;i++)g=j.strtotime(T.allowTimes[i]).getHours(),c=j.strtotime(T.allowTimes[i]).getMinutes(),y(g,c);M.html(m);var b="",i=0;for(i=parseInt(T.yearStart,10)+T.yearOffset;i<=parseInt(T.yearEnd,10)+T.yearOffset;i++)b+='<div class="xdsoft_option '+(j.currentTime.getFullYear()==i?"xdsoft_current":"")+'" data-value="'+i+'">'+i+"</div>";H.children().eq(0).html(b);for(i=0,b="";i<=11;i++)b+='<div class="xdsoft_option '+(j.currentTime.getMonth()==i?"xdsoft_current":"")+'" data-value="'+i+'">'+T.i18n[T.lang].months[i]+"</div>";P.children().eq(0).html(b),e(n).trigger("generate.xdsoft")},10),t.stopPropagation()}).on("afterOpen.xdsoft",function(){if(T.timepicker){var e;M.find(".xdsoft_current").length?e=".xdsoft_current":M.find(".xdsoft_init_time").length&&(e=".xdsoft_init_time");if(e){var t=O[0].clientHeight,n=M[0].offsetHeight,r=M.find(e).index()*T.timeHeightInTimePicker+1;n-t<r&&(r=n-t),O.trigger("scroll_element.xdsoft_scroller",[parseInt(r)/(n-t)])}else O.trigger("scroll_element.xdsoft_scroller",[0])}});var I=0;L.on("click.xdsoft","td",function(r){r.stopPropagation(),I++;var i=e(this),s=j.currentTime;if(s===undefined||s===null)j.currentTime=j.now(),s=j.currentTime;if(i.hasClass("xdsoft_disabled"))return!1;s.setDate(1),s.setFullYear(i.data("year")),s.setMonth(i.data("month")),s.setDate(i.data("date")),n.trigger("select.xdsoft",[s]),t.val(j.str()),(I>1||T.closeOnDateSelect===!0||T.closeOnDateSelect===0&&!T.timepicker)&&!T.inline&&n.trigger("close.xdsoft"),T.onSelectDate&&T.onSelectDate.call&&T.onSelectDate.call(n,j.currentTime,n.data("input")),n.data("changed",!0),n.trigger("xchange.xdsoft"),n.trigger("changedatetime.xdsoft"),setTimeout(function(){I=0},200)}),M.on("click.xdsoft","div",function(t){t.stopPropagation();var r=e(this),i=j.currentTime;if(i===undefined||i===null)j.currentTime=j.now(),i=j.currentTime;if(r.hasClass("xdsoft_disabled"))return!1;i.setHours(r.data("hour")),i.setMinutes(r.data("minute")),n.trigger("select.xdsoft",[i]),n.data("input").val(j.str()),!T.inline&&n.trigger("close.xdsoft"),T.onSelectTime&&T.onSelectTime.call&&T.onSelectTime.call(n,j.currentTime,n.data("input")),n.data("changed",!0),n.trigger("xchange.xdsoft"),n.trigger("changedatetime.xdsoft")}),n.mousewheel&&C.mousewheel(function(e,t,n,r){return T.scrollMonth?(t<0?j.nextMonth():j.prevMonth(),!1):!0}),n.mousewheel&&O.unmousewheel().mousewheel(function(e,t,n,r){if(!T.scrollTime)return!0;var i=O[0].clientHeight,s=M[0].offsetHeight,o=Math.abs(parseInt(M.css("marginTop"))),u=!0;return t<0&&s-i-T.timeHeightInTimePicker>=o?(M.css("marginTop","-"+(o+T.timeHeightInTimePicker)+"px"),u=!1):t>0&&o-T.timeHeightInTimePicker>=0&&(M.css("marginTop","-"+(o-T.timeHeightInTimePicker)+"px"),u=!1),O.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(M.css("marginTop"))/(s-i))]),e.stopPropagation(),u});var q=!1;n.on("changedatetime.xdsoft",function(){if(T.onChangeDateTime&&T.onChangeDateTime.call){var e=n.data("input");T.onChangeDateTime.call(n,j.currentTime,e),delete T.value,e.trigger("change")}}).on("generate.xdsoft",function(){T.onGenerate&&T.onGenerate.call&&T.onGenerate.call(n,j.currentTime,n.data("input")),q&&(n.trigger("afterOpen.xdsoft"),q=!1)}).on("click.xdsoft",function(e){e.stopPropagation()});var R=0;t.mousewheel&&t.mousewheel(function(e,r,i,s){if(!T.scrollInput)return!0;if(!T.datepicker&&T.timepicker)return R=M.find(".xdsoft_current").length?M.find(".xdsoft_current").eq(0).index():0,R+r>=0&&R+r<M.children().length&&(R+=r),M.children().eq(R).length&&M.children().eq(R).trigger("mousedown"),!1;if(T.datepicker&&!T.timepicker)return C.trigger(e,[r,i,s]),t.val&&t.val(j.str()),n.trigger("changedatetime.xdsoft"),!1});var U=function(){var t=n.data("input").offset(),r=t.top+n.data("input")[0].offsetHeight-1,i=t.left,s="absolute";T.fixed?(r-=e(window).scrollTop(),i-=e(window).scrollLeft(),s="fixed"):(r+n[0].offsetHeight>e(window).height()+e(window).scrollTop()&&(r=t.top-n[0].offsetHeight+1),r<0&&(r=0),i+n[0].offsetWidth>e(window).width()&&(i=t.left-n[0].offsetWidth+n.data("input")[0].offsetWidth)),n.css({left:i,top:r,position:s})};n.on("open.xdsoft",function(){var t=!0;T.onShow&&T.onShow.call&&(t=T.onShow.call(n,j.currentTime,n.data("input"))),t!==!1&&(n.show(),U(),e(window).off("resize.xdsoft",U).on("resize.xdsoft",U),T.closeOnWithoutClick&&e([document.body,window]).on("mousedown.xdsoft",function r(){n.trigger("close.xdsoft"),e([document.body,window]).off("mousedown.xdsoft",r)}))}).on("close.xdsoft",function(e){var t=!0;T.onClose&&T.onClose.call&&(t=T.onClose.call(n,j.currentTime,n.data("input"))),t!==!1&&!T.opened&&!T.inline&&n.hide(),e.stopPropagation()}).data("input",t);var z=0,W=0;n.data("xdsoft_datetime",j),n.setOptions(T),j.setCurrentTime(X()),t.data("xdsoft_datetimepicker",n).on("open.xdsoft focusin.xdsoft mousedown.xdsoft",function(e){if(t.is(":disabled")||t.is(":hidden")||!t.is(":visible")||t.data("xdsoft_datetimepicker").is(":visible")&&T.closeOnInputClick)return;clearTimeout(z),z=setTimeout(function(){if(t.is(":disabled")||t.is(":hidden")||!t.is(":visible"))return;q=!0,j.setCurrentTime(X()),n.trigger("open.xdsoft")},100)}).on("keydown.xdsoft",function(t){var r=this.value,i=t.which;switch(!0){case!!~[f].indexOf(i):var s=e("input:visible,textarea:visible");return n.trigger("close.xdsoft"),s.eq(s.index(this)+1).focus(),!1;case!!~[m].indexOf(i):return n.trigger("close.xdsoft"),!0}})},L=function(t){var n=t.data("xdsoft_datetimepicker");n&&(n.data("xdsoft_datetime",null),n.remove(),t.data("xdsoft_datetimepicker",null).off("open.xdsoft focusin.xdsoft focusout.xdsoft mousedown.xdsoft blur.xdsoft keydown.xdsoft"),e(window).off("resize.xdsoft"),e([window,document.body]).off("mousedown.xdsoft"),t.unmousewheel&&t.unmousewheel())};return e(document).off("keydown.xdsoftctrl keyup.xdsoftctrl").on("keydown.xdsoftctrl",function(e){e.keyCode==u&&(x=!0)}).on("keyup.xdsoftctrl",function(e){e.keyCode==u&&(x=!1)}),this.each(function(){var t;if(t=e(this).data("xdsoft_datetimepicker")){if(e.type(n)==="string")switch(n){case"show":e(this).select().focus(),t.trigger("open.xdsoft");break;case"hide":t.trigger("close.xdsoft");break;case"destroy":L(e(this));break;case"reset":this.value=this.defaultValue,(!this.value||!t.data("xdsoft_datetime").isValidDate(Date.parseDate(this.value,T.format)))&&t.data("changed",!1),t.data("xdsoft_datetime").setCurrentTime(this.value)}else t.setOptions(n);return 0}e.type(n)!=="string"&&(!T.lazyInit||T.open||T.inline?k(e(this)):C(e(this)))})},e.fn.datetimepicker.defaults=t})(jQuery)}),Date.parseFunctions={count:0},Date.parseRegexes=[],Date.formatFunctions={count:0},Date.prototype.dateFormat=function(e){if(e=="unixtime")return parseInt(this.getTime()/1e3);Date.formatFunctions[e]==null&&Date.createNewFormat(e);var t=Date.formatFunctions[e];return this[t]()},Date.createNewFormat=function(format){var funcName="format"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;var code="Date.prototype."+funcName+" = function() {return ",special=!1,ch="";for(var i=0;i<format.length;++i)ch=format.charAt(i),!special&&ch=="\\"?special=!0:special?(special=!1,code+="'"+String.escape(ch)+"' + "):code+=Date.getFormatCode(ch);eval(code.substring(0,code.length-3)+";}")},Date.getFormatCode=function(e){switch(e){case"d":return"String.leftPad(this.getDate(), 2, '0') + ";case"D":return"Date.dayNames[this.getDay()].substring(0, 3) + ";case"j":return"this.getDate() + ";case"l":return"Date.dayNames[this.getDay()] + ";case"S":return"this.getSuffix() + ";case"w":return"this.getDay() + ";case"z":return"this.getDayOfYear() + ";case"W":return"this.getWeekOfYear() + ";case"F":return"Date.monthNames[this.getMonth()] + ";case"m":return"String.leftPad(this.getMonth() + 1, 2, '0') + ";case"M":return"Date.monthNames[this.getMonth()].substring(0, 3) + ";case"n":return"(this.getMonth() + 1) + ";case"t":return"this.getDaysInMonth() + ";case"L":return"(this.isLeapYear() ? 1 : 0) + ";case"Y":return"this.getFullYear() + ";case"y":return"('' + this.getFullYear()).substring(2, 4) + ";case"a":return"(this.getHours() < 12 ? 'am' : 'pm') + ";case"A":return"(this.getHours() < 12 ? 'AM' : 'PM') + ";case"g":return"((this.getHours() %12) ? this.getHours() % 12 : 12) + ";case"G":return"this.getHours() + ";case"h":return"String.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";case"H":return"String.leftPad(this.getHours(), 2, '0') + ";case"i":return"String.leftPad(this.getMinutes(), 2, '0') + ";case"s":return"String.leftPad(this.getSeconds(), 2, '0') + ";case"O":return"this.getGMTOffset() + ";case"T":return"this.getTimezone() + ";case"Z":return"(this.getTimezoneOffset() * -60) + ";default:return"'"+String.escape(e)+"' + "}},Date.parseDate=function(e,t){if(t=="unixtime")return new Date(isNaN(parseInt(e))?0:parseInt(e)*1e3);Date.parseFunctions[t]==null&&Date.createParser(t);var n=Date.parseFunctions[t];return Date[n](e)},Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++,regexNum=Date.parseRegexes.length,currentGroup=1;Date.parseFunctions[format]=funcName;var code="Date."+funcName+" = function(input) {\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1, z = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {",regex="",special=!1,ch="";for(var i=0;i<format.length;++i)ch=format.charAt(i),!special&&ch=="\\"?special=!0:special?(special=!1,regex+=String.escape(ch)):(obj=Date.formatCodeToRegex(ch,currentGroup),currentGroup+=obj.g,regex+=obj.s,obj.g&&obj.c&&(code+=obj.c));code+="if (y > 0 && z > 0){\nvar doyDate = new Date(y,0);\ndoyDate.setDate(z);\nm = doyDate.getMonth();\nd = doyDate.getDate();\n}",code+="if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}",Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$"),eval(code)},Date.formatCodeToRegex=function(e,t){switch(e){case"D":return{g:0,c:null,s:"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};case"j":case"d":return{g:1,c:"d = parseInt(results["+t+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"\\d"};case"z":return{g:1,c:"z = parseInt(results["+t+"], 10);\n",s:"(\\d{1,3})"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+t+"].substring(0, 3)], 10);\n",s:"("+Date.monthNames.join("|")+")"};case"M":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+t+"]], 10);\n",s:"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"};case"n":case"m":return{g:1,c:"m = parseInt(results["+t+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"\\d{1,2}"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"Y":return{g:1,c:"y = parseInt(results["+t+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+t+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};case"a":return{g:1,c:"if (results["+t+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+t+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":case"h":case"H":return{g:1,c:"h = parseInt(results["+t+"], 10);\n",s:"(\\d{1,2})"};case"i":return{g:1,c:"i = parseInt(results["+t+"], 10);\n",s:"(\\d{2})"};case"s":return{g:1,c:"s = parseInt(results["+t+"], 10);\n",s:"(\\d{2})"};case"O":return{g:0,c:null,s:"[+-]\\d{4}"};case"T":return{g:0,c:null,s:"[A-Z]{3}"};case"Z":return{g:0,c:null,s:"[+-]\\d{1,5}"};default:return{g:0,c:null,s:String.escape(e)}}},Date.prototype.getTimezone=function(){return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},Date.prototype.getGMTOffset=function(){return(this.getTimezoneOffset()>0?"-":"+")+String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset())/60),2,"0")+String.leftPad(Math.abs(this.getTimezoneOffset())%60,2,"0")},Date.prototype.getDayOfYear=function(){var e=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var t=0;t<this.getMonth();++t)e+=Date.daysInMonth[t];return e+this.getDate()},Date.prototype.getWeekOfYear=function(){var e=this.getDayOfYear()+(4-this.getDay()),t=new Date(this.getFullYear(),0,1),n=7-t.getDay()+4;return String.leftPad(Math.ceil((e-n)/7)+1,2,"0")},Date.prototype.isLeapYear=function(){var e=this.getFullYear();return(e&3)==0&&(e%100||e%400==0&&e)},Date.prototype.getFirstDayOfMonth=function(){var e=(this.getDay()-(this.getDate()-1))%7;return e<0?e+7:e},Date.prototype.getLastDayOfMonth=function(){var e=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return e<0?e+7:e},Date.prototype.getDaysInMonth=function(){return Date.daysInMonth[1]=this.isLeapYear()?29:28,Date.daysInMonth[this.getMonth()]},Date.prototype.getSuffix=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},String.escape=function(e){return e.replace(/('|\\)/g,"\\$1")},String.leftPad=function(e,t,n){var r=new String(e);n==null&&(n=" ");while(r.length<t)r=n+r;return r},Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31],Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Date.y2kYear=50,Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},Date.patterns={ISO8601LongPattern:"Y-m-d H:i:s",ISO8601ShortPattern:"Y-m-d",ShortDatePattern:"n/j/Y",LongDatePattern:"l, F d, Y",FullDateTimePattern:"l, F d, Y g:i:s A",MonthDayPattern:"F d",ShortTimePattern:"g:i A",LongTimePattern:"g:i:s A",SortableDateTimePattern:"Y-m-d\\TH:i:s",UniversalSortableDateTimePattern:"Y-m-d H:i:sO",YearMonthPattern:"F, Y"},define("UI.modalplus",["backbone","i18n!/nls/lang.js"],function(e,t){var n,r,i;return i=[],r={title:"",mode:"normal",template:"",width:520,maxHeight:null,delay:300,compact:!1,disableClose:!1,disableFooter:!1,disableDrag:!1,hideClose:!1,hasScroll:!1,hasHeader:!0,hasFooter:!0,cancel:{text:"",hide:!1},confirm:{text:"",color:"blue",disabled:!1,hide:!1},onClose:null,onConfirm:null,onShow:null},n=e.View.extend({events:{"click .modal-confirm":"confirm","click .btn.modal-close":"cancel","click i.modal-close":"close"},constructor:function(e){var n,i,s;$(":focus").blur(),this.nextOptions=[],this.nextCloses=[],typeof e.cancel=="string"&&(e.cancel={text:e.cancel}),typeof e.confirm=="string"&&(e.confirm={text:e.confirm}),e.mode==="fullscreen"&&(e.disableClose=!0,e.disableFooter=!0),e.hasFooter=!e.disableFooter;if((s=e.mode)==="fullscreen"||s==="panel")e.disableDrag=!0;return this.wrap=$("#modal-wrap"),this.wrap.size()===0&&(this.wrap=$("<div id='modal-wrap'></div>").appendTo($("body"))),this.option=$.extend(!0,{},r,e),(n=this.option.cancel).text||(n.text=t.IDE.POP_LBL_CANCEL),(i=this.option.confirm).text||(i.text=t.IDE.LBL_SUBMIT),this.render()},render:function(){var e,t;return e=this,typeof this.option.template=="object"&&(this.option.$template=this.option.template,this.option.template=""),this.tpl=$(MC.template.modalTemplate(this.option)),this.option.width&&this.tpl.find(".modal-wrapper-fix").css("width",this.option.width),this.tpl.find(".modal-body").html(this.option.$template),this.setElement(this.tpl),this.isReady=!1,i.length&&!i[i.length-1].isReady?(void 0,this.option.force&&i[i.length-1].nextOptions.push(this.option),this):(this.tpl.appendTo(this.wrap),this.resize(),i.push(this),i.length>1?(e.option.mode==="normal"&&(i[i.length-1].resize(1),i[i.length-1].animate("slideIn")),i[i.length-2].animate("fadeOut"),i[i.length-1].tpl.addClass("bounce")):(this.tpl.addClass("animate"),this.trigger("show",this),typeof (t=this.option).onShow=="function"&&t.onShow(this),_.defer(function(){return e.wrap.addClass("show"),e.tpl.addClass("bounce")}),_.delay(function(){return e.trigger("shown",this)},300)),_.delay(function(){return e.resize(),e.isReady=!0},300),_.delay(function(){return e.nextOptions.forEach(function(e){return new n(e)})},(this.option.delay||300)+10),this.bindEvent(),this)},close:function(e){var t,n,r,s;n=i[i.length-1];if(n!=null?n.pending:void 0)return n.nextCloses.push(this),!1;if(!e||typeof e!="number")typeof e=="function"&&(t=e),e=1;return this.isClosed?!1:(r=i[i.length-(1+e)],n.pending=!0,n.trigger("close",this),typeof (s=n.option).onClose=="function"&&s.onClose(this),i.length>1?(n.option.mode==="panel"?n.tpl.removeClass("bounce"):n.animate("slideOut"),r.animate("fadeIn")):(n.wrap.removeClass("show"),n.tpl.removeClass("bounce")),_.delay(function(){var r;return n.tpl.remove(),n.trigger("closed",this),n.pending=!1,n.isClosed=!0,i.length>1?i.length=i.length-e:(n.wrap.remove(),i=[]),(r=i[i.length-1])!=null&&r.resize(),typeof t=="function"?t():void 0},n.option.delay||300),_.delay(function(){return n.nextCloses.forEach(function(e){return e.close()})},(n.option.delay||300)+10),this)},confirm:function(e){var t;return $(e.currentTarget).is(":disabled")?!1:(this.trigger("confirm",this),typeof (t=this.option).onConfirm=="function"&&t.onConfirm(),this)},cancel:function(){var e;return this.trigger("cancel",this),this.close(),typeof (e=this.option).onCancel=="function"&&e.onCancel(this),this},bindEvent:function(){var e,t,n,r,s,o;o=this,n=!1,_.each(i,function(e){e.option.disableClose&&(n=!0)}),n||(this.wrap.off("click"),this.wrap.on("click",function(e){var t;if(e.target===e.currentTarget)return t=i[i.length-1],t.pending?!1:o.close()})),$(window).resize(function(){if(!o.isClosed)return o===i[i.length-1]?o.resize():o.resize(-1)}),$(document).keyup(function(e){if(e.which===27&&!o.option.disableClose)return e.preventDefault(),o.close()}),s=i[i.length-1];if(this.option.disableDrag)return!1;if(s)return e=0,t=0,r=!1,s.find(".modal-header h3").mousedown(function(n){var i;r=!0,n.which?n.which===3&&(r=!1):n.button&&n.button===2&&(r=!1),r&&(i=s.tpl.offset(),e=i.left-n.clientX,t=i.top-n.clientY)}),$(document).mousemove(function(n){var i,o,u;if(r){s.tpl.css({left:n.clientX+e,top:n.clientY+t});if(window.getSelection)return typeof (i=window.getSelection()).empty=="function"&&i.empty(),typeof (o=window.getSelection()).removeAllRanges=="function"&&o.removeAllRanges(),(u=document.selection)!=null?typeof u.empty=="function"?u.empty():void 0:void 0}}),$(document).mouseup(function(n){var i,o,u,a;r&&(i=n.clientX+e,a=n.clientY+t,o=$(window).height()-s.tpl.height(),u=$(window).width()-s.tpl.width(),a<0&&(a=0),i<0&&(i=0),a>o&&(a=o),i>u&&(i=u),s.tpl.animate({top:a,left:i},100)),r=!1,e=t=0})},resize:function(e){var t,n,r,i,s,o,u;return r=this,e||this.tpl.show(),this.option.mode==="panel"&&!e?(this.trigger("resize",this),!1):this.option.mode==="fullscreen"&&!e?(this.tpl.removeAttr("style"),!1):(u=$(window).width(),o=$(window).height(),s=this.tpl.width(),t=this.tpl.height(),i=(o-t)*.4,n=(u-s)/2,e&&this.tpl.removeClass("animate"),i<0&&(i=10),e===1&&(n=u+n),e===-1&&(n=-u+n),r.tpl.css({top:i,left:n}),e&&r.tpl.hide(),this.trigger("resize",{top:i,left:n}),this)},isOpen:function(){return!this.isClosed},next:function(e){var t;return t=new n(e),this.trigger("next",t),t,this},toggleConfirm:function(e){return this.tpl.find(".modal-confirm").attr("disabled",!!e),this},toggleFooter:function(e){return this.tpl.find(".modal-footer").toggle(!!e),this},setContent:function(e){var t;return this.option.maxHeight||this.option.hasScroll?t=".scroll-content":t=".modal-body",this.tpl.find(t).html(e),this.resize(),this},compact:function(){return this.tpl.find(".modal-body").css({padding:0}),this},setWidth:function(e){var t;return t=this.tpl.find(".modal-body"),t.parent().css({width:e}),this.resize(),this},animate:function(e){var t,n,r,i,s;this.tpl.show(),i=this;if(this.option.mode==="fullscreen"&&e==="slideIn")return!1;if(this.option.mode==="panel")return!1;if(this.isMoving)return void 0,!1;s=$(window).width(),r=this.tpl.offset(),n=r.left+s,t=300;if(e==="fadeOut"||e==="fadeIn")t=100,n=+r.left+s;if(e==="fadeOut"||e==="slideIn")n=+r.left-s;return i.isMoving=!0,this.tpl.animate({left:n},t,function(){return i.isMoving=!1,!1}),this},find:function(e){return this.tpl.find(e)},$:function(e){return this.tpl.find(e)},setTitle:function(e){return this.tpl.find(".modal-header h3").text(e),this},abnormal:function(){var e;return(e=this.option.mode)==="panel"||e==="fullscreen"},loading:function(e){if(!e)return this._title=this.find(".modal-header h3").text(),this.setTitle(t.PROP.LBL_LOADING),this._content=this.find(".modal-body").children(),this.setContent(MC.template.loadingSpinner()),this.toggleFooter(!1);if(!this._title)throw new Error("The modal was not in loading state.");return this.setTitle(this._title),this.setContent(this._content),this.toggleFooter(!0)}}),n}),define("UI.nanoscroller",["jquery"],function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;T={paneClass:"nano-pane",paneClassY:"pane-y",paneClassX:"pane-x",sliderClass:"nano-slider",sliderClassY:"slider-y",sliderClassX:"slider-x",contentClass:"nano-content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null},w="scrollbar",b="scroll",l="mousedown",c="mousemove",p="mousewheel",h="mouseup",g="resize",o="drag",S="up",v="panedown",f="left",m="paneright",i="DOMMouseScroll",s="down",y="right",x="wheel",u="keydown",a="keyup",E="touchmove",t=window.navigator.appName==="Microsoft Internet Explorer"&&/msie 7./i.test(window.navigator.appVersion)&&window.ActiveXObject,r=null,n=null,N=function(){var e,t,n,r;return e=document.createElement("div"),t=e.style,t.position="absolute",t.width="100px",t.height="100px",t.overflow=b,t.top="-9999px",document.body.appendChild(e),r=e.offsetWidth-e.clientWidth,n=e.offsetHeight-e.clientHeight,document.body.removeChild(e),[r,n]},d=function(){function u(t,i){var s;this.el=t,this.options=i;if(!r||!n)s=N(),r=s[0],n=s[1];this.$el=e(this.el),this.doc=e(document),this.win=e(window),this.$content=this.$el.children("."+i.contentClass),this.$content.attr("tabindex",0),this.content=this.$content[0],this.options.iOSNativeScrolling&&this.el.style.WebkitOverflowScrolling!=null?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return u.prototype.preventVerticalScrolling=function(e,t){if(!this.isActiveY)return;if(e.type===i)(t===s&&e.originalEvent.detail>0||t===S&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===p){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(t===s&&e.originalEvent.wheelDelta<0||t===S&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},u.prototype.preventHorizontalScrolling=function(e,t){if(!this.isActiveX)return;if(e.type===i)(t===y&&e.originalEvent.detail>0||t===f&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===p){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(t===y&&e.originalEvent.wheelDelta<0||t===f&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},u.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActiveX=!0,this.isActiveY=!0},u.prototype.updateVerticalScrollValues=function(){var e;e=this.content;if(!e)return;this.maxScrollTop=e.scrollHeight-e.clientHeight,this.contentScrollTop=e.scrollTop,this.iOSNativeScrolling||(this.maxSliderTop=this.yPaneHeight-this.ySliderHeight,this.ySliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},u.prototype.updateHorizontalScrollValues=function(){var e;e=this.content;if(!e)return;this.maxScrollLeft=e.scrollWidth-e.clientWidth,this.contentScrollLeft=e.scrollLeft,this.iOSNativeScrolling||(this.maxSliderLeft=this.xPaneWidth-this.xSliderWidth,this.xSliderLeft=this.contentScrollLeft*this.maxSliderLeft/this.maxScrollLeft)},u.prototype.createEvents=function(){this.yEvents={down:function(e){return function(t){return e.isYBeingDragged=!0,e.offsetY=t.pageY-e.ySlider.offset().top,e.yPane.addClass("active"),e.doc.bind(c,e.yEvents[o]).bind(h,e.yEvents[S]),!1}}(this),drag:function(e){return function(t){return e.ySliderY=t.pageY-e.$el.offset().top-e.offsetY,e.scrollY(),e.updateVerticalScrollValues(),e.contentScrollTop>=e.maxScrollTop?e.$el.trigger("scrollend"):e.contentScrollTop===0&&e.$el.trigger("scrolltop"),!1}}(this),up:function(e){return function(t){return e.isYBeingDragged=!1,e.yPane.removeClass("active"),e.doc.unbind(c,e.yEvents[o]).unbind(h,e.yEvents[S]),!1}}(this),resize:function(e){return function(t){e.reset()}}(this),panedown:function(e){return function(t){return e.ySliderY=(t.offsetY||t.originalEvent.layerY)-e.ySliderHeight*.5,e.scrollY(),e.yEvents.down(t),!1}}(this),scroll:function(e){return function(t){if(e.isYBeingDragged)return;e.updateVerticalScrollValues(),e.iOSNativeScrolling||(e.ySliderY=e.ySliderTop,e.ySlider.css({top:e.ySliderTop}));if(t==null)return;e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventVerticalScrolling(t,s),e.$el.trigger("scrollend")):e.contentScrollTop===0&&(e.options.preventPageScrolling&&e.preventVerticalScrolling(t,S),e.$el.trigger("scrolltop"))}}(this),wheel:function(e){return function(t){if(t==null)return;return e.ySliderY+=-t.wheelDeltaY||-t.delta,e.scrollY(),!1}}(this)},this.xEvents={down:function(e){return function(t){return e.isXBeingDragged=!0,e.offsetX=t.pageX-e.xSlider.offset().left,e.xPane.addClass("active"),e.doc.bind(c,e.xEvents[o]).bind(h,e.xEvents[S]),!1}}(this),drag:function(e){return function(t){return e.xSliderX=t.pageX-e.$el.offset().left-e.offsetX,e.scrollX(),e.updateHorizontalScrollValues(),e.contentScrollLeft>=e.maxScrollLeft?e.$el.trigger("scrollend"):e.contentScrollLeft===0&&e.$el.trigger("scrollleft"),!1}}(this),up:function(e){return function(t){return e.isXBeingDragged=!1,e.xPane.removeClass("active"),e.doc.unbind(c,e.xEvents[o]).unbind(h,e.xEvents[S]),!1}}(this),resize:function(e){return function(t){e.reset()}}(this),panedown:function(e){return function(t){return e.xSliderX=(t.offsetX||t.originalEvent.layerX)-e.xSliderWidth*.5,e.scrollX(),e.xEvents.down(t),!1}}(this),scroll:function(e){return function(t){if(e.isXBeingDragged)return;e.updateHorizontalScrollValues(),e.iOSNativeScrolling||(e.xSliderX=e.xSliderLeft,e.xSlider.css({left:e.xSliderLeft}));if(t==null)return;e.contentScrollLeft>=e.maxScrollLeft?(e.options.preventPageScrolling&&e.preventHorizontalScrolling(t,y),e.$el.trigger("scrollend")):e.contentScrollLeft===0&&(e.options.preventPageScrolling&&e.preventHorizontalScrolling(t,f),e.$el.trigger("scrollleft"))}}(this),wheel:function(e){return function(t){if(t==null)return;return e.xSliderX+=-t.wheelDeltaX||-t.delta,e.scrollX(),!1}}(this)}},u.prototype.addEvents=function(){var e,t;this.removeEvents(),t=this.yEvents,e=this.xEvents,this.options.disableResize||this.win.bind(g,t[g]).bind(g,e[g]),this.iOSNativeScrolling||(this.ySlider.bind(l,t[s]),this.xSlider.bind(l,e[s]),this.yPane.bind(l,t[v]).bind(""+p+" "+i,t[x]),this.xPane.bind(l,e[v]).bind(""+p+" "+i,e[x])),this.$content.bind(""+b+" "+p+" "+i+" "+E,t[b]).bind(""+b+" "+p+" "+i+" "+E,e[b])},u.prototype.removeEvents=function(){var e,t;t=this.yEvents,e=this.xEvents,this.win.unbind(g,t[g]).unbind(g,e[g]),this.iOSNativeScrolling||(this.ySlider.unbind(),this.xSlider.unbind(),this.yPane.unbind(),this.xPane.unbind()),this.$content.unbind(""+b+" "+p+" "+i+" "+E,t[b]).unbind(""+b+" "+p+" "+i+" "+E,e[b])},u.prototype.generate=function(){var e,t,i,s,o,u,a,f,l,c;return s=this.options,o=s.paneClass,a=s.paneClassY,u=s.paneClassX,f=s.sliderClass,c=s.sliderClassY,l=s.sliderClassX,e=s.contentClass,!this.$el.find(""+a).length&&!this.$el.find(""+c).length&&this.$el.append('<div class="'+o+" "+a+'"><div class="'+f+" "+c+'" /></div>'),!this.$el.find(""+u).length&&!this.$el.find(""+l).length&&this.$el.append('<div class="'+o+" "+u+'"><div class="'+f+" "+l+'" /></div>'),this.yPane=this.$el.children("."+a),this.xPane=this.$el.children("."+u),this.ySlider=this.yPane.find("."+c),this.xSlider=this.xPane.find("."+l),r&&(i=this.$el.css("direction")==="rtl"?{left:-r}:{right:-r},this.$el.addClass("has-scrollbar"),this.$content.css(i)),n&&(t={bottom:-n},this.$el.addClass("has-scrollbar"),this.$content.css(t)),this},u.prototype.restore=function(){this.stopped=!1,this.yPane.show(),this.xPane.show(),this.addEvents()},u.prototype.reset=function(){var e,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;if(!this.content)return;if(this.iOSNativeScrolling){this.contentHeight=this.content.scrollHeight,this.contentWidth=this.content.scrollWidth;return}return this.$el.removeClass("has-scrollbar-x"),this.$el.removeClass("has-scrollbar-y"),!this.$el.find("."+this.options.paneClassY).length&&!this.$el.find("."+this.options.paneClassX).length&&this.generate().stop(),this.stopped&&this.restore(),e=this.content,s=e.style,u=s.overflowY,o=s.overflowX,t&&this.$content.css({height:this.$content.height(),width:this.$content.height()}),i=e.scrollHeight+r,a=e.scrollWidth+n,e.scrollWidth>this.xPane.outerWidth(!0)&&this.$el.addClass("has-scrollbar-x"),e.scrollHeight>this.yPane.outerHeight(!0)&&this.$el.addClass("has-scrollbar-y"),l=this.yPane.outerHeight(),v=parseInt(this.yPane.css("top"),10),f=parseInt(this.yPane.css("bottom"),10),h=l+v+f,m=this.xPane.outerWidth(),c=parseInt(this.xPane.css("left"),10),d=parseInt(this.xPane.css("right"),10),p=m+c+d,g=Math.round(h/i*h),g<this.options.sliderMinHeight?g=this.options.sliderMinHeight:this.options.sliderMaxHeight!=null&&g>this.options.sliderMaxHeight&&(g=this.options.sliderMaxHeight),u===b&&s.overflowX!==b&&(g+=r),y=Math.round(p/a*p),y<this.options.sliderMinWidth?y=this.options.sliderMinWidth:this.options.sliderMaxWidth!=null&&y>this.options.sliderMaxWidth&&(y=this.options.sliderMaxWidth),o===b&&s.overflowY!==b&&(y+=n),this.maxSliderTop=h-g,this.maxSliderLeft=p-y,this.contentHeight=i,this.contentWidth=a,this.yPaneHeight=l,this.xPaneWidth=m,this.yPaneOuterHeight=h,this.xPaneOuterWidth=p,this.ySliderHeight=g,this.xSliderWidth=y,this.ySlider.height(g),this.xSlider.width(y),this.yEvents.scroll(),this.xEvents.scroll(),this.yPane.show(),this.isActiveY=!0,e.scrollHeight===e.clientHeight||this.yPane.outerHeight(!0)>=e.scrollHeight&&u!==b?(this.yPane.hide(),this.$el.removeClass("has-scrollbar-y"),this.isActiveY=!1):this.el.clientHeight===e.scrollHeight&&u===b?this.ySlider.hide():this.ySlider.show(),this.xPane.show(),this.isActiveX=!0,e.scrollWidth===e.clientWidth||this.xPane.outerWidth(!0)>=e.scrollWidth&&o!==b?(this.xPane.hide(),this.$el.removeClass("has-scrollbar-x"),this.isActiveX=!1):this.el.clientWidth===e.scrollWidth&&o===b?this.xSlider.hide():this.xSlider.show(),this.yPane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),this.xPane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),this},u.prototype.scroll=function(){return this.scrollY()},u.prototype.scrollY=function(){if(!this.isActiveY)return;return this.ySliderY=Math.max(0,this.ySliderY),this.ySliderY=Math.min(this.maxSliderTop,this.ySliderY),this.$content.scrollTop((this.yPaneHeight-this.contentHeight+r)*this.ySliderY/this.maxSliderTop*-1),this.iOSNativeScrolling||this.ySlider.css({top:this.ySliderY}),this},u.prototype.scrollX=function(){if(!this.isActiveX)return;return this.xSliderX=Math.max(0,this.xSliderX),this.xSliderX=Math.min(this.maxSliderLeft,this.xSliderX),this.$content.scrollLeft((this.xPaneWidth-this.contentWidth+n)*this.xSliderX/this.maxSliderLeft*-1),this.iOSNativeScrolling||this.xSlider.css({left:this.xSliderX}),this},u.prototype.scrollBottom=function(e){if(!this.isActiveY)return;return this.reset(),this.$content.scrollTop(this.contentHeight-this.$content.height()-e).trigger(p),this},u.prototype.scrollRight=function(e){if(!this.isActiveX)return;return this.reset(),this.$content.scrollLeft(this.contentWidth-this.$content.width()-e).trigger(p),this},u.prototype.scrollTop=function(e){if(!this.isActiveY)return;return this.reset(),this.$content.scrollTop(+e).trigger(p),this},u.prototype.scrollLeft=function(e){if(!this.isActiveX)return;return this.reset(),this.$content.scrollLeft(+e).trigger(p),this},u.prototype.scrollTo=function(t){var n;if(!this.isActiveY&&!this.isActiveX)return;return this.reset(),n=e(t).get(0),this.isActiveY&&this.scrollTop(n.offsetTop),this.isActiveX&&this.scrollLeft(n.offsetLeft),this},u.prototype.stop=function(){return this.stopped=!0,this.removeEvents(),this.yPane.hide(),this.xPane.hide(),this},u.prototype.flash=function(){if(!this.isActiveY&&!this.isActiveX)return;return this.reset(),this.isActiveY&&this.yPane.addClass("flashed"),this.isActiveX&&this.xPane.addClass("flashed"),setTimeout(function(e){return function(){e.isActiveY&&e.yPane.removeClass("flashed"),e.isActiveX&&e.xPane.removeClass("flashed")}}(this),this.options.flashDelay),this},u}(),e.fn.nanoScroller=function(t){return this.each(function(){var n,r;(r=this.nanoscroller)||(n=e.extend({},T,t),this.nanoscroller=r=new d(this,n));if(t&&typeof t=="object"){e.extend(r.options,t);if(t.scrollBottom)return r.scrollBottom(t.scrollBottom);if(t.scrollTop)return r.scrollTop(t.scrollTop);if(t.scrollRight)return r.scrollRight(t.scrollRight);if(t.scrollLeft)return r.scrollLeft(t.scrollLeft);if(t.scrollTo)return r.scrollTo(t.scrollTo);if(t.scroll==="bottom")return r.scrollBottom(0);if(t.scroll==="top")return r.scrollTop(0);if(t.scroll==="right")return r.scrollRight(0);if(t.scroll==="left")return r.scrollLeft(0);if(t.scroll&&t.scroll instanceof e)return r.scrollTo(t.scroll);if(t.stop)return r.stop();if(t.flash)return r.flash()}return r.reset()})}}),define("UI.selectize",["jquery"],function(e){e(function(){e(document.body).on("focus blur","input.selection[data-tip]",function(t){var n=e(t.target),r=n.data("tip");if(t.type==="focusin"&&r){e("#selection-tip").length||e(document.body).append('<div id="selection-tip"><i class="icon-info"></i><span>'+r+"</span></div>");var i=n.outerWidth()+"px",s=n.offset().left+"px",o=n.outerHeight()+n.offset().top+"px";e("#selection-tip").css({width:i,left:s,top:o}).show()}else e("#selection-tip").hide()})});var t=!1,n=function(e){return"selection-tip-"+e},r=function(t){var r="#"+n(t);return e(r)},i=function(e,t){var n=e.outerWidth()+"px",r=e.offset().left+"px",i=e.outerHeight()+e.offset().top+"px";t.css({width:n,left:r,top:i}).slideDown(50)},s=function(s,o,f){var l=n(f),c=r(f);c.length||(c=e('<div class="selection-tip" id="'+l+'"><i class="icon-info"></i><span></span></div>'),e(document.body).append(c),s.on("mouseenter",function(){t=f,u(f)}).on("mouseleave",function(){t=!1,a(f)})),c.find("span").html(o),s.addClass("error"),i(s,c),setTimeout(function(){a(f)},2e3)},o=function(t){var r,i;t?(i="#"+n(t),$target=f(t),$target.off("mouseenter").off("mouseleave").removeClass("error")):i=".selection-tip",e(i).remove()},u=function(e){$tipDom=r(e),$target=f(e),i($target,$tipDom)},a=function(e){t!=e&&r(e).slideUp(50)},f=function(t){var n='[data-selection-id="'+t+'"]';return e(n).eq(0)},l=function(t){t.find(".selection.error").each(function(){var t=e(this).data("selectionId");o(t)})};(function(e){e.fn.selectionValid=function(t){var n=e(this),r=n.attr("data-target"),i;if(r){var u=t.limits;u&&(i=u[r])}i&&(n.attr("data-ignore-regexp",i),n.attr("data-ignore","true").attr("data-required","true"),n.parent().attr("data-bind","true")),n.on("focus",function(){e(this).data("selection-origin-value",e(this).val())}).on("change",function(){var n=e(this).val();if(t[r]){var i=t[r](n,e(this)),u=e(this).data("selection-origin-value"),a=e(this).data("selectionId");if(_.isString(i))return i!==""?s(e(this),i,a):e(this).val(u),!1;o(a)}})},e.fn.unbindSelection=function(){l(this)}})(jQuery);var c=function(){var t=function(e,t){this.items=e,this.settings=t||{diacritics:!0}};t.prototype.tokenize=function(e){e=i(String(e||"").toLowerCase());if(!e||!e.length)return[];var t,n,r,o,a=[],f=e.split(/ +/);for(t=0,n=f.length;t<n;t++){r=s(f[t]);if(this.settings.diacritics)for(o in u)u.hasOwnProperty(o)&&(r=r.replace(new RegExp(o,"g"),u[o]));a.push({string:f[t],regex:new RegExp(r,"i")})}return a},t.prototype.iterator=function(e,t){var n;o(e)?n=Array.prototype.forEach||function(e){for(var t=0,n=this.length;t<n;t++)e(this[t],t,this)}:n=function(e){for(var t in this)this.hasOwnProperty(t)&&e(this[t],t,this)},n.apply(e,[t])},t.prototype.getScoreFunction=function(e,t){var n,r,i,s;n=this,e=n.prepareSearch(e,t),i=e.tokens,r=e.options.fields,s=i.length;var o=function(e,t){var n,r;return e?(e=String(e||""),r=e.search(t.regex),r===-1?0:(n=t.string.length/e.length,r===0&&(n+=.5),n)):0},u=function(){var e=r.length;return e?e===1?function(e,t){return o(t[r[0]],e)}:function(t,n){for(var i=0,s=0;i<e;i++)s+=o(n[r[i]],t);return s/e}:function(){return 0}}();return s?s===1?function(e){return u(i[0],e)}:e.options.conjunction==="and"?function(e){var t;for(var n=0,r=0;n<s;n++){t=u(i[n],e);if(t<=0)return 0;r+=t}return r/s}:function(e){for(var t=0,n=0;t<s;t++)n+=u(i[t],e);return n/s}:function(){return 0}},t.prototype.getSortFunction=function(e,t){var r,i,s,o,u,a,f,l,c,h,p;s=this,e=s.prepareSearch(e,t),p=!e.query&&t.sort_empty||t.sort,c=function(e,t){return e==="$score"?t.score:s.items[t.id][e]},u=[];if(p)for(r=0,i=p.length;r<i;r++)(e.query||p[r].field!=="$score")&&u.push(p[r]);if(e.query){h=!0;for(r=0,i=u.length;r<i;r++)if(u[r].field==="$score"){h=!1;break}h&&u.unshift({field:"$score",direction:"desc"})}else for(r=0,i=u.length;r<i;r++)if(u[r].field==="$score"){u.splice(r,1);break}l=[];for(r=0,i=u.length;r<i;r++)l.push(u[r].direction==="desc"?-1:1);return a=u.length,a?a===1?(o=u[0].field,f=l[0],function(e,t){return f*n(c(o,e),c(o,t))}):function(e,t){var r,i,s,o,f;for(r=0;r<a;r++){f=u[r].field,i=l[r]*n(c(f,e),c(f,t));if(i)return i}return 0}:null},t.prototype.prepareSearch=function(e,t){if(typeof e=="object")return e;t=r({},t);var n=t.fields,i=t.sort,s=t.sort_empty;return n&&!o(n)&&(t.fields=[n]),i&&!o(i)&&(t.sort=[i]),s&&!o(s)&&(t.sort_empty=[s]),{options:t,query:String(e||"").toLowerCase(),tokens:this.tokenize(e),total:0,items:[]}},t.prototype.search=function(e,t){var n=this,r,i,s,o,u,a;return s=this.prepareSearch(e,t),t=s.options,e=s.query,a=t.score||n.getScoreFunction(s),e.length?n.iterator(n.items,function(e,n){i=a(e),(t.filter===!1||i>0)&&s.items.push({score:i,id:n})}):n.iterator(n.items,function(e,t){s.items.push({score:1,id:t})}),u=n.getSortFunction(s,t),u&&s.items.sort(u),s.total=s.items.length,typeof t.limit=="number"&&(s.items=s.items.slice(0,t.limit)),s};var n=function(e,t){return typeof e=="number"&&typeof t=="number"?e>t?1:e<t?-1:0:(e=String(e||"").toLowerCase(),t=String(t||"").toLowerCase(),e>t?1:t>e?-1:0)},r=function(e,t){var n,r,i,s;for(n=1,r=arguments.length;n<r;n++){s=arguments[n];if(!s)continue;for(i in s)s.hasOwnProperty(i)&&(e[i]=s[i])}return e},i=function(e){return(e+"").replace(/^\s+|\s+$|/g,"")},s=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},o=Array.isArray||e&&e.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},u={a:"[aÀÁÂÃÄÅàáâãäåĀā]",c:"[cÇçćĆčČ]",d:"[dđĐďĎ]",e:"[eÈÉÊËèéêëěĚĒē]",i:"[iÌÍÎÏìíîïĪī]",n:"[nÑñňŇ]",o:"[oÒÓÔÕÕÖØòóôõöøŌō]",r:"[rřŘ]",s:"[sŠš]",t:"[tťŤ]",u:"[uÙÚÛÜùúûüůŮŪū]",y:"[yŸÿýÝ]",z:"[zŽž]"};return t}(),h=function(){var e={};e.mixin=function(e){e.plugins={},e.prototype.initializePlugins=function(e){var n,r,i,s=this,o=[];s.plugins={names:[],settings:{},requested:{},loaded:{}};if(t.isArray(e))for(n=0,r=e.length;n<r;n++)typeof e[n]=="string"?o.push(e[n]):(s.plugins.settings[e[n].name]=e[n].options,o.push(e[n].name));else if(e)for(i in e)e.hasOwnProperty(i)&&(s.plugins.settings[i]=e[i],o.push(i));while(o.length)s.require(o.shift())},e.prototype.loadPlugin=function(t){var n=this,r=n.plugins,i=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');r.requested[t]=!0,r.loaded[t]=i.fn.apply(n,[n.plugins.settings[t]||{}]),r.names.push(t)},e.prototype.require=function(e){var t=this,n=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(n.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return n.loaded[e]},e.define=function(t,n){e.plugins[t]={name:t,fn:n}}};var t={isArray:Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}};return e}();(function(){var t=function(e,t){if(typeof t=="string"&&!t.length)return;var n=typeof t=="string"?new RegExp(t,"i"):t,r=function(e){var t=0;if(e.nodeType===3){var i=e.data.search(n);if(i>=0&&e.data.length>0){var s=e.data.match(n),o=document.createElement("span");o.className="highlight";var u=e.splitText(i),a=u.splitText(s[0].length),f=u.cloneNode(!0);o.appendChild(f),u.parentNode.replaceChild(o,u),t=1}}else if(e.nodeType===1&&e.childNodes&&!/(script|style)/i.test(e.tagName))for(var l=0;l<e.childNodes.length;++l)l+=r(e.childNodes[l]);return t};return e.each(function(){r(this)})},n=function(){};n.prototype={on:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},off:function(e,t){var n=arguments.length;if(n===0)return delete this._events;if(n===1)return delete this._events[e];this._events=this._events||{};if(e in this._events==0)return;this._events[e].splice(this._events[e].indexOf(t),1)},trigger:function(e){this._events=this._events||{};if(e in this._events==0)return;for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},n.mixin=function(e){var t=["on","off","trigger"];for(var r=0;r<t.length;r++)e.prototype[t[r]]=n.prototype[t[r]]};var r=/Mac/.test(navigator.userAgent),i=65,s=188,o=13,u=27,a=37,f=38,l=80,p=39,d=40,v=78,m=8,g=46,y=16,b=r?91:17,w=r?18:17,E=9,S=1,x=2,T=function(e){return typeof e!="undefined"},N=function(e){return typeof e=="object"?e:typeof e=="undefined"||e===null?null:typeof e=="boolean"?e?"true":"false":e+""},C=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},k=function(e){return(e+"").replace(/\$/g,"$$$$")},L={};L.before=function(e,t,n){var r=e[t];e[t]=function(){return n.apply(e,arguments),r.apply(e,arguments)}},L.after=function(e,t,n){var r=e[t];e[t]=function(){var t=r.apply(e,arguments);return n.apply(e,arguments),t}};var A=function(t,n){if(!e.isArray(n))return n;var r,i,s={};for(r=0,i=n.length;r<i;r++)n[r].hasOwnProperty(t)&&(s[n[r][t]]=n[r]);return s},O=function(e){var t=!1;return function(){if(t)return;t=!0,e.apply(this,arguments)}},M=function(e,t){var n;return function(){var r=this,i=arguments;window.clearTimeout(n),n=window.setTimeout(function(){e.apply(r,i)},t)}},_=function(e,t,n){var r,i=e.trigger,s={};e.trigger=function(){var n=arguments[0];if(t.indexOf(n)===-1)return i.apply(e,arguments);s[n]=arguments},n.apply(e,[]),e.trigger=i;for(r in s)s.hasOwnProperty(r)&&i.apply(e,s[r])},D=function(e,t,n,r){e.on(t,n,function(t){var n=t.target;while(n&&n.parentNode!==e[0])n=n.parentNode;return t.currentTarget=n,r.apply(this,[t])})},P=function(e){var t={};if("selectionStart"in e)t.start=e.selectionStart,t.length=e.selectionEnd-t.start;else if(document.selection){e.focus();var n=document.selection.createRange(),r=document.selection.createRange().text.length;n.moveStart("character",-e.value.length),t.start=n.text.length-r,t.length=r}return t},H=function(e,t,n){var r,i,s={};if(n)for(r=0,i=n.length;r<i;r++)s[n[r]]=e.css(n[r]);else s=e.css();t.css(s)},B=function(t,n){if(!t)return 0;var r=e("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(t).appendTo("body");H(n,r,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var i=r.width();return r.remove(),i},j=function(e){var t=null,n=function(n,r){var i,s,o,u,a,f,l,c;n=n||window.event||{},r=r||{};if(n.metaKey||n.altKey)return;if(!r.force&&e.data("grow")===!1)return;i=e.val(),n.type&&n.type.toLowerCase()==="keydown"&&(s=n.keyCode,o=s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===32,s===g||s===m?(c=P(e[0]),c.length?i=i.substring(0,c.start)+i.substring(c.start+c.length):s===m&&c.start?i=i.substring(0,c.start-1)+i.substring(c.start+1):s===g&&typeof c.start!="undefined"&&(i=i.substring(0,c.start)+i.substring(c.start+1))):o&&(f=n.shiftKey,l=String.fromCharCode(n.keyCode),f?l=l.toUpperCase():l=l.toLowerCase(),i+=l)),u=e.attr("placeholder"),!i&&u&&(i=u),a=B(i,e)+4,a!==t&&(t=a,e.width(a),e.triggerHandler("resize"))};e.on("keydown keyup update blur",n),n()},F=function(t,n){var r,i,s,o,u,a=this;u=t[0],u.selectize=a,o=window.getComputedStyle?window.getComputedStyle(u,null).getPropertyValue("direction"):u.currentStyle&&u.currentStyle.direction,o=o||t.parents("[dir]:first").attr("dir")||"",e.extend(a,{settings:n,$input:t,tagType:u.tagName.toLowerCase()==="select"?S:x,rtl:/rtl/i.test(o),eventNS:".selectize"+ ++F.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:t.is("[required]"),isInvalid:!1,isLocked:!1,isLoading:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:n.loadThrottle===null?a.onSearchChange:M(a.onSearchChange,n.loadThrottle)}),a.sifter=new c(this.options,{diacritics:n.diacritics}),e.extend(a.options,A(n.valueField,n.options)),delete a.settings.options,e.extend(a.optgroups,A(n.optgroupValueField,n.optgroups)),delete a.settings.optgroups,a.settings.mode=a.settings.mode||(a.settings.maxItems===1?"single":"multi"),typeof a.settings.hideSelected!="boolean"&&(a.settings.hideSelected=a.settings.mode==="multi"),a.settings.create&&(a.canCreate=function(e){var t=a.settings.createFilter;return e.length&&(typeof t!="function"||t.apply(a,[e]))&&(typeof t!="string"||(new RegExp(t)).test(e))&&(!(t instanceof RegExp)||t.test(e))}),a.initializePlugins(a.settings.plugins),a.setupCallbacks(),a.setupTemplates(),a.setup()};return n.mixin(F),h.mixin(F),e.extend(F.prototype,{setup:function(){var t=this,n=t.settings,i=t.eventNS,s=e(window),o=e(document),u=t.$input,a,f,l,c,h,p,d,v,m,g,E,x;d=t.settings.mode,g=u.attr("tabindex")||"",E=u.attr("class")||"",a=e("<div>").addClass(n.wrapperClass).addClass(E).addClass(d),f=e("<div>").addClass(n.inputClass).addClass("items").appendTo(a),l=e('<input type="text" autocomplete="off" />').appendTo(f).attr("tabindex",g),p=e(n.dropdownParent||a),c=e("<div>").addClass(n.dropdownClass).addClass(E).addClass(d).hide().appendTo(p),h=e("<div>").addClass(n.dropdownContentClass).appendTo(c);if(t.settings.render.button){var T=t.settings.render.button.apply(t);if(T){var N=e(T).addClass("selectize-dropdown-button");c.append(N),t.$dropdown_button=N}}a.css({width:u[0].style.width}),t.plugins.names.length&&(x="plugin-"+t.plugins.names.join(" plugin-"),a.addClass(x),c.addClass(x)),(n.maxItems===null||n.maxItems>1)&&t.tagType===S&&u.attr("multiple","multiple"),t.settings.placeholder&&l.attr("placeholder",n.placeholder),u.attr("autocorrect")&&l.attr("autocorrect",u.attr("autocorrect")),u.attr("autocapitalize")&&l.attr("autocapitalize",u.attr("autocapitalize")),t.$wrapper=a,t.$control=f,t.$control_input=l,t.$dropdown=c,t.$dropdown_content=h,c.on("mouseenter","[data-selectable]",function(){return t.onOptionHover.apply(t,arguments)}),c.on("mousedown","[data-selectable]",function(){return t.onOptionSelect.apply(t,arguments)}),D(f,"mousedown","*:not(input)",function(){return t.onItemSelect.apply(t,arguments)}),j(l),f.on({mousedown:function(e){return t.onMouseDown.apply(t,arguments)},click:function(){return t.onClick.apply(t,arguments)}}),l.on({mousedown:function(e){t.isOpen&&e.stopPropagation()},keydown:function(){return t.onKeyDown.apply(t,arguments)},keyup:function(){return t.onKeyUp.apply(t,arguments)},keypress:function(){return t.onKeyPress.apply(t,arguments)},resize:function(){t.positionDropdown.apply(t,[])},blur:function(){return t.onBlur.apply(t,arguments)},focus:function(){return t.ignoreBlur=!1,t.onFocus.apply(t,arguments)},paste:function(){return t.onPaste.apply(t,arguments)}}),o.on("keydown"+i,function(e){t.isCmdDown=e[r?"metaKey":"ctrlKey"],t.isCtrlDown=e[r?"altKey":"ctrlKey"],t.isShiftDown=e.shiftKey}),o.on("keyup"+i,function(e){e.keyCode===w&&(t.isCtrlDown=!1),e.keyCode===y&&(t.isShiftDown=!1),e.keyCode===b&&(t.isCmdDown=!1)}),o.on("mousedown"+i,function(n){if(t.isFocused){if(n.target===t.$dropdown[0]||e(n.target).parents(".selectize-dropdown.selection").length)return!1;!t.$control.has(n.target).length&&n.target!==t.$control[0]&&t.blur()}}),s.on(["scroll"+i,"resize"+i].join(" "),function(){t.isOpen&&t.positionDropdown.apply(t,arguments)}),s.on("mousemove"+i,function(){t.ignoreHover=!1}),this.revertSettings={$children:u.children().detach(),tabindex:u.attr("tabindex")},u.attr("tabindex",-1).hide().after(t.$wrapper),e.isArray(n.items)&&(t.setValue(n.items),delete n.items),u[0].validity&&u.on("invalid"+i,function(e){e.preventDefault(),t.isInvalid=!0,t.refreshState()}),t.updateOriginalInput(),t.refreshItems(),t.refreshState(),t.updatePlaceholder(),t.isSetup=!0,u.is(":disabled")&&t.disable(),t.on("change",this.onChange),u.data("selectize",t),u.addClass("selectized"),t.trigger("initialize"),n.preload===!0&&t.onSearchChange("")},setupTemplates:function(){var t=this,n=t.settings.labelField,r=t.settings.optgroupLabelField,i={optgroup:function(e){return'<div class="optgroup">'+e.html+"</div>"},optgroup_header:function(e,t){return'<div class="optgroup-header">'+t(e[r])+"</div>"},option:function(e,t){return'<div class="option">'+t(e[n])+"</div>"},item:function(e,t){return'<div class="item">'+t(e[n])+"</div>"},option_create:function(e,t){return'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>"}};t.settings.render=e.extend({},i,t.settings.render)},setupCallbacks:function(){var e,t,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType"},r=this;for(e in n)n.hasOwnProperty(e)&&(t=this.settings[n[e]],t&&this.on(e,t),function(e){r.on(e,function(){r.$input&&r.$input.trigger("select_"+e,arguments)})}(e))},onClick:function(e){var t=this;t.isFocused||(t.focus(),e.preventDefault())},onMouseDown:function(t){var n=this,r=t.isDefaultPrevented(),i=e(t.target);if(n.isFocused){if(t.target!==n.$control_input[0])return n.settings.mode==="single"?n.isOpen?n.close():n.open():r||n.setActiveItem(null),!1}else r||window.setTimeout(function(){n.focus()},0)},onChange:function(){var e=this.getValue();this.$input.hasClass("bool")?this.$input.trigger("change",e==="true"?!0:!1):this.$input.trigger("change",e)},onPaste:function(e){var t=this;(t.isFull()||t.isInputHidden||t.isLocked)&&e.preventDefault()},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var t=String.fromCharCode(e.keyCode||e.which);if(this.settings.create&&t===this.settings.delimiter)return this.createItem(),e.preventDefault(),!1},onKeyDown:function(e){var t=e.target===this.$control_input[0],n=this;if(n.isLocked){e.keyCode!==E&&e.preventDefault();return}switch(e.keyCode){case i:if(n.isCmdDown){n.selectAll();return}break;case u:n.close();return;case v:if(!e.ctrlKey||e.altKey)break;case d:if(!n.isOpen&&n.hasOptions)n.open();else if(n.$activeOption){n.ignoreHover=!0;var s=n.getAdjacentOption(n.$activeOption,1);s.length&&n.setActiveOption(s,!0,!0)}e.preventDefault();return;case l:if(!e.ctrlKey||e.altKey)break;case f:if(n.$activeOption){n.ignoreHover=!0;var c=n.getAdjacentOption(n.$activeOption,-1);c.length&&n.setActiveOption(c,!0,!0)}e.preventDefault();return;case o:n.isOpen&&n.$activeOption?n.onOptionSelect({currentTarget:n.$activeOption}):n.newItemClick(),e.preventDefault();return;case a:n.advanceSelection(-1,e);return;case p:n.advanceSelection(1,e);return;case E:n.settings.selectOnTab&&n.isOpen&&n.$activeOption&&(n.onOptionSelect({currentTarget:n.$activeOption}),e.preventDefault()),n.settings.create&&n.createItem()&&e.preventDefault();return;case m:case g:n.deleteSelection(e);return}if((n.isFull()||n.isInputHidden)&&(r?!e.metaKey:!e.ctrlKey)){e.preventDefault();return}},onKeyUp:function(e){var t=this;if(t.isLocked)return e&&e.preventDefault();var n=t.$control_input.val()||"";t.lastValue!==n&&(t.lastValue=n,t.onSearchChange(n),t.refreshOptions(),t.trigger("type",n))},onSearchChange:function(e){var t=this,n=t.settings.load;if(!n)return;if(t.loadedSearches.hasOwnProperty(e))return;t.loadedSearches[e]=!0,t.load(function(r){n.apply(t,[e,r])})},onFocus:function(e){var t=this;t.isFocused=!0;if(t.isDisabled)return t.blur(),e&&e.preventDefault(),!1;if(t.ignoreFocus)return;t.settings.preload==="focus"&&t.onSearchChange(""),t.$activeItems.length||(t.showInput(),t.setActiveItem(null),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState()},onBlur:function(e){var t=this;t.isFocused=!1;if(t.ignoreFocus)return;if(!t.ignoreBlur&&document.activeElement===t.$dropdown_content[0]){t.ignoreBlur=!0,t.onFocus(e);return}t.settings.create&&t.settings.createOnBlur&&t.createItem(!1),t.close(),t.setTextboxValue(""),t.setActiveItem(null),t.setActiveOption(null),t.setCaret(t.items.length),t.refreshState()},onOptionHover:function(e){if(this.ignoreHover)return;this.setActiveOption(e.currentTarget,!1)},onOptionSelect:function(t){var n,r,i,s=this;t.preventDefault&&(t.preventDefault(),t.stopPropagation()),r=e(t.currentTarget),r.hasClass("create")?s.createItem():(n=r.attr("data-value"),typeof n!="undefined"&&(s.lastQuery=null,s.setTextboxValue(""),s.addItem(n),!s.settings.hideSelected&&t.type&&/mouse/.test(t.type)&&s.setActiveOption(s.getOption(n))))},onItemSelect:function(e){var t=this;if(t.isLocked)return;t.settings.mode==="multi"&&(e.preventDefault(),t.setActiveItem(e.currentTarget,e))},load:function(e){var t=this,n=t.$wrapper.addClass("loading-selection");t.loading++,e.apply(t,[function(e){t.loading=Math.max(t.loading-1,0),e&&e.length&&(t.addOption(e),t.refreshOptions(t.isFocused&&!t.isInputHidden)),t.loading||n.removeClass("loading-selection"),t.trigger("load",e)}])},setTextboxValue:function(e){var t=this.$control_input,n=t.val()!==e;n&&(t.val(e).triggerHandler("update"),this.lastValue=e)},getValue:function(){return this.tagType===S&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)||this.$control_input.val()},setValue:function(e,t){this.isValueInOptions(e)&&(this.oldValue=e,t?(this.clear(),this.addItems(e)):_(this,["change"],function(){this.clear(),this.addItems(e)}))},setActiveItem:function(t,n){var r=this,i,s,o,u,a,f,l,c;if(r.settings.mode==="single")return;t=e(t);if(!t.length){e(r.$activeItems).removeClass("active"),r.$activeItems=[],r.isFocused&&r.showInput();return}i=n&&n.type.toLowerCase();if(i==="mousedown"&&r.isShiftDown&&r.$activeItems.length){c=r.$control.children(".active:last"),u=Array.prototype.indexOf.apply(r.$control[0].childNodes,[c[0]]),a=Array.prototype.indexOf.apply(r.$control[0].childNodes,[t[0]]),u>a&&(l=u,u=a,a=l);for(s=u;s<=a;s++)f=r.$control[0].childNodes[s],r.$activeItems.indexOf(f)===-1&&(e(f).addClass("active"),r.$activeItems.push(f));n.preventDefault()}else i==="mousedown"&&r.isCtrlDown||i==="keydown"&&this.isShiftDown?t.hasClass("active")?(o=r.$activeItems.indexOf(t[0]),r.$activeItems.splice(o,1),t.removeClass("active")):r.$activeItems.push(t.addClass("active")[0]):(e(r.$activeItems).removeClass("active"),r.$activeItems=[t.addClass("active")[0]]);r.hideInput(),this.isFocused||r.focus()},setActiveOption:function(t,n,r){var i,s,o,u,a,f=this;f.$activeOption&&f.$activeOption.removeClass("active"),f.$activeOption=null,t=e(t);if(!t.length)return;f.$activeOption=t.addClass("active");if(n||!T(n))i=f.$dropdown_content.height(),s=f.$activeOption.outerHeight(!0),n=f.$dropdown_content.scrollTop()||0,o=f.$activeOption.offset().top-f.$dropdown_content.offset().top+n,u=o,a=o-i+s,o+s>i+n?f.$dropdown_content.stop().animate({scrollTop:a},r?f.settings.scrollDuration:0):o<n&&f.$dropdown_content.stop().animate({scrollTop:u},r?f.settings.scrollDuration:0)},selectAll:function(){var e=this;if(e.settings.mode==="single")return;e.$activeItems=Array.prototype.slice.apply(e.$control.children(":not(input)").addClass("active")),e.$activeItems.length&&(e.hideInput(),e.close()),e.focus()},hideInput:function(){var e=this;if(e.$input&&e.$input.hasClass("show-input"))return;e.setTextboxValue(""),e.$control_input.css({opacity:0,position:"absolute",left:e.rtl?1e4:-1e4}),e.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var e=this;if(e.isDisabled)return;e.ignoreFocus=!0,e.$control_input[0].focus(),window.setTimeout(function(){e.ignoreFocus=!1,e.onFocus()},0)},blur:function(){this.$control_input.trigger("blur")},getScoreFunction:function(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())},getSearchOptions:function(){var e=this.settings,t=e.sortField;return typeof t=="string"&&(t={field:t}),{fields:e.searchField,conjunction:e.searchConjunction,sort:t}},search:function(t){var n,r,i,s,o,u=this,a=u.settings,f=this.getSearchOptions();if(a.score){o=u.settings.score.apply(this,[t]);if(typeof o!="function")throw new Error('Selectize "score" setting must be a function that returns a function')}t!==u.lastQuery?(u.lastQuery=t,s=u.sifter.search(t,e.extend(f,{score:o})),u.currentResults=s):s=e.extend(!0,{},u.currentResults);if(a.hideSelected)for(n=s.items.length-1;n>=0;n--)u.items.indexOf(N(s.items[n].id))!==-1&&s.items.splice(n,1);return s},refreshOptions:function(n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;typeof n=="undefined"&&(n=!0);var b=this,w=b.$control_input.val(),E=b.search(w),S=b.$dropdown_content,x=b.$activeOption&&N(b.$activeOption.attr("data-value"));o=E.items.length,typeof b.settings.maxOptions=="number"&&(o=Math.min(o,b.settings.maxOptions)),u={};if(b.settings.optgroupOrder){a=b.settings.optgroupOrder;for(r=0;r<a.length;r++)u[a[r]]=[]}else a=[];for(r=0;r<o;r++){f=b.options[E.items[r].id],l=b.render("option",f),c=f[b.settings.optgroupField]||"",h=e.isArray(c)?c:[c];for(i=0,s=h&&h.length;i<s;i++)c=h[i],b.optgroups.hasOwnProperty(c)||(c=""),u.hasOwnProperty(c)||(u[c]=[],a.push(c)),u[c].push(l)}p=[];for(r=0,o=a.length;r<o;r++)c=a[r],b.optgroups.hasOwnProperty(c)&&u[c].length?(d=b.render("optgroup_header",b.optgroups[c])||"",d+=u[c].join(""),p.push(b.render("optgroup",e.extend({},b.optgroups[c],{html:d})))):p.push(u[c].join(""));S.html(p.join(""));if(b.settings.highlight&&E.query.length&&E.tokens.length)for(r=0,o=E.tokens.length;r<o;r++)t(S,E.tokens[r].regex);if(!b.settings.hideSelected)for(r=0,o=b.items.length;r<o;r++)b.getOption(b.items[r]).addClass("selected");v=b.settings.create&&b.canCreate&&b.canCreate(E.query),v&&(S.prepend(b.render("option_create",{input:w})),y=e(S[0].childNodes[0])),b.hasOptions=E.items.length>0||v;if(b.hasOptions){if(E.items.length>0){g=x&&b.getOption(x),g&&g.length?m=g:b.settings.mode==="single"&&b.items.length&&(m=b.getOption(b.items[0]));if(!m||!m.length)y&&!b.settings.addPrecedence?m=b.getAdjacentOption(y,1):m=S.find("[data-selectable]:first")}else m=y;b.setActiveOption(m),n&&!b.isOpen&&b.open()}else b.setActiveOption(null),n&&b.isOpen&&b.close();if(b.settings.render.button&&b.$dropdown_button){if(b.$dropdown_button.find("span.new").length){var T=b.$control_input.val();if(!a.length&&T)b.$dropdown_button.find("span.default").text(""),b.$dropdown_button.find("span.new").text(T),b.open();else{var C=b.settings.render.button.apply(b),k=e(C).find("span.default").text();b.$dropdown_button.find("span.default").text(k),b.$dropdown_button.find("span.new").text("")}}b.$dropdown_button.off("click").on("click",function(e){b.newItemClick()})}},newItemClick:function(){var e=this;e.settings.render.button&&e.$dropdown_button&&(e.$input.trigger("select_dropdown_button_click",e.$control_input.val()),e.close())},addOption:function(t){var n,r,i,s,o=this;if(e.isArray(t)){for(n=0,r=t.length;n<r;n++)o.addOption(t[n]);return}s=N(t[o.settings.valueField]);if(typeof s!="string"||o.options.hasOwnProperty(s))return;o.userOptions[s]=!0,o.options[s]=t,o.lastQuery=null,o.trigger("option_add",s,t)},addOptionGroup:function(e,t){this.optgroups[e]=t,this.trigger("optgroup_add",e,t)},updateOption:function(t,n){var r=this,i,s,o,u,a,f;t=N(t),o=N(n[r.settings.valueField]);if(t===null)return;if(!r.options.hasOwnProperty(t))return;if(typeof o!="string")throw new Error("Value must be set in option data");o!==t&&(delete r.options[t],u=r.items.indexOf(t),u!==-1&&r.items.splice(u,1,o)),r.options[o]=n,a=r.renderCache.item,f=r.renderCache.option,a&&(delete a[t],delete a[o]),f&&(delete f[t],delete f[o]),r.items.indexOf(o)!==-1&&(i=r.getItem(t),s=e(r.render("item",n)),i.hasClass("active")&&s.addClass("active"),i.replaceWith(s)),r.isOpen&&r.refreshOptions(!1)},removeOption:function(e){var t=this;e=N(e);var n=t.renderCache.item,r=t.renderCache.option;n&&delete n[e],r&&delete r[e],delete t.userOptions[e],delete t.options[e],t.lastQuery=null,t.trigger("option_remove",e),t.removeItem(e)},clearOptions:function(){var e=this;e.loadedSearches={},e.userOptions={},e.renderCache={},e.options=e.sifter.items={},e.lastQuery=null,e.trigger("option_clear"),e.clear()},getOption:function(e){return this.getElementWithValue(e,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(t,n){var r=this.$dropdown.find("[data-selectable]"),i=r.index(t)+n;return i>=0&&i<r.length?r.eq(i):e()},getElementWithValue:function(t,n){t=N(t);if(typeof t!="undefined"&&t!==null)for(var r=0,i=n.length;r<i;r++)if(n[r].getAttribute("data-value")===t)return e(n[r]);return e()},getItem:function(e){return this.getElementWithValue(e,this.$control.children())},addItems:function(t){var n=e.isArray(t)?t:[t];for(var r=0,i=n.length;r<i;r++)this.isPending=r<i-1,this.addItem(n[r])},addItem:function(t){_(this,["change"],function(){var n,r,i,s=this,o=s.settings.mode,u,a,f,l;t=N(t);if(s.items.indexOf(t)!==-1){o==="single"&&s.close();return}if(!s.options.hasOwnProperty(t))return;o==="single"&&s.clear();if(o==="multi"&&s.isFull())return;n=e(s.render("item",s.options[t])),l=s.isFull(),s.items.splice(s.caretPos,0,t),s.insertAtCaret(n),(!s.isPending||!l&&s.isFull())&&s.refreshState(),s.isSetup&&(i=s.$dropdown_content.find("[data-selectable]"),s.isPending||(r=s.getOption(t),f=s.getAdjacentOption(r,1).attr("data-value"),s.refreshOptions(s.isFocused&&o!=="single"),f&&s.setActiveOption(s.getOption(f))),!i.length||s.isFull()?s.close():s.positionDropdown(),s.updatePlaceholder(),s.trigger("item_add",t,n),s.updateOriginalInput())})},removeItem:function(e){var t=this,n,r,i;n=typeof e=="object"?e:t.getItem(e),e=N(n.attr("data-value")),r=t.items.indexOf(e);if(r!==-1){n.remove(),n.hasClass("active")&&(i=t.$activeItems.indexOf(n[0]),t.$activeItems.splice(i,1)),t.items.splice(r,1),t.lastQuery=null,!t.settings.persist&&t.userOptions.hasOwnProperty(e)&&t.removeOption(e),r<t.caretPos&&t.setCaret(t.caretPos-1),t.refreshState(),t.updatePlaceholder(),t.updateOriginalInput(),t.positionDropdown(),t.trigger("item_remove",e);var s=t.options[e];s&&s.text&&t.setTextboxValue(s.text)}},createItem:function(t){var n=this,r=e.trim(n.$control_input.val()||""),i=n.caretPos;if(n.canCreate&&!n.canCreate(r))return!1;n.lock(),typeof t=="undefined"&&(t=!0);var s=typeof n.settings.create=="function"?this.settings.create:function(e){var t={};return t[n.settings.labelField]=e,t[n.settings.valueField]=e,t},o=O(function(e){n.unlock();if(!e||typeof e!="object")return;var r=N(e[n.settings.valueField]);if(typeof r!="string")return;n.setTextboxValue(""),n.addOption(e),n.setCaret(i),n.addItem(r),n.refreshOptions(t&&n.settings.mode!=="single")}),u=s.apply(this,[r,o]);return typeof u!="undefined"&&o(u),!0},refreshItems:function(){this.lastQuery=null;if(this.isSetup)for(var e=0;e<this.items.length;e++)this.addItem(this.items);this.refreshState(),this.updateOriginalInput()},refreshState:function(){var e,t=this;t.isRequired&&(t.items.length&&(t.isInvalid=!1),t.$control_input.prop("required",e)),t.refreshClasses()},refreshClasses:function(){var t=this,n=t.isFull(),r=t.isLocked;t.$wrapper.toggleClass("rtl",t.rtl),t.$control.toggleClass("focus",t.isFocused).toggleClass("disabled",t.isDisabled).toggleClass("required",t.isRequired).toggleClass("invalid",t.isInvalid).toggleClass("locked",r).toggleClass("full",n).toggleClass("not-full",!n).toggleClass("input-active",t.isFocused&&!t.isInputHidden).toggleClass("dropdown-active",t.isOpen).toggleClass("has-options",!e.isEmptyObject(t.options)).toggleClass("has-items",t.items.length>0),t.$control_input.data("grow",!n&&!r)},isFull:function(){return this.settings.maxItems!==null&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(){var e,t,n,r=this;if(r.tagType===S){n=[];for(e=0,t=r.items.length;e<t;e++)n.push('<option value="'+C(r.items[e])+'" selected="selected"></option>');!n.length&&!this.$input.attr("multiple")&&n.push('<option value="" selected="selected"></option>'),r.$input.html(n.join(""))}else r.$input.val(r.getValue()),r.$input.attr("value",r.$input.val());r.isSetup&&r.trigger("change",r.$input.val())},updatePlaceholder:function(){if(!this.settings.placeholder)return;var e=this.$control_input;this.items.length?e.removeAttr("placeholder"):e.attr("placeholder",this.settings.placeholder),e.triggerHandler("update",{force:!0})},open:function(){var e=this;if(e.isLocked&&!e.isLoading||e.isOpen||e.settings.mode==="multi"&&e.isFull())return;e.focus(),e.isOpen=!0,e.refreshState(),e.$dropdown.css({visibility:"hidden",display:"block"}),e.positionDropdown(),e.$dropdown.css({visibility:"visible"}),e.trigger("dropdown_open",e.$dropdown)},close:function(){var e=this,t=e.isOpen;e.settings.mode==="single"&&e.items.length&&e.hideInput(),e.isOpen=!1,e.$dropdown.hide(),e.setActiveOption(null),e.refreshState(),t&&e.trigger("dropdown_close",e.$dropdown)},positionDropdown:function(){var e=this.$control,t=this.settings.dropdownParent==="body"?e.offset():e.position();t.top+=e.outerHeight(!0),this.$dropdown.css({width:e.outerWidth(),top:t.top,left:t.left})},clear:function(){var e=this;if(!e.items.length)return;e.$control.children(":not(input)").remove(),e.items=[],e.lastQuery=null,e.setCaret(0),e.setActiveItem(null),e.updatePlaceholder(),e.updateOriginalInput(),e.refreshState(),e.showInput(),e.trigger("clear")},insertAtCaret:function(t){var n=Math.min(this.caretPos,this.items.length);n===0?this.$control.prepend(t):e(this.$control[0].childNodes[n]).before(t),this.setCaret(n+1)},deleteSelection:function(t){var n,r,i,s,o,u,a,f,l,c=this;i=t&&t.keyCode===m?-1:1,s=P(c.$control_input[0]),c.$activeOption&&!c.settings.hideSelected&&(a=c.getAdjacentOption(c.$activeOption,-1).attr("data-value")),o=[];if(c.$activeItems.length){l=c.$control.children(".active:"+(i>0?"last":"first")),u=c.$control.children(":not(input)").index(l),i>0&&u++;for(n=0,r=c.$activeItems.length;n<r;n++)o.push(e(c.$activeItems[n]).attr("data-value"));t&&(t.preventDefault(),t.stopPropagation())}else(c.isFocused||c.settings.mode==="single")&&c.items.length&&(i<0&&s.start===0&&s.length===0?o.push(c.items[c.caretPos-1]):i>0&&s.start===c.$control_input.val().length&&o.push(c.items[c.caretPos]));if(!o.length||typeof c.settings.onDelete=="function"&&c.settings.onDelete.apply(c,[o])===!1)return!1;typeof u!="undefined"&&c.setCaret(u);while(o.length)c.removeItem(o.pop());return c.showInput(),c.positionDropdown(),c.refreshOptions(!0),a&&(f=c.getOption(a),f.length&&c.setActiveOption(f)),!0},advanceSelection:function(e,t){var n,r,i,s,o,u,a=this;if(e===0)return;a.rtl&&(e*=-1),n=e>0?"last":"first",r=P(a.$control_input[0]),a.isFocused&&!a.isInputHidden?(s=a.$control_input.val().length,o=e<0?r.start===0&&r.length===0:r.start===s,o&&!s&&a.advanceCaret(e,t)):(u=a.$control.children(".active:"+n),u.length&&(i=a.$control.children(":not(input)").index(u),a.setActiveItem(null),a.setCaret(e>0?i+1:i)))},advanceCaret:function(e,t){var n=this,r,i;if(e===0)return;r=e>0?"next":"prev",n.isShiftDown?(i=n.$control_input[r](),i.length&&(n.hideInput(),n.setActiveItem(i),t&&t.preventDefault())):n.setCaret(n.caretPos+e)},setCaret:function(t){var n=this;n.settings.mode==="single"?t=n.items.length:t=Math.max(0,Math.min(n.items.length,t));if(!n.isPending){var r,i,s,o,u;o=n.$control.children(":not(input)");for(r=0,i=o.length;r<i;r++)u=e(o[r]).detach(),r<t?n.$control_input.before(u):n.$control.append(u)}n.caretPos=t},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var e=this;e.$input.prop("disabled",!0),e.isDisabled=!0,e.lock()},enable:function(){var e=this;e.$input.prop("disabled",!1),e.isDisabled=!1,e.unlock()},destroy:function(){var t=this,n=t.eventNS,r=t.revertSettings;t.trigger("destroy"),t.off(),t.$wrapper.remove(),t.$dropdown.remove(),t.$input.html("").append(r.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:r.tabindex}).show(),t.$control_input.removeData("grow"),t.$input.removeData("selectize"),e(window).off(n),e(document).off(n),e(document.body).off(n),delete t.$input[0].selectize},render:function(e,t){var n,r,i,s="",o=!1,u=this,a=/^[\t ]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;if(e==="option"||e==="item")n=N(t[u.settings.valueField]),o=!!n;if(o){T(u.renderCache[e])||(u.renderCache[e]={});if(u.renderCache[e].hasOwnProperty(n))return u.renderCache[e][n]}s=u.settings.render[e].apply(this,[t,C]);if(e==="option"||e==="option_create")s=s.replace(a,"<$1 data-selectable");e==="optgroup"&&(r=t[u.settings.optgroupValueField]||"",s=s.replace(a,'<$1 data-group="'+k(C(r))+'"'));if(e==="option"||e==="item")s=s.replace(a,'<$1 data-value="'+k(C(n||""))+'"');return o&&(u.renderCache[e][n]=s),s},clearCache:function(e){var t=this;typeof e=="undefined"?t.renderCache={}:delete t.renderCache[e]},isValueInOptions:function(t){t=N(t);var n=this;if(n.settings.validHandle)return n.settings.validHandle.call(n.$input,t);if(!t||!t.length)return!1;var n=this;if(e.isArray(t)){for(var r in t)if(!n.options[t[r]])return!1}else if(!n.options[t])return!1;return!0}}),F.count=0,F.defaults={plugins:[],delimiter:",",persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,scrollDuration:60,loadThrottle:300,dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",optgroupOrder:null,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,validHandle:null,render:{}},e.fn.selectize=function(t){var n=e.fn.selectize.defaults,r=e.extend({},n,t),i=r.dataAttr,s=r.labelField,o=r.valueField,u=r.optgroupField,a=r.optgroupLabelField,f=r.optgroupValueField,l=function(t,n){var i,u,a,f,l=e.trim(t.val()||"");if(!r.allowEmptyOption&&!l.length)return;a=l.split(r.delimiter);for(i=0,u=a.length;i<u;i++)f={},f[s]=a[i],f[o]=a[i],n.options[a[i]]=f;n.items=a},c=function(t,n){var l,c,h,p,d=0,v=n.options,m=function(e){var t=i&&e.attr(i);return typeof t=="string"&&t.length?JSON.parse(t):null},g=function(t,i){var a,f;t=e(t),a=t.attr("value")||"";if(!a.length&&!r.allowEmptyOption)return;if(v.hasOwnProperty(a)){i&&(v[a].optgroup?e.isArray(v[a].optgroup)?v[a].optgroup.push(i):v[a].optgroup=[v[a].optgroup,i]:v[a].optgroup=i);return}f=m(t)||{},f[s]=f[s]||t.text(),f[o]=f[o]||a,f[u]=f[u]||i,f.$order=++d,v[a]=f,t.is(":selected")&&n.items.push(a)},y=function(t){var r,i,s,o,u;t=e(t),s=t.attr("label"),s&&(o=m(t)||{},o[a]=s,o[f]=s,n.optgroups[s]=o),u=e("option",t);for(r=0,i=u.length;r<i;r++)g(u[r],s)};n.maxItems=t.attr("multiple")?null:1,p=t.children();for(l=0,c=p.length;l<c;l++)h=p[l].tagName.toLowerCase(),h==="optgroup"?y(p[l]):h==="option"&&g(p[l])};return this.each(function(){if(this.selectize)return;var i,s=e(this),o=this.tagName.toLowerCase(),u=s.attr("placeholder")||s.attr("data-placeholder");!u&&!r.allowEmptyOption&&(u=s.children('option[value=""]').text());var a={placeholder:u,options:{},optgroups:{},items:[]};o==="select"?c(s,a):l(s,a),i=new F(s,e.extend(!0,{},n,a,t))})},e.fn.getValue=function(){var e=this[0];return e.selectize?this.hasClass("bool")?e.selectize.getValue()==="true"?!0:!1:e.selectize.getValue():this.val()},e.fn.setValue=function(e){var t=this[0];return t.selectize?t.selectize.setValue(e):this.val(e)},e.fn.selectize.defaults=F.defaults,F.define("drag_drop",function(t){if(!e.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if(this.settings.mode!=="multi")return;var n=this;n.lock=function(){var e=n.lock;return function(){var t=n.$control.data("sortable");return t&&t.disable(),e.apply(n,arguments)}}(),n.unlock=function(){var e=n.unlock;return function(){var t=n.$control.data("sortable");return t&&t.enable(),e.apply(n,arguments)}}(),n.setup=function(){var t=n.setup;return function(){t.apply(this,arguments);var r=n.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:n.isLocked,start:function(e,t){t.placeholder.css("width",t.helper.css("width")),r.css({overflow:"visible"})},stop:function(){r.css({overflow:"hidden"});var t=n.$activeItems?n.$activeItems.slice():null,i=[];r.children("[data-value]").each(function(){i.push(e(this).attr("data-value"))}),n.setValue(i),n.setActiveItem(t)}})}}()}),F.define("dropdown_header",function(t){var n=this;t=e.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(e){return'<div class="'+e.headerClass+'">'+'<div class="'+e.titleRowClass+'">'+'<span class="'+e.labelClass+'">'+e.title+"</span>"+'<a href="javascript:void(0)" class="'+e.closeClass+'">&times;</a>'+"</div>"+"</div>"}},t),n.setup=function(){var r=n.setup;return function(){r.apply(n,arguments),n.$dropdown_header=e(t.html(t)),n.$dropdown.prepend(n.$dropdown_header)}}()}),F.define("optgroup_columns",function(t){var n=this;t=e.extend({equalizeWidth:!0,equalizeHeight:!0},t),this.getAdjacentOption=function(t,n){var r=t.closest("[data-group]").find("[data-selectable]"),i=r.index(t)+n;return i>=0&&i<r.length?r.eq(i):e()},this.onKeyDown=function(){var e=n.onKeyDown;return function(t){var r,i,s,o;if(!this.isOpen||t.keyCode!==a&&t.keyCode!==p)return e.apply(this,arguments);n.ignoreHover=!0,o=this.$activeOption.closest("[data-group]"),r=o.find("[data-selectable]").index(this.$activeOption),t.keyCode===a?o=o.prev("[data-group]"):o=o.next("[data-group]"),s=o.find("[data-selectable]"),i=s.eq(Math.min(s.length-1,r)),i.length&&this.setActiveOption(i);return}}();var r=function(){var e,t=r.width,n=document;return typeof t=="undefined"&&(e=n.createElement("div"),e.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',e=e.firstChild,n.body.appendChild(e),t=r.width=e.offsetWidth-e.clientWidth,n.body.removeChild(e)),t},i=function(){var i,s,o,u,a,f,l;l=e("[data-group]",n.$dropdown_content),s=l.length;if(!s||!n.$dropdown_content.width())return;if(t.equalizeHeight){o=0;for(i=0;i<s;i++)o=Math.max(o,l.eq(i).height());l.css({height:o})}t.equalizeWidth&&(f=n.$dropdown_content.innerWidth()-r(),u=Math.round(f/s),l.css({width:u}),s>1&&(a=f-u*(s-1),l.eq(s-1).css({width:a})))};if(t.equalizeHeight||t.equalizeWidth)L.after(this,"positionDropdown",i),L.after(this,"refreshOptions",i)}),F.define("remove_button",function(t){if(this.settings.mode==="single")return;t=e.extend({label:"&times;",title:"Remove",className:"remove",append:!0},t);var n=this,r='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+C(t.title)+'">'+t.label+"</a>",i=function(e,t){var n=e.search(/(<\/[^>]+>\s*)$/);return e.substring(0,n)+t+e.substring(n)};this.setup=function(){var s=n.setup;return function(){if(t.append){var o=n.settings.render.item;n.settings.render.item=function(e){return i(o.apply(this,arguments),r)}}s.apply(this,arguments),this.$control.on("click","."+t.className,function(t){t.preventDefault();if(n.isLocked)return;var r=e(t.currentTarget).parent();n.setActiveItem(r),n.deleteSelection()&&n.setCaret(n.items.length)})}}()}),F.define("restore_on_backspace",function(e){var t=this;e.text=e.text||function(e){return e[this.settings.labelField]},this.onKeyDown=function(n){var r=t.onKeyDown;return function(t){var n,i;if(t.keyCode===m&&this.$control_input.val()===""&&!this.$activeItems.length){n=this.caretPos-1;if(n>=0&&n<this.items.length){i=this.options[this.items[n]],this.deleteSelection(t)&&(this.setTextboxValue(e.text.apply(this,[i])),this.refreshOptions(!0)),t.preventDefault();return}}return r.apply(this,arguments)}}()}),F.define("custom_selection",function(t){var n=this;this.onKeyDown=function(e){var t=n.onKeyDown;return function(e){if(e.keyCode===o&&!n.isOpen){n.open(),e.preventDefault();return}return t.apply(this,arguments)}}(),this.onMouseDown=function(e){var t=n.onMouseDown;return function(e){if(!n.isOpen){n.open(),e.preventDefault();return}return t.apply(this,arguments)}}(),this.onChange=function(t){var r=n.onChange;return function(t){var i=n.oldValue;e.isArray(n.oldValue)&&n.oldValue[0]&&(i=n.oldValue[0]);if(t!==i&&n.isValueInOptions(t)){n.oldValue=t;var s=r.apply(this,arguments);if(n.$input.hasClass("bool")){var o=n.$input.prevAll(".switcher");if(o.length){var u=n.getValue();u==="true"?o.addClass("on"):o.removeClass("on")}}return s}return}}(),this.onBlur=function(e){var t=n.onBlur;return function(e){var r=n.getValue();return n.isValueInOptions(r)?n.settings.validHandle:n.setValue(n.oldValue,!0),t.apply(this,arguments)}}(),this.render=function(){var t=n.render;return function(){var r=t.apply(n,arguments);if(n.$input.hasClass("bool")){var i=n.$input.prevAll(".switcher");if(!i.length){var s=n.getValue();s||(s=n.$input.attr("value"));var o="";s==="true"&&(o="on"),n.$input.before('<label class="switcher '+o+' disabled">'+'<span class="switch-label" data-on="" data-off=""></span>'+'<span class="switch-handle"></span>'+"</label>");var i=n.$input.prevAll(".switcher");i.on("click",function(){if(e(this).hasClass("disabled"))return;e(this).hasClass("on")?(e(this).removeClass("on"),n.setValue(!1)):(e(this).addClass("on"),n.setValue(!0))})}i=n.$input.prevAll(".switcher"),n.$input.attr("disabled")?i.addClass("disabled"):i.removeClass("disabled")}return r}}(),this.setLoading=function(e){var t=this;t.$dropdown_content.nextAll(".box-loading").remove(),t.isLoading=e,e?(t.lock(),t.$dropdown.addClass("loading-selection"),t.$dropdown.append('<div class="box-loading box-wrapper"><div class="loading-spinner"></div></div>')):(t.unlock(),t.$dropdown.removeClass("loading-selection"))}}),F})()}),define("UI.selection",["UI.selectize"],function(){var e,t;return e=function(e,t,n){var r,i,s,o,u;if(!e||!e.length)return;if(!e.hasClass("selectized")){s=!1,i=void 0;if(e.hasClass("dropdown"))return!1;e.hasClass("mutil")&&(s=!0,i=null),e.hasClass("bool")&&e.selectize({multi:s,maxItems:i,persist:!0,valueField:"value",labelField:"text",searchField:["text"],create:!1,openOnFocus:!1,plugins:["custom_selection"],onInitialize:function(){var t;return t=this.$input.attr("value"),t&&this.setValue(t.split(","),!0),e.trigger("selectized",this)},options:[{text:"True",value:"true"},{text:"False",value:"false"}],render:{option:function(e){return"<div>"+e.text+"</div>"},item:function(e){return"<div>"+e.text+"</div>"}}}),e.hasClass("option")&&(r=!1,u=e.data("valid-handle"),u&&t&&t[u]&&(o=t[u],o&&(r=!0)),e.selectize({multi:s,maxItems:i,persist:!0,create:r,createOnBlur:r,openOnFocus:!1,plugins:["custom_selection"],onInitialize:function(){var t,r;return r=this.$input.attr("value"),r&&this.setValue(r.split(","),!0),t=this.$input.attr("data-target"),n&&t&&(this.$control_input.attr("data-selection-id",MC.guid()),this.$control_input.attr("data-target",t),this.$control_input.selectionValid(n)),e.trigger("selectized",this)},validHandle:o,render:{option:function(e){var n;return n=this.$input.data("option-tpl"),n&&t&&t[n]?t[n].call(this.$input,e):"<div>"+e.text+"</div>"},item:function(e){var n;return n=this.$input.data("item-tpl"),n&&t&&t[n]?t[n].call(this.$input,e):"<div>"+e.text+"</div>"},button:function(){var e;return e=this.$input.data("button-tpl"),e&&t&&t[e]?t[e].call(this.$input):null}},createFilter:function(e){return o?o.call(this.$input,e):!1}}));if(n&&e.is("input, textarea"))return e.attr("data-selection-id",MC.guid()),e.selectionValid(n)}},t=function(t,n,r){return t.off("DOMNodeInserted").on("DOMNodeInserted",function(t){var i;i=$(t.target),i.find("select.selection, input").each(function(){return e($(this),n,r)});if((i[0].nodeName==="SELECT"||i[0].nodeName==="INPUT")&&i.hasClass(".selection"))return e(i,n,r)})},t.unbind=function(e,t){return e.unbindSelection()},t}),define("UI.bubblepopup",["jquery"],function(){var e;return $(document).on("click",function(e){if(!$(e.target).hasClass("bubble-popuped"))return $("#bubble-box").remove(),$(".bubble-popuped").removeClass("bubble-popuped")}),e=function(e,t,n){var r,i,s,o,u,a,f,l;e=$(e),i=$("#bubble-box"),s={};if($.trim(t)!=="")return i[0]||($(document.body).append('<div id="bubble-box" class="bubble-popup"><div class="arrow"></div><div id="bubble-content"></div></div>'),i=$("#bubble-box")),r=$("#bubble-content").html(t),r.find(".cancel").on("click",function(){return $("#bubble-box").remove(),$(".bubble-popuped").removeClass("bubble-popuped")}),_.each(n,function(e,t){return r.find(t).on("click",e)}),a=e.offset(),f=e.innerWidth(),u=e.innerHeight(),l=i.width(),o=i.height(),a.top+u+o-document.documentElement.scrollTop>window.innerHeight?(s.top=a.top-o-15,i.addClass("bubble-top")):(s.top=a.top+u+15,i.addClass("bubble-bottom")),s.left=a.left-(l-f)/2,i.css(s).show(),e.addClass("bubble-popuped")},e}),define("UI.select2",["jquery"],function(){function c(e){var t=$(document.createTextNode(""));e.before(t),t.before(e),t.remove()}function h(e){function t(e){return l[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function p(e,t){var n=0,r=t.length;for(;n<r;n+=1)if(v(e,t[n]))return n;return-1}function d(){var e=$(f);e.appendTo("body");var t={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),t}function v(e,t){return e===t?!0:e===undefined||t===undefined?!1:e===null||t===null?!1:e.constructor===String?e+""==t+"":t.constructor===String?t+""==e+"":!1}function m(e,t){var n,r,i;if(e===null||e.length<1)return[];n=e.split(t);for(r=0,i=n.length;r<i;r+=1)n[r]=$.trim(n[r]);return n}function g(e){return e.outerWidth(!1)-e.width()}function y(e){var t="keyup-change-value";e.on("keydown",function(){$.data(e,t)===undefined&&$.data(e,t,e.val())}),e.on("keyup",function(){var n=$.data(e,t);n!==undefined&&e.val()!==n&&($.removeData(e,t),e.trigger("keyup-change"))})}function b(e){e.on("mousemove",function(e){var t=o;(t===undefined||t.x!==e.pageX||t.y!==e.pageY)&&$(e.target).trigger("mousemove-filtered",e)})}function w(e,t,n){n=n||undefined;var r;return function(){var i=arguments;window.clearTimeout(r),r=window.setTimeout(function(){t.apply(n,i)},e)}}function E(e,t){var n=w(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){p(e.target,t.get())>=0&&n(e)})}function S(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],n=e.val().length,r;e.focus();var i=t.offsetWidth>0||t.offsetHeight>0;i&&t===document.activeElement&&(t.setSelectionRange?t.setSelectionRange(n,n):t.createTextRange&&(r=t.createTextRange(),r.collapse(!1),r.select()))},0)}function x(e){e=$(e)[0];var t=0,n=0;if("selectionStart"in e)t=e.selectionStart,n=e.selectionEnd-t;else if("selection"in document){e.focus();var r=document.selection.createRange();n=document.selection.createRange().text.length,r.moveStart("character",-e.value.length),t=r.text.length-n}return{offset:t,length:n}}function T(e){e.preventDefault(),e.stopPropagation()}function N(e){e.preventDefault(),e.stopImmediatePropagation()}function C(e){if(!s){var t=e[0].currentStyle||window.getComputedStyle(e[0],null);s=$(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:t.fontSize,fontFamily:t.fontFamily,fontStyle:t.fontStyle,fontWeight:t.fontWeight,letterSpacing:t.letterSpacing,textTransform:t.textTransform,whiteSpace:"nowrap"}),s.attr("class","select2-sizer"),$("body").append(s)}return s.text(e.val()),s.width()}function k(e,t,n){var r,i=[],s;r=e.attr("class"),r&&(r=""+r,$(r.split(" ")).each2(function(){this.indexOf("select2-")===0&&i.push(this)})),r=t.attr("class"),r&&(r=""+r,$(r.split(" ")).each2(function(){this.indexOf("select2-")!==0&&(s=n(this),s&&i.push(s))})),e.attr("class",i.join(" "))}function L(e,t,n,r){var i=h(e.toUpperCase()).indexOf(h(t.toUpperCase())),s=t.length;if(i<0){n.push(r(e));return}n.push(r(e.substring(0,i))),n.push("<span class='select2-match'>"),n.push(r(e.substring(i,i+s))),n.push("</span>"),n.push(r(e.substring(i+s,e.length)))}function A(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function O(e){var t,n=null,r=e.quietMillis||100,i=e.url,s=this;return function(o){window.clearTimeout(t),t=window.setTimeout(function(){var t=e.data,r=i,u=e.transport||$.fn.select2.ajaxDefaults.transport,a={type:e.type||"GET",cache:e.cache||!1,jsonpCallback:e.jsonpCallback||undefined,dataType:e.dataType||"json"},f=$.extend({},$.fn.select2.ajaxDefaults.params,a);t=t?t.call(s,o.term,o.page,o.context):null,r=typeof r=="function"?r.call(s,o.term,o.page,o.context):r,n&&typeof n.abort=="function"&&n.abort(),e.params&&($.isFunction(e.params)?$.extend(f,e.params.call(s)):$.extend(f,e.params)),$.extend(f,{url:r,dataType:e.dataType,data:t,success:function(t){var n=e.results(t,o.page);o.callback(n)}}),n=u.call(s,f)},r)}}function M(e){var t=e,n,r,i=function(e){return""+e.text};$.isArray(t)&&(r=t,t={results:r}),$.isFunction(t)===!1&&(r=t,t=function(){return r});var s=t();return s.text&&(i=s.text,$.isFunction(i)||(n=s.text,i=function(e){return e[n]})),function(e){var n=e.term,r={results:[]},s;if(n===""){e.callback(t());return}s=function(t,r){var o,u;t=t[0];if(t.children){o={};for(u in t)t.hasOwnProperty(u)&&(o[u]=t[u]);o.children=[],$(t.children).each2(function(e,t){s(t,o.children)}),(o.children.length||e.matcher(n,i(o),t))&&r.push(o)}else e.matcher(n,i(t),t)&&r.push(t)},$(t().results).each2(function(e,t){s(t,r.results)}),e.callback(r)}}function _(e){var t=$.isFunction(e);return function(n){var r=n.term,i={results:[]},s=t?e(n):e;$.isArray(s)&&($(s).each(function(){var e=this.text!==undefined,t=e?this.text:this;(r===""||n.matcher(r,t))&&i.results.push(e?this:{id:this,text:this})}),n.callback(i))}}function D(e,t){if($.isFunction(e))return!0;if(!e)return!1;if(typeof e=="string")return!0;throw new Error(t+" must be a string, function, or falsy value")}function P(e){if($.isFunction(e)){var t=Array.prototype.slice.call(arguments,1);return e.apply(null,t)}return e}function H(e){var t=0;return $.each(e,function(e,n){n.children?t+=H(n.children):t++}),t}function B(e,t,n,r){var i=e,s=!1,o,u,a,f,l;if(!r.createSearchChoice||!r.tokenSeparators||r.tokenSeparators.length<1)return undefined;for(;;){u=-1;for(a=0,f=r.tokenSeparators.length;a<f;a++){l=r.tokenSeparators[a],u=e.indexOf(l);if(u>=0)break}if(u<0)break;o=e.substring(0,u),e=e.substring(u+l.length);if(o.length>0){o=r.createSearchChoice.call(this,o,t);if(o!==undefined&&o!==null&&r.id(o)!==undefined&&r.id(o)!==null){s=!1;if(!r.allowDuplicate)for(a=0,f=t.length;a<f;a++)if(v(r.id(o),r.id(t[a]))){s=!0;break}s||n(o)}}}if(i!==e)return e}function j(){var e=this;Array.prototype.forEach.call(arguments,function(t){e[t].remove(),e[t]=null})}function F(e,t){var n=function(){};return n.prototype=new e,n.prototype.constructor=n,n.prototype.parent=e.prototype,n.prototype=$.extend(n.prototype,t),n}typeof $.fn.each2=="undefined"&&$.extend($.fn,{each2:function(e){var t=$([0]),n=-1,r=this.length;while(++n<r&&(t.context=t[0]=this[n])&&e.call(t[0],n,t)!==!1);return this}});if(window.Select2!==undefined)return;var e,t,n,r,i,s,o={x:0,y:0},u,a,e={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,COMMA:188,isArrow:function(t){t=t.which?t.which:t;switch(t){case e.LEFT:case e.RIGHT:case e.UP:case e.DOWN:return!0}return!1},isControl:function(t){var n=t.which;switch(n){case e.SHIFT:case e.CTRL:case e.ALT:return!0}return t.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},f="<div class='select2-measure-scrollbar'></div>",l={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z"};u=$(document),i=function(){var e=1;return function(){return e++}}(),u.on("mousemove",function(e){o.x=e.pageX,o.y=e.pageY}),t=F(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(e){var t,n,r=".select2-results";this.opts=e=this.prepareOpts(e),this.id=e.id,e.element.data("select2")!==undefined&&e.element.data("select2")!==null&&e.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=$("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible"),this.containerId="s2id_"+(e.element.attr("id")||"autogen"+i()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",e.element.attr("title")),this.body=$("body"),k(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",e.element.attr("style")),this.container.css(P(e.containerCss)),this.container.addClass(P(e.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",T),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),k(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(P(e.dropdownCssClass)),this.dropdown.data("select2",this),this.dropdown.on("click",T),this.results=t=this.container.find(r),this.search=n=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",T),b(this.results),this.dropdown.on("mousemove-filtered",r,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",r,this.bind(function(e){this._touchEvent=!0,this.highlightUnderEvent(e)})),this.dropdown.on("touchmove",r,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",r,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(e){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),E(80,this.results),this.dropdown.on("scroll-debounced",r,this.bind(this.loadMoreIfNeeded)),$(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),$(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),$.fn.mousewheel&&t.mousewheel(function(e,n,r,i){var s=t.scrollTop();i>0&&s-i<=0?(t.scrollTop(0),T(e)):i<0&&t.get(0).scrollHeight-t.scrollTop()+i<=t.height()&&(t.scrollTop(t.get(0).scrollHeight-t.height()),T(e))}),y(n),n.on("keyup-change input paste",this.bind(this.updateResults)),n.on("focus",function(){n.addClass("select2-focused")}),n.on("blur",function(){n.removeClass("select2-focused")}),this.dropdown.on("mouseup",r,this.bind(function(e){$(e.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(e),this.selectHighlighted(e))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()}),this.nextSearchTerm=undefined,$.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),e.maximumInputLength!==null&&this.search.attr("maxlength",e.maximumInputLength);var s=e.element.prop("disabled");s===undefined&&(s=!1),this.enable(!s);var o=e.element.prop("readonly");o===undefined&&(o=!1),this.readonly(o),a=a||d(),this.autofocus=e.element.prop("autofocus"),e.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",e.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,t=e.data("select2");this.close(),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),t!==undefined&&(t.container.remove(),t.liveRegion.remove(),t.dropdown.remove(),e.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show()),j.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){if(e.is("option"))return{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:v(e.attr("locked"),"locked")||v(e.data("locked"),!0)};if(e.is("optgroup"))return{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}},prepareOpts:function(e){var t,n,r,s,o=this;t=e.element,t.get(0).tagName.toLowerCase()==="select"&&(this.select=n=e.element),n&&$.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in e)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),e=$.extend({},{populateResults:function(t,n,r){var s,u=this.opts.id,a=this.liveRegion;s=function(t,n,f){var l,c,h,p,d,v,m,g,y,b;t=e.sortResults(t,n,r);for(l=0,c=t.length;l<c;l+=1)h=t[l],d=h.disabled===!0,p=!d&&u(h)!==undefined,v=h.children&&h.children.length>0,m=$("<li></li>"),m.addClass("select2-results-dept-"+f),m.addClass("select2-result"),m.addClass(p?"select2-result-selectable":"select2-result-unselectable"),d&&m.addClass("select2-disabled"),v&&m.addClass("select2-result-with-children"),m.addClass(o.opts.formatResultCssClass(h)),m.attr("role","presentation"),g=$(document.createElement("div")),g.addClass("select2-result-label"),g.attr("id","select2-result-label-"+i()),g.attr("role","option"),b=e.formatResult(h,g,r,o.opts.escapeMarkup),b!==undefined&&(g.html(b),m.append(g)),v&&(y=$("<ul></ul>"),y.addClass("select2-result-sub"),s(h.children,y,f+1),m.append(y)),m.data("select2-data",h),n.append(m);a.text(e.formatMatches(t.length))},s(n,t,0)}},$.fn.select2.defaults,e),typeof e.id!="function"&&(r=e.id,e.id=function(e){return e[r]});if($.isArray(e.element.data("select2Tags"))){if("tags"in e)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+e.element.attr("id");e.tags=e.element.data("select2Tags")}n?(e.query=this.bind(function(e){var n={results:[],more:!1},r=e.term,i,s,u;u=function(t,n){var i;t.is("option")?e.matcher(r,t.text(),t)&&n.push(o.optionToData(t)):t.is("optgroup")&&(i=o.optionToData(t),t.children().each2(function(e,t){u(t,i.children)}),i.children.length>0&&n.push(i))},i=t.children(),this.getPlaceholder()!==undefined&&i.length>0&&(s=this.getPlaceholderOption(),s&&(i=i.not(s))),i.each2(function(e,t){u(t,n.results)}),e.callback(n)}),e.id=function(e){return e.id}):"query"in e||("ajax"in e?(s=e.element.data("ajax-url"),s&&s.length>0&&(e.ajax.url=s),e.query=O.call(e.element,e.ajax)):"data"in e?e.query=M(e.data):"tags"in e&&(e.query=_(e.tags),e.createSearchChoice===undefined&&(e.createSearchChoice=function(e){return{id:$.trim(e),text:$.trim(e)}}),e.initSelection===undefined&&(e.initSelection=function(t,n){var r=[];$(m(t.val(),e.separator)).each(function(){var t={id:this,text:this},n=e.tags;$.isFunction(n)&&(n=n()),$(n).each(function(){if(v(this.id,t.id))return t=this,!1}),r.push(t)}),n(r)})));if(typeof e.query!="function")throw"query function not defined for Select2 "+e.element.attr("id");if(e.createSearchChoicePosition==="top")e.createSearchChoicePosition=function(e,t){e.unshift(t)};else if(e.createSearchChoicePosition==="bottom")e.createSearchChoicePosition=function(e,t){e.push(t)};else if(typeof e.createSearchChoicePosition!="function")throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return e},monitorSource:function(){var e=this.opts.element,t,n;e.on("change.select2",this.bind(function(e){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),t=this.bind(function(){var t=e.prop("disabled");t===undefined&&(t=!1),this.enable(!t);var n=e.prop("readonly");n===undefined&&(n=!1),this.readonly(n),k(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(P(this.opts.containerCssClass)),k(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(P(this.opts.dropdownCssClass))}),e.length&&e[0].attachEvent&&e.each(function(){this.attachEvent("onpropertychange",t)}),n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,n!==undefined&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new n(function(e){e.forEach(t)}),this.propertyObserver.observe(e.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(e){var t=$.Event("select2-selecting",{val:this.id(e),object:e});return this.opts.element.trigger(t),!t.isDefaultPrevented()},triggerChange:function(e){e=e||{},e=$.extend({},e,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(e),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===undefined&&(e=!0);if(this._enabled===e)return;this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface()},disable:function(){this.enable(!1)},readonly:function(e){e===undefined&&(e=!1);if(this._readonly===e)return;this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface()},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var e=this.dropdown,t=this.container.offset(),n=this.container.outerHeight(!1),r=this.container.outerWidth(!1),i=e.outerHeight(!1),s=$(window),o=s.width(),u=s.height(),f=s.scrollLeft()+o,l=s.scrollTop()+u,c=t.top+n,h=t.left,p=c+i<=l,d=t.top-i>=s.scrollTop(),v=e.outerWidth(!1),m=h+v<=f,g=e.hasClass("select2-drop-above"),y,b,w,E,S;g?(b=!0,!d&&p&&(w=!0,b=!1)):(b=!1,!p&&d&&(w=!0,b=!0)),w&&(e.hide(),t=this.container.offset(),n=this.container.outerHeight(!1),r=this.container.outerWidth(!1),i=e.outerHeight(!1),f=s.scrollLeft()+o,l=s.scrollTop()+u,c=t.top+n,h=t.left,v=e.outerWidth(!1),m=h+v<=f,e.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(S=$(".select2-results",e)[0],e.addClass("select2-drop-auto-width"),e.css("width",""),v=e.outerWidth(!1)+(S.scrollHeight===S.clientHeight?0:a.width),v>r?r=v:v=r,i=e.outerHeight(!1),m=h+v<=f):this.container.removeClass("select2-drop-auto-width"),this.body.css("position")!=="static"&&(y=this.body.offset(),c-=y.top,h-=y.left),m||(h=t.left+this.container.outerWidth(!1)-v),E={left:h,width:r},b?(E.top=t.top-i,E.bottom="auto",this.container.addClass("select2-drop-above"),e.addClass("select2-drop-above")):(E.top=c,E.bottom="auto",this.container.removeClass("select2-drop-above"),e.removeClass("select2-drop-above")),E=$.extend(E,P(this.opts.dropdownCss)),e.css(E)},shouldOpen:function(){var e;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(e=$.Event("select2-opening"),this.opts.element.trigger(e),!e.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){var e=this.containerEventName,t="scroll."+e,n="resize."+e,r="orientationchange."+e,i;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),i=$("#select2-drop-mask"),i.length==0&&(i=$(document.createElement("div")),i.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),i.hide(),i.appendTo(this.body),i.on("mousedown touchstart click",function(e){c(i);var t=$("#select2-drop"),n;t.length>0&&(n=t.data("select2"),n.opts.selectOnBlur&&n.selectHighlighted({noFocus:!0}),n.close(),e.preventDefault(),e.stopPropagation())})),this.dropdown.prev()[0]!==i[0]&&this.dropdown.before(i),$("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),i.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var s=this;this.container.parents().add(window).each(function(){$(this).on(n+" "+t+" "+r,function(e){s.opened()&&s.positionDropdown()})})},close:function(){if(!this.opened())return;var e=this.containerEventName,t="scroll."+e,n="resize."+e,r="orientationchange."+e;this.container.parents().add(window).each(function(){$(this).off(t).off(n).off(r)}),this.clearDropdownAlignmentPreference(),$("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger($.Event("select2-close"))},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return P(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var e=this.results,t,n,r,i,s,o,u;n=this.highlight();if(n<0)return;if(n==0){e.scrollTop(0);return}t=this.findHighlightableChoices().find(".select2-result-label"),r=$(t[n]),i=r.offset().top+r.outerHeight(!0),n===t.length-1&&(u=e.find("li.select2-more-results"),u.length>0&&(i=u.offset().top+u.outerHeight(!0))),s=e.offset().top+e.outerHeight(!0),i>s&&e.scrollTop(e.scrollTop()+(i-s)),o=r.offset().top-e.offset().top,o<0&&r.css("display")!="none"&&e.scrollTop(e.scrollTop()+o)},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(e){var t=this.findHighlightableChoices(),n=this.highlight();while(n>-1&&n<t.length){n+=e;var r=$(t[n]);if(r.hasClass("select2-result-selectable")&&!r.hasClass("select2-disabled")&&!r.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(e){var t=this.findHighlightableChoices(),n,r;if(arguments.length===0)return p(t.filter(".select2-highlighted")[0],t.get());e>=t.length&&(e=t.length-1),e<0&&(e=0),this.removeHighlight(),n=$(t[e]),n.addClass("select2-highlighted"),this.search.attr("aria-activedescendant",n.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(n.text()),r=n.data("select2-data"),r&&this.opts.element.trigger({type:"select2-highlight",val:this.id(r),choice:r})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(e){var t=$(e.target).closest(".select2-result-selectable");if(t.length>0&&!t.is(".select2-highlighted")){var n=this.findHighlightableChoices();this.highlight(n.index(t))}else t.length==0&&this.removeHighlight()},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n,r=this.resultsPage+1,i=this,s=this.search.val(),o=this.context;if(t.length===0)return;n=t.offset().top-e.offset().top-e.height(),n<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:s,page:r,context:o,matcher:this.opts.matcher,callback:this.bind(function(n){if(!i.opened())return;i.opts.populateResults.call(this,e,n.results,{term:s,page:r,context:o}),i.postprocessResults(n,!1,!1),n.more===!0?(t.detach().appendTo(e).text(P(i.opts.formatLoadMore,r+1)),window.setTimeout(function(){i.loadMoreIfNeeded()},10)):t.remove(),i.positionDropdown(),i.resultsPage=r,i.context=n.context,this.opts.element.trigger({type:"select2-loaded",items:n})})}))},tokenize:function(){},updateResults:function(e){function l(){t.removeClass("select2-active"),s.positionDropdown(),n.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?s.liveRegion.text(n.text()):s.liveRegion.text(s.opts.formatMatches(n.find(".select2-result-selectable").length))}function c(e){n.html(e),l()}var t=this.search,n=this.results,r=this.opts,i,s=this,o,u=t.val(),a=$.data(this.container,"select2-last-term"),f;if(e!==!0&&a&&v(u,a))return;$.data(this.container,"select2-last-term",u);if(e!==!0&&(this.showSearchInput===!1||!this.opened()))return;f=++this.queryCount;var h=this.getMaximumSelectionSize();if(h>=1){i=this.data();if($.isArray(i)&&i.length>=h&&D(r.formatSelectionTooBig,"formatSelectionTooBig")){c("<li class='select2-selection-limit'>"+P(r.formatSelectionTooBig,h)+"</li>");return}}if(t.val().length<r.minimumInputLength){D(r.formatInputTooShort,"formatInputTooShort")?c("<li class='select2-no-results'>"+P(r.formatInputTooShort,t.val(),r.minimumInputLength)+"</li>"):c(""),e&&this.showSearch&&this.showSearch(!0);return}if(r.maximumInputLength&&t.val().length>r.maximumInputLength){D(r.formatInputTooLong,"formatInputTooLong")?c("<li class='select2-no-results'>"+P(r.formatInputTooLong,t.val(),r.maximumInputLength)+"</li>"):c("");return}r.formatSearching&&this.findHighlightableChoices().length===0&&c("<li class='select2-searching'>"+P(r.formatSearching)+"</li>"),t.addClass("select2-active"),this.removeHighlight(),o=this.tokenize(),o!=undefined&&o!=null&&t.val(o),this.resultsPage=1,r.query({element:r.element,term:t.val(),page:this.resultsPage,context:null,matcher:r.matcher,callback:this.bind(function(i){var o;if(f!=this.queryCount)return;if(!this.opened()){this.search.removeClass("select2-active");return}this.context=i.context===undefined?null:i.context,this.opts.createSearchChoice&&t.val()!==""&&(o=this.opts.createSearchChoice.call(s,t.val(),i.results),o!==undefined&&o!==null&&s.id(o)!==undefined&&s.id(o)!==null&&$(i.results).filter(function(){return v(s.id(this),s.id(o))}).length===0&&this.opts.createSearchChoicePosition(i.results,o));if(i.results.length===0&&D(r.formatNoMatches,"formatNoMatches")){var u=P(r.formatNoMatches,t.val());u&&c("<li class='select2-no-results'>"+u+"</li>");return}n.empty(),s.opts.populateResults.call(this,n,i.results,{term:t.val(),page:this.resultsPage,context:null}),i.more===!0&&D(r.formatLoadMore,"formatLoadMore")&&(n.append("<li class='select2-more-results'>"+s.opts.escapeMarkup(P(r.formatLoadMore,this.resultsPage))+"</li>"),window.setTimeout(function(){s.loadMoreIfNeeded()},10)),this.postprocessResults(i,e,undefined,this.opts.allowDuplicate),l(),this.opts.element.trigger({type:"select2-loaded",items:i})})})},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){S(this.search)},selectHighlighted:function(e){if(this._touchMoved){this.clearTouchMoved();return}var t=this.highlight(),n=this.results.find(".select2-highlighted"),r=n.closest(".select2-result").data("select2-data");r?(this.highlight(t),this.onSelect(r,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==undefined?e.text():undefined)},getPlaceholderOption:function(){if(this.select){var e=this.select.children("option").first();if(this.opts.placeholderOption!==undefined)return this.opts.placeholderOption==="first"&&e||typeof this.opts.placeholderOption=="function"&&this.opts.placeholderOption(this.select);if($.trim(e.text())===""&&e.val()==="")return e}},initContainerWidth:function(){function e(){var e,t,n,r,i,s;if(this.opts.width==="off")return null;if(this.opts.width==="element")return this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px";if(this.opts.width==="copy"||this.opts.width==="resolve"){e=this.opts.element.attr("style");if(e!==undefined){t=e.split(";");for(r=0,i=t.length;r<i;r+=1){s=t[r].replace(/\s/g,""),n=s.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i);if(n!==null&&n.length>=1)return n[1]}}return this.opts.width==="resolve"?(e=this.opts.element.css("width"),e.indexOf("%")>0?e:this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px"):null}return $.isFunction(this.opts.width)?this.opts.width():this.opts.width}var t=e.call(this);t!==null&&this.container.css("width",t)}}),n=F(t,{createContainer:function(){var e=$(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'></ul>","</div>"].join(""));return e},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var e,t,n;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),e=this.search.get(0),e.createTextRange?(t=e.createTextRange(),t.collapse(!1),t.select()):e.setSelectionRange&&(n=this.search.val().length,e.setSelectionRange(n,n))),this.search.val()===""&&this.nextSearchTerm!=undefined&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger($.Event("select2-open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){$("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),j.call(this,"selection","focusser")},initContainer:function(){var t,n=this.container,r=this.dropdown,s=i(),o;this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=n.find(".select2-choice"),this.focusser=n.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+s),this.focusser.attr("aria-labelledby","select2-chosen-"+s),this.results.attr("id","select2-results-"+s),this.search.attr("aria-owns","select2-results-"+s),this.focusser.attr("id","s2id_autogen"+s),o=$("label[for='"+this.opts.element.attr("id")+"']"),this.focusser.prev().text(o.text()).attr("for",this.focusser.attr("id"));var u=this.opts.element.attr("title");this.opts.element.attr("title",u||o.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text($("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(t){if(!this.isInterfaceEnabled())return;if(t.which===e.PAGE_UP||t.which===e.PAGE_DOWN){T(t);return}switch(t.which){case e.UP:case e.DOWN:this.moveHighlight(t.which===e.UP?-1:1),T(t);return;case e.ENTER:this.selectHighlighted(),T(t);return;case e.TAB:this.selectHighlighted({noFocus:!0});return;case e.ESC:this.cancel(t),T(t);return}})),this.search.on("blur",this.bind(function(e){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(t){if(!this.isInterfaceEnabled())return;if(t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC)return;if(this.opts.openOnEnter===!1&&t.which===e.ENTER){T(t);return}if(t.which==e.DOWN||t.which==e.UP||t.which==e.ENTER&&this.opts.openOnEnter){if(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey)return;this.open(),T(t);return}if(t.which==e.DELETE||t.which==e.BACKSPACE){this.opts.allowClear&&this.clear(),T(t);return}})),y(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){e.stopPropagation();if(this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){if(!this.isInterfaceEnabled())return;this.clear(),N(e),this.close(),this.selection.focus()})),t.on("mousedown touchstart",this.bind(function(e){c(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),T(e)})),r.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),t.on("focus",this.bind(function(e){T(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger($.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(e){var t=this.selection.data("select2-data");if(t){var n=$.Event("select2-clearing");this.opts.element.trigger(n);if(n.isDefaultPrevented())return;var r=this.getPlaceholderOption();this.opts.element.val(r?r.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),e!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}))}},initSelection:function(){var e;if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var t=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==undefined&&e!==null&&(t.updateSelection(e),t.close(),t.setPlaceholder(),t.nextSearchTerm=t.opts.nextSearchTerm(e,t.search.val()))})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()===undefined?!1:(e=this.getPlaceholderOption())!==undefined&&e.prop("selected")||this.opts.element.val()===""||this.opts.element.val()===undefined||this.opts.element.val()===null},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments),t=this;return e.element.get(0).tagName.toLowerCase()==="select"?e.initSelection=function(e,n){var r=e.find("option").filter(function(){return this.selected&&!this.disabled});n(t.optionToData(r))}:"data"in e&&(e.initSelection=e.initSelection||function(t,n){var r=t.val(),i=null;e.query({matcher:function(t,n,s){var o=v(r,e.id(s));return o&&(i=s),o},callback:$.isFunction(n)?function(){n(i)}:$.noop})}),e},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===undefined?undefined:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==undefined){if(this.select&&this.getPlaceholderOption()===undefined)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var r=0,i=this,s=!0;this.findHighlightableChoices().each2(function(e,t){if(v(i.id(t.data("select2-data")),i.opts.element.val()))return r=e,!1}),n!==!1&&(t===!0&&r>=0?this.highlight(r):this.highlight(0));if(t===!0){var o=this.opts.minimumResultsForSearch;o>=0&&this.showSearch(H(e.results)>=o)}},showSearch:function(e){if(this.showSearchInput===e)return;this.showSearchInput=e,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!e),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!e),$(this.dropdown,this.container).toggleClass("select2-with-searchbox",e)},onSelect:function(e,t){if(!this.triggerSelect(e))return;var n=this.opts.element.val(),r=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.close(),(!t||!t.noFocus)&&this.opts.shouldFocusInput(this)&&this.focusser.focus(),v(n,this.id(e))||this.triggerChange({added:e,removed:r})},updateSelection:function(e){var t=this.selection.find(".select2-chosen"),n,r;this.selection.data("select2-data",e),t.empty(),e!==null&&(n=this.opts.formatSelection(e,t,this.opts.escapeMarkup)),n!==undefined&&t.append(n),r=this.opts.formatSelectionCssClass(e,t),r!==undefined&&t.addClass(r),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==undefined&&this.container.addClass("select2-allowclear")},val:function(){var e,t=!1,n=null,r=this,i=this.data();if(arguments.length===0)return this.opts.element.val();e=arguments[0],arguments.length>1&&(t=arguments[1]);if(this.select)this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return n=r.optionToData(t),!1}),this.updateSelection(n),this.setPlaceholder(),t&&this.triggerChange({added:n,removed:i});else{if(!e&&e!==0){this.clear(t);return}if(this.opts.initSelection===undefined)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){r.opts.element.val(e?r.id(e):""),r.updateSelection(e),r.setPlaceholder(),t&&r.triggerChange({added:e,removed:i})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var t,n=!1;if(arguments.length===0)return t=this.selection.data("select2-data"),t==undefined&&(t=null),t;arguments.length>1&&(n=arguments[1]),e?(t=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),n&&this.triggerChange({added:e,removed:t})):this.clear(n)}}),r=F(t,{createContainer:function(){var e=$(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'></ul>","</div>"].join(""));return e},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments),t=this;return e.element.get(0).tagName.toLowerCase()==="select"?e.initSelection=function(e,n){var r=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,n){r.push(t.optionToData(n))}),n(r)}:"data"in e&&(e.initSelection=e.initSelection||function(t,n){var r=m(t.val(),e.separator),i=[];e.query({matcher:function(t,n,s){var o=$.grep(r,function(t){return v(t,e.id(s))}).length;return o&&i.push(s),o},callback:$.isFunction(n)?function(){var t=[];for(var s=0;s<r.length;s++){var o=r[s];for(var u=0;u<i.length;u++){var a=i[u];if(v(o,e.id(a))){t.push(a),i.splice(u,1);break}}}n(t)}:$.noop})}),e},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");if(!t.length||!e||e[0]!=t[0])t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e))},destroy:function(){$("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),j.call(this,"searchContainer","selection")},initContainer:function(){var t=".select2-choices",n;this.searchContainer=this.container.find(".select2-search-field"),this.selection=n=this.container.find(t);var r=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(e){r.search[0].focus(),r.selectChoice($(this))}),this.search.attr("id","s2id_autogen"+i()),this.search.prev().text($("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){if(!this.isInterfaceEnabled())return;this.opened()||this.open()})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(t){if(!this.isInterfaceEnabled())return;++this.keydowns;var r=n.find(".select2-search-choice-focus"),i=r.prev(".select2-search-choice:not(.select2-locked)"),s=r.next(".select2-search-choice:not(.select2-locked)"),o=x(this.search);this.opts.selectOnComma&&t.which==e.COMMA&&(t.which=e.ENTER);if(!(!r.length||t.which!=e.LEFT&&t.which!=e.RIGHT&&t.which!=e.BACKSPACE&&t.which!=e.DELETE&&t.which!=e.ENTER)){var u=r;t.which==e.LEFT&&i.length?u=i:t.which==e.RIGHT?u=s.length?s:null:t.which===e.BACKSPACE?this.unselect(r.first())&&(this.search.width(10),u=i.length?i:s):t.which==e.DELETE?this.unselect(r.first())&&(this.search.width(10),u=s.length?s:null):t.which==e.ENTER&&(u=null),this.selectChoice(u),T(t),(!u||!u.length)&&this.open();return}if((t.which===e.BACKSPACE&&this.keydowns==1||t.which==e.LEFT)&&o.offset==0&&!o.length){this.selectChoice(n.find(".select2-search-choice:not(.select2-locked)").last()),T(t);return}this.selectChoice(null);if(this.opened())switch(t.which){case e.UP:case e.DOWN:this.moveHighlight(t.which===e.UP?-1:1),T(t);return;case e.ENTER:this.selectHighlighted(),T(t);return;case e.TAB:this.selectHighlighted({noFocus:!0}),this.close();return;case e.ESC:this.cancel(t),T(t);return}if(t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.BACKSPACE||t.which===e.ESC)return;if(t.which===e.ENTER){if(this.opts.openOnEnter===!1)return;if(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey)return}this.open(),(t.which===e.PAGE_UP||t.which===e.PAGE_DOWN)&&T(t),t.which===e.ENTER&&T(t)})),this.search.on("keyup",this.bind(function(e){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger($.Event("select2-blur"))})),this.container.on("click",t,this.bind(function(e){if(!this.isInterfaceEnabled())return;if($(e.target).closest(".select2-search-choice").length>0)return;this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()})),this.container.on("focus",t,this.bind(function(){if(!this.isInterfaceEnabled())return;this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder()})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){var e;this.opts.element.val()===""&&this.opts.element.text()===""&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||this.opts.element.val()!==""){var t=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==undefined&&e!==null&&(t.updateSelection(e),t.close(),t.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),t=this.getMaxSearchWidth();e!==undefined&&this.getVal().length===0&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(t>0?t:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.search.val()===""&&this.nextSearchTerm!=undefined&&(this.search.val(this.nextSearchTerm),this.search.select()),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger($.Event("select2-open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(e){var t=[],n=[],r=this;$(e).each(function(){p(r.id(this),t)<0&&(t.push(r.id(this)),n.push(this))}),e=n,this.selection.find(".select2-search-choice").remove(),$(e).each(function(){r.addSelectedChoice(this)}),r.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),e!=null&&e!=undefined&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){if(!this.triggerSelect(e))return;this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.clearSearch(),this.updateResults(),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(e,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.nextSearchTerm!=undefined&&(this.search.val(this.nextSearchTerm),this.updateResults(),this.search.select()),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),(!t||!t.noFocus)&&this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(e){var t=!e.locked,n=$("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'>x</a></li>"),r=$("<li class='select2-search-choice select2-locked'><div></div></li>"),i=t?n:r,s=this.id(e),o=this.getVal(),u,a;u=this.opts.formatSelection(e,i.find("div"),this.opts.escapeMarkup),u!=undefined&&i.find("div").replaceWith("<div>"+u+"</div>"),a=this.opts.formatSelectionCssClass(e,i.find("div")),a!=undefined&&i.addClass(a),t&&i.find(".select2-search-choice-close").on("mousedown",T).on("click dblclick",this.bind(function(e){if(!this.isInterfaceEnabled())return;this.unselect($(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),T(e),this.close(),this.focusSearch()})).on("focus",this.bind(function(){if(!this.isInterfaceEnabled())return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active")})),i.data("select2-data",e),i.insertBefore(this.searchContainer),o.push(s),this.setVal(o)},unselect:function(e){var t=this.getVal(),n,r;e=e.closest(".select2-search-choice");if(e.length===0)throw"Invalid argument: "+e+". Must be .select2-search-choice";n=e.data("select2-data");if(!n)return;var i=$.Event("select2-removing");i.val=this.id(n),i.choice=n,this.opts.element.trigger(i);if(i.isDefaultPrevented())return!1;while((r=p(this.id(n),t))>=0)t.splice(r,1),this.setVal(t),this.select&&this.postprocessResults();return e.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}),!0},postprocessResults:function(e,t,n,r){var i=this.getVal(),s=this.results.find(".select2-result"),o=this.results.find(".select2-result-with-children"),u=this;r||s.each2(function(e,t){var n=u.id(t.data("select2-data"));p(n,i)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),o.each2(function(e,t){!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0&&t.addClass("select2-selected")}),this.highlight()==-1&&n!==!1&&u.highlight(0),!this.opts.createSearchChoice&&!s.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&this.results.find(".select2-no-results").length===0)&&D(u.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+P(u.opts.formatNoMatches,u.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-g(this.search)},resizeSearch:function(){var e,t,n,r,i,s=g(this.search);e=C(this.search)+10,t=this.search.offset().left,n=this.selection.width(),r=this.selection.offset().left,i=n-(t-r)-s,i<e&&(i=n-s),i<40&&(i=n-s),i<=0&&(i=e),this.search.width(Math.floor(i))},getVal:function(){var e;return this.select?(e=this.select.val(),e===null?[]:e):(e=this.opts.element.val(),m(e,this.opts.separator))},setVal:function(e){var t;this.select?this.select.val(e):(t=[],$(e).each(function(){p(this,t)<0&&t.push(this)}),this.opts.element.val(t.length===0?"":t.join(this.opts.separator)))},buildChangeDetails:function(e,t){var t=t.slice(0),e=e.slice(0);for(var n=0;n<t.length;n++)for(var r=0;r<e.length;r++)v(this.opts.id(t[n]),this.opts.id(e[r]))&&(t.splice(n,1),n>0&&n--,e.splice(r,1),r--);return{added:t,removed:e}},val:function(e,t){var n,r=this;if(arguments.length===0)return this.getVal();n=this.data(),n.length||(n=[]);if(!e&&e!==0){this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),t&&this.triggerChange({added:this.data(),removed:n});return}this.setVal(e);if(this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),t&&this.triggerChange(this.buildChangeDetails(n,this.data()));else{if(this.opts.initSelection===undefined)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(e){var i=$.map(e,r.id);r.setVal(i),r.updateSelection(e),r.clearSearch(),t&&r.triggerChange(r.buildChangeDetails(n,r.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var e=[],t=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){e.push(t.opts.id($(this).data("select2-data")))}),this.setVal(e),this.triggerChange()},data:function(e,t){var n=this,r,i;if(arguments.length===0)return this.selection.children(".select2-search-choice").map(function(){return $(this).data("select2-data")}).get();i=this.data(),e||(e=[]),r=$.map(e,function(e){return n.opts.id(e)}),this.setVal(r),this.updateSelection(e),this.clearSearch(),t&&this.triggerChange(this.buildChangeDetails(i,this.data()))}}),$.fn.select2=function(){var e=Array.prototype.slice.call(arguments,0),t,n,r,i,s,o=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],u=["opened","isFocused","container","dropdown"],a=["val","data"],f={search:"externalSearch"};return this.each(function(){if(e.length===0||typeof e[0]=="object")t=e.length===0?{}:$.extend({},e[0]),t.element=$(this),t.element.get(0).tagName.toLowerCase()==="select"?s=t.element.prop("multiple"):(s=t.multiple||!1,"tags"in t&&(t.multiple=s=!0)),n=s?new window.Select2["class"].multi:new window.Select2["class"].single,n.init(t);else{if(typeof e[0]!="string")throw"Invalid arguments to select2 plugin: "+e;if(p(e[0],o)<0)throw"Unknown method: "+e[0];i=undefined,n=$(this).data("select2");if(n===undefined)return;r=e[0],r==="container"?i=n.container:r==="dropdown"?i=n.dropdown:(f[r]&&(r=f[r]),i=n[r].apply(n,e.slice(1)));if(p(e[0],u)>=0||p(e[0],a)>=0&&e.length==1)return!1}}),i===undefined?this:i},$.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,r){var i=[];return L(e.text,n.term,i,r),i.join("")},formatSelection:function(e,t,n){return e?n(e.text):undefined},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(e,t){return undefined},formatMatches:function(e){return e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" or more character"+(n==1?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(n==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results…"},formatSearching:function(){return"Searching…"},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==undefined?null:e.id},matcher:function(e,t){return h(""+t).toUpperCase().indexOf(h(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:B,escapeMarkup:A,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null},nextSearchTerm:function(e,t){return undefined},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){var t="ontouchstart"in window||navigator.msMaxTouchPoints>0;return t?e.opts.minimumResultsForSearch<0?!1:!0:!0}},$.fn.select2.ajaxDefaults={transport:$.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:O,local:M,tags:_},util:{debounce:w,markMatch:L,escapeMarkup:A,stripDiacritics:h},"class":{"abstract":t,single:n,multi:r}}}),define("ui/ui",function(){});