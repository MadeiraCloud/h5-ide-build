define("wspace/awseditor/template/TplRightPanel",["handlebars"],function(e){var t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<button class="HideOEPanelRight tooltip sidebar-hider icon-caret-right" data-tooltip=\''+o(n.i18n.call(t,"RES_TIP_TOGGLE_RESOURCE_PANEL",{hash:{},data:i}))+'\'></button>\n<nav class="sidebar-title">\n  <button id="btn-switch-property">'+o(n.i18n.call(t,"PROP.LBL_PROPERTY",{hash:{},data:i}))+'</button>\n  <button id="btn-switch-state">'+o(n.i18n.call(t,"PROP.LBL_STATE",{hash:{},data:i}))+' <b class="count"></b></button>\n</nav>\n\n<div class="sub-property">\n  <section class="property-panel-wrapper property-first-panel">\n    <header class="property-sidebar-title truncate property-title"></header>\n    <div class="scroll-wrap scrollbar-auto-hide">\n      <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n      <div class="scroll-content property-content property-details"></div>\n    </div>\n  </section>\n\n  <section class="property-panel-wrapper property-second-panel">\n    <div class="property-sidebar-title">\n      <button class="back icon-btn-back HideSecondPanel tooltip"></button><span class="truncate property-second-title"></span>\n    </div>\n    <div class="scroll-wrap scrollbar-auto-hide">\n      <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n      <div class="scroll-content property-content"></div>\n    </div>\n  </section>\n</div>\n<div class="sub-stateeditor"></div>',s};return e.template(t)}),define("wspace/awseditor/property/base/main",["event"],function(e){var t,n,r,i,s,o,u,a,f,l,c,h;return n=null,r=null,i=null,s=null,f=[].slice,e.onLongListen("all",function(e){var t,r;if((!n||!n.ideEvents)&&(!i||!i.ideEvents))return;return n&&n.ideEvents&&n.ideEvents.hasOwnProperty(e)&&(t=f.call(arguments,1),r=n.ideEvents[e],_.isString(r)&&(r=n[r]),r.apply(n,t)),i&&i.ideEvents&&i.ideEvents.hasOwnProperty(e)&&(t||(t=f.call(arguments,1)),r=i.ideEvents[e],_.isString(r)&&(r=i[r]),r.apply(i,t)),null}),u={},a=[],u.DEFAULT_TYPE="default",o={},t=function(){return this.type=t.TYPE.Stack,null},t.TYPE=t.prototype.TYPE={Stack:"Stack",App:"App",AppEdit:"AppEdit"},t.prototype.loadSubPanel=function(e,t){return c(o[e],e,t,n.type)},t.extend=function(e,n){var r,i,s,f,l,c,h;s=Backbone.Model.extend.call(t,e,n),i=new s;if(i.subPanelID)return o[i.subPanelID]=i,s;e.handleTypes===""?r=[u.DEFAULT_TYPE]:_.isString(e.handleTypes)||!e.handleTypes.hasOwnProperty("length")?r=[e.handleTypes]:r=e.handleTypes;for(c=0,h=r.length;c<h;c++){f=r[c];if(!f.hasOwnProperty("length")){a.push({regexp:f,prop:i});continue}f.indexOf(">")&&(l=f.split(">"),l.length===2&&l[1].length>0&&(u[l[1]+">"+l[0]]=i)),u[f]=i}return s},t.prototype.activeModule=function(){return n},t.prototype.activeSubModule=function(){return i},t.activeModule=t.prototype.activeModule,t.activeSubModule=t.prototype.activeSubModule,t.loadSubPanel=t.prototype.loadSubPanel,t.load=function(e,t,n,r){var i,s;return s=l(e,t,n),i=c(s,e,t,n,r),i!==!0?(i===!1?e="Missing_Resource":(e="",void 0),s=l(e,t,n),c(s,e,t,n,r)):!0},l=function(e,t,n){var r,i,s,o,f;e||(e=u.DEFAULT_TYPE),r=e,i=u[e],i||(r=n+":"+e,i=u[r]);if(!i&&e.indexOf(!1))for(o=0,f=a.length;o<f;o++){s=a[o];if(e.match(s.regexp)){r=s.regexp,i=s.prop;break}}if(!i)return;return i.handle=r,i},c=function(e,o,u,a,f){var l,c;if(!e)return!1;e.type=a,l="init"+e.type;if(!e[l])return;e.uid=u,c=e[l].call(e,u);if(c===!1)return;l="setup"+e.type,e[l]&&(e[l].call(e),e[l]=null),e.subPanelID?(i=e,s=o):(i=null,s=null,n=e,r=o);if(e.model.init){e.model.clear({silent:!0});if(e.model.init(u)===!1)return!1}return h(f,e.model),e.view.model=e.model,e.view._isSub=!!e.subPanelID,e.view.__restore=t.__restore,t.__restore=!1,e.subPanelID?e.view._loadAsSub(e.subPanelID):e.view._load(),l="afterLoad"+e.type,e[l]&&e[l].call(e),!0},h=function(e,t){},t.onUnloadSubPanel=function(){return n.onUnloadSubPanel&&n.onUnloadSubPanel(i.subPanelID),i=null,s=null,null},t.snapshot=function(){return{activeModuleId:n.uid,activeModuleType:r,activeSubModuleId:i?i.uid:null,activeSubModuleType:s,tab_type:n.type}},t.restore=function(e,n){return t.load(e.activeModuleType,e.activeModuleId,e.tab_type,!0),e.activeSubModuleType&&(t.__restore=!0,t.loadSubPanel(e.activeSubModuleType,e.activeSubModuleId,!0),t.__restore=!1),null},t}),define("wspace/awseditor/property/base/model",["backbone","Design","constant"],function(e,t,n){var r;return r=e.Model.extend({init:function(){return null},setName:function(e){var n;return n=this.get("uid"),void 0,t.instance().component(n).setName(e),this.set("name",e),null},setDesc:function(e){var n;return n=this.get("uid"),void 0,t.instance().component(n).setDesc(e)}}),r}),define("wspace/awseditor/property/stack/model",["../base/model","constant","Design"],function(e,t,n){var r;return r=e.extend({init:function(){var e,r,i,s;return r=n.instance(),r.get("name")?(e=r.get("agent"),this.set({name:r.get("name").replace(/\s+/g,""),id:r.get("id"),usage:r.get("usage"),description:r.get("description"),type:"EC2 VPC",region:t.REGION_SHORT_LABEL[r.region()],isApp:this.isApp,isAppEdit:this.isAppEdit,isStack:this.isStack,isImport:r.modeIsAppView(),isResDiff:r.get("resource_diff"),opsEnable:e.enabled}),n.instance().opsModel().isMesos()&&(i={isMesos:!0,marathonOn:this.getMarathon()},this.set(i)),s=n.modelClassForType(t.RESTYPE.VPC).theVPC(),s&&this.set("vpcid",s.get("appId")),this.getNetworkACL(),this.isStack&&this.set("isStack",!0),this.set(n.instance().getCost()),this.set("currency",n.instance().getCurrency()),null):null},createAcl:function(){var e;return e=n.modelClassForType(t.RESTYPE.ACL),(new e).id},getNetworkACL:function(){var e,r,i;return e=n.modelClassForType(t.RESTYPE.ACL),i=[],r=null,_.each(e.allObjects(),function(e){return function(t){var n,s;return s=!0,e.isApp?s=!1:t.isDefault()?s=!1:e.isAppEdit&&(s=!t.get("appId")),n={uid:t.id,name:t.get("name"),rule:t.getRuleCount(),association:t.getAssoCount(),deletable:s},t.isDefault()?r=n:i.splice(_.sortedIndex(i,n,"name"),0,n),null}}(this)),r&&i.splice(0,0,r),this.set("networkAcls",i),null},removeAcl:function(e){return n.instance().component(e).remove(),this.getNetworkACL(),null},updateStackName:function(e){this.set("name",e),n.instance().set("name",e)},updateDescription:function(e){this.set("description",e),n.instance().set("description",e)},setMarathon:function(e){return n.modelClassForType(t.RESTYPE.MESOSMASTER).setMarathon(e)},getMarathon:function(){return n.modelClassForType(t.RESTYPE.MESOSMASTER).getMarathon()}}),new r});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/property/base/view",["constant","i18n!/nls/lang.js","backbone","jquery","handlebars","UI.selectbox","UI.notification","UI.multiinputbox","UI.modal","UI.selectbox","MC.validate","UI.parsley","UI.tooltip","UI.sortable","UI.tablist"],function(e,t){var n,r,i;return i=[],r=[],n=Backbone.View.extend({__addToTrash:function(e){if(__indexOf.call(i,e)<0)return i.push(e)},__clearTrash:function(){var e,t,n;for(t=0,n=i.length;t<n;t++)e=i[t],_.isObject(e)&&e.remove&&e.__removeSubView();return i=[],this},__removeSubView:function(){var e,t,n;for(t=0,n=r.length;t<n;t++)e=r[t],_.isObject(e)&&_.isFunction(e.remove)&&e.remove();return r=[]},addSubView:function(e){if(__indexOf.call(r,e)<0)return r.push(e)},setTitle:function(e){$("#OEPanelRight").find(this._isSub?".property-second-title":".property-title").text(e)},prependTitle:function(e){$("#OEPanelRight").find(this._isSub?".property-second-title":".property-title").prepend(e)},forceShow:function(){return $("#OEPanelRight").trigger("FORCE_SHOW"),null},disabledAllOperabilityArea:function(e){var t;if(e){if($("#OpsEditor").children(".disabled-event-layout").length)return;return t='<div class="disabled-event-layout"></div>',$("#OpsEditor").append(t),$("#tabbar-wrapper").append(t)}return $(".disabled-event-layout").remove()},_load:function(){var e,t;return this.__clearTrash(),this.__addToTrash(this),t=$("#OEPanelRight").find(".property-first-panel").find(".property-details"),e=$("<div class='scroll-content property-content property-details'></div>").insertAfter(t),t.empty().remove(),this._resetImmediatelySection(),this.setElement(e),this.render(),this.focusImportantInput(),null},_resetImmediatelySection:function(){return $(".apply-immediately-section").remove(),$(".property-panel-wrapper").removeClass("immediately")},_loadAsSub:function(e){var t;return this.__restore?$("#OEPanelRight").trigger("OPEN_SUBPANEL_IMM"):$("#OEPanelRight").trigger("OPEN_SUBPANEL"),this.setElement($("#OEPanelRight").find(".property-second-panel .property-content")),this.render(),t=this,setTimeout(function(){return t.focusImportantInput()},200),null},_render:function(){var t,n,r;r=this._originalRender(),selectbox.init();if(!_.isString(r))return r;n=this.model.get("uid");if(n){t=Design.instance().component(n);if(t&&(t.type===e.RESTYPE.SG||t.type===e.RESTYPE.DBINSTANCE))return null}return this.setTitle(r),null},focusImportantInput:function(){var e,t;return t=this,e=t.$el.find("input[data-empty-remove]").filter(function(){return!this.value.length}),e.length&&setTimeout(function(){return t.forceShow(),e.focus(),t.disabledAllOperabilityArea(!0)},0),null}}),n.extend=function(e,t){return e.render&&(e._originalRender=e.render,e.render=n.prototype._render),Backbone.View.extend.call(this,e,t)},n}),define("wspace/awseditor/property/stack/template/stack",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n        ",i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+='\n        <dl class="dl-horizontal dl-region-type property-control-group">\n            <dt>'+u(n.i18n.call(e,"PROP.STACK_LBL_REGION",{hash:{},data:t}))+"</dt>\n            <dd>"+u((i=e&&e.region,typeof i===a?i.apply(e):i))+"</dd>\n            <dt>"+u(n.i18n.call(e,"PROP.STACK_LBL_TYPE",{hash:{},data:t}))+"</dt>\n            <dd>"+u((i=e&&e.type,typeof i===a?i.apply(e):i))+"</dd>\n            <dt>"+u(n.i18n.call(e,"PROP.APP_LBL_ID",{hash:{},data:t}))+"</dt>\n            <dd>"+u((i=e&&e.id,typeof i===a?i.apply(e):i))+"</dd>\n            ",i=n["if"].call(e,e&&e.isApp,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+="\n        </dl>\n\n        ",i=n["if"].call(e,e&&e.isApp,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;r+="\n\n        ",i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;r+="\n\n        ",i=n["if"].call(e,e&&e.isMesos,{hash:{},inverse:f.noop,fn:f.program(17,w,t),data:t});if(i||i===0)r+=i;return r+="\n\n\n    ",r}function c(e,t){var r="",i;return r+='\n            <section class="property-control-group" data-bind="true">\n                <label class="left" for="property-app-name">'+u(n.i18n.call(e,"PROP.APP_LBL_NAME",{hash:{},data:t}))+'</label>\n                <input class="input" type="text" data-ignore="true" data-required-rollback="true" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'"\n                       id="property-app-name">\n            </section>\n        ',r}function h(e,t){var r="",i;r+="\n                ",i=n["if"].call(e,e&&e.usage,{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;return r+="\n                <dt>"+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+"</dt>\n                <dd>"+u((i=e&&e.description,typeof i===a?i.apply(e):i))+"</dd>\n            ",r}function p(e,t){var r="",i;return r+="\n                    <dt>"+u(n.i18n.call(e,"PROP.STACK_LBL_USAGE",{hash:{},data:t}))+"</dt>\n                    <dd>"+u((i=e&&e.usage,typeof i===a?i.apply(e):i))+"</dd>\n                ",r}function d(e,t){var r="",i;r+='\n            <dl class="dl-vertical">\n                <dt><label>'+u(n.i18n.call(e,"PROP.APP_LBL_INSTANCE_STATE",{hash:{},data:t}))+"</label></dt>\n                ",i=n["if"].call(e,e&&e.opsEnable,{hash:{},inverse:f.program(10,m,t),fn:f.program(8,v,t),data:t});if(i||i===0)r+=i;r+="\n                <dt><label>"+u(n.i18n.call(e,"PROP.APP_LBL_RESDIFF_VIEW",{hash:{},data:t}))+"</label></dt>\n                ",i=n["if"].call(e,e&&e.isResDiff,{hash:{},inverse:f.program(10,m,t),fn:f.program(8,v,t),data:t});if(i||i===0)r+=i;return r+="\n            </dl>\n\n        ",r}function v(e,t){var r="";return r+="\n                    <dd>"+u(n.i18n.call(e,"PROP.LBL_ENABLED",{hash:{},data:t}))+"</dd>\n                ",r}function m(e,t){var r="";return r+="\n                    <dd>"+u(n.i18n.call(e,"PROP.LBL_DISABLED",{hash:{},data:t}))+"</dd>\n                ",r}function g(e,t){var r="",i;r+="\n            ",i=n["if"].call(e,e&&e.usage,{hash:{},inverse:f.noop,fn:f.program(13,y,t),data:t});if(i||i===0)r+=i;r+='\n            <section class="property-control-group" data-bind="true">\n                <label for="property-stack-description">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n                <textarea name="" id="property-stack-description" cols="30" rows="7">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+'</textarea>\n            </section>\n            <section class="property-control-group resdiff-switch">\n                <div class="checkbox">\n                    <input id="property-app-resdiff" type="checkbox" name="resdiff" ',i=n["if"].call(e,e&&e.isResDiff,{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+=' >\n                    <label for="property-app-resdiff"></label>\n                </div>\n                <label for="property-app-resdiff">'+u(n.i18n.call(e,"PROP.APP_LBL_RESDIFF",{hash:{},data:t}))+'</label>\n                <i class="icon-info tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.APP_TIP_RESDIFF",{hash:{},data:t}))+'"></i>\n            </section>\n        ',r}function y(e,t){var r="";return r+='\n                <section class="property-control-group" data-bind="true">\n                    <label for="property-app-usage">'+u(n.i18n.call(e,"PROP.STACK_LBL_USAGE",{hash:{},data:t}))+'</label>\n                    <div class="clear">\n                        <div id="property-app-usage" class="selectbox">\n                            <div class="selection"><i class="icon-app-type-testing"></i>Testing</div>\n                            <ul class="dropdown" tabindex="-1">\n                                <li class="selected item" data-value="testing"><i class="icon-app-type-testing"></i>Testing</li>\n                                <li class="item" data-value="development"><i class="icon-app-type-development"></i>Development</li>\n                                <li class="item" data-value="production"><i class="icon-app-type-production"></i>Production</li>\n                                <li class="item" data-value="others"><i class="icon-app-type-others" data-value="testing"></i>Others</li>\n                                <li class="item" data-value="custom"><i class="icon-app-type-custom" data-value="custom"></i>Custom</li>\n                            </ul>\n                        </div>\n                        <input type="text" class="input custom-app-usage" placeholder="custom" maxlength="32" data-required-rollback="true" />\n                    </div>\n                </section>\n            ',r}function b(e,t){return"checked"}function w(e,t){var r="",i;r+='\n            <div class="option-group-head expand">Mesos Settings</div>\n            <div class="option-group">\n                <!--',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(18,E,t),data:t});if(i||i===0)r+=i;return r+='-->\n                <section id="mesos-data-area">\n                </section>\n            </div>\n        ',r}function E(e,t){var r="",i;r+='\n                    <section class="property-control-group" data-bind="true">\n                        <div class="mesos-marathon-switch">\n                            <img class="marathon-mark-img" src="/assets/images/ide/marathon.png" alt="">\n                            <span>Marathon</span>\n                            <label class="switch toolbar-visual-ops-switch marathon-switch narrow ',i=n["if"].call(e,e&&e.marathonOn,{hash:{},inverse:f.noop,fn:f.program(19,S,t),data:t});if(i||i===0)r+=i;return r+='">\n                                <span class="switch-handle"></span>\n                            </label>\n                        </div>\n                    </section>\n                ',r}function S(e,t){return"on"}function x(e,t){var r="",i;r+='\n        <section class="property-control-group" data-bind="true">\n            <label class="left" for="property-stack-name">'+u(n.i18n.call(e,"PROP.STACK_LBL_NAME",{hash:{},data:t}))+'</label>\n            <input class="input" type="text" data-ignore="true" data-required-rollback="true" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'"\n                   id="property-stack-name">\n        </section>\n        <section class="property-control-group" data-bind="true">\n            <label for="property-stack-description">'+u(n.i18n.call(e,"PROP.STACK_LBL_DESCRIPTION",{hash:{},data:t}))+'</label>\n            <textarea name="" id="property-stack-description" cols="30" rows="7">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+'</textarea>\n        </section>\n        <dl class="dl-horizontal dl-region-type property-control-group">\n            <dt><label>'+u(n.i18n.call(e,"PROP.STACK_LBL_REGION",{hash:{},data:t}))+"</label></dt>\n            <dd>"+u((i=e&&e.region,typeof i===a?i.apply(e):i))+"</dd>\n            <dt><label>"+u(n.i18n.call(e,"PROP.STACK_LBL_TYPE",{hash:{},data:t}))+"</label></dt>\n            <dd>"+u((i=e&&e.type,typeof i===a?i.apply(e):i))+"</dd>\n            <dt><label>"+u(n.i18n.call(e,"PROP.STACK_LBL_ID",{hash:{},data:t}))+"</label></dt>\n            <dd>"+u((i=e&&e.id,typeof i===a?i.apply(e):i))+"</dd>\n        </dl>\n\n        <!-- Mesos Settings -->\n        ",i=n["if"].call(e,e&&e.isMesos,{hash:{},inverse:f.noop,fn:f.program(22,T,t),data:t});if(i||i===0)r+=i;return r+="\n\n    ",r}function T(e,t){var r="",i;r+='\n            <section class="property-control-group" data-bind="true">\n                <div class="mesos-marathon-switch">\n                    <img class="marathon-mark-img" src="/assets/images/ide/marathon.png" alt=""> <span>Marathon</span>\n                    <label class="switch toolbar-visual-ops-switch marathon-switch narrow ',i=n["if"].call(e,e&&e.marathonOn,{hash:{},inverse:f.noop,fn:f.program(19,S,t),data:t});if(i||i===0)r+=i;return r+='">\n                        <span class="switch-handle"></span>\n                    </label>\n                </div>\n            </section>\n        ',r}function N(e,t){var r="",i;r+='\n        <div class="option-group-head pos-r">'+u(n.i18n.call(e,"PROP.STACK_TIT_ACL",{hash:{},data:t}))+'<span\n                class="acl-info-list-num property-head-num-wrap">('+u((i=(i=e&&e.networkAcls,i==null||i===!1?i:i.length),typeof i===a?i.apply(e):i))+')</span>\n        </div>\n        <div class="option-group">\n            <ul class="acl-sg-info-list acl-info-list mega-list-wraper" id="stack-property-acl-list"></ul>\n            ',i=n.unless.call(e,e&&e.isApp,{hash:{},inverse:f.noop,fn:f.program(25,C,t),data:t});if(i||i===0)r+=i;return r+="\n        </div>\n    ",r}function C(e,t){var r="";return r+='<a href="#" class="add-to-list"\n                                id="stack-property-new-acl">'+u(n.i18n.call(e,"PROP.STACK_BTN_CREATE_NEW_ACL",{hash:{},data:t}))+"</a>",r}function k(e,t){var r="",i;r+=u((i=e&&e.currency,typeof i===a?i.apply(e):i))+u((i=e&&e.totalFee,typeof i===a?i.apply(e):i))+"\n            /",i=n.i18n.call(e,"PROP.STACK_LBL_COST_CYCLE",{hash:{},data:t});if(i||i===0)r+=i;return r+=" ",r}function L(e,t){var n="",r;return n+="\n                <tr>\n                    <td>"+u((r=e&&e.resource,typeof r===a?r.apply(e):r))+"</td>\n                    <td>"+u((r=e&&e.type,typeof r===a?r.apply(e):r))+"</td>\n                    <td>"+u((r=e&&e.formatedFee,typeof r===a?r.apply(e):r))+"</td>\n                </tr>\n            ",n}function A(e,t){var r="";return r+='\n    <div class="option-group-head expand">\n        '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n    </div>\n    <div class="option-group">\n        <div class="tags-action">\n            <button class="btn open-tag-manager modal-confirm btn-blue tag-manager-global">'+u(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>\n        </div>\n    </div>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+="<article>\n\n    ",o=n.unless.call(t,t&&t.isStack,{hash:{},inverse:f.program(21,x,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n\n\n\n    <!-- SG, ACL, COST -->\n    <div class="option-group-head">'+u(n.i18n.call(t,"PROP.STACK_TIT_SG",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span\n            id="property-head-sg-num"></span>)</span></div>\n    <div class="option-group sg-group"></div>\n\n\n    ',o=n["if"].call(t,t&&t.networkAcls,{hash:{},inverse:f.noop,fn:f.program(24,N,i),data:i});if(o||o===0)s+=o;s+='\n\n\n    <div class="option-group-head">\n        '+u(n.i18n.call(t,"PROP.STACK_TIT_COST_ESTIMATION",{hash:{},data:i}))+'\n        <span class="cost-counter right">',o=n["if"].call(t,t&&t.totalFee,{hash:{},inverse:f.noop,fn:f.program(27,k,i),data:i});if(o||o===0)s+=o;s+='</span>\n    </div>\n    <div class="option-group">\n        <table class="table cost-estimation-table">\n            <thead>\n            <tr>\n                <th>'+u(n.i18n.call(t,"PROP.STACK_COST_COL_RESOURCE",{hash:{},data:i}))+'</th>\n                <th style="min-width:70px;">'+u(n.i18n.call(t,"PROP.STACK_COST_COL_SIZE_TYPE",{hash:{},data:i}))+'</th>\n                <th style="min-width:60px;">'+u(n.i18n.call(t,"PROP.STACK_COST_COL_FEE",{hash:{},data:i}))+"</th>\n            </tr>\n            </thead>\n            <tbody> ",o=n.each.call(t,t&&t.costList,{hash:{},inverse:f.noop,fn:f.program(29,L,i),data:i});if(o||o===0)s+=o;s+=' </tbody>\n\n        </table>\n        <div class="property-control-group tac">\n            <a target="_blank" href="http://aws.amazon.com/ec2/pricing/" class="goto-outsite tac"\n               target="_blank">'+u(n.i18n.call(t,"PROP.STACK_LBL_AWS_EC2_PRICING",{hash:{},data:i}))+"</a>\n        </div>\n    </div>\n\n    ",o=n.unless.call(t,t&&t.isApp,{hash:{},inverse:f.noop,fn:f.program(31,A,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>",s},n.main=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n    <dl class="dl-vertical">\n        <dt>Framework</dt>\n        <dd>'+u(n.emptyStr.call(e,e&&e.framework,{hash:{},data:t}))+'</dd>\n        <dt>Mesos Leader UI</dt>\n        <dd><a target="_blank" href="http://'+u((i=e&&e.leaderIp,typeof i===o?i.apply(e):i))+":"+u((i=e&&e.leaderPort,typeof i===o?i.apply(e):i))+'">'+u((i=e&&e.leaderIp,typeof i===o?i.apply(e):i))+":"+u((i=e&&e.leaderPort,typeof i===o?i.apply(e):i))+"</a></dd>\n        ",i=n["if"].call(e,e&&e.framework,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+="\n    </dl>\n",r}function l(e,t){var n="",r;return n+='\n            <dt>Marathon Leader UI</dt>\n            <dd><a target="_blank" href="http://'+u((r=e&&e.marathonIp,typeof r===o?r.apply(e):r))+":"+u((r=e&&e.marathonPort,typeof r===o?r.apply(e):r))+'">'+u((r=e&&e.marathonIp,typeof r===o?r.apply(e):r))+":"+u((r=e&&e.marathonPort,typeof r===o?r.apply(e):r))+"</a>\n            </dd>\n        ",n}function c(e,t){return'\n    <dl class="dl-vertical">\n        <dt>Mesos Data is not ready yet...</dt>\n    </dl>\n'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n["if"].call(t,t&&t.leaderIp,{hash:{},inverse:a.program(4,c,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.mesosData=e.template(t),n}),define("wspace/awseditor/property/stack/template/acl",["handlebars"],function(e){var t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='<li data-uid="'+u((i=e&&e.uid,typeof i===o?i.apply(e):i))+'">\n<div class="col2">\n	<div class="col2-1 truncate">'+u((i=e&&e.name,typeof i===o?i.apply(e):i))+'</div>\n	<div class="col2-2 truncate">'+u((i=e&&e.rule,typeof i===o?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP.STACK_ACL_LBL_RULE",{hash:{},data:t}))+", "+u((i=e&&e.association,typeof i===o?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP.STACK_ACL_LBL_ASSOC",{hash:{},data:t}))+" ",i=n["if"].call(e,e&&e.deletable,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+=' </div>\n</div>\n<div class="col3 edit icon-btn-details tooltip" data-tooltip=\''+u(n.i18n.call(e,"PROP.STACK_ACL_TIP_DETAIL",{hash:{},data:t}))+"' ></div>\n</li>",r}function l(e,t){var r="",i;return r+=' | <a class="sg-list-delete-btn" data-name="'+u((i=e&&e.name,typeof i===o?i.apply(e):i))+'" data-count="'+u((i=e&&e.association,typeof i===o?i.apply(e):i))+'">'+u(n.i18n.call(e,"PROP.STACK_ACL_BTN_DELETE",{hash:{},data:t}))+"</a>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.networkAcls,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""};return e.template(t)}),define("wspace/awseditor/property/stack/template/sub",["handlebars"],function(e){var t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div style="width:420px">\n   <div class="modal-header">\n      <h3>'+a((o=t&&t.title,typeof o===u?o.apply(t):o))+" "+a(n.i18n.call(t,"PROP.STACK_SNS_SUBSCRIPTION",{hash:{},data:i}))+'</h3>\n      <i class="modal-close">&times;</i>\n   </div>\n   <div class="modal-body" id="property-asg-sns-modal" data-uid='+a((o=t&&t.uid,typeof o===u?o.apply(t):o))+'>\n      <div class="modal-control-group modal-sns-protocol">\n        <label class="label-short">'+a(n.i18n.call(t,"PROP.STACK_SNS_PROTOCOL",{hash:{},data:i}))+'</label>\n        <div class="selectbox">\n          <div class="selection">'+a((o=t&&t.protocol,typeof o===u?o.apply(t):o))+'</div>\n          <ul class="dropdown" tabindex="-1">\n            <li class="item" data-id="https">'+a(n.i18n.call(t,"PROP.STACK_SNS_PROTOCOL_HTTPS",{hash:{},data:i}))+'</li>\n            <li class="item" data-id="http">'+a(n.i18n.call(t,"PROP.STACK_SNS_PROTOCOL_HTTP",{hash:{},data:i}))+'</li>\n            <li class="item" data-id="email">'+a(n.i18n.call(t,"PROP.STACK_SNS_PROTOCOL_EMAIL",{hash:{},data:i}))+'</li>\n            <li class="item" data-id="email-json">'+a(n.i18n.call(t,"PROP.STACK_SNS_PROTOCOL_EMAIL_JSON",{hash:{},data:i}))+'</li>\n            <li class="item" data-id="sms">'+a(n.i18n.call(t,"PROP.STACK_SNS_PROTOCOL_SMS",{hash:{},data:i}))+'</li>\n            <li class="item" data-id="arn">'+a(n.i18n.call(t,"PROP.STACK_SNS_PROTOCOL_APPLICATION",{hash:{},data:i}))+'</li>\n            <li class="item" data-id="sqs">'+a(n.i18n.call(t,"PROP.STACK_SNS_PROTOCOL_AMAZON_SQS",{hash:{},data:i}))+'</li>\n          </ul>\n        </div>\n      </div>\n      <div class="modal-control-group">\n        <label class="label-short" for="property-asg-endpoint">'+a(n.i18n.call(t,"PROP.ENDPOINT",{hash:{},data:i}))+'</label>\n        <div class="property-asg-ep" data-bind="true">\n          <input type="text" class="input" id="property-asg-endpoint" value="'+a((o=t&&t.endpoint,typeof o===u?o.apply(t):o))+'" max-length="255" data-required="true" data-trigger="change">\n        </div>\n      </div>\n\n    </section>\n\n   </div>\n   <div class="modal-footer">\n      <button id="property-asg-sns-done" class="btn btn-blue">'+a(n.i18n.call(t,"PROP.LBL_DONE",{hash:{},data:i}))+'</button>\n      <button class="btn modal-close btn-silver">'+a(n.i18n.call(t,"PROP.LBL_CANCEL",{hash:{},data:i}))+"</button>\n   </div>\n</div>",s};return e.template(t)}),define("wspace/awseditor/property/stack/view",["../base/view","./template/stack","./template/acl","./template/sub","event","UI.modalplus","i18n!/nls/lang.js","constant"],function(e,t,n,r,i,s,o,u){var a;return a=e.extend({events:{"change #property-stack-name":"stackNameChanged","change #property-stack-description":"stackDescriptionChanged","change #property-app-name":"changeAppName","change .custom-app-usage":"changeUsage","click #stack-property-new-acl":"createAcl","click #stack-property-acl-list .edit":"openAcl","click .acl-info-list .sg-list-delete-btn":"deleteAcl","click #property-app-resdiff":"toggleResDiff","click .marathon-switch":"toggleMarathon"},render:function(){var e;return this.model.isApp||this.model.isAppEdit?e="App - "+this.model.get("name"):e="Stack - "+this.model.get("name"),this.$el.html(t.main(this.model.toJSON())),e&&this.setTitle(e),this.refreshACLList(),this.bindAppUsage(),this.model.isAppEdit&&this.$("#property-app-name").parsley("custom",this.checkAppName),this.renderMesosData(),null},renderMesosData:function(e){return e==null&&(e=Design.instance().opsModel().getMesosData()),this.$("#mesos-data-area").html(t.mesosData(_.extend({isAppEdit:this.model.isAppEdit},e.toJSON())))},bindAppUsage:function(){var e,t;return e=this.$el.find("#property-app-usage.selectbox"),e.size()<1?!1:(e.on("OPTION_CHANGE",function(t,n,r){e.toggleClass("custom",r.value==="custom").parent().find("input.custom-app-usage").toggleClass("show",r.value==="custom");if(r.value!=="custom")return Design.instance().set("usage",r.value)}),t=Design.instance().get("usage"),t==="testing"||t==="development"||t==="production"||t==="others"?e.find(".dropdown li.item[data-value='"+t+"']").click():(e.find(".dropdown li.item[data-value='custom']").click(),e.parent().find("input.custom-app-usage").val(t)))},toggleMarathon:function(e){var t,n;return t=$(e.currentTarget),t.toggleClass("on"),n=t.hasClass("on"),this.model.setMarathon(n)},checkAppName:function(e){var t,n;return t=Design.instance(),n=t.project().apps().findWhere({name:e}),n&&n.id!==t.get("id")?o.PROP.MSG_WARN_REPEATED_APP_NAME:null},changeAppName:function(e){var t;t=$(e.currentTarget);if(t.parsley("validate"))return Design.instance().set("name",t.val())},changeUsage:function(e){var t;t=$(e.currentTarget);if(t.parsley("validate"))return Design.instance().set("usage",t.val())},toggleResDiff:function(e){return Design.instance().set("resource_diff",e.currentTarget.checked)},stackDescriptionChanged:function(){var e,t,n;t=$("#property-stack-description"),n=this.model.get("id"),e=t.val();if(t.parsley("validate"))return this.model.updateDescription(e)},stackNameChanged:function(){var e,t,n;n=$("#property-stack-name"),t=this.model.get("id"),e=n.val();if(e===this.model.get("name"))return;return n.parsley("custom",function(t){if(!MC.validate("awsName",t))return o.PARSLEY.SHOULD_BE_A_VALID_STACK_NAME;if(t===Design.instance().__opsModel.get("name"))return;if(!Design.instance().project().stacks().isNameAvailable(t))return sprintf(o.PARSLEY.TYPE_NAME_CONFLICT,"Stack",e)}),n.parsley("validate")&&(this.setTitle("Stack - "+e),this.model.updateStackName(e)),null},refreshACLList:function(){return $(this.el).find(".acl-info-list-num").text("("+this.model.get("networkAcls").length+")"),$("#stack-property-acl-list").html(n(this.model.attributes))},createAcl:function(){return this.trigger("OPEN_ACL",this.model.createAcl())},openAcl:function(e){return this.trigger("OPEN_ACL",$(e.currentTarget).closest("li").attr("data-uid")),null},deleteAcl:function(e){var t,n,r,i,u,a,f;return t=$(e.currentTarget),i=parseInt(t.attr("data-count"),10),r=t.closest("li").attr("data-uid"),i?(f=this,n=t.attr("data-name"),u=MC.template.modalDeleteSGOrACL({title:o.PROP.STACK_DELETE_NETWORK_ACL_TITLE,main_content:sprintf(o.PROP.STACK_DELETE_NETWORK_ACL_CONTENT,n),desc_content:sprintf(o.PROP.STACK_DELETE_NETWORK_ACL_DESC,n)}),a=new s({title:o.PROP.STACK_DELETE_NETWORK_ACL_TITLE,width:420,template:u,confirm:{text:o.PROP.LBL_DELETE,color:"red"}}),a.on("confirm",function(){return f.model.removeAcl(r),f.model.getNetworkACL(),f.refreshACLList(),a.close()})):(this.model.removeAcl(r),this.model.getNetworkACL(),this.refreshACLList())}}),new a}),define("wspace/awseditor/property/sglist/model",["Design","constant"],function(e,t){var n;return n=Backbone.Model.extend({getSGInfoList:function(){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P;u=e.instance(),v=this.parent_model,m=!1,u.modeIsApp()||u.modeIsAppView()?m=!0:u.modeIsAppEdit()&&v.isSGListReadOnly&&(m=v.isSGListReadOnly()),y=this.resId,g=u.component(y),g?(h=g.type===t.RESTYPE.ELB,p=!1,y=g.id):(h=!1,p=!0,y=""),T=[],f={},l=[],n=e.modelClassForType("SgAsso"),P=e.modelClassForType(t.RESTYPE.SG).allObjects();for(C=0,O=P.length;C<O;C++){E=P[C];if(E.isElbSg()&&!h&&!p)continue;a=!1,S=!!n.findExisting(E,g),d=p||!m||S;if(!d)continue;E.isDefault()||m?o=!1:o=!0,c=m||p,s=E.connections("SgAsso");for(k=0,M=s.length;k<M;k++){i=s[k];if(i.connectsTo(y)){f[E.id]=!0,l.push(E);break}}u.opsModel().isMesos()&&E.isMesos()&&(o=!1,a=!0),T.push({uid:E.id,color:E.color,name:E.get("name"),desc:E.get("description"),ruleCount:E.ruleCount(),memberCount:E.getMemberList().length,hideCheck:c,deletable:o,disableCheck:a,used:f[E.id]})}x=[];for(L=0,_=l.length;L<_;L++){N=l[L],b=N.connections("SgRuleSet");for(A=0,D=b.length;A<D;A++)w=b[A],x=x.concat(w.toPlainObjects(N.id))}return r=e.modelClassForType("SgRuleSet"),this.set({is_stack_sg:p,only_one_sg:l.length===1,sg_list:T,sg_length:p?T.length:l.length,readonly:m,sg_rule_list:r.getPlainObjFromRuleSets(x)}),this.sortSGList(),this.sortSGRule(),null},sortSGList:function(){return this.attributes.sg_list=this.attributes.sg_list.sort(function(e,t){if(e.name==="DefaultSG")return-1;if(t.name==="DefaultSG")return 1;if(e.name<t.name)return-1;if(e.name===t.name)return 0;if(e.name>t.name)return 1}),this.attributes.sg_list},sortSGRule:function(e){var t;return t=_.sortBy(this.attributes.sg_rule_list,e||"direction"),this.set("sg_rule_list",t),null},assignSG:function(t,n){var r,i,s;return r=e.modelClassForType("SgAsso"),s=e.instance(),void 0,i=new r(s.component(this.resId),s.component(t)),n===!1&&i.remove(),null},deleteSG:function(t){return e.instance().component(t).remove(),null},isElbSg:function(t){return e.instance().component(t).isElbSg()},getElbNameBySgId:function(n){var r,i,s,o,u;i=e.instance().component(n);if(i.isElbSg()){u=e.modelClassForType(t.RESTYPE.ELB).allObjects();for(s=0,o=u.length;s<o;s++){r=u[s];if(r.getElbSg()===i)return r.get("name")}}return""},createNewSG:function(){var n,r,i,s;return r=e.modelClassForType(t.RESTYPE.SG),s=new r,i=e.instance().component(this.resId),i&&(n=e.modelClassForType("SgAsso"),new n(s,i)),s.id}}),new n}),define("wspace/awseditor/property/sglist/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n<ul class="tab">\n	<li data-tab-target="#item-group" class="active">'+u(n.i18n.call(e,"PROP.SGLIST_TAB_GROUP",{hash:{},data:t}))+'</li>\n	<li data-tab-target="#item-rule">'+u(n.i18n.call(e,"PROP.SGLIST_TAB_RULE",{hash:{},data:t}))+"</li>\n</ul>\n",r}function c(e,t){var r="",i;r+='\n			<li data-uid="'+u((i=e&&e.uid,typeof i===f?i.apply(e):i))+'">\n				',i=n.unless.call(e,e&&e.hideCheck,{hash:{},inverse:a.noop,fn:a.program(4,h,t),data:t});if(i||i===0)r+=i;r+='\n				<div class="col2">\n					<div class="col2-1 truncate"><div class="sg-color" style="background-color:'+u((i=e&&e.color,typeof i===f?i.apply(e):i))+'" ></div><span class="sg-name">'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'</span></div>\n					<div class="col2-2 truncate">'+u((i=e&&e.desc,typeof i===f?i.apply(e):i))+'</div>\n					<div class="col2-3 truncate">'+u((i=e&&e.ruleCount,typeof i===f?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP.SGLIST_LBL_RULE",{hash:{},data:t}))+", "+u((i=e&&e.memberCount,typeof i===f?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP.SGLIST_LBL_MEMBER",{hash:{},data:t})),i=n["if"].call(e,e&&e.deletable,{hash:{},inverse:a.noop,fn:a.program(9,v,t),data:t});if(i||i===0)r+=i;return r+='</div>\n				</div>\n				<div class="col3 sg-edit-icon tooltip icon-btn-details" data-tooltip=\''+u(n.i18n.call(e,"PROP.SGLIST_TIP_VIEW_DETAIL",{hash:{},data:t}))+"'></div>\n			</li>\n			",r}function h(e,t){var r="",i;r+='\n					<div class="checkbox-wrap col1">\n						<div class="checkbox">\n							<input class="sg-list-association-check" type="checkbox" ',i=n["if"].call(e,e&&e.used,{hash:{},inverse:a.noop,fn:a.program(5,p,t),data:t});if(i||i===0)r+=i;r+=' id="sg-list-'+u((i=t==null||t===!1?t:t.index,typeof i===f?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.disableCheck,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;return r+='/>\n							<label for="sg-list-'+u((i=t==null||t===!1?t:t.index,typeof i===f?i.apply(e):i))+'"></label>\n						</div>\n					</div>\n				',r}function p(e,t){return'checked="checked"'}function d(e,t){return"disabled"}function v(e,t){var r="",i;return r+=' | <a class="sg-list-delete-btn" data-name="'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" data-count="'+u((i=e&&e.memberCount,typeof i===f?i.apply(e):i))+'">'+u(n.i18n.call(e,"PROP.SGLIST_LNK_DELETE",{hash:{},data:t}))+"</a>",r}function m(e,t){var r="";return r+='<a href="javascript:void(0)" class="add-to-list" id="add-sg-btn">'+u(n.i18n.call(e,"PROP.SGLIST_BTN_CREATE_NEW_SG",{hash:{},data:t}))+"</a>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";o=n.unless.call(t,t&&t.is_stack_sg,{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n<div class="sg-info-list-tab-content tab-content">\n	<div id="item-group" class="active tab-item pos-r">\n		<ul class="acl-sg-info-list mega-list-wraper" id="sg-info-list">\n			',o=n.each.call(t,t&&t.sg_list,{hash:{},inverse:a.noop,fn:a.program(3,c,i),data:i});if(o||o===0)s+=o;s+="\n		</ul>\n		",o=n.unless.call(t,t&&t.readonly,{hash:{},inverse:a.noop,fn:a.program(11,m,i),data:i});if(o||o===0)s+=o;return s+='\n	</div>\n\n	<div id="item-rule" class="tab-item">\n		<div class="rule-list-sort property-control-group">\n			<label>'+u(n.i18n.call(t,"PROP.SG_RULE_SORT_BY",{hash:{},data:i}))+'</label>\n			<div class="selectbox" id="sg-rule-filter-select">\n				<div class="selection">'+u(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</div>\n				<ul class="dropdown" tabindex="-1">\n					<li class="item selected" data-id="direction">'+u(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</li>\n					<li class="item" data-id="relation">'+u(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_SRC_DEST",{hash:{},data:i}))+'</li>\n					<li class="item" data-id="protocol">'+u(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_PROTOCOL",{hash:{},data:i}))+'</li>\n				</ul>\n			</div>\n		</div>\n		<ul class="mega-list-wraper" id="sglist-rule-list"> </ul>\n	</div>\n</div>',s};return e.template(t)}),define("wspace/awseditor/property/sglist/view",["./template/stack","i18n!/nls/lang.js","UI.modalplus"],function(e,t,n){var r;return r=Backbone.View.extend({events:{"click #sg-info-list .sg-edit-icon":"openSgPanel","click #add-sg-btn":"openSgPanel","click .sg-list-association-check":"assignSGToComp","click .sg-list-delete-btn":"deleteSGFromComp","OPTION_CHANGE #sg-rule-filter-select":"sortSgRule"},render:function(){return this.model.getSGInfoList(),this.setElement($(".sg-group")),this.$el.html(e(this.model.attributes)),$("#sglist-rule-list").html(MC.template.sgRuleList(this.model.attributes.sg_rule_list)),$("#property-head-sg-num").text(this.model.attributes.sg_length)},openSgPanel:function(e){var t;return e.currentTarget.id==="add-sg-btn"?t=this.model.createNewSG():t=$(e.currentTarget).closest("li").attr("data-uid"),this.trigger("OPEN_SG",t)},refreshSGList:function(){return this.render()},assignSGToComp:function(e){var t,n,r,i;return n=$(e.currentTarget),t=n.closest("#sg-info-list").find(":checked"),t.length===0?!1:(i=n.closest("li").attr("data-uid"),r=n.prop("checked"),this.model.assignSG(i,r),this.render(),null)},deleteSGFromComp:function(e){var r,i,s,o,u,a,f,l,c;return l=this,r=$(e.currentTarget),f=r.closest("li").attr("data-uid"),o=Number(r.attr("data-count")),a=r.attr("data-name"),o&&(s=sprintf(t.PROP.SGLIST_DELETE_SG_CONFIRM_TITLE,a),i=sprintf(t.PROP.SGLIST_DELETE_SG_CONFIRM_DESC,a)),s?(c=MC.template.modalDeleteSGOrACL({title:t.PROP.SGLIST_DELETE_SG_TITLE,main_content:s,desc_content:i}),u=new n({title:t.PROP.SGLIST_DELETE_SG_TITLE,width:420,template:c,confirm:{text:t.PROP.LBL_DELETE,color:"red"}}),u.on("confirm",function(){return l.model.deleteSG(f),l.render(),u.close()})):(this.model.deleteSG(f),this.render())},sortSgRule:function(e){var t,n;return t=$("#sglist-rule-list"),n=$(e.target).find(".selected").attr("data-id"),this.model.sortSGRule(n),$("#sglist-rule-list").html(MC.template.sgRuleList(this.model.attributes.sg_rule_list))}}),new r}),define("wspace/awseditor/property/sglist/main",["../base/main","./model","./view"],function(e,t,n){var r,i,s;return n.on("OPEN_SG",function(t){return e.loadSubPanel("SG",t),null}),n.model=t,s=function(){return n.render(),null},r=function(e){return t.parent_model=e,t.resId=e.get("uid")||e.id,n.render(),null},i=function(e){if(e==="SG")return n.render()},{loadModule:r,refresh:s,onUnloadSubPanel:i}}),define("wspace/awseditor/property/stack/main",["../base/main","./model","./view","../sglist/main","event","Design"],function(e,t,n,r,i,s){var o;return n.on("OPEN_ACL",function(t){return e.loadSubPanel("ACL",t),null}),o=e.extend({handleTypes:["Stack","default"],onUnloadSubPanel:function(e){r.onUnloadSubPanel(e);if(e==="ACL")return this.model.getNetworkACL(),this.view.refreshACLList()},initStack:function(e){return this.model=t,this.model.isApp=!1,this.model.isAppEdit=!1,this.model.isStack=!0,this.view=n,null},afterLoadStack:function(){return r.loadModule(this.model),null},initApp:function(e){var r;return this.model=t,this.model.isApp=!0,this.model.isAppEdit=!1,this.model.isStack=!1,this.view=n,r=s.instance().opsModel(),r.isMesos()&&this.view.listenTo(r.getMesosData(),"change",n.renderMesosData),null},afterLoadApp:function(){return r.loadModule(this.model),null},initAppEdit:function(){return this.model=t,this.model.isApp=!1,this.model.isAppEdit=!0,this.model.isStack=!1,this.view=n,null},afterLoadAppEdit:function(){return r.loadModule(this.model),null}}),null}),define("wspace/awseditor/property/instance/model",["../base/model","constant","event","i18n!/nls/lang.js"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var n,r,i,s,o,u,a;return i=Design.instance().component(e),r=i!=null?i.toJSON():void 0,r.uid=e,r.classic_stack=!1,r.can_set_ebs=i.isEbsOptimizedEnabled(),r.instance_type=i.getInstanceTypeList(),r.tenancy=i.isDefaultTenancy(),r.displayCount=r.count-1,r.description=i.get("description"),r.tags=i.tags(),i.isMesos()&&(u={isMesosMaster:i.isMesosMaster(),isMesosSlave:i.isMesosSlave(),mesosAttr:typeof i.getMesosAttributes=="function"?i.getMesosAttributes():void 0,defaultMesosAttr:typeof i.getDefaultMesosAttributes=="function"?i.getDefaultMesosAttributes():void 0},_.extend(r,u)),o=i.getEmbedEni(),r.number_disable=o&&o.connections("RTB_Route").length>0,a=Design.modelClassForType(t.RESTYPE.VPC).allObjects()[0],r.force_tenacy=a&&!a.isDefaultTenancy(),s=Design.instance(),n=s.get("agent"),r.stackAgentEnable=n.enabled,r.userData=i.get("userData"),this.set(r),this.getAmi(),this.getKeyPair(),this.getEni(),null},getKeyPair:function(){var e;return e=Design.instance().component(this.get("uid")).connectionTargets("KeypairUsage")[0],e&&this.set("keypair",e.getKPList()),null},addKP:function(e){var n,r,i,s,o;n=Design.modelClassForType(t.RESTYPE.KP),o=n.allObjects();for(i=0,s=o.length;i<s;i++){r=o[i];if(r.get("name")===e)return!1}return r=new n({name:e}),r.id},setKP:function(e){var t,n;return t=Design.instance(),n=t.component(this.get("uid")),t.component(e).assignTo(n),null},setCount:function(e){return Design.instance().component(this.get("uid")).setCount(e)},setEbsOptimized:function(e){return Design.instance().component(this.get("uid")).set("ebsOptimized",e)},setTenancy:function(e){return Design.instance().component(this.get("uid")).setTenancy(e)},setMonitoring:function(e){return Design.instance().component(this.get("uid")).set("monitoring",e)},setUserData:function(e){return Design.instance().component(this.get("uid")).set("userData",e)},setEniDescription:function(e){return Design.instance().component(this.get("uid")).getEmbedEni().set("description",e)},setSourceCheck:function(e){return Design.instance().component(this.get("uid")).getEmbedEni().set("sourceDestCheck",e)},setPublicIp:function(e){Design.instance().component(this.get("uid")).getEmbedEni().set("assoPublicIp",e);if(e)return Design.modelClassForType(t.RESTYPE.IGW).tryCreateIgw()},getAmi:function(){var e,t,n,r,i,s,o,u;return t=this.get("imageId"),n=Design.instance().component(this.get("uid")),e=n.getAmi(),e?r={name:e.name||e.description||e.id,icon:e.osType+"."+e.architecture+"."+e.rootDeviceType+".png"}:r={name:t+" is not available.",icon:"ami-not-available.png",unavailable:!0},this.set("instance_ami",r),e&&e.blockDeviceMapping&&!$.isEmptyObject(e.blockDeviceMapping)&&(o=e.rootDeviceName,s=e.blockDeviceMapping[o],o&&!s&&_.each(e.blockDeviceMapping,function(e,t){return o.indexOf(t)!==-1&&!s&&(s=e,o=t),null}),i=n.get("rdType"),u={name:o,size:parseInt(n.get("rdSize"),10),iops:n.get("rdIops"),encrypted:s.encrypted,isStandard:i==="standard",isIo1:i==="io1",isGp2:i==="gp2"},u.size<10&&(u.iops="",u.iopsDisabled=!0),this.set("rootDevice",u)),this.set("min_volume_size",n.getAmiRootDeviceVolumeSize()),null},canSetInstanceType:function(e){var t,n,i,s;return i=Design.instance().component(this.get("uid")),n=i.connectionTargets("EniAttachment").length+1,t=i.getInstanceTypeConfig(e),s=t?t.max_eni:2,n<=2||n<=s?!0:sprintf(r.PROP.WARN_EXCEED_ENI_LIMIT,e,s)},setInstanceType:function(e){var t;return t=Design.instance().component(this.get("uid")),t.setInstanceType(e),this.getEni(),t.isEbsOptimizedEnabled()},getEni:function(){var e,t,n;n=Design.instance().component(this.get("uid")),e=n.getEmbedEni();if(!e)return;return t=e.toJSON(),t.ips=e.getIpArray(),t.ips[0].unDeletable=!0,this.set("eni",t),this.set("multi_enis",n.connections("EniAttachment").length>0),null},attachEip:function(e,n){return Design.instance().component(this.get("uid")).getEmbedEni().setIp(e,null,null,n),this.attributes.eni.ips[e].hasEip=n,n&&Design.modelClassForType(t.RESTYPE.IGW).tryCreateIgw(),null},removeIp:function(e){return Design.instance().component(this.get("uid")).getEmbedEni().removeIp(e),null},addIp:function(){var e,t;return e=Design.instance().component(this.get("uid")).getEmbedEni(),e.addIp(),t=e.getIpArray(),t[0].unDeletable=!0,this.get("eni").ips=t,null},isValidIp:function(e){return Design.instance().component(this.get("uid")).getEmbedEni().isValidIp(e)},canAddIP:function(){return Design.instance().component(this.get("uid")).getEmbedEni().canAddIp()},setIp:function(e,t,n){return Design.instance().component(this.get("uid")).getEmbedEni().setIp(e,t,n),null},getStateData:function(){return Design.instance().component(this.get("uid")).getStateData()},setIops:function(e){return Design.instance().component(this.get("uid")).set("rdIops",e),null},setVolumeType:function(e){return Design.instance().component(this.get("uid")).set("rdType",e),null},setVolumeSize:function(e){return Design.instance().component(this.get("uid")).set("rdSize",e),null}}),new i}),define("wspace/awseditor/property/instance/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return"single"}function c(e,t){var r="";return r+='disabled="disabled" data-tooltip="'+u(n.i18n.call(e,"PROP.INSTANCE_TIP_YOU_CANNOT_SPECIFY_INSTANCE_NUMBER",{hash:{},data:t}))+'"',r}function h(e,t){var r="";return r+='data-tooltip="'+u(n.i18n.call(e,"PROP.INSTANCE_TIP_IF_THE_QUANTITY_IS_MORE_THAN_1",{hash:{},data:t}))+'"',r}function p(e,t){return'style="color:red;"'}function d(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left">'+u(n.i18n.call(e,"PROP.INSTANCE_TYPE",{hash:{},data:t}))+'</label>\n			<div class="selectbox selectbox-mega" id="instance-type-select">\n				<div class="selection"></div>\n				<ul class="dropdown"> ',i=n.each.call(e,e&&e.instance_type,{hash:{},inverse:a.noop,fn:a.program(10,v,t),data:t});if(i||i===0)r+=i;return r+=" </ul>\n			</div>\n		</section>\n		",r}function v(e,t){var r="",i;r+='\n					<li class="',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(11,m,t),data:t});if(i||i===0)r+=i;r+='tooltip item" tabindex="-1" data-tooltip="'+u((i=e&&e.main,typeof i===f?i.apply(e):i))+'" data-id="'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.hide,{hash:{},inverse:a.noop,fn:a.program(13,g,t),data:t});if(i||i===0)r+=i;return r+='>\n						<div class="main truncate">'+u((i=e&&e.main,typeof i===f?i.apply(e):i))+'</div>\n						<div class="sub"><span>'+u((i=e&&e.ecu,typeof i===f?i.apply(e):i))+"</span><span>"+u((i=e&&e.core,typeof i===f?i.apply(e):i))+"</span><span>"+u((i=e&&e.mem,typeof i===f?i.apply(e):i))+"</span></div>\n					</li>\n				",r}function m(e,t){return"selected "}function g(e,t){return'style="display:none;"'}function y(e,t){return'checked="checked"'}function b(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left">'+u(n.i18n.call(e,"PROP.INSTANCE_TENANCY",{hash:{},data:t}))+'</label>\n			<div class="selectbox" id="tenancy-select">\n				<div class="selection">',i=n["if"].call(e,e&&e.tenancy,{hash:{},inverse:a.program(20,E,t),fn:a.program(18,w,t),data:t});if(i||i===0)r+=i;r+='</div>\n				<ul class="dropdown" tabindex="-1">\n					',i=n.unless.call(e,e&&e.force_tenacy,{hash:{},inverse:a.noop,fn:a.program(22,S,t),data:t});if(i||i===0)r+=i;r+='\n					<li class="item ',i=n.unless.call(e,e&&e.tenancy,{hash:{},inverse:a.noop,fn:a.program(23,x,t),data:t});if(i||i===0)r+=i;return r+='" data-id="dedicated">'+u(n.i18n.call(e,"PROP.INSTANCE_TENANCY_DELICATED",{hash:{},data:t}))+"</li>\n				</ul>\n			</div>\n		</section>\n		",r}function w(e,t){return"Default"}function E(e,t){return"Dedicated"}function S(e,t){var r="",i;r+='\n					<li class="item ',i=n["if"].call(e,e&&e.tenancy,{hash:{},inverse:a.noop,fn:a.program(23,x,t),data:t});if(i||i===0)r+=i;return r+='" data-id="default">'+u(n.i18n.call(e,"PROP.INSTANCE_TENANCY_DEFAULT",{hash:{},data:t}))+"</li>\n					",r}function x(e,t){return"selected"}function T(e,t){return'\n				<input id="property-instance-enable-cloudwatch" type="checkbox" checked="true" value="None" name="property-instance-enable-cloudwatch" />\n				'}function N(e,t){return'\n				<input id="property-instance-enable-cloudwatch" type="checkbox" value="None" name="property-instance-enable-cloudwatch" />\n				'}function C(e,t){return"hide"}function k(e,t){var r="";return r+='\n			<div class="property-info">'+u(n.i18n.call(e,"PROP.INSTANCE_USERDATA_DISABLED_TO_INSTALL_VISUALOPS",{hash:{},data:t}))+' <a href="'+u(n.i18n.call(e,"PROP.AGENT_USER_DATA_URL",{hash:{},data:t}))+'" target="_blank">'+u(n.i18n.call(e,"PROP.INSTANCE_VIEW_AGENT_USER_DATA_URL_TEXT",{hash:{},data:t}))+"</a>.</div>\n			",r}function L(e,t){var r="",i;return r+='\n			<label for="property-instance-user-data">'+u(n.i18n.call(e,"PROP.INSTANCE_USER_DATA",{hash:{},data:t}))+'</label>\n			<textarea id="property-instance-user-data">'+u((i=e&&e.userData,typeof i===f?i.apply(e):i))+"</textarea>\n			",r}function A(e,t){var r="",i;r+='\n	<div class="option-group-head">'+u(n.i18n.call(e,"PROP.INSTANCE_ROOT_DEVICE",{hash:{},data:t}))+'</div>\n	<div class="option-group">\n    <section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP.VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</label>\n      <div>"+u((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.name),typeof i===f?i.apply(e):i))+'</div>\n    </section>\n    <section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP.VOLUME_SIZE",{hash:{},data:t}))+'</label>\n      <div class="ranged-number-input">\n          <label for="volume-size-ranged"></label>\n          <input id="volume-size-ranged" type="text" class="input" value="'+u((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.size),typeof i===f?i.apply(e):i))+'" name="volume-size-ranged" data-ignore="true" maxlength="5" data-required="true" data-required="true" data-type="number"/>\n      <label for="volume-property-ranged-number" >GB</label>\n      </div>\n    </section>\n\n    <section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP.VOLUME_TYPE",{hash:{},data:t}))+'</label>\n      <div id="volume-type-radios">\n\n      <div>\n      	<div class="radio">\n          <input id="radio-standard" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isStandard),{hash:{},inverse:a.noop,fn:a.program(15,y,t),data:t});if(i||i===0)r+=i;r+=' value="standard"/>\n          <label for="radio-standard"></label>\n        </div>\n        <label for="radio-standard">'+u(n.i18n.call(e,"PROP.VOLUME_TYPE_STANDARD",{hash:{},data:t}))+'</label>\n      </div>\n\n      <div>\n        <div class="radio">\n          <input id="radio-gp2" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isGp2),{hash:{},inverse:a.noop,fn:a.program(15,y,t),data:t});if(i||i===0)r+=i;r+=' value="gp2"/>\n          <label for="radio-gp2"></label>\n        </div>\n        <label for="radio-gp2">'+u(n.i18n.call(e,"PROP.VOLUME_TYPE_GP2",{hash:{},data:t}))+"</label>\n      </div>\n\n      <div ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:a.noop,fn:a.program(36,O,t),data:t});if(i||i===0)r+=i;r+=' data-tooltip="'+u(n.i18n.call(e,"PROP.VOLUME_MSG_WARN",{hash:{},data:t}))+'">\n        <div class="radio">\n          <input id="radio-io1" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isIo1),{hash:{},inverse:a.noop,fn:a.program(15,y,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:a.noop,fn:a.program(38,M,t),data:t});if(i||i===0)r+=i;r+=' value="io1"/>\n          <label for="radio-io1"></label>\n        </div>\n        <label for="radio-io1">'+u(n.i18n.call(e,"PROP.VOLUME_TYPE_IO1",{hash:{},data:t}))+'</label>\n      </div>\n\n      </div>\n    </section>\n\n    <section class="property-control-group" id="iops-group" ',i=n.unless.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isIo1),{hash:{},inverse:a.noop,fn:a.program(40,_,t),data:t});if(i||i===0)r+=i;r+=">\n        <label>"+u(n.i18n.call(e,"PROP.INSTANCE_IOPS",{hash:{},data:t}))+'</label>\n        <div class="ranged-number-input">\n          <label for="iops-ranged"></label>\n          <input id="iops-ranged" type="text" class="input" min="100" max="2000" value="'+u((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),typeof i===f?i.apply(e):i))+'">\n        </div>\n    </section>\n\n    <section class="property-control-group">\n        <label>'+u(n.i18n.call(e,"PROP.VOLUME_ENCRYPTED",{hash:{},data:t}))+"</label>\n        <div>",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.encrypted),{hash:{},inverse:a.program(44,P,t),fn:a.program(42,D,t),data:t});if(i||i===0)r+=i;return r+="</div>\n    </section>\n\n	</div>\n  ",r}function O(e,t){return'class="tooltip"'}function M(e,t){return"disabled"}function _(e,t){return'style="display:none"'}function D(e,t){return"Encrypted"}function P(e,t){return"Not Encrypted"}function H(e,t){var r="",i;r+='\n	<div class="option-group-head">'+u(n.i18n.call(e,"PROP.INSTANCE_ENI_DETAIL",{hash:{},data:t}))+'</div>\n	<div class="option-group" data-bind="true">\n		<section class="property-control-group">\n			<label class="left" for="property-instance-ni-description">'+u(n.i18n.call(e,"PROP.INSTANCE_ENI_DESC",{hash:{},data:t}))+'</label>\n			<textarea id="property-instance-ni-description" data-type="ascii" data-ignore="true" class="input">'+u((i=(i=e&&e.eni,i==null||i===!1?i:i.description),typeof i===f?i.apply(e):i))+'</textarea>\n		</section>\n		<section class="property-control-group">\n			<div class="checkbox">\n				',i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.sourceDestCheck),{hash:{},inverse:a.program(49,j,t),fn:a.program(47,B,t),data:t});if(i||i===0)r+=i;r+='\n				<label for="property-instance-source-check"></label>\n			</div>\n			<label for="property-instance-source-check">'+u(n.i18n.call(e,"PROP.INSTANCE_ENI_SOURCE_DEST_CHECK",{hash:{},data:t}))+"</label>\n		</section>\n		<section ",i=n["if"].call(e,e&&e.multi_enis,{hash:{},inverse:a.program(53,I,t),fn:a.program(51,F,t),data:t});if(i||i===0)r+=i;r+='>\n			<div class="checkbox">\n				<input id="property-instance-public-ip" type="checkbox" ',i=n["if"].call(e,e&&e.multi_enis,{hash:{},inverse:a.noop,fn:a.program(55,q,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.assoPublicIp),{hash:{},inverse:a.noop,fn:a.program(57,R,t),data:t});if(i||i===0)r+=i;return r+=' value="None" name="property-instance-public-ip" />\n				<label for="property-instance-public-ip"></label>\n			</div>\n			<label for="property-instance-public-ip">'+u(n.i18n.call(e,"PROP.INSTANCE_ENI_AUTO_PUBLIC_IP",{hash:{},data:t}))+'</label>\n		</section>\n		<section class="property-control-group">\n			<div class="network-list-wrap">\n				<div class="network-list-header clearfix">\n					'+u(n.i18n.call(e,"PROP.INSTANCE_ENI_IP_ADDRESS",{hash:{},data:t}))+'\n					<button id="instance-ip-add" class="right btn btn-blue btn-small tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ENI_TIP_ADD_IP_ADDRESS",{hash:{},data:t}))+'">'+u(n.i18n.call(e,"PROP.INSTANCE_ENI_ADD_IP",{hash:{},data:t}))+'</button>\n				</div>\n				<ul class="network-list" id="property-network-list" data-bind="true"></ul>\n			</div>\n		</section>\n	</div>\n	',r}function B(e,t){return'\n				<input id="property-instance-source-check" type="checkbox" checked="true" value="None" name="property-instance-source-check" />\n				'}function j(e,t){return'\n				<input id="property-instance-source-check" type="checkbox" value="None" name="property-instance-source-check" />\n				'}function F(e,t){var r="";return r+='class="property-control-group tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.INSTANCE_TIP_PUBLIC_IP_CANNOT_BE_ASSOCIATED",{hash:{},data:t}))+'"',r}function I(e,t){return'class="property-control-group"'}function q(e,t){return'disabled="disabled"'}function R(e,t){return'checked="checked" '}function U(e,t){var r="",i;r+='\n		<table class="table cost-estimation-table">\n			<tbody>\n			',i=n.each.call(e,e&&e.tags,{hash:{},inverse:a.noop,fn:a.program(60,z,t),data:t});if(i||i===0)r+=i;return r+="\n			</tbody>\n		</table>\n		",r}function z(e,t){var n="",r;return n+='\n			<tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===f?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===f?r.apply(e):r))+"</td> </tr>\n			",n}function W(e,t){var r="";return r+='\n		<div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<article>\n\n	<div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.INSTANCE_DETAIL",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-instance-name" >'+u(n.i18n.call(t,"PROP.INSTANCE_HOSTNAME",{hash:{},data:i}))+'</label>\n			<span class="required-input right">'+u(n.i18n.call(t,"PROP.INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n\n			<div class="property-instance-name-wrap ',o=n.ifCond.call(t,t&&t.count,1,{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='">\n				<div class="name-count-wrap">\n					-[0-<span id="property-instance-name-count">'+u((o=t&&t.displayCount,typeof o===f?o.apply(t):o))+'</span>]\n				</div>\n				<div class="fitfloat">\n					<input class="input instance-name"  type="text" value="'+u((o=t&&t.name,typeof o===f?o.apply(t):o))+'" id="property-instance-name" data-ignore="true" data-required-rollback="true"/>\n				</div>\n			</div>\n		</section>\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-res-desc">'+u(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+'</label>\n			<textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((o=t&&t.description,typeof o===f?o.apply(t):o))+'</textarea>\n		</section>\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-instance-count" >'+u(n.i18n.call(t,"PROP.INSTANCE_NUMBER",{hash:{},data:i}))+'</label>\n			<span class="required-input right">'+u(n.i18n.call(t,"PROP.INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n			<input class="input tooltip" type="text" value="'+u((o=t&&t.count,typeof o===f?o.apply(t):o))+'" id="property-instance-count" data-ignore="true" data-required="true" data-type="digits" ',o=n["if"].call(t,t&&t.number_disable,{hash:{},inverse:a.program(5,h,i),fn:a.program(3,c,i),data:i});if(o||o===0)s+=o;s+='/>\n		</section>\n		<section class="property-control-group">\n			<label>'+u(n.i18n.call(t,"PROP.INSTANCE_AMI",{hash:{},data:i}))+'</label>\n			<div id="property-ami" class="property-block-wrap clearfix" data-uid=\''+u((o=t&&t.imageId,typeof o===f?o.apply(t):o))+'\'>\n				<img class="property-ami-icon left" src="/assets/images/ide/ami/'+u((o=(o=t&&t.instance_ami,o==null||o===!1?o:o.icon),typeof o===f?o.apply(t):o))+'">\n				<div class="property-ami-label" ',o=n["if"].call(t,(o=t&&t.instance_ami,o==null||o===!1?o:o.unavailable),{hash:{},inverse:a.noop,fn:a.program(7,p,i),data:i});if(o||o===0)s+=o;s+=">"+u((o=(o=t&&t.instance_ami,o==null||o===!1?o:o.name),typeof o===f?o.apply(t):o))+"</div>\n			</div>\n		</section>\n		",o=n["if"].call(t,(o=t&&t.instance_type,o==null||o===!1?o:o.length),{hash:{},inverse:a.noop,fn:a.program(9,d,i),data:i});if(o||o===0)s+=o;s+='\n		<section class="property-control-group" ',o=n.unless.call(t,t&&t.can_set_ebs,{hash:{},inverse:a.noop,fn:a.program(13,g,i),data:i});if(o||o===0)s+=o;s+='>\n			<div class="checkbox">\n				<input id="property-instance-ebs-optimized" type="checkbox" value="None" ',o=n["if"].call(t,t&&t.ebsOptimized,{hash:{},inverse:a.noop,fn:a.program(15,y,i),data:i});if(o||o===0)s+=o;s+=' name="ebs-optimized" />\n				<label for="property-instance-ebs-optimized"></label>\n			</div>\n			<label for="property-instance-ebs-optimized">'+u(n.i18n.call(t,"PROP.INSTANCE_EBS_OPTIMIZED",{hash:{},data:i}))+"</label>\n		</section>\n		",o=n.unless.call(t,t&&t.classic_stack,{hash:{},inverse:a.noop,fn:a.program(17,b,i),data:i});if(o||o===0)s+=o;s+='\n		<section class="property-control-group">\n			<label class="left">'+u(n.i18n.call(t,"PROP.INSTANCE_KEY_PAIR",{hash:{},data:i}))+'</label>\n			<i class="icon-info tooltip default-kp-info" data-tooltip="'+u(n.i18n.call(t,"POP_INSTANCE_KEYPAIR_INFO_TIP",{hash:{},data:i}))+'"></i>\n            <div id="kp-placeholder"></div>\n		</section>\n	</div>\n	<div class="option-group-head">'+u(n.i18n.call(t,"PROP.INSTANCE_ADVANCED_DETAIL",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group">\n			<div class="checkbox">\n				',o=n["if"].call(t,t&&t.monitoring,{hash:{},inverse:a.program(27,N,i),fn:a.program(25,T,i),data:i});if(o||o===0)s+=o;s+='\n				<label for="property-instance-enable-cloudwatch"></label>\n			</div>\n			<label for="property-instance-enable-cloudwatch" >'+u(n.i18n.call(t,"PROP.INSTANCE_CW_ENABLED",{hash:{},data:i}))+'</label>\n\n			<p class="',o=n.unless.call(t,t&&t.monitoring,{hash:{},inverse:a.noop,fn:a.program(29,C,i),data:i});if(o||o===0)s+=o;s+=' property-info" id="property-cloudwatch-warn">'+u(n.i18n.call(t,"PROP.INSTANCE_CW_WARN",{hash:{},data:i}))+'<a target="_blank" href="http://aws.amazon.com/cloudwatch">'+u(n.i18n.call(t,"PROP.INSTANCE_WATCH_LINK_TEXT",{hash:{},data:i}))+'</a></p>\n		</section>\n		<section class="property-control-group">\n			',o=n["if"].call(t,t&&t.stackAgentEnable,{hash:{},inverse:a.program(33,L,i),fn:a.program(31,k,i),data:i});if(o||o===0)s+=o;s+="\n		</section>\n	</div>\n\n  ",o=n["if"].call(t,t&&t.rootDevice,{hash:{},inverse:a.noop,fn:a.program(35,A,i),data:i});if(o||o===0)s+=o;s+="\n\n	",o=n["if"].call(t,t&&t.eni,{hash:{},inverse:a.noop,fn:a.program(46,H,i),data:i});if(o||o===0)s+=o;s+='\n\n	<div class="option-group-head" id="sg-head">'+u(n.i18n.call(t,"PROP.INSTANCE_SG_DETAIL",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  	<div class="option-group sg-group"></div>\n	<div class="option-group-head expand">\n		'+u(n.i18n.call(t,"PROP.RESOURCE_TAGS",{hash:{},data:i}))+'\n	</div>\n	<div class="option-group">\n		',o=n["if"].call(t,(o=t&&t.tags,o==null||o===!1?o:o.length),{hash:{},inverse:a.program(62,W,i),fn:a.program(59,U,i),data:i});if(o||o===0)s+=o;return s+='\n		<div class="tags-action">\n			\n			<button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(t,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:i}))+"</button>\n		</div>\n	</div>\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/instance/template/stack_mesos",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n    <div class="option-group-head expand">Mesos Settings</div>\n    <div class="option-group">\n        <section class="property-control-group" data-bind="true">\n            <label>Default Attributes</label>\n            <table class="table">\n                <tr>\n                    <th>Key</th><th>Value</th>\n                </tr>\n                ',i=n.each.call(e,e&&e.defaultMesosAttr,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+='\n            </table>\n        </section>\n\n        <section class="property-control-group" data-bind="true">\n            <label>Custom Attributes <a href="#" class="icon-add" id="add-ma-item-outside"></a></label>\n            <div id="mesos-attribute" class="multi-input">\n                <div class="multi-ipt-row template">\n                    <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                    <span class="ipt-wrapper">\n                        <input class="input mesos-attr ipt-half" type="text" data-name="key" placeholder="key" required/>\n                        <input class="input mesos-attr ipt-half" type="text" data-name="value" placeholder="value" required/>\n                    </span>\n                </div>\n                ',i=n.each.call(e,e&&e.mesosAttr,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n            </div>\n        </section>\n    </div>\n    ",r}function c(e,t){var n="",r;return n+="\n                <tr>\n                    <td>"+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</td>\n                    <td>"+a(typeof e===u?e.apply(e):e)+"</td>\n                </tr>\n                ",n}function h(e,t){var r="",i;r+='\n                <div class="multi-ipt-row">\n                    <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                    <span class="ipt-wrapper">\n                        <input class="input mesos-attr ipt-half" type="text" data-name="key" value="'+a((i=t==null||t===!1?t:t.key,typeof i===u?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.readonly,{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;r+=' placeholder="key" required/>\n                        <input class="input mesos-attr ipt-half" type="text" data-name="value" value="'+a(typeof e===u?e.apply(e):e)+'" ',i=n["if"].call(e,e&&e.readonly,{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;return r+=' placeholder="value" required/>\n                    </span>\n                </div>\n                ',r}function p(e,t){return"disabled"}function d(e,t){return"single"}function v(e,t){var r="",i;r+='\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-res-desc">'+a(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n			<textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+a((i=e&&e.description,typeof i===u?i.apply(e):i))+'</textarea>\n		</section>\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-instance-count" >'+a(n.i18n.call(e,"PROP.INSTANCE_NUMBER",{hash:{},data:t}))+'</label>\n			<span class="required-input right">'+a(n.i18n.call(e,"PROP.INSTANCE_REQUIRE",{hash:{},data:t}))+'</span>\n			<input class="input tooltip" type="text" value="'+a((i=e&&e.count,typeof i===u?i.apply(e):i))+'" id="property-instance-count" data-ignore="true" data-required="true" data-type="digits" ',i=n["if"].call(e,e&&e.number_disable,{hash:{},inverse:f.program(12,g,t),fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;return r+="/>\n		</section>\n        ",r}function m(e,t){var r="";return r+='disabled="disabled" data-tooltip="'+a(n.i18n.call(e,"PROP.INSTANCE_TIP_YOU_CANNOT_SPECIFY_INSTANCE_NUMBER",{hash:{},data:t}))+'"',r}function g(e,t){var r="";return r+='data-tooltip="'+a(n.i18n.call(e,"PROP.INSTANCE_TIP_IF_THE_QUANTITY_IS_MORE_THAN_1",{hash:{},data:t}))+'"',r}function y(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left">'+a(n.i18n.call(e,"PROP.INSTANCE_TYPE",{hash:{},data:t}))+'</label>\n			<div class="selectbox selectbox-mega" id="instance-type-select">\n				<div class="selection"></div>\n				<ul class="dropdown"> ',i=n.each.call(e,e&&e.instance_type,{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+=" </ul>\n			</div>\n		</section>\n		",r}function b(e,t){var r="",i;r+='\n					<li class="',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:f.noop,fn:f.program(16,w,t),data:t});if(i||i===0)r+=i;r+='tooltip item" tabindex="-1" data-tooltip="'+a((i=e&&e.main,typeof i===u?i.apply(e):i))+'" data-id="'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.hide,{hash:{},inverse:f.noop,fn:f.program(18,E,t),data:t});if(i||i===0)r+=i;return r+='>\n						<div class="main truncate">'+a((i=e&&e.main,typeof i===u?i.apply(e):i))+'</div>\n						<div class="sub"><span>'+a((i=e&&e.ecu,typeof i===u?i.apply(e):i))+"</span><span>"+a((i=e&&e.core,typeof i===u?i.apply(e):i))+"</span><span>"+a((i=e&&e.mem,typeof i===u?i.apply(e):i))+"</span></div>\n					</li>\n				",r}function w(e,t){return"selected "}function E(e,t){return'style="display:none;"'}function S(e,t){return'checked="checked"'}function x(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left">'+a(n.i18n.call(e,"PROP.INSTANCE_TENANCY",{hash:{},data:t}))+'</label>\n			<div class="selectbox" id="tenancy-select">\n				<div class="selection">',i=n["if"].call(e,e&&e.tenancy,{hash:{},inverse:f.program(25,N,t),fn:f.program(23,T,t),data:t});if(i||i===0)r+=i;r+='</div>\n				<ul class="dropdown" tabindex="-1">\n					',i=n.unless.call(e,e&&e.force_tenacy,{hash:{},inverse:f.noop,fn:f.program(27,C,t),data:t});if(i||i===0)r+=i;r+='\n					<li class="item ',i=n.unless.call(e,e&&e.tenancy,{hash:{},inverse:f.noop,fn:f.program(28,k,t),data:t});if(i||i===0)r+=i;return r+='" data-id="dedicated">'+a(n.i18n.call(e,"PROP.INSTANCE_TENANCY_DELICATED",{hash:{},data:t}))+"</li>\n				</ul>\n			</div>\n		</section>\n		",r}function T(e,t){return"Default"}function N(e,t){return"Dedicated"}function C(e,t){var r="",i;r+='\n					<li class="item ',i=n["if"].call(e,e&&e.tenancy,{hash:{},inverse:f.noop,fn:f.program(28,k,t),data:t});if(i||i===0)r+=i;return r+='" data-id="default">'+a(n.i18n.call(e,"PROP.INSTANCE_TENANCY_DEFAULT",{hash:{},data:t}))+"</li>\n					",r}function k(e,t){return"selected"}function L(e,t){var r="",i;r+='\n	<div class="option-group-head">'+a(n.i18n.call(e,"PROP.INSTANCE_ADVANCED_DETAIL",{hash:{},data:t}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group">\n			<div class="checkbox">\n				',i=n["if"].call(e,e&&e.monitoring,{hash:{},inverse:f.program(33,O,t),fn:f.program(31,A,t),data:t});if(i||i===0)r+=i;r+='\n				<label for="property-instance-enable-cloudwatch"></label>\n			</div>\n			<label for="property-instance-enable-cloudwatch" >'+a(n.i18n.call(e,"PROP.INSTANCE_CW_ENABLED",{hash:{},data:t}))+'</label>\n\n			<p class="',i=n.unless.call(e,e&&e.monitoring,{hash:{},inverse:f.noop,fn:f.program(35,M,t),data:t});if(i||i===0)r+=i;r+=' property-info" id="property-cloudwatch-warn">'+a(n.i18n.call(e,"PROP.INSTANCE_CW_WARN",{hash:{},data:t}))+'<a target="_blank" href="http://aws.amazon.com/cloudwatch">'+a(n.i18n.call(e,"PROP.INSTANCE_WATCH_LINK_TEXT",{hash:{},data:t}))+'</a></p>\n		</section>\n		<section class="property-control-group">\n			',i=n["if"].call(e,e&&e.stackAgentEnable,{hash:{},inverse:f.program(39,D,t),fn:f.program(37,_,t),data:t});if(i||i===0)r+=i;return r+="\n		</section>\n	</div>\n    ",r}function A(e,t){return'\n				<input id="property-instance-enable-cloudwatch" type="checkbox" checked="true" value="None" name="property-instance-enable-cloudwatch" />\n				'}function O(e,t){return'\n				<input id="property-instance-enable-cloudwatch" type="checkbox" value="None" name="property-instance-enable-cloudwatch" />\n				'}function M(e,t){return"hide"}function _(e,t){var r="";return r+='\n			<div class="property-info">'+a(n.i18n.call(e,"PROP.INSTANCE_USERDATA_DISABLED_TO_INSTALL_VISUALOPS",{hash:{},data:t}))+' <a href="'+a(n.i18n.call(e,"PROP.AGENT_USER_DATA_URL",{hash:{},data:t}))+'" target="_blank">'+a(n.i18n.call(e,"PROP.INSTANCE_VIEW_AGENT_USER_DATA_URL_TEXT",{hash:{},data:t}))+"</a>.</div>\n			",r}function D(e,t){var r="",i;return r+='\n			<label for="property-instance-user-data">'+a(n.i18n.call(e,"PROP.INSTANCE_USER_DATA",{hash:{},data:t}))+'</label>\n			<textarea id="property-instance-user-data">'+a((i=e&&e.userData,typeof i===u?i.apply(e):i))+"</textarea>\n			",r}function P(e,t){var r="",i;r+='\n	<div class="option-group-head">'+a(n.i18n.call(e,"PROP.INSTANCE_ROOT_DEVICE",{hash:{},data:t}))+'</div>\n	<div class="option-group">\n    <section class="property-control-group">\n      <label>'+a(n.i18n.call(e,"PROP.VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</label>\n      <div>"+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.name),typeof i===u?i.apply(e):i))+'</div>\n    </section>\n    <section class="property-control-group">\n      <label>'+a(n.i18n.call(e,"PROP.VOLUME_SIZE",{hash:{},data:t}))+'</label>\n      <div class="ranged-number-input">\n          <label for="volume-size-ranged"></label>\n          <input id="volume-size-ranged" type="text" class="input" value="'+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.size),typeof i===u?i.apply(e):i))+'" name="volume-size-ranged" data-ignore="true" maxlength="4" data-required="true" data-required="true" data-type="number"/>\n      <label for="volume-property-ranged-number" >GB</label>\n      </div>\n    </section>\n\n    <section class="property-control-group">\n      <label>'+a(n.i18n.call(e,"PROP.VOLUME_TYPE",{hash:{},data:t}))+'</label>\n      <div id="volume-type-radios">\n\n      <div>\n      	<div class="radio">\n          <input id="radio-standard" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isStandard),{hash:{},inverse:f.noop,fn:f.program(20,S,t),data:t});if(i||i===0)r+=i;r+=' value="standard"/>\n          <label for="radio-standard"></label>\n        </div>\n        <label for="radio-standard">'+a(n.i18n.call(e,"PROP.VOLUME_TYPE_STANDARD",{hash:{},data:t}))+'</label>\n      </div>\n\n      <div>\n        <div class="radio">\n          <input id="radio-gp2" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isGp2),{hash:{},inverse:f.noop,fn:f.program(20,S,t),data:t});if(i||i===0)r+=i;r+=' value="gp2"/>\n          <label for="radio-gp2"></label>\n        </div>\n        <label for="radio-gp2">'+a(n.i18n.call(e,"PROP.VOLUME_TYPE_GP2",{hash:{},data:t}))+"</label>\n      </div>\n\n      <div ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:f.noop,fn:f.program(42,H,t),data:t});if(i||i===0)r+=i;r+=' data-tooltip="'+a(n.i18n.call(e,"PROP.VOLUME_MSG_WARN",{hash:{},data:t}))+'">\n        <div class="radio">\n          <input id="radio-io1" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isIo1),{hash:{},inverse:f.noop,fn:f.program(20,S,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;r+=' value="io1"/>\n          <label for="radio-io1"></label>\n        </div>\n        <label for="radio-io1">'+a(n.i18n.call(e,"PROP.VOLUME_TYPE_IO1",{hash:{},data:t}))+'</label>\n      </div>\n\n      </div>\n    </section>\n\n    <section class="property-control-group" id="iops-group" ',i=n.unless.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isIo1),{hash:{},inverse:f.noop,fn:f.program(44,B,t),data:t});if(i||i===0)r+=i;r+=">\n        <label>"+a(n.i18n.call(e,"PROP.INSTANCE_IOPS",{hash:{},data:t}))+'</label>\n        <div class="ranged-number-input">\n          <label for="iops-ranged"></label>\n          <input id="iops-ranged" type="text" class="input" min="100" max="2000" value="'+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),typeof i===u?i.apply(e):i))+'">\n        </div>\n    </section>\n\n    <section class="property-control-group">\n        <label>'+a(n.i18n.call(e,"PROP.VOLUME_ENCRYPTED",{hash:{},data:t}))+"</label>\n        <div>",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.encrypted),{hash:{},inverse:f.program(48,F,t),fn:f.program(46,j,t),data:t});if(i||i===0)r+=i;return r+="</div>\n    </section>\n\n	</div>\n  ",r}function H(e,t){return'class="tooltip"'}function B(e,t){return'style="display:none"'}function j(e,t){return"Encrypted"}function F(e,t){return"Not Encrypted"}function I(e,t){var r="",i;r+='\n	<div class="option-group-head">'+a(n.i18n.call(e,"PROP.INSTANCE_ENI_DETAIL",{hash:{},data:t}))+'</div>\n	<div class="option-group" data-bind="true">\n		<section class="property-control-group">\n			<label class="left" for="property-instance-ni-description">'+a(n.i18n.call(e,"PROP.INSTANCE_ENI_DESC",{hash:{},data:t}))+'</label>\n			<textarea id="property-instance-ni-description" data-type="ascii" data-ignore="true" class="input">'+a((i=(i=e&&e.eni,i==null||i===!1?i:i.description),typeof i===u?i.apply(e):i))+'</textarea>\n		</section>\n		<section class="property-control-group">\n			<div class="checkbox">\n				',i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.sourceDestCheck),{hash:{},inverse:f.program(53,R,t),fn:f.program(51,q,t),data:t});if(i||i===0)r+=i;r+='\n				<label for="property-instance-source-check"></label>\n			</div>\n			<label for="property-instance-source-check">'+a(n.i18n.call(e,"PROP.INSTANCE_ENI_SOURCE_DEST_CHECK",{hash:{},data:t}))+"</label>\n		</section>\n		<section ",i=n["if"].call(e,e&&e.multi_enis,{hash:{},inverse:f.program(57,z,t),fn:f.program(55,U,t),data:t});if(i||i===0)r+=i;r+='>\n			<div class="checkbox">\n				<input id="property-instance-public-ip" type="checkbox" disabled="disabled" ',i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.assoPublicIp),{hash:{},inverse:f.noop,fn:f.program(20,S,t),data:t});if(i||i===0)r+=i;return r+=' value="None" name="property-instance-public-ip" />\n				<label for="property-instance-public-ip"></label>\n			</div>\n			<label for="property-instance-public-ip">'+a(n.i18n.call(e,"PROP.INSTANCE_ENI_AUTO_PUBLIC_IP",{hash:{},data:t}))+'</label>\n		</section>\n		<section class="property-control-group">\n			<div class="network-list-wrap">\n				<div class="network-list-header clearfix">\n					'+a(n.i18n.call(e,"PROP.INSTANCE_ENI_IP_ADDRESS",{hash:{},data:t}))+'\n				</div>\n				<ul class="network-list" id="property-network-list" data-bind="true"></ul>\n			</div>\n		</section>\n	</div>\n	',r}function q(e,t){return'\n				<input id="property-instance-source-check" type="checkbox" checked="true" value="None" name="property-instance-source-check" />\n				'}function R(e,t){return'\n				<input id="property-instance-source-check" type="checkbox" value="None" name="property-instance-source-check" />\n				'}function U(e,t){var r="";return r+='class="property-control-group tooltip" data-tooltip="'+a(n.i18n.call(e,"PROP.INSTANCE_TIP_PUBLIC_IP_CANNOT_BE_ASSOCIATED",{hash:{},data:t}))+'"',r}function z(e,t){return'class="property-control-group"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+="<article>\n    ",o=n["if"].call(t,t&&t.isMesosSlave,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n	<div class="option-group-head expand">'+a(n.i18n.call(t,"PROP.INSTANCE_DETAIL",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-instance-name" >'+a(n.i18n.call(t,"PROP.INSTANCE_HOSTNAME",{hash:{},data:i}))+'</label>\n			<span class="required-input right">'+a(n.i18n.call(t,"PROP.INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n\n			<div class="property-instance-name-wrap ',o=n.ifCond.call(t,t&&t.count,1,{hash:{},inverse:f.noop,fn:f.program(7,d,i),data:i});if(o||o===0)s+=o;s+='">\n				<div class="name-count-wrap">\n					-[0-<span id="property-instance-name-count">'+a((o=t&&t.displayCount,typeof o===u?o.apply(t):o))+'</span>]\n				</div>\n				<div class="fitfloat">\n					<input class="input instance-name"  type="text" value="'+a((o=t&&t.name,typeof o===u?o.apply(t):o))+'" id="property-instance-name" data-ignore="true" data-required-rollback="true"/>\n				</div>\n			</div>\n		</section>\n\n        ',o=n["if"].call(t,t&&t.isMesosSlave,{hash:{},inverse:f.noop,fn:f.program(9,v,i),data:i});if(o||o===0)s+=o;s+="\n\n		",o=n["if"].call(t,(o=t&&t.instance_type,o==null||o===!1?o:o.length),{hash:{},inverse:f.noop,fn:f.program(14,y,i),data:i});if(o||o===0)s+=o;s+='\n\n		<section class="property-control-group" ',o=n.unless.call(t,t&&t.can_set_ebs,{hash:{},inverse:f.noop,fn:f.program(18,E,i),data:i});if(o||o===0)s+=o;s+='>\n			<div class="checkbox">\n				<input id="property-instance-ebs-optimized" type="checkbox" value="None" ',o=n["if"].call(t,t&&t.ebsOptimized,{hash:{},inverse:f.noop,fn:f.program(20,S,i),data:i});if(o||o===0)s+=o;s+=' name="ebs-optimized" />\n				<label for="property-instance-ebs-optimized"></label>\n			</div>\n			<label for="property-instance-ebs-optimized">'+a(n.i18n.call(t,"PROP.INSTANCE_EBS_OPTIMIZED",{hash:{},data:i}))+"</label>\n		</section>\n		",o=n.unless.call(t,t&&t.classic_stack,{hash:{},inverse:f.noop,fn:f.program(22,x,i),data:i});if(o||o===0)s+=o;s+='\n		<section class="property-control-group">\n			<label class="left">'+a(n.i18n.call(t,"PROP.INSTANCE_KEY_PAIR",{hash:{},data:i}))+'</label>\n			<i class="icon-info tooltip default-kp-info" data-tooltip="'+a(n.i18n.call(t,"POP_INSTANCE_KEYPAIR_INFO_TIP",{hash:{},data:i}))+'"></i>\n            <div id="kp-placeholder"></div>\n		</section>\n	</div>\n\n    ',o=n["if"].call(t,t&&t.isMesosSlave,{hash:{},inverse:f.noop,fn:f.program(30,L,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n["if"].call(t,t&&t.rootDevice,{hash:{},inverse:f.noop,fn:f.program(41,P,i),data:i});if(o||o===0)s+=o;s+="\n\n	",o=n["if"].call(t,t&&t.eni,{hash:{},inverse:f.noop,fn:f.program(50,I,i),data:i});if(o||o===0)s+=o;return s+='\n\n	<div class="option-group-head" id="sg-head">'+a(n.i18n.call(t,"PROP.INSTANCE_SG_DETAIL",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n</article>',s};return e.template(t)}),define("wspace/awseditor/property/instance/view",["../base/view","./template/stack","./template/stack_mesos","i18n!/nls/lang.js","constant","kp_dropdown"],function(e,t,n,r,i,s){var o,u,a,f;return f=function(){return null},a=2e4,u=function(e){switch(e){case i.RESTYPE.MESOSMASTER:return n;case i.RESTYPE.MESOSSLAVE:return n;default:return t}},o=e.extend({events:{"change .instance-name":"instanceNameChange","change #property-res-desc":"onChangeDesc","change #property-instance-count":"countChange","change #property-instance-ebs-optimized":"ebsOptimizedSelect","change #property-instance-enable-cloudwatch":"cloudwatchSelect","change #property-instance-user-data":"userdataChange","change #property-instance-ni-description":"eniDescriptionChange","change #property-instance-source-check":"sourceCheckChange","change #property-instance-public-ip":"publicIpChange","OPTION_CHANGE #instance-type-select":"instanceTypeSelect","OPTION_CHANGE #tenancy-select":"tenancySelect","click #property-ami":"openAmiPanel","OPTION_CHANGE #keypair-select":"setKP","EDIT_UPDATE #keypair-select":"addKP","EDIT_FINISHED #keypair-select":"updateKPSelect","click .toggle-eip":"setEip","click #instance-ip-add":"addIp","click #property-network-list .icon-remove":"removeIp","keyup .input-ip":"syncIPList","click #volume-type-radios input":"changeVolumeType","keyup #iops-ranged":"changeIops","keyup #volume-size-ranged":"sizeChanged","change .mesos-attr":"setMesosAttribute","REMOVE_ROW .multi-input":"setMesosAttribute","click #add-ma-item-outside":"addMesosAttrItem"},render:function(){var e,t,n;return n=u(this.resModel.subType),this.$el.html(n(this.model.toJSON())),e=new s({resModel:this.resModel}),this.$("#kp-placeholder").html(e.render().el),this.addSubView(e),this.refreshIPList(),t=this,$("#volume-size-ranged").parsley("custom",function(e){e=+e;if(!e||e>16384||e<t.model.attributes.min_volume_size)return sprintf(r.PARSLEY.VOLUME_SIZE_OF_ROOTDEVICE_MUST_IN_RANGE,t.model.attributes.min_volume_size)}),$("#iops-ranged").parsley("custom",function(e){var t;e=+e,t=parseInt($("#volume-size-ranged").val(),10);if(e>a||e<100)return r.PARSLEY.IOPS_MUST_BETWEEN_100_4000;if(e>10*t)return r.PARSLEY.IOPS_MUST_BE_LESS_THAN_10_TIMES_OF_VOLUME_SIZE}),this.model.attributes.name},addMesosAttrItem:function(e){return this.$("#mesos-attribute").find(".icon-add").eq(0).click(),!1},setMesosAttribute:function(e){var t;return t={},this.$("#mesos-attribute").find(".multi-ipt-row:not(.template)").each(function(){var e,n,r;e=$(this).find(".input"),n=e[0].value.trim(),r=e[1].value;if(n.length)return t[n]=r}),this.resModel.setMesosAttributes(t)},changeVolumeType:function(e){var t,n,r,i;t=$(e.currentTarget);if(t.is(":disabled"))return;return r=t.val(),$("#iops-group").toggle(r==="io1"),r==="io1"?(i=parseInt($("#volume-size-ranged").val(),10),n=i*10,n>a&&(n=a),$("#iops-ranged").val(n).keyup()):(this.model.setIops(""),$("#iops-ranged").val("")),this.model.setVolumeType(r),null},changeIops:function(){return $("#iops-ranged").parsley("validate")&&this.model.setIops($("#iops-ranged").val()),null},sizeChanged:function(e){var t,n,r,i;if(!$("#volume-size-ranged").parsley("validate"))return;return i=parseInt($("#volume-size-ranged").val(),10),this.model.setVolumeSize(i),i<10&&(this.model.setIops(""),r=!0),t=$("#volume-type-radios").children("div").last().toggleClass("tooltip",r).find("input"),r?(t.attr("disabled","disabled"),$("#radio-standard").click(),$("#iops-group").hide()):t.removeAttr("disabled"),n=parseInt($("#iops-ranged").val(),10)||0,n&&(n>i*10&&(n=i*10,$("#iops-ranged").val(n)),$("#iops-ranged").keyup()),null},instanceNameChange:function(e){var t,n;return n=$(e.currentTarget),t=n.val(),MC.aws.aws.checkResName(this.model.get("uid"),n,"Instance")&&(this.model.setName(t),this.setTitle(t)),null},onChangeDesc:function(e){return this.model.setDesc($(e.currentTarget).val())},countChange:function(e){var t,n,i;t=$(e.currentTarget),n=this,t.parsley("custom",function(e){if(isNaN(e)||e>99||e<1)return r.PARSLEY.THIS_VALUE_MUST_BETWEEN_1_99});if(t.parsley("validate"))return this.refreshIPList(),i=+t.val(),this.model.setCount(i),$(".property-instance-name-wrap").toggleClass("single",i===1),$("#property-instance-name-count").text(i-1),this.setEditableIP(i===1)},setEditableIP:function(e){var t;return t=$("#property-network-list"),e?t.find(".input-ip-wrap").removeClass("disabled").find(".name").data("tooltip",r.PROP.INSTANCE_IP_MSG_1).find(".input-ip").prop("disabled",""):t.find(".input-ip-wrap").addClass("disabled").find(".name").data("tooltip",r.PROP.INSTANCE_IP_MSG_2).find(".input-ip").attr("disabled","disabled"),null},instanceTypeSelect:function(e,t){var n,r,i;r=this.model.canSetInstanceType(t);if(r!==!0){notification("error",r),e.preventDefault();return}return i=this.model.setInstanceType(t),n=$("#property-instance-ebs-optimized"),n.closest(".property-control-group").toggle(i),i||n.prop("checked",!1),this.refreshIPList()},ebsOptimizedSelect:function(e){return this.model.setEbsOptimized(e.target.checked),null},tenancySelect:function(e,t){var n,r,i;return r=$("#instance-type-select"),n=r.find("[data-id='t1.micro']"),n.length&&(i=t!=="dedicated",n.toggle(i),n.hasClass("selected")&&!i&&r.find(".item:not([data-id='t1.micro'])").eq(0).click()),this.model.setTenancy(t),null},cloudwatchSelect:function(e){return this.model.setMonitoring(e.target.checked),$("#property-cloudwatch-warn").toggle($("#property-instance-enable-cloudwatch").is(":checked"))},userdataChange:function(e){return this.model.setUserData(e.target.value),null},eniDescriptionChange:function(e){return this.model.setEniDescription(e.target.value),null},sourceCheckChange:function(e){return this.model.setSourceCheck(e.target.checked),null},publicIpChange:function(e){return this.model.setPublicIp(e.target.checked),null},updateKPSelect:function(){return $("#keypair-select").find(".item:last-child").append('<span class="icon-remove"></span>'),null},openAmiPanel:function(e){return this.trigger("OPEN_AMI",$("#property-ami").attr("data-uid")),null},bindIpItemValidate:function(){var e;return e=this,$(".input-ip").each(function(){var t;return t=$(this),t.parsley("custom",function(n){var r,i,s,o,u,a,f;f=t,i=n,s=f.siblings(".input-ip-prefix").text(),r=s+i,u=s.split("."),o=!1,u.length===4?i==="x"?o=!0:MC.validate("ipaddress",s+i)&&(o=!0):i==="x.x"?o=!0:MC.validate("ipaddress",s+i)&&(o=!0);if(!o)return"Invalid IP address";a=e.model.isValidIp(r);if(a!==!0)return a})})},addIp:function(){if($("#instance-ip-add").hasClass("disabled"))return;return this.model.addIp(),this.refreshIPList(),null},removeIp:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.index(),t.remove(),this.model.removeIp(n),this.updateIPAddBtnState(!0),null},setEip:function(e){var t,n,i,s;return t=$(e.currentTarget),i=t.closest("li").index(),n=!t.hasClass("associated"),n?s=r.PROP.INSTANCE_IP_MSG_4:s=r.PROP.INSTANCE_IP_MSG_3,t.toggleClass("associated",n).attr("data-tooltip",s),this.model.attachEip(i,n),null},syncIPList:function(e){var t,n,r,i,s;i=$("#property-network-list .input-ip-item"),t=$(e.currentTarget);if(!t.parsley("validate"))return;return s=t.val(),r=t.siblings(".input-ip-prefix").text()+s,n=s==="x"||s==="x.x",this.model.setIp(t.closest("li").index(),r,n),null},refreshIPList:function(){if(!this.model.attributes.eni)return;return $("#property-network-list").html(MC.template.propertyIpList(this.model.attributes.eni.ips)),this.updateIPAddBtnState(),this.bindIpItemValidate(),null},updateIPAddBtnState:function(e){var t;return e===void 0&&(e=this.model.canAddIP()),e===!0?t="Add IP Address":(_.isString(e)?t=e:t="Cannot add IP address",e=!1),$("#instance-ip-add").toggleClass("disabled",!e).data("tooltip",t),null},disableUserDataInput:function(e){var t;t=$("#property-instance-user-data");if(e===!0)return t.attr("disabled","disabled"),t.addClass("tooltip").attr("data-tooltip",r.PROP.INSTANCE_USER_DATA_DISABLE);if(e===!1)return t.removeAttr("disabled"),t.removeClass("tooltip").removeAttr("data-tooltip")}}),new o}),define("wspace/awseditor/property/instance/app_model",["../base/model","constant","i18n!/nls/lang.js","Design","CloudResources","ApiRequest"],function(e,t,n,r,i,s){var o;return o=e.extend({defaults:{id:null},setOsTypeAndLoginCmd:function(e){var n,s,o,u,a,f,l,c;f=r.instance().region(),s=(l=i(r.instance().credentialId(),t.RESTYPE.INSTANCE,f).get(e))!=null?l.toJSON():void 0,s&&(a=(c=i(r.instance().credentialId(),t.RESTYPE.AMI,f).get(s.imageId))!=null?c.toJSON():void 0,a&&(a=a.osType));if(!a)return;"win|windows".indexOf(a)>0?this.set("osType","windows"):this.set("osType",a),s&&(o=s.instanceState.name);if(o==="running")switch(a){case"amazon":u="ec2-user";break;case"ubuntu":u="ubuntu";break;case"redhat":u="ec2-user";break;default:u="root"}return n=sprintf("ssh -i %s.pem %s@%s",s.keyName,u,s.publicIpAddress||s.privateIpAddress),this.set("loginCmd",n)},init:function(e){var n,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;this.resModel||void 0,this.set("id",e),this.set("uid",e),this.effective?(this.set("uid",this.effective.uid),this.set("mid",this.effective.mid),n=e):n=this.resModel.get("appId"),this.resModel&&this.set("userData",this.resModel.get("userData")),s=i(r.instance().credentialId(),t.RESTYPE.INSTANCE,r.instance().region());if(!(s!=null?(m=s.get(n))!=null?m.toJSON():void 0:void 0))return!1;a=$.extend(!0,{},(g=s.get(n))!=null?g.toJSON():void 0),this.set("userDataEnabled",!r.instance().get("agent").enabled&&a.rootDeviceType==="ebs"),a.name=this.resModel?this.resModel.get("name"):n,c=this.resModel.getAmiRootDeviceName(),this.resModel.isMesosSlave()&&(f={isMesosSlave:!0},_.extend(a,f)),a.state=MC.capitalize(a.instanceState.name),a.blockDevice="";if(a.blockDeviceMapping&&a.blockDeviceMapping){o=[],y=a.blockDeviceMapping;for(d=0,v=y.length;d<v;d++)u=y[d],o.push(u.deviceName),c===u.deviceName&&(h=u);a.blockDevice=o.join(", "),h&&(p=(b=i(r.instance().credentialId(),t.RESTYPE.VOL,r.instance().region()).get(h.ebs.volumeId))!=null?b.toJSON():void 0,p&&(p.attachmentSet&&(p.name=p.attachmentSet[0].device),this.set("rootDevice",p)))}return a.eni=this.getEniData(a),a.app_view=!1,l="disabled",a.monitoring&&a.monitoring.state&&(l=a.monitoring.state),this.set("monitoringState",l),this.set(a),this.setOsTypeAndLoginCmd(n),null},getEniData:function(e){var n,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;if(!e.networkInterfaceSet)return null;b=e.networkInterfaceSet;for(p=0,m=b.length;p<m;p++){c=b[p];if(c.attachment.deviceIndex==="0"){h=c.networkInterfaceId,f=c;break}}s=t.RESTYPE.ENI;if(!h)return null;n=r.modelClassForType(s),o=n&&n.allObjects()||[];for(d=0,g=o.length;d<g;d++){l=o[d];if(l.get("appId"===h)){a=l;break}}u=i(r.instance().credentialId(),t.RESTYPE.ENI,r.instance().region()),u.get(h)?f=$.extend(!0,{},(w=u.get(h))!=null?w.toJSON():void 0):f=$.extend(!0,{},f),f.name=a?a.get("name"):h,f.status==="in-use"&&(f.isInUse=!0),f.sourceDestCheck=f.sourceDestCheck?"enabled":"disabled",E=f.privateIpAddressesSet;for(v=0,y=E.length;v<y;v++)c=E[v],c.primary=c.primary===!0;return f},getPassword:function(e){return s("ins_GetPasswordData",{region_name:r.instance().region(),instance_id:this.get("instanceId"),key_id:r.instance().credentialId(),key_data:e||void 0}).then(function(e){var t;return t="",e["ns0:GetPasswordDataResponse"]&&(t="ns0:"),e[t+"GetPasswordDataResponse"][t+"passwordData"]})},getEni:function(){var e,t,n;n=r.instance().component(this.get("uid")),e=n.getEmbedEni();if(!e)return;return t=e.toJSON(),t.ips=e.getIpArray(),t.ips[0].unDeletable=!0,this.set("eni",t),this.set("multi_enis",n.connections("EniAttachment").length>0),null}}),new o}),define("wspace/awseditor/property/instance/template/app",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){return'\n  <div class="option-group-head expand">Mesos Details</div>\n  <div class="option-group" id="mesos-data-area">\n  </div>\n  '}function c(e,t){var r="",i;r+="\n      <dd>",i=n["if"].call(e,e&&e.keyName,{hash:{},inverse:f.program(6,p,t),fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="</dd>\n      ",r}function h(e,t){var n;return a((n=e&&e.keyName,typeof n===u?n.apply(e):n))}function p(e,t){return a(n.i18n.call(e,"PROP.INSTANCE_NO_KP",{hash:{},data:t}))}function d(e,t){var r="",i;r+="\n      <dd>\n        ",i=n["if"].call(e,e&&e.keyName,{hash:{},inverse:f.program(14,y,t),fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;return r+="\n      </dd>\n      ",r}function v(e,t){var r="",i;r+="\n            ",i=n["if"].call(e,e&&e.windows,{hash:{},inverse:f.program(12,g,t),fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function m(e,t){var r="",i;return r+="\n                "+a((i=e&&e.keyName,typeof i===u?i.apply(e):i))+'\n                <button class="btn btn-blue" id="property-app-keypair">'+a(n.i18n.call(e,"PROP.INSTANCE_GET_WINDOWS_PASSWORD",{hash:{},data:t}))+"</button>\n            ",r}function g(e,t){var n="",r;return n+='\n                <a href="#" id="property-app-keypair">'+a((r=e&&e.keyName,typeof r===u?r.apply(e):r))+"</a>\n            ",n}function y(e,t){var r="";return r+="\n          "+a(n.i18n.call(e,"PROP.INSTANCE_NO_KP",{hash:{},data:t}))+"\n        ",r}function b(e,t){var r="";return r+="\n      <dt>"+a(n.i18n.call(e,"PROP.INSTANCE_USER_DATA",{hash:{},data:t}))+'</dt>\n      <dd><a href="#" id="property-user-data-detail">'+a(n.i18n.call(e,"PROP.INSTANCE_USER_DATA_DETAIL",{hash:{},data:t}))+"</a></dd>\n      ",r}function w(e,t){var r="",i;r+='\n  <div class="option-group-head">'+a(n.i18n.call(e,"PROP.INSTANCE_ROOT_DEVICE",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <article class="property-app">\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP.VOLUME_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.volumeId),{hash:{},data:t}))+"</dd>\n        <dt>"+a(n.i18n.call(e,"PROP.VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.name),{hash:{},data:t}))+"</dd>\n        <dt>"+a(n.i18n.call(e,"PROP.VOLUME_STATE",{hash:{},data:t}))+'</dt>\n        <dd><i class="status status-'+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.status),typeof i===u?i.apply(e):i))+'"></i>'+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.status),typeof i===u?i.apply(e):i))+"</dd>\n        <dt>"+a(n.i18n.call(e,"PROP.VOLUME_CREATE_TIME",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.timeStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.createTime),{hash:{},data:t}))+'</dd>\n      </dl>\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP.VOLUME_TYPE",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.readableVt.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.volumeType),{hash:{},data:t}))+"</dd>\n        ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.snapshotId),{hash:{},inverse:f.noop,fn:f.program(19,E,t),data:t});if(i||i===0)r+=i;r+="\n        <dt>"+a(n.i18n.call(e,"PROP.VOLUME_SIZE",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.size),{hash:{},data:t}))+" GB</dd>\n        <dt>"+a(n.i18n.call(e,"PROP.VOLUME_ENCRYPTED",{hash:{},data:t}))+"</dt>\n        <dd>",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.encrypted),{hash:{},inverse:f.program(23,x,t),fn:f.program(21,S,t),data:t});if(i||i===0)r+=i;r+="</dd>\n        ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),{hash:{},inverse:f.noop,fn:f.program(25,T,t),data:t});if(i||i===0)r+=i;return r+='\n      </dl>\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP.VOLUME_ATTACHMENT_STATE",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.attachmentSet),i==null||i===!1?i:i[0]),i==null||i===!1?i:i.state),{hash:{},data:t}))+"</dd>\n        <dt>"+a(n.i18n.call(e,"PROP.VOLUME_INSTANCE_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.attachmentSet),i==null||i===!1?i:i[0]),i==null||i===!1?i:i.instanceId),{hash:{},data:t}))+"</dd>\n        <dt>"+a(n.i18n.call(e,"PROP.VOLUME_ATTACHMENT_TIME",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.timeStr.call(e,(i=(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.attachmentSet),i==null||i===!1?i:i[0]),i==null||i===!1?i:i.attachTime),{hash:{},data:t}))+"</dd>\n      </dl>\n    </article>\n  </div>\n  ",r}function E(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP.VOLUME_SNAPSHOT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.snapshotId),typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function S(e,t){return a(n.i18n.call(e,"PROP.VOLUME_ENCRYPTED_STATE",{hash:{},data:t}))}function x(e,t){return a(n.i18n.call(e,"PROP.VOLUME_NOT_ENCRYPTED_STATE",{hash:{},data:t}))}function T(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP.INSTANCE_IOPS",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function N(e,t){var r="",i;r+='\n  <div class="option-group-head">'+a(n.i18n.call(e,"PROP.INSTANCE_ENI_DETAIL",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(e,"PROP.ENI_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n      <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.name),typeof i===u?i.apply(e):i))+"</dd>\n\n      <dt>"+a(n.i18n.call(e,"PROP.ENI_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.networkInterfaceId),typeof i===u?i.apply(e):i))+"</dd>\n\n      <dt>"+a(n.i18n.call(e,"PROP.ENI_STATE",{hash:{},data:t}))+'</dt>\n      <dd><i class="status status-'+a((i=(i=e&&e.eni,i==null||i===!1?i:i.status),typeof i===u?i.apply(e):i))+'"></i>'+a((i=(i=e&&e.eni,i==null||i===!1?i:i.status),typeof i===u?i.apply(e):i))+"</dd>\n\n      ",i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.description),{hash:{},inverse:f.noop,fn:f.program(28,C,t),data:t});if(i||i===0)r+=i;r+="\n\n      <dt>"+a(n.i18n.call(e,"PROP.INSTANCE_ENI_SOURCE_DEST_CHECK_DISP",{hash:{},data:t}))+"</dt>\n      <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.sourceDestCheck),typeof i===u?i.apply(e):i))+'</dd>\n    </dl>\n\n    <div class="hidden-details">\n      <a href="#" class="toggle-details js-toggle-dropdown" data-toggle="self-only"><span class="details-off">+ '+a(n.i18n.call(e,"PROP.ENI_SHOW_DETAIL",{hash:{},data:t}))+'</span><span class="details-on">- '+a(n.i18n.call(e,"PROP.ENI_HIDE_DETAIL",{hash:{},data:t}))+'</span></a>\n\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP.ENI_VPC_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.vpcId),typeof i===u?i.apply(e):i))+"</dd>\n\n        <dt>"+a(n.i18n.call(e,"PROP.ENI_SUBNET_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.subnetId),typeof i===u?i.apply(e):i))+"</dd>\n\n        ",i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.attachment),{hash:{},inverse:f.noop,fn:f.program(30,k,t),data:t});if(i||i===0)r+=i;r+='\n      </dl>\n      <dl class="dl-vertical">\n        <dt>'+a(n.i18n.call(e,"PROP.ENI_MAC_ADDRESS",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.eni,i==null||i===!1?i:i.macAddress),{hash:{},data:t}))+"</dd>\n\n        ",i=n["if"].call(e,(i=(i=e&&e.eni,i==null||i===!1?i:i.association),i==null||i===!1?i:i.publicDnsName),{hash:{},inverse:f.noop,fn:f.program(32,L,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.privateDnsName),{hash:{},inverse:f.noop,fn:f.program(34,A,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.ownerId),{hash:{},inverse:f.noop,fn:f.program(36,O,t),data:t});if(i||i===0)r+=i;r+='\n      </dl>\n    </div>\n    <table class="table table-small">\n      <tr>\n        <th>'+a(n.i18n.call(e,"PROP.INSTANCE_ENI_IP_ADDRESS",{hash:{},data:t}))+"</th>\n        <th>"+a(n.i18n.call(e,"PROP.INSTANCE_PUBLIC_IP",{hash:{},data:t}))+"</th>\n      </tr>\n      ",i=n.each.call(e,(i=e&&e.eni,i==null||i===!1?i:i.privateIpAddressesSet),{hash:{},inverse:f.noop,fn:f.program(38,M,t),data:t});if(i||i===0)r+=i;return r+="\n    </table>\n\n  </div>\n  ",r}function C(e,t){var r="",i;return r+="\n      <dt>"+a(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+"</dt>\n      <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.description),typeof i===u?i.apply(e):i))+"</dd>\n      ",r}function k(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP.ENI_ATTACHMENT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=(i=e&&e.eni,i==null||i===!1?i:i.attachment),i==null||i===!1?i:i.attachmentId),{hash:{},data:t}))+"</dd>\n\n        <dt>"+a(n.i18n.call(e,"PROP.ENI_Attachment_OWNER",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=e&&e.eni,i==null||i===!1?i:i.instanceOwnerId),{hash:{},data:t}))+"</dd>\n\n        <dt>"+a(n.i18n.call(e,"PROP.ENI_Attachment_STATE",{hash:{},data:t}))+"</dt>\n        <dd>"+a(n.emptyStr.call(e,(i=(i=e&&e.eni,i==null||i===!1?i:i.attachment),i==null||i===!1?i:i.status),{hash:{},data:t}))+"</dd>\n        ",r}function L(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP.INSTANCE_PUBLIC_DNS",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=(i=e&&e.eni,i==null||i===!1?i:i.association),i==null||i===!1?i:i.publicDnsName),typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function A(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP.INSTANCE_PRIVATE_DNS",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.privateDnsName),typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function O(e,t){var r="",i;return r+="\n        <dt>"+a(n.i18n.call(e,"PROP.ENI_IP_OWNER",{hash:{},data:t}))+"</dt>\n        <dd>"+a((i=(i=e&&e.eni,i==null||i===!1?i:i.ownerId),typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function M(e,t){var r="",i;r+="\n      <tr>\n        <td>"+a((i=e&&e.privateIpAddress,typeof i===u?i.apply(e):i)),i=n["if"].call(e,e&&e.primary,{hash:{},inverse:f.noop,fn:f.program(39,_,t),data:t});if(i||i===0)r+=i;r+="</td>\n        <td>",i=n["if"].call(e,(i=e&&e.association,i==null||i===!1?i:i.publicIp),{hash:{},inverse:f.program(43,P,t),fn:f.program(41,D,t),data:t});if(i||i===0)r+=i;return r+="</td>\n      </tr>\n      ",r}function _(e,t){var r="";return r+="<span>("+a(n.i18n.call(e,"PROP.ENI_PRIMARY",{hash:{},data:t}))+")</span>",r}function D(e,t){var n;return a((n=(n=e&&e.association,n==null||n===!1?n:n.publicIp),typeof n===u?n.apply(e):n))}function P(e,t){return"-"}function H(e,t){var r="",i;r+='\n      <div class="option-group-head expand">\n          '+a(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n      </div>\n      <div class="option-group">\n          ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.program(49,F,t),fn:f.program(46,B,t),data:t});if(i||i===0)r+=i;return r+='\n          <div class="tags-action">\n              \n          </div>\n      </div>\n  ',r}function B(e,t){var r="",i;r+='\n              <table class="table cost-estimation-table">\n                  <tbody>\n                  ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(47,j,t),data:t});if(i||i===0)r+=i;return r+="\n                  </tbody>\n              </table>\n          ",r}function j(e,t){var n="",r;return n+='\n                      <tr> <td style="min-width:70px;">'+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</td><td>"+a(typeof e===u?e.apply(e):e)+"</td> </tr>\n                  ",n}function F(e,t){var r="";return r+='\n              <div class="empty-tag">'+a(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n          ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article class="property-app">\n  ',o=n["if"].call(t,t&&t.isMesosSlave,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n  <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP.INSTANCE_DETAIL",{hash:{},data:i}))+'\n  <a href="#" class="icon-syslog tooltip property-btn-get-system-log" data-tooltip="'+a(n.i18n.call(t,"PROP.INSTANCE_TIP_GET_SYSTEM_LOG",{hash:{},data:i}))+'" ></a>\n</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP.INSTANCE_INSTANCE_ID",{hash:{},data:i}))+"</dt>\n      <dd>"+a((o=t&&t.instanceId,typeof o===u?o.apply(t):o))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.NAME",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.name,{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.description,{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_STATE",{hash:{},data:i}))+'</dt>\n      <dd><i class="status status-'+a((o=t&&t.state,typeof o===u?o.apply(t):o))+'"></i>'+a((o=t&&t.state,typeof o===u?o.apply(t):o))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_LAUNCH_TIME",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.timeStr.call(t,t&&t.launchTime,{hash:{},data:i}))+'</dd>\n    </dl>\n\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP.INSTANCE_PRIMARY_PUBLIC_IP",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.publicIpAddress,{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_PUBLIC_DNS",{hash:{},data:i}))+'</dt>\n      <dd class="click-select tooltip" data-tooltip="'+a(n.i18n.call(t,"PROP.ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:i}))+'">'+a(n.emptyStr.call(t,t&&t.dnsName,{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_PRIMARY_PRIVATE_IP",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.privateIpAddress,{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_PRIVATE_DNS",{hash:{},data:i}))+'</dt>\n      <dd class="click-select tooltip" data-tooltip="'+a(n.i18n.call(t,"PROP.ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:i}))+'">'+a(n.emptyStr.call(t,t&&t.privateDnsName,{hash:{},data:i}))+'</dd>\n    </dl>\n\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP.INSTANCE_AMI",{hash:{},data:i}))+'</dt>\n      <dd><a href="#" data-uid="'+a((o=t&&t.imageId,typeof o===u?o.apply(t):o))+'" id="property-app-ami">'+a((o=t&&t.imageId,typeof o===u?o.apply(t):o))+"</a><dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_TYPE",{hash:{},data:i}))+"</dt>\n      <dd>"+a((o=t&&t.instanceType,typeof o===u?o.apply(t):o))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_KEY_PAIR",{hash:{},data:i}))+"</dt>\n      ",o=n["if"].call(t,t&&t.app_view,{hash:{},inverse:f.program(8,d,i),fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+="\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_CLOUDWATCH_DETAILED_MONITORING",{hash:{},data:i}))+"</dt>\n      <dd>"+a((o=t&&t.monitoringState,typeof o===u?o.apply(t):o))+"</dd>\n      ",o=n["if"].call(t,t&&t.userDataEnabled,{hash:{},inverse:f.noop,fn:f.program(16,b,i),data:i});if(o||o===0)s+=o;s+="\n      <dt>"+a(n.i18n.call(t,"PROP.RESOURCE_TAGS",{hash:{},data:i}))+"</dt>\n      <dd>"+a((o=t&&t.resourceTags,typeof o===u?o.apply(t):o))+'</dd>\n    </dl>\n\n    <dl class="dl-vertical">\n      <dt>'+a(n.i18n.call(t,"PROP.INSTANCE_EBS_OPTIMIZED",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.ebsOptimized,{hash:{},data:i}))+"<dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_TENANCY",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,(o=t&&t.placement,o==null||o===!1?o:o.tenancy),{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_ROOT_DEVICE_TYPE",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.rootDeviceType,{hash:{},data:i}))+"</dd>\n\n      <dt>"+a(n.i18n.call(t,"PROP.INSTANCE_BLOCK_DEVICE",{hash:{},data:i}))+"</dt>\n      <dd>"+a(n.emptyStr.call(t,t&&t.blockDevice,{hash:{},data:i}))+"</dd>\n    </dl>\n  </div>\n  ",o=n["if"].call(t,t&&t.rootDevice,{hash:{},inverse:f.noop,fn:f.program(18,w,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n["if"].call(t,t&&t.eni,{hash:{},inverse:f.noop,fn:f.program(27,N,i),data:i});if(o||o===0)s+=o;s+='\n\n  <div class="option-group-head"> '+a(n.i18n.call(t,"PROP.INSTANCE_SG_DETAIL",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n  ',o=n["if"].call(t,t&&t.tagSet,{hash:{},inverse:f.noop,fn:f.program(45,H,i),data:i});if(o||o===0)s+=o;return s+="\n</article>",s},n.main=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n  <dt>ID</dt><dd>"+a((i=e&&e.id,typeof i===u?i.apply(e):i))+"</dd>\n  <dt>Active</dt><dd>",i=n["if"].call(e,e&&e.active,{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+='</dd>\n  <dt></dt><dd></dd>\n  <dt>Attributes</dt>\n  <dd>\n    <table class="table">\n      <tr>\n        <th>Key</th><th>Value</th>\n      </tr>\n      ',i=n.each.call(e,e&&e.attributes,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+='\n    </table>\n  </dd>\n  <dt>Resources</dt>\n  <dd>\n    <table class="table">\n      <tr>\n        <th>Key</th><th>Value</th>\n      </tr>\n      ',i=n.each.call(e,e&&e.resources,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;return r+="\n    </table>\n  </dd>\n  ",r}function c(e,t){return"true"}function h(e,t){return"false"}function p(e,t){var n="",r;return n+="\n      <tr>\n        <td>"+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</td>\n        <td>"+a(typeof e===u?e.apply(e):e)+"</td>\n      </tr>\n      ",n}function d(e,t){return"\n  <dt>Mesos Data is not ready yet...</dt>\n  <dd></dd>\n  "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<dl class="dl-vertical">\n  ',o=n["if"].call(t,t,{hash:{},inverse:f.program(8,d,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</dl>",s},n.mesosData=e.template(t),n}),define("wspace/awseditor/property/instance/app_view",["../base/view","./template/app","i18n!/nls/lang.js","ApiRequest","kp_upload","Design","JsonExporter","UI.modalplus"],function(e,t,n,r,i,s,o,u){var a,f,l;return f=o.download,l=function(e,t){return function(){var n;return $("body").hasClass("safari")?n=null:n=new Blob([t]),n?(f(n,e),null):{data:"data:text/plain;,"+t,name:e}}},a=e.extend({__kpUpload:null,events:{"click #property-app-keypair":"keyPairClick","click #property-app-ami":"openAmiPanel","click .property-btn-get-system-log":"openSysLogModal","click #property-user-data-detail":"viewUserDataDetail"},render:function(){var e;return e=this.model.toJSON(),e.windows=this.model.get("osType")==="windows",this.$el.html(t.main(e)),this.resModel.isMesosSlave()&&this.renderMesosData(),this.model.attributes.name},renderMesosData:function(){var e;return e=this.resModel.getMesosAppAttributes(this.model.get("instanceId")),this.$("#mesos-data-area").html(t.mesosData(e))},keyPairClick:function(e){return this.proccessKpStuff()},proccessKpStuff:function(e){var t,n,r,i;return e||(i=this.resModel.connectionTargets("KeypairUsage")[0],t=i&&i.isDefault()&&i.get("appId")==="DefaultKP---"+s.instance().get("id"),r=i&&!i.isDefault(),n=t||r,n&&this.model.downloadKp(kpName)),!n&&this.model.get("osType")==="windows"?this.decryptPassword():this.loginPrompt()},loginPrompt:function(){var e,t;return e=this.model.get("keyName"),new u({title:e,width:420,template:MC.template.modalDownloadKP({loginCmd:this.model.get("loginCmd"),windows:this.model.get("osType")==="windows"}),confirm:{hide:!0}}),t=this,$("#keypair-cmd").off("click").on("click",function(e){return e.currentTarget.select&&e.currentTarget.select(),e.stopPropagation()}),!1},decryptPassword:function(){var e;return e=this,this.kpModal=new u({title:n.IDE.GET_WINDOWS_PASSWORD,width:500,template:MC.template.modalDecryptPassword({name:this.model.get("keyName"),isOldKp:!1}),disableFooter:!0}),this.model.getPassword().then(function(t){return e.updateKPModal("check",!!t)},function(){return notification("error",n.NOTIFY.ERR_GET_PASSWD_FAILED)}),$("#do-kp-decrypt").off("click").on("click",function(t){return e.model.getPassword(e.__kpUpload.getData()).then(function(t){return e.updateKPModal("got",t)},function(){return notification("error",n.NOTIFY.ERR_GET_PASSWD_FAILED)})}),!1},updateKPModal:function(e,t,n,r){var s,o,u,a,f;if(this.kpModal.isClosed)return;if(e==="check")return t?(this.__kpUpload&&this.__kpUpload.remove(),this.__kpUpload=new i({type:"Private Key"}),this.__kpUpload.on("load",function(){return $("#do-kp-decrypt").prop("disabled",!1)}),this.kpModal.$(".import-zone").html(this.__kpUpload.render().el),this.kpModal.$(".decrypt-action").show()):(this.kpModal.$(".import-zone").html(""),this.kpModal.$(".no-password").show());if(e==="got")return $("#do-kp-decrypt").prop("disabled",!0),s=$("#keypair-pwd"),u=s.get(0),s.val(t),u.select(),u.focus(),$("#do-kp-decrypt").text("Decrypted"),$(".change-pw-recommend").show();if(e==="download"){f=t,a=n,o=r||n,$("#keypair-kp-download").off("click").on("click",l(""+this.model.get("keyName")+".pem",o)),$("#keypair-loading").hide(),$("#keypair-body").show();if(this.model.get("osType")==="windows")return $("#keypair-pwd-old").val(a).off("click").on("click",function(){return this.select()}),$("#keypair-show").one("click",function(){return $("#keypair-pwd-old").prop("type","input")})}},openAmiPanel:function(e){return this.trigger("OPEN_AMI",$(e.target).data("uid")),!1},openSysLogModal:function(){var e,t;return e=this.model.get("instanceId"),this.sysLogModal=(new u({template:MC.template.modalInstanceSysLog({log_content:""}),width:900,title:n.IDE.SYSTEM_LOG+e,confirm:{hide:!0}})).tpl.attr("id","modal-instance-sys-log"),t=this,r("ins_GetConsoleOutput",{key_id:s.instance().credentialId(),region_name:s.instance().region(),instance_id:e}).then(function(e){var n;return t.refreshSysLog((n=e.GetConsoleOutputResponse)!=null?n.output:void 0),t.sysLogModal.resize()},function(){return t.refreshSysLog(null,n.IDE.SYSTEM_LOG_NOT_READY),t.sysLogModal.resize()}),!1},viewUserDataDetail:function(){var e,t;return t=this.model.get("userData"),e=this,this.userDataLog=(new u({template:MC.template.modalInstanceSysLog({log_content:MC.template.convertBreaklines({content:t})}),width:900,title:n.PROP.INSTANCE_USER_DATA,confirm:{hide:!0}})).tpl.attr("id","modal-instance-sys-log"),r("ins_DescribeInstanceAttribute",{key_id:s.instance().credentialId(),region_name:s.instance().region(),instance_id:e.model.get("id"),attribute_name:"userData"}).then(function(n){var r,i;return void 0,t=n!=null?(r=n.DescribeInstanceAttributeResponse)!=null?(i=r.userData)!=null?i.value:void 0:void 0:void 0,e.refreshSysLog(t),e.userDataLog.resize()},function(){return e.refreshSysLog(null,n.IDE.USER_DATA_FETCH_FAILED),e.userDataLog.resize()})},refreshSysLog:function(e,t){var n,r;return $("#modal-instance-sys-log .instance-sys-log-loading").hide(),t?$("#modal-instance-sys-log .instance-sys-log-info").text(t).show():(e=e||"",r=Base64.decode(e),n=$("#modal-instance-sys-log .instance-sys-log-content"),n.html(MC.template.convertBreaklines({content:r})),n.show())}}),new a}),define("wspace/awseditor/property/instance/main",["../base/main","./model","./view","./app_model","./app_view","../sglist/main","constant","event","Design"],function(e,t,n,r,i,s,o,u,a){var f,l;return l={},l[u.PROPERTY_REFRESH_ENI_IP_LIST]=function(){return this.model.getEni&&this.model.getEni(),this.view.refreshIPList&&this.view.refreshIPList(),null},f=e.extend({ideEvents:l,handleTypes:[o.RESTYPE.INSTANCE,"component_asg_instance"],onUnloadSubPanel:function(e){return s.onUnloadSubPanel(e),null},setupStack:function(){return this.view.on("OPEN_AMI",function(t){return e.loadSubPanel("STATIC",t)}),null},initStack:function(e){return this.model=t,this.view=n,this.view.resModel=a.instance().component(e),null},afterLoadStack:function(){return s.loadModule(this.model),null},setupApp:function(){var t;return t=this,this.view.on("OPEN_AMI",function(t){return e.loadSubPanel("STATIC",t)}),null},initApp:function(e){var t,s,u;return this.model=r,this.view=i,u=a.instance().component(e),u||(t=a.modelClassForType(o.RESTYPE.INSTANCE).getEffectiveId(e),u=a.instance().component(t.uid)),this.model.effective=t,this.view.resModel=this.model.resModel=u,s=a.instance().opsModel(),u.isMesosSlave()&&this.view.listenTo(s.getMesosData(),"change",n.renderMesosData),null},afterLoadApp:function(){return s.loadModule(this.model),null}}),null}),define("wspace/awseditor/property/servergroup/app_model",["../base/model","../instance/model","constant","i18n!/nls/lang.js","Design","CloudResources"],function(e,t,n,r,i,s){var o;return o=e.extend({init:function(e){var t,n,s,o,u;return this.set("uid",e),this.set("readOnly",!this.isAppEdit),this.set("isMesos",this.resModel.isMesos()),this.set("isMesosMaster",this.resModel.isMesosMaster()),this.set("isMesosSlave",this.resModel.isMesosSlave()),this.set("tags",i.instance().component(e).tags()),n=this.resModel.get("imageId"),t=this.resModel.getAmi()||this.resModel.get("cachedAmi"),t?(this.set("ami",{id:n,name:t.name||t.description||t.id,icon:""+t.osType+"."+t.architecture+"."+t.rootDeviceType+".png",type:t.rootDeviceType}),this.set("type_editable",t.rootDeviceType!=="instance-store")):notification("warning",sprintf(r.NOTIFY.ERR_AMI_NOT_FOUND,n)),s=this.resModel.getBlockDeviceMapping(),s.length===1&&this.set("rootDevice",s[0]),u=this.resModel.get(!0),this.set("instance_type",this.resModel.getInstanceTypeList()),this.set("ebs_optimized",this.resModel.get("ebsOptimized")),this.set("can_set_ebs",this.resModel.isEbsOptimizedEnabled()),o=this.resModel.connectionTargets("RTB_Route").length,o&&this.set("number_disable",!0),this.set("number",this.resModel.get("count")),this.set("name",this.resModel.get("name")),this.set("monitoring",this.resModel.get("monitoring")),this.set("description",this.resModel.get("description")),this.set("displayCount",this.resModel.get("count")-1),this.set("userData",this.resModel.get("userData")),this.getGroupList(),this.getEni(),null},setCount:function(e){var t;return t=this.get("uid"),i.instance().component(t).setCount(e),this.getGroupList(),null},getGroupList:function(){var e,t,r,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;v=this.get("uid"),t=i.instance().component(v),d=s(i.instance().credentialId(),n.RESTYPE.INSTANCE,i.instance().region()),e=(w=s(i.instance().credentialId(),n.RESTYPE.INSTANCE,i.instance().region()).get(t.get("appId")))!=null?w.toJSON():void 0,p=t.get("name"),a=[{appId:t.get("appId"),name:p+"-0",status:e?e.instanceState.name:"Unknown",launchTime:e?e.launchTime:""}],r=t.get("count"),t.groupMembers().length>r-1?h=t.groupMembers().slice(0,r-1):h=t.groupMembers();for(l=m=0,y=h.length;m<y;l=++m)c=h[l],a.push({name:p+"-"+(l+1),appId:c.appId,status:d.get(c.appId)?d.get(c.appId).attributes.instanceState.name:"Unknown",isNew:!c.appId,isOld:c.appId&&l+1>=r});while(a.length<r)a.push({name:p+"-"+a.length,isNew:!0,status:"Unknown"});u=0,E=t.groupMembers();for(f=g=0,b=E.length;g<b;f=++g){o=E[f];if(!o.appId)break;u=f+1}return u+=1,a.length>1?(this.set("group",a),u>r?a.increment="-"+(u-r):u<r&&(a.increment="+"+(r-u))):this.set("group",a[0]),null},getEni:t.getEni,setEbsOptimized:t.setEbsOptimized,canSetInstanceType:t.canSetInstanceType,setInstanceType:t.setInstanceType,setIp:t.setIp,canAddIP:t.canAddIP,isValidIp:t.isValidIp,addIp:t.addIp,removeIp:t.removeIp,attachEip:t.attachEip,setMonitoring:t.setMonitoring,setSourceCheck:t.setSourceCheck,setUserData:t.setUserData}),new o}),define("wspace/awseditor/property/servergroup/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return'class="expand"'}function c(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.INSTANCE_DETAIL",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n\n    <section class="property-control-group" data-bind="true">\n        <label class="left" for="property-instance-name" >'+u(n.i18n.call(e,"PROP.INSTANCE_HOSTNAME",{hash:{},data:t}))+'</label>\n        <span class="required-input right">'+u(n.i18n.call(e,"PROP.INSTANCE_REQUIRE",{hash:{},data:t}))+'</span>\n\n        <div class="property-instance-name-wrap ',i=n.ifCond.call(e,e&&e.count,1,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+='">\n            <div class="name-count-wrap">\n                -[0-<span id="property-instance-name-count">'+u((i=e&&e.displayCount,typeof i===a?i.apply(e):i))+'</span>]\n            </div>\n            <div class="fitfloat">\n                <input class="input instance-name"  type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-instance-name" data-ignore="true" data-required-rollback="true"/>\n            </div>\n        </div>\n    </section>\n\n    <section class="property-control-group" data-bind="true">\n        <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n        <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+"</textarea>\n    </section>\n\n    ",i=n.unless.call(e,e&&e.isMesosMaster,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n["if"].call(e,e&&e.ami,{hash:{},inverse:f.noop,fn:f.program(11,m,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n["if"].call(e,e&&e.type_editable,{hash:{},inverse:f.program(25,N,t),fn:f.program(14,y,t),data:t});if(i||i===0)r+=i;r+='\n  </div>\n\n  <div class="option-group-head">'+u(n.i18n.call(e,"PROP.INSTANCE_ADVANCED_DETAIL",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <section class="property-control-group">\n      <div class="checkbox">\n        ',i=n["if"].call(e,e&&e.monitoring,{hash:{},inverse:f.program(29,k,t),fn:f.program(27,C,t),data:t});if(i||i===0)r+=i;r+='\n        <label for="property-instance-enable-cloudwatch"></label>\n      </div>\n      <label for="property-instance-enable-cloudwatch" >'+u(n.i18n.call(e,"PROP.INSTANCE_CW_ENABLED",{hash:{},data:t}))+'</label>\n\n      <p class="',i=n.unless.call(e,e&&e.monitoring,{hash:{},inverse:f.noop,fn:f.program(21,x,t),data:t});if(i||i===0)r+=i;r+=' property-info" id="property-cloudwatch-warn">'+u(n.i18n.call(e,"PROP.INSTANCE_CW_WARN",{hash:{},data:t}))+'<a target="_blank" href="http://aws.amazon.com/cloudwatch">'+u(n.i18n.call(e,"PROP.SG_AMAZON_CLOUD_WATCH_PRODUCT_PAGE",{hash:{},data:t}))+"</a></p>\n    </section>\n  </div>\n\n  ",i=n["if"].call(e,e&&e.rootDevice,{hash:{},inverse:f.noop,fn:f.program(31,L,t),data:t});if(i||i===0)r+=i;r+="\n\n  ",i=n["if"].call(e,e&&e.eni,{hash:{},inverse:f.noop,fn:f.program(36,M,t),data:t});if(i||i===0)r+=i;r+='\n\n  <div class="option-group-head"> '+u(n.i18n.call(e,"PROP.INSTANCE_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n  <div class="option-group-head">\n    '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n  </div>\n  <div class="option-group">\n    ',i=n["if"].call(e,(i=e&&e.tags,i==null||i===!1?i:i.length),{hash:{},inverse:f.program(44,B,t),fn:f.program(41,P,t),data:t});if(i||i===0)r+=i;return r+='\n    <div class="tags-action">\n      \n      <button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>\n    </div>\n  </div>\n  ",r}function h(e,t){return"single"}function p(e,t){var r="",i;r+='\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-instance-count" >'+u(n.i18n.call(e,"PROP.INSTANCE_NUMBER",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.INSTANCE_REQUIRE",{hash:{},data:t}))+'</span>\n      <input class="input tooltip" type="text" value="'+u((i=e&&e.number,typeof i===a?i.apply(e):i))+'" id="property-instance-count" data-ignore="true" data-required="true" data-type="digits" ',i=n["if"].call(e,e&&e.number_disable,{hash:{},inverse:f.program(9,v,t),fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="/>\n    </section>\n    ",r}function d(e,t){var r="";return r+='disabled="disabled" data-tooltip="'+u(n.i18n.call(e,"PROP.INSTANCE_TIP_YOU_CANNOT_SPECIFY_INSTANCE_NUMBER",{hash:{},data:t}))+'"',r}function v(e,t){var r="";return r+='data-tooltip="'+u(n.i18n.call(e,"PROP.INSTANCE_TIP_IF_THE_QUANTITY_IS_MORE_THAN_1",{hash:{},data:t}))+'"',r}function m(e,t){var r="",i;r+="\n    ",i=n.unless.call(e,e&&e.isMesos,{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;return r+="\n    ",r}function g(e,t){var r="",i;return r+='\n    <section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP.INSTANCE_AMI",{hash:{},data:t}))+'</label>\n      <div id="property-ami" class="property-block-wrap clearfix" data-uid=\''+u((i=(i=e&&e.ami,i==null||i===!1?i:i.id),typeof i===a?i.apply(e):i))+'\'>\n        <img class="property-ami-icon left" src="/assets/images/ide/ami/'+u((i=(i=e&&e.ami,i==null||i===!1?i:i.icon),typeof i===a?i.apply(e):i))+'" / >\n        <div class="property-ami-label">'+u((i=(i=e&&e.ami,i==null||i===!1?i:i.name),typeof i===a?i.apply(e):i))+"</div>\n      </div>\n    </section>\n    ",r}function y(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,(i=e&&e.instance_type,i==null||i===!1?i:i.length),{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+="\n    ",r}function b(e,t){var r="",i;r+='\n    <section class="property-control-group">\n      <label class="left">'+u(n.i18n.call(e,"PROP.INSTANCE_TYPE",{hash:{},data:t}))+'</label>\n      <div class="selectbox selectbox-mega" id="instance-type-select">\n        <div class="selection"></div>\n        <ul class="dropdown">\n          ',i=n.each.call(e,e&&e.instance_type,{hash:{},inverse:f.noop,fn:f.program(16,w,t),data:t});if(i||i===0)r+=i;r+='\n        </ul>\n      </div>\n    </section>\n    <section class="property-control-group ',i=n.unless.call(e,e&&e.can_set_ebs,{hash:{},inverse:f.noop,fn:f.program(21,x,t),data:t});if(i||i===0)r+=i;r+='">\n      <div class="checkbox">\n        <input id="property-instance-ebs-optimized" type="checkbox" value="None" ',i=n["if"].call(e,e&&e.ebs_optimized,{hash:{},inverse:f.noop,fn:f.program(23,T,t),data:t});if(i||i===0)r+=i;return r+=' name="ebs-optimized" />\n        <label for="property-instance-ebs-optimized"></label>\n      </div>\n      <label for="property-instance-ebs-optimized">'+u(n.i18n.call(e,"PROP.INSTANCE_EBS_OPTIMIZED",{hash:{},data:t}))+"</label>\n    </section>\n    ",r}function w(e,t){var r="",i;r+='\n          <li class="',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:f.noop,fn:f.program(17,E,t),data:t});if(i||i===0)r+=i;r+='tooltip item" data-tooltip="'+u((i=e&&e.main,typeof i===a?i.apply(e):i))+'" data-id="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.hide,{hash:{},inverse:f.noop,fn:f.program(19,S,t),data:t});if(i||i===0)r+=i;return r+='>\n            <div class="main truncate">'+u((i=e&&e.main,typeof i===a?i.apply(e):i))+'</div>\n            <div class="sub"><span>'+u((i=e&&e.ecu,typeof i===a?i.apply(e):i))+"</span> <span>"+u((i=e&&e.core,typeof i===a?i.apply(e):i))+"</span> <span>"+u((i=e&&e.mem,typeof i===a?i.apply(e):i))+"</span></div>\n          </li>\n          ",r}function E(e,t){return"selected "}function S(e,t){return'style="display:none;"'}function x(e,t){return"hide"}function T(e,t){return'checked="checked"'}function N(e,t){var r="";return r+='\n    <section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP.INSTANCE_TYPE",{hash:{},data:t}))+'</label>\n      <p class="property-info">'+u(n.i18n.call(e,"PROP.SG_UPDATE_INSTANCE_TYPE_DISABLED_FOR_INSTANCE_STORE",{hash:{},data:t}))+"</p>\n    </section>\n    ",r}function C(e,t){return'\n        <input id="property-instance-enable-cloudwatch" type="checkbox" checked="true" value="None" name="property-instance-enable-cloudwatch" />\n        '}function k(e,t){return'\n        <input id="property-instance-enable-cloudwatch" type="checkbox" value="None" name="property-instance-enable-cloudwatch" />\n        '}function L(e,t){var r="",i;r+='\n  <div class="option-group-head">Root Device</div>\n  <div class="option-group">\n    <article class="property-app">\n      <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(e,"PROP.VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.DeviceName),{hash:{},data:t}))+"</dd>\n        <dt>"+u(n.i18n.call(e,"PROP.VOLUME_TYPE",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.emptyStr.call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.VolumeType),{hash:{},data:t}))+"</dd>\n        ",i=n["if"].call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.SnapshotId),{hash:{},inverse:f.noop,fn:f.program(32,A,t),data:t});if(i||i===0)r+=i;r+="\n        <dt>"+u(n.i18n.call(e,"PROP.VOLUME_SIZE",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.emptyStr.call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.VolumeSize),{hash:{},data:t}))+" GB</dd>\n        ",i=n["if"].call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.Iops),{hash:{},inverse:f.noop,fn:f.program(34,O,t),data:t});if(i||i===0)r+=i;return r+="\n      </dl>\n    </article>\n  </div>\n  ",r}function A(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP.VOLUME_SNAPSHOT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.SnapshotId),typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function O(e,t){var n="",r;return n+="\n        <dt>IOPS</dt>\n        <dd>"+u((r=(r=(r=e&&e.rootDevice,r==null||r===!1?r:r.Ebs),r==null||r===!1?r:r.Iops),typeof r===a?r.apply(e):r))+"</dd>\n        ",n}function M(e,t){var r="",i;r+='\n  <div class="option-group-head">'+u(n.i18n.call(e,"PROP.INSTANCE_ENI_DETAIL",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <section class="property-control-group">\n      <div class="checkbox">\n        ',i=n["if"].call(e,(i=e&&e.eni,i==null||i===!1?i:i.sourceDestCheck),{hash:{},inverse:f.program(39,D,t),fn:f.program(37,_,t),data:t});if(i||i===0)r+=i;return r+='\n        <label for="property-instance-source-check"></label>\n      </div>\n      <label for="property-instance-source-check">'+u(n.i18n.call(e,"PROP.INSTANCE_ENI_SOURCE_DEST_CHECK",{hash:{},data:t}))+'</label>\n    </section>\n    <section class="property-control-group">\n      <div class="network-list-wrap">\n        <div class="network-list-header clearfix">\n          '+u(n.i18n.call(e,"PROP.INSTANCE_ENI_IP_ADDRESS",{hash:{},data:t}))+'\n          <button id="instance-ip-add" class="right btn btn-blue btn-small tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ENI_TIP_ADD_IP_ADDRESS",{hash:{},data:t}))+'">'+u(n.i18n.call(e,"PROP.INSTANCE_ENI_ADD_IP",{hash:{},data:t}))+'</button>\n        </div>\n        <ul class="network-list" id="property-network-list" data-bind="true"></ul>\n      </div>\n    </section>\n  </div>\n  ',r}function _(e,t){return'\n        <input id="property-instance-source-check" type="checkbox" checked="true" value="None" name="property-instance-source-check" />\n        '}function D(e,t){return'\n        <input id="property-instance-source-check" type="checkbox" value="None" name="property-instance-source-check" />\n        '}function P(e,t){var r="",i;r+='\n    <table class="table cost-estimation-table">\n      <tbody>\n      ',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(42,H,t),data:t});if(i||i===0)r+=i;return r+="\n      </tbody>\n    </table>\n    ",r}function H(e,t){var n="",r;return n+='\n      <tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n      ",n}function B(e,t){var r="";return r+='\n    <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n  <div id="prop-appedit-ami-list" ',o=n["if"].call(t,t&&t.readOnly,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+=">\n\n  </div>\n  ",o=n.unless.call(t,t&&t.readOnly,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+="\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/servergroup/template/ami_list",["handlebars"],function(e){var t=function(e,t,n,r,i){function f(e,t){var r="",i;r+="\n",i=n.unless.call(e,(i=e&&e.group,i==null||i===!1?i:i.length),{hash:{},inverse:o.program(5,h,t),fn:o.program(2,l,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function l(e,t){var r="",i;r+='\n<div class="option-group-head ',i=n["if"].call(e,e&&e.readOnly,{hash:{},inverse:o.noop,fn:o.program(3,c,t),data:t});if(i||i===0)r+=i;return r+='">'+u(n.i18n.call(e,"PROP.SG_INSTANCE_SUMMARY",{hash:{},data:t}))+'</div>\n<div class="option-group">\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(e,"PROP.INSTANCE_INSTANCE_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=(i=e&&e.group,i==null||i===!1?i:i.appId),typeof i===a?i.apply(e):i))+"</dd>\n\n    <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_STATE",{hash:{},data:t}))+'</dt>\n    <dd><i class="status status-'+u((i=(i=e&&e.group,i==null||i===!1?i:i.status),typeof i===a?i.apply(e):i))+' icon-label"></i>'+u((i=(i=e&&e.group,i==null||i===!1?i:i.status),typeof i===a?i.apply(e):i))+"</dd>\n\n    <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_LAUNCH_TIME",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.timeStr.call(e,(i=e&&e.group,i==null||i===!1?i:i.launchTime),{hash:{},data:t}))+"</dd>\n  </dl>\n<div>\n",r}function c(e,t){return"expand"}function h(e,t){var r="",i;r+='\n<div class="option-group-head ',i=n["if"].call(e,e&&e.readOnly,{hash:{},inverse:o.noop,fn:o.program(3,c,t),data:t});if(i||i===0)r+=i;r+='">'+u(n.i18n.call(e,"PROP.SG_SERVER_GROUP_MEMBERS",{hash:{},data:t}))+'<span class="property-head-num-wrap">('+u((i=(i=e&&e.group,i==null||i===!1?i:i.length),typeof i===a?i.apply(e):i))+')</span> <span class="appedit-head-meta appedit-head-meta-add">'+u((i=(i=e&&e.group,i==null||i===!1?i:i.increment),typeof i===a?i.apply(e):i))+'</span></div>\n<ul class="option-group mega-list-wraper">\n  ',i=n.each.call(e,e&&e.group,{hash:{},inverse:o.noop,fn:o.program(6,p,t),data:t});if(i||i===0)r+=i;return r+="\n</ul>\n",r}function p(e,t){var r="",i;r+='\n    <li>\n      <i class="status status-'+u((i=e&&e.status,typeof i===a?i.apply(e):i))+' icon-label tooltip" data-tooltip="'+u((i=e&&e.status,typeof i===a?i.apply(e):i))+'"></i>'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+"\n      ",i=n["if"].call(e,e&&e.appId,{hash:{},inverse:o.noop,fn:o.program(7,d,t),data:t});if(i||i===0)r+=i;r+="\n      ",i=n["if"].call(e,e&&e.isNew,{hash:{},inverse:o.program(11,m,t),fn:o.program(9,v,t),data:t});if(i||i===0)r+=i;return r+="\n    </li>\n  ",r}function d(e,t){var n="",r;return n+='<span class="subtitle">('+u((r=e&&e.appId,typeof r===a?r.apply(e):r))+")</span>",n}function v(e,t){var r="";return r+='<div class="subtitle subtitle-launch">'+u(n.i18n.call(e,"PROP.SG_LAUNCH_AFTER_APPLYING_UPDATES",{hash:{},data:t}))+"</div>\n      ",r}function m(e,t){var r="",i;i=n["if"].call(e,e&&e.isOld,{hash:{},inverse:o.noop,fn:o.program(12,g,t),data:t});if(i||i===0)r+=i;return r+="\n      ",r}function g(e,t){var r="";return r+='<div class="subtitle subtitle-terminate">'+u(n.i18n.call(e,"PROP.SG_TERMINATE_AFTER_APPLYING_UPDATE",{hash:{},data:t}))+"</div>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this,u=this.escapeExpression,a="function";return s=n["if"].call(t,t&&t.group,{hash:{},inverse:o.noop,fn:o.program(1,f,i),data:i}),s||s===0?s:""};return e.template(t)}),define("wspace/awseditor/property/servergroup/app_view",["../base/view","../instance/view","./template/app","./template/ami_list","i18n!/nls/lang.js"],function(e,t,n,r,i){var s;return s=e.extend({events:{"change .instance-name":"instanceNameChange","change #property-res-desc":"onChangeDesc","change #property-instance-count":"countChange","click #property-ami":"openAmiPanel","OPTION_CHANGE #instance-type-select":"instanceTypeSelect","change #property-instance-ebs-optimized":"ebsOptimizedSelect","click .toggle-eip":"setEip","click #instance-ip-add":"addIp","click #property-network-list .icon-remove":"removeIp","change .input-ip":"syncIPList","change #property-instance-enable-cloudwatch":"cloudwatchSelect","change #property-instance-source-check":"sourceCheckChange"},render:function(){return this.$el.html(n(this.model.attributes)),this.updateInstanceList(),this.refreshIPList(),this.model.attributes.name},instanceNameChange:function(e){var t,n;return n=$(e.currentTarget),t=n.val(),MC.aws.aws.checkResName(this.model.get("uid"),n,"Instance")&&(this.model.setName(t),this.setTitle(t)),null},openAmiPanel:function(e){return this.trigger("OPEN_AMI",$(e.currentTarget).data("uid")),!1},updateInstanceList:function(){return $("#prop-appedit-ami-list").html(r(this.model.attributes)),null},updateUserData:t.userdataChange,countChange:function(e){var t,n;t=$(e.currentTarget),t.parsley("custom",function(e){if(isNaN(e)||e>99||e<1)return i.PARSLEY.THIS_VALUE_MUST_BETWEEN_1_99});if(!t.parsley("validate"))return;return n=+t.val(),this.model.setCount(n),this.updateInstanceList(),$(".property-instance-name-wrap").toggleClass("single",n===1),$("#property-instance-name-count").text(n-1),this.setEditableIP(n===1),null},onChangeDesc:function(e){return this.model.setDesc($(e.currentTarget).val())},ebsOptimizedSelect:function(e){return this.model.setEbsOptimized(e.target.checked),null},instanceTypeSelect:t.instanceTypeSelect,cloudwatchSelect:t.cloudwatchSelect,sourceCheckChange:t.sourceCheckChange,addIp:t.addIp,removeIp:t.removeIp,setEip:t.setEip,syncIPList:t.syncIPList,refreshIPList:t.refreshIPList,updateIPAddBtnState:t.updateIPAddBtnState,setEditableIP:t.setEditableIP,validateIpItem:t.validateIpItem,bindIpItemValidate:t.bindIpItemValidate}),new s}),define("wspace/awseditor/property/servergroup/main",["../base/main","./app_model","./app_view","../sglist/main","constant","event"],function(e,t,n,r,i,s){var o,u;return u={},u[s.PROPERTY_REFRESH_ENI_IP_LIST]=function(){return this.model.getEni(),this.view.refreshIPList(),null},o=e.extend({ideEvents:u,handleTypes:"component_server_group",onUnloadSubPanel:function(e){return r.onUnloadSubPanel(e),null},initApp:function(){return this.model=t,this.model.isAppEdit=!1,this.view=n,null},setupAppEdit:function(){return this.view.on("OPEN_AMI",function(t){return e.loadSubPanel("STATIC",t)}),null},initAppEdit:function(e){return this.model=t,this.model.isAppEdit=!0,this.model.resModel=Design.instance().component(e),this.view=n,null},afterLoadAppEdit:function(){return r.loadModule(this.model),null}}),null}),define("wspace/awseditor/property/connection/model",["../base/model","Design","constant","i18n!/nls/lang.js"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var i,s;return s=t.instance().component(e),s?(s.type==="EniAttachment"?i={name:r.PROP.ENI_ATTACHMENT_NAME,eniAsso:{instance:s.getTarget(n.RESTYPE.INSTANCE).get("name"),eni:s.getTarget(n.RESTYPE.ENI).get("name")}}:s.type==="ElbSubnetAsso"&&(i={name:r.PROP.ELB_SUBNET_ASSO_NAME,subnetAsso:{elb:s.getTarget(n.RESTYPE.ELB).get("name"),subnet:s.getTarget(n.RESTYPE.SUBNET).get("name")}}),this.set(i)):!1}}),new i}),define("wspace/awseditor/property/connection/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function f(e,t){var r="",i;return r+='\n	<div class="property-control-group">'+u(n.i18n.call(e,"PROP.CONNECTION_ATTACHMENT_OF",(i=e&&e.eniAsso,i==null||i===!1?i:i.instance),(i=e&&e.eniAsso,i==null||i===!1?i:i.eni),{hash:{},data:t}))+"</div>\n",r}function l(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e&&e.subnetAsso,{hash:{},inverse:a.noop,fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){var r="",i;return r+='\n  <div class="property-control-group">'+u(n.i18n.call(e,"PROP.CONNECTION_SUBNET_ASSO_PLACEMENT",(i=e&&e.subnetAsso,i==null||i===!1?i:i.subnet),(i=e&&e.subnetAsso,i==null||i===!1?i:i.elb),{hash:{},data:t}))+"</div>\n  ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this;s+="<article>\n\n",o=n["if"].call(t,t&&t.eniAsso,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/connection/view",["../base/view","./template/stack"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name}}),new n}),define("wspace/awseditor/property/connection/main",["../base/main","./model","./view"],function(e,t,n){var r;return r=e.extend({handleTypes:["EniAttachment","ElbSubnetAsso"],initStack:function(){return this.model=t,this.view=n,null},initApp:function(){return this.model=t,this.view=n,null},initAppEdit:function(){return this.model=t,this.view=n,null}}),null}),define("wspace/awseditor/property/staticsub/model",["../base/model","constant","../base/main","CloudResources","Design","i18n!/nls/lang.js"],function(e,t,n,r,i,s){var o;return o=e.extend({init:function(e){var n,s,o;this.set("isApp",this.isApp),n=i.modelClassForType(t.RESTYPE.INSTANCE),s=r(i.instance().credentialId(),t.RESTYPE.AMI,i.instance().region()).get(e);if(s){s=s.toJSON(),this.set(s),this.set("instance_type",(n.getInstanceType(s,i.instance().region())||[]).join(", ")),this.set("ami",!0),this.set("name",s.name);return}if(e.indexOf("ami-")===0){this.set("ami",{unavailable:!0}),this.set("name",e);return}return this.set("name",e),o=r(i.instance().credentialId(),t.RESTYPE.SNAP,i.instance().region()).get(e),o?(this.set(o.attributes),!0):!1},canChangeAmi:function(e){var o,u,a,f;return o=i.instance().component(n.activeModule().uid),f=o.getAmi()||o.get("cachedAmi"),a=r(i.instance().credentialId(),t.RESTYPE.AMI,i.instance().region()).get(e),a&&(a=a.toJSON()),!f&&!a?s.PROP.STATICSUB_VALIDATION_AMI_INFO_MISSING:f.osType==="windows"&&a.osType!=="windows"?sprintf(s.PROP.STATICSUB_VALIDATION_AMI_TYPE_NOT_SUPPORT,a.osFamily):f.osType!=="windows"&&a.osType==="windows"?sprintf(s.PROP.STATICSUB_VALIDATION_AMI_TYPE_NOT_SUPPORT,a.osFamily):(u=i.modelClassForType(t.RESTYPE.INSTANCE).getInstanceType(a,i.instance().region()),u.indexOf(o.get("instanceType"))===-1?sprintf(s.PROP.STATICSUB_VALIDATION_AMI_INSTANCETYPE_NOT_VALID,a.name,o.get("instanceType")):!0)},getAmiPngName:function(e){var n;return n=r(i.instance().credentialId(),t.RESTYPE.AMI,i.instance().region()).get(e),n?(n=n.attributes,""+n.osType+"."+n.architecture+"."+n.rootDeviceType):"ami-not-available"},getAmiName:function(e){var n;return n=r(i.instance().credentialId(),t.RESTYPE.AMI,i.instance().region()).get(e),n?n.get("name"):""},changeAmi:function(e){return i.instance().component(n.activeModule().uid).setAmi(e),this.init(e),null},getInstanceName:function(){return i.instance().component(n.activeModule().uid).get("name")}}),new o}),define("wspace/awseditor/property/staticsub/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n\n",i=n["if"].call(e,e&&e.isApp,{hash:{},inverse:a.program(5,p,t),fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n.unless.call(e,(i=e&&e.ami,i==null||i===!1?i:i.unavailable),{hash:{},inverse:a.noop,fn:a.program(8,v,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,(i=e&&e.ami,i==null||i===!1?i:i.unavailable),{hash:{},inverse:a.noop,fn:a.program(3,h,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function h(e,t){var r="";return r+='\n    <div class="property-control-group property-ami-info">\n        <p>'+u(n.i18n.call(e,"PROP.AMI_APP_NOT_AVAILABLE",{hash:{},data:t}))+"</p>\n    </div>\n    ",r}function p(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,(i=e&&e.ami,i==null||i===!1?i:i.unavailable),{hash:{},inverse:a.noop,fn:a.program(6,d,t),data:t});if(i||i===0)r+=i;return r+='\n    <div class="property-control-group property-ami-info">\n        <div class="property-control-group tac">\n            <button id="changeAmi" class="btn btn-blue"><i class="icon-edit icon-label"></i>'+u(n.i18n.call(e,"PROP.STATIC_SUB_CHANGE_AMI",{hash:{},data:t}))+'</button>\n        </div>\n    </div>\n    <div class="property-control-group hide" id="changeAmiPanel">\n        <p>'+u(n.i18n.call(e,"PROP.DRAG_IMAGE_DROP_TO_CHANGE",{hash:{},data:t}))+'</p>\n        <div id="changeAmiDropZone">\n            <p>'+u(n.i18n.call(e,"PROP.DRAG_IMAGE_DROP_HERE",{hash:{},data:t}))+'</p>\n            <div class="resource-icon resource-icon-instance">\n                <img src="/assets/images/ide/ami/amazon.i386.ebs.png" width="39" height="27">\n                <div class="resource-label"></div>\n            </div>\n        </div>\n        <div class="hide" id="confirmChangeAmiWrap">\n            <p id="changeAmiWarning"></p>\n            <button id="confirmChangeAmi" class="btn btn-blue">'+u(n.i18n.call(e,"PROP.CONFIRM_CHANGE_AMI",{hash:{},data:t}))+'</button>\n        </div>\n        <button id="cancelChangeAmi" class="btn-link">'+u(n.i18n.call(e,"PROP.LBL_CANCEL",{hash:{},data:t}))+"</button>\n    </div>\n",r}function d(e,t){var r="";return r+='\n    <div class="property-control-group property-ami-info">\n        '+u(n.i18n.call(e,"PROP.AMI_STACK_NOT_AVAILABLE",{hash:{},data:t}))+"\n    </div>\n    ",r}function v(e,t){var r="",i;return r+='\n    <dl class="dl-vertical property-ami-info">\n    <dt>'+u(n.i18n.call(e,"PROP.INSTANCE_AMI_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.id,typeof i===f?i.apply(e):i))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_AMI_NAME",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.name,typeof i===f?i.apply(e):i))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_AMI_DESC",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.description,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_ROOT_DEVICE_TYPE",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.rootDeviceType,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_AMI_ARCHITECH",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.architecture,typeof i===f?i.apply(e):i))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_AMI_VIRTUALIZATION",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.virtualizationType,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_AMI_KERNEL_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.kernelId,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_AMI_OS_TYPE",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.osType,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_AMI_SUPPORT_INSTANCE_TYPE",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.instance_type,{hash:{},data:t}))+"</dd>\n    </dl>\n    ",r}function m(e,t){var r="",i;return r+='\n    <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(e,"PROP.VOLUME_SNAPSHOT_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.id,typeof i===f?i.apply(e):i))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.VOLUME_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.volumeId,typeof i===f?i.apply(e):i))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.description,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.LBL_CAPACITY",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.volumeSize,{hash:{},data:t}))+"GB</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.LBL_OWNER",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.ownerId,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.LBL_STARTED",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.startTime,{hash:{},data:t}))+"</dd>\n    </dl>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<article class="property-app">\n',o=n["if"].call(t,t&&t.ami,{hash:{},inverse:a.program(10,m,i),fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/staticsub/view",["../base/view","./template/stack"],function(e,t){var n;return n=e.extend({events:{"click #changeAmi":"showChangeAmiPanel","click #confirmChangeAmi":"changeAmi","click #cancelChangeAmi":"hideChangeAmiPanel"},render:function(){var e;return this.$el.html(t(this.model.attributes)),this.model.attributes.name,e=this,$("#changeAmiDropZone").on("addItem_drop",function(t,n){return e.onDropAmi(n)}),this.model.id},showChangeAmiPanel:function(){return $("#changeAmiPanel").show().siblings(".property-ami-info").hide(),$("#changeAmiDropZone").children().hide().filter("p").show(),$("#confirmChangeAmiWrap").hide(),null},hideChangeAmiPanel:function(){return $("#changeAmiPanel").hide().siblings(".property-ami-info").show(),null},onDropAmi:function(e){var t,n;t=e.dataTransfer.imageId;if(!t)return;return $("#changeAmiPanel").data("amiId",t),$("#confirmChangeAmiWrap").show(),n=this.model.canChangeAmi(t),n===!0?($("#changeAmiWarning").hide(),$("#confirmChangeAmi").show()):($("#changeAmiWarning").html(n).show(),$("#confirmChangeAmi").hide()),$("#changeAmiDropZone").children().show().filter("p").hide(),$("#changeAmiDropZone").find("img").attr("src","/assets/images/ide/ami/"+this.model.getAmiPngName(t)+".png"),$("#changeAmiDropZone").find(".resource-label").html(this.model.getAmiName(t)),null},changeAmi:function(){var e;return e=$("#changeAmiPanel").data("amiId"),this.model.changeAmi(e),this.trigger("AMI_CHANGE"),null}}),new n}),define("wspace/awseditor/property/staticsub/main",["../base/main","./model","./view","event","Design"],function(e,t,n,r,i){var s;return n.on("AMI_CHANGE",function(){var t;return t=i.instance().component(e.activeModule().uid),r.trigger(r.OPEN_PROPERTY,t.type,t.id),null}),s=e.extend({subPanelID:"STATIC",initStack:function(){return this.model=t,this.view=n,this.model.isApp=!1,null},initApp:function(){return this.model=t,this.view=n,this.model.isApp=!0,null},initAppEdit:function(){return this.model=t,this.view=n,this.model.isApp=!0,null}}),null}),define("wspace/awseditor/property/missing/main",["../base/main","../base/model","../base/view","constant","i18n!/nls/lang.js"],function(e,t,n,r,i){var s,o,u,a,f;return o=n.extend({render:function(){var e,t;return e=Design.instance().component(this.model.get("uid")),(t=Design.instance().get("state"))!=="Stopped"&&t!=="Stopping"||e.type!==r.RESTYPE.ASG?(this.$el.html(MC.template.missingPropertyPanel()),i.PROP.MISSING_RESOURCE_UNAVAILABLE):(this.$el.html(MC.template.missingAsgWhenStop({asgName:e.get("name")})),""+e.get("name")+" Deleted")}}),f=new o,u=t.extend({init:function(e){return this.set("uid",e)}}),a=new u,s=e.extend({handleTypes:"Missing_Resource",initApp:function(){return this.model=a,this.view=f,null},initAppEdit:function(){return this.model=a,this.view=f,null}}),null}),define("wspace/awseditor/property/sg/model",["../base/model","Design","constant","CloudResources"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var n,r,i,s,o,u,a,f;this.component=n=t.instance().component(e);if(this.modeIsApp){this.appInit(e);return}o=[],f=n.connections("SgRuleSet");for(u=0,a=f.length;u<a;u++)s=f[u],o=o.concat(s.toPlainObjects(e,!0));i=_.map(n.getMemberList(),function(e){return e.get("name")}),this.set({uid:e,name:n.get("name"),description:n.get("description"),members:i,rules:o,color:n.color,ruleEditable:!this.readonly(),readonly:this.readonly(),tags:n.tags()}),this.sortSGRule(),n.isElbSg()?r=!0:this.isAppEdit&&(r=n.get("appId"));if(r||n.isDefault())this.set("nameReadOnly",!0),this.set("descReadOnly",!0);return null},setDescription:function(e){return t.instance().component(this.get("uid")).set("description",e),null},sortSGRule:function(e){return this.attributes.rules=_.sortBy(this.attributes.rules,e||"direction"),null},addRule:function(e){var n,r,i,s,o,u,a,f,l,c;a=this.get("uid"),i=t.instance().component(a),e.relation[0]==="@"?u=t.instance().component(e.relation.substr(1)):u=i.createIpTarget(e.relation),n=t.modelClassForType("SgRuleSet"),o=new n(i,u),r=o.ruleCount(i.id),o.addRawRule(i.id,e.direction,e);if(r<o.ruleCount(i.id)){s=[],c=i.connections("SgRuleSet");for(f=0,l=c.length;f<l;f++)e=c[f],s=s.concat(e.toPlainObjects(a,!0));return this.attributes.rules=s,this.sortSGRule(),!0}return!1},createSGRuleData:function(){var e;return e=_.map(t.modelClassForType(n.RESTYPE.SG).allObjects(),function(e){return{id:e.id,color:e.color,name:e.get("name")}}),{isClassic:!1,sgList:e}},removeRule:function(e){var n;return n=t.instance().component(e.ruleSetId),n.removeRuleByPlainObj(e),null},appInit:function(e){var i,s,o,u,a,f,l,c,h,p,d;s=t.instance().region(),o=this.component.get("appId"),i=(p=r(t.instance().credentialId(),n.RESTYPE.SG,s).get(o))!=null?p.toJSON():void 0,f=[],d=this.component.connections("SgRuleSet");for(c=0,h=d.length;c<h;c++)a=d[c],f=f.concat(a.toPlainObjects(e));return u=_.map(this.component.connectionTargets("SgAsso"),function(e){return e.get("name")}),l={uid:e,name:this.component.get("name"),color:this.component.color,groupName:i.groupName,description:i.groupDescription,groupId:i.groupId,ownerId:i.ownerId,vpcId:i.vpcId,tagSet:i.tagSet,members:u,rules:f},this.set(l),this.sortSGRule(),null},readonly:function(){return this.component.isMesos()&&t.instance().opsModel().isMesos()}}),new i}),define("wspace/awseditor/property/sg/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return'disabled="disabled"'}function c(e,t){var r="";return r+='\n		<a href="#" class="icon-add tooltip add-rule" id="sg-add-rule-icon" data-tooltip=\''+u(n.i18n.call(e,"PROP.SG_TIP_CREATE_RULE",{hash:{},data:t}))+"' ></a>\n		",r}function h(e,t){var n="";return n+='<li class="sg-member-name">'+u(typeof e===a?e.apply(e):e)+"</li>",n}function p(e,t){var r="",i;r+='\n		<table class="table cost-estimation-table">\n			<tbody>\n			',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(8,d,t),data:t});if(i||i===0)r+=i;return r+="\n			</tbody>\n		</table>\n		",r}function d(e,t){var n="",r;return n+='\n			<tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n			",n}function v(e,t){var r="";return r+='\n		<div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article>\n	<div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.SG_TIT_DETAIL",{hash:{},data:i}))+'</div>\n	<div class="option-group" data-bind="true">\n		<div class="property-control-group">\n			<label for="securitygroup-name" >'+u(n.i18n.call(t,"PROP.SG_DETAIL_LBL_NAME",{hash:{},data:i}))+'</label>\n			<span class="required-input right">'+u(n.i18n.call(t,"PROP.LBL_REQUIRED",{hash:{},data:i}))+'</span>\n			<input class="input"  type="text" id="securitygroup-name" ',o=n["if"].call(t,t&&t.nameReadOnly,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t&&t.readonly,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+=' value="'+u((o=t&&t.name,typeof o===a?o.apply(t):o))+'" maxlength="255" data-ignore="true" data-required-rollback="true"/>\n		</div>\n		<div class="property-control-group">\n			<label for="securitygroup-description" >'+u(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+'</label>\n			<input class="input" type="text" id="securitygroup-description" ',o=n["if"].call(t,t&&t.descReadOnly,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t&&t.readonly,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+=' value="'+u((o=t&&t.description,typeof o===a?o.apply(t):o))+'" maxlength="255" data-type="ascii" data-ignore="true"/>\n		</div>\n	</div>\n\n	<div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.SG_TIT_RULE",{hash:{},data:i}))+'\n		<span class="property-head-num-wrap">(<span id="rule-count">'+u((o=(o=t&&t.rules,o==null||o===!1?o:o.length),typeof o===a?o.apply(t):o))+"</span>)</span>\n		",o=n["if"].call(t,t&&t.ruleEditable,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n	</div>\n	<div class="option-group">\n		<div class="rule-list-sort property-control-group">\n			<label>'+u(n.i18n.call(t,"PROP.SG_RULE_SORT_BY",{hash:{},data:i}))+'</label>\n			<div class="selectbox" id="sg-rule-filter-select">\n				<div class="selection">'+u(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</div>\n				<ul class="dropdown" tabindex="-1">\n					<li class="item selected" data-id="direction">'+u(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</li>\n					<li class="item" data-id="relation">'+u(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_SRC_DEST",{hash:{},data:i}))+'</li>\n					<li class="item" data-id="protocol">'+u(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_PROTOCOL",{hash:{},data:i}))+'</li>\n				</ul>\n			</div>\n		</div>\n\n		<ul class="mega-list-wraper" id="sg-rule-list"></ul>\n	</div>\n\n	<div class="option-group-head">'+u(n.i18n.call(t,"PROP.SG_TIT_MEMBER",{hash:{},data:i}))+'<span class="property-head-num-wrap">('+u((o=(o=t&&t.members,o==null||o===!1?o:o.length),typeof o===a?o.apply(t):o))+')</span>	</div>\n	<div class="option-group">\n		<ul class="sg-member-list mega-list-wraper">\n			',o=n.each.call(t,t&&t.members,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+='\n		</ul>\n	</div>\n\n	<div class="option-group-head expand">\n		'+u(n.i18n.call(t,"PROP.RESOURCE_TAGS",{hash:{},data:i}))+'\n	</div>\n	<div class="option-group">\n		',o=n["if"].call(t,(o=t&&t.tags,o==null||o===!1?o:o.length),{hash:{},inverse:f.program(10,v,i),fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;return s+='\n		<div class="tags-action">\n			\n			<button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(t,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:i}))+"</button>\n		</div>\n	</div>\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/sg/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var n="";return n+=' <li class="sg-member-name">'+a(typeof e===u?e.apply(e):e)+"</li> ",n}function c(e,t){var r="",i;r+='\n  <div class="option-group-head">\n      '+a(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n  </div>\n  <div class="option-group">\n    ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.program(7,d,t),fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n  </div>\n  ",r}function h(e,t){var r="",i;r+='\n    <table class="table cost-estimation-table">\n      <tbody>\n      ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;return r+="\n      </tbody>\n    </table>\n    ",r}function p(e,t){var n="",r;return n+='\n      <tr> <td style="min-width:70px;">'+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</td><td>"+a(typeof e===u?e.apply(e):e)+"</td> </tr>\n      ",n}function d(e,t){var r="";return r+='\n    <div class="empty-tag">'+a(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article>\n  <dl class="dl-vertical">\n    <dt>'+a(n.i18n.call(t,"PROP.SG_APP_SG_NAME",{hash:{},data:i}))+"</dt>\n    <dd>"+a((o=t&&t.groupName,typeof o===u?o.apply(t):o))+"</dd>\n\n    <dt>"+a(n.i18n.call(t,"PROP.SG_APP_SG_ID",{hash:{},data:i}))+"</dt>\n    <dd>"+a((o=t&&t.groupId,typeof o===u?o.apply(t):o))+"</dd>\n\n    <dt>"+a(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+"</dt>\n    <dd>"+a((o=t&&t.description,typeof o===u?o.apply(t):o))+"</dd>\n\n    <dt>"+a(n.i18n.call(t,"PROP.SG_APP_VPC_ID",{hash:{},data:i}))+"</dt>\n    <dd>"+a((o=t&&t.vpcId,typeof o===u?o.apply(t):o))+'</dd>\n  </dl>\n\n  <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP.SG_TIT_RULE",{hash:{},data:i}))+'\n    <span class="property-head-num-wrap">(<span id="rule-count">'+a((o=(o=t&&t.rules,o==null||o===!1?o:o.length),typeof o===u?o.apply(t):o))+'</span>)</span>\n  </div>\n  <div class="option-group">\n\n    <div class="rule-list-sort property-control-group">\n      <label>'+a(n.i18n.call(t,"PROP.SG_RULE_SORT_BY",{hash:{},data:i}))+'</label>\n      <div class="selectbox" id="sg-rule-filter-select">\n        <div class="selection">'+a(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</div>\n        <ul class="dropdown" tabindex="-1">\n          <li class="item selected" data-id="direction">'+a(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</li>\n          <li class="item" data-id="relation">'+a(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_SRC_DEST",{hash:{},data:i}))+'</li>\n          <li class="item" data-id="protocol">'+a(n.i18n.call(t,"PROP.SG_RULE_SORT_BY_PROTOCOL",{hash:{},data:i}))+'</li>\n        </ul>\n      </div>\n    </div>\n\n    <ul class="mega-list-wraper sg-rule-list" id="sg-rule-list"></ul>\n  </div>\n\n  <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP.SG_TIT_MEMBER",{hash:{},data:i}))+'\n    <span class="property-head-num-wrap">(<span>'+a((o=(o=t&&t.members,o==null||o===!1?o:o.length),typeof o===u?o.apply(t):o))+'</span>)</span>\n  </div>\n  <div class="option-group">\n    <ul class="sg-member-list mega-list-wraper">\n      ',o=n.each.call(t,t&&t.members,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n    </ul>\n  </div>\n\n  ",o=n["if"].call(t,t&&t.tagSet,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+="\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/sg/view",["../base/view","./template/stack","./template/app","constant","i18n!/nls/lang.js","UI.modalplus"],function(e,t,n,r,i,s){var o;return o=e.extend({events:{"click #sg-add-rule-icon":"showCreateRuleModal","click .sg-rule-delete":"removeRulefromList","change #securitygroup-name":"setSGName","change #securitygroup-description":"setSGDescription","OPTION_CHANGE #sg-rule-filter-select":"sortSgRule"},render:function(){var e;return e=this.model.modeIsApp?n:t,this.$el.html(e(this.model.toJSON())),this.refreshSgruleList(),this.setTitle(this.model.get("name")),this.prependTitle('<span class="sg-color" style="background-color:'+this.model.get("color")+'" ></span>'),this.forceShow(),setTimeout(function(){return $("#securitygroup-name").focus()},200),this.model.get("name")},refreshSgruleList:function(){var e;return e=this.model.get("rules"),e.deletable=this.model.get("ruleEditable"),$("#sg-rule-list").html(MC.template.sgRuleList(e))},showCreateRuleModal:function(e){var t;return t=this,this.modal=new s({title:i.IDE.POP_SGRULE_TITLE_ADD,template:MC.template.modalSGRule(t.model.createSGRuleData()),confirm:{text:i.IDE.POP_SGRULE_BTN_SAVE}}),this.modal.tpl.attr("id","modal-sg-rule"),this.modal.on("confirm",t.saveSgModal.bind(t)),$("#sg-modal-direction").on("click","input",this.radioSgModalChange),$("#modal-protocol-select").on("OPTION_CHANGE",this.sgModalSelectboxChange),$("#protocol-icmp-main-select").on("OPTION_CHANGE",this.icmpMainSelect),$("#sg-protocol-select-result").on("OPTION_CHANGE",".protocol-icmp-sub-select",this.icmpSubSelect),$("#sg-add-model-source-select").on("OPTION_CHANGE",this.modalRuleSourceSelected),!1},radioSgModalChange:function(e){return $("#sg-modal-direction input:checked").val()==="inbound"?$("#rule-modal-ip-range").text(i.IDE.POP_ACLRULE_LBL_SOURCE):$("#rule-modal-ip-range").text(i.IDE.POP_ACLRULE_LBL_DEST)},sgModalSelectboxChange:function(e,t){return $("#sg-protocol-select-result").find(".show").removeClass("show"),$(".sg-protocol-option-input").removeClass("show"),$("#sg-protocol-"+t).addClass("show"),$(".protocol-icmp-sub-select").removeClass("shown"),$("#modal-protocol-select").data("protocal-type",t),null},icmpMainSelect:function(e,t){return $("#protocol-icmp-main-select").data("protocal-main",t),t==="3"||t==="5"||t==="11"||t==="12"?($(".protocol-icmp-sub-select").removeClass("shown"),$("#protocol-icmp-sub-select-"+t).addClass("shown")):$(".protocol-icmp-sub-select").removeClass("shown")},icmpSubSelect:function(e,t){return $("#protocol-icmp-main-select").data("protocal-sub",t)},modalRuleSourceSelected:function(e){var t,n;return n=$.trim($(e.target).find(".selected").attr("data-id")),t=n==="custom",$("#securitygroup-modal-description").toggle(t),$("#sg-add-model-source-select .selection").width(t?69:322),null},setSGName:function(e){var t,n,r;return r=$(e.currentTarget),t=r.val(),MC.aws.aws.checkResName(this.model.get("uid"),r,"SG")&&(n=this.model.get("name"),this.model.setName(t),this.setTitle(this.model.get("name")),this.prependTitle('<span class="sg-color" style="background-color:'+this.model.get("color")+'" ></span>'),$("#sg-rule-list").children().find(".rule-reference").each(function(){$(this).text()===n&&$(this).html(title)})),null},setSGDescription:function(e){return this.model.setDescription(e.target.value),null},sortSgRule:function(e){return this.model.sortSGRule($(e.target).find(".selected").attr("data-id")),this.refreshSgruleList(),null},removeRulefromList:function(e){var t,n,r;return t=$(e.target).closest("li"),n={ruleSetId:t.attr("data-uid"),port:t.attr("data-port"),protocol:t.attr("data-protocol"),direction:t.attr("data-direction"),relation:t.attr("data-relationid")},t.remove(),r=$("#sg-rule-list").children().length,$("#rule-count").text(r),this.model.removeRule(n),!1},saveSgModal:function(e){var t,n,r,s,o,u,a,f,l,c,h,p,d,v;c=$("#sg-modal-direction input:checked").val(),n=$("#securitygroup-modal-description"),p=$("#sg-protocol-tcp input"),d=$("#sg-protocol-udp input"),t=$("#sg-protocol-custom input"),o=$("#modal-protocol-select").data("protocal-type"),h=$.trim($("#sg-add-model-source-select").find(".selected").attr("data-id")),v={custom:{dom:t,method:function(e){return MC.validate.portRange(e)?Number(e)<0||Number(e)>255?i.PARSLEY.THE_PROTOCOL_NUMBER_RANGE_MUST_BE_0_255:null:i.PARSLEY.MUST_BE_A_VALID_FORMAT_OF_NUMBER}},tcp:{dom:p,method:function(e){var t;return t=[],t=MC.validate.portRange(e),t?MC.validate.portValidRange(t)?null:i.PARSLEY.PORT_RANGE_BETWEEN_0_65535:i.PARSLEY.MUST_BE_A_VALID_FORMAT_OF_PORT_RANGE}},udp:{dom:d,method:function(e){var t;return t=[],t=MC.validate.portRange(e),t?MC.validate.portValidRange(t)?null:i.PARSLEY.PORT_RANGE_BETWEEN_0_65535:i.PARSLEY.MUST_BE_A_VALID_FORMAT_OF_PORT_RANGE}}},o in v&&(r=v[o],r.dom.parsley("custom",r.method)),n.parsley("custom",function(e){return MC.validate("cidr",e)?null:i.PARSLEY.MUST_BE_CIDR_BLOCK});if(h==="custom"&&!n.parsley("validate")||r&&!r.dom.parsley("validate"))return;l={protocol:o,direction:c||"inbound",fromPort:"",toPort:""};switch(o){case"tcp":case"udp":s=$("#sg-protocol-"+o+" input").val().split("-"),l.fromPort=s[0].trim(),s.length>=2&&(l.toPort=s[1].trim());break;case"icmp":u=$("#protocol-icmp-main-select").data("protocal-main"),a=$("#protocol-icmp-main-select").data("protocal-sub"),l.fromPort=u,l.toPort=a;break;case"custom":l.protocol=$("#sg-protocol-custom input").val()}return h==="custom"?l.relation=n.val():l.relation="@"+$("#sg-add-model-source-select").find("li.selected").attr("data-uid"),f=this.model.addRule(l),f?(this.refreshSgruleList(),this.modal.close()):notification("warning",i.NOTIFY.THE_ADDING_RULE_ALREADY_EXIST)}}),new o}),define("wspace/awseditor/property/sg/main",["../base/main","./model","./view"],function(e,t,n){var r;return r=e.extend({subPanelID:"SG",initStack:function(){return this.model=t,this.model.modeIsApp=!1,this.model.isAppEdit=!1,this.view=n,null},initApp:function(){return this.model=t,this.model.modeIsApp=!0,this.model.isAppEdit=!1,this.view=n,null},initAppEdit:function(){return this.model=t,this.model.modeIsApp=!1,this.model.isAppEdit=!0,this.view=n,null}}),null}),define("wspace/awseditor/property/sgrule/model",["../base/model","Design"],function(e,t){var n;return n=e.extend({init:function(e){var n,r,i;i=t.instance().component(e);if(!i)return;return n=t.modelClassForType("SgRuleSet"),r=n.getRelatedSgRuleSets(i.port1Comp(),i.port2Comp()),this.set({uid:e,groups:n.getGroupedObjFromRuleSets(r),readOnly:this.isApp}),null}}),new n}),define("wspace/awseditor/property/sgrule/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var n="",r;n+='\n  <div class="mega-list-wraper-header truncate"><span class="sg-color sg-color-rule-header" style="background-color:'+a((r=e&&e.ownerColor,typeof r===u?r.apply(e):r))+'"></span>'+a((r=e&&e.ownerName,typeof r===u?r.apply(e):r))+'</div>\n  <ul class="mega-list-wraper">',r=(r=e&&e.ruleListTpl,typeof r===u?r.apply(e):r);if(r||r===0)n+=r;return n+="</ul>\n  ",n}function c(e,t){var r="";return r+='\n  <a class="add-to-list" id="sg-edit-rule-button"><i class="icon-edit icon-label"></i>'+a(n.i18n.call(e,"PROP.SGRULE_BTN_EDIT_RULE",{hash:{},data:t}))+"</a>\n  ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article>\n  <section class="property-info" style="margin-top:0;">\n    <div class="property-control-group">'+a(n.i18n.call(t,"PROP.SGRULE_DESCRIPTION",{hash:{},data:i}))+"</div>\n  </section>\n\n	",o=n.each.call(t,t&&t.groups,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n.unless.call(t,t&&t.readOnly,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/sgrule/view",["../base/view","./template/stack","SGRulePopup"],function(e,t,n){var r;return r=e.extend({events:{"click #sg-edit-rule-button":"onEditRule"},render:function(){var e,n,r,i;i=this.model.attributes.groups;for(n=0,r=i.length;n<r;n++)e=i[n],e.ruleListTpl=MC.template.sgRuleList(e.rules);return this.$el.html(t(this.model.attributes)),"Security Group Rule"},onEditRule:function(e){return new n(this.model.get("uid")),!1}}),new r}),define("wspace/awseditor/property/sgrule/main",["../base/main","./model","./view"],function(e,t,n){var r;return r=e.extend({handleTypes:["ElbAmiAsso","SgRuleLine"],initStack:function(){return this.model=t,this.model.isApp=!1,this.view=n,null},initApp:function(){return this.model=t,this.model.isApp=!0,this.view=n,null},initAppEdit:function(){return this.model=t,this.model.isApp=!1,this.view=n,null}}),null}),define("wspace/awseditor/property/volume/model",["../base/model","constant","Design","CloudResources"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var i,s,o,u,a,f,l,c;return i=n.instance().component(e),u=i.attributes,u.owner?(f=i.isSupportEncrypted(),s=!0,f||(s=!1),u.snapshotId&&(f=!1),i.get("owner").type===t.RESTYPE.LC&&(s=!1),o=!1,f&&(o=(c=u.encrypted)==="true"||c===!0),l={isWin:u.name[0]!=="/",isStandard:u.volumeType==="standard",isIo1:u.volumeType==="io1",isGp2:u.volumeType==="gp2",iops:u.iops,volume_size:u.volumeSize,snapshot_id:u.snapshotId,name:u.name,displayEncrypted:s,support_encrypted:f,encrypted:o,owner:u.owner,tags:i.tags()},l.snapshot_id&&(a=r(n.instance().credentialId(),t.RESTYPE.SNAP,n.instance().region()).get(l.snapshot_id),a&&(l.snapshot_size=a.get("volumeSize"),l.snapshot_desc=a.get("description"))),l.volume_size<10&&(l.iopsDisabled=!0),this.set("volume_detail",l),this.set("uid",e),null):(void 0,!1)},setDeviceName:function(e){var t,r;return t=this.get("uid"),r=n.instance().component(t),r.set("name",e),this.attributes.volume_detail.name=e,null},setVolumeSize:function(e){var r,i,s,o,u,a,f,l,c,h,p;a=this.get("uid"),l=n.instance().component(a);if(!l){u=a.split("_"),i=u[2],o=u[0],s=n.instance().component(o),c=n.modelClassForType(t.RESTYPE.VOL),r=c&&c.allObjects()||[];for(h=0,p=r.length;h<p;h++){f=r[h];if(f.get("owner")===s&&f.get("name")===i){f.set("volumeSize",e);break}}}else l.set("volumeSize",e);return null},setVolumeType:function(e,t){var r;return r=n.instance().component(this.get("uid")),r.set({volumeType:e,iops:t}),null},setEncrypted:function(e){var t,r;return t=this.get("uid"),r=n.instance().component(t),!r||r.set("encrypted",e),null},isDuplicate:function(e){var t,r,i,s,o,u,a,f,l;return a=this.get("uid"),u=this,f=n.instance().component(a),o=f.get("owner"),l=o.get("volumeList"),r=_.some(l,function(t){if(t!==f&&u.isDeviceNameEqual(u.getDeviceNameMap(t.get("name")),u.getDeviceNameMap(e)))return!0}),r?!0:(t=o.getAmi(),s=this.getDeviceNameMap(e),i=_.some(t.blockDeviceMapping,function(e,t){var n;return n=u.getDeviceNameMap(t),u.isDeviceNameEqual(s,n)}),i)},isDeviceNameEqual:function(e,t){return!e||!t?!1:e.origin===t.origin?!0:e.numberSuffix&&!t.numberSuffix||!e.numberSuffix&&t.numberSuffix?e.prefix+e.middle===t.prefix+t.middle:!1},getDeviceNameMap:function(e){var t;return t=/(sd|hd|xvd)([a-z]+)([0-9]*)/i.exec(e),t?{origin:t[0],prefix:t[1],middle:t[2],numberSuffix:t[3]}:null}}),new i}),define("wspace/awseditor/property/volume/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return"disabled"}function c(e,t){var r="",i;return r+='\n    <section class="property-control-group">\n        <label>'+u(n.i18n.call(e,"PROP.VOLUME_SNAPSHOT",{hash:{},data:t}))+'</label>\n        <div id="snapshot-info-group" class="clearfix property-block-wrap" data-uid=\''+u((i=(i=e&&e.volume_detail,i==null||i===!1?i:i.snapshot_id),typeof i===a?i.apply(e):i))+"'>\n            <div>"+u((i=(i=e&&e.volume_detail,i==null||i===!1?i:i.snapshot_id),typeof i===a?i.apply(e):i))+' <span class="mgl5">'+u((i=(i=e&&e.volume_detail,i==null||i===!1?i:i.snapshot_size),typeof i===a?i.apply(e):i))+"GB</span></div>\n            <div><span>"+u((i=(i=e&&e.volume_detail,i==null||i===!1?i:i.snapshot_desc),typeof i===a?i.apply(e):i))+"</span></div>\n        </div>\n    </section>\n    ",r}function h(e,t){return'checked="checked"'}function p(e,t){var r="";return r+='class="tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.VOLUME_MSG_WARN",{hash:{},data:t}))+'"',r}function d(e,t){return'style="display:none"'}function v(e,t){return'style="display:block"'}function m(e,t){var r="",i;r+='\n            <input id="iops-ranged" type="text" class="input" value="100" name="iops-ranged" min="100" max="2000" required="" ',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(1,l,t),data:t});if(i||i===0)r+=i;return r+=">\n            ",r}function g(e,t){var r="",i;r+='\n            <input class="input" id="iops-ranged" type="text" value="'+u((i=(i=e&&e.volume_detail,i==null||i===!1?i:i.iops),typeof i===a?i.apply(e):i))+'" name="iops-ranged" min="100" max="2000" required="" ',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(1,l,t),data:t});if(i||i===0)r+=i;return r+=">\n            ",r}function y(e,t){var r="",i;r+='\n    <section class="property-control-group">\n        <label>'+u(n.i18n.call(e,"PROP.VOLUME_ENCRYPTED",{hash:{},data:t}))+'</label>\n        <div>\n            <div class="checkbox">\n                <input id="volume-property-encrypted-check" type="checkbox" ',i=n.unless.call(e,(i=e&&e.volume_detail,i==null||i===!1?i:i.support_encrypted),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,(i=e&&e.volume_detail,i==null||i===!1?i:i.encrypted),{hash:{},inverse:f.noop,fn:f.program(20,w,t),data:t});if(i||i===0)r+=i;r+="  ",i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(1,l,t),data:t});if(i||i===0)r+=i;return r+='/>\n                <label for="volume-property-encrypted-check"></label>\n            </div>\n            <label for="volume-property-encrypted-check">'+u(n.i18n.call(e,"PROP.VOLUME_ENCRYPTED_LABEL",{hash:{},data:t}))+"</label>\n        </div>\n    </section>\n    ",r}function b(e,t){return'disabled="disabled"'}function w(e,t){return'checked="checked" '}function E(e,t){var r="",i;r+='\n        <table class="table cost-estimation-table">\n            <tbody>\n            ',i=n.each.call(e,(i=e&&e.volume_detail,i==null||i===!1?i:i.tags),{hash:{},inverse:f.noop,fn:f.program(23,S,t),data:t});if(i||i===0)r+=i;return r+="\n            </tbody>\n        </table>\n        ",r}function S(e,t){var n="",r;return n+='\n            <tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n            ",n}function x(e,t){var r="";return r+='\n        <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n        ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article id=\'property-panel-volume\' data-bind="true" data-focus="none">\n    <section class="property-control-group">\n        <label>'+u(n.i18n.call(t,"PROP.VOLUME_DEVICE_NAME",{hash:{},data:i}))+'</label>\n        <div class="name">\n            <input class="input input-device"  type="text" value="'+u((o=(o=t&&t.volume_detail,o==null||o===!1?o:o.name),typeof o===a?o.apply(t):o))+'" id="volume-device" data-ignore="true" data-ignore-regexp="^[\\/a-zA-Z]+[\\/0-9a-zA-Z-]*$" data-required-rollback="true" maxlength="10" ',o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='/>\n        </div>\n    </section>\n    <section class="property-control-group">\n        <label>'+u(n.i18n.call(t,"PROP.VOLUME_SIZE",{hash:{},data:i}))+'</label>\n        <div class="ranged-number-input">\n            <label for="volume-size-ranged"></label>\n            <input id="volume-size-ranged" type="text" class="input" value="'+u((o=(o=t&&t.volume_detail,o==null||o===!1?o:o.volume_size),typeof o===a?o.apply(t):o))+'" name="volume-size-ranged" data-ignore="true" maxlength="5" data-required="true" data-required="true" data-type="number" ',o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='/>\n        <label for="volume-property-ranged-number" >GB</label>\n        </div>\n    </section>\n\n    ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.snapshot_id),{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n\n    <section class="property-control-group">\n        <label>'+u(n.i18n.call(t,"PROP.VOLUME_TYPE",{hash:{},data:i}))+'</label>\n        <div class="context" id="volume-type-radios">\n\n            <div>\n                <div class="radio">\n                    <input id="radio-standard" type="radio" name="volume-type" ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.isStandard),{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+=' value="standard" ',o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='/>\n                    <label for="radio-standard"></label>\n                </div>\n                <label for="radio-standard">'+u(n.i18n.call(t,"PROP.VOLUME_TYPE_STANDARD",{hash:{},data:i}))+'</label>\n            </div>\n\n            <div>\n                <div class="radio">\n                    <input id="radio-gp2" type="radio" name="volume-type" ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.isGp2),{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+=' value="gp2" ',o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='/>\n                    <label for="radio-gp2"></label>\n                </div>\n                <label for="radio-gp2">'+u(n.i18n.call(t,"PROP.VOLUME_TYPE_GP2",{hash:{},data:i}))+"</label>\n            </div>\n\n            <div ",o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.iopsDisabled),{hash:{},inverse:f.noop,fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+='>\n                <div class="radio">\n                    <input id="radio-io1" type="radio" name="volume-type" ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.isIo1),{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+=' value="io1" ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.iopsDisabled),{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='/>\n                    <label for="radio-io1"></label>\n                </div>\n                <label for="radio-io1">'+u(n.i18n.call(t,"PROP.VOLUME_TYPE_IO1",{hash:{},data:i}))+'</label>\n            </div>\n\n        </div>\n    </section>\n\n    <section class="property-control-group" id="iops-group" ',o=n.unless.call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.isIo1),{hash:{},inverse:f.program(11,v,i),fn:f.program(9,d,i),data:i});if(o||o===0)s+=o;s+='>\n        <label>IOPS</label>\n        <div class="ranged-number-input">\n            <label for="iops-ranged"></label>\n            ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.isStandard),{hash:{},inverse:f.program(15,g,i),fn:f.program(13,m,i),data:i});if(o||o===0)s+=o;s+='\n        <label for="volume-property-ranged-number" ></label>\n        </div>\n    </section>\n\n    ',o=n["if"].call(t,(o=t&&t.volume_detail,o==null||o===!1?o:o.displayEncrypted),{hash:{},inverse:f.noop,fn:f.program(17,y,i),data:i});if(o||o===0)s+=o;s+='\n    <div class="option-group-head expand">\n        '+u(n.i18n.call(t,"PROP.RESOURCE_TAGS",{hash:{},data:i}))+'\n    </div>\n    <div class="option-group">\n        ',o=n["if"].call(t,(o=(o=t&&t.volume_detail,o==null||o===!1?o:o.tags),o==null||o===!1?o:o.length),{hash:{},inverse:f.program(25,x,i),fn:f.program(22,E,i),data:i});if(o||o===0)s+=o;return s+='\n        <div class="tags-action">\n            \n            <button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(t,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:i}))+"</button>\n        </div>\n    </div>\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/volume/view",["../base/view","./template/stack","event","i18n!/nls/lang.js"],function(e,t,n,r){var i,s;return s=2e4,i=e.extend({events:{"click #volume-type-radios input":"volumeTypeChecked","change #volume-device":"deviceNameChanged","keyup #volume-size-ranged":"sizeChanged","keyup  #volume-size-ranged":"processIops","keyup #iops-ranged":"sizeChanged","click #snapshot-info-group":"showSnapshotDetail","change #volume-property-encrypted-check":"encryptedCheck"},render:function(){return this.$el.html(t(_.extend({isAppEdit:this.model.isAppEdit},this.model.toJSON()))),$("#volume-size-ranged").parsley("custom",function(e){e=+e;if(!e||e>16384||e<1)return r.PARSLEY.VOLUME_SIZE_MUST_IN_1_1024}),$("#iops-ranged").parsley("custom",function(e){var t;e=+e,t=parseInt($("#volume-size-ranged").val(),10);if(e>s||e<100)return r.PARSLEY.IOPS_MUST_BETWEEN_100_4000;if(e>10*t)return r.PARSLEY.IOPS_MUST_BE_LESS_THAN_10_TIMES_OF_VOLUME_SIZE}),this.model.attributes.volume_detail.name},volumeTypeChecked:function(e){var t,n,r;return this.processIops(),n=$("#volume-type-radios input:checked").val(),n==="io1"?($("#iops-group").show(),r=parseInt($("#volume-size-ranged").val(),10),t=r*10,t>s&&(t=s),$("#iops-ranged").val(t)):(t="",$("#iops-group").hide()),this.model.setVolumeType(n,t),this.sizeChanged()},deviceNameChanged:function(e){var t,n,i,s,o,u,a,f;u=$(e.currentTarget),s=this.model.get("volume_detail").owner,i=u.val(),n=u.prev("label").text(),t=s.getAmi(),a=t.osType==="windows"?"windows":"linux",f=t.virtualizationType,o=this,u.parsley("custom",function(e){if(!MC.validate.deviceName(e,f))return f==="hvm"?r.PARSLEY.DEVICENAME_HVM:r.PARSLEY.DEVICENAME_PARAVIRTUAL;if(o.model.isDuplicate(e))return sprintf(r.PARSLEY.VOLUME_NAME_INUSE,e)});if(u.parsley("validate"))return this.model.setDeviceName(i),this.setTitle(this.model.attributes.volume_detail.name)},processIops:function(e){var t,n;return n=parseInt($("#volume-size-ranged").val(),10),t=$("#radio-io1").is(":checked"),n>=10?this.enableIops():t||this.disableIops(),null},enableIops:function(){return $("#volume-type-radios > div").last().data("tooltip","").find("input").removeAttr("disabled")},disableIops:function(){return $("#volume-type-radios > div").last().data("tooltip",r.PROP.VOLUME_DISABLE_IOPS_TOOLTIP).find("input").attr("disabled","")},sizeChanged:function(e){var t,n,r,i;return r=parseInt($("#volume-size-ranged").val(),10),n=!0,i=$("#volume-size-ranged").parsley("validate"),t=$("#radio-io1").is(":checked"),t&&(n=$("#iops-ranged").parsley("validate")),i&&n&&(this.model.setVolumeSize(r),t&&this.model.setVolumeType("io1",$("#iops-ranged").val())),null},showSnapshotDetail:function(e){return this.trigger("OPEN_SNAPSHOT",$("#snapshot-info-group").data("uid")),null},encryptedCheck:function(e){return this.model.setEncrypted(e.target.checked),null}}),new i}),define("wspace/awseditor/property/volume/app_model",["../base/model","Design","CloudResources","constant"],function(e,t,n,r){var i,s;return s=function(e){var i,s,o,u,a,f,l,c,h,p,d,v,m;a=e.get("owner").groupMembers()[0],o=e.get("name"),i=a.appId,u=n(t.instance().credentialId(),r.RESTYPE.INSTANCE,t.instance().region()),c=n(t.instance().credentialId(),r.RESTYPE.VOL,t.instance().region());if(!u)return null;s=(d=u.get(i))!=null?d.toJSON():void 0;if(s&&s.blockDeviceMapping){v=s.blockDeviceMapping;for(h=0,p=v.length;h<p;h++){f=v[h];if(s.rootDeviceName.indexOf(f.deviceName)!==-1)continue;l=(m=c.get(f.ebs.volumeId))!=null?m.attributes:void 0;if(!l)continue;if(l.device!==o)continue;return l}}return null},i=e.extend({init:function(e){var i,o,u;return o=t.instance().component(e),o?i=o.get("appId"):i=e,!i&&o.get("owner").type===r.RESTYPE.LC?u=s(o):(u=n(t.instance().credentialId(),r.RESTYPE.VOL,t.instance().region()).get(i),u=u.attributes),u.tags=o.tags(),u.isAppEdit=this.isAppEdit,u?(u.attachmentSet&&(u.name=u.attachmentSet[0].device),this.set(u)):!1}}),new i}),define("wspace/awseditor/property/volume/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+="\n    <dt>"+u(n.i18n.call(e,"PROP.VOLUME_SNAPSHOT_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=e&&e.snapshotId,typeof i===a?i.apply(e):i))+"</dd>\n    ",r}function c(e,t){return"Encrypted"}function h(e,t){return"Not Encrypted"}function p(e,t){var n="",r;return n+="\n    <dt>IOPS</dt>\n    <dd>"+u((r=e&&e.iops,typeof r===a?r.apply(e):r))+"</dd>\n    ",n}function d(e,t){var r="",i;r+='\n        <div class="option-group-head expand">\n            '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n        </div>\n        <div class="option-group">\n            ',i=n["if"].call(e,(i=e&&e.tags,i==null||i===!1?i:i.length),{hash:{},inverse:f.program(13,g,t),fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;return r+='\n            <div class="tags-action">\n                \n                <button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>\n            </div>\n        </div>\n    ",r}function v(e,t){var r="",i;r+='\n            <table class="table cost-estimation-table">\n                <tbody>\n                ',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(11,m,t),data:t});if(i||i===0)r+=i;return r+="\n                </tbody>\n            </table>\n            ",r}function m(e,t){var n="",r;return n+='\n                <tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n                ",n}function g(e,t){var r="";return r+='\n            <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n            ",r}function y(e,t){var r="",i;r+="\n        ",i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(16,b,t),data:t});if(i||i===0)r+=i;return r+="\n    ",r}function b(e,t){var r="",i;r+='\n        <div class="option-group-head">\n            '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n        </div>\n        <div class="option-group">\n            ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.program(13,g,t),fn:f.program(17,w,t),data:t});if(i||i===0)r+=i;return r+='\n            <div class="tags-action">\n                \n            </div>\n        </div>\n        ',r}function w(e,t){var r="",i;r+='\n            <table class="table cost-estimation-table">\n                <tbody>\n                ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(18,E,t),data:t});if(i||i===0)r+=i;return r+="\n                </tbody>\n            </table>\n            ",r}function E(e,t){var n="",r;return n+='\n                <tr> <td style="min-width:70px;">'+u((r=t==null||t===!1?t:t.key,typeof r===a?r.apply(e):r))+"</td><td>"+u(typeof e===a?e.apply(e):e)+"</td> </tr>\n                ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(t,"PROP.VOLUME_ID",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,t&&t.volumeId,{hash:{},data:i}))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP.VOLUME_DEVICE_NAME",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,t&&t.name,{hash:{},data:i}))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP.VOLUME_STATE",{hash:{},data:i}))+'</dt>\n    <dd><i class="status status-'+u((o=t&&t.status,typeof o===a?o.apply(t):o))+'"></i>'+u((o=t&&t.status,typeof o===a?o.apply(t):o))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP.VOLUME_CREATE_TIME",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.timeStr.call(t,t&&t.createTime,{hash:{},data:i}))+'</dd>\n  </dl>\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(t,"PROP.VOLUME_TYPE",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.readableVt.call(t,t&&t.volumeType,{hash:{},data:i}))+"</dd>\n    ",o=n["if"].call(t,t&&t.snapshotId,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n    <dt>"+u(n.i18n.call(t,"PROP.VOLUME_SIZE",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,t&&t.size,{hash:{},data:i}))+" GB</dd>\n    <dt>"+u(n.i18n.call(t,"PROP.VOLUME_ENCRYPTED",{hash:{},data:i}))+"</dt>\n    <dd>",o=n["if"].call(t,t&&t.encrypted,{hash:{},inverse:f.program(5,h,i),fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+="</dd>\n    ",o=n["if"].call(t,t&&t.iops,{hash:{},inverse:f.noop,fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+='\n  </dl>\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(t,"PROP.VOLUME_ATTACHMENT_STATE",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,(o=(o=t&&t.attachmentSet,o==null||o===!1?o:o[0]),o==null||o===!1?o:o.state),{hash:{},data:i}))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP.VOLUME_INSTANCE_ID",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.emptyStr.call(t,(o=(o=t&&t.attachmentSet,o==null||o===!1?o:o[0]),o==null||o===!1?o:o.instanceId),{hash:{},data:i}))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP.VOLUME_ATTACHMENT_TIME",{hash:{},data:i}))+"</dt>\n    <dd>"+u(n.timeStr.call(t,(o=(o=t&&t.attachmentSet,o==null||o===!1?o:o[0]),o==null||o===!1?o:o.attachTime),{hash:{},data:i}))+"</dd>\n  </dl>\n\n    ",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.program(15,y,i),fn:f.program(9,d,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/volume/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name}}),new n}),define("wspace/awseditor/property/volume/main",["../base/main","./model","./view","./app_model","./app_view","constant"],function(e,t,n,r,i,s){var o;return o=e.extend({handleTypes:[s.RESTYPE.VOL],setupStack:function(){return this.view.on("OPEN_SNAPSHOT",function(t){return e.loadSubPanel("STATIC",t),null}),null},initStack:function(e){var r,i;return i=Design.instance().component(e),r=i.get("owner"),this.model=t,this.view=n,r.type===s.RESTYPE.LC&&r.get("appId")?this.model.isAppEdit=!0:this.model.isAppEdit=!1,null},initApp:function(){return this.model=r,this.view=i,this.model.isAppEdit=!1,null},initAppEdit:function(){return this.model=r,this.view=i,this.model.isAppEdit=!0,null}}),null}),define("wspace/awseditor/property/elb/model",["../base/model","Design","constant","sslcert_dropdown","CloudResources"],function(e,t,n,r,i){var s;return s=e.extend({init:function(e){var r,i,s,o,u,a,f,l,c,h;s=t.instance().component(e),this.getAppData(e),i=s!=null?s.toJSON():void 0,i.uid=e,i.isVpc=!0,i.description=s!=null?s.get("description"):void 0,a=s.getHealthCheckTarget(),i.pingProtocol=a[0],i.pingPort=a[1],i.pingPath=a[2],i.sslCert&&(i.sslCert=(c=i.sslCert)!=null?c.toJSON():void 0),h=i.listeners;for(f=0,l=h.length;f<l;f++){u=h[f];if(u.protocol==="SSL"||u.protocol==="HTTPS"){i.showCert=!0;break}}return o=s.connectionTargets("SslCertUsage")[0],r=t.modelClassForType(n.RESTYPE.IAM).allObjects(),i.noSSLCert=!0,i.sslCertItem=_.map(r,function(e){var t;return o===e&&(i.noSSLCert=!1),t=!1,e.get("certId")&&e.get("arn")&&(t=!0),{uid:e.id,name:e.get("name"),selected:o===e,disableCertEdit:t}}),i.ConnectionDraining&&(i.ConnectionDraining.Enabled===!0?(i.connectionDrainingEnabled=!0,i.connectionDrainingTimeout=i.ConnectionDraining.Timeout):i.connectionDrainingEnabled=!1),this.set(i),null},getAppData:function(e){var r,s;e=e||this.get("uid"),s=t.instance().component(e),r=i(t.instance().credentialId(),n.RESTYPE.ELB,t.instance().region()).get(s.get("appId"));if(!r)return;return r=r.attributes,this.set({appData:!0,isInternet:r.Scheme==="internet-facing",DNSName:r.Dnsname,CanonicalHostedZoneNameID:r.CanonicalHostedZoneNameID}),null},setScheme:function(e){return e=e==="internal",t.instance().component(this.get("uid")).setInternal(e),e||t.modelClassForType(n.RESTYPE.IGW).tryCreateIgw(),null},setElbCrossAZ:function(e){return t.instance().component(this.get("uid")).set("crossZone",!!e),null},setHealthProtocol:function(e){return t.instance().component(this.get("uid")).setHealthCheckTarget(e),null},setHealthPort:function(e){return t.instance().component(this.get("uid")).setHealthCheckTarget(void 0,e),null},setHealthPath:function(e){return t.instance().component(this.get("uid")).setHealthCheckTarget(void 0,void 0,e),null},setHealthInterval:function(e){return t.instance().component(this.get("uid")).set("healthCheckInterval",e),null},setHealthTimeout:function(e){return t.instance().component(this.get("uid")).set("healthCheckTimeout",e),null},setHealthUnhealth:function(e){return t.instance().component(this.get("uid")).set("unHealthyThreshold",e),null},setHealthHealth:function(e){return t.instance().component(this.get("uid")).set("healthyThreshold",e),null},setListener:function(e,n){return t.instance().component(this.get("uid")).setListener(e,n),null},removeListener:function(e){return t.instance().component(this.get("uid")).removeListener(e),null},setCert:function(e){return t.instance().component(this.get("uid")).connectionTargets("SslCertUsage")[0].set(e),null},addCert:function(e){var r;return r=t.modelClassForType(n.RESTYPE.IAM),(new r(e)).assignTo(t.instance().component(this.get("uid"))),null},removeCert:function(e){return t.instance().component(e).remove(),null},updateElbAZ:function(e){return t.instance().component(this.get("uid")).set("AvailabilityZones",e),null},changeCert:function(e){var n,r,i,s,o;r=t.instance();if(e)r.component(e).assignTo(r.component(this.get("uid")));else{o=r.component(this.get("uid")).connections("SslCertUsage");for(i=0,s=o.length;i<s;i++)n=o[i],n.remove()}return null},updateCert:function(e,n){return t.instance().component(e).updateValue(n),null},getOtherCertName:function(e){var r,i;return r=t.modelClassForType(n.RESTYPE.IAM).allObjects(),i=[],_.each(r,function(t){var n;n=t.get("name");if(e!==n)return i.push(n)}),i},setConnectionDraining:function(e,n){var r;return e||(n=null),r=t.instance().component(this.get("uid")),r.set("ConnectionDraining",{Enabled:e,Timeout:n})},setAdvancedProxyProtocol:function(e,n){var r;return r=t.instance().component(this.get("uid")),r.setPolicyProxyProtocol(e,n)},initNewSSLCertDropDown:function(e,n){var i,s,o,u;return u=this,i=t.instance().component(this.get("uid")),s=new r,s.uid=this.get("uid"),s.listenerNum=e,o=i.getSSLCert(e),o&&(s.sslCertName=o.get("name")),s},setIdletimeout:function(e){var n;return n=t.instance().component(this.get("uid")),n.set("idleTimeout",e)}}),new s}),define("wspace/awseditor/property/elb/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n    <dl class="dl-vertical property-app">\n      <dt>'+u(n.i18n.call(e,"PROP.ELB_SCHEME",{hash:{},data:t}))+"</dt>\n      <dd>",i=n["if"].call(e,e&&e.isInternet,{hash:{},inverse:a.program(4,h,t),fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.ELB_DNS_NAME",{hash:{},data:t}))+'</dt>\n      <dd>\n        <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:t}))+'">(A)'+u((i=e&&e.DNSName,typeof i===f?i.apply(e):i))+'</div>\n        <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:t}))+'">(AAAA)ipv6.'+u((i=e&&e.DNSName,typeof i===f?i.apply(e):i))+'</div>\n        <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:t}))+'">(A/AAAA)dualstack.'+u((i=e&&e.DNSName,typeof i===f?i.apply(e):i))+"</div>\n      </dd>\n      <dt>"+u(n.i18n.call(e,"PROP.ELB_HOST_ZONE_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.CanonicalHostedZoneNameID,typeof i===f?i.apply(e):i))+"<dd>\n    </dl>\n	",r}function c(e,t){return u(n.i18n.call(e,"PROP.ELB_INTERNET_FACING",{hash:{},data:t}))}function h(e,t){return u(n.i18n.call(e,"PROP.ELB_INTERNAL",{hash:{},data:t}))}function p(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left" for="property-elb-name" >'+u(n.i18n.call(e,"PROP.ELB_NAME",{hash:{},data:t}))+'</label>\n			<span class="required-input right">'+u(n.i18n.call(e,"PROP.ELB_REQUIRED",{hash:{},data:t}))+'</span>\n			<input data-ignore="true" data-required-rollback="true" maxlength="23" class="input elb-name"  type="text" value="'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" id="property-elb-name"/>\n		</section>\n		',i=n["if"].call(e,e&&e.isVpc,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function d(e,t){var r="",i;r+='\n		<section class="property-control-group">\n      <label>'+u(n.i18n.call(e,"PROP.ELB_SCHEME",{hash:{},data:t}))+'</label>\n      <div class="mgt5">\n        <div class="radio">\n            <input type="radio" ',i=n.unless.call(e,e&&e.internal,{hash:{},inverse:a.noop,fn:a.program(8,v,t),data:t});if(i||i===0)r+=i;r+=' value="internet" id="elb-scheme-select1" name="elb-schema-select"/>\n            <label for="elb-scheme-select1"></label>\n        </div>\n        <label for="elb-scheme-select1">Internet-facing</label>\n      </div>\n      <div class="mgt5">\n        <div class="radio">\n            <input type="radio" ',i=n["if"].call(e,e&&e.internal,{hash:{},inverse:a.noop,fn:a.program(8,v,t),data:t});if(i||i===0)r+=i;return r+=' value="internal" id="elb-scheme-select2" name="elb-schema-select"/>\n            <label for="elb-scheme-select2"></label>\n        </div>\n        <label for="elb-scheme-select2">Internal</label>\n    	</div>\n		</section>\n		',r}function v(e,t){return'checked="checked"'}function m(e,t){return"hide"}function g(e,t){var n;return u((n=e&&e.connectionDrainingTimeout,typeof n===f?n.apply(e):n))}function y(e,t){return"300"}function b(e,t){var r="",i;r+='\n		<li class="elb-property-listener">\n			<div class="elb-property-listener-item-remove icon-remove tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ELB_TIP_REMOVE_LISTENER",{hash:{},data:t}))+'"></div>\n\n			<div class="property-control-group listener-item clearfix">\n				<div>\n					<label class="left">'+u(n.i18n.call(e,"PROP.ELB_LOAD_BALENCER_PROTOCOL",{hash:{},data:t}))+'</label>\n					<div class="selectbox elb-property-elb-protocol">\n						<div class="selection">'+u((i=e&&e.protocol,typeof i===f?i.apply(e):i))+'</div>\n						<ul class="dropdown">\n							<li data-id="HTTP" class="item ',i=n.ifCond.call(e,e&&e.protocol,"HTTP",{hash:{},inverse:a.noop,fn:a.program(17,w,t),data:t});if(i||i===0)r+=i;r+='">HTTP</li>\n							<li data-id="HTTPS" class="item ',i=n.ifCond.call(e,e&&e.protocol,"HTTPS",{hash:{},inverse:a.noop,fn:a.program(17,w,t),data:t});if(i||i===0)r+=i;r+='">HTTPS</li>\n							<li data-id="TCP" class="item ',i=n.ifCond.call(e,e&&e.protocol,"TCP",{hash:{},inverse:a.noop,fn:a.program(17,w,t),data:t});if(i||i===0)r+=i;r+='">TCP</li>\n							<li data-id="SSL" class="item ',i=n.ifCond.call(e,e&&e.protocol,"SSL",{hash:{},inverse:a.noop,fn:a.program(17,w,t),data:t});if(i||i===0)r+=i;r+='">SSL</li>\n						</ul>\n					</div>\n				</div>\n				<div>\n					<label class="left">'+u(n.i18n.call(e,"PROP.PORT",{hash:{},data:t}))+'</label>\n					<input class="input elb-property-elb-port tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ELB_TIP_25_80_443OR1024TO65535",{hash:{},data:t}))+'" type="text" value="'+u((i=e&&e.port,typeof i===f?i.apply(e):i))+'" data-ignore="true" data-required="true" data-type="digits" maxlength="5"/>\n				</div>\n			</div>\n\n			<div class="property-control-group listener-item clearfix">\n				<div class="left elb-property-listener-item-1">\n					<label class="left">'+u(n.i18n.call(e,"PROP.ELB_INSTANCE_PROTOCOL",{hash:{},data:t}))+'</label>\n					<div class="selectbox elb-property-instance-protocol">\n						<div class="selection">'+u((i=e&&e.instanceProtocol,typeof i===f?i.apply(e):i))+'</div>\n						<ul class="dropdown">\n							<li data-id="HTTP" class="item ',i=n.ifCond.call(e,e&&e.instanceProtocol,"HTTP",{hash:{},inverse:a.noop,fn:a.program(17,w,t),data:t});if(i||i===0)r+=i;r+='">HTTP</li>\n							<li data-id="HTTPS" class="item ',i=n.ifCond.call(e,e&&e.instanceProtocol,"HTTPS",{hash:{},inverse:a.noop,fn:a.program(17,w,t),data:t});if(i||i===0)r+=i;r+='">HTTPS</li>\n							<li data-id="TCP" class="item ',i=n.ifCond.call(e,e&&e.instanceProtocol,"TCP",{hash:{},inverse:a.noop,fn:a.program(17,w,t),data:t});if(i||i===0)r+=i;r+='">TCP</li>\n							<li data-id="SSL" class="item ',i=n.ifCond.call(e,e&&e.instanceProtocol,"SSL",{hash:{},inverse:a.noop,fn:a.program(17,w,t),data:t});if(i||i===0)r+=i;return r+='">SSL</li>\n						</ul>\n					</div>\n				</div>\n				<div class="left elb-property-listener-item-2">\n					<label class="left">'+u(n.i18n.call(e,"PROP.PORT",{hash:{},data:t}))+'</label>\n					<input class="input elb-property-instance-port tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ELB_TIP_1_65535",{hash:{},data:t}))+'" type="text" value="'+u((i=e&&e.instancePort,typeof i===f?i.apply(e):i))+'" data-ignore="true" data-required="true" data-type="digits" maxlength="5"/>\n				</div>\n			</div>\n\n			<div class="property-control-group sslcert-select clearfix">\n				<label for="sslcert-placeholder">'+u(n.i18n.call(e,"PROP.ELB_SERVER_CERTIFICATE",{hash:{},data:t}))+'</label>\n				<div class="sslcert-placeholder"></div>\n			</div>\n		</li>\n		',r}function w(e,t){return"selected"}function E(e,t){return" selected"}function S(e,t){return'disabled="disabled"'}function x(e,t){var r="";return r+='\n	<div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.ELB_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n	<div class="option-group sg-group"></div>\n\n	',r}function T(e,t){var r="",i;r+="\n		",i=n["if"].call(e,e&&e.azArray,{hash:{},inverse:a.noop,fn:a.program(26,N,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function N(e,t){var r="",i;r+='\n		<div class="option-group-head"> '+u(n.i18n.call(e,"PROP.ELB_AVAILABILITY_ZONE",{hash:{},data:t}))+' </div>\n		<div class="option-group" id="property-elb-az-cb-group">\n			',i=n.each.call(e,e&&e.azArray,{hash:{},inverse:a.noop,fn:a.program(27,C,t),data:t});if(i||i===0)r+=i;return r+="\n		</div>\n		",r}function C(e,t){var r="",i;r+='\n			<section class="property-control-group">\n				<div class="checkbox">\n					<input class="property-elb-az-checkbox" type="checkbox" ',i=n["if"].call(e,e&&e.disabled,{hash:{},inverse:a.noop,fn:a.program(21,S,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(8,v,t),data:t});if(i||i===0)r+=i;return r+=' data-name="'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" id="property-elb-az-'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'"/>\n					<label for="property-elb-az-'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'"></label>\n				</div>\n				<label for="property-elb-az-'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" class="checkbox-label-main">\n					<span>'+u((i=e&&e.displayName,typeof i===f?i.apply(e):i))+'</span></label>\n				<label for="property-elb-az-'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" class="checkbox-label-minor">'+u((i=e&&e.instanceCount,typeof i===f?i.apply(e):i))+" instances</label>\n			</section>\n			",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<article id="stack-elb-property-panel">\n\n	<div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.ELB_DETAILS",{hash:{},data:i}))+'</div>\n	<div class="option-group" data-bind="true" >\n	',o=n["if"].call(t,t&&t.appData,{hash:{},inverse:a.program(6,p,i),fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n		<section class="property-control-group" data-bind="true">\n		<label class="left" for="property-res-desc">'+u(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+'</label>\n		<textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((o=t&&t.description,typeof o===f?o.apply(t):o))+'</textarea>\n		</section>\n		<section class="property-control-group">\n			<div class="checkbox">\n				<input id="elb-cross-az-select" type="checkbox" ',o=n["if"].call(t,t&&t.crossZone,{hash:{},inverse:a.noop,fn:a.program(8,v,i),data:i});if(o||o===0)s+=o;s+='/>\n				<label for="elb-cross-az-select"></label>\n			</div>\n			<label for="elb-cross-az-select" >'+u(n.i18n.call(t,"PROP.ELB_ENABLE_CROSS_ZONE_BALANCING",{hash:{},data:i}))+'</label>\n			<a class="elb-info-icon tooltip icon-info" href="https://aws.amazon.com/about-aws/whats-new/2013/11/06/elastic-load-balancing-adds-cross-zone-load-balancing/" data-tooltip="'+u(n.i18n.call(t,"PROP.ELB_TIP_CLICK_TO_READ_RELATED_AWS_DOCUMENT",{hash:{},data:i}))+'" target="_blank"></a>\n		</section>\n		<section class="property-control-group">\n			<div class="checkbox">\n				<input id="elb-connection-draining-select" type="checkbox" ',o=n["if"].call(t,t&&t.connectionDrainingEnabled,{hash:{},inverse:a.noop,fn:a.program(8,v,i),data:i});if(o||o===0)s+=o;s+='/>\n				<label for="elb-connection-draining-select"></label>\n			</div>\n			<label for="elb-connection-draining-select" >'+u(n.i18n.call(t,"PROP.ELB_CONNECTION_DRAINING",{hash:{},data:i}))+'</label>\n			<a class="elb-info-icon tooltip icon-info" href="http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/config-conn-drain.html" data-tooltip="'+u(n.i18n.call(t,"PROP.ELB_TIP_CLICK_TO_READ_RELATED_AWS_DOCUMENT",{hash:{},data:i}))+'" target="_blank"></a>\n			<div class="elb-connection-draining-input-group ',o=n.unless.call(t,t&&t.connectionDrainingEnabled,{hash:{},inverse:a.noop,fn:a.program(10,m,i),data:i});if(o||o===0)s+=o;s+='">\n				<label for="elb-connection-draining-input" class="left">'+u(n.i18n.call(t,"PROP.ELB_CONNECTION_TIMEOUT",{hash:{},data:i}))+'</label>\n				<input id="elb-connection-draining-input" class="input parsley-validated" type="text" value="',o=n["if"].call(t,t&&t.connectionDrainingTimeout,{hash:{},inverse:a.program(14,y,i),fn:a.program(12,g,i),data:i});if(o||o===0)s+=o;s+='" data-ignore="true" data-required="true" data-type="number">\n				<label for="elb-connection-draining-input">'+u(n.i18n.call(t,"PROP.ELB_CONNECTION_SECONDS",{hash:{},data:i}))+'</label>\n			</div>\n		</section>\n		<section class="property-control-group">\n			<label for="property-elb-idle-timeout" >'+u(n.i18n.call(t,"PROP.ELB_IDLE_TIMEOUT",{hash:{},data:i}))+'</label>\n			<input class="input input-short mgt5"  type="text" value="'+u((o=t&&t.idleTimeout,typeof o===f?o.apply(t):o))+'" name="property-elb-idle-timeout" id="property-elb-idle-timeout" data-required="true" data-type="digits" data-min="1" data-max="3600" data-ignore="true"/>\n			<label class="mgl5" for="property-elb-idle-timeout" >'+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_INTERVAL_SECONDS",{hash:{},data:i}))+'</label>\n		</section>\n	</div>\n\n	<div class="option-group-head"> '+u(n.i18n.call(t,"PROP.ELB_LISTENER_DETAIL",{hash:{},data:i}))+' </div>\n	<div class="option-group" data-bind="true"> <ul id="elb-property-listener-list" class="mega-list-wraper">\n		',o=n.each.call(t,t&&t.listeners,{hash:{},inverse:a.noop,fn:a.program(16,b,i),data:i});if(o||o===0)s+=o;s+='\n		</ul>\n		<a href="#" id="elb-property-listener-content-add" class="add-to-list">'+u(n.i18n.call(t,"PROP.ELB_BTN_ADD_LISTENER",{hash:{},data:i}))+'</a>\n	</div>\n\n	<div class="option-group-head"> '+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_DETAILS",{hash:{},data:i}))+' </div>\n	<div class="option-group" data-bind="true" data-validate="parsley" >\n		<section class="property-control-group">\n			<label>'+u(n.i18n.call(t,"PROP.ELB_PING_PROTOCOL",{hash:{},data:i}))+'</label>\n			<div class="selectbox mgt5" id="elb-property-health-protocol-select">\n				<div class="selection">'+u((o=t&&t.pingProtocol,typeof o===f?o.apply(t):o))+'</div>\n				<ul class="dropdown" tabindex="-1">\n					<li class="item',o=n.ifCond.call(t,t&&t.pingProtocol,"TCP",{hash:{},inverse:a.noop,fn:a.program(19,E,i),data:i});if(o||o===0)s+=o;s+='" data-id="TCP">TCP</li>\n					<li class="item',o=n.ifCond.call(t,t&&t.pingProtocol,"HTTP",{hash:{},inverse:a.noop,fn:a.program(19,E,i),data:i});if(o||o===0)s+=o;s+='" data-id="HTTP">HTTP</li>\n					<li class="item',o=n.ifCond.call(t,t&&t.pingProtocol,"HTTPS",{hash:{},inverse:a.noop,fn:a.program(19,E,i),data:i});if(o||o===0)s+=o;s+='" data-id="HTTPS">HTTPS</li>\n					<li class="item',o=n.ifCond.call(t,t&&t.pingProtocol,"SSL",{hash:{},inverse:a.noop,fn:a.program(19,E,i),data:i});if(o||o===0)s+=o;s+='" data-id="SSL">SSL</li>\n				</ul>\n			</div>\n		</section>\n		<section class="property-control-group" data-bind="true">\n			<label for="property-elb-health-port" >'+u(n.i18n.call(t,"PROP.ELB_PING_PORT",{hash:{},data:i}))+'</label>\n			<input class="input mgt5" tooltip="1-65535" type="text" value="'+u((o=t&&t.pingPort,typeof o===f?o.apply(t):o))+'" name="property-elb-health-port" id="property-elb-health-port" data-required="true" data-type="digits" data-ignore="true" maxlength="5"/>\n		</section>\n		<section class="property-control-group">\n			<label for="property-elb-health-path" >'+u(n.i18n.call(t,"PROP.ELB_PING_PATH",{hash:{},data:i}))+'</label>\n			<div class="pos-r mgt5">\n				<input class="input" ',o=n.ifCond.call(t,t&&t.pingProtocol,"SSL",{hash:{},inverse:a.noop,fn:a.program(21,S,i),data:i});if(o||o===0)s+=o;o=n.ifCond.call(t,t&&t.pingProtocol,"TCP",{hash:{},inverse:a.noop,fn:a.program(21,S,i),data:i});if(o||o===0)s+=o;s+='type="text" value="'+u((o=t&&t.pingPath,typeof o===f?o.apply(t):o))+'" name="property-elb-health-path" id="property-elb-health-path" />\n				<span class="elb-pingpath-prefix">/</span>\n			</div>\n		</section>\n\n		<section class="property-control-group">\n			<label for="property-elb-health-interval" >'+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_INTERVAL",{hash:{},data:i}))+'</label>\n			<input class="input input-short mgt5"  type="text" value="'+u((o=t&&t.healthCheckInterval,typeof o===f?o.apply(t):o))+'" name="property-elb-health-interval" id="property-elb-health-interval" data-required="true" data-type="digits" data-ignore="true"/>\n			<label class="mgl5" for="property-elb-health-interval" >'+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_INTERVAL_SECONDS",{hash:{},data:i}))+'</label>\n		</section>\n		<section class="property-control-group">\n			<label for="property-elb-health-timout" >'+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_RESPOND_TIMEOUT",{hash:{},data:i}))+'</label>\n			<input class="input input-short mgt5"  type="text" value="'+u((o=t&&t.healthCheckTimeout,typeof o===f?o.apply(t):o))+'" name="property-elb-health-timeout" id="property-elb-health-timeout" data-required="true" data-type="digits" data-ignore="true"/>\n			<label class="mgl5" for="property-elb-health-timeout" >'+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_INTERVAL_SECONDS",{hash:{},data:i}))+'</label>\n		</section>\n\n		<section class="property-control-group">\n			<label>'+u(n.i18n.call(t,"PROP.ELB_UNHEALTH_THRESHOLD",{hash:{},data:i}))+'</label>\n			<div class="slider" id="elb-property-slider-unhealthy">\n				<a class="thumb"></a>\n				<ul class="marker"><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li></ul>\n			</div>\n		</section>\n		<section class="property-control-group">\n			<label>'+u(n.i18n.call(t,"PROP.ELB_HEALTH_THRESHOLD",{hash:{},data:i}))+'</label>\n			<div class="slider" id="elb-property-slider-healthy">\n				<a class="thumb"></a>\n				<ul class="marker"><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li></ul>\n			</div>\n		</section>\n	</div>\n\n	',o=n["if"].call(t,t&&t.isVpc,{hash:{},inverse:a.program(25,T,i),fn:a.program(23,x,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/elb/view",["../base/view","./template/stack","event","i18n!/nls/lang.js"],function(e,t,n,r){var i,s;return s={makeInRange:function(e,t,n,r){var i,s;return i=t[0],s=t[1],isFinite(e)?(e=+e,e<i?e=i:e>s&&(e=s)):e=r,n.val(e),e}},i=e.extend({events:{"keyup #property-elb-name":"elbNameChange","change #property-res-desc":"onChangeDesc","change #elb-scheme-select1":"schemeSelectChange","change #elb-scheme-select2":"schemeSelectChange","OPTION_CHANGE #elb-property-health-protocol-select":"healthProtocolSelect","change #property-elb-health-port":"healthPortChanged","change #property-elb-health-path":"healthPathChanged","change #property-elb-health-interval":"healthIntervalChanged","change #property-elb-health-timeout":"healthTimeoutChanged","OPTION_CHANGE .elb-property-elb-protocol":"protocolChanged","OPTION_CHANGE .elb-property-instance-protocol":"protocolChanged","change .elb-property-elb-port":"portChanged","change .elb-property-instance-port":"portChanged","click #elb-property-listener-content-add":"listenerItemAddClicked","click .elb-property-listener-item-remove":"listenerItemRemovedClicked","change #elb-property-cert-name-input":"listenerCertChanged","change #elb-property-cert-privatekey-input":"listenerCertChanged","change #elb-property-cert-publickey-input":"listenerCertChanged","change #elb-property-cert-chain-input":"listenerCertChanged","change .property-elb-az-checkbox":"azCheckChanged","mousedown .slider .thumb":"sliderMouseDown","mousedown .slider li":"sliderSelect","SLIDER_CHANGE .slider":"sliderChanged","change #elb-cross-az-select":"elbCrossAZSelect","click #sslcert-select .item":"changeSSLCert","click #elb-connection-draining-select":"elbConnectionDrainSelectChange","change #elb-connection-draining-input":"elbConnectionDrainTimeoutChange","click #elb-advanced-proxy-protocol-select":"elbAdvancedProxyProtocolSelectChange","change #property-elb-idle-timeout":"elbIdleTimeoutChange"},render:function(){var e;return e=this,this.$el.html(t(this.model.attributes)),this.updateSlider($("#elb-property-slider-unhealthy"),this.model.get("unHealthyThreshold")-2),this.updateSlider($("#elb-property-slider-healthy"),this.model.get("healthyThreshold")-2),_.each(this.$(".sslcert-placeholder"),function(t,n){var r,i,s;return i=$(t),r=i.parents(".elb-property-listener"),s=e.model.initNewSSLCertDropDown(n),r.data("sslCertDropDown",s),i.html(s.render().el)}),this.updateCertView(),this.model.attributes.name},elbNameChange:function(e){var t,n,r,i;i=$(e.currentTarget),t=i.val(),r=this.model.get("name");if(MC.aws.aws.checkResName(this.model.get("uid"),i,"Load Balancer"))return this.model.setName(t),this.setTitle(t),r+="-sg",n=t+"-sg",$("#sg-info-list").children().each(function(){var e;e=$(this).find(".sg-name");if(e.text()===r)return e.text(n),!1})},onChangeDesc:function(e){return this.model.setDesc($(e.currentTarget).val())},schemeSelectChange:function(e){return this.model.setScheme(e.currentTarget.value),null},healthProtocolSelect:function(e,t){return t==="TCP"||t==="SSL"?$("#property-elb-health-path").attr("disabled","disabled"):$("#property-elb-health-path").removeAttr("disabled"),this.model.setHealthProtocol(t)},healthPortChanged:function(e){var t,n;return t=$(e.currentTarget),n=t.val(),n=s.makeInRange(n,[1,65535],t,1),this.model.setHealthPort(n)},healthPathChanged:function(e){return this.model.setHealthPath($(e.currentTarget).val())},healthIntervalChanged:function(e){var t,n,i;t=$(e.currentTarget),i=s.makeInRange(t.val(),[5,300],t,30),n=$("#property-elb-health-timeout"),t.parsley("custom",function(e){var t,i;return t=Number(e),i=Number(n.val()),t<=i?r.PROP.ELB_HEALTH_INTERVAL_VALID:null});if(!t.parsley("validate"))return;return n.parsley("validate"),this.model.setHealthInterval(i)},healthTimeoutChanged:function(e){var t,n,i;n=$(e.currentTarget),i=s.makeInRange(n.val(),[2,60],n,5),t=$("#property-elb-health-interval"),n.parsley("custom",function(e){var n,i;return n=Number(t.val()),i=Number(e),n<=i?r.PROP.ELB_HEALTH_INTERVAL_VALID:null});if(!n.parsley("validate"))return;return t.parsley("validate"),this.model.setHealthTimeout(i)},elbIdleTimeoutChange:function(e){var t;t=$(e.currentTarget);if(t.parsley("validate"))return this.model.setIdletimeout(Number(t.val()))},sliderChanged:function(e,t){var n,r;return r=$(e.target),n=e.target.id,t+=2,n==="elb-property-slider-unhealthy"?this.model.setHealthUnhealth(t):this.model.setHealthHealth(t)},listenerItemAddClicked:function(e){var t,n,r,i,s,o,u;return u=this,t=$("#elb-property-listener-list").children().eq(0).clone(),i=t.find("ul"),r=t.find("input.input"),r.val("80"),i.children(".selected").removeClass("selected"),i.children(":first-child").addClass("selected"),i.prev(".selection").text("HTTP"),$("#elb-property-listener-list").append(t),this.updateListener(t),s=t.find(".sslcert-placeholder"),n=s.parents(".elb-property-listener"),o=u.model.initNewSSLCertDropDown(t.index()),n.data("sslCertDropDown",o),s.html(o.render().el),!1},updateListener:function(e){var t;return t={port:e.find(".elb-property-elb-port").val(),protocol:e.find(".elb-property-elb-protocol .selected").text(),instancePort:e.find(".elb-property-instance-port").val(),instanceProtocol:e.find(".elb-property-instance-protocol .selected").text()},this.model.setListener(e.index(),t),this.updateCertView(),null},protocolChanged:function(e){var t,n,r,i,s,o,u,a,f,l,c,h;return n=$(e.currentTarget),e&&(c=$(e.target),h=c.find(".selection").text(),h&&(l=null,a=null,f=c.parents(".elb-property-listener"),c.hasClass("elb-property-elb-protocol")?(l=f.find(".elb-property-elb-port"),a=f.find(".elb-property-instance-protocol")):(l=f.find(".elb-property-instance-port"),a=f.find(".elb-property-elb-protocol")),h==="HTTPS"||h==="SSL"?l.val("443"):l.val("80"),s={HTTP:"application",HTTPS:"application",TCP:"transport",SSL:"transport"},i=h,u=a.find(".selection").text(),s[i]!==s[u]&&(a.find(".selection").text(i),t=a.find(".item"),t.removeClass("selected"),r=a.find("[data-id="+i+"]"),r.addClass("selected")),a.hasClass("elb-property-elb-protocol")?l=f.find(".elb-property-elb-port"):l=f.find(".elb-property-instance-port"),o=a.find(".selection").text(),o==="HTTPS"||o==="SSL"?l.val("443"):l.val("80"))),this.updateListener(n.closest("li")),null},portChanged:function(e){var t,n;return t=$(e.currentTarget),t.hasClass("elb-property-elb-port")?n=function(e){e=parseInt(e,10);if(!(e===25||e===80||e===443||1023<e&&e<65536))return r.PARSLEY.LOAD_BALANCER_PORT_MUST_BE_SOME_PROT}:n=function(e){e=parseInt(e,10);if(!(0<e&&e<65536))return r.PARSLEY.INSTANCE_PORT_MUST_BE_BETWEEN_1_AND_65535},t.parsley("custom",n),t.parsley("validate")&&this.updateListener(t.closest("li")),null},listenerItemChanged:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v;return e&&(d=$(e.target),v=d.find(".selection").text(),v&&(p=null,c=null,h=d.parents(".elb-property-listener-main"),d.hasClass("elb-property-listener-elb-protocol-select")?(p=h.find(".elb-property-listener-elb-port-input"),c=h.find(".elb-property-listener-instance-protocol-select")):(p=h.find(".elb-property-listener-instance-port-input"),c=h.find(".elb-property-listener-elb-protocol-select")),v==="HTTPS"||v==="SSL"?p.val("443"):p.val("80"),i={HTTP:"application",HTTPS:"application",TCP:"transport",SSL:"transport"},t=v,l=c.find(".selection").text(),i[t]!==i[l]&&c.find(".selection").text(t),c.hasClass("elb-property-listener-elb-protocol-select")?p=h.find(".elb-property-listener-elb-port-input"):p=h.find(".elb-property-listener-instance-port-input"),f=c.find(".selection").text(),f==="HTTPS"||f==="SSL"?p.val("443"):p.val("80"))),a=this,o=$("#accordion-group-elb-property-listener"),u=o.find(".elb-property-listener-main"),s=[],r=!1,n=!1,u.each(function(e,t){var n,i,o,u,a,f,l,c;c=$(this),o=$.trim(c.find(".elb-property-listener-elb-protocol-select .selection").text()),i=c.find(".elb-property-listener-elb-port-input").val(),f=$.trim(c.find(".elb-property-listener-instance-protocol-select .selection").text()),a=c.find(".elb-property-listener-instance-port-input").val(),n=c.find(".elb-property-listener-elb-port-input"),u=c.find(".elb-property-listener-instance-port-input"),elbPortValidate&&instancePortValidate&&!isNaN(parseInt(i,10))&&!isNaN(parseInt(a,10))&&(l={Listener:{LoadBalancerPort:i,InstanceProtocol:f,Protocol:o,SSLCertificateId:"",InstancePort:a},PolicyNames:""},s.push(l));if(o==="HTTPS"||o==="SSL")r=!0;return null}),this.model.setListenerAry(idx,listener),this.updateCertView(),null},listenerItemRemovedClicked:function(e){var t;return t=$(e.currentTarget).closest("li"),this.model.removeListener(t.index()),t.remove(),this.updateCertView(),!1},listenerCertChanged:function(e){return this.model.setCert({name:$("#elb-property-cert-name-input").val(),key:$("#elb-property-cert-privatekey-input").val(),body:$("#elb-property-cert-publickey-input").val(),chain:$("#elb-property-cert-chain-input").val()}),null},updateCertView:function(){return $("#elb-property-listener-list").children().each(function(){var e,t,n,r;return n=$(this).find(".elb-property-elb-protocol .selected").text(),e=$(this).find(".sslcert-select"),t=$(this),r=t.data("sslCertDropDown"),n==="HTTPS"||n==="SSL"?(r&&r.setDefault(),e.show()):(r&&r.dropdown.setSelection("None"),e.hide())}),null},azCheckChanged:function(e){var t;return t=_.map($("#property-elb-az-cb-group").find("input:checked"),function(e){return $(e).attr("data-name")}),this.model.updateElbAZ(t),null},updateSlider:function(e,t){var n,r,i;return r=e.children(".marker").children().length-1,i=e.width(),n=t*Math.floor(i/r),e.data("value",t).children(".thumb").css("left",n),null},sliderSelect:function(e){var t,n,r;return n=$(e.currentTarget),t=n.closest(".slider"),r=n.index(),this.updateSlider(t,r),t.trigger("SLIDER_CHANGE",r),null},sliderMouseDown:function(e){var t,n,r,i,s,o,u,a,f,l,c,h;return t=$("body"),r=$(e.currentTarget),n=r.closest(".slider"),a=n.children(".marker").children().length-1,h=n.width(),f=Math.floor(h/a),u=e.clientX,l=r.position().left,c=n.data("value"),i=0,s=function(e){var t,n,s,o,p;return p=e.clientX-u,t=Math.abs(p),s=f/2,t>=s?(t+=s,n=p>0?1:-1,i=Math.floor(t/f)*n,o=l+i*f,o<0?(o=0,i=-c):o>h&&(o=h,i=a-c)):(o=l,i=0),r.css("left",o),!1},o=function(){var e;return t.off("mousemove",s),e=c+i,n.data("value",e).trigger("SLIDER_CHANGE",e),null},t.on("mousemove",s),t.one("mouseup",o),!1},elbCrossAZSelect:function(e){return this.model.setElbCrossAZ(e.target.checked),null},changeSSLCert:function(e){var t,r,i;return i=this,t=$(e.currentTarget),r=t.attr("data-id"),i.model.changeCert(r),n.trigger(n.REFRESH_PROPERTY)},elbConnectionDrainSelectChange:function(e){var t,n,r,i,s,o;s=this,n=s.$("#elb-connection-draining-select"),t=s.$(".elb-connection-draining-input-group"),r=s.$("#elb-connection-draining-input"),i=n.prop("checked"),i?t.removeClass("hide"):t.addClass("hide"),o=Number(r.val()),i&&o&&s.model.setConnectionDraining(!0,o);if(!i)return s.model.setConnectionDraining(!1)},elbConnectionDrainTimeoutChange:function(e){var t,n,i,s,o;s=this,n=s.$("#elb-connection-draining-input"),t=s.$("#elb-connection-draining-select"),i=t.prop("checked"),o=Number(n.val()),n.parsley("custom",function(e){var t;return t=Number(n.val()),t>=1&&t<3600?null:r.PROP.ELB_CONNECTION_DRAIN_TIMEOUT_INVALID});if(!n.parsley("validate"))return;if(i&&o)return s.model.setConnectionDraining(!0,o)},elbAdvancedProxyProtocolSelectChange:function(e){var t,n,r,i;return i=this,t=i.$("#elb-advanced-proxy-protocol-select"),n=$("#elb-advanced-proxy-protocol-select-tip"),r=t.prop("checked"),r?n.removeClass("hide"):n.addClass("hide"),i.model.setAdvancedProxyProtocol(r,[80])}}),new i}),define("wspace/awseditor/property/elb/app_model",["../base/model","constant","Design","CloudResources"],function(e,t,n,r){var i;return i=e.extend({defaults:{id:null},init:function(e){var i,s,o,u,a,f,l,c;return this.set("id",e),this.set("uid",e),u=n.instance().component(e),i=r(n.instance().credentialId(),t.RESTYPE.ELB,n.instance().region()).get(u.get("appId")),i?(i=i.toJSON(),i.description=u.get("description"),i.name=u.get("name"),i.ConnectionDraining?i.ConnectionDraining.Enabled?i.ConnectionDrainingInfo="Enabled; Timeout: "+i.ConnectionDraining.Timeout+" seconds":i.ConnectionDrainingInfo="Disabled":i.ConnectionDrainingInfo="Disabled",i.IdleTimeout=(c=i.ConnectionSettings)!=null?c.IdleTimeout:void 0,i.name=u.get("name"),i.isInternet=i.Scheme==="internet-facing",l=i.HealthCheck.Target,f=l.indexOf(":"),i.HealthCheck.protocol=l.substring(0,f),l=l.substring(f+1),a=parseInt(l,10),isNaN(a)&&(a=80),i.HealthCheck.port=a,i.HealthCheck.path=l.replace(/[^\/]+\//,"/"),i.CrossZone=u.get("crossZone")?"Enabled":"Disabled",i.listenerDisplay=[],i.ListenerDescriptions&&$.each(i.ListenerDescriptions,function(e,t){i.listenerDisplay.push(t);if(t.Listener.SslcertificateId)return t.Listener.server_certificate=t.Listener.SslcertificateId.split("/")[1],null}),i.isClassic=!1,i.defaultVPC=!1,i.distribution=[],s={},o=i.InstanceStates,_.each(o,function(e){var i,o,u,a,f,l,c,h,p,d,v,m,g;try{return a=e.InstanceId,h=e.ReasonCode,c=e.State,p=e.Description,u=n.modelClassForType(t.RESTYPE.INSTANCE).getEffectiveId(a),d=u.uid,o=n.instance().component(d),m="",o&&(l=o.get("name"),l===a&&(l=null),g={instance_name:l,instance_id:a,instance_state:c==="InService",instance_state_desc:p},v=null,o.parent()&&o.parent().parent()&&(v=o.parent().parent(),o.type===t.RESTYPE.LC&&(v=o.parent().parent().parent())),v&&(m=v.get("name"))),m||(f=r(n.instance().credentialId(),t.RESTYPE.INSTANCE,n.instance().region()).get(a),f&&f.get("placement")&&(m=f.get("placement").availabilityZone)),s[m]=s[m]||[],s[m].push(g)}catch(y){return i=y,void 0}}),_.each(s,function(e,t){var n;return n=!0,_.each(e,function(e){return e.instance_state||(n=!1),null}),i.distribution.push({zone:t,instance:e,health:n})}),i.distribution=i.distribution.sort(function(e,t){return e.zone>t.zone}),this.set(i),this.set("componentUid",u.id)):!1}}),new i}),define("wspace/awseditor/property/elb/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return u(n.i18n.call(e,"PROP.ELB_INTERNET_FACING",{hash:{},data:t}))}function c(e,t){return u(n.i18n.call(e,"PROP.ELB_INTERNAL",{hash:{},data:t}))}function h(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP.ELB_IDLE_TIMEOUT",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.IdleTimeout,typeof i===a?i.apply(e):i))+" seconds<dd>\n        ",r}function p(e,t){var r="",i;r+="\n      <li>\n        <div>\n          <label>"+u(n.i18n.call(e,"PROP.ELB_ELB_PROTOCOL",{hash:{},data:t}))+"</label>\n          <div>"+u((i=(i=e&&e.Listener,i==null||i===!1?i:i.Protocol),typeof i===a?i.apply(e):i))+"</div>\n        </div>\n\n        <div>\n          <label>"+u(n.i18n.call(e,"PROP.PORT",{hash:{},data:t}))+"</label>\n          <div>"+u((i=(i=e&&e.Listener,i==null||i===!1?i:i.LoadBalancerPort),typeof i===a?i.apply(e):i))+"</div>\n        </div>\n\n        <div>\n          <label>"+u(n.i18n.call(e,"PROP.ELB_INSTANCE_PROTOCOL",{hash:{},data:t}))+"</label>\n          <div>"+u((i=(i=e&&e.Listener,i==null||i===!1?i:i.InstanceProtocol),typeof i===a?i.apply(e):i))+"</div>\n        </div>\n\n        <div>\n          <label>"+u(n.i18n.call(e,"PROP.PORT",{hash:{},data:t}))+"</label>\n          <div>"+u((i=(i=e&&e.Listener,i==null||i===!1?i:i.InstancePort),typeof i===a?i.apply(e):i))+"</div>\n        </div>\n        ",i=n["if"].call(e,(i=e&&e.Listener,i==null||i===!1?i:i.server_certificate),{hash:{},inverse:f.noop,fn:f.program(8,d,t),data:t});if(i||i===0)r+=i;return r+="\n      </li>\n    ",r}function d(e,t){var r="",i;return r+='\n        <div class="app-panel-li-col2-full">\n          <label>'+u(n.i18n.call(e,"PROP.ELB_SERVER_CERTIFICATE",{hash:{},data:t}))+"</label>\n          <div>"+u((i=(i=e&&e.Listener,i==null||i===!1?i:i.server_certificate),typeof i===a?i.apply(e):i))+"</div>\n        </div>\n        ",r}function v(e,t){var r="",i;r+='\n  <div class="option-group-head">'+u(n.i18n.call(e,"PROP.ELB_INSTANCES",{hash:{},data:t}))+'</div>\n  <ul class="option-group mega-list-wraper">\n    ',i=n.each.call(e,e&&e.distribution,{hash:{},inverse:f.noop,fn:f.program(11,m,t),data:t});if(i||i===0)r+=i;return r+="\n  </ul>\n  ",r}function m(e,t){var r="",i;r+='\n      <li>\n        <div class="list-row">\n            <i class="status status-',i=n["if"].call(e,e&&e.health,{hash:{},inverse:f.program(14,y,t),fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;r+=' icon-label"></i>\n            <span class="app-panel-li-main">'+u((i=e&&e.zone,typeof i===a?i.apply(e):i))+'</span>\n        </div>\n        <ul class="elb-property-instance-list">\n          ',i=n.each.call(e,e&&e.instance,{hash:{},inverse:f.noop,fn:f.program(16,b,t),data:t});if(i||i===0)r+=i;return r+="\n        </ul>\n      </li>\n    ",r}function g(e,t){return"green"}function y(e,t){return"red"}function b(e,t){var r="",i;r+='\n            <li>\n              <div class="instance-info">\n                ',i=n["if"].call(e,e&&e.instance_name,{hash:{},inverse:f.noop,fn:f.program(17,w,t),data:t});if(i||i===0)r+=i;r+='\n                <div class="instance-id ',i=n.unless.call(e,e&&e.instance_name,{hash:{},inverse:f.noop,fn:f.program(19,E,t),data:t});if(i||i===0)r+=i;r+='">('+u((i=e&&e.instance_id,typeof i===a?i.apply(e):i))+')</div>\n              </div>\n              <div class="instance-state">\n                ',i=n["if"].call(e,e&&e.instance_state,{hash:{},inverse:f.program(23,x,t),fn:f.program(21,S,t),data:t});if(i||i===0)r+=i;r+="\n                ",i=n.unless.call(e,e&&e.instance_state,{hash:{},inverse:f.noop,fn:f.program(25,T,t),data:t});if(i||i===0)r+=i;return r+="\n              </div>\n            </li>\n          ",r}function w(e,t){var n="",r;return n+='<div class="instance-name">'+u((r=e&&e.instance_name,typeof r===a?r.apply(e):r))+"</div>",n}function E(e,t){return"instance-id-down"}function S(e,t){return"InService"}function x(e,t){return"OutOfService"}function T(e,t){var n="",r;return n+='<a class="elb-info-icon tooltip icon-info" data-tooltip="'+u((r=e&&e.instance_state_desc,typeof r===a?r.apply(e):r))+'"></a>',n}function N(e,t){var r="";return r+='\n  <div class="option-group-head">'+u(n.i18n.call(e,"PROP.ELB_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span> </div>\n  <div class="option-group sg-group">'+u(n.i18n.call(e,"PROP.LBL_LOADING",{hash:{},data:t}))+"</div>\n  ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.ELB_DETAILS",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n      <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(t,"PROP.ELB_SCHEME",{hash:{},data:i}))+"</dt>\n        <dd>",o=n["if"].call(t,t&&t.isInternet,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="</dd>\n        <dt>"+u(n.i18n.call(t,"PROP.ELB_DNS_NAME",{hash:{},data:i}))+'</dt>\n        <dd>\n          <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP.ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:i}))+'">(A)'+u((o=t&&t.Dnsname,typeof o===a?o.apply(t):o))+'</div>\n          <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP.ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:i}))+'">(AAAA)ipv6.'+u((o=t&&t.Dnsname,typeof o===a?o.apply(t):o))+'</div>\n          <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(t,"PROP.ELB_TIP_CLICK_TO_SELECT_ALL",{hash:{},data:i}))+'">(A/AAAA)dualstack.'+u((o=t&&t.Dnsname,typeof o===a?o.apply(t):o))+"</div>\n        </dd>\n        <dt>"+u(n.i18n.call(t,"PROP.NAME",{hash:{},data:i}))+"</dt>\n        <dd>"+u(n.emptyStr.call(t,t&&t.name,{hash:{},data:i}))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+"</dt>\n        <dd>"+u(n.emptyStr.call(t,t&&t.description,{hash:{},data:i}))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP.ELB_HOST_ZONE_ID",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=t&&t.CanonicalHostedZoneNameID,typeof o===a?o.apply(t):o))+"<dd>\n        <dt>"+u(n.i18n.call(t,"PROP.ELB_CROSS_ZONE",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=t&&t.CrossZone,typeof o===a?o.apply(t):o))+"<dd>\n        <dt>"+u(n.i18n.call(t,"PROP.ELB_CONNECTION_DRAIN",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=t&&t.ConnectionDrainingInfo,typeof o===a?o.apply(t):o))+"<dd>\n        ",o=n["if"].call(t,t&&t.IdleTimeout,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+='\n      </dl>\n  </div>\n\n  <div class="option-group-head">'+u(n.i18n.call(t,"PROP.ELB_LISTENER_DETAIL",{hash:{},data:i}))+'</div>\n  <ul class="option-group mega-list-wraper elb-property-listener-app">\n    ',o=n.each.call(t,t&&t.listenerDisplay,{hash:{},inverse:f.noop,fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+='\n  </ul>\n\n  <div class="option-group-head">'+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_DETAILS",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n      <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(t,"PROP.ELB_PING_PROTOCOL",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.protocol),typeof o===a?o.apply(t):o))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP.ELB_PING_PORT",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.port),typeof o===a?o.apply(t):o))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP.ELB_PING_PATH",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.path),typeof o===a?o.apply(t):o))+"</dd>\n\n        <dt>"+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_INTERVAL",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.Interval),typeof o===a?o.apply(t):o))+" "+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_INTERVAL_SECONDS",{hash:{},data:i}))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_RESPOND_TIMEOUT",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.Timeout),typeof o===a?o.apply(t):o))+" "+u(n.i18n.call(t,"PROP.ELB_HEALTH_CHECK_INTERVAL_SECONDS",{hash:{},data:i}))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP.ELB_UNHEALTH_THRESHOLD",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.UnhealthyThreshold),typeof o===a?o.apply(t):o))+"</dd>\n        <dt>"+u(n.i18n.call(t,"PROP.ELB_HEALTH_THRESHOLD",{hash:{},data:i}))+"</dt>\n        <dd>"+u((o=(o=t&&t.HealthCheck,o==null||o===!1?o:o.HealthyThreshold),typeof o===a?o.apply(t):o))+"</dd>\n      </dl>\n  </div>\n\n  ",o=n["if"].call(t,(o=t&&t.distribution,o==null||o===!1?o:o.length),{hash:{},inverse:f.noop,fn:f.program(10,v,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n.unless.call(t,t&&t.isclassic,{hash:{},inverse:f.noop,fn:f.program(27,N,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/elb/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name}}),new n}),define("wspace/awseditor/property/elb/main",["../base/main","./model","./view","./app_model","./app_view","../sglist/main","constant"],function(e,t,n,r,i,s,o){var u;return u=e.extend({handleTypes:o.RESTYPE.ELB,onUnloadSubPanel:function(e){return s.onUnloadSubPanel(e),null},initStack:function(){return this.model=t,this.view=n,null},afterLoadStack:function(){return s.loadModule(this.model),null},initApp:function(){return this.model=r,this.view=i,null},afterLoadApp:function(){return s.loadModule(this.model),null},initAppEdit:function(){return this.model=t,this.view=n,null},afterLoadAppEdit:function(){return s.loadModule(t),null}}),null}),define("wspace/awseditor/property/az/model",["../base/model","Design","constant","CloudResources"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var i,s,o,u,a,f,l,c,h,p;a=t.instance(),o=r(t.instance().credentialId(),n.RESTYPE.AZ,t.instance().region()).where({category:a.get("region")}),u=a.component(e);if(!u||!o)return!1;l=u.get("name"),c={},i=t.modelClassForType(n.RESTYPE.AZ),_.each(i.allObjects(),function(e){return c[e.get("name")]=!0,null}),f=[];for(h=0,p=o.length;h<p;h++)s=o[h],s=s.attributes,(s.id===l||!c[s.id])&&f.push({name:s.id,selected:s.id===l});return this.set({uid:e,name:l,list:f}),null}}),new i}),define("wspace/awseditor/property/az/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="";return r+="\n  <div>"+u(n.i18n.call(e,"PROP.AZ_CANNOT_EDIT_EXISTING_AZ",{hash:{},data:t}))+"</div>\n  ",r}function c(e,t){var r="",i;r+='\n  <label class="left">'+u(n.i18n.call(e,"PROP.AZ_LBL_SWITCH",{hash:{},data:t}))+'</label>\n  <div class="selectbox selectbox-mega" id="az-quick-select">\n    <div class="selection">'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'</div>\n    <ul class="dropdown" tabindex="-1">\n      ',i=n.each.call(e,e&&e.list,{hash:{},inverse:a.noop,fn:a.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n    </ul>\n  </div>\n  ",r}function h(e,t){var r="",i;r+='<li class="item',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(5,p,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'">'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+"</li>",r}function p(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<section class="property-control-group">\n  ',o=n["if"].call(t,t&&t.appEdit,{hash:{},inverse:a.program(3,c,i),fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</section>",s};return e.template(t)}),define("wspace/awseditor/property/az/view",["../base/view","./template/stack"],function(e,t){var n;return n=e.extend({events:{"OPTION_CHANGE #az-quick-select":"azSelect"},render:function(){var e;return this.isAppEdit?e={appEdit:!0}:e=this.model.attributes,this.$el.html(t(e)),"Availability Zone"},azSelect:function(e,t){this.model.setName(t)}}),new n}),define("wspace/awseditor/property/az/main",["../base/main","./model","./view","constant"],function(e,t,n,r){var i;return i=e.extend({handleTypes:r.RESTYPE.AZ,initStack:function(){this.model=t,this.view=n,this.view.isAppEdit=!1},initApp:function(){return!1},initAppEdit:function(){this.model=t,this.view=n,this.view.isAppEdit=!0}}),null}),define("wspace/awseditor/property/subnet/model",["../base/model","constant","Design","CloudResources"],function(e,t,n,r){var i;return i=e.extend({defaults:{isAppEdit:!1},init:function(e){var i,s,o,u,a,f,l,c,h,p;return h=n.instance().component(e),h?(i=n.modelClassForType(t.RESTYPE.ACL),c=h.connectionTargets("AclAsso")[0],s=null,a=[],_.each(i.allObjects(),function(e){var t;return t={uid:e.id,name:e.get("name"),isUsed:e===c,rule:e.getRuleCount(),association:e.getAssoCount()},e.isDefault()?(s=t,t.isDefault=!0):a.splice(_.sortedIndex(a,t,"name"),0,t),null}),s&&a.splice(0,0,s),this.set({uid:e,name:h.get("name"),networkACL:a,isAppEdit:this.isAppEdit,description:h.get("description"),tags:h.tags()}),this.isAppEdit&&(l=(p=r(n.instance().credentialId(),t.RESTYPE.SUBNET,n.instance().region()).get(h.get("appId")))!=null?p.toJSON():void 0,l=_.clone(l),f=h.connectionTargets("RTB_Asso")[0],u=f.get("appId"),f.get("main")&&(o=f.get("appId")),l.routeTable=u?u:o,this.set(l)),this.getCidr(),null):!1},getCidr:function(){var e,t,r;return t=n.instance().component(this.get("uid")),r=t.get("cidr"),e=this.genCIDRDivAry(t.parent().parent().get("cidr"),r),this.set("CIDRPrefix",e[0]),this.set("CIDR",r?e[1]:""),null},genCIDRDivAry:function(e,t){var n,r,i,s,o,u;return t||(t=e),u=Number(e.split("/")[1]),s=t.split("/"),o=Number(s[1]),i=s[0].split("."),u>23?(n=i[0]+"."+i[1]+"."+i[2]+".",r=i[3]+"/"+o):(n=i[0]+"."+i[1]+".",r=i[2]+"."+i[3]+"/"+o),[n,r]},createAcl:function(){var e,r;return e=n.modelClassForType(t.RESTYPE.ACL),r=new e,this.setACL(r.id),r.id},removeAcl:function(e){return n.instance().component(e).remove(),null},setCidr:function(e){return n.instance().component(this.get("uid")).setCidr(e)},setACL:function(e){return n.instance().component(this.get("uid")).setAcl(e),null},isValidCidr:function(e){return n.instance().component(this.get("uid")).isValidCidr(e)}}),new i}),define("wspace/awseditor/property/subnet/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP.SUBNET_APP_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.subnetId,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP.SUBNET_APP_STATE",{hash:{},data:t}))+'</dt>\n      <dd><i class="status status-'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'"></i>'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP.SUBNET_APP_CIDR",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.cidrBlock,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP.SUBNET_APP_AVAILABLE_IP",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.availableIpAddressCount,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP.SUBNET_APP_VPC_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP.SUBNET_APP_RT_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.routeTable,typeof i===a?i.apply(e):i))+'</dd>\n    </dl>\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-subnet-name">'+u(n.i18n.call(e,"PROP.SUBNET_DETAIL_LBL_NAME",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <input class="input" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" lastValue="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-subnet-name" maxlength="255" data-required-rollback="true" data-ignore="true"/>\n    </section>\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n      <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+"</textarea>\n    </section>\n  </div>\n\n  ",r}function c(e,t){var r="",i;return r+='\n  <div class="option-group">\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-subnet-name">'+u(n.i18n.call(e,"PROP.SUBNET_DETAIL_LBL_NAME",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <input class="input" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" lastValue="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-subnet-name" maxlength="255" data-required-rollback="true" data-ignore="true"/>\n    </section>\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n      <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+'</textarea>\n    </section>\n    <section class="property-control-group">\n      <label class="left" for="property-cidr-block">'+u(n.i18n.call(e,"PROP.SUBNET_DETAIL_LBL_CIDR_BLOCK",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <div class="subnet-cidr-wrapper">\n        <span class="cidr-prefix" id="property-cidr-prefix">'+u((i=e&&e.CIDRPrefix,typeof i===a?i.apply(e):i))+'</span>\n        <input data-ignore="true" data-ignore-regexp="^[0-9./]*$" class="input cidr-rest tooltip" type="text" value="'+u((i=e&&e.CIDR,typeof i===a?i.apply(e):i))+'" lastValue="'+u((i=e&&e.CIDR,typeof i===a?i.apply(e):i))+'" id="property-cidr-block" data-empty-remove="true" data-tooltip="'+u(n.i18n.call(e,"PROP.SUBNET_TIP_CIDR_BLOCK",{hash:{},data:t}))+'"/>\n      </div>\n    </section>\n  </div>\n  ',r}function h(e,t){var r="",i;r+='\n    <table class="table cost-estimation-table">\n      <tbody>\n      ',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;return r+="\n      </tbody>\n    </table>\n    ",r}function p(e,t){var n="",r;return n+='\n      <tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n      ",n}function d(e,t){var r="";return r+='\n    <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article data-bind="true">\n  <div class="option-group-head expand" id="subnet-property-detail">'+u(n.i18n.call(t,"PROP.SUBNET_TIT_DETAIL",{hash:{},data:i}))+"</div>\n  ",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.SUBNET_TIT_ASSOC_ACL",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n    <ul id="networkacl-list" class="acl-sg-info-list acl-info-list mega-list-wraper"></ul>\n    <a href="#" class="add-to-list" id="networkacl-create">'+u(n.i18n.call(t,"PROP.SUBNET_BTN_CREATE_NEW_ACL",{hash:{},data:i}))+'</a>\n  </div>\n  <div class="option-group-head expand">\n    '+u(n.i18n.call(t,"PROP.RESOURCE_TAGS",{hash:{},data:i}))+'\n  </div>\n  <div class="option-group">\n    ',o=n["if"].call(t,(o=t&&t.tags,o==null||o===!1?o:o.length),{hash:{},inverse:f.program(8,d,i),fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;return s+='\n    <div class="tags-action">\n      \n      <button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(t,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:i}))+"</button>\n    </div>\n  </div>\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/subnet/template/acl",["handlebars"],function(e){var t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<li data-uid="'+u((i=e&&e.uid,typeof i===o?i.apply(e):i))+'">\n  <div class="col1"> <div class="radio">\n    <input id="ppty-acl-'+u((i=t==null||t===!1?t:t.index,typeof i===o?i.apply(e):i))+'" class="ppty-acl-cb" type="radio" ',i=n["if"].call(e,e&&e.isUsed,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+='/>\n    <label for="ppty-acl-'+u((i=t==null||t===!1?t:t.index,typeof i===o?i.apply(e):i))+'"></label>\n  </div> </div>\n  <div class="col2">\n    <div class="col2-1 truncate">'+u((i=e&&e.name,typeof i===o?i.apply(e):i))+'</div>\n    <div class="col2-2 truncate">'+u((i=e&&e.rule,typeof i===o?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP.SUBNET_ACL_LBL_RULE",{hash:{},data:t}))+", "+u((i=e&&e.association,typeof i===o?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP.SUBNET_ACL_LBL_ASSOC",{hash:{},data:t})),i=n.unless.call(e,e&&e.isDefault,{hash:{},inverse:a.noop,fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;return r+='</div>\n  </div>\n  <div class="col3 tooltip icon-btn-details" data-tooltip=\''+u(n.i18n.call(e,"PROP.SUBNET_ACL_TIP_DETAIL",{hash:{},data:t}))+"'></div>\n</li>\n",r}function l(e,t){return'checked="checked"'}function c(e,t){var r="",i;return r+=' | <a class="sg-list-delete-btn" data-name="'+u((i=e&&e.name,typeof i===o?i.apply(e):i))+'" data-count="'+u((i=e&&e.association,typeof i===o?i.apply(e):i))+'">'+u(n.i18n.call(e,"PROP.SUBNET_ACL_BTN_DELETE",{hash:{},data:t}))+"</a>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t&&t.networkACL,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""};return e.template(t)}),define("wspace/awseditor/property/subnet/view",["../base/view","./template/stack","./template/acl","event","Design","i18n!/nls/lang.js","UI.modalplus"],function(e,t,n,r,i,s,o){var u;return u=e.extend({events:{"change #property-subnet-name":"onChangeName","change #property-res-desc":"onChangeDesc","focus #property-cidr-block":"onFocusCIDR","keypress #property-cidr-block":"onPressCIDR","blur #property-cidr-block":"onBlurCIDR","click #networkacl-create":"createAcl","click .icon-btn-details":"openAcl","click .ppty-acl-cb":"changeAcl","click .sg-list-delete-btn":"deleteAcl"},render:function(){return this.$el.html(t(this.model.attributes)),this.refreshACLList(),this.validateCidr(!0),this.model.attributes.name},onChangeName:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(MC.aws.aws.checkResName(this.model.get("uid"),n,"Subnet"))return this.model.setName(t),this.setTitle(t)},onChangeDesc:function(e){return this.model.setDesc($(e.currentTarget).val())},onPressCIDR:function(e){return e.keyCode===13&&$("#property-cidr-block").blur(),null},onFocusCIDR:function(e){return this.disabledAllOperabilityArea(!0),null},validateCidr:function(e){var t,n,r,u,a,f,l,c,h,p,d;n=$("#property-cidr-prefix").html(),r=$("#property-cidr-block").val(),h=n+r,c=s.PROP.REMOVE_SUBNET,r?MC.validate("cidr",h)?(a=this.model.isValidCidr(h),a!==!0&&(f=a.error,u=a.detail,a.shouldRemove===!1&&(c=""))):(f=sprintf(s.PROP.SUBNET_CIDR_VALIDATION_INVALID,h),u=sprintf(s.PROP.SUBNET_CIDR_VALIDATION_INVALID_DESC)):(f=s.PROP.SUBNET_CIDR_VALIDATION_REQUIRED,u=s.PROP.SUBNET_CIDR_VALIDATION_REQUIRED_DESC);if(!f)return h;if(e)return this.focusCidrFirsttime(),!1;if((d=this.modal)!=null?!d.isOpen():!void 0)p=this,t=MC.template.setupCIDRConfirm({main_content:f,desc_content:u,remove_content:c}),this.modal=new o({title:s.IDE.SET_UP_CIDR_BLOCK,width:420,template:t,confirm:{text:"OK",color:"blue"},disableClose:!0,cancel:{hide:!0}}),l=this.modal,$('<a id="cidr-removed" class="link-red left link-modal-danger">'+c+"</a>").appendTo(l.find(".modal-footer")),l.on("close",function(){return p.$("#property-cidr-block").focus()}),l.on("closed",function(){return p.$("#property-cidr-block").focus()}),l.on("confirm",function(){return l.close()}),l.find("#cidr-removed").on("click",function(){return i.instance().component(p.model.get("uid")).remove(),p.disabledAllOperabilityArea(!1),l.close()});return!1},focusCidrFirsttime:function(){return _.defer(function(){var e,t;return e=this.$("#property-cidr-block"),e.focus(),t=e.val().length,e[0].setSelectionRange(t,t)})},onBlurCIDR:function(e){var t;t=this.validateCidr();if(!t)return;return this.model.setCidr(t),this.disabledAllOperabilityArea(!1)},createAcl:function(){return this.trigger("OPEN_ACL",this.model.createAcl())},openAcl:function(e){var t;return t=$(e.currentTarget).closest("li").attr("data-uid"),this.trigger("OPEN_ACL",t),null},deleteAcl:function(e){var t,n,r,i,u,a,f;return t=$(e.currentTarget),i=parseInt(t.attr("data-count"),10),r=t.closest("li").attr("data-uid"),i?(f=this,n=t.attr("data-name"),u=MC.template.modalDeleteSGOrACL({title:s.IDE.TITLE_DELETE_NETWORK_ACL,main_content:sprintf(s.PROP.STACK_DELETE_NETWORK_ACL_CONTENT,n),desc_content:sprintf(s.PROP.STACK_DELETE_NETWORK_ACL_DESC,n)}),a=new o({title:s.PROP.TITLE_DELETE_NETWORK_ACL,width:420,template:u,confirm:{text:s.PROP.LBL_DELETE,color:"red"}}),a.on("confirm",function(){return f.model.removeAcl(r),f.refreshACLList(),a.close()}),a.on("close",function(){return $("#property-cidr-block").focus()}),a.on("closed",function(){return $("#property-cidr-block").focus()})):(this.model.removeAcl(r),this.refreshACLList())},changeAcl:function(e){return this.model.setACL($(e.currentTarget).closest("li").attr("data-uid")),this.refreshACLList()},refreshACLList:function(){return this.model.init(this.model.get("uid")),$("#networkacl-list").html(n(this.model.attributes))}}),new u}),define("wspace/awseditor/property/subnet/app_model",["../base/model","constant","Design","CloudResources"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var i,s,o,u,a,f;return o=n.instance().component(e),a=(f=r(n.instance().credentialId(),t.RESTYPE.SUBNET,n.instance().region()).get(o.get("appId")))!=null?f.toJSON():void 0,a?(a=_.clone(a),a.name=o.get("name"),a.description=o.get("description"),a.acl=this.getACL(e),a.uid=e,u=o.connectionTargets("RTB_Asso")[0],s=u.get("appId"),u.get("main")&&(i=u.get("appId")),a.routeTable=s?s:i,this.set(a),null):!1},getACL:function(e){var t;return t=n.instance().component(e).connectionTargets("AclAsso")[0],t?{id:t.id,name:t.get("name"),rule:t.getRuleCount(),association:t.getAssoCount()}:null}}),new i}),define("wspace/awseditor/property/subnet/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n    <div class="option-group-head expand">\n        '+a(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n    </div>\n    <div class="option-group">\n        ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.program(5,p,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+='\n        <div class="tags-action">\n            \n        </div>\n    </div>\n    ',r}function c(e,t){var r="",i;r+='\n        <table class="table cost-estimation-table">\n            <tbody>\n            ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(3,h,t),data:t});if(i||i===0)r+=i;return r+="\n            </tbody>\n        </table>\n        ",r}function h(e,t){var n="",r;return n+='\n            <tr> <td style="min-width:70px;">'+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</td><td>"+a(typeof e===u?e.apply(e):e)+"</td> </tr>\n            ",n}function p(e,t){var r="";return r+='\n        <div class="empty-tag">'+a(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n        ",r}function d(e,t){var r="",i;return r+='\n    <div class="option-group-head expand">'+a(n.i18n.call(e,"PROP.SUBNET_TIT_ASSOC_ACL",{hash:{},data:t}))+'</div>\n    <div class="option-group">\n        <ul class="acl-sg-info-list mega-list-wraper acl-info-list">\n            <li>\n                <div class="col2">\n                    <div class="col2-1 truncate">'+a((i=(i=e&&e.acl,i==null||i===!1?i:i.name),typeof i===u?i.apply(e):i))+'</div>\n                    <div class="col2-2 truncate">'+a((i=(i=e&&e.acl,i==null||i===!1?i:i.rule),typeof i===u?i.apply(e):i))+" "+a(n.i18n.call(e,"PROP.SUBNET_ACL_LBL_RULE",{hash:{},data:t}))+", "+a((i=(i=e&&e.acl,i==null||i===!1?i:i.association),typeof i===u?i.apply(e):i))+"\n                        "+a(n.i18n.call(e,"PROP.SUBNET_ACL_LBL_ASSOC",{hash:{},data:t}))+'\n                    </div>\n                </div>\n                <div class="col3 tooltip icon-btn-details" data-uid="'+a((i=(i=e&&e.acl,i==null||i===!1?i:i.id),typeof i===u?i.apply(e):i))+"\"\n                     data-tooltip='"+a(n.i18n.call(e,"PROP.SUBNET_ACL_TIP_DETAIL",{hash:{},data:t}))+"'></div>\n            </li>\n        </ul>\n    </div>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article class="property-app">\n\n    <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP.SUBNET_TIT_DETAIL",{hash:{},data:i}))+'</div>\n    <div class="option-group">\n        <dl class="dl-vertical">\n            <dt>'+a(n.i18n.call(t,"PROP.SUBNET_APP_ID",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.subnetId,typeof o===u?o.apply(t):o))+"</dd>\n\n            <dt>"+a(n.i18n.call(t,"PROP.NAME",{hash:{},data:i}))+"</dt>\n            <dd>"+a(n.emptyStr.call(t,t&&t.name,{hash:{},data:i}))+"</dd>\n\n            <dt>"+a(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+"</dt>\n            <dd>"+a(n.emptyStr.call(t,t&&t.description,{hash:{},data:i}))+"</dd>\n\n            <dt>"+a(n.i18n.call(t,"PROP.SUBNET_APP_STATE",{hash:{},data:i}))+'</dt>\n            <dd><i class="status status-'+a((o=t&&t.state,typeof o===u?o.apply(t):o))+'"></i>'+a((o=t&&t.state,typeof o===u?o.apply(t):o))+"</dd>\n\n            <dt>"+a(n.i18n.call(t,"PROP.SUBNET_APP_CIDR",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.cidrBlock,typeof o===u?o.apply(t):o))+"</dd>\n\n            <dt>"+a(n.i18n.call(t,"PROP.SUBNET_APP_AVAILABLE_IP",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.availableIpAddressCount,typeof o===u?o.apply(t):o))+"</dd>\n\n            <dt>"+a(n.i18n.call(t,"PROP.SUBNET_APP_VPC_ID",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.vpcId,typeof o===u?o.apply(t):o))+"</dd>\n\n            <dt>"+a(n.i18n.call(t,"PROP.SUBNET_APP_RT_ID",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.routeTable,typeof o===u?o.apply(t):o))+"</dd>\n        </dl>\n    </div>\n    ",o=n["if"].call(t,t&&t.tagSet,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n    ",o=n["if"].call(t,t&&t.acl,{hash:{},inverse:f.noop,fn:f.program(7,d,i),data:i});if(o||o===0)s+=o;return s+="\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/subnet/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({events:{"click .acl-sg-info-list .icon-btn-details":"showACLDetail"},render:function(){return this.$el.html(t(this.model.toJSON())),this.setTitle(this.model.get("name")),null},showACLDetail:function(e){return this.trigger("OPEN_ACL",$(e.currentTarget).data("uid")),null}}),new n}),define("wspace/awseditor/property/subnet/main",["../base/main","./model","./view","./app_model","./app_view","constant"],function(e,t,n,r,i,s){var o;return i.on("OPEN_ACL",function(t){return e.loadSubPanel("ACL",t)}),n.on("OPEN_ACL",function(t){return e.loadSubPanel("ACL",t),null}),o=e.extend({handleTypes:s.RESTYPE.SUBNET,onUnloadSubPanel:function(e){if(e==="ACL"&&this.view.refreshACLList)return this.view.refreshACLList()},initStack:function(){return this.view=n,this.model=t,this.model.isAppEdit=!1,null},initApp:function(){return this.view=i,this.model=r,null},initAppEdit:function(){return this.view=n,this.model=t,this.model.isAppEdit=!0,null}}),null}),define("wspace/awseditor/property/vpc/model",["../base/model","Design","constant","CloudResources"],function(e,t,n,r){var i;return i=e.extend({defaults:{isAppEdit:!1},init:function(e){var i,s,o,u,a,f,l,c,h,p,d;return a=t.instance().component(e),c=a.get("dhcp"),l=$.extend({},c.attributes),l.none=c.isAuto(),l["default"]=c.isDefault(),l.hasDhcp=!l.none&&!l["default"],f={uid:e,dnsSupport:a.get("dnsSupport"),dnsHosts:a.get("dnsHostnames"),defaultTenancy:a.isDefaultTenancy(),name:a.get("name"),cidr:a.get("cidr"),dhcp:l,isAppEdit:this.isAppEdit,description:a.get("description"),tags:a.tags()},this.isAppEdit&&(h=t.instance().component(e),p=(d=r(t.instance().credentialId(),n.RESTYPE.VPC,t.instance().region()).get(h.get("appId")))!=null?d.toJSON():void 0,p=_.clone(p),u=n.RESTYPE.RT,o=n.RESTYPE.ACL,s=t.modelClassForType(u),i=t.modelClassForType(o),p.mainRTB=s.getMainRouteTable(),p.mainRTB&&(p.mainRTB=p.mainRTB.get("appId"),p.defaultACL=i.getDefaultAcl()),p.defaultACL&&(p.defaultACL=p.defaultACL.get("appId")),this.set(p)),this.set(f),null},setCidr:function(e){return t.instance().component(this.get("uid")).setCidr(e)?(this.attributes.cidr=e,!0):!1},setTenancy:function(e){return t.instance().component(this.get("uid")).setTenancy(e),null},setDnsSupport:function(e){var n;return n=this.get("uid"),t.instance().component(n).set("dnsSupport",e),null},setDnsHosts:function(e){var n;return n=this.get("uid"),t.instance().component(n).set("dnsHostnames",e),null},setAmazonDns:function(e){var n;return n=this.get("uid"),t.instance().component(n).get("dhcp").set("amazonDNS",e),null},removeDhcp:function(e){var n,r;return r=this.get("uid"),n=t.instance().component(r).get("dhcp"),e?n.setDefault():n.setAuto(),null},setDhcp:function(e){var n,r;return r=this.get("uid"),n=t.instance().component(r).get("dhcp"),n.setDhcp(e),null},setDHCPOptions:function(e,n){var r,i;return i=this.get("uid"),r=t.instance().component(i).get("dhcp"),r.set(e,n),null}}),new i}),define("wspace/awseditor/property/vpc/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP.VPC_APP_VPC_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.VPC_APP_STATE",{hash:{},data:t}))+'</dt>\n      <dd><i class="status status-'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'"></i>'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.VPC_APP_CIDR",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.cidrBlock,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.VPC_DETAIL_LBL_TENANCY",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.instanceTenancy,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.VPC_APP_MAIN_RT",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.mainRTB,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.VPC_APP_DEFAULT_ACL",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.defaultACL,typeof i===a?i.apply(e):i))+'</dd>\n    </dl>\n    <section class="property-control-group clearfix">\n      <label class="left" for="property-vpc-name">'+u(n.i18n.call(e,"PROP.VPC_DETAIL_LBL_NAME",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <input class="input vpc-name" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-vpc-name" maxlength="255" data-ignore="true" data-required-rollback="true"/>\n    </section>\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n      <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+'</textarea>\n    </section>\n    <section class="property-control-group">\n      <div class="checkbox">\n        <input id="property-dns-resolution" type="checkbox"',i=n["if"].call(e,e&&e.dnsSupport,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+=' name="dns-resolution">\n        <label for="property-dns-resolution"></label>\n      </div>\n      <label for="property-dns-resolution">'+u(n.i18n.call(e,"PROP.VPC_DETAIL_LBL_ENABLE_DNS_RESOLUTION",{hash:{},data:t}))+'</label>\n    </section>\n\n    <section class="property-control-group">\n      <div class="checkbox">\n        <input id="property-dns-hostname" type="checkbox"',i=n["if"].call(e,e&&e.dnsHosts,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+=' name="dns-hostname">\n        <label for="property-dns-hostname"></label>\n      </div>\n      <label for="property-dns-hostname">'+u(n.i18n.call(e,"PROP.VPC_DETAIL_LBL_ENABLE_DNS_HOSTNAME_SUPPORT",{hash:{},data:t}))+'</label>\n    </section>\n\n    <section class="property-control-group">\n      <label class="left">'+u(n.i18n.call(e,"PROP.VPC_TIT_DHCP_OPTION",{hash:{},data:t}))+'</label>\n      <div id="dhcp-dropdown"></div>\n    </section>\n  </div>\n\n\n  ',r}function c(e,t){return' checked="checked"'}function h(e,t){var r="",i;r+='\n  <div class="option-group" data-bind="true">\n    <section class="property-control-group clearfix">\n      <label class="left" for="property-vpc-name">'+u(n.i18n.call(e,"PROP.VPC_DETAIL_LBL_NAME",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <input class="input vpc-name" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-vpc-name" maxlength="255" data-ignore="true" data-required-rollback="true"/>\n    </section>\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n      <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+'</textarea>\n    </section>\n    <section class="property-control-group clearfix">\n      <label class="left" for="property-cidr-block">'+u(n.i18n.call(e,"PROP.VPC_DETAIL_LBL_CIDR_BLOCK",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <input class="input cidr-block tooltip" type="text" value="'+u((i=e&&e.cidr,typeof i===a?i.apply(e):i))+'" id="property-cidr-block" data-tooltip="'+u(n.i18n.call(e,"PROP.VPC_TIP_EG_10_0_0_0_16",{hash:{},data:t}))+'" maxlength="255" data-ignore="true" data-required-rollback="true" data-trigger="change" data-type="awsCidr"/>\n    </section>\n\n    <section class="property-control-group">\n      <label class="left">'+u(n.i18n.call(e,"PROP.VPC_DETAIL_LBL_TENANCY",{hash:{},data:t}))+'</label>\n      <div class="selectbox selectbox-mega" id="property-tenancy">\n        <div class="selection">',i=n["if"].call(e,e&&e.defaultTenancy,{hash:{},inverse:f.program(7,d,t),fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;r+='</div>\n        <ul class="dropdown" tabindex="-1">\n          <li class="item',i=n["if"].call(e,e&&e.defaultTenancy,{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+='" data-id="default">'+u(n.i18n.call(e,"PROP.VPC_DETAIL_TENANCY_LBL_DEFAULT",{hash:{},data:t}))+'</li>\n          <li class="item',i=n.unless.call(e,e&&e.defaultTenancy,{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+='" data-id="dedicated">'+u(n.i18n.call(e,"PROP.VPC_DETAIL_TENANCY_LBL_DEDICATED",{hash:{},data:t}))+'</li>\n        </ul>\n      </div>\n      <div id="desc-dedicated" class="property-info">'+u(n.i18n.call(e,"PROP.VPC_SELECTING_DEDICATED_DESC",{hash:{},data:t}))+'<a target="_blank" href="http://aws.amazon.com/dedicated-instances/">'+u(n.i18n.call(e,"PROP.VPC_SELECTING_DEDICATED_LINK_TEXT",{hash:{},data:t}))+'</a></div>\n    </section>\n\n    <section class="property-control-group">\n      <div class="checkbox">\n        <input id="property-dns-resolution" type="checkbox"',i=n["if"].call(e,e&&e.dnsSupport,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+=' name="dns-resolution">\n        <label for="property-dns-resolution"></label>\n      </div>\n      <label for="property-dns-resolution">'+u(n.i18n.call(e,"PROP.VPC_DETAIL_LBL_ENABLE_DNS_RESOLUTION",{hash:{},data:t}))+'</label>\n    </section>\n\n\n    <section class="property-control-group">\n      <div class="checkbox">\n        <input id="property-dns-hostname" type="checkbox"',i=n["if"].call(e,e&&e.dnsHosts,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+=' name="dns-hostname">\n        <label for="property-dns-hostname"></label>\n      </div>\n      <label for="property-dns-hostname">'+u(n.i18n.call(e,"PROP.VPC_DETAIL_LBL_ENABLE_DNS_HOSTNAME_SUPPORT",{hash:{},data:t}))+'</label>\n    </section>\n\n    <section class="property-control-group">\n        <label class="left">'+u(n.i18n.call(e,"PROP.VPC_TIT_DHCP_OPTION",{hash:{},data:t}))+'</label>\n        <div id="dhcp-dropdown"></div>\n    </section>\n  </div>\n\n  ',r}function p(e,t){var r;return r=n.i18n.call(e,"PROP.VPC_DETAIL_TENANCY_LBL_DEFAULT",{hash:{},data:t}),r||r===0?r:""}function d(e,t){return"Dedicated"}function v(e,t){return" selected"}function m(e,t){var r="",i;r+='\n    <table class="table cost-estimation-table">\n      <tbody>\n      ',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;return r+="\n      </tbody>\n    </table>\n    ",r}function g(e,t){var n="",r;return n+='\n      <tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n      ",n}function y(e,t){var r="";return r+='\n    <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article>\n  <div class="option-group-head expand" id="vpc-property-detail">'+u(n.i18n.call(t,"PROP.VPC_TIT_DETAIL",{hash:{},data:i}))+"</div>\n\n  ",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.program(4,h,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n  <div class="option-group-head expand">\n    '+u(n.i18n.call(t,"PROP.RESOURCE_TAGS",{hash:{},data:i}))+'\n  </div>\n  <div class="option-group">\n    ',o=n["if"].call(t,(o=t&&t.tags,o==null||o===!1?o:o.length),{hash:{},inverse:f.program(14,y,i),fn:f.program(11,m,i),data:i});if(o||o===0)s+=o;return s+='\n    <div class="tags-action">\n      \n      <button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(t,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:i}))+"</button>\n    </div>\n  </div>\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/vpc/view",["../base/view","./template/stack","i18n!/nls/lang.js","dhcp","UI.modalplus"],function(e,t,n,r,i){var s,o;return o=function(e){var t,n,r,i,s;t=$(e),r=[];for(i=0,s=t.length;i<s;i++)n=t[i],n.value&&r.push(n.value);return r},s=e.extend({events:{"change #property-vpc-name":"onChangeName","change #property-res-desc":"onChangeDesc","change #property-cidr-block":"onChangeCidr","change #property-dns-resolution":"onChangeDnsSupport","change #property-dns-hostname":"onChangeDnsHostname","OPTION_CHANGE #property-tenancy":"onChangeTenancy","change .property-control-group-sub .input":"onChangeDhcpOptions","OPTION_CHANGE #property-netbios-type":"onChangeDhcpOptions","REMOVE_ROW #property-dhcp-options":"onChangeDhcpOptions","ADD_ROW .multi-input":"processParsley"},render:function(){var e;return e=this.model.toJSON(),this.$el.html(t(e)),multiinputbox.update($("#property-domain-server")),this.dhcp=new r({resModel:this.model}),this.dhcp.off("change"),this.dhcp.on("change",function(e){return function(t){return e.changeDhcp(t)}}(this)),this.dhcp.on("manage",function(e){return function(){return void 0}}(this)),this.$el.find("#dhcp-dropdown").html(this.dhcp.dropdown.el),this.initDhcpSelection(),e.name},initDhcpSelection:function(){var e,t;return e=this.model.attributes.dhcp.appId,e===""?t={isAuto:!0}:e==="default"?t={isDefault:!0}:t={id:e},this.dhcp.setSelection(t)},changeDhcp:function(e){return e.id==="default"?this.model.removeDhcp(!0):e.id===""?this.model.removeDhcp(!1):this.model.setDhcp(e.id)},onChangeName:function(e){var t,n;return n=$(e.currentTarget),t=n.val(),MC.aws.aws.checkResName(this.model.get("uid"),n,"VPC")&&(this.model.setName(t),this.setTitle(t)),null},onChangeDesc:function(e){return this.model.setDesc($(e.currentTarget).val())},onChangeCidr:function(e){var t,r;return r=$(e.currentTarget),t=r.val(),r.parsley("validate")&&(this.model.setCidr(t)||(r.val(this.model.get("cidr")),notification(n.NOTIFY.WARN_CANNT_AUTO_ASSIGN_CIDR_FOR_SUBNET))),null},onChangeTenancy:function(e,t){return this.model.setTenancy(t),null},onChangeDnsSupport:function(e){return this.model.setDnsSupport(e.target.checked),null},onChangeDnsHostname:function(e){return this.model.setDnsHosts(e.target.checked),null},onChangeAmazonDns:function(e){var t,n,r,i;return i=$("#property-amazon-dns").is(":checked"),r=i?3:4,t=$("#property-domain-server").attr("data-max-row",r),n=t.children(),t.toggleClass("max",n.length>=r),this.model.setAmazonDns(i),null},onUseDHCP:function(e){return $("#property-dhcp-desc").hide(),$("#property-dhcp-options").show(),this.model.useDhcp(),null},onChangeDhcpOptions:function(e){var t;if(e&&!$(e.currentTarget).closest("[data-bind=true]").parsley("validate"))return;return t={domainName:$("#property-dhcp-domain").val(),domainServers:o("#property-domain-server .input"),ntpServers:o("#property-ntp-server .input"),netbiosServers:o("#property-netbios-server .input"),netbiosType:parseInt($("#property-netbios-type .selection").html(),10)||0},this.model.setDHCPOptions(t),null}}),new s}),define("wspace/awseditor/property/vpc/app_model",["../base/model","Design","constant","CloudResources"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;h=t.instance().component(e),p=(d=r(t.instance().credentialId(),n.RESTYPE.VPC,t.instance().region()).get(h.get("appId")))!=null?d.attributes:void 0,a=r(t.instance().credentialId(),n.RESTYPE.DHCP,t.instance().region());if(!p)return!1;p=$.extend(!0,{},p),p.name=h.get("name"),p.description=h.get("description"),u=n.RESTYPE.RT,o=n.RESTYPE.ACL,s=t.modelClassForType(u),i=t.modelClassForType(o),p.mainRTB=s.getMainRouteTable(),p.mainRTB&&(p.mainRTB=p.mainRTB.get("appId")),p.defaultACL=i.getDefaultAcl(),p.defaultACL&&(p.defaultACL=p.defaultACL.get("appId"));if(p.dhcpOptionsId)if(!a.get(p.dhcpOptionsId))p.default_dhcp=!0;else{l=(v=a.get(h!=null?(m=h.toJSON().dhcp)!=null?m.toJSON().appId:void 0:void 0))!=null?v.attributes:void 0,p.dhcpOptionsId=h!=null?(g=h.toJSON().dhcp)!=null?(y=g.toJSON())!=null?y.appId:void 0:void 0:void 0,f=null;if(l){f={};for(c in l)f[MC.camelCase(c)]=l[c]}p.dhcp=f}return this.set(p),null}}),new i}),define("wspace/awseditor/property/vpc/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n  <div class="property-control-group">\n    <p>'+u(n.i18n.call(e,"PROP.VPC_DHCP_LBL_DEFAULT",{hash:{},data:t}))+"</p>\n  ",r}function c(e,t){var r="",i;r+="\n  ",i=n["if"].call(e,e&&e.defaultDhcp,{hash:{},inverse:a.noop,fn:a.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n  ",r}function h(e,t){var r="";return r+='\n    <dl class="dl-vertical">\n        <dd>'+u(n.i18n.call(e,"PROP.VPC_DHCP_LBL_NONE",{hash:{},data:t}))+"</dd>\n    </dl>\n  </div>\n  ",r}function p(e,t){var r="",i;r+='\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(e,"PROP.VPC_DHCP_OPTION_SET_ID",{hash:{},data:t}))+"</dt>\n    <dd>",i=n["if"].call(e,e&&e.dhcpOptionsId,{hash:{},inverse:a.program(9,v,t),fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;r+="</dd>\n\n    ",i=n["if"].call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.domainName),{hash:{},inverse:a.noop,fn:a.program(11,m,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n["if"].call(e,(i=(i=e&&e.dhcp,i==null||i===!1?i:i.domainNameServers),i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(14,y,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n["if"].call(e,(i=(i=e&&e.dhcp,i==null||i===!1?i:i.ntpServers),i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(16,b,t),data:t});if(i||i===0)r+=i;r+="\n\n\n    ",i=n["if"].call(e,(i=(i=e&&e.dhcp,i==null||i===!1?i:i.netbiosNameServers),i==null||i===!1?i:i.length),{hash:{},inverse:a.noop,fn:a.program(18,w,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n["if"].call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.netbiosNodeType),{hash:{},inverse:a.noop,fn:a.program(20,E,t),data:t});if(i||i===0)r+=i;return r+="\n\n  </dl>\n  ",r}function d(e,t){var n;return u((n=e&&e.dhcpOptionsId,typeof n===f?n.apply(e):n))}function v(e,t){var n;return u((n=(n=e&&e.dhcp,n==null||n===!1?n:n.dhcpOptionsId),typeof n===f?n.apply(e):n))}function m(e,t){var r="",i;r+="\n    <dt>"+u(n.i18n.call(e,"PROP.VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME",{hash:{},data:t}))+"</dt>\n    <dd>",i=n.each.call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.domainName),{hash:{},inverse:a.noop,fn:a.program(12,g,t),data:t});if(i||i===0)r+=i;return r+="</dd>\n    ",r}function g(e,t){var n="";return n+="<p>"+u(typeof e===f?e.apply(e):e)+"</p>",n}function y(e,t){var r="",i;r+="\n    <dt>"+u(n.i18n.call(e,"PROP.VPC_DHCP_SPECIFIED_LBL_DOMAIN_NAME_SERVER",{hash:{},data:t}))+"</dt>\n    <dd>",i=n.each.call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.domainNameServers),{hash:{},inverse:a.noop,fn:a.program(12,g,t),data:t});if(i||i===0)r+=i;return r+="\n    </dd>\n    ",r}function b(e,t){var r="",i;r+="\n    <dt>"+u(n.i18n.call(e,"PROP.VPC_DHCP_SPECIFIED_LBL_NTP_SERVER",{hash:{},data:t}))+"</dt>\n    <dd>",i=n.each.call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.ntpServers),{hash:{},inverse:a.noop,fn:a.program(12,g,t),data:t});if(i||i===0)r+=i;return r+="\n    </dd>\n    ",r}function w(e,t){var r="",i;r+="\n    <dt>"+u(n.i18n.call(e,"PROP.VPC_DHCP_SPECIFIED_LBL_NETBIOS_NAME_SERVER",{hash:{},data:t}))+"</dt>\n    <dd>",i=n.each.call(e,(i=e&&e.dhcp,i==null||i===!1?i:i.netbiosNameServers),{hash:{},inverse:a.noop,fn:a.program(12,g,t),data:t});if(i||i===0)r+=i;return r+="\n    </dd>\n    ",r}function E(e,t){var r="",i;return r+="\n    <dt>"+u(n.i18n.call(e,"PROP.VPC_DHCP_SPECIFIED_LBL_NETBIOS_NODE_TYPE",{hash:{},data:t}))+"</dt>\n    <dd>"+u((i=(i=(i=e&&e.dhcp,i==null||i===!1?i:i.netbiosNodeType),i==null||i===!1?i:i[0]),typeof i===f?i.apply(e):i))+"</dd>\n    ",r}function S(e,t){var r="",i;r+='\n  <div class="option-group-head expand">\n      '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n  </div>\n  <div class="option-group">\n      ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:a.program(26,N,t),fn:a.program(23,x,t),data:t});if(i||i===0)r+=i;return r+='\n      <div class="tags-action">\n        \n      </div>\n  </div>\n  ',r}function x(e,t){var r="",i;r+='\n      <table class="table cost-estimation-table">\n        <tbody>\n        ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:a.noop,fn:a.program(24,T,t),data:t});if(i||i===0)r+=i;return r+="\n        </tbody>\n      </table>\n      ",r}function T(e,t){var n="",r;return n+='\n        <tr> <td style="min-width:70px;">'+u((r=t==null||t===!1?t:t.key,typeof r===f?r.apply(e):r))+"</td><td>"+u(typeof e===f?e.apply(e):e)+"</td> </tr>\n        ",n}function N(e,t){var r="";return r+='\n      <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n      ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<article class="property-app">\n\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.VPC_TIT_DETAIL",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(t,"PROP.VPC_APP_VPC_ID",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.id,typeof o===f?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP.NAME",{hash:{},data:i}))+"</dt>\n      <dd>"+u(n.emptyStr.call(t,t&&t.name,{hash:{},data:i}))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+"</dt>\n      <dd>"+u(n.emptyStr.call(t,t&&t.description,{hash:{},data:i}))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP.VPC_APP_STATE",{hash:{},data:i}))+'</dt>\n      <dd><i class="status status-'+u((o=t&&t.state,typeof o===f?o.apply(t):o))+'"></i>'+u((o=t&&t.state,typeof o===f?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP.VPC_APP_CIDR",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.cidrBlock,typeof o===f?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP.VPC_DETAIL_LBL_TENANCY",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.instanceTenancy,typeof o===f?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP.VPC_APP_MAIN_RT",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.mainRTB,typeof o===f?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP.VPC_APP_DEFAULT_ACL",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.defaultACL,typeof o===f?o.apply(t):o))+'</dd>\n    </dl>\n  </div>\n\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.VPC_TIT_DHCP_OPTION",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n\n  ',o=n["if"].call(t,t&&t.autoDhcp,{hash:{},inverse:a.program(3,c,i),fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n.unless.call(t,t&&t.defaultDhcp,{hash:{},inverse:a.noop,fn:a.program(6,p,i),data:i});if(o||o===0)s+=o;s+="\n  </div>\n\n  ",o=n["if"].call(t,t&&t.tagSet,{hash:{},inverse:a.noop,fn:a.program(22,S,i),data:i});if(o||o===0)s+=o;return s+="\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/vpc/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({render:function(){var e;return e=this.model.attributes,e.dhcpOptionsId==="default"?(e.defaultDhcp=!0,e.autoDhcp=!1):!e.dhcpOptionsId||!e.dhcp?(e.autoDhcp=!0,e.defaultDhcp=!1):e.dhcpOptionsId[0]!=="@"&&(e.autoDhcp=!1,e.defaultDhcp=!1),this.$el.html(t(e)),this.model.attributes.name}}),new n}),define("wspace/awseditor/property/vpc/main",["../base/main","./model","./view","./app_model","./app_view","constant"],function(e,t,n,r,i,s){var o;return o=e.extend({handleTypes:s.RESTYPE.VPC,initStack:function(){return this.model=t,this.model.isAppEdit=!1,this.view=n,null},initApp:function(){return this.model=r,this.view=i,null},initAppEdit:function(){return this.model=t,this.model.isAppEdit=!0,this.view=n,null}}),null}),define("wspace/awseditor/property/rtb/model",["../base/model","Design","constant","CloudResources","i18n!/nls/lang.js"],function(e,t,n,r,i){var s;return s=e.extend({defaults:{isAppEdit:!1},setMainRT:function(){return t.instance().component(this.get("uid")).setMain(),this.isAppEdit&&(this.setMainMessage(this.get("uid")),this.set("isMain",t.instance().component(this.get("uid")).get("main"))),null},reInit:function(){return this.init(this.get("uid")),null},init:function(e){var r,s,o,u,a,f,l,c,h,p,d,v;a=t.instance(),o=a.component(e),f=n.RESTYPE,this.set("tags",o.tags());if(o.node_line){this.set("isRTB",!1),c=o.getTarget(f.SUBNET),o=o.getTarget(f.RT);if(c){this.set({title:i.IDE.TITLE_SUBNET_RT_ASSO,association:{subnet:c.get("name"),rtb:o.get("name")}});return}}else this.set("isRTB",!0);r=t.modelClassForType(f.VPC),l=[],u={uid:o.id,description:o.get("description"),title:o.get("name"),isMain:o.get("main"),local_route:r.theVPC().get("cidr"),routes:l,isAppEdit:this.isAppEdit,isStack:t.instance().mode()==="stack"},v=o.connections();for(p=0,d=v.length;p<d;p++){s=v[p];if(s.type!=="RTB_Route")continue;h=s.getOtherTarget(f.RT),l.push({name:h.get("name"),type:h.type,ref:s.id,readonly:h.type==="ExternalVpcRouteTarget",isVgw:h.type===f.VGW,isProp:s.get("propagate"),cidr_set:s.get("routes")})}return l=_.sortBy(l,"type"),this.isAppEdit&&(this.set("vpcId",o.parent().get("appId")),this.set("routeTableId",o.get("appId")),this.setMainMessage(e)),this.set(u),!0},setMainMessage:function(e){var i,s,o,u,a,f,l,c,h;u=t.instance().component(e),i=(c=r(t.instance().credentialId(),n.RESTYPE.RT,t.instance().region()).get(u.get("appId")))!=null?c.toJSON():void 0,o=!1;if(i&&i.associationSet&&i.associationSet.length){h=i.associationSet;for(f=0,l=h.length;f<l;f++)s=h[f],s.main===!0&&(o=!0)}a=t.modelClassForType(n.RESTYPE.RT).getMainRouteTable(),o&&a.id!==u.id?this.set("main","Yes (Set as No after applying updates)"):o&&a.id===u.id?this.set("main","Yes"):!o&&a.id===u.id?this.set("main","No (Set as Yes after applying updates)"):this.set("main","No")},setPropagation:function(e){var r,i;return i=t.instance().component(this.get("uid")),r=_.find(i.connections(),function(e){return e.getTarget(n.RESTYPE.VGW)!==null}),r.setPropagate(e),null},setRoutes:function(e,n){return _.each(n,function(e,t){var r;return r=MC.getValidCIDR(e),n[t]=r}),t.instance().component(e).set("routes",n),null},removeRoute:function(e){var n;return(n=t.instance().component(e))!=null?n.remove():void 0},isCidrConflict:function(e,r){return t.modelClassForType(n.RESTYPE.SUBNET).isCidrConflict(e,r)}}),new s}),define("wspace/awseditor/property/rtb/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n    <div class="property-control-group">'+u(n.i18n.call(e,"PROP.RT_ASSOCIATION",{hash:{},data:t}))+" "+u((i=(i=e&&e.association,i==null||i===!1?i:i.subnet),typeof i===a?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP.RT_ASSOCIATION_TO",{hash:{},data:t}))+" "+u((i=(i=e&&e.association,i==null||i===!1?i:i.rtb),typeof i===a?i.apply(e):i))+"\n    </div>\n    ",r}function c(e,t){var r="",i;r+='\n    <div class="property-control-group" data-bind="true">\n        <label class="left" for="rt-name">'+u(n.i18n.call(e,"PROP.RT_NAME",{hash:{},data:t}))+'</label>\n        <input class="input" type="text" data-required="true" data-ignore="true" data-required-rollback="true"\n               value="'+u((i=e&&e.title,typeof i===a?i.apply(e):i))+'" id="rt-name">\n    </div>\n\n    <section class="property-control-group" data-bind="true">\n        <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n        <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+"</textarea>\n    </section>\n\n    ",i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:f.program(7,d,t),fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+='\n\n	<div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.RT_LBL_ROUTE",{hash:{},data:t}))+'</div>\n	<div class="option-group" data-bind="true">\n		<ul class="mega-list-wrapper route-list">\n			<li><table class="table-no-style">\n			  <tr class="route-target">\n			    <td class="route-label">'+u(n.i18n.call(e,"PROP.RT_TARGET",{hash:{},data:t}))+'</td>\n			    <td class="route-target-resource">'+u(n.i18n.call(e,"PROP.RT_LOCAL",{hash:{},data:t}))+'</td>\n			  </tr>\n			  <tr>\n			    <td class="route-label">'+u(n.i18n.call(e,"PROP.RT_DESTINATION",{hash:{},data:t}))+'</td>\n			    <td class="route-destination-input"> <input class="input route-readonly" value="'+u((i=e&&e.local_route,typeof i===a?i.apply(e):i))+'" disabled /> </td>\n			  </tr>\n			</table></li>\n\n            ',i=n.each.call(e,e&&e.routes,{hash:{},inverse:f.noop,fn:f.programWithDepth(12,g,t,e),data:t});if(i||i===0)r+=i;r+="\n        </ul>\n    </div>\n        ",i=n["if"].call(e,e&&e.isRTB,{hash:{},inverse:f.noop,fn:f.program(30,A,t),data:t});if(i||i===0)r+=i;return r+="\n    ",r}function h(e,t){var r="",i;r+='\n    <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(e,"PROP.RT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.routeTableId,typeof i===a?i.apply(e):i))+"</dd>\n\n        <dt>"+u(n.i18n.call(e,"PROP.RT_LBL_MAIN_RT",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.main,typeof i===a?i.apply(e):i))+"</dd>\n\n        <dt>"+u(n.i18n.call(e,"PROP.RT_VPC_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+"</dd>\n    </dl>\n    ",i=n["if"].call(e,e&&e.canSetMain,{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;return r+="\n\n    ",r}function p(e,t){var r="";return r+='\n    <div class="tac property-control-group">\n        <button class="btn btn-primary" id="set-main-rt" style="width: 200px;">'+u(n.i18n.call(e,"PROP.RT_SET_MAIN",{hash:{},data:t}))+"</button>\n    </div>\n    ",r}function d(e,t){var r="",i;r+='\n    <div class="tac property-control-group">\n        ',i=n["if"].call(e,e&&e.isMain,{hash:{},inverse:f.noop,fn:f.program(8,v,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,e&&e.canSetMain,{hash:{},inverse:f.noop,fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;return r+="\n\n    </div>\n    ",r}function v(e,t){var r="";return r+="\n        <p>"+u(n.i18n.call(e,"PROP.RT_LBL_MAIN_RT",{hash:{},data:t}))+"</p>\n        ",r}function m(e,t){var r="";return r+='\n        <button class="btn btn-primary" id="set-main-rt" style="width: 200px;">'+u(n.i18n.call(e,"PROP.RT_SET_MAIN",{hash:{},data:t}))+"</button>\n        ",r}function g(e,t,r){var i="",s;i+='\n            <li class="',s=n["if"].call(e,r&&r.isStack,{hash:{},inverse:f.noop,fn:f.program(13,y,t),data:t});if(s||s===0)i+=s;i+='">\n            ',s=n["if"].call(e,r&&r.isStack,{hash:{},inverse:f.noop,fn:f.program(16,w,t),data:t});if(s||s===0)i+=s;i+='\n            <table class="table-no-style">\n                <tr class="route-target">\n                    <td class="route-label">'+u(n.i18n.call(e,"PROP.RT_TARGET",{hash:{},data:t}))+'</td>\n                    <td class="route-target-resource">'+u((s=e&&e.name,typeof s===a?s.apply(e):s))+'</td>\n                </tr>\n                <tr>\n                    <td class="route-label">'+u(n.i18n.call(e,"PROP.RT_DESTINATION",{hash:{},data:t}))+'</td>\n                    <td class="route-destination-input">\n                        ',s=n["if"].call(e,e&&e.readonly,{hash:{},inverse:f.program(22,T,t),fn:f.program(19,S,t),data:t});if(s||s===0)i+=s;i+="\n\n                        ",s=n["if"].call(e,e&&e.isVgw,{hash:{},inverse:f.noop,fn:f.program(27,k,t),data:t});if(s||s===0)i+=s;return i+="\n                    </td>\n                </tr>\n            </table>\n            </li>\n            ",i}function y(e,t){var r;return r=n.ifCond.call(e,e&&e.type," ExternalVpcRouteTarget\n            ",{hash:{},inverse:f.noop,fn:f.program(14,b,t),data:t}),r||r===0?r:""}function b(e,t){return"have-vpc-peer-route"}function w(e,t){var r;return r=n.ifCond.call(e,e&&e.type,"ExternalVpcRouteTarget",{hash:{},inverse:f.noop,fn:f.program(17,E,t),data:t}),r||r===0?r:""}function E(e,t){var r="";return r+='\n            <div class="remove-vpc-peer-route">'+u(n.i18n.call(e,"PROP.RTB_REMOVE_VPC_PEER_ROUTE",{hash:{},data:t}))+"</div>\n            ",r}function S(e,t){var r="",i;r+="\n                        ",i=n.each.call(e,e&&e.cidr_set,{hash:{},inverse:f.noop,fn:f.programWithDepth(20,x,t,e),data:t});if(i||i===0)r+=i;return r+="\n                        ",r}function x(e,t,n){var r="",i;return r+='\n                        <div class="route-readonly" data-ref="'+u((i=n&&n.ref,typeof i===a?i.apply(e):i))+'">'+u(typeof e===a?e.apply(e):e)+"</div>\n                        ",r}function T(e,t){var r="",i;r+='\n                        <div class="multi-input" data-ref="'+u((i=e&&e.ref,typeof i===a?i.apply(e):i))+'">\n                            ',i=n.each.call(e,e&&e.cidr_set,{hash:{},inverse:f.program(25,C,t),fn:f.program(23,N,t),data:t});if(i||i===0)r+=i;return r+="\n                        </div>\n                        ",r}function N(e,t){var n="";return n+='\n                            <div class="multi-ipt-row">\n                                <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#"\n                                                                                               class="icon-add"></a></span>\n                                <span class="ipt-wrapper"><input class="ip-main-input input" data-ignore="true"\n                                                                 data-ignore-regexp="^[0-9./]*$" data-type="cidr"\n                                                                 data-trigger="change" placeholder="eg. 0.0.0.0/0"\n                                                                 value="'+u(typeof e===a?e.apply(e):e)+'" type="text"></span>\n                            </div>\n                            ',n}function C(e,t){return'\n                            <div class="multi-ipt-row">\n                                <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#"\n                                                                                               class="icon-add"></a></span>\n                                <span class="ipt-wrapper"><input class="input tooltip" data-ignore="true"\n                                                                 data-ignore-regexp="^[0-9./]*$"\n                                                                 placeholder="eg. 0.0.0.0/0" data-empty-remove="true"\n                                                                 type="text"></span>\n                            </div>\n                            '}function k(e,t){var r="",i;r+='\n                        <div class="property-control-group">\n                            <div class="checkbox">\n                                <input id="propagate_'+u((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'" type="checkbox" class="propagation" ',i=n["if"].call(e,e&&e.isProp,{hash:{},inverse:f.noop,fn:f.program(28,L,t),data:t});if(i||i===0)r+=i;return r+='>\n                                <label for="propagate_'+u((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'"></label>\n                            </div>\n                            <label for="propagate_'+u((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'">'+u(n.i18n.call(e,"PROP.RTB_ALLOW_PROPAGATION",{hash:{},data:t}))+"</label>\n                        </div>\n                        ",r}function L(e,t){return'checked="true" '}function A(e,t){var r="",i;r+='\n        <div class="option-group-head expand">\n            '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n        </div>\n        <div class="option-group">\n            ',i=n["if"].call(e,(i=e&&e.tags,i==null||i===!1?i:i.length),{hash:{},inverse:f.program(34,_,t),fn:f.program(31,O,t),data:t});if(i||i===0)r+=i;return r+='\n            <div class="tags-action">\n\n                <button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>\n            </div>\n        </div>\n        ",r}function O(e,t){var r="",i;r+='\n            <table class="table cost-estimation-table">\n                <tbody>\n                ',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(32,M,t),data:t});if(i||i===0)r+=i;return r+="\n                </tbody>\n            </table>\n            ",r}function M(e,t){var n="",r;return n+='\n                <tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n                ",n}function _(e,t){var r="";return r+='\n            <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n            ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+="<article>\n    ",o=n["if"].call(t,t&&t.association,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/rtb/view",["../base/view","./template/stack","i18n!/nls/lang.js","UI.modalplus"],function(e,t,n,r){var i;return i=e.extend({events:{"REMOVE_ROW  .multi-input":"removeIp","ADD_ROW     .multi-input":"processParsley","BEFORE_REMOVE_ROW  .multi-input":"beforeRemoveIp","change #rt-name":"changeName","click #set-main-rt":"setMainRT","change .propagation":"changePropagation","focus .ipt-wrapper .input":"onFocusCIDR","keypress .ipt-wrapper .input":"onPressCIDR","blur .ipt-wrapper .input":"onBlurCIDR","change #property-res-desc":"onChangeDescription","click .remove-vpc-peer-route a":"onRemoveVPCPeerRoute"},render:function(){var e;return e=this.model.attributes,e.canSetMain=!e.isMain&&!Design.instance().opsModel().isMesos(),this.$el.html(t(this.model.attributes)),this.model.attributes.title},onChangeDescription:function(e){return this.model.setDesc($(e.currentTarget).val())},processParsley:function(e){return $(e.currentTarget).find("input").last().focus().removeClass("parsley-validated").removeClass("parsley-error").next(".parsley-error-list").remove(),null},beforeRemoveIp:function(e){var t;return t=$(e.currentTarget).find("input").filter(function(){return this.value.length}),t.length<=1&&e.value?!1:null},removeIp:function(e){var t,n;return t=$(e.currentTarget),n=_.map(t.find("input"),function(e){return e.value}),this.model.setRoutes(t.attr("data-ref"),_.uniq(n)),null},changeName:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(MC.aws.aws.checkResName(this.model.get("uid"),n,"Route Table"))return this.model.setName(t),this.setTitle(t)},setMainRT:function(){return this.model.isAppEdit?(this.model.setMainRT(),this.render()):($("#set-main-rt").hide().parent().find("p").show(),this.model.setMainRT()),null},changePropagation:function(e){return this.model.setPropagation($(e.target).is(":checked")),null},onPressCIDR:function(e){if(e.keyCode===13)return $(e.currentTarget).blur()},onFocusCIDR:function(e){return this.disabledAllOperabilityArea(!0),null},onBlurCIDR:function(e){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;f=$(e.currentTarget),l=f.val(),d=f.closest(".multi-input"),s=d.attr("data-ref"),c=[],d.find("input").each(function(){return this!==e.currentTarget&&this.value&&c.push(this.value),null}),t=_.uniq(c),d.closest("li").siblings().each(function(){var e;return e=[],$(this).find("input").each(function(){return this.value&&e.push(this.value),null}),t=t.concat(_.uniq(e)),null});if(!l)f.closest(".multi-ipt-row").siblings().length===0&&(h=n.PROP.RTB_CIDR_BLOCK_REQUIRED,o=n.PROP.RTB_CIDR_BLOCK_REQUIRED_DESC);else if(!MC.validate("cidr",l))h=sprintf(n.PROP.RTB_CIDR_BLOCK_INVALID,l),o=n.PROP.RTB_CIDR_BLOCK_INVALID_DESC;else for(a=m=0,g=t.length;m<g;a=++m){i=t[a];if(l===i||i!=="0.0.0.0/0"&&this.model.isCidrConflict(l,i)){h=sprintf(n.PROP.RTB_CIDR_BLOCK_CONFLICTS,l),o=n.PROP.RTB_CIDR_BLOCK_CONFLICTS_DESC;break}}if(!h){l&&c.push(l),this.model.setRoutes(s,_.uniq(c)),this.disabledAllOperabilityArea(!1);return}u=MC.template.setupCIDRConfirm({remove_content:n.PROP.REMOVE_ROUTE,main_content:h,desc_content:o}),v=this;if((y=this.modal)!=null?!y.isOpen():!void 0)return this.modal=new r({title:n.IDE.SET_UP_CIDR_BLOCK,width:420,template:u,confirm:{text:"OK",color:"blue"},disableClose:!0,cancel:{hide:!0}}),p=this.modal,$('<a id="cidr-removed" class="link-red left link-modal-danger">'+n.PROP.REMOVE_ROUTE+"</a>").appendTo(p.find(".modal-footer")),p.on("confirm",function(){return v.disabledAllOperabilityArea(!1),p.close()}),p.on("close",function(){return v.disabledAllOperabilityArea(!1),f.focus()}),p.on("closed",function(){return v.disabledAllOperabilityArea(!1),f.focus()}),p.find("#cidr-removed").on("click",function(){var e;return(e=Design.instance().component(s))!=null&&e.remove(),v.disabledAllOperabilityArea(!1),p.close(),v.render()})},onRemoveVPCPeerRoute:function(e){var t;return t=$(e.currentTarget).parents("li"),this.model.removeRoute(t.find(".route-readonly").attr("data-ref")),t.remove(),null}}),new i}),define("wspace/awseditor/property/rtb/app_model",["../base/model","constant","Design","CloudResources"],function(e,t,n,r){var i;return i=e.extend({processTarget:function(e){return e.routeSet=_.map(e.routeSet,function(e){return e.target=e.instanceId||e.networkInterfaceId||e.gatewayId||e.vpcPeeringConnectionId,e.target!=="local"&&n.instance().eachComponent(function(t){if(t.get("appId")===e.target){e.target=t.get("name");return}return null}),e}),null},init:function(e){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L;d=n.instance().component(e);if(d.type===t.RESTYPE.RT)h=d;else{o={},s=d.getOtherTarget(t.RESTYPE.RT),h=d.getTarget(t.RESTYPE.RT),s.type===t.RESTYPE.SUBNET&&(o.subnet=s.get("name"),a=!0),o.rtb=h.get("name"),e=h.id;if(a){this.set("association",o),this.set("name","Subnet-RT Association");return}}p=(T=r(n.instance().credentialId(),t.RESTYPE.RT,n.instance().region()).get(h.get("appId")))!=null?T.toJSON():void 0;if(!p)return!1;p=$.extend(!0,{},p),p.name=h.get("name"),p.description=h.get("description"),u=!1;if(p.associationSet&&p.associationSet.length){N=p.associationSet;for(m=0,w=N.length;m<w;m++)i=N[m],i.main===!0&&(u=!0)}u?p.main="Yes":p.main="No",C=p.routeSet;for(g=0,E=C.length;g<E;g++)f=C[g],f.state==="active"&&(f.active=!0);c={};if(p.propagatingVgwSet&&p.propagatingVgwSet.length){k=p.propagatingVgwSet;for(y=0,S=k.length;y<S;y++)f=k[y],c[f.gatewayId]=!0}L=p.routeSet;for(l=b=0,x=L.length;b<x;l=++b)v=L[l],c[v.gatewayId]&&(v.propagate=!0);return this.processTarget(p),this.set(p)}}),new i}),define("wspace/awseditor/property/rtb/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n    <div class="property-control-group">'+u(n.i18n.call(e,"PROP.RT_ASSOCIATION",{hash:{},data:t}))+" "+u((i=(i=e&&e.association,i==null||i===!1?i:i.subnet),typeof i===a?i.apply(e):i))+" "+u(n.i18n.call(e,"PROP.RT_ASSOCIATION_TO",{hash:{},data:t}))+" "+u((i=(i=e&&e.association,i==null||i===!1?i:i.rtb),typeof i===a?i.apply(e):i))+"\n    </div>\n    ",r}function c(e,t){var r="",i;r+='\n\n    <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(e,"PROP.RT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.id,typeof i===a?i.apply(e):i))+"</dd>\n\n        <dt>"+u(n.i18n.call(e,"PROP.NAME",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.emptyStr.call(e,e&&e.name,{hash:{},data:t}))+"</dd>\n\n        <dt>"+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.emptyStr.call(e,e&&e.description,{hash:{},data:t}))+"</dd>\n\n        <dt>"+u(n.i18n.call(e,"PROP.RT_LBL_MAIN_RT",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.main,typeof i===a?i.apply(e):i))+"</dd>\n\n        <dt>"+u(n.i18n.call(e,"PROP.RT_VPC_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+'</dd>\n    </dl>\n    <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.RT_LBL_ROUTE",{hash:{},data:t}))+'</div>\n    <div class="option-group">\n        <table class="table table-small">\n            <thead>\n            <tr>\n                <th></th>\n                <th>'+u(n.i18n.call(e,"PROP.RT_DESTINATION",{hash:{},data:t}))+"</th>\n                <th>"+u(n.i18n.call(e,"PROP.RT_TARGET",{hash:{},data:t}))+"</th>\n                <th></th>\n            </tr>\n            </thead>\n            ",i=n.each.call(e,e&&e.routeSet,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+="\n        </table>\n    </div>\n    ",i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(13,g,t),data:t});if(i||i===0)r+=i;return r+="\n    ",r}function h(e,t){var r="",i;r+="\n            <tr>\n                ",i=n["if"].call(e,e&&e.active,{hash:{},inverse:f.program(7,d,t),fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;r+="\n                <td>"+u((i=e&&e.destinationCidrBlock,typeof i===a?i.apply(e):i))+"</td>\n                <td>"+u((i=e&&e.target,typeof i===a?i.apply(e):i))+"</td>\n                ",i=n["if"].call(e,e&&e.propagate,{hash:{},inverse:f.program(11,m,t),fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;return r+="\n            </tr>\n            ",r}function p(e,t){var r="";return r+='\n                <td><i class="status status-green tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.RT_TIP_ACTIVE",{hash:{},data:t}))+'"></i></td>\n                ',r}function d(e,t){var r="";return r+='\n                <td><i class="status status-red tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.RT_TIP_BLACKHOLE",{hash:{},data:t}))+'"></i></td>\n                ',r}function v(e,t){var r="";return r+='\n                <td><i class="icon-info tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.RT_TIP_PROPAGATED",{hash:{},data:t}))+'"></i></td>\n                ',r}function m(e,t){return"\n                <td></td>\n                "}function g(e,t){var r="",i;r+='\n    <div class="option-group-head expand">\n        '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n    </div>\n    <div class="option-group">\n        ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.program(17,w,t),fn:f.program(14,y,t),data:t});if(i||i===0)r+=i;return r+='\n        <div class="tags-action">\n            \n        </div>\n    </div>\n    ',r}function y(e,t){var r="",i;r+='\n        <table class="table cost-estimation-table">\n            <tbody>\n            ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+="\n            </tbody>\n        </table>\n        ",r}function b(e,t){var n="",r;return n+='\n            <tr> <td style="min-width:70px;">'+u((r=t==null||t===!1?t:t.key,typeof r===a?r.apply(e):r))+"</td><td>"+u(typeof e===a?e.apply(e):e)+"</td> </tr>\n            ",n}function w(e,t){var r="";return r+='\n        <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n        ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n\n    ',o=n["if"].call(t,t&&t.association,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/rtb/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name}}),new n}),define("wspace/awseditor/property/rtb/main",["../base/main","./model","./view","./app_model","./app_view","event","constant"],function(e,t,n,r,i,s,o){var u;return u=e.extend({handleTypes:[o.RESTYPE.RT,"RTB_Route","RTB_Asso"],initStack:function(){return this.model=t,this.model.isAppEdit=!1,this.view=n,null},initApp:function(){return this.model=r,this.view=i,null},initAppEdit:function(){return this.model=t,this.model.isAppEdit=!0,this.view=n,null}}),null}),define("wspace/awseditor/property/static/model",["../base/model","Design","constant","CloudResources"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var i,s,o,u,a;return s=t.instance().component(e),this.set("tags",s.tags()),u=s.type===n.RESTYPE.IGW,this.set("isIGW",u),this.isApp&&(this.set("readOnly",!0),i=s.get("appId"),o=(a=r(t.instance().credentialId(),s.type,t.instance().region()).get(i))!=null?a.toJSON():void 0,this.isAppEdit&&this.set("isAppEdit",!0)),o&&(o.attachments&&o.attachments.length?o.attachment_state=o.attachments[0].state:o.attachmentSet&&o.attachmentSet.length&&(o.attachment_state=o.attachmentSet[0].state),this.set(o),this.set("appId",o.id)),null}}),new i}),define("wspace/awseditor/property/static/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<article class="property-app">\n    <dl class="dl-vertical">\n        <dt>',i=n["if"].call(e,e&&e.isIGW,{hash:{},inverse:a.program(4,c,t),fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+=" ID</dt>\n        <dd>"+o(n.emptyStr.call(e,e&&e.appId,{hash:{},data:t}))+"</dd>\n        ",i=n["if"].call(e,e&&e.isIGW,{hash:{},inverse:a.program(8,p,t),fn:a.program(6,h,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,e&&e.type,{hash:{},inverse:a.noop,fn:a.program(10,d,t),data:t});if(i||i===0)r+=i;r+="\n        <dt>VPC</dt>\n        <dd>"+o(n.emptyStr.call(e,e&&e.vpcId,{hash:{},data:t}))+"</dd>\n    </dl>\n    </article>\n    ",i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:a.noop,fn:a.program(12,v,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function l(e,t){return"Internet Gateway"}function c(e,t){return"VPN Gateway"}function h(e,t){var r="",i;return r+="\n        <dt>"+o(n.i18n.call(e,"PROP.VPC_APP_STATE",{hash:{},data:t}))+'</dt>\n        <dd><i class="status status-xgw-'+o((i=e&&e.state,typeof i===u?i.apply(e):i))+'"></i>'+o((i=e&&e.state,typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function p(e,t){var r="",i;return r+="\n        <dt>"+o(n.i18n.call(e,"PROP.VPC_APP_STATE",{hash:{},data:t}))+'</dt>\n        <dd><i class="status status-xgw-'+o((i=e&&e.state,typeof i===u?i.apply(e):i))+'"></i>'+o((i=e&&e.state,typeof i===u?i.apply(e):i))+"</dd>\n        <dt>"+o(n.i18n.call(e,"PROP.VOLUME_ATTACHMENT_STATE",{hash:{},data:t}))+'</dt>\n        <dd><i class="status status-xgw-'+o((i=e&&e.attachment_state,typeof i===u?i.apply(e):i))+'"></i>'+o((i=e&&e.attachment_state,typeof i===u?i.apply(e):i))+"</dd>\n        ",r}function d(e,t){var n="",r;return n+="\n        <dt>type</dt>\n        <dd>"+o((r=e&&e.type,typeof r===u?r.apply(e):r))+"</dd>\n        ",n}function v(e,t){var r="",i;r+='\n        <div class="option-group-head expand">\n            '+o(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n        </div>\n        <div class="option-group">\n            ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:a.program(16,y,t),fn:a.program(13,m,t),data:t});if(i||i===0)r+=i;r+='\n            <div class="tags-action">\n                \n                ',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(18,b,t),data:t});if(i||i===0)r+=i;return r+="\n            </div>\n        </div>\n    ",r}function m(e,t){var r="",i;r+='\n            <table class="table cost-estimation-table">\n                <tbody>\n                ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:a.noop,fn:a.program(14,g,t),data:t});if(i||i===0)r+=i;return r+="\n                </tbody>\n            </table>\n            ",r}function g(e,t){var n="",r;return n+='\n                <tr> <td style="min-width:70px;">'+o((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</td><td>"+o(typeof e===u?e.apply(e):e)+"</td> </tr>\n                ",n}function y(e,t){var r="";return r+='\n            <div class="empty-tag">'+o(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n            ",r}function b(e,t){var r="";return r+='<button class="btn open-tag-manager modal-confirm btn-blue">'+o(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>",r}function w(e,t){var r="",i;r+='\n    <article>\n        <div class="property-control-group">\n            ',i=n["if"].call(e,e&&e.isIGW,{hash:{},inverse:a.program(23,S,t),fn:a.program(21,E,t),data:t});if(i||i===0)r+=i;r+='\n        </div>\n    </article>\n    <div class="option-group-head expand">\n        '+o(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n    </div>\n    <div class="option-group">\n        ',i=n["if"].call(e,(i=e&&e.tags,i==null||i===!1?i:i.length),{hash:{},inverse:a.program(28,N,t),fn:a.program(25,x,t),data:t});if(i||i===0)r+=i;return r+='\n        <div class="tags-action">\n            \n            <button class="btn open-tag-manager modal-confirm btn-blue">'+o(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>\n        </div>\n    </div>\n",r}function E(e,t){var r="";return r+="\n            "+o(n.i18n.call(e,"PROP.IGW_TXT_DESCRIPTION",{hash:{},data:t}))+"\n            ",r}function S(e,t){var r="";return r+="\n            "+o(n.i18n.call(e,"PROP.VGW_TXT_DESCRIPTION",{hash:{},data:t}))+"\n            ",r}function x(e,t){var r="",i;r+='\n        <table class="table cost-estimation-table">\n            <tbody>\n            ',i=n.each.call(e,e&&e.tags,{hash:{},inverse:a.noop,fn:a.program(26,T,t),data:t});if(i||i===0)r+=i;return r+="\n            </tbody>\n        </table>\n        ",r}function T(e,t){var n="",r;return n+='\n            <tr> <td style="min-width:70px;">'+o((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===u?r.apply(e):r))+"</td><td>"+o((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===u?r.apply(e):r))+"</td> </tr>\n            ",n}function N(e,t){var r="";return r+='\n        <div class="empty-tag">'+o(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n        ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u="function",a=this;return s=n["if"].call(t,t&&t.readOnly,{hash:{},inverse:a.program(20,w,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""};return e.template(t)}),define("wspace/awseditor/property/static/view",["../base/view","./template/stack"],function(e,t){var n;return n=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.get("isIGW")?"Internet-gateway":"VPN-gateway"}}),new n}),define("wspace/awseditor/property/static/main",["../base/main","./model","./view","constant"],function(e,t,n,r){var i;return i=e.extend({handleTypes:[r.RESTYPE.VGW,r.RESTYPE.IGW],initStack:function(){return this.model=t,this.view=n,this.model.isApp=!1,null},initApp:function(){return this.model=t,this.view=n,this.model.isApp=!0,null},initAppEdit:function(){return this.model=t,this.view=n,this.model.isApp=!0,this.model.isAppEdit=!0,null}}),null}),define("wspace/awseditor/property/cgw/model",["../base/model","Design","constant"],function(e,t,n){var r;return r=e.extend({init:function(e){var n;return n=t.instance().component(e),this.set({uid:e,name:n.get("name"),description:n.get("description"),BGP:n.get("bgpAsn"),ip:n.get("ip"),tags:n.tags()}),null},setIP:function(e){return t.instance().component(this.get("uid")).set("ip",e),null},setBGP:function(e){return t.instance().component(this.get("uid")).set("bgpAsn",e),null}}),new r}),define("wspace/awseditor/property/cgw/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return'checked="checked" '}function c(e,t){return'style="display:none;"'}function h(e,t){var r="",i;r+='\n		<table class="table cost-estimation-table">\n			<tbody>\n			',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;return r+="\n			</tbody>\n		</table>\n		",r}function p(e,t){var n="",r;return n+='\n			<tr> <td style="min-width:70px;">'+a((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===u?r.apply(e):r))+"</td><td>"+a((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===u?r.apply(e):r))+"</td> </tr>\n			",n}function d(e,t){var r="";return r+='\n		<div class="empty-tag">'+a(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article id="property-cgw" data-bind="true">\n	<div class="property-control-group clearfix">\n		<label class="left" for="property-cgw-name">'+a(n.i18n.call(t,"PROP.CGW_LBL_NAME",{hash:{},data:i}))+'</label>\n		<span class="required-input right">'+a(n.i18n.call(t,"PROP.LBL_REQUIRED",{hash:{},data:i}))+'</span>\n		<input class="input" type="text" value="'+a((o=t&&t.name,typeof o===u?o.apply(t):o))+'" id="property-cgw-name" data-ignore="true"/>\n	</div>\n\n	<div class="property-control-group">\n        <label class="left" for="property-res-desc">'+a(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+'</label>\n        <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+a((o=t&&t.description,typeof o===u?o.apply(t):o))+'</textarea>\n	</div>\n\n	<div class="property-control-group clearfix">\n		<label class="left" for="property-cgw-ip">'+a(n.i18n.call(t,"PROP.CGW_LBL_IPADDR",{hash:{},data:i}))+'</label>\n		<span class="required-input right">'+a(n.i18n.call(t,"PROP.LBL_REQUIRED",{hash:{},data:i}))+'</span>\n		<input class="input tooltip" type="text" value="'+a((o=t&&t.ip,typeof o===u?o.apply(t):o))+'" data-ignore="true" data-ignore-regexp="^[0-9.]*$" id="property-cgw-ip" data-empty-remove="true" data-tooltip="'+a(n.i18n.call(t,"PROP.CGW_TIP_THIS_ADDRESS_MUST_BE_STATIC",{hash:{},data:i}))+'"/>\n	</div>\n\n	<div class="property-control-group clearfix cgw-routing">\n		<label>'+a(n.i18n.call(t,"PROP.CGW_LBL_ROUTING",{hash:{},data:i}))+'</label>\n		<p></p>\n		<div class="radio">\n			<input id="property-routing-static" type="radio" name="routing-type" ',o=n.unless.call(t,t&&t.BGP,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='value="static" />\n			<label for="property-routing-static"></label>\n		</div>\n		<label for="property-routing-static">'+a(n.i18n.call(t,"PROP.CGW_LBL_STATIC",{hash:{},data:i}))+'</label>\n	</div>\n\n	<div class="property-control-group clearfix cgw-routing">\n		<div class="radio">\n			<input id="property-routing-dynamic" type="radio" name="routing-type" ',o=n["if"].call(t,t&&t.BGP,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='value="dynamic" />\n			<label for="property-routing-dynamic"></label>\n		</div>\n		<label for="property-routing-dynamic">'+a(n.i18n.call(t,"PROP.CGW_LBL_DYNAMIC",{hash:{},data:i}))+'</label>\n	</div>\n\n	<div class="property-control-group clearfix" ',o=n.unless.call(t,t&&t.BGP,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+=' id="property-cgw-bgp-wrapper">\n		<label class="left" for="property-cgw-bgp">'+a(n.i18n.call(t,"PROP.CGW_LBL_BGP_ASN",{hash:{},data:i}))+'</label>\n		<span class="required-input right">'+a(n.i18n.call(t,"PROP.LBL_REQUIRED",{hash:{},data:i}))+'</span>\n		<input class="input tooltip" type="text" value="'+a((o=t&&t.BGP,typeof o===u?o.apply(t):o))+'" id="property-cgw-bgp" maxlength="5" data-tooltip="'+a(n.i18n.call(t,"PROP.CGW_TIP_1TO65534",{hash:{},data:i}))+'" data-type="digits" />\n	</div>\n\n	<div class="option-group-head expand">\n		'+a(n.i18n.call(t,"PROP.RESOURCE_TAGS",{hash:{},data:i}))+'\n	</div>\n	<div class="option-group">\n		',o=n["if"].call(t,(o=t&&t.tags,o==null||o===!1?o:o.length),{hash:{},inverse:f.program(8,d,i),fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;return s+='\n		<div class="tags-action">\n			\n			<button class="btn open-tag-manager modal-confirm btn-blue">'+a(n.i18n.call(t,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:i}))+"</button>\n		</div>\n	</div>\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/cgw/view",["i18n!/nls/lang.js","../base/view","./template/stack","constant","Design","UI.modalplus"],function(e,t,n,r,i,s){var o;return o=t.extend({events:{"click #property-cgw .cgw-routing input":"onChangeRouting","change #property-cgw-bgp":"onChangeBGP","change #property-cgw-name":"onChangeName","focus #property-cgw-ip":"onFocusIP","keypress #property-cgw-ip":"onPressIP","blur #property-cgw-ip":"onBlurIP","change #property-res-desc":"onChangeDescription"},render:function(){return this.$el.html(n(this.model.toJSON())),this.model.get("name")},onChangeDescription:function(e){return this.model.setDesc($(e.currentTarget).val())},onChangeRouting:function(){return $("#property-cgw-bgp-wrapper").toggle($("#property-routing-dynamic").is(":checked")),this.model.setBGP("")},onChangeBGP:function(t){var n,r;n=$(t.currentTarget),r=i.instance().region();if(!n.val()){this.model.setBGP("");return}return n.parsley("custom",function(t){t=+t;if(t<1||t>65534)return e.PARSLEY.MUST_BE_BETWEEN_1_AND_65534;if(t===7224&&r==="us-east-1")return e.PARSLEY.ASN_NUMBER_7224_RESERVED;if(t===9059&&r==="eu-west-1")return e.PARSLEY.ASN_NUMBER_9059_RESERVED_IN_IRELAND}),n.parsley("validate")&&this.model.setBGP(n.val()),null},onChangeName:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(MC.aws.aws.checkResName(this.model.get("uid"),n,"Customer Gateway"))return this.model.setName(t),this.setTitle(t)},onPressIP:function(e){if(e.keyCode===13)return $("#property-cgw-ip").blur()},onFocusIP:function(e){return this.disabledAllOperabilityArea(!0),null},onBlurIP:function(t){var n,r,o,u,a,f,l,c;u=$("#property-cgw-ip").val(),o=!0,u?MC.validate("ipv4",u)?MC.aws.aws.isValidInIPRange(u,"private")?(a=sprintf(e.PROP.CGW_IP_VALIDATE_INVALID_CUSTOM,u),n=e.PROP.CGW_IP_VALIDATE_INVALID_CUSTOM_DESC):o=!1:(a=sprintf(e.PROP.CGW_IP_VALIDATE_INVALID,u),n=e.PROP.CGW_IP_VALIDATE_INVALID_DESC):(a=e.PROP.CGW_IP_VALIDATE_REQUIRED,n=e.PROP.CGW_IP_VALIDATE_REQUIRED_DESC);if(!o){this.model.setIP(t.target.value),this.disabledAllOperabilityArea(!1);return}if((c=this.modal)!=null?!c.isOpen():!void 0)return r=MC.template.setupCIDRConfirm({remove_content:e.PROP.CGW_REMOVE_CUSTOM_GATEWAY,main_content:a,desc_content:n}),l=this,this.modal=new s({template:r,title:e.IDE.SET_UP_CIDR_BLOCK,disableClose:!0,width:420,confirm:{text:"OK",color:"blue"},cancel:{hide:!0}}),f=this.modal,$('<a id="cidr-removed" class="link-red left link-modal-danger">'+e.PROP.CGW_REMOVE_CUSTOM_GATEWAY+"</a>").appendTo(f.find(".modal-footer")),f.on("confirm",function(){return f.close()}),f.on("close",function(){return $("#property-cgw-ip").focus()}),f.on("closed",function(){return $("#property-cgw-ip").focus()}),f.find("#cidr-removed").on("click",function(e){return e.preventDefault(),void 0,i.instance().component(l.model.get("uid")).remove(),l.disabledAllOperabilityArea(!1),f.close()})}}),new o}),define("wspace/awseditor/property/cgw/app_model",["../base/model","Design","constant","CloudResources"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var i,s,o;return s=t.instance().component(e),i=(o=r(t.instance().credentialId(),n.RESTYPE.CGW,t.instance().region()).get(s.get("appId")))!=null?o.toJSON():void 0,i?(i=$.extend(!0,{},i),i.uid=e,i.name=s.get("name"),i.description=s.get("description"),this.set(i),null):!1}}),new i}),define("wspace/awseditor/property/cgw/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="";return r+="\n    <dt>"+u(n.i18n.call(e,"PROP.NAME",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.name,{hash:{},data:t}))+"</dd>\n    <dt>"+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+"</dt>\n    <dd>"+u(n.emptyStr.call(e,e&&e.description,{hash:{},data:t}))+"</dd>\n    ",r}function c(e,t){var r="",i;return r+='\n  <div class="property-control-group clearfix">\n      <label class="left" for="property-cgw-name">'+u(n.i18n.call(e,"PROP.CGW_LBL_NAME",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.LBL_REQUIRED",{hash:{},data:t}))+'</span>\n      <input class="input" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-cgw-name" data-ignore="true"/>\n  </div>\n  <section class="property-control-group" data-bind="true">\n    <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n    <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+"</textarea>\n  </section>\n  ",r}function h(e,t){var r="",i;r+='\n    <div class="option-group-head expand">\n        '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n    </div>\n    <div class="option-group">\n        ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.program(9,v,t),fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,e&&e.isEditable,{hash:{},inverse:f.program(13,g,t),fn:f.program(11,m,t),data:t});if(i||i===0)r+=i;return r+="\n    </div>\n    ",r}function p(e,t){var r="",i;r+='\n        <table class="table cost-estimation-table">\n            <tbody>\n            ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n            </tbody>\n        </table>\n        ",r}function d(e,t){var n="",r;return n+='\n            <tr> <td style="min-width:70px;">'+u((r=t==null||t===!1?t:t.key,typeof r===a?r.apply(e):r))+"</td><td>"+u(typeof e===a?e.apply(e):e)+"</td> </tr>\n            ",n}function v(e,t){var r="";return r+='\n        <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n        ",r}function m(e,t){var r="";return r+='\n        <div class="tags-action">\n            \n            <button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>\n        </div>\n        ",r}function g(e,t){return'\n        <div class="tags-action">\n            \n        </div>\n        '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(t,"PROP.CGW_APP_CGW_LBL_ID",{hash:{},data:i}))+"</dt>\n    <dd>"+u((o=t&&t.customerGatewayId,typeof o===a?o.apply(t):o))+"</dd>\n    ",o=n.unless.call(t,t&&t.isEditable,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n  </dl>\n  ",o=n["if"].call(t,t&&t.isEditable,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n  <dl class="dl-vertical">\n    <dt>'+u(n.i18n.call(t,"PROP.CGW_APP_CGW_LBL_STATE",{hash:{},data:i}))+'</dt>\n    <dd><i class="status status-xgw-'+u((o=t&&t.state,typeof o===a?o.apply(t):o))+'"></i>'+u((o=t&&t.state,typeof o===a?o.apply(t):o))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP.CGW_LBL_IPADDR",{hash:{},data:i}))+"</dt>\n    <dd>"+u((o=t&&t.ipAddress,typeof o===a?o.apply(t):o))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP.CGW_APP_CGW_LBL_TYPE",{hash:{},data:i}))+"</dt>\n    <dd>"+u((o=t&&t.type,typeof o===a?o.apply(t):o))+"</dd>\n    <dt>"+u(n.i18n.call(t,"PROP.CGW_LBL_BGP_ASN",{hash:{},data:i}))+"</dt>\n    <dd>"+u((o=t&&t.bgpAsn,typeof o===a?o.apply(t):o))+"</dd>\n  </dl>\n    ",o=n["if"].call(t,t&&t.tagSet,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;return s+="\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/cgw/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({events:{"change #property-res-desc":"onChangeDescription","change #property-cgw-name":"onChangeName"},render:function(){var e;return this.$el.html(t(_.extend({isEditable:this.model.isAppEdit},(e=this.model)!=null?e.toJSON():void 0))),this.model.get("id")},onChangeName:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(MC.aws.aws.checkResName(this.model.get("uid"),n,"Customer Gateway"))return this.model.setName(t),this.setTitle(t)},onChangeDescription:function(e){return this.model.setDesc($(e.currentTarget).val())}}),new n}),define("wspace/awseditor/property/cgw/main",["../base/main","./model","./view","./app_model","./app_view","constant"],function(e,t,n,r,i,s){var o;return o=e.extend({handleTypes:s.RESTYPE.CGW,initStack:function(){return this.model=t,this.view=n,null},initApp:function(){return this.model=r,this.model.isAppEdit=!1,this.view=i,null},initAppEdit:function(){return this.model=r,this.model.isAppEdit=!0,this.view=i,null}}),null}),define("wspace/awseditor/property/vpn/model",["../base/model","Design","constant","CloudResources"],function(e,t,n,r){var i,s;return s=function(e,t){var n,r;return n="{}",t.customerGatewayConfiguration?(t=$.xml2json($.parseXML(t.customerGatewayConfiguration)),t?(t=t.vpn_connection,r=_.map(e,function(e){var n,r;return n={vpnConnectionId:t["@attributes"].id||"",vpnGatewayId:t.vpn_gateway_id||"",customerGatewayId:t.customer_gateway_id||""},n.tunnel=_.map(t.ipsec_tunnel,function(e,t){var n;return n={},n.number=t+1,n.ike_protocol_method=e.ike.authentication_protocol||"",n.ike_pre_shared_key=e.ike.pre_shared_key||"",n.ike_authentication_protocol_algorithm=e.ike.authentication_protocol||"",n.ike_encryption_protocol=e.ike.encryption_protocol||"",n.ike_lifetime=e.ike.lifetime||"",n.ike_mode=e.ike.mode||"",n.ike_perfect_forward_secrecy=e.ike.perfect_forward_secrecy||"",n.ipsec_protocol=e.ipsec.protocol||"",n.ipsec_authentication_protocol=e.ipsec.authentication_protocol||"",n.ipsec_encryption_protocol=e.ipsec.encryption_protocol||"",n.ipsec_lifetime=e.ipsec.lifetime||"",n.ipsec_mode=e.ipsec.mode||"",n.ipsec_perfect_forward_secrecy=e.ipsec.perfect_forward_secrecy||"",n.ipsec_interval=e.ipsec.dead_peer_detection.interval||"",n.ipsec_retries=e.ipsec.dead_peer_detection.retries||"",n.tcp_mss_adjustment=e.ipsec.tcp_mss_adjustment||"",n.clear_df_bit=e.ipsec.clear_df_bit||"",n.fragmentation_before_encryption=e.ipsec.fragmentation_before_encryption||"",n.customer_gateway_outside_address=e.customer_gateway.tunnel_outside_address.ip_address||"",n.vpn_gateway_outside_address=e.vpn_gateway.tunnel_outside_address.ip_address||"",n.customer_gateway_inside_address=e.customer_gateway.tunnel_inside_address.ip_address+"/"+e.customer_gateway.tunnel_inside_address.network_cidr||"",n.vpn_gateway_inside_address=e.vpn_gateway.tunnel_inside_address.ip_address+"/"+e.customer_gateway.tunnel_inside_address.network_cidr||"",n.next_hop=e.vpn_gateway.tunnel_inside_address.ip_address||"",n.isStaticRouting=!0,e.customer_gateway.bgp&&e.customer_gateway.bgp.asn&&(n.isStaticRouting=!1,n.customer_gateway_bgp_asn=e.customer_gateway.bgp.asn||"",n.vpn_gateway_bgp_asn=e.vpn_gateway.bgp.asn||"",n.neighbor_ip_address=e.vpn_gateway.tunnel_inside_address.ip_address||"",n.customer_gateway_bgp_hold_time=e.customer_gateway.bgp.hold_time||""),n}),r=n.vpnConnectionId||"download_configuration",n=MC.template.configurationDownload(n),'{"download":true, "filecontent":"'+Base64.encode(n)+'", "filename":"'+r+'", "btnname":"'+e.name+'"}'}),"[ "+r.join(",")+" ]"):n):n},i=e.extend({init:function(e){var r,i,s;return s=t.instance().component(e),i=s.getTarget(n.RESTYPE.VGW),r=s.getTarget(n.RESTYPE.CGW),(this.isApp||this.isAppEdit)&&this.getAppData(s.get("appId")),this.set({uid:e,name:"vpn:"+r.get("name"),ips:s.get("routes"),dynamic:r.isDynamic(),tags:s.tags()}),null},updateIps:function(e){return _.each(e,function(t,n){var r;r=MC.getValidCIDR(t),e[n]=r}),t.instance().component(this.get("uid")).set("routes",e),null},getAppData:function(e){var i,o,u,a;return i=(a=r(t.instance().credentialId(),n.RESTYPE.VPN,t.instance().region()).get(e))!=null?a.toJSON():void 0,i=_.clone(i),i&&(u=s([{type:"download_configuration",name:"Download Configuration"}],i),o=JSON.parse(u),o&&o.length>0&&this.set("vpncfg",o[0])),i.vgwTelemetry&&i.vgwTelemetry.item&&(i.vgwTelemetry=_.map(i.vgwTelemetry.item,function(e,t){return e=$.extend(!0,{},e),e.index=t+1,e})),i.isApp=this.isApp,this.set(i)},isCidrConflict:function(e,r){return t.modelClassForType(n.RESTYPE.SUBNET).isCidrConflict(e,r)}}),new i}),define("wspace/awseditor/property/vpn/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.VPN_SUMMARY",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP.CGW_APP_VPN_LBL_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.vpnConnectionId,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP.CGW_APP_VPN_LBL_STATE",{hash:{},data:t}))+'</dt>\n      <dd><i class="status status-xgw-'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'"></i>'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP.CGW_APP_VPN_LBL_TYPE",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.type,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP.CGW_LBL_ROUTING",{hash:{},data:t}))+"</dt>\n      <dd>",i=n["if"].call(e,(i=e&&e.options,i==null||i===!1?i:i.staticRoutesOnly),{hash:{},inverse:f.program(4,h,t),fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+="</dd>\n\n      <a class='btn btn-primary vpn-download' href=\"data:text/plain;base64,",i=(i=(i=e&&e.vpncfg,i==null||i===!1?i:i.filecontent),typeof i===a?i.apply(e):i);if(i||i===0)r+=i;r+='" download="',i=(i=(i=e&&e.vpncfg,i==null||i===!1?i:i.filename),typeof i===a?i.apply(e):i);if(i||i===0)r+=i;r+='.txt" style="padding:8px;">'+u(n.i18n.call(e,"PROP.CGW_APP_TIT_DOWNLOAD_CONF",{hash:{},data:t}))+"</a>\n\n    </dl>\n  </div>\n\n  ",i=n["if"].call(e,e&&e.vgwTelemetry,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+="\n\n\n  ",i=n["if"].call(e,e&&e.isApp,{hash:{},inverse:f.noop,fn:f.program(14,y,t),data:t});if(i||i===0)r+=i;r+="\n\n  ",i=n["if"].call(e,e&&e.isApp,{hash:{},inverse:f.noop,fn:f.program(18,E,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){return u(n.i18n.call(e,"PROP.VPN_STACK_STATIC",{hash:{},data:t}))}function h(e,t){return u(n.i18n.call(e,"PROP.VPN_STACK_DYNAMIC",{hash:{},data:t}))}function p(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.CGW_APP_VPN_LBL_TUNNEL",{hash:{},data:t}))+'</div>\n    <div class="option-group">\n        <table class="table">\n            <thead>\n            <tr>\n                <th style="width:20px">'+u(n.i18n.call(e,"PROP.CGW_APP_VPN_COL_TUNNEL",{hash:{},data:t}))+'</th>\n                <th style="width:100px">'+u(n.i18n.call(e,"PROP.CGW_APP_VPN_COL_IP",{hash:{},data:t}))+"</th>\n            </tr>\n            </thead>\n            <tbody>\n            ",i=n.each.call(e,e&&e.vgwTelemetry,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n            </tbody>\n        </table>\n    </div>\n  ",r}function d(e,t){var r="",i;r+='\n            <tr>\n                <td><i class="status status-'+u((i=e&&e.status,typeof i===a?i.apply(e):i))+' icon-label tooltip"\n                       data-tooltip="',i=n.ifCond.call(e,e&&e.status,"DOWN",{hash:{},inverse:f.program(10,m,t),fn:f.program(8,v,t),data:t});if(i||i===0)r+=i;r+=" since "+u((i=e&&e.lastStatusChange,typeof i===a?i.apply(e):i)),i=n["if"].call(e,e&&e.statusMessage,{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;return r+='"></i>'+u((i=e&&e.index,typeof i===a?i.apply(e):i))+"\n                </td>\n                <td>"+u((i=e&&e.outsideIpAddress,typeof i===a?i.apply(e):i))+"</td>\n            </tr>\n            ",r}function v(e,t){return"DOWN"}function m(e,t){return"UP"}function g(e,t){var n="",r;return n+="because "+u((r=e&&e.statusMessage,typeof r===a?r.apply(e):r)),n}function y(e,t){var r="",i;r+=" ",i=n["if"].call(e,(i=e&&e.routes,i==null||i===!1?i:i.item),{hash:{},inverse:f.noop,fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+=" ",r}function b(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.CGW_APP_VPN_LBL_STATUS_RT",{hash:{},data:t}))+'</div>\n    <div class="option-group">\n        <table class="table">\n            <thead>\n            <tr>\n                <th style="width:100px">'+u(n.i18n.call(e,"PROP.CGW_APP_VPN_COL_IP_PREFIX",{hash:{},data:t}))+'</th>\n                <th style="width:100px">'+u(n.i18n.call(e,"PROP.CGW_APP_VPN_COL_SOURCE",{hash:{},data:t}))+"</th>\n            </tr>\n            </thead>\n            <tbody>\n            ",i=n.each.call(e,(i=e&&e.routes,i==null||i===!1?i:i.item),{hash:{},inverse:f.noop,fn:f.program(16,w,t),data:t});if(i||i===0)r+=i;return r+="\n            </tbody>\n        </table>\n    </div>\n  ",r}function w(e,t){var n="",r;return n+='\n            <tr>\n                <td><i class="status status-'+u((r=e&&e.state,typeof r===a?r.apply(e):r))+' icon-label tooltip" data-tooltip="'+u((r=e&&e.state,typeof r===a?r.apply(e):r))+'"></i>'+u((r=e&&e.destinationCidrBlock,typeof r===a?r.apply(e):r))+"\n                </td>\n                <td>"+u((r=e&&e.source,typeof r===a?r.apply(e):r))+"</td>\n            </tr>\n            ",n}function E(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(19,S,t),data:t});if(i||i===0)r+=i;return r+="\n  ",r}function S(e,t){var r="",i;r+='\n    <div class="option-group-head">\n        '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n    </div>\n    <div class="option-group">\n        ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.program(23,N,t),fn:f.program(20,x,t),data:t});if(i||i===0)r+=i;return r+="\n    </div>\n    ",r}function x(e,t){var r="",i;r+='\n        <table class="table cost-estimation-table">\n            <tbody>\n            ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(21,T,t),data:t});if(i||i===0)r+=i;return r+="\n            </tbody>\n        </table>\n        ",r}function T(e,t){var n="",r;return n+='\n            <tr> <td style="min-width:70px;">'+u((r=t==null||t===!1?t:t.key,typeof r===a?r.apply(e):r))+"</td><td>"+u(typeof e===a?e.apply(e):e)+"</td> </tr>\n            ",n}function N(e,t){var r="";return r+='\n        <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n        ",r}function C(e,t){var r="",i;r+="\n  ",i=n["if"].call(e,e&&e.dynamic,{hash:{},inverse:f.noop,fn:f.program(26,k,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function k(e,t){var r="";return r+='\n    <section class="property-control-group">'+u(n.i18n.call(e,"PROP.VPN_GATEWAY_VPN_DYNAMIC",{hash:{},data:t}))+"</section>\n  ",r}function L(e,t){var r="",i;r+=" ",i=n.unless.call(e,e&&e.dynamic,{hash:{},inverse:f.noop,fn:f.program(29,A,t),data:t});if(i||i===0)r+=i;return r+=" ",r}function A(e,t){var r="",i;r+="\n  ",i=n["if"].call(e,e&&e.vpnConnectionId,{hash:{},inverse:f.noop,fn:f.program(30,O,t),data:t});if(i||i===0)r+=i;r+='\n  <section class="property-control-group">\n    <div class="clearfix">\n      <label class="left" for="property-vpc-ips">'+u(n.i18n.call(e,"PROP.VPN_LBL_IP_PREFIX",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.LBL_REQUIRED",{hash:{},data:t}))+'</span>\n    </div>\n    <div id="property-vpn-ips" class="multi-input" data-max-row="100" data-bind="true">\n      ',i=n.each.call(e,e&&e.ips,{hash:{},inverse:f.program(34,_,t),fn:f.program(32,M,t),data:t});if(i||i===0)r+=i;r+="\n    </div>\n  </section>\n",i=n["if"].call(e,e&&e.vpnConnectionId,{hash:{},inverse:f.noop,fn:f.program(36,D,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function O(e,t){var r="";return r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.CGW_APP_VPN_LBL_STATUS_RT",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n  ',r}function M(e,t){var r="";return r+='\n      <div class="multi-ipt-row">\n        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n        <span class="ipt-wrapper"><input data-ignore="true" data-ignore-regexp="^[0-9./]*$" class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.VPN_TIP_EG_192_168_0_0_16",{hash:{},data:t}))+'" placeholder="'+u(n.i18n.call(e,"PROP.VPN_TIP_EG_192_168_0_0_16",{hash:{},data:t}))+'" value="'+u(typeof e===a?e.apply(e):e)+'" type="text"></span>\n      </div>\n      ',r}function _(e,t){var r="";return r+='\n      <div class="multi-ipt-row">\n        <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n        <span class="ipt-wrapper"><input data-ignore="true" data-empty-remove="true" data-ignore-regexp="^[0-9./]*$" class="input tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.VPN_TIP_EG_192_168_0_0_16",{hash:{},data:t}))+'" placeholder="'+u(n.i18n.call(e,"PROP.VPN_TIP_EG_192_168_0_0_16",{hash:{},data:t}))+'" type="text"></span>\n      </div>\n      ',r}function D(e,t){return" </div> "}function P(e,t){var r="",i;r+='\n  <div class="option-group-head expand">\n    '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n  </div>\n  <div class="option-group">\n    ',i=n["if"].call(e,(i=e&&e.tags,i==null||i===!1?i:i.length),{hash:{},inverse:f.program(42,j,t),fn:f.program(39,H,t),data:t});if(i||i===0)r+=i;return r+='\n    <div class="tags-action">\n\n      <button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>\n    </div>\n  </div>\n",r}function H(e,t){var r="",i;r+='\n    <table class="table cost-estimation-table">\n      <tbody>\n      ',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(40,B,t),data:t});if(i||i===0)r+=i;return r+="\n      </tbody>\n    </table>\n    ",r}function B(e,t){var n="",r;return n+='\n      <tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n      ",n}function j(e,t){var r="";return r+='\n    <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+="<article>\n",o=n["if"].call(t,t&&t.vpnConnectionId,{hash:{},inverse:f.program(25,C,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n.unless.call(t,t&&t.isApp,{hash:{},inverse:f.noop,fn:f.program(28,L,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n.unless.call(t,t&&t.isApp,{hash:{},inverse:f.noop,fn:f.program(38,P,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/vpn/view",["../base/view","./template/stack","i18n!/nls/lang.js","UI.modalplus"],function(e,t,n,r){var i;return i=e.extend({events:{"BEFORE_REMOVE_ROW #property-vpn-ips":"beforeRemoveIP","REMOVE_ROW #property-vpn-ips":"removeIP","ADD_ROW #property-vpn-ips":"addIP","focus #property-vpn-ips input":"onFocusCIDR","keypress #property-vpn-ips input":"onPressCIDR","blur #property-vpn-ips input":"onBlurCIDR"},render:function(){return this.$el.html(t(this.model.attributes)),this.model.attributes.name},addIP:function(){return $("#property-vpn-ips input").last().focus(),null},beforeRemoveIP:function(e){var t;return e.value&&(t=$("#property-vpn-ips").find("input").filter(function(){return this.value.length>0}),t.length<2&&e.preventDefault()),null},removeIP:function(e,t){var n;if(!t)return;return n=[],$("#property-vpn-ips input").each(function(){return n.push($(this).val())}),this.model.updateIps(n),null},onPressCIDR:function(e){return e.keyCode===13&&$(e.currentTarget).blur(),null},onFocusCIDR:function(e){return this.disabledAllOperabilityArea(!0),null},onBlurCIDR:function(e){var t,i,s,o,u,a,f,l,c,h,p,d,v;u=$(e.currentTarget),a=u.val(),f=[],$("#property-vpn-ips input").each(function(){return this.value&&f.push(this.value),null}),t=_.uniq(f);if(!a)u.parents(".multi-ipt-row").siblings().length===0&&(l=n.PROP.VPN_BLUR_CIDR_REQUIRED,s=n.PROP.VPN_BLUR_CIDR_REQUIRED_DESC);else if(!MC.validate("cidr",a))l=sprintf(n.PROP.VPN_BLUR_CIDR_NOT_VALID_IP,a),s=n.PROP.VPN_BLUR_CIDR_NOT_VALID_IP_DESC;else for(p=0,d=t.length;p<d;p++){i=t[p];if(i!==a&&this.model.isCidrConflict(a,i)){l=sprintf(n.PROP.VPN_BLUR_CIDR_CONFLICTS_IP,a),s=n.PROP.VPN_BLUR_CIDR_CONFLICTS_IP_DESC;break}}if(!l){this.model.updateIps(t),this.disabledAllOperabilityArea(!1);return}if((v=this.modal)!=null?!v.isOpen():!void 0)return o=MC.template.setupCIDRConfirm({remove_content:n.PROP.VPN_REMOVE_CONNECTION,main_content:l,desc_content:s}),h=this,this.modal=new r({title:n.IDE.VPN_REMOVE_CONNECTION,width:420,template:o,confirm:{text:"OK",color:"blue"},disableClose:!0,cancel:{hide:!0}}),c=this.modal,$('<a id="cidr-removed" class="link-red left link-modal-danger">'+n.PROP.VPN_REMOVE_CONNECTION+"</a>").appendTo(c.find(".modal-footer")),c.on("confirm",function(){return c.close()}),c.on("close",function(){return u.focus()}),c.on("closed",function(){return u.focus()}),c.find("#cidr-removed").on("click",function(){return Design.instance().component(h.model.get("uid")).remove(),h.disabledAllOperabilityArea(!1),c.close()})}}),new i}),define("wspace/awseditor/property/vpn/main",["../base/main","./model","./view","constant","event"],function(e,t,n,r,i){var s;return s=e.extend({handleTypes:r.RESTYPE.VPN,initStack:function(){return this.view=n,this.model=t,this.model.isApp=!1,this.model.isAppEdit=!1,null},initApp:function(){return this.view=n,this.model=t,this.model.isApp=!0,this.model.isAppEdit=!1,null},initAppEdit:function(){return this.view=n,this.model=t,this.model.isApp=!1,this.model.isAppEdit=!0,null}}),null}),define("wspace/awseditor/property/eni/model",["../base/model","constant","Design","i18n!/nls/lang.js","CloudResources"],function(e,t,n,r,i){var s;return s=e.extend({defaults:{uid:null,isAppEdit:!1},init:function(e){var t,r;return t=n.instance().component(e),r={uid:e,name:t.get("name"),desc:t.get("description"),sourceDestCheck:t.get("sourceDestCheck"),isAppEdit:this.isAppEdit,isGroupMode:this.isGroupMode,attached:t.connections("EniAttachment").length>0,description:t.get("description"),tags:t.tags()},this.set(r),this.getIpList(),this.isAppEdit&&this.getEniGroup(e),null},getIpList:function(){var e;return e=n.instance().component(this.get("uid")).getIpArray(),e[0].unDeletable=!0,this.isAppEdit&&(e[0].editable=!1),this.set("ips",e),null},setEniDesc:function(e){return n.instance().component(this.get("uid")).set("description",e),null},setSourceDestCheck:function(e){return n.instance().component(this.get("uid")).set("sourceDestCheck",e),null},attachEip:function(e,r){return n.instance().component(this.get("uid")).setIp(e,null,null,r),this.attributes.ips[e].hasEip=r,r&&n.modelClassForType(t.RESTYPE.IGW).tryCreateIgw(),null},removeIp:function(e){return n.instance().component(this.get("uid")).removeIp(e),null},getEniGroup:function(e){var r,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x;u=n.instance().component(e),v=i(n.instance().credentialId(),t.RESTYPE.ENI,n.instance().region()),r=(w=v.get(u.get("appId")))!=null?w.toJSON():void 0,d=u.get("name"),f=[{appId:u.get("appId"),name:d+"-0",desc:u.get("description"),status:r?r.status:"Unknown",sourceDestCheck:u.get("sourceDestCheck")?"enabled":"disabled"}],s=u.serverGroupCount(),u.groupMembers().length>s-1?p=u.groupMembers().slice(0,s-1):p=u.groupMembers();for(c=m=0,y=p.length;m<y;c=++m)h=p[c],f.push({name:d+"-"+(c+1),appId:h.appId,status:(v!=null?(E=v.get(h.appId))!=null?E.toJSON():void 0:void 0)?(S=v.get(h.appId))!=null?S.toJSON().status:void 0:"Unknown",isNew:!h.appId,isOld:h.appId&&c+1>=s});while(f.length<s)f.push({name:d+"-"+f.length,isNew:!0,status:"Unknown"});a=0,x=u.groupMembers();for(l=g=0,b=x.length;g<b;l=++g){o=x[l];if(!o.appId)break;a=l+1}return a+=1,f.length>1?(this.set("group",f),a>s?f.increment="-"+(a-s):a<s&&(f.increment="+"+(s-a))):this.set("group",f[0]),this.set("readOnly",!1),null},addIp:function(){var e,t;return e=n.instance().component(this.get("uid")),e.addIp(),t=e.getIpArray(),t[0].unDeletable=!0,this.set("ips",t),null},isValidIp:function(e){return n.instance().component(this.get("uid")).isValidIp(e)},canAddIP:function(){return n.instance().component(this.get("uid")).canAddIp()},setIp:function(e,t,r){return n.instance().component(this.get("uid")).setIp(e,t,r),null}}),new s}),define("wspace/awseditor/property/eni/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function f(e,t){var r="";return r+='\n<article class="property-control-group">'+o(n.i18n.call(e,"PROP.ENI_LBL_ATTACH_WARN",{hash:{},data:t}))+"</article>\n",r}function l(e,t){var r="",i;r+='\n\n<article>\n    <div id="prop-appedit-eni-list" class="expand"></div>\n    <div class="option-group-head expand">'+o(n.i18n.call(e,"PROP.ENI_LBL_DETAIL",{hash:{},data:t}))+'</div>\n    <div class="option-group">\n        <!-- ',i=n.unless.call(e,e&&e.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;r+=' -->\n        <section class="property-control-group" data-bind="true">\n            <label class="left" for="property-eni-desc">'+o(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n            <input id="property-eni-desc" data-type="ascii" data-ignore="true" data-required-rollback="true"\n                   data-ignore-regexp="^[a-zA-Z0-9\\.\\ \\_\\-\\:\\/\\(\\)\\#\\,\\@\\[\\]\\+\\=\\&\\;\\{\\}\\!\\$\\*]*$" maxlength="255"\n                   class="input" value="'+o((i=e&&e.description,typeof i===u?i.apply(e):i))+'"/>\n        </section>\n        <section class="property-control-group">\n            <div class="checkbox">\n                <input id="property-eni-source-check" type="checkbox" ',i=n["if"].call(e,e&&e.sourceDestCheck,{hash:{},inverse:a.noop,fn:a.program(6,h,t),data:t});if(i||i===0)r+=i;r+='\n                />\n                <label for="property-eni-source-check"></label>\n            </div>\n            <label for="property-eni-source-check">'+o(n.i18n.call(e,"PROP.ENI_SOURCE_DEST_CHECK",{hash:{},data:t}))+'</label>\n        </section>\n\n        <section class="property-control-group">\n            <div class="network-list-wrap">\n                <div class="network-list-header">\n                    '+o(n.i18n.call(e,"PROP.ENI_IP_ADDRESS",{hash:{},data:t}))+"\n                    ",i=n.unless.call(e,e&&e.isMesos,{hash:{},inverse:a.noop,fn:a.program(8,p,t),data:t});if(i||i===0)r+=i;r+='\n                </div>\n                <ul class="network-list" id="property-eni-list" data-bind="true">\n                </ul>\n            </div>\n        </section>\n    </div>\n\n    <div class="option-group-head expand">'+o(n.i18n.call(e,"PROP.ENI_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span\n            id="property-head-sg-num"></span>)</span></div>\n    <div class="option-group sg-group"></div>\n\n    <div class="option-group-head expand">\n        '+o(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n    </div>\n    <div class="option-group">\n        ',i=n["if"].call(e,(i=e&&e.tags,i==null||i===!1?i:i.length),{hash:{},inverse:a.program(13,m,t),fn:a.program(10,d,t),data:t});if(i||i===0)r+=i;return r+='\n        <div class="tags-action">\n            \n            <button class="btn open-tag-manager modal-confirm btn-blue">'+o(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>\n        </div>\n    </div>\n</article>\n\n",r}function c(e,t){var r="",i;return r+='\n            <section class="property-control-group" data-bind="true">\n              <label class="left" for="property-eni-desc">'+o(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n              <textarea id="property-eni-desc" data-type="ascii" data-ignore="true" class="input">'+o((i=e&&e.desc,typeof i===u?i.apply(e):i))+"</textarea>\n            </section>\n        ",r}function h(e,t){return'checked="checked" '}function p(e,t){var r="";return r+='\n                    <button id="property-eni-ip-add" class="right btn btn-blue btn-small tooltip"\n                            data-tooltip="'+o(n.i18n.call(e,"PROP.ENI_TIP_ADD_IP_ADDRESS",{hash:{},data:t}))+'">'+o(n.i18n.call(e,"PROP.ENI_ADD_IP",{hash:{},data:t}))+"\n                    </button>\n                    ",r}function d(e,t){var r="",i;r+='\n        <table class="table cost-estimation-table">\n            <tbody>\n            ',i=n.each.call(e,e&&e.tags,{hash:{},inverse:a.noop,fn:a.program(11,v,t),data:t});if(i||i===0)r+=i;return r+="\n            </tbody>\n        </table>\n        ",r}function v(e,t){var n="",r;return n+='\n            <tr> <td style="min-width:70px;">'+o((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===u?r.apply(e):r))+"</td><td>"+o((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===u?r.apply(e):r))+"</td> </tr>\n            ",n}function m(e,t){var r="";return r+='\n        <div class="empty-tag">'+o(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n        ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u="function",a=this;return s=n.unless.call(t,t&&t.attached,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""};return e.template(t)}),define("wspace/awseditor/property/eni/template/eni_list",["handlebars"],function(e){var t=function(e,t,n,r,i){function f(e,t){var r="",i;r+="\n",i=n.unless.call(e,(i=e&&e.group,i==null||i===!1?i:i.length),{hash:{},inverse:a.program(7,p,t),fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function l(e,t){var r="",i;r+='\n<div class="option-group-head ',i=n["if"].call(e,e&&e.readOnly,{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;r+='">'+o(n.i18n.call(e,"PROP.ENI_NETWORK_INTERFACE_SUMMARY",{hash:{},data:t}))+'</div>\n<div class="option-group">\n  <dl class="dl-vertical">\n    <dt>'+o(n.i18n.call(e,"PROP.ENI_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n    <dd>"+o((i=(i=e&&e.group,i==null||i===!1?i:i.name),typeof i===u?i.apply(e):i))+"</dd>\n    <dt>"+o(n.i18n.call(e,"PROP.ENI_ID",{hash:{},data:t}))+"</dt>\n    <dd>"+o((i=(i=e&&e.group,i==null||i===!1?i:i.appId),typeof i===u?i.apply(e):i))+"</dd>\n    <dt>"+o(n.i18n.call(e,"PROP.ENI_STATE",{hash:{},data:t}))+'</dt>\n    <dd><i class="status status-'+o((i=(i=e&&e.group,i==null||i===!1?i:i.status),typeof i===u?i.apply(e):i))+'"></i>'+o((i=(i=e&&e.group,i==null||i===!1?i:i.status),typeof i===u?i.apply(e):i))+"</dd>\n    ",i=n["if"].call(e,(i=e&&e.group,i==null||i===!1?i:i.description),{hash:{},inverse:a.noop,fn:a.program(5,h,t),data:t});if(i||i===0)r+=i;return r+="\n    <dt>"+o(n.i18n.call(e,"PROP.INSTANCE_ENI_SOURCE_DEST_CHECK_DISP",{hash:{},data:t}))+"</dt>\n    <dd>"+o((i=(i=e&&e.group,i==null||i===!1?i:i.sourceDestCheck),typeof i===u?i.apply(e):i))+"</dd>\n  </dl>\n<div>\n\n",r}function c(e,t){return"expand"}function h(e,t){var r="",i;return r+="\n    <dt>"+o(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+"</dt>\n    <dd>"+o((i=(i=e&&e.group,i==null||i===!1?i:i.desc),typeof i===u?i.apply(e):i))+"</dd>\n    ",r}function p(e,t){var r="",i;r+='\n<div class="option-group-head ',i=n["if"].call(e,e&&e.readOnly,{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;r+='">'+o(n.i18n.call(e,"PROP.ENI_NETWORK_INTERFACE_GROUP_MEMBERS",{hash:{},data:t}))+'<span class="property-head-num-wrap">('+o((i=(i=e&&e.group,i==null||i===!1?i:i.length),typeof i===u?i.apply(e):i))+')</span><span class="appedit-head-meta appedit-head-meta-add">'+o((i=(i=e&&e.group,i==null||i===!1?i:i.increment),typeof i===u?i.apply(e):i))+'</span></div>\n<ul class="option-group mega-list-wraper">\n  ',i=n.each.call(e,e&&e.group,{hash:{},inverse:a.noop,fn:a.program(8,d,t),data:t});if(i||i===0)r+=i;return r+="\n</ul>\n",r}function d(e,t){var r="",i;r+='\n    <li>\n      <i class="status status-'+o((i=e&&e.status,typeof i===u?i.apply(e):i))+' icon-label tooltip" data-tooltip="'+o((i=e&&e.status,typeof i===u?i.apply(e):i))+'"></i>'+o((i=e&&e.name,typeof i===u?i.apply(e):i))+"\n      ",i=n["if"].call(e,e&&e.appId,{hash:{},inverse:a.noop,fn:a.program(9,v,t),data:t});if(i||i===0)r+=i;r+="\n      ",i=n["if"].call(e,e&&e.isNew,{hash:{},inverse:a.program(13,g,t),fn:a.program(11,m,t),data:t});if(i||i===0)r+=i;return r+="\n    </li>\n  ",r}function v(e,t){var n="",r;return n+='<span class="subtitle">('+o((r=e&&e.appId,typeof r===u?r.apply(e):r))+")</span>",n}function m(e,t){var r="";return r+='<div class="subtitle subtitle-launch">'+o(n.i18n.call(e,"PROP.ENI_CREATE_AFTER_APPLYING_UPDATES",{hash:{},data:t}))+"</div>\n      ",r}function g(e,t){var r="",i;i=n["if"].call(e,e&&e.isOld,{hash:{},inverse:a.noop,fn:a.program(14,y,t),data:t});if(i||i===0)r+=i;return r+="\n      ",r}function y(e,t){var r="";return r+='<div class="subtitle subtitle-terminate">'+o(n.i18n.call(e,"PROP.ENI_DELETE_AFTER_APPLYING_UPDATES",{hash:{},data:t}))+"</div>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u="function",a=this;return s=n["if"].call(t,t&&t.group,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""};return e.template(t)}),define("wspace/awseditor/property/eni/view",["../base/view","./template/stack","./template/eni_list","i18n!/nls/lang.js"],function(e,t,n,r){var i,s;return s=function(){return null},i=e.extend({events:{"change #property-eni-desc":"setEniDesc","change #property-eni-source-check":"setEniSourceDestCheck","click .toggle-eip":"setEip","click #property-eni-ip-add":"addIp","click #property-eni-list .icon-remove":"removeIp","keyup .input-ip":"syncIPList"},render:function(){var e;return e=this.model.attributes,e.isMesos=Design.instance().opsModel().isMesos(),this.$el.html(t(e)),this.refreshIpList(),$("#prop-appedit-eni-list").html(n(this.model.attributes)),this.bindIpItemValidate(),this.model.attributes.name},setEniDesc:function(e){return this.model.setEniDesc(e.target.value),null},onChangeDesc:function(e){return this.model.setDesc($(e.currentTarget).val())},setEniSourceDestCheck:function(e){return this.model.setSourceDestCheck(e.target.checked),null},addIp:function(){if($("#property-eni-ip-add").hasClass("disabled"))return;return this.model.addIp(),this.refreshIpList(),null},setEip:function(e){var t,n,i,s;return t=$(e.currentTarget),i=t.closest("li").index(),n=!t.hasClass("associated"),n?s=r.PROP.INSTANCE_IP_MSG_4:s=r.PROP.INSTANCE_IP_MSG_3,t.toggleClass("associated",n).attr("data-tooltip",s),this.model.attachEip(i,n),null},removeIp:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.index(),t.remove(),this.model.removeIp(n),this.updateIPAddBtnState(!0),null},syncIPList:function(e){var t,n,r,i,s;i=$("#property-eni-list .input-ip-item"),t=$(e.currentTarget);if(!t.parsley("validate"))return;return s=t.val(),r=t.siblings(".input-ip-prefix").text()+s,n=s==="x"||s==="x.x",this.model.setIp(t.closest(".input-ip-item").index(),r,n),null},refreshIpList:function(e){return $("#property-eni-list").html(MC.template.propertyIpList(this.model.attributes.ips)),this.updateIPAddBtnState(),this.bindIpItemValidate(),null},bindIpItemValidate:function(){var e;return e=this,$(".input-ip").each(function(){var t;return t=$(this),t.parsley("custom",function(n){var r,i,s,o,u,a,f;f=t,i=n,s=f.siblings(".input-ip-prefix").text(),r=s+i,u=s.split("."),o=!1,u.length===4?i==="x"?o=!0:MC.validate("ipaddress",s+i)&&(o=!0):i==="x.x"?o=!0:MC.validate("ipaddress",s+i)&&(o=!0);if(!o)return"Invalid IP address";a=e.model.isValidIp(r);if(a!==!0)return a})})},updateIPAddBtnState:function(e){var t;return e===void 0&&(e=this.model.canAddIP()),e===!0?t="Add IP Address":(_.isString(e)?t=e:t="Cannot add IP address",e=!1),$("#property-eni-ip-add").toggleClass("disabled",!e).data("tooltip",t),null}}),new i}),define("wspace/awseditor/property/eni/app_model",["../base/model","Design","constant","CloudResources"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T;l=[],m=t.instance().component(e);if(!m){i=t.modelClassForType("AWS.VPC.NetworkInterface").allObjects();for(y=0,w=i.length;y<w;y++){o=i[y];if(o.get("appId")===e){m=o,g=o!=null?o.toJSON():void 0;break}S=o.groupMembers();for(d in S){p=S[d];if(p.appId===e){v=+d+1,m=o,g=p;break}}}}else g=m!=null?m.toJSON():void 0;s=r(t.instance().credentialId(),n.RESTYPE.ENI,t.instance().region()),this.isGroupMode?l=[g].concat(m.groupMembers()):l.push(g),f=[];for(h in l){a=l[h],((x=s.get(a.appId))!=null?x.toJSON():void 0)?u=$.extend(!0,{},s.get(a.appId).toJSON()):u={privateIpAddressesSet:[]},T=u.privateIpAddressesSet;for(b=0,E=T.length;b<E;b++)c=T[b],c.primary=c.primary===!0;u.id=a.appId,u.name=a.name?""+a.name+"-0":""+m.get("name")+"-"+(v||h),u.description=m.get("description"),u.idx=v||h,u.sourceDestCheck=u.sourceDestCheck?"enabled":"disabled",f.push(u)}return this.isGroupMode?(this.set("group",_.sortBy(f,"idx")),this.set("readOnly",!0),this.set("isGroupMode",!0),this.set("name",m.get("name"))):(u=f[0],u.readOnly=!0,u.isGroupMode=!1,u.id=e,u.uid=m?m.id:e,this.set(u)),null}}),new i}),define("wspace/awseditor/property/eni/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.ENI_NETWORK_INTERFACE_DETAIL",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP.ENI_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.name,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+"</dt>\n      <dd>"+u(n.emptyStr.call(e,e&&e.description,{hash:{},data:t}))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.ENI_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.networkInterfaceId,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.ENI_STATE",{hash:{},data:t}))+'</dt>\n      <dd><i class="status status-'+u((i=e&&e.status,typeof i===a?i.apply(e):i))+'"></i>'+u((i=e&&e.status,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_ENI_SOURCE_DEST_CHECK_DISP",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.sourceDestCheck,typeof i===a?i.apply(e):i))+'</dd>\n    </dl>\n    <div class="hidden-details">\n      <a href="#" class="toggle-details js-toggle-dropdown" data-toggle="self-only"><span class="details-off">+ '+u(n.i18n.call(e,"PROP.ENI_SHOW_DETAIL",{hash:{},data:t}))+'</span><span class="details-on">- '+u(n.i18n.call(e,"PROP.ENI_HIDE_DETAIL",{hash:{},data:t}))+'</span></a>\n      <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(e,"PROP.ENI_VPC_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+"</dd>\n        <dt>"+u(n.i18n.call(e,"PROP.ENI_SUBNET_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.subnetId,typeof i===a?i.apply(e):i))+"</dd>\n        ",i=n["if"].call(e,e&&e.attachment,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+="\n        <dt>"+u(n.i18n.call(e,"PROP.ENI_MAC_ADDRESS",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.macAddress,typeof i===a?i.apply(e):i))+"</dd>\n        ",i=n["if"].call(e,(i=e&&e.association,i==null||i===!1?i:i.publicDnsName),{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,e&&e.privateDnsName,{hash:{},inverse:f.noop,fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+="\n        ",i=n["if"].call(e,e&&e.ownerId,{hash:{},inverse:f.noop,fn:f.program(8,d,t),data:t});if(i||i===0)r+=i;r+='\n      </dl>\n    </div>\n\n    <table class="table">\n      <tr>\n        <th>'+u(n.i18n.call(e,"PROP.INSTANCE_ENI_IP_ADDRESS",{hash:{},data:t}))+"</th>\n        <th>"+u(n.i18n.call(e,"PROP.INSTANCE_PUBLIC_IP",{hash:{},data:t}))+"</th>\n      </tr>\n      ",i=n.each.call(e,e&&e.privateIpAddressesSet,{hash:{},inverse:f.noop,fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;r+='\n    </table>\n  </div>\n\n  <div class="option-group-head">'+u(n.i18n.call(e,"PROP.ENI_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n\n  ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(17,b,t),data:t});if(i||i===0)r+=i;return r+="\n  ",r}function c(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP.ENI_ATTACHMENT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=e&&e.attachment,i==null||i===!1?i:i.attachmentId),typeof i===a?i.apply(e):i))+"</dd>\n        <dt>"+u(n.i18n.call(e,"PROP.ENI_Attachment_OWNER",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=e&&e.attachment,i==null||i===!1?i:i.instanceOwnerId),typeof i===a?i.apply(e):i))+"</dd>\n        <dt>"+u(n.i18n.call(e,"PROP.ENI_Attachment_STATE",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=e&&e.attachment,i==null||i===!1?i:i.status),typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function h(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_PUBLIC_DNS",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=e&&e.association,i==null||i===!1?i:i.publicDnsName),typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function p(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP.INSTANCE_PRIVATE_DNS",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.privateDnsName,typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function d(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP.ENI_IP_OWNER",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.ownerId,typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function v(e,t){var r="",i;r+="\n      <tr>\n        <td>"+u((i=e&&e.privateIpAddress,typeof i===a?i.apply(e):i)),i=n["if"].call(e,e&&e.primary,{hash:{},inverse:f.noop,fn:f.program(11,m,t),data:t});if(i||i===0)r+=i;r+="</td>\n        <td>",i=n["if"].call(e,(i=e&&e.association,i==null||i===!1?i:i.publicIp),{hash:{},inverse:f.program(15,y,t),fn:f.program(13,g,t),data:t});if(i||i===0)r+=i;return r+="</td>\n      </tr>\n      ",r}function m(e,t){var r="";return r+="<span>("+u(n.i18n.call(e,"PROP.ENI_PRIMARY",{hash:{},data:t}))+")</span>",r}function g(e,t){var n;return u((n=(n=e&&e.association,n==null||n===!1?n:n.publicIp),typeof n===a?n.apply(e):n))}function y(e,t){return"-"}function b(e,t){var r="",i;r+='\n  <div class="option-group-head expand">\n    '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n  </div>\n  <div class="option-group">\n    ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.program(21,S,t),fn:f.program(18,w,t),data:t});if(i||i===0)r+=i;return r+='\n    <div class="tags-action">\n      \n    </div>\n  </div>\n  ',r}function w(e,t){var r="",i;r+='\n    <table class="table cost-estimation-table">\n      <tbody>\n      ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(19,E,t),data:t});if(i||i===0)r+=i;return r+="\n      </tbody>\n    </table>\n    ",r}function E(e,t){var n="",r;return n+='\n      <tr> <td style="min-width:70px;">'+u((r=t==null||t===!1?t:t.key,typeof r===a?r.apply(e):r))+"</td><td>"+u(typeof e===a?e.apply(e):e)+"</td> </tr>\n      ",n}function S(e,t){var r="";return r+='\n    <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app">\n  <div id="prop-appedit-eni-list" class="expand"></div>\n\n  ',o=n.unless.call(t,t&&t.isGroupMode,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/eni/app_view",["../base/view","./template/app","./template/eni_list"],function(e,t,n){var r;return r=e.extend({render:function(){return this.$el.html(t(this.model.attributes)),this.model.isGroupMode&&$("#prop-appedit-eni-list").html(n(this.model.attributes)),this.model.attributes.name}}),new r}),define("wspace/awseditor/property/eni/main",["../base/main","./model","./view","./app_model","./app_view","../sglist/main","event","constant"],function(e,t,n,r,i,s,o,u){var a,f;return f={},f[o.PROPERTY_REFRESH_ENI_IP_LIST]=function(){return this.model.getIpList(),this.view.refreshIpList(),null},a=e.extend({ideEvents:f,handleTypes:[u.RESTYPE.ENI,"component_eni_group"],onUnloadSubPanel:function(e){return s.onUnloadSubPanel(e),null},initStack:function(){return this.model=t,this.model.isAppEdit=!1,this.model.isGroupMode=!1,this.view=n,null},afterLoadStack:function(){if(!this.model.attributes.association)return s.loadModule(this.model)},initApp:function(){return this.model=r,this.model.isGroupMode=this.handle==="component_eni_group",this.view=i,null},afterLoadApp:function(){return this.model.isGroupMode||s.loadModule(this.model),null},initAppEdit:function(){return this.model=t,this.model.isAppEdit=!0,this.view=n,null},afterLoadAppEdit:function(){return s.loadModule(this.model),null}}),null}),define("wspace/awseditor/property/acl/model",["../base/model","Design","constant","CloudResources","i18n!/nls/lang.js"],function(e,t,n,r,i){var s,o,u;return u={0:"Echo Reply(0)",3:"Destination Unreachable(3)",4:"Source Quench(4)",5:"Redirect Message(5)",6:"Alternate Host Address(6)",8:"Echo Request(8)",9:"Router Advertisement(9)",10:"Router Solicitation(10)",11:"Time Exceeded(11)",12:"Parameter Problem: Bad IP header(12)",13:"Timestamp(13)",14:"Timestamp Reply(14)",15:"Information Request(15)",16:"Information Reply(16)",17:"Address Mask Request(17)",18:"Address Mask Reply(18)",30:"Traceroute(30)",31:"Datagram Conversion Error(31)",32:"Mobile Host Redirect(32)",33:"Where Are You(33)",34:"Here I Am(34)",35:"Mobile Registration Request(35)",36:"Mobile Registration Reply(36)",37:"Domain Name Request(37)",38:"Domain Name Reply(38)",39:"SKIP Algorithm Discovery Protocol(39)",40:"Photuris Security Failures(40)","-1":"All(-1)"},o={3:{"-1":"All(-1)",0:"destination network unreachable(0)",1:"destination host unreachable(1)",2:"destination protocol unreachable(2)",3:"destination port unreachable(3)",4:"fragmentation required and DF flag set(4)",5:"source route failed(5)",6:"destination network unknown(6)",7:"destination host unknown(7)",8:"source host isolated(8)",9:"network administratively prohibited(9)",10:"host administratively prohibited(10)",11:"network unreachable for TOS(11)",12:"host unreachable for TOS(12)",13:"communication administratively prohibited(13)"},5:{"-1":"All(-1)",0:"redirect datagram for the network(0)",1:"redirect datagram for the host(1)",2:"redirect datagram for the TOS & network(2)",3:"redirect datagram for the TOS & host(3)"},11:{"-1":"All(-1)",0:"TTL expired transit(0)",1:"fragmentation reasembly time exceeded(1)"},12:{"-1":"All(-1)",0:"pointer indicates the error(0)",1:"missing a required option(1)",2:"bad length(2)"}},s=e.extend({init:function(e){var i,s,o,u,a,f;return i=t.instance().component(e),s={},i.get("appId")&&(s=(f=r(t.instance().credentialId(),n.RESTYPE.ACL,t.instance().region()).get(i.get("appId")))!=null?f.toJSON():void 0),u=_.map(i.connectionTargets("AclAsso"),function(e){return{name:e.get("name"),cidr:e.get("cidr")}}),a={uid:e,isDefault:i.isDefault(),appId:i.get("appId"),name:i.get("name"),vpcId:t.modelClassForType(n.RESTYPE.VPC).theVPC().get("appId"),rules:null,isApp:this.isApp,associations:_.sortBy(u,name),tags:i.tags()},o=$.extend(!0,a,s),this.set(o),this.getRules(),this.sortRules(),null},getRules:function(){var e,n,r;return r=$.extend(!0,[],t.instance().component(this.get("uid")).get("rules")),n=this.get("isDefault"),e=this.isApp,_.each(r,function(t){var r,i,s,a;t.port||(t.port="All");if(t.number===32767)t.number="*",t.readOnly=!0;else if(t.number===100&&n||e)t.readOnly=!0;switch(t.protocol){case-1:t.protocol="ALL";break;case 1:t.protocol="ICMP";break;case 6:t.protocol="TCP";break;case 17:t.protocol="UDP"}t.tooltip="Port";try{t.protocol==="ICMP"?(s=t.port.split("/"),a="",s[0]&&(a=u[s[0]]),r="",s[1]&&(o[s[0]]?r=o[s[0]][s[1]]:r="All(-1)"),a&&!r?t.tooltip="Type: "+a:a&&r&&(t.tooltip="Type: "+a+", "+"Code: "+r)):t.tooltip="Port: "+t.port}catch(f){i=f,void 0}return null}),this.set("rules",r)},sortRules:function(){var e,t;return t=this.get("sortKey")||"number",t==="number"?e=function(e,t){var n,r;n=parseInt(e.number,10)||-1,r=parseInt(t.number,10)||-1;if(n>r)return 1;if(n===r)return 0;if(n<r)return-1}:e=function(e,n){if(e[t]>n[t])return 1;if(e[t]===n[t])return 0;if(e[t]<n[t])return-1},this.attributes.rules=this.attributes.rules.sort(e),null},setSortOption:function(e){return this.set("sortKey",e),this.sortRules(),null},removeAclRule:function(e){return t.instance().component(this.get("uid")).removeRule(e)},addAclRule:function(e){return t.instance().component(this.get("uid")).addRule(e),this.getRules(),this.sortRules(),this.trigger("REFRESH_RULE_LIST"),null},checkRuleNumber:function(e){var n;return e=parseInt(e,10),0<e&&e<32768?this.get("isDefault")&&e===100?i.PARSLEY.RULE_NUMBER_100_HAS_EXISTED:(n=_.find(t.instance().component(this.get("uid")).get("rules"),function(t){return t.number===e}),n?sprintf(i.PARSLEY.RULENUMBER_ALREADY_EXISTS,e):!0):i.PARSLEY.VALID_RULE_NUMBER_1_TO_32767}}),new s}),define("wspace/awseditor/property/acl/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n  <section class="property-control-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP.ACL_APP_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.appId,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP.ACL_APP_IS_DEFAULT",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.isDefault,typeof i===a?i.apply(e):i))+"</dd>\n\n      <dt>"+u(n.i18n.call(e,"PROP.ACL_APP_VPC_ID",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.vpcId,typeof i===a?i.apply(e):i))+"</dd>\n    </dl>\n  </section>\n  ",r}function c(e,t){var r="",i;r+='\n  <section class="property-control-group" data-bind="true">\n    <label class="left" for="property-acl-name">'+u(n.i18n.call(e,"PROP.ACL_LBL_NAME",{hash:{},data:t}))+'</label>\n    <span class="required-input right">'+u(n.i18n.call(e,"PROP.LBL_REQUIRED",{hash:{},data:t}))+'</span>\n    <input class="input" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.isDefault,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+=' id="property-acl-name" maxlength="255" data-ignore="true" data-required-rollback="true"/>\n  </section>\n  ',r}function h(e,t){return'disabled="disabled"'}function p(e,t){var r="";return r+='\n    <a href="#" class="icon-add add-rule tooltip" id="acl-add-rule-icon" data-tooltip=\''+u(n.i18n.call(e,"PROP.ACL_BTN_CREATE_NEW_RULE",{hash:{},data:t}))+"'></a>\n    ",r}function d(e,t){var n="",r;return n+="<li>"+u((r=e&&e.name,typeof r===a?r.apply(e):r))+" ("+u((r=e&&e.cidr,typeof r===a?r.apply(e):r))+")</li>",n}function v(e,t){var r="",i;r+="\n  ",i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(11,m,t),data:t});if(i||i===0)r+=i;return r+="\n  ",r}function m(e,t){var r="",i;r+='\n  <div class="option-group-head">\n      '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n  </div>\n  <div class="option-group">\n    ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.program(15,b,t),fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;return r+='\n    <div class="tags-action">\n\n    </div>\n\n  </div>\n  ',r}function g(e,t){var r="",i;r+='\n    <table class="table cost-estimation-table">\n      <tbody>\n      ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(13,y,t),data:t});if(i||i===0)r+=i;return r+="\n      </tbody>\n    </table>\n    ",r}function y(e,t){var n="",r;return n+='\n      <tr> <td style="min-width:70px;">'+u((r=t==null||t===!1?t:t.key,typeof r===a?r.apply(e):r))+"</td><td>"+u(typeof e===a?e.apply(e):e)+"</td> </tr>\n      ",n}function b(e,t){var r="";return r+='\n    <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n    ",r}function w(e,t){var r="",i;r+='\n  <div class="option-group-head expand">\n    '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n  </div>\n  <div class="option-group">\n    ',i=n["if"].call(e,(i=e&&e.tags,i==null||i===!1?i:i.length),{hash:{},inverse:f.program(15,b,t),fn:f.program(18,E,t),data:t});if(i||i===0)r+=i;return r+='\n    <div class="tags-action">\n      \n      <button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>\n    </div>\n  </div>\n  ",r}function E(e,t){var r="",i;r+='\n    <table class="table cost-estimation-table">\n      <tbody>\n      ',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(19,S,t),data:t});if(i||i===0)r+=i;return r+="\n      </tbody>\n    </table>\n    ",r}function S(e,t){var n="",r;return n+='\n      <tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n      ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+="<article>\n  ",o=n["if"].call(t,t&&t.appId,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n\n  <div class="option-group-head acl-header expand">'+u(n.i18n.call(t,"PROP.ACL_TIT_RULE",{hash:{},data:i}))+'\n    <span class="property-head-num-wrap">(<span id="acl-rule-count">'+u((o=(o=t&&t.rules,o==null||o===!1?o:o.length),typeof o===a?o.apply(t):o))+"</span>)</span>\n    ",o=n.unless.call(t,t&&t.isApp,{hash:{},inverse:f.noop,fn:f.program(6,p,i),data:i});if(o||o===0)s+=o;s+='\n  </div>\n  <div class="option-group">\n    <div class="rule-list-sort property-control-group">\n      <label>'+u(n.i18n.call(t,"PROP.ACL_RULE_SORT_BY",{hash:{},data:i}))+'</label>\n      <div class="selectbox" id="acl-sort-rule-select">\n        <div class="selection">'+u(n.i18n.call(t,"PROP.ACL_RULE_SORT_BY_NUMBER",{hash:{},data:i}))+'</div>\n        <ul class="dropdown" tabindex="-1">\n          <li data-id="number" class="item selected">'+u(n.i18n.call(t,"PROP.ACL_RULE_SORT_BY_NUMBER",{hash:{},data:i}))+'</li>\n          <li data-id="action" class="item">'+u(n.i18n.call(t,"PROP.ACL_RULE_SORT_BY_ACTION",{hash:{},data:i}))+'</li>\n          <li data-id="direction" class="item">'+u(n.i18n.call(t,"PROP.ACL_RULE_SORT_BY_DIRECTION",{hash:{},data:i}))+'</li>\n          <li data-id="source/destination" class="item">'+u(n.i18n.call(t,"PROP.ACL_RULE_SORT_BY_SRC_DEST",{hash:{},data:i}))+'</li>\n        </ul>\n      </div>\n    </div>\n    <ul class="mega-list-wraper acl-rule-list" id="acl-rule-list">'+u((o=t&&t.acl_list,typeof o===a?o.apply(t):o))+'</ul>\n  </div>\n\n  <div class="option-group-head acl-header expand">'+u(n.i18n.call(t,"PROP.ACL_TIT_ASSOC",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="acl-assn-count">'+u((o=(o=t&&t.associations,o==null||o===!1?o:o.length),typeof o===a?o.apply(t):o))+'</span>)</span>\n  </div>\n\n  <ul class="option-group mega-list-wraper">',o=n.each.call(t,t&&t.associations,{hash:{},inverse:f.noop,fn:f.program(8,d,i),data:i});if(o||o===0)s+=o;s+="</ul>\n\n  ",o=n["if"].call(t,t&&t.isApp,{hash:{},inverse:f.program(17,w,i),fn:f.program(10,v,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/acl/template/rule_item",["handlebars"],function(e){var t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<li data-uid="'+o((i=e&&e.id,typeof i===u?i.apply(e):i))+'">\n  <div class="acl-rule-number"><span class="tooltip" data-tooltip=\''+o(n.i18n.call(e,"PROP.ACL_TIP_RULE_NUMBER",{hash:{},data:t}))+"'>"+o((i=e&&e.number,typeof i===u?i.apply(e):i))+'</span></div>\n\n  <div class="acl-rule-details">\n    <div class="rule-list-row">\n      <div class="acl-rule-allow-cb tooltip icon-'+o((i=e&&e.action,typeof i===u?i.apply(e):i))+"\" data-tooltip='",i=n.ifCond.call(e,e&&e.action,"deny",{hash:{},inverse:a.program(4,c,t),fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+="'></div>\n      ",i=n["if"].call(e,e&&e.egress,{hash:{},inverse:a.program(8,p,t),fn:a.program(6,h,t),data:t});if(i||i===0)r+=i;r+='\n      <span class="tooltip" data-tooltip=\''+o(n.i18n.call(e,"PROP.ACL_TIP_CIDR_BLOCK",{hash:{},data:t}))+"'>"+o((i=e&&e.cidr,typeof i===u?i.apply(e):i))+'</span>\n    </div>\n    <div class="rule-list-row">\n      <div><span class="rule-protocol tooltip" data-tooltip=\''+o(n.i18n.call(e,"PROP.ACL_TIP_PROTOCOL",{hash:{},data:t}))+"'>"+o((i=e&&e.protocol,typeof i===u?i.apply(e):i))+'</span></div>\n      <div class="tooltip" data-tooltip=\''+o((i=e&&e.tooltip,typeof i===u?i.apply(e):i))+"'>"+o((i=e&&e.port,typeof i===u?i.apply(e):i))+"</div>\n    </div>\n    ",i=n.unless.call(e,e&&e.readOnly,{hash:{},inverse:a.noop,fn:a.program(10,d,t),data:t});if(i||i===0)r+=i;return r+="\n  </div>\n</li>\n",r}function l(e,t){var r;return r=n.i18n.call(e,"PROP.ACL_TIP_ACTION_DENY",{hash:{},data:t}),r||r===0?r:""}function c(e,t){var r;return r=n.i18n.call(e,"PROP.ACL_TIP_ACTION_ALLOW",{hash:{},data:t}),r||r===0?r:""}function h(e,t){var r="",i;r+='<span class="icon-outbound tooltip" data-tooltip=\'',i=n.i18n.call(e,"PROP.ACL_TIP_OUTBOUND",{hash:{},data:t});if(i||i===0)r+=i;return r+="'></span>\n      ",r}function p(e,t){var r="",i;r+='<span class="icon-inbound tooltip" data-tooltip=\'',i=n.i18n.call(e,"PROP.ACL_TIP_INBOUND",{hash:{},data:t});if(i||i===0)r+=i;return r+="'></span>\n      ",r}function d(e,t){var r="";return r+='<a class="icon-remove rule-remove-icon tooltip" data-tooltip=\''+o(n.i18n.call(e,"PROP.ACL_TIP_REMOVE_RULE",{hash:{},data:t}))+"'></a>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u="function",a=this;return s=n.each.call(t,t,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""};return e.template(t)}),define("wspace/awseditor/property/acl/template/dialog",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n			<li class="item tooltip" data-id="'+a((r=e&&e.cidr,typeof r===u?r.apply(e):r))+'"><div class="main truncate">'+a((r=e&&e.name,typeof r===u?r.apply(e):r))+"</div></li>\n		",n}function c(e,t){var r="";return r+='\n		  <li class="item" data-id="custom">'+a(n.i18n.call(e,"POP_ACLRULE_PROTOCOL_CUSTOM",{hash:{},data:t}))+'</li>\n		  <li class="item" data-id="all">'+a(n.i18n.call(e,"POP_ACLRULE_PROTOCOL_ALL",{hash:{},data:t}))+"</li>\n		  ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="modal-control-group clearfix">\n  <label class="label-short" for="modal-acl-number">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_RULE_NUMBER",{hash:{},data:i}))+'</label>\n  <div class="prefix-input left">\n	<label for="modal-acl-number">#</label>\n	<input class="input" type="text" id="modal-acl-number" required data-ignore="true" data-ignore-regexp="^[0-9]*$" data-required="true" autofocus>\n  </div>\n</div>\n<div class="modal-control-group clearfix">\n	<label class="label-short">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_ACTION",{hash:{},data:i}))+'</label>\n	<div class="radio-group-horizontal">\n		<div class="radio">\n			<input type="radio" id="acl-add-model-action-allow" checked="checked" name="acl-add-model-action-select"/>\n			<label for="acl-add-model-action-allow"></label>\n		</div>\n		<label class="radio-label" for="acl-add-model-action-allow">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_ACTION_ALLOW",{hash:{},data:i}))+'</label>\n	</div>\n	<div class="radio-group-horizontal">\n		<div class="radio">\n			<input type="radio" id="acl-add-model-action-deny" name="acl-add-model-action-select"/>\n			<label for="acl-add-model-action-deny"></label>\n		</div>\n		<label class="radio-label" for="acl-add-model-action-deny">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_ACTION_DENY",{hash:{},data:i}))+'</label>\n	</div>\n</div>\n<div class="modal-control-group clearfix">\n	<label class="label-short">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_DIRECTION",{hash:{},data:i}))+'</label>\n	<div class="radio-group-horizontal">\n		<div class="radio">\n			<input type="radio" id="acl-add-model-direction-inbound" checked="checked" name="acl-add-model-direction-select"/>\n			<label for="acl-add-model-direction-inbound"></label>\n		</div>\n		<label class="radio-label" for="acl-add-model-direction-inbound">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_INBOUND",{hash:{},data:i}))+'</label>\n	</div>\n	<div class="radio-group-horizontal">\n		<div class="radio">\n			<input type="radio" id="acl-add-model-direction-outbound" name="acl-add-model-direction-select"/>\n			<label for="acl-add-model-direction-outbound"></label>\n		</div>\n		<label class="radio-label" for="acl-add-model-direction-outbound">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_OUTBOUND",{hash:{},data:i}))+'</label>\n	</div>\n</div>\n<div class="modal-control-group acl-source-dest clearfix">\n  <label class="label-short" id="acl-add-model-bound-label">'+a(n.i18n.call(t,"POP_ACLRULE_LBL_SOURCE",{hash:{},data:i}))+'</label>\n	<div class="selectbox" id="acl-add-model-source-select">\n		<div class="selection">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_CUSTOM",{hash:{},data:i}))+'</div>\n		<ul class="dropdown">\n		<li class="item tooltip selected" data-id="custom">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_CUSTOM",{hash:{},data:i}))+"</li>\n		",o=n.each.call(t,t&&t.subnets,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n		</ul>\n  </div>\n  <input class="input" type="text" id="modal-acl-source-input" data-ignore="true" data-ignore-regexp="^[0-9./]*$" data-required="true" placeholder=\''+a(n.i18n.call(t,"POP_ACLRULE_PLACEHOLD_SOURCE",{hash:{},data:i}))+'\' >\n</div>\n\n<div class="modal-control-group clearfix">\n  <label class="label-short" >'+a(n.i18n.call(t,"POP_ACLRULE_LBL_PROTOCOL",{hash:{},data:i}))+'</label>\n	  <div class="selectbox modal-protocol-select" id="modal-protocol-select"  data-protocal-type="tcp">\n		<div class="selection">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_TCP",{hash:{},data:i}))+'</div>\n		<ul class="dropdown scroll-wrap scrollbar-auto-hide context-wrap" tabindex="-1">\n		  <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n		  <li class="selected item" data-id="tcp">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_TCP",{hash:{},data:i}))+'</li>\n		  <li class="item" data-id="udp">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_UDP",{hash:{},data:i}))+'</li>\n		  <li class="item" data-id="icmp">'+a(n.i18n.call(t,"POP_ACLRULE_PROTOCOL_ICMP",{hash:{},data:i}))+"</li>\n		  ",o=n.unless.call(t,t&&t.classic,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+='\n		</ul>\n	  </div>\n\n  <div id="sg-protocol-select-result">\n	  <div class="sg-protocol-option-input show" id="sg-protocol-tcp">\n		<input class="input" type="text" placeholder=\''+a(n.i18n.call(t,"POP_ACLRULE_PLACEHOLD_PORT_RANGE",{hash:{},data:i}))+'\' required data-ignore="true" data-ignore-regexp="^[0-9-]*$" data-required="true"/>\n	  </div>\n	  <div class="sg-protocol-option-input" id="sg-protocol-udp">\n		<input class="input" type="text" placeholder=\''+a(n.i18n.call(t,"POP_ACLRULE_PLACEHOLD_PORT_RANGE",{hash:{},data:i}))+'\' required data-ignore="true" data-ignore-regexp="^[0-9-]*$" data-required="true"/>\n	  </div>\n	  <div class="sg-protocol-option-input" id="sg-protocol-icmp">\n		<div class="selectbox" id="protocol-icmp-main-select" data-protocal-main="0"  data-protocal-sub="-1">\n		  <div class="selection">Echo Reply(0)</div>\n		  <div class="dropdown scroll-wrap scrollbar-auto-hide context-wrap" style="height:300px;">\n			<div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n			<ul tabindex="-1" class="scroll-content">\n			  <li class="item selected" data-id="0">Echo Reply(0)</li>\n			  <li class="item" data-id="3">Destination Unreachable(3) ...</li>\n			  <li class="item" data-id="4">Source Quench(4)</li>\n			  <li class="item" data-id="5">Redirect Message(5) ...</li>\n			  <li class="item" data-id="6">Alternate Host Address(6)</li>\n			  <li class="item" data-id="8">Echo Request(8)</li>\n			  <li class="item" data-id="9">Router Advertisement(9)</li>\n			  <li class="item" data-id="10">Router Solicitation(10)</li>\n			  <li class="item" data-id="11">Time Exceeded(11) ...</li>\n			  <li class="item" data-id="12">Parameter Problem: Bad IP header(12) ...</li>\n			  <li class="item" data-id="13">Timestamp(13)</li>\n			  <li class="item" data-id="14">Timestamp Reply(14)</li>\n			  <li class="item" data-id="15">Information Request(15)</li>\n			  <li class="item" data-id="16">Information Reply(16)</li>\n			  <li class="item" data-id="17">Address Mask Request(17)</li>\n			  <li class="item" data-id="18">Address Mask Reply(18)</li>\n			  <li class="item" data-id="30">Traceroute(30)</li>\n			  <li class="item" data-id="31">Datagram Conversion Error(31)</li>\n			  <li class="item" data-id="32">Mobile Host Redirect(32)</li>\n			  <li class="item" data-id="33">Where Are You(33)</li>\n			  <li class="item" data-id="34">Here I Am(34)</li>\n			  <li class="item" data-id="35">Mobile Registration Request(35)</li>\n			  <li class="item" data-id="36">Mobile Registration Reply(36)</li>\n			  <li class="item" data-id="37">Domain Name Request(37)</li>\n			  <li class="item" data-id="38">Domain Name Reply(38)</li>\n			  <li class="item" data-id="39">SKIP Algorithm Discovery Protocol(39)</li>\n			  <li class="item" data-id="40">Photuris Security Failures(40)</li>\n			  <li class="item" data-id="-1">All(-1)</li>\n			</ul>\n		  </div>\n	  </div>\n	  <div class="selectbox protocol-icmp-sub-select" id="protocol-icmp-sub-select-3">\n		<div class="selection">All(-1)</div>\n		<div class="dropdown scroll-wrap scrollbar-auto-hide context-wrap" style="height:300px;">\n			<div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n			<ul class="scroll-content" tabindex="-1">\n			  <li class="item selected" data-id="-1">All(-1)</li>\n			  <li class="item" data-id="0">destination network unreachable(0)</li>\n			  <li class="item" data-id="1">destination host unreachable(1)</li>\n			  <li class="item" data-id="2">destination protocol unreachable(2)</li>\n			  <li class="item" data-id="3">destination port unreachable(3)</li>\n			  <li class="item" data-id="4">fragmentation required and DF flag set(4)</li>\n			  <li class="item" data-id="5">source route failed(5)</li>\n			  <li class="item" data-id="6">destination network unknown(6)</li>\n			  <li class="item" data-id="7">destination host unknown(7)</li>\n			  <li class="item" data-id="8">source host isolated(8)</li>\n			  <li class="item" data-id="9">network administratively prohibited(9)</li>\n			  <li class="item" data-id="10">host administratively prohibited(10)</li>\n			  <li class="item" data-id="11">network unreachable for TOS(11)</li>\n			  <li class="item" data-id="12">host unreachable for TOS(12)</li>\n			  <li class="item" data-id="13">communication administratively prohibited(13)</li>\n			</ul>\n		</div>\n	  </div>\n	  <div class="selectbox protocol-icmp-sub-select" id="protocol-icmp-sub-select-5">\n		<div class="selection">All(-1)</div>\n		<ul class="dropdown" tabindex="-1">\n		  <li class="selected item" data-id="-1">All(-1)</li>\n		  <li class="item" data-id="0">redirect datagram for the network(0)</li>\n		  <li class="item" data-id="1">redirect datagram for the host(1)</li>\n		  <li class="item" data-id="2">redirect datagram for the TOS & network(2)</li>\n		  <li class="item" data-id="3">redirect datagram for the TOS & host(3)</li>\n		</ul>\n	  </div>\n	  <div class="selectbox protocol-icmp-sub-select" id="protocol-icmp-sub-select-11">\n		<div class="selection">All(-1)</div>\n		<ul class="dropdown" tabindex="-1">\n		  <li class="item selected" data-id="-1">All(-1)</li>\n		  <li class="item" data-id="0">TTL expired transit(0)</li>\n		  <li class="item" data-id="1">fragmentation reasembly time exceeded(1)</li>\n		</ul>\n	  </div>\n	  <div class="selectbox protocol-icmp-sub-select" id="protocol-icmp-sub-select-12">\n		<div class="selection">All(-1)</div>\n		<ul class="dropdown" role="menu">\n		  <li class="item selected" data-id="-1">All(-1)</li>\n		  <li class="item" data-id="0">pointer indicates the error(0)</li>\n		  <li class="item" data-id="1">missing a required option(1)</li>\n		  <li class="item" data-id="2">bad length(2)</li>\n		</ul>\n	  </div>\n	  </div>\n	  <div class="sg-protocol-option-input" id="sg-protocol-custom">\n			<input class="input" type="string" value="1" min="1" max="255" required="" required data-ignore="true" data-ignore-regexp="^[0-9-]*$" data-required="true">\n	  </div>\n	  <div class="sg-protocol-option-input" id="sg-protocol-all" required data-ignore="true" data-ignore-regexp="^[0-9-]*$"> '+a(n.i18n.call(t,"POP_ACLRULE_LBL_PORT_RANGE_ALL",{hash:{},data:i}))+' </div>\n  </div>\n  <ul class="simple-protocol-select">\n		<li>SSH</li>\n		<li>SMTP</li>\n		<li>DNS</li>\n		<li>HTTP</li>\n		<li>POP3</li>\n		<li>IMAP</li>\n		<li>LDAP</li>\n		<li>HTTPS</li>\n		<li>SMTPS</li>\n		<li>IMAPS</li>\n		<li>POP3S</li>\n		<li>MS SQL</li>\n		<li>MYSQL</li>\n		<li>RDP</li>\n	</ul>\n</div>',s};return e.template(t)}),define("wspace/awseditor/property/acl/view",["../base/view","Design","constant","./template/stack","./template/rule_item","./template/dialog","i18n!/nls/lang.js","UI.modalplus"],function(e,t,n,r,i,s,o,u){var a;return a=e.extend({events:{"change #property-acl-name":"aclNameChanged","click #acl-add-rule-icon":"showCreateRuleModal","OPTION_CHANGE #acl-sort-rule-select":"sortAclRule","click .acl-rule-details .rule-remove-icon":"removeAclRule"},render:function(){return this.$el.html(r(this.model.attributes)),this.refreshRuleList(),this.model.attributes.name},aclNameChanged:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(MC.aws.aws.checkResName(this.model.get("uid"),n,"ACL"))return this.model.setName(t),this.setTitle(t)},sortAclRule:function(e){var t,n;return t=$("#acl-rule-list"),n=$(e.target).find(".selected").attr("data-id"),this.model.setSortOption(n),this.refreshRuleList(),null},refreshRuleList:function(){return $("#acl-rule-list").html(i(this.model.attributes.rules)),$("#acl-rule-count").text(this.model.attributes.rules.length),null},removeAclRule:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.attr("data-uid"),this.model.removeAclRule(n)&&t.remove(),null},showCreateRuleModal:function(){var e,r;return e=t.modelClassForType(n.RESTYPE.SUBNET),r={classic:!1,subnets:_.map(e.allObjects(),function(e){return{name:e.get("name"),cidr:e.get("cidr")}})},this.modal=new u({title:o.IDE.POP_ACLRULE_TITLE_ADD,width:450,template:s(r),confirm:{text:o.IDE.POP_ACLRULE_BTN_SAVE},compact:!0}),this.modal.on("confirm",_.bind(this.saveRule,this)).tpl.attr("id","modal-acl-rule"),$("#acl-add-model-source-select").on("OPTION_CHANGE",this.modalRuleSourceSelected),$("#modal-protocol-select").on("OPTION_CHANGE",this.modalRuleProtocolSelected),$("#protocol-icmp-main-select").on("OPTION_CHANGE",this.modalRuleICMPSelected),$("#acl-add-model-direction-outbound").on("change",this.changeBoundInModal),$("#acl-add-model-direction-inbound").on("change",this.changeBoundInModal),$(".simple-protocol-select li").on("click",this.clickSimpleProtocolSelect),!1},saveRule:function(){var e,t,n,r,i,s,u,a,f,l,c,h;n=$("#modal-acl-number"),u=$("#modal-acl-number").val(),l=this.model.checkRuleNumber(u),n.parsley("custom",function(e){return _.isString(l)?l:null});if(!n.parsley("validate"))return;c=$("#acl-add-model-source-select").find(".selected").attr("data-id");if(c==="custom"){e=$("#modal-acl-source-input"),e.parsley("custom",function(e){return MC.validate("cidr",e)?null:o.PARSLEY.MUST_BE_CIDR_BLOCK});if(!e.parsley("validate"))return;c=e.val()}t=$("#modal-protocol-select").find(".selected"),f=t.attr("data-id"),h={tcp:{dom:$("#sg-protocol-tcp input"),method:function(e){var t;return t=[],t=MC.validate.portRange(e),t?MC.validate.portValidRange(t)?null:"Port range needs to be a number or a range of numbers between 0 and 65535.":"Must be a valid format of port range."}},udp:{dom:$("#sg-protocol-udp input"),method:function(e){var t;return t=[],t=MC.validate.portRange(e),t?MC.validate.portValidRange(t)?null:"Port range needs to be a number or a range of numbers between 0 and 65535.":"Must be a valid format of port range."}},custom:{dom:$("#sg-protocol-custom input"),method:function(e){return MC.validate.port(e)?null:"Must be a valid format of port."}}};if(h[f]){s=h[f],s.dom.parsley("custom",s.method);if(!s.dom.parsley("validate"))return}return f==="tcp"?(a=$("#sg-protocol-"+f+" input").val(),f="6"):f==="udp"?(a=$("#sg-protocol-"+f+" input").val(),f="17"):f==="icmp"?(i=$("#protocol-icmp-main-select").find(".selected").attr("data-id"),r=$("#protocol-icmp-sub-select-"+i).find(".selected").attr("data-id")||"-1",f="1",a=i+"/"+r):f==="custom"?(f=$("#sg-protocol-"+f+" input").val(),a=""):f==="all"&&(f="-1",a=""),this.model.addAclRule({number:u,action:$("#acl-add-model-action-allow").is(":checked")?"allow":"deny",egress:$("#acl-add-model-direction-outbound").is(":checked"),cidr:c,protocol:f,port:a}),this.modal.close(),null},modalRuleSourceSelected:function(e){var t;return t=$.trim($(e.target).find(".selected").attr("data-id")),t==="custom"?($("#modal-acl-source-input").show(),$("#acl-add-model-source-select .selection").width(68)):($("#modal-acl-source-input").hide(),$("#acl-add-model-source-select .selection").width(322))},modalRuleProtocolSelected:function(e){var t,n,r,i;return r=$(e.target),i=r.find(".selected").attr("data-id"),i&&($("#sg-protocol-custom").hide(),$("#sg-protocol-all").hide(),$("#sg-protocol-select-result .sg-protocol-option-input").hide(),$("#sg-protocol-"+i).show(),t=$("#protocol-icmp-main-select"),n=t.find(".selected").attr("data-id"),n!=="3"&&n!=="5"&&n!=="11"&&n!=="12"&&$(".protocol-icmp-sub-select").hide()),null},modalRuleICMPSelected:function(e){var t,n,r;return t=$(e.target),n=t.find(".selected").attr("data-id"),r=$("#protocol-icmp-sub-select-"+n),$(".protocol-icmp-sub-select").hide(),r.show(),null},changeBoundInModal:function(e){var t;return t=$("#acl-add-model-direction-inbound").prop("checked"),t?$("#acl-add-model-bound-label").text(o.IDE.POP_ACLRULE_LBL_SOURCE):$("#acl-add-model-bound-label").text(o.IDE.POP_ACLRULE_LBL_DEST)},clickSimpleProtocolSelect:function(e){var t,n,r,i;return n=$(e.currentTarget).text(),i=function(e){var t,n;return t=e.toLowerCase(),n=$("#modal-protocol-select"),n.find("li.item").removeClass("selected"),n.find("li.item[data-id="+t+"]").addClass("selected"),n.find(".selection").text(e),n.trigger("OPTION_CHANGE")},t={SSH:22,SMTP:25,DNS:53,HTTP:80,POP3:110,IMAP:143,LDAP:289,HTTPS:443,SMTPS:465,IMAPS:993,POP3S:995,"MS SQL":1433,MYSQL:3306,RDP:3389},r=t[n],n==="DNS"?(i("UDP"),$("#sg-protocol-udp input").val(r)):(i("TCP"),$("#sg-protocol-tcp input").val(r))}}),new a}),define("wspace/awseditor/property/acl/main",["../base/main","./model","./view","event"],function(e,t,n){var r;return t.on("REFRESH_RULE_LIST",function(){return n.refreshRuleList()}),r=e.extend({subPanelID:"ACL",initStack:function(){return this.model=t,this.model.isApp=!1,this.view=n,null},initApp:function(){return this.model=t,this.model.isApp=!0,this.view=n,null},initAppEdit:function(){return this.model=t,this.model.isApp=!1,this.view=n,null}}),null}),define("wspace/awseditor/property/launchconfig/model",["../base/model","constant","Design","CloudResources"],function(e,t,n,r){var i;return i=e.extend({initialize:function(){var e;return e=this,this.on("EC2_KPDOWNLOAD_RETURN",function(t){var n,r;r=t.param[3],n=t.param[4];if(e.get("keyName")!==n)return;return e.trigger("KP_DOWNLOADED",t.resolved_data),null})},init:function(e){var t,r,i,s,o,u;this.lc=n.instance().component(e);if(!this.lc)return!1;r=this.lc.toJSON(),r.uid=e,r.isEditable=this.isAppEdit,r.app_view=n.instance().modeIsAppView(),this.lc.isMesos()&&(o={isMesos:!0,mesosAttr:this.lc.getMesosAttributes(),defaultMesosAttr:this.lc.getDefaultMesosAttributes()},_.extend(r,o)),this.set(r),this.set("displayAssociatePublicIp",!0),this.set("monitorEnabled",!0),this.set("can_set_ebs",this.lc.isEbsOptimizedEnabled()),this.getInstanceType(),this.getAmi(),this.getKeyPair(),i=n.instance(),t=i.get("agent"),this.set("stackAgentEnable",t.enabled);if(this.isApp){this.getAppLaunch(e),s=this.lc.connectionTargets("KeypairUsage")[0],this.set("keyName",s&&s.get("appId")||this.lc.get("keyName")),u=this.lc.getBlockDeviceMapping(),u.length===1&&this.set("rootDevice",u[0]);return}return null},getInstanceType:function(e,t){var r,i,s;return r=this.lc.get("instanceType"),i=n.instance().region(),s=_.map(this.lc.getInstanceType(),function(e){var t;return t=App.model.getInstanceTypeConfig(i),t?(t=t[e].formated_desc,{main:t[0],ecu:t[1],core:t[2],mem:t[3],name:e,selected:r===e}):{}}),this.set("instance_type",s),null},setEbsOptimized:function(e){return this.lc.set("ebsOptimized",e)},setCloudWatch:function(e){return this.lc.set("monitoring",e)},setUserData:function(e){return this.lc.set("userData",e)},setPublicIp:function(e){this.lc.set("publicIp",e);if(e)return n.modelClassForType(t.RESTYPE.IGW).tryCreateIgw()},setInstanceType:function(e){return this.lc.setInstanceType(e),this.lc.isEbsOptimizedEnabled()},getAmi:function(){var e,t,r,i,s,o,u,a;return t=this.get("imageId"),r=n.instance().component(this.get("uid")),e=this.lc.getAmi(),e?i={name:e.name||e.description||e.id,icon:e.osType+"."+e.architecture+"."+e.rootDeviceType+".png"}:i={name:t+" is not available.",icon:"ami-not-available.png",unavailable:!0},this.set("instance_ami",i),e&&e.blockDeviceMapping&&!$.isEmptyObject(e.blockDeviceMapping)&&(u=e.rootDeviceName,o=e.blockDeviceMapping[u],u&&!o&&(_.each(e.blockDeviceMapping,function(e,t){if(u.indexOf(t)!==-1&&!o)return o=e,u=t,null}),null),s=r.get("rdType"),a={name:u,size:parseInt(r.get("rdSize"),10),iops:r.get("rdIops"),isStandard:s==="standard",isIo1:s==="io1",isGp2:s==="gp2"},a.size<10&&(a.iops="",a.iopsDisabled=!0),this.set("rootDevice",a)),this.set("min_volume_size",r.getAmiRootDeviceVolumeSize()),null},getKeyPair:function(){var e;return e=n.instance().component(this.get("uid")).connectionTargets("KeypairUsage")[0],e&&this.set("keypair",e.getKPList()),null},addKP:function(e){var r,i,s,o,u;r=n.modelClassForType(t.RESTYPE.KP),u=r.allObjects();for(s=0,o=u.length;s<o;s++){i=u[s];if(i.get("name")===e)return!1}return i=new r({name:e}),i.id},setKP:function(e){var t,r;return t=n.instance(),r=t.component(this.get("uid")),t.component(e).assignTo(r),null},isSGListReadOnly:function(){if(this.get("appId"))return!0},getAppLaunch:function(e){var i,s;return i=(s=r(n.instance().credentialId(),t.RESTYPE.LC,n.instance().region()).get(this.lc.get("appId")))!=null?s.toJSON():void 0,this.set("ebsOptimized",this.lc.get("ebsOptimized")+""),this.set("name",this.lc.get("name")),this.set("lc",i),this.set("uid",e),null},getStateData:function(){return n.instance().component(this.get("uid")).getStateData()},setIops:function(e){return n.instance().component(this.get("uid")).set("rdIops",e),null},setVolumeType:function(e){return n.instance().component(this.get("uid")).set("rdType",e),null},setVolumeSize:function(e){return n.instance().component(this.get("uid")).set("rdSize",e),null}}),new i}),define("wspace/awseditor/property/launchconfig/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return'style="color:red;"'}function c(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left">'+f(n.i18n.call(e,"PROP.INSTANCE_TYPE",{hash:{},data:t}))+'</label>\n			<div class="selectbox selectbox-mega" id="instance-type-select">\n				<div class="selection"></div>\n				<ul class="dropdown">\n					',i=n.each.call(e,e&&e.instance_type,{hash:{},inverse:u.noop,fn:u.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n				</ul>\n			</div>\n		</section>\n		",r}function h(e,t){var r="",i;r+='\n					<li class="',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(5,p,t),data:t});if(i||i===0)r+=i;return r+='tooltip item" data-tooltip="'+f((i=e&&e.main,typeof i===a?i.apply(e):i))+'" data-id="'+f((i=e&&e.name,typeof i===a?i.apply(e):i))+'">\n						<div class="main  truncate">'+f((i=e&&e.main,typeof i===a?i.apply(e):i))+'</div>\n						<div class="sub"><span>'+f((i=e&&e.ecu,typeof i===a?i.apply(e):i))+"</span> <span>"+f((i=e&&e.core,typeof i===a?i.apply(e):i))+"</span> <span>"+f((i=e&&e.mem,typeof i===a?i.apply(e):i))+"</span></div>\n					</li>\n					",r}function p(e,t){return"selected "}function d(e,t){return"hide"}function v(e,t){return'\n				<input id="property-instance-ebs-optimized" type="checkbox" value="None" checked="true" name="ebs-optimized" />\n				'}function m(e,t){return'\n				<input id="property-instance-ebs-optimized" type="checkbox" value="None" name="ebs-optimized" />\n				'}function g(e,t){var r="",i;r+='\n			<section class="property-control-group">\n				<div class="checkbox">\n					<input id="property-instance-public-ip" type="checkbox" ',i=n["if"].call(e,e&&e.publicIp,{hash:{},inverse:u.noop,fn:u.program(14,y,t),data:t});if(i||i===0)r+=i;return r+=' value="None" name="property-instance-public-ip" />\n					<label for="property-instance-public-ip"></label>\n				</div>\n				<label for="property-instance-public-ip">'+f(n.i18n.call(e,"PROP.INSTANCE_ENI_AUTO_PUBLIC_IP",{hash:{},data:t}))+"</label>\n			</section>\n		",r}function y(e,t){return'checked="checked"'}function b(e,t){var r;return r=n["if"].call(e,e&&e.monitoring,{hash:{},inverse:u.noop,fn:u.program(17,w,t),data:t}),r||r===0?r:""}function w(e,t){return'checked="true"'}function E(e,t){return'disabled="disabled"'}function S(e,t){var r="";return r+='\n			<div class="property-info">'+f(n.i18n.call(e,"PROP.INSTANCE_USERDATA_DISABLED_TO_INSTALL_VISUALOPS",{hash:{},data:t}))+"</div>\n			",r}function x(e,t){var r="",i;return r+='\n				<label for="property-instance-user-data">'+f(n.i18n.call(e,"PROP.INSTANCE_USER_DATA",{hash:{},data:t}))+'</label>\n				<textarea id="property-instance-user-data">'+f((i=e&&e.userData,typeof i===a?i.apply(e):i))+"</textarea>\n			",r}function T(e,t){var r="",i;r+='\n	<div class="option-group-head">Root Device</div>\n	<div class="option-group">\n    <section class="property-control-group">\n      <label>'+f(n.i18n.call(e,"PROP.VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</label>\n      <div>"+f((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.name),typeof i===a?i.apply(e):i))+'</div>\n    </section>\n    <section class="property-control-group">\n      <label>'+f(n.i18n.call(e,"PROP.VOLUME_SIZE",{hash:{},data:t}))+'</label>\n      <div class="ranged-number-input">\n          <label for="volume-size-ranged"></label>\n          <input id="volume-size-ranged" type="text" class="input" value="'+f((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.size),typeof i===a?i.apply(e):i))+'" name="volume-size-ranged" data-ignore="true" maxlength="5" data-required="true" data-required="true" data-type="number"/>\n      <label for="volume-size-ranged" >GB</label>\n      </div>\n    </section>\n\n    <section class="property-control-group">\n        <label>'+f(n.i18n.call(e,"PROP.VOLUME_TYPE",{hash:{},data:t}))+'</label>\n        <div id="volume-type-radios">\n          <div>\n             <div class="radio">\n                  <input id="radio-standard" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isStandard),{hash:{},inverse:u.noop,fn:u.program(14,y,t),data:t});if(i||i===0)r+=i;r+=' value="standard" />\n                  <label for="radio-standard"></label>\n              </div>\n              <label for="radio-standard">'+f(n.i18n.call(e,"PROP.VOLUME_TYPE_STANDARD",{hash:{},data:t}))+'</label>\n          </div>\n          <div>\n             <div class="radio">\n                  <input id="radio-gp2" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isGp2),{hash:{},inverse:u.noop,fn:u.program(14,y,t),data:t});if(i||i===0)r+=i;r+=' value="gp2" />\n                  <label for="radio-gp2"></label>\n              </div>\n              <label for="radio-gp2">'+f(n.i18n.call(e,"PROP.VOLUME_TYPE_GP2",{hash:{},data:t}))+"</label>\n          </div>\n          <div ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:u.noop,fn:u.program(26,N,t),data:t});if(i||i===0)r+=i;r+=' data-tooltip="'+f(n.i18n.call(e,"PROP.VOLUME_MSG_WARN",{hash:{},data:t}))+'">\n            <div class="radio">\n              <input id="radio-io1" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isIo1),{hash:{},inverse:u.noop,fn:u.program(14,y,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:u.noop,fn:u.program(28,C,t),data:t});if(i||i===0)r+=i;r+=' value="io1" />\n              <label for="radio-io1"></label>\n            </div>\n            <label for="radio-io1">'+f(n.i18n.call(e,"PROP.VOLUME_TYPE_IO1",{hash:{},data:t}))+'</label>\n          </div>\n        </div>\n    </section>\n\n    <section class="property-control-group" id="iops-group" ',i=n.unless.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isIo1),{hash:{},inverse:u.noop,fn:u.program(30,k,t),data:t});if(i||i===0)r+=i;r+='>\n        <label>IOPS</label>\n        <div class="ranged-number-input">\n          <label for="iops-ranged"></label>\n          <input id="iops-ranged" type="text" class="input" min="100" max="2000" value="'+f((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),typeof i===a?i.apply(e):i))+'">\n        </div>\n    </section>\n\n<!--     <section class="property-control-group">\n        <label>'+f(n.i18n.call(e,"PROP.VOLUME_ENCRYPTED",{hash:{},data:t}))+"</label>\n        <div>",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.encrypted),{hash:{},inverse:u.program(34,A,t),fn:u.program(32,L,t),data:t});if(i||i===0)r+=i;return r+="</div>\n    </section> -->\n\n	</div>\n  ",r}function N(e,t){return'class="tooltip"'}function C(e,t){return"disabled"}function k(e,t){return'style="display:none"'}function L(e,t){return"Yes"}function A(e,t){return"No"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<article>\n\n	<div class="option-group-head expand">'+f(n.i18n.call(t,"PROP.LC_TITLE",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-instance-name" >'+f(n.i18n.call(t,"PROP.LC_NAME",{hash:{},data:i}))+'</label>\n			<span class="required-input right">'+f(n.i18n.call(t,"PROP.INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n			<input class="input launch-configuration-name"  type="text" value="'+f((o=t&&t.name,typeof o===a?o.apply(t):o))+'" name="property-instance-name" id="property-instance-name" maxlength="240" data-required-rollback="true" data-ignore="true"/>\n		</section>\n        <section class="property-control-group" data-bind="true">\n            <label class="left" for="property-res-desc">'+f(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+'</label>\n            <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+f((o=t&&t.description,typeof o===a?o.apply(t):o))+'</textarea>\n        </section>\n		<section class="property-control-group">\n			<label>'+f(n.i18n.call(t,"PROP.INSTANCE_AMI",{hash:{},data:i}))+'</label>\n			<div id="property-ami" class="property-block-wrap clearfix" data-uid="'+f((o=t&&t.imageId,typeof o===a?o.apply(t):o))+'">\n				<img class="property-ami-icon left" src="/assets/images/ide/ami/'+f((o=(o=t&&t.instance_ami,o==null||o===!1?o:o.icon),typeof o===a?o.apply(t):o))+'" / >\n				<div class="property-ami-label" ',o=n["if"].call(t,(o=t&&t.instance_ami,o==null||o===!1?o:o.unavailable),{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+=">"+f((o=(o=t&&t.instance_ami,o==null||o===!1?o:o.name),typeof o===a?o.apply(t):o))+"</div>\n			</div>\n		</section>\n		",o=n["if"].call(t,(o=t&&t.instance_type,o==null||o===!1?o:o.length),{hash:{},inverse:u.noop,fn:u.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n		<section class="property-control-group ',o=n.unless.call(t,t&&t.can_set_ebs,{hash:{},inverse:u.noop,fn:u.program(7,d,i),data:i});if(o||o===0)s+=o;s+='">\n			<div class="checkbox">\n				',o=n["if"].call(t,t&&t.ebsOptimized,{hash:{},inverse:u.program(11,m,i),fn:u.program(9,v,i),data:i});if(o||o===0)s+=o;s+='\n				<label for="property-instance-ebs-optimized"></label>\n			</div>\n			<label for="property-instance-ebs-optimized">'+f(n.i18n.call(t,"PROP.INSTANCE_EBS_OPTIMIZED",{hash:{},data:i}))+'</label>\n		</section>\n		<section class="property-control-group">\n			<label class="left">'+f(n.i18n.call(t,"PROP.INSTANCE_KEY_PAIR",{hash:{},data:i}))+'</label>\n			<i class="icon-info tooltip default-kp-info" data-tooltip="'+f(n.i18n.call(t,"POP_INSTANCE_KEYPAIR_INFO_TIP",{hash:{},data:i}))+'"></i>\n            <div id="kp-placeholder"></div>\n		</section>\n		',o=n["if"].call(t,t&&t.displayAssociatePublicIp,{hash:{},inverse:u.noop,fn:u.program(13,g,i),data:i});if(o||o===0)s+=o;s+='\n	</div>\n\n	<div class="option-group-head">'+f(n.i18n.call(t,"PROP.INSTANCE_ADVANCED_DETAIL",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group">\n			<div class="checkbox">\n				<input id="property-instance-enable-cloudwatch" type="checkbox" ',o=n["if"].call(t,t&&t.monitorEnabled,{hash:{},inverse:u.program(19,E,i),fn:u.program(16,b,i),data:i});if(o||o===0)s+=o;s+=' value="None" name="property-instance-enable-cloudwatch" />\n				<label for="property-instance-enable-cloudwatch"></label>\n			</div>\n			<label for="property-instance-enable-cloudwatch">'+f(n.i18n.call(t,"PROP.INSTANCE_CW_ENABLED",{hash:{},data:i}))+'</label>\n\n			<p class="',o=n.unless.call(t,t&&t.monitoring,{hash:{},inverse:u.noop,fn:u.program(7,d,i),data:i});if(o||o===0)s+=o;s+=' property-info" id="property-cloudwatch-warn">'+f(n.i18n.call(t,"PROP.INSTANCE_CW_WARN",{hash:{},data:i}))+'<a target="_blank" href="http://aws.amazon.com/cloudwatch">'+f(n.i18n.call(t,"PROP.INSTANCE_WATCH_LINK_TEXT",{hash:{},data:i}))+'</a></p>\n		</section>\n		<section class="property-control-group">\n			',o=n["if"].call(t,t&&t.stackAgentEnable,{hash:{},inverse:u.program(23,x,i),fn:u.program(21,S,i),data:i});if(o||o===0)s+=o;s+="\n		</section>\n	</div>\n\n	",o=n["if"].call(t,t&&t.rootDevice,{hash:{},inverse:u.noop,fn:u.program(25,T,i),data:i});if(o||o===0)s+=o;return s+='\n\n	<div class="option-group-head">'+f(n.i18n.call(t,"PROP.INSTANCE_SG_DETAIL",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n</article>',s};return e.template(t)}),define("wspace/awseditor/property/launchconfig/template/stack_mesos",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n    <div class="option-group-head expand">Mesos Settings</div>\n    <div class="option-group">\n        <section class="property-control-group" data-bind="true">\n            <label>Default Attributes</label>\n            <table class="table">\n                <tr>\n                    <th>Key</th><th>Value</th>\n                </tr>\n                ',i=n.each.call(e,e&&e.defaultMesosAttr,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+='\n            </table>\n        </section>\n\n        <section class="property-control-group" data-bind="true">\n            <label>Custom Attributes <a href="#" class="icon-add" id="add-ma-item-outside"></a></label>\n            <div id="mesos-attribute" class="multi-input">\n                <div class="multi-ipt-row template">\n                    <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                    <span class="ipt-wrapper">\n                        <input class="input mesos-attr ipt-half" type="text" data-name="key" placeholder="key" required/>\n                        <input class="input mesos-attr ipt-half" type="text" data-name="value" placeholder="value" required/>\n                    </span>\n                </div>\n                ',i=n.each.call(e,e&&e.mesosAttr,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n            </div>\n        </section>\n    </div>\n    ",r}function c(e,t){var n="",r;return n+="\n                <tr>\n                    <td>"+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</td>\n                    <td>"+a(typeof e===u?e.apply(e):e)+"</td>\n                </tr>\n                ",n}function h(e,t){var r="",i;r+='\n                <div class="multi-ipt-row">\n                    <span class="ipt-controls"><a href="#" class="icon-del"></a><a href="#" class="icon-add"></a></span>\n                    <span class="ipt-wrapper">\n                        <input class="input mesos-attr ipt-half" type="text" data-name="key" value="'+a((i=t==null||t===!1?t:t.key,typeof i===u?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.readonly,{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;r+=' placeholder="key" required/>\n                        <input class="input mesos-attr ipt-half" type="text" data-name="value" value="'+a(typeof e===u?e.apply(e):e)+'" ',i=n["if"].call(e,e&&e.readonly,{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;return r+=' placeholder="value" required/>\n                    </span>\n                </div>\n                ',r}function p(e,t){return"disabled"}function d(e,t){var r="",i;r+='\n		<section class="property-control-group">\n			<label class="left">'+a(n.i18n.call(e,"PROP.INSTANCE_TYPE",{hash:{},data:t}))+'</label>\n			<div class="selectbox selectbox-mega" id="instance-type-select">\n				<div class="selection"></div>\n				<ul class="dropdown">\n					',i=n.each.call(e,e&&e.instance_type,{hash:{},inverse:f.noop,fn:f.program(8,v,t),data:t});if(i||i===0)r+=i;return r+="\n				</ul>\n			</div>\n		</section>\n		",r}function v(e,t){var r="",i;r+='\n					<li class="',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:f.noop,fn:f.program(9,m,t),data:t});if(i||i===0)r+=i;return r+='tooltip item" data-tooltip="'+a((i=e&&e.main,typeof i===u?i.apply(e):i))+'" data-id="'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+'">\n						<div class="main  truncate">'+a((i=e&&e.main,typeof i===u?i.apply(e):i))+'</div>\n						<div class="sub"><span>'+a((i=e&&e.ecu,typeof i===u?i.apply(e):i))+"</span> <span>"+a((i=e&&e.core,typeof i===u?i.apply(e):i))+"</span> <span>"+a((i=e&&e.mem,typeof i===u?i.apply(e):i))+"</span></div>\n					</li>\n					",r}function m(e,t){return"selected "}function g(e,t){return"hide"}function y(e,t){return'\n				<input id="property-instance-ebs-optimized" type="checkbox" value="None" checked="true" name="ebs-optimized" />\n				'}function b(e,t){return'\n				<input id="property-instance-ebs-optimized" type="checkbox" value="None" name="ebs-optimized" />\n				'}function w(e,t){var r="",i;r+='\n			<section class="property-control-group">\n				<div class="checkbox">\n					<input id="property-instance-public-ip" type="checkbox"  disabled="disabled" ',i=n["if"].call(e,e&&e.publicIp,{hash:{},inverse:f.noop,fn:f.program(18,E,t),data:t});if(i||i===0)r+=i;return r+=' value="None" name="property-instance-public-ip" />\n					<label for="property-instance-public-ip"></label>\n				</div>\n				<label for="property-instance-public-ip">'+a(n.i18n.call(e,"PROP.INSTANCE_ENI_AUTO_PUBLIC_IP",{hash:{},data:t}))+"</label>\n			</section>\n		",r}function E(e,t){return'checked="checked"'}function S(e,t){var r;return r=n["if"].call(e,e&&e.monitoring,{hash:{},inverse:f.noop,fn:f.program(21,x,t),data:t}),r||r===0?r:""}function x(e,t){return'checked="true"'}function T(e,t){return'disabled="disabled"'}function N(e,t){var r="";return r+='\n			<div class="property-info">'+a(n.i18n.call(e,"PROP.INSTANCE_USERDATA_DISABLED_TO_INSTALL_VISUALOPS",{hash:{},data:t}))+"</div>\n			",r}function C(e,t){var r="",i;return r+='\n				<label for="property-instance-user-data">'+a(n.i18n.call(e,"PROP.INSTANCE_USER_DATA",{hash:{},data:t}))+'</label>\n				<textarea id="property-instance-user-data">'+a((i=e&&e.userData,typeof i===u?i.apply(e):i))+"</textarea>\n			",r}function k(e,t){var r="",i;r+='\n	<div class="option-group-head">Root Device</div>\n	<div class="option-group">\n    <section class="property-control-group">\n      <label>'+a(n.i18n.call(e,"PROP.VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</label>\n      <div>"+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.name),typeof i===u?i.apply(e):i))+'</div>\n    </section>\n    <section class="property-control-group">\n      <label>'+a(n.i18n.call(e,"PROP.VOLUME_SIZE",{hash:{},data:t}))+'</label>\n      <div class="ranged-number-input">\n          <label for="volume-size-ranged"></label>\n          <input id="volume-size-ranged" type="text" class="input" value="'+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.size),typeof i===u?i.apply(e):i))+'" name="volume-size-ranged" data-ignore="true" maxlength="4" data-required="true" data-required="true" data-type="number"/>\n      <label for="volume-size-ranged" >GB</label>\n      </div>\n    </section>\n\n    <section class="property-control-group">\n        <label>'+a(n.i18n.call(e,"PROP.VOLUME_TYPE",{hash:{},data:t}))+'</label>\n        <div id="volume-type-radios">\n          <div>\n             <div class="radio">\n                  <input id="radio-standard" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isStandard),{hash:{},inverse:f.noop,fn:f.program(18,E,t),data:t});if(i||i===0)r+=i;r+=' value="standard" />\n                  <label for="radio-standard"></label>\n              </div>\n              <label for="radio-standard">'+a(n.i18n.call(e,"PROP.VOLUME_TYPE_STANDARD",{hash:{},data:t}))+'</label>\n          </div>\n          <div>\n             <div class="radio">\n                  <input id="radio-gp2" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isGp2),{hash:{},inverse:f.noop,fn:f.program(18,E,t),data:t});if(i||i===0)r+=i;r+=' value="gp2" />\n                  <label for="radio-gp2"></label>\n              </div>\n              <label for="radio-gp2">'+a(n.i18n.call(e,"PROP.VOLUME_TYPE_GP2",{hash:{},data:t}))+"</label>\n          </div>\n          <div ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:f.noop,fn:f.program(30,L,t),data:t});if(i||i===0)r+=i;r+=' data-tooltip="'+a(n.i18n.call(e,"PROP.VOLUME_MSG_WARN",{hash:{},data:t}))+'">\n            <div class="radio">\n              <input id="radio-io1" type="radio" name="volume-type" ',i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isIo1),{hash:{},inverse:f.noop,fn:f.program(18,E,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.iopsDisabled),{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;r+=' value="io1" />\n              <label for="radio-io1"></label>\n            </div>\n            <label for="radio-io1">'+a(n.i18n.call(e,"PROP.VOLUME_TYPE_IO1",{hash:{},data:t}))+'</label>\n          </div>\n        </div>\n    </section>\n\n    <section class="property-control-group" id="iops-group" ',i=n.unless.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.isIo1),{hash:{},inverse:f.noop,fn:f.program(32,A,t),data:t});if(i||i===0)r+=i;r+='>\n        <label>IOPS</label>\n        <div class="ranged-number-input">\n          <label for="iops-ranged"></label>\n          <input id="iops-ranged" type="text" class="input" min="100" max="2000" value="'+a((i=(i=e&&e.rootDevice,i==null||i===!1?i:i.iops),typeof i===u?i.apply(e):i))+'">\n        </div>\n    </section>\n\n<!--     <section class="property-control-group">\n        <label>'+a(n.i18n.call(e,"PROP.VOLUME_ENCRYPTED",{hash:{},data:t}))+"</label>\n        <div>",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.encrypted),{hash:{},inverse:f.program(36,M,t),fn:f.program(34,O,t),data:t});if(i||i===0)r+=i;return r+="</div>\n    </section> -->\n\n	</div>\n  ",r}function L(e,t){return'class="tooltip"'}function A(e,t){return'style="display:none"'}function O(e,t){return"Yes"}function M(e,t){return"No"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+="<article>\n    ",o=n["if"].call(t,t&&t.isMesos,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n	<div class="option-group-head expand">'+a(n.i18n.call(t,"PROP.LC_TITLE",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group" data-bind="true">\n			<label class="left" for="property-instance-name" >'+a(n.i18n.call(t,"PROP.LC_NAME",{hash:{},data:i}))+'</label>\n			<span class="required-input right">'+a(n.i18n.call(t,"PROP.INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n			<input class="input launch-configuration-name"  type="text" value="'+a((o=t&&t.name,typeof o===u?o.apply(t):o))+'" name="property-instance-name" id="property-instance-name" maxlength="240" data-required-rollback="true" data-ignore="true"/>\n		</section>\n\n    <section class="property-control-group" data-bind="true">\n        <label class="left" for="property-res-desc">'+a(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+'</label>\n        <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+a((o=t&&t.description,typeof o===u?o.apply(t):o))+"</textarea>\n    </section>\n\n		",o=n["if"].call(t,(o=t&&t.instance_type,o==null||o===!1?o:o.length),{hash:{},inverse:f.noop,fn:f.program(7,d,i),data:i});if(o||o===0)s+=o;s+='\n		<section class="property-control-group ',o=n.unless.call(t,t&&t.can_set_ebs,{hash:{},inverse:f.noop,fn:f.program(11,g,i),data:i});if(o||o===0)s+=o;s+='">\n			<div class="checkbox">\n				',o=n["if"].call(t,t&&t.ebsOptimized,{hash:{},inverse:f.program(15,b,i),fn:f.program(13,y,i),data:i});if(o||o===0)s+=o;s+='\n				<label for="property-instance-ebs-optimized"></label>\n			</div>\n			<label for="property-instance-ebs-optimized">'+a(n.i18n.call(t,"PROP.INSTANCE_EBS_OPTIMIZED",{hash:{},data:i}))+'</label>\n		</section>\n		<section class="property-control-group">\n			<label class="left">'+a(n.i18n.call(t,"PROP.INSTANCE_KEY_PAIR",{hash:{},data:i}))+'</label>\n			<i class="icon-info tooltip default-kp-info" data-tooltip="'+a(n.i18n.call(t,"POP_INSTANCE_KEYPAIR_INFO_TIP",{hash:{},data:i}))+'"></i>\n            <div id="kp-placeholder"></div>\n		</section>\n		',o=n["if"].call(t,t&&t.displayAssociatePublicIp,{hash:{},inverse:f.noop,fn:f.program(17,w,i),data:i});if(o||o===0)s+=o;s+='\n	</div>\n\n	<div class="option-group-head">'+a(n.i18n.call(t,"PROP.INSTANCE_ADVANCED_DETAIL",{hash:{},data:i}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group">\n			<div class="checkbox">\n				<input id="property-instance-enable-cloudwatch" type="checkbox" ',o=n["if"].call(t,t&&t.monitorEnabled,{hash:{},inverse:f.program(23,T,i),fn:f.program(20,S,i),data:i});if(o||o===0)s+=o;s+=' value="None" name="property-instance-enable-cloudwatch" />\n				<label for="property-instance-enable-cloudwatch"></label>\n			</div>\n			<label for="property-instance-enable-cloudwatch">'+a(n.i18n.call(t,"PROP.INSTANCE_CW_ENABLED",{hash:{},data:i}))+'</label>\n\n			<p class="',o=n.unless.call(t,t&&t.monitoring,{hash:{},inverse:f.noop,fn:f.program(11,g,i),data:i});if(o||o===0)s+=o;s+=' property-info" id="property-cloudwatch-warn">'+a(n.i18n.call(t,"PROP.INSTANCE_CW_WARN",{hash:{},data:i}))+'<a target="_blank" href="http://aws.amazon.com/cloudwatch">'+a(n.i18n.call(t,"PROP.INSTANCE_WATCH_LINK_TEXT",{hash:{},data:i}))+'</a></p>\n		</section>\n		<section class="property-control-group">\n			',o=n["if"].call(t,t&&t.stackAgentEnable,{hash:{},inverse:f.program(27,C,i),fn:f.program(25,N,i),data:i});if(o||o===0)s+=o;s+="\n		</section>\n	</div>\n\n	",o=n["if"].call(t,t&&t.rootDevice,{hash:{},inverse:f.noop,fn:f.program(29,k,i),data:i});if(o||o===0)s+=o;return s+='\n\n	<div class="option-group-head">'+a(n.i18n.call(t,"PROP.INSTANCE_SG_DETAIL",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n</article>',s};return e.template(t)}),define("wspace/awseditor/property/launchconfig/view",["../base/view","./template/stack","./template/stack_mesos","event","constant","i18n!/nls/lang.js","kp_dropdown"],function(e,t,n,r,i,s,o){var u,a;return a=2e4,u=e.extend({events:{"change .launch-configuration-name":"lcNameChange","change #property-res-desc":"onChangeDescription","change .instance-type-select":"instanceTypeSelect","change #property-instance-ebs-optimized":"ebsOptimizedSelect","change #property-instance-enable-cloudwatch":"cloudwatchSelect","change #property-instance-user-data":"userdataChange","change #property-instance-public-ip":"publicIpChange","OPTION_CHANGE #instance-type-select":"instanceTypeSelect","OPTION_CHANGE #keypair-select":"setKP","EDIT_UPDATE #keypair-select":"addKP","EDIT_FINISHED #keypair-select":"updateKPSelect","click #property-ami":"openAmiPanel","click #volume-type-radios input":"changeVolumeType","keyup #iops-ranged":"changeIops","keyup #volume-size-ranged":"sizeChanged","change .mesos-attr":"setMesosAttribute","REMOVE_ROW .multi-input":"setMesosAttribute","click #add-ma-item-outside":"addMesosAttrItem"},render:function(){var e,r,i;return i=this.resModel.isMesos()?n:t,this.$el.html(i(this.model.toJSON())),e=new o({resModel:this.resModel}),this.addSubView(e),this.$("#kp-placeholder").html(e.render().el),r=this,$("#volume-size-ranged").parsley("custom",function(e){e=+e;if(!e||e>16384||e<r.model.attributes.min_volume_size)return sprintf(s.PARSLEY.VOLUME_SIZE_OF_ROOTDEVICE_MUST_IN_RANGE,r.model.attributes.min_volume_size)}),$("#iops-ranged").parsley("custom",function(e){var t;e=+e,t=parseInt($("#volume-size-ranged").val(),10);if(e>a||e<100)return s.PARSLEY.IOPS_MUST_BETWEEN_100_4000;if(e>10*t)return s.PARSLEY.IOPS_MUST_BE_LESS_THAN_10_TIMES_OF_VOLUME_SIZE}),this.model.attributes.name},addMesosAttrItem:function(e){return this.$("#mesos-attribute").find(".icon-add").eq(0).click(),!1},setMesosAttribute:function(e){var t;return t={},this.$("#mesos-attribute").find(".multi-ipt-row:not(.template)").each(function(){var e,n,r;e=$(this).find(".input"),n=e[0].value.trim(),r=e[1].value;if(n.length)return t[n]=r}),this.resModel.setMesosAttributes(t)},onChangeDescription:function(e){return this.model.setDesc($(e.currentTarget).val())},changeVolumeType:function(e){var t,n,r,i;t=$(e.currentTarget);if(t.is(":disabled"))return;return r=t.val(),$("#iops-group").toggle(r==="io1"),r==="io1"?(i=parseInt($("#volume-size-ranged").val(),10),n=i*10,n>a&&(n=a),$("#iops-ranged").val(n).keyup()):(this.model.setIops(""),$("#iops-ranged").val("")),this.model.setVolumeType(r),null},changeIops:function(){return $("#iops-ranged").parsley("validate")&&this.model.setIops($("#iops-ranged").val()),null},sizeChanged:function(e){var t,n,r,i;if(!$("#volume-size-ranged").parsley("validate"))return;return i=parseInt($("#volume-size-ranged").val(),10),this.model.setVolumeSize(i),i<10&&(this.model.setIops(""),r=!0),t=$("#volume-type-radios").children("div").last().toggleClass("tooltip",r).find("input"),r?(t.attr("disabled","disabled"),$("#radio-standard").click(),$("#iops-group").hide()):t.removeAttr("disabled"),n=parseInt($("#iops-ranged").val(),10)||0,n&&(n>i*10&&(n=i*10,$("#iops-ranged").val(n)),$("#iops-ranged").keyup()),null},publicIpChange:function(e){return this.model.setPublicIp(e.currentTarget.checked),null},lcNameChange:function(e){var t,n;return n=$(e.currentTarget),t=n.val(),MC.aws.aws.checkResName(this.model.get("uid"),n,"LaunchConfiguration")&&(this.model.setName(t),this.setTitle(t)),null},instanceTypeSelect:function(e,t){var n,r;r=this.model.setInstanceType(t),n=$("#property-instance-ebs-optimized"),n.closest(".property-control-group").toggle(r);if(!r)return n.prop("checked",!1)},ebsOptimizedSelect:function(e){return this.model.setEbsOptimized(e.target.checked),null},cloudwatchSelect:function(e){return this.model.setCloudWatch(e.target.checked),$("#property-cloudwatch-warn").toggle($("#property-instance-enable-cloudwatch").is(":checked"))},userdataChange:function(e){return this.model.setUserData(e.target.value)},setKP:function(e,t){return this.model.setKP(t)},addKP:function(e,t){var n;n=this.model.addKP(t);if(!n)return notification("error",s.NOTIFY.WARN_KEYPAIR_NAME_ALREADY_EXISTS),n},updateKPSelect:function(){return $("#keypair-select").find(".item:last-child").append('<span class="icon-remove"></span>')},openAmiPanel:function(e){return this.trigger("OPEN_AMI",$("#property-ami").attr("data-uid")),null},disableUserDataInput:function(e){var t;t=$("#property-instance-user-data");if(e===!0)return t.attr("disabled","disabled"),t.addClass("tooltip").attr("data-tooltip",s.PROP.INSTANCE_USER_DATA_DISABLE);if(e===!1)return t.removeAttr("disabled"),t.removeClass("tooltip").removeAttr("data-tooltip")}}),new u}),define("wspace/awseditor/property/launchconfig/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n    <section class="property-control-group" data-bind="true">\n      <label class="left" for="property-instance-name" >'+u(n.i18n.call(e,"PROP.LC_NAME",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.INSTANCE_REQUIRE",{hash:{},data:t}))+'</span>\n      <input class="input launch-configuration-name"  type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" name="property-instance-name" id="property-instance-name" maxlength="240" data-required-rollback="true" data-ignore="true"/>\n    </section>\n    <section class="property-control-group">\n      <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n      <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+"</textarea>\n    </section>\n    ",r}function c(e,t){var r="",i;return r+="\n      <dt>"+u(n.i18n.call(e,"PROP.NAME",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.name,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+"</dt>\n      <dd>"+u(n.emptyStr.call(e,e&&e.description,{hash:{},data:t}))+"</dd>\n      ",r}function h(e,t){var n="",r;return n+="\n      <dd>"+u((r=e&&e.keyName,typeof r===a?r.apply(e):r))+"</dd>\n      ",n}function p(e,t){var r="",i;r+='\n  <div class="option-group-head">'+u(n.i18n.call(e,"PROP.INSTANCE_ROOT_DEVICE",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <article class="property-app">\n      <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(e,"PROP.VOLUME_DEVICE_NAME",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.emptyStr.call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.DeviceName),{hash:{},data:t}))+'</dd>\n      </dl>\n      <dl class="dl-vertical">\n        <dt>'+u(n.i18n.call(e,"PROP.VOLUME_TYPE",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.readableVt.call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.VolumeType),{hash:{},data:t}))+"</dd>\n        ",i=n["if"].call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.SnapshotId),{hash:{},inverse:f.noop,fn:f.program(8,d,t),data:t});if(i||i===0)r+=i;r+="\n        <dt>"+u(n.i18n.call(e,"PROP.VOLUME_SIZE",{hash:{},data:t}))+"</dt>\n        <dd>"+u(n.emptyStr.call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.VolumeSize),{hash:{},data:t}))+" GB</dd>\n<!--         <dt>"+u(n.i18n.call(e,"PROP.VOLUME_ENCRYPTED",{hash:{},data:t}))+"</dt>\n        <dd>",i=n["if"].call(e,(i=e&&e.rootDevice,i==null||i===!1?i:i.encrypted),{hash:{},inverse:f.program(12,m,t),fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;r+="</dd> -->\n        ",i=n["if"].call(e,(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.Iops),{hash:{},inverse:f.noop,fn:f.program(14,g,t),data:t});if(i||i===0)r+=i;return r+="\n      </dl>\n    </article>\n  </div>\n  ",r}function d(e,t){var r="",i;return r+="\n        <dt>"+u(n.i18n.call(e,"PROP.VOLUME_SNAPSHOT_ID",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=(i=(i=e&&e.rootDevice,i==null||i===!1?i:i.Ebs),i==null||i===!1?i:i.SnapshotId),typeof i===a?i.apply(e):i))+"</dd>\n        ",r}function v(e,t){return"Yes"}function m(e,t){return"No"}function g(e,t){var n="",r;return n+="\n        <dt>IOPS</dt>\n        <dd>"+u((r=(r=(r=e&&e.rootDevice,r==null||r===!1?r:r.Ebs),r==null||r===!1?r:r.Iops),typeof r===a?r.apply(e):r))+"</dd>\n        ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app" data-bind="true">\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.LC_TITLE",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n    ',o=n["if"].call(t,t&&t.isEditable,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n    <dl class="dl-vertical">\n      ',o=n.unless.call(t,t&&t.isEditable,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+="\n      <dt>"+u(n.i18n.call(t,"PROP.LC_CREATE_TIME",{hash:{},data:i}))+"</dt>\n      <dd>"+u(n.timeStr.call(t,(o=t&&t.lc,o==null||o===!1?o:o.CreatedTime),{hash:{},data:i}))+'</dd>\n    </dl>\n\n\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(t,"PROP.INSTANCE_AMI",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.imageId,typeof o===a?o.apply(t):o))+"<dd>\n      <dt>"+u(n.i18n.call(t,"PROP.INSTANCE_TYPE",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.instanceType,typeof o===a?o.apply(t):o))+"</dd>\n      <dt>"+u(n.i18n.call(t,"PROP.INSTANCE_KEY_PAIR",{hash:{},data:i}))+"</dt>\n      ",o=n["if"].call(t,t&&t.app_view,{hash:{},inverse:f.program(5,h,i),fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+='\n    </dl>\n\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(t,"PROP.INSTANCE_EBS_OPTIMIZED",{hash:{},data:i}))+"</dt>\n      <dd>"+u((o=t&&t.ebsOptimized,typeof o===a?o.apply(t):o))+"<dd>\n    </dl>\n  </div>\n\n  ",o=n["if"].call(t,t&&t.rootDevice,{hash:{},inverse:f.noop,fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;return s+='\n\n  <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.INSTANCE_SG_DETAIL",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n  <div class="option-group sg-group"></div>\n</article>',s};return e.template(t)}),define("wspace/awseditor/property/launchconfig/app_view",["../base/view","./template/app"],function(e,t){var n;return n=e.extend({events:{"change #property-instance-enable-cloudwatch":"cloudwatchSelect","change #property-instance-user-data":"userdataChange","change #property-res-desc":"onChangeDescription","change .launch-configuration-name":"lcNameChange"},kpModalClosed:!1,render:function(){var e;return e=_.extend({isEditable:this.model.isAppEdit},this.model.toJSON()),this.$el.html(t(e)),e.name},onChangeDescription:function(e){return this.model.setDesc($(e.currentTarget).val())},lcNameChange:function(e){var t,n;return n=$(e.currentTarget),t=n.val(),MC.aws.aws.checkResName(this.model.get("uid"),n,"LaunchConfiguration")&&(this.model.setName(t),this.setTitle(t)),null},cloudwatchSelect:function(e){return this.model.setCloudWatch(e.target.checked),$("#property-cloudwatch-warn").toggle($("#property-instance-enable-cloudwatch").is(":checked"))},userdataChange:function(e){return this.model.setUserData(e.target.value)},elbNameChange:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(MC.aws.aws.checkResName(this.model.get("uid"),n,"Launch Configuration"))return this.model.setName(t),this.setTitle(t)}}),new n}),define("wspace/awseditor/property/launchconfig/main",["../base/main","./model","./view","./app_view","../sglist/main","constant","event"],function(e,t,n,r,i,s,o){var u;return t.on("KP_DOWNLOADED",function(e,t){return r.updateKPModal(e,t)}),r.on("OPEN_AMI",function(t){return e.loadSubPanel("STATIC",t)}),n.on("OPEN_AMI",function(t){return e.loadSubPanel("STATIC",t)}),u=e.extend({handleTypes:[s.RESTYPE.LC],onUnloadSubPanel:function(e){return i.onUnloadSubPanel(e),null},initStack:function(e){return this.model=t,this.model.isApp=!1,this.view=n,this.view.resModel=Design.instance().component(e),null},afterLoadStack:function(){return i.loadModule(this.model),null},initApp:function(){return this.model=t,this.model.isApp=!0,this.model.isAppEdit=!1,this.view=r,null},initAppEdit:function(){return this.model=t,this.model.isApp=!0,this.model.isAppEdit=!0,this.view=r,null},afterLoadApp:function(){return i.loadModule(this.model),null},afterLoadAppEdit:function(){return i.loadModule(this.model),null}}),null});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/property/asg/model",["../base/model","constant","Design"],function(e,t,n){var r;return r=e.extend({init:function(e){var t,r,i,s;t=n.instance().component(e),t.type==="ExpandedAsg"&&(t=t.get("originalAsg"),e=t.id),r=t!=null?t.toJSON():void 0,r.uid=e,this.set(r),i=t.getLc();if(!i){this.set("emptyAsg",!0);return}return this.set("tags",t.tags()),this.set("has_elb",!!i.connections("ElbAmiAsso").length),this.set("isEC2HealthCheck",t.isEC2HealthCheckType()),s=t.getNotification(),this.set("notification",s),this.set("has_notification",s.instanceLaunch||s.instanceLaunchError||s.instanceTerminate||s.instanceTerminateError||s.test),this.notiObject=t.getNotiObject(),this.set("policies",_.map(r.policies,function(e){return r=$.extend(!0,{},e.attributes),r.alarmData.period=Math.round(r.alarmData.period/60),r})),null},setHealthCheckType:function(e){return n.instance().component(this.get("uid")).set("healthCheckType",e)},setASGMin:function(e){return n.instance().component(this.get("uid")).set("minSize",e)},setASGMax:function(e){return n.instance().component(this.get("uid")).set("maxSize",e)},setASGDesireCapacity:function(e){return n.instance().component(this.get("uid")).set("capacity",e)},setASGCoolDown:function(e){return n.instance().component(this.get("uid")).set("cooldown",e)},setHealthCheckGrace:function(e){return n.instance().component(this.get("uid")).set("healthCheckGracePeriod",e)},setNotification:function(e){var t;return t=n.instance().component(this.get("uid")).setNotification(e),this.notiObject=t,null},removeTopic:function(){var e;return e=n.instance().component(this.get("uid")).setNotification(notification),e!=null?e.removeTopic():void 0},getNotificationTopicName:function(){return n.instance().component(this.get("uid")).getNotificationTopicName()},setNotificationTopic:function(e,t){return n.instance().component(this.get("uid")).setNotificationTopic(e,t)},setTerminatePolicy:function(e){return n.instance().component(this.get("uid")).set("terminationPolicies",e),this.set("terminationPolicies",e),null},delPolicy:function(e){return n.instance().component(e).remove(),null},isDupPolicyName:function(e,t){return _.some(n.instance().component(this.get("uid")).get("policies"),function(n){if(n.id!==e&&n.get("name")===t)return!0})},defaultScalingPolicyName:function(){var e,t,r,i,s;e=n.instance().component(this.get("uid")),e.type==="ExpandedAsg"&&(e=e.get("originalAsg")),s=e.get("policies"),t=s.length,i=""+this.attributes.name+"-policy-"+t,r=_.map(s,function(e){return e.get("name")});while(__indexOf.call(r,i)>=0)i=""+this.attributes.name+"-policy-"+ ++t;return i},getPolicy:function(e){var t;return t=$.extend(!0,{},n.instance().component(e).attributes),t.alarmData.period=Math.round(t.alarmData.period/60),t},setPolicy:function(e){var r,i,s,o;return s=n.instance().component(this.get("uid")),s.type==="ExpandedAsg"&&(s=s.get("originalAsg")),e.uid?(o=n.instance().component(e.uid),i=e.alarmData,o.setAlarm(i),delete e.alarmData,o.set(e),e.alarmData=i):(r=n.modelClassForType(t.RESTYPE.SP),o=new r(e),s.addScalingPolicy(o),e.uid=o.id,this.get("policies").push(o.toJSON())),e.sendNotification&&e.topic&&o.setTopic(e.topic.appId,e.topic.name),null}}),new r}),define("wspace/awseditor/property/asg/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n  <div class="property-control-group">'+u(n.i18n.call(e,"PROP.ASG_MSG_DROP_LC",{hash:{},data:t}))+"</div>\n  ",r}function c(e,t){var r="",i;r+='\n	<div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.ASG_DETAILS",{hash:{},data:t}))+'</div>\n	<div class="option-group" data-bind="true">\n		<section class="property-control-group">\n			<label class="left" for="property-asg-name" >'+u(n.i18n.call(e,"PROP.NAME",{hash:{},data:t}))+'</label>\n			<span class="required-input right">'+u(n.i18n.call(e,"PROP.ASG_REQUIRED",{hash:{},data:t}))+'</span>\n			<input class="input" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-asg-name" maxlength="255" data-ignore="true" data-required-rollback="true"/>\n		</section>\n\n		<section class="property-control-group" data-bind="true">\n	        <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n	        <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+'</textarea>\n		</section>\n\n		<section class="property-control-group">\n			<div class="property-asg-size">\n				<label class="left" for="property-asg-min">'+u(n.i18n.call(e,"PROP.ASG_MIN_SIZE",{hash:{},data:t}))+'</label>\n				<input class="input" type="text" id="property-asg-min" value="'+u((i=e&&e.minSize,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true" data-required-rollback="true">\n			</div>\n			<div class="property-asg-size">\n				<label class="left" for="property-asg-max">'+u(n.i18n.call(e,"PROP.ASG_MAX_SIZE",{hash:{},data:t}))+'</label>\n				<input class="input" type="text" id="property-asg-max" value="'+u((i=e&&e.maxSize,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true" data-required-rollback="true">\n			</div>\n			<div class="property-asg-size">\n				<label class="left" for="property-asg-capacity">'+u(n.i18n.call(e,"PROP.ASG_DESIRE_CAPACITY",{hash:{},data:t}))+'</label>\n				<input class="input" type="text" id="property-asg-capacity" value="'+u((i=e&&e.capacity,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true">\n			</div>\n	 	</section>\n\n		<section class="property-control-group">\n			<label class="left" for="property-asg-cooldown">'+u(n.i18n.call(e,"PROP.ASG_COOL_DOWN",{hash:{},data:t}))+'</label>\n			<input class="input input-short" type="text" id="property-asg-cooldown" value="'+u((i=e&&e.cooldown,typeof i===a?i.apply(e):i))+'" data-type="digits" max="86400">\n			<span>'+u(n.i18n.call(e,"PROP.ASG_UNIT_SECONDS",{hash:{},data:t}))+'</span>\n		</section>\n\n		<section class="property-control-group clearfix">\n			<label clas="left">'+u(n.i18n.call(e,"PROP.ASG_HEALTH_CHECK_TYPE",{hash:{},data:t}))+'</label>\n			<div class="mgt5">\n				<div class="radio">\n					<input id="property-asg-ec2" type="radio" value="ec2" ',i=n["if"].call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+=' name="property-asg-hc-option" />\n					<label for="property-asg-ec2"></label>\n				</div>\n				<label for="property-asg-ec2">EC2</label>\n			</div>\n			<div ',i=n.unless.call(e,e&&e.has_elb,{hash:{},inverse:f.program(8,d,t),fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;r+='>\n				<div class="radio">\n					<input id="property-asg-elb" type="radio" ',i=n.unless.call(e,e&&e.has_elb,{hash:{},inverse:f.noop,fn:f.program(10,v,t),data:t});if(i||i===0)r+=i;r+=' value="elb" ',i=n.unless.call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+=' name="property-asg-hc-option" />\n					<label for="property-asg-elb"></label>\n				</div>\n				<label for="property-asg-elb">ELB</label>\n                <p id="property-asg-elb-warn" class="hide property-info" ',i=n.unless.call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(12,m,t),data:t});if(i||i===0)r+=i;r+=">"+u(n.i18n.call(e,"PROP.ASG_ELB_WARN",{hash:{},data:t}))+'</p>\n			</div>\n		</section>\n\n		<section class="property-control-group">\n			<label class="left" for="property-asg-healthcheck">'+u(n.i18n.call(e,"PROP.ASG_HEALTH_CHECK_CRACE_PERIOD",{hash:{},data:t}))+'</label>\n			<input class="input input-short" type="text" id="property-asg-healthcheck" value="'+u((i=e&&e.healthCheckGracePeriod,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true">\n			<span>'+u(n.i18n.call(e,"PROP.ASG_UNIT_SECONDS",{hash:{},data:t}))+'</span>\n		</section>\n	</div>\n\n	<div class="option-group-head">'+u(n.i18n.call(e,"PROP.ASG_POLICY",{hash:{},data:t}))+'</div>\n	<div class="option-group">\n		<section class="property-control-group pos-r property-term-p">\n			<h5>'+u(n.i18n.call(e,"PROP.ASG_TERMINATION_POLICY",{hash:{},data:t}))+'</h5>\n			<div class="termination-policy-brief">'+u((i=e&&e.term_policy_brief,typeof i===a?i.apply(e):i))+'</div>\n			<div class="asg-p-action"><i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_TERMINATION_EDIT",{hash:{},data:t}))+'" id="property-asg-term-edit"></i></div>\n		</section>\n\n		<ul id="property-asg-policies" class="mega-list-wraper">\n			<li class="pos-r hide">\n        <h5 class="property-asg-policy-name name"></h5>\n				<span class="asg-p-metric asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ALARM_METRIC",{hash:{},data:t}))+'"></span>\n        <span class="asg-p-eval asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_THRESHOLD",{hash:{},data:t}))+'"></span>\n        <span class="asg-p-periods asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_PERIOD",{hash:{},data:t}))+'"></span>\n        <span class="asg-p-trigger asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ACTION",{hash:{},data:t}))+'"></span>\n        <span class="asg-p-adjust asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ADJUSTMENT",{hash:{},data:t}))+'"></span>\n        <div class="asg-p-action">\n	        <i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_EDIT",{hash:{},data:t}))+'"></i>\n	        <i class="icon-remove icon-del tooltip mgl5" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_REMOVE",{hash:{},data:t}))+'"></i>\n        </div>\n      </li>\n      ',i=n.each.call(e,e&&e.policies,{hash:{},inverse:f.noop,fn:f.program(14,g,t),data:t});if(i||i===0)r+=i;r+='\n\n		</ul>\n		<div class="property-control-group tac">\n			<button class="btn btn-blue btn-long ',i=n.unless.call(e,e&&e.can_add_policy,{hash:{},inverse:f.noop,fn:f.program(16,y,t),data:t});if(i||i===0)r+=i;r+='" id="property-asg-policy-add" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_TIP_YOU_CAN_ONLY_ADD_25_SCALING_POLICIES",{hash:{},data:t}))+'">'+u(n.i18n.call(e,"PROP.ASG_BTN_ADD_SCALING_POLICY",{hash:{},data:t}))+'</button>\n		</div>\n	</div>\n\n	<div class="option-group-head">'+u(n.i18n.call(e,"PROP.ASG_LBL_NOTIFICATION",{hash:{},data:t}))+'</div>\n	<div class="option-group" id="property-asg-sns">\n		<div class="property-control-group property-asg-notification-wrap">\n			<p>'+u(n.i18n.call(e,"PROP.ASG_LBL_SEND_NOTIFICATION",{hash:{},data:t}))+'</p>\n			<div><div class="checkbox">\n				<input id="property-asg-sns1" type="checkbox" data-key="instanceLaunch" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceLaunch),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;r+='/>\n				<label for="property-asg-sns1"></label>\n			</div>\n			<label for="property-asg-sns1">'+u(n.i18n.call(e,"PROP.ASG_LBL_SUCCESS_INSTANCES_LAUNCH",{hash:{},data:t}))+'</label></div>\n\n			<div><div class="checkbox">\n				<input id="property-asg-sns2" type="checkbox" data-key="instanceLaunchError" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceLaunchError),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;r+='/>\n				<label for="property-asg-sns2"></label>\n			</div>\n			<label for="property-asg-sns2">'+u(n.i18n.call(e,"PROP.ASG_LBL_FAILED_INSTANCES_LAUNCH",{hash:{},data:t}))+'</label></div>\n\n			<div><div class="checkbox">\n				<input id="property-asg-sns3" type="checkbox" data-key="instanceTerminate" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceTerminate),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;r+='/>\n				<label for="property-asg-sns3"></label>\n			</div>\n			<label for="property-asg-sns3">'+u(n.i18n.call(e,"PROP.ASG_LBL_SUCCESS_INSTANCES_TERMINATE",{hash:{},data:t}))+'</label></div>\n\n			<div><div class="checkbox">\n				<input id="property-asg-sns4" type="checkbox" data-key="instanceTerminateError" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceTerminateError),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;r+='/>\n				<label for="property-asg-sns4"></label>\n			</div>\n			<label for="property-asg-sns4">'+u(n.i18n.call(e,"PROP.ASG_LBL_FAILED_INSTANCES_TERMINATE",{hash:{},data:t}))+'</label></div>\n\n			<div><div class="checkbox">\n				<input id="property-asg-sns5" type="checkbox" data-key="test" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.test),{hash:{},inverse:f.noop,fn:f.program(18,b,t),data:t});if(i||i===0)r+=i;return r+='/>\n				<label for="property-asg-sns5"></label>\n			</div>\n			<label for="property-asg-sns5">'+u(n.i18n.call(e,"PROP.ASG_LBL_VALIDATE_SNS",{hash:{},data:t}))+'</label></div>\n\n		</div>\n\n		<div class="property-control-group sns-group" style="display:none;">\n			<label for="sns-placeholder">'+u(n.i18n.call(e,"PROP.SELECT_SNS_TOPIC",{hash:{},data:t}))+'</label>\n			<div id="sns-placeholder"></div>\n		</div>\n\n	</div>\n	',r}function h(e,t){return'checked="true"'}function p(e,t){var r="";return r+='data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_HAS_ELB_WARN",{hash:{},data:t}))+'" class="mgt5 tooltip"',r}function d(e,t){return'class="mgt5"'}function v(e,t){return'disabled="disabled"'}function m(e,t){return' style="display: block"'}function g(e,t){var r="",i;return r+='\n      <li class="pos-r" data-uid="'+u((i=e&&e.id,typeof i===a?i.apply(e):i))+'">\n        <h5 class="property-asg-policy-name name" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_NAME",{hash:{},data:t}))+'">'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'</h5>\n      	<span class="asg-p-metric asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ALARM_METRIC",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.metricName),typeof i===a?i.apply(e):i))+'</span>\n        <span class="asg-p-eval asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_THRESHOLD",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.comparisonOperator),typeof i===a?i.apply(e):i))+" "+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.threshold),typeof i===a?i.apply(e):i))+u((i=e&&e.unit,typeof i===a?i.apply(e):i))+'</span>\n        <span class="asg-p-periods asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_PERIOD",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.evaluationPeriods),typeof i===a?i.apply(e):i))+"x"+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.period),typeof i===a?i.apply(e):i))+'m</span>\n        <span class="asg-p-trigger asg-p-tag asg-p-trigger-'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ACTION",{hash:{},data:t}))+'">'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'</span>\n        <span class="asg-p-adjust asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ADJUSTMENT",{hash:{},data:t}))+'">'+u((i=e&&e.adjustment,typeof i===a?i.apply(e):i))+" "+u((i=e&&e.adjustmentType,typeof i===a?i.apply(e):i))+'</span>\n        <div class="asg-p-action">\n	        <i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_EDIT",{hash:{},data:t}))+'"></i>\n	        <i class="icon-del tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_REMOVE",{hash:{},data:t}))+'"></i>\n        </div>\n      </li>\n      ',r}function y(e,t){return"disabled tooltip"}function b(e,t){return'checked="checked"'}function w(e,t){var r="",i;r+='\n		<table class="table cost-estimation-table">\n			<tbody>\n			',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(21,E,t),data:t});if(i||i===0)r+=i;return r+="\n			</tbody>\n		</table>\n		",r}function E(e,t){var n="",r;return n+='\n			<tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n			",n}function S(e,t){var r="";return r+='\n		<div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+="<article>\n  ",o=n["if"].call(t,t&&t.emptyAsg,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n	<div class="option-group-head expand">\n		'+u(n.i18n.call(t,"PROP.RESOURCE_TAGS",{hash:{},data:i}))+'\n	</div>\n	<div class="option-group">\n		',o=n["if"].call(t,(o=t&&t.tags,o==null||o===!1?o:o.length),{hash:{},inverse:f.program(23,S,i),fn:f.program(20,w,i),data:i});if(o||o===0)s+=o;return s+='\n\n		<div class="tags-action">\n			\n			<button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(t,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:i}))+"</button>\n		</div>\n	</div>\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/asg/template/policy",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){return"readonly"}function c(e,t){return'checked="checked"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="scroll-wrap" style="max-height:500px;" id="asg-termination-policy" data-bind="true">\n	<div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n	<div class="modal-body scroll-content" id="property-asg-policy" data-uid="'+a((o=t&&t.uid,typeof o===u?o.apply(t):o))+'">\n\n		<label for="asg-policy-name" class="modal-text-major">'+a(n.i18n.call(t,"PROP.ASG_POLICY_TLT_NAME",{hash:{},data:i}))+'</label>\n		<input type="text" class="input" value="'+a((o=t&&t.name,typeof o===u?o.apply(t):o))+'" id="asg-policy-name" data-required-rollback="true" data-ignore="true" maxlength="255" data-required="true" ',o=n["if"].call(t,t&&t.isOld,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='>\n\n\n		<section class="modal-control-group">\n			<h5>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ALARM",{hash:{},data:i}))+'</h5>\n			<div class="control-sentence">\n				<span>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_WHEN",{hash:{},data:i}))+'</span>\n\n				<div class="selectbox" id="asg-policy-metric">\n					<div class="selection">'+a(n.i18n.call(t,"PROP.ASG_POLICY_CPU",{hash:{},data:i}))+'</div>\n					<ul class="dropdown" tabindex="-1">\n						<li data-id="CPUUtilization" class="item selected">'+a(n.i18n.call(t,"PROP.ASG_POLICY_CPU",{hash:{},data:i}))+'</li>\n						<li data-id="DiskReadBytes" class="item">'+a(n.i18n.call(t,"PROP.ASG_POLICY_DISC_READS",{hash:{},data:i}))+'</li>\n						<li data-id="DiskReadOps" class="item">'+a(n.i18n.call(t,"PROP.ASG_POLICY_DISK_READ_OPERATIONS",{hash:{},data:i}))+'</li>\n						<li data-id="DiskWriteBytes" class="item">'+a(n.i18n.call(t,"PROP.ASG_POLICY_DISK_WRITES",{hash:{},data:i}))+'</li>\n						<li data-id="DiskWriteOps" class="item">'+a(n.i18n.call(t,"PROP.ASG_POLICY_DISK_WRITE_OPERATIONS",{hash:{},data:i}))+'</li>\n						<li data-id="NetworkIn" class="item">'+a(n.i18n.call(t,"PROP.ASG_POLICY_NETWORK_IN",{hash:{},data:i}))+'</li>\n						<li data-id="NetworkOut" class="item">'+a(n.i18n.call(t,"PROP.ASG_POLICY_NETWORK_OUT",{hash:{},data:i}))+'</li>\n						<li data-id="StatusCheckFailed" class="item">'+a(n.i18n.call(t,"PROP.ASG_POLICY_STATUS_CHECK_FAILED_ANY",{hash:{},data:i}))+'</li>\n						<li data-id="StatusCheckFailed_Instance" class="item">'+a(n.i18n.call(t,"PROP.ASG_POLICY_STATUS_CHECK_FAILED_INSTANCE",{hash:{},data:i}))+'</li>\n						<li data-id="StatusCheckFailed_System" class="item">'+a(n.i18n.call(t,"PROP.ASG_POLICY_STATUS_CHECK_FAILED_SYSTEM",{hash:{},data:i}))+"</li>\n					</ul>\n				</div>\n\n				<span>"+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_IS",{hash:{},data:i}))+'</span>\n\n				<div class="selectbox" id="asg-policy-eval">\n					<div class="selection">&gt;=</div>\n					<ul class="dropdown" tabindex="-1">\n						<li data-id=">" class="item">&gt;</li>\n						<li data-id=">=" class="item selected">&gt;=</li>\n						<li data-id="<" class="item">&lt;</li>\n						<li data-id="<=" class="item">&lt;=</li>\n					</ul>\n				</div>\n\n				<input type="text" class="input" id="asg-policy-threshold" value="'+a((o=(o=t&&t.alarmData,o==null||o===!1?o:o.threshold),typeof o===u?o.apply(t):o))+'" placeholder="'+a(n.i18n.call(t,"PROP.ASG_POLICY_TLT_THRESHOLD",{hash:{},data:i}))+'" data-ignore="true" data-ignore-regexp="^[0-9]*\\.?[0-9]*$" data-required="true">\n\n				<span id="asg-policy-unit">'+a((o=t&&t.unit,typeof o===u?o.apply(t):o))+"</span>\n\n				<br />\n\n				<span>"+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_FOR",{hash:{},data:i}))+'</span>\n\n				<input type="text" class="input" id="asg-policy-periods" value="'+a((o=(o=t&&t.alarmData,o==null||o===!1?o:o.evaluationPeriods),typeof o===u?o.apply(t):o))+'" data-required="true" data-ignore="true" data-type="digits">\n\n				<span>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_PERIOD",{hash:{},data:i}))+'</span>\n\n				<input type="text" class="input" id="asg-policy-second" value="'+a((o=(o=t&&t.alarmData,o==null||o===!1?o:o.period),typeof o===u?o.apply(t):o))+'" data-required="true" data-ignore="true" data-type="digits">\n\n				<span>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_SECONDS",{hash:{},data:i}))+"</span>\n\n				<br />\n\n				<span>"+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_START_SCALING",{hash:{},data:i}))+'</span>\n\n				<div class="selectbox" id="asg-policy-trigger">\n					<div class="selection">ALARM</div>\n					<ul class="dropdown" tabindex="-1">\n						<li data-id="ALARM" class="item selected">ALARM</li>\n						<li data-id="INSUFFICIANT_DATA" class="item">INSUFFICIANT_DATA</li>\n						<li data-id="OK" class="item">OK</li>\n					</ul>\n				</div>\n\n				<span>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_STATE",{hash:{},data:i}))+'</span>\n			</div>\n		</section>\n\n		<section class="modal-control-group">\n			<h5>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_SCALING_ACTIVITY",{hash:{},data:i}))+'</h5>\n			<div class="control-sentence">\n				<span>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADJUSTMENT",{hash:{},data:i}))+'</span>\n				<div class="selectbox" id="asg-policy-adjust-type">\n					<div class="selection">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADJUSTMENT_CHANGE",{hash:{},data:i}))+'</div>\n					<ul class="dropdown" tabindex="-1">\n						<li data-id="ChangeInCapacity" class="item selected">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADJUSTMENT_CHANGE",{hash:{},data:i}))+'</li>\n						<li data-id="ExactCapacity" class="item">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADJUSTMENT_EXACT",{hash:{},data:i}))+'</li>\n						<li data-id="PercentChangeInCapacity" class="item">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADJUSTMENT_PERCENT",{hash:{},data:i}))+"</li>\n					</ul>\n				</div>\n				<span>"+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADJUSTMENT_OF",{hash:{},data:i}))+'</span>\n				<input type="text" class="input tooltip" id="asg-policy-adjust" data-required="true" value="'+a((o=t&&t.adjustment,typeof o===u?o.apply(t):o))+'" placeholder="e.g. -1" data-ignore="true" data-ignore-regexp="^-?[0-9]*$">\n				<span class="hide pecentcapcity">%</span>\n				<span>.</span>\n			</div>\n		</section>\n\n		<h5>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED",{hash:{},data:i}))+'</h5>\n		<div class="asg-policy-advanced">\n			<section id="asg-policy-statistics" class="modal-control-group">\n				<h5>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_ALARM_OPTION",{hash:{},data:i}))+'</h5>\n				<div class="clearfix">\n					<label>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_STATISTIC",{hash:{},data:i}))+'</label>\n					<div class="selectbox" id="asg-policy-statistics">\n						<div class="selection">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_STATISTIC_AVG",{hash:{},data:i}))+'</div>\n						<ul class="dropdown" tabindex="-1">\n							<li data-id="Average" class="item selected">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_STATISTIC_AVG",{hash:{},data:i}))+'</li>\n							<li data-id="Minimum" class="item">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_STATISTIC_MIN",{hash:{},data:i}))+'</li>\n							<li data-id="Maximum" class="item">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_STATISTIC_MAX",{hash:{},data:i}))+'</li>\n							<li data-id="SampleCount" class="item">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_STATISTIC_SAMPLE",{hash:{},data:i}))+'</li>\n							<li data-id="Sum" class="item">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_STATISTIC_SUM",{hash:{},data:i}))+'</li>\n						</ul>\n					</div>\n				</div>\n			</section>\n\n			<section id="asg-policy-scaling" class="modal-control-group">\n				<h5>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_SCALING_OPTION",{hash:{},data:i}))+'</h5>\n				<div class="clearfix">\n					<label for="asg-policy-cooldown">'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_COOLDOWN_PERIOD",{hash:{},data:i}))+'</label>\n					<input type="text" class="input tooltip" data-tooltip="'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_TIP_COOLDOWN_PERIOD",{hash:{},data:i}))+'" value="'+a((o=t&&t.cooldown,typeof o===u?o.apply(t):o))+'" maxlength="5" placeholder="'+a(n.i18n.call(t,"PROP.ASG_DEFAULT_COOL_DOWN",{hash:{},data:i}))+'" data-ignore="true" data-type="digits" id="asg-policy-cooldown">\n					<span>'+a(n.i18n.call(t,"PROP.ASG_UNIT_SECONDS",{hash:{},data:i}))+'</span>\n				</div>\n\n				<div id="asg-policy-step-wrapper" class="hide clearfix pecentcapcity">\n					<label>'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_MIN_ADJUST_STEP",{hash:{},data:i}))+'</label>\n					<input type="text" class="input tooltip" data-tooltip="'+a(n.i18n.call(t,"PROP.ASG_ADD_POLICY_ADVANCED_TIP_MIN_ADJUST_STEP",{hash:{},data:i}))+'" id="asg-policy-step" value="'+a((o=t&&t.minAdjustStep,typeof o===u?o.apply(t):o))+'" data-ignore="true" maxlength="5" data-type="digits">\n				</div>\n			</section>\n\n			<section class="modal-control-group">\n				<h5>'+a(n.i18n.call(t,"PROP.ASG_LBL_NOTIFICATION",{hash:{},data:i}))+'</h5>\n				<div class="checkbox">\n					<input id="asg-policy-notify" type="checkbox" ',o=n["if"].call(t,t&&t.sendNotification,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+='/>\n					<label for="asg-policy-notify"></label>\n				</div>\n				<label id="asg-policy-notify-label" for="asg-policy-notify">'+a(n.i18n.call(t,"PROP.ASG_LBL_SEND_NOTIFICATION_D",{hash:{},data:i}))+'</label>\n\n				<div class="sns-policy-field">\n					<label>'+a(n.i18n.call(t,"PROP.SELECT_SNS_TOPIC",{hash:{},data:i}))+'</label>\n					<div class="policy-sns-placeholder"></div>\n				</div>\n\n			</section>\n		</div>\n	</div>\n</div>\n</div>',s};return e.template(t)}),define("wspace/awseditor/property/asg/template/term",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n            <li ",i=n["if"].call(e,e&&e.checked,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;r+='  data-name="'+f((i=e&&e.name,typeof i===a?i.apply(e):i))+'">\n            <div class="checkbox">\n                <input id="property-asg-term'+f((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'" type="checkbox" ',i=n["if"].call(e,e&&e.checked,{hash:{},inverse:u.noop,fn:u.program(4,h,t),data:t});if(i||i===0)r+=i;return r+='/>\n                <label for="property-asg-term'+f((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'"></label>\n            </div>\n            <label for="property-asg-term'+f((i=t==null||t===!1?t:t.index,typeof i===a?i.apply(e):i))+'" class="list-name" data-name="'+f((i=e&&e.name,typeof i===a?i.apply(e):i))+'">'+f((i=e&&e.text,typeof i===a?i.apply(e):i))+'</label>\n            <span class="drag-handle tooltip icon-sort" data-tooltip="'+f(n.i18n.call(e,"PROP.ASG_TERMINATION_MSG_DRAG",{hash:{},data:t}))+'"></span>\n            </li>\n            ',r}function c(e,t){return'class="enabled" '}function h(e,t){return'checked="checked" '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<div id="property-asg-term">\n    <p class="modal-text-minor">'+f(n.i18n.call(t,"PROP.ASG_TERMINATION_TEXT_WARN",{hash:{},data:i}))+'</p>\n    <div class="drag-sort-list-wrap">\n        <ul class="drag-sort-list" id="property-term-list">\n            ',o=n.each.call(t,t,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n        </ul>\n\n        <ul class="drag-sort-list">\n            <li ',o=n["if"].call(t,t&&t.useDefault,{hash:{},inverse:u.noop,fn:u.program(2,c,i),data:i});if(o||o===0)s+=o;s+='>\n            <div class="checkbox">\n                <input id="property-asg-term-def" type="checkbox" ',o=n["if"].call(t,t&&t.useDefault,{hash:{},inverse:u.noop,fn:u.program(4,h,i),data:i});if(o||o===0)s+=o;return s+='/>\n                <label for="property-asg-term-def"></label>\n            </div>\n            <span>'+f(n.i18n.call(t,"PROP.DEFAULT",{hash:{},data:i}))+"</span>\n            </li>\n        </ul>\n    </div>\n</div>",s};return e.template(t)}),define("wspace/awseditor/property/asg/view",["../base/view","./template/stack","./template/policy","./template/term","i18n!/nls/lang.js","sns_dropdown","UI.modalplus"],function(e,t,n,r,i,s,o){var u,a,f,l,c,h;return c={CPUUtilization:i.PROP.ASG_POLICY_CPU,DiskReadBytes:i.PROP.ASG_POLICY_DISC_READS,DiskReadOps:i.PROP.ASG_POLICY_DISK_READ_OPERATIONS,DiskWriteBytes:i.PROP.ASG_POLICY_DISK_WRITES,DiskWriteOps:i.PROP.ASG_POLICY_DISK_WRITE_OPERATIONS,NetworkIn:i.PROP.ASG_POLICY_NETWORK_IN,NetworkOut:i.PROP.ASG_POLICY_NETWORK_OUT,StatusCheckFailed:i.PROP.ASG_POLICY_STATUS_CHECK_FAILED_ANY,StatusCheckFailed_Instance:i.PROP.ASG_POLICY_STATUS_CHECK_FAILED_INSTANCE,StatusCheckFailed_System:i.PROP.ASG_POLICY_STATUS_CHECK_FAILED_SYSTEM},a={ChangeInCapacity:i.PROP.ASG_ADD_POLICY_ADJUSTMENT_CHANGE,ExactCapacity:i.PROP.ASG_ADD_POLICY_ADJUSTMENT_EXACT,PercentChangeInCapacity:i.PROP.ASG_ADD_POLICY_ADJUSTMENT_PERCENT},l={ChangeInCapacity:i.PROP.EG_MINUS_1,ExactCapacity:i.PROP.EG_5,PercentChangeInCapacity:i.PROP.EG_MINUS_30},f={ChangeInCapacity:i.PROP.ASG_ADJUST_TOOLTIP_CHANGE,ExactCapacity:i.PROP.ASG_ADJUST_TOOLTIP_EXACT,PercentChangeInCapacity:i.PROP.ASG_ADJUST_TOOLTIP_PERCENT},h={CPUUtilization:"%",DiskReadBytes:"B",DiskWriteBytes:"B",NetworkIn:"B",NetworkOut:"B"},u=e.extend({events:{"click #property-asg-term-edit":"showTermPolicy","click #property-asg-sns input[type=checkbox]":"setNotification","change #property-asg-elb":"setHealthyCheckELBType","change #property-asg-ec2":"setHealthyCheckEC2Type","change #property-asg-name":"setASGName","change #property-asg-min":"setSizeGroup","change #property-asg-max":"setSizeGroup","change #property-asg-capacity":"setSizeGroup","change #property-asg-cooldown":"setASGCoolDown","change #property-asg-healthcheck":"setHealthCheckGrace","click #property-asg-policy-add":"addScalingPolicy","click #property-asg-policies .icon-edit":"editScalingPolicy","click #property-asg-policies .icon-del":"delScalingPolicy","change #property-res-desc":"onChangeDescription"},render:function(){var e,n,r,i,s;this.createSnsNotiDropdown(this.model.getNotificationTopicName()),e=this.model.toJSON(),s=e.policies;for(r=0,i=s.length;r<i;r++)n=s[r],n.unit=h[n.alarmData.metricName],n.alarmData.metricName=c[n.alarmData.metricName],n.adjustmentType=a[n.adjustmentType];return e.term_policy_brief=this.getTerminationPoliciesText(e.terminationPolicies),e.can_add_policy=e.policies.length<25,this.$el.html(t(e)),this.processNotiTopic(null,!0),e.name},getTerminationPoliciesText:function(e){return _.map(e,function(e){return e}).join(" > ")},createSnsNotiDropdown:function(e){var t;return t=e?{selection:e}:{},this.snsNotiDropdown=new s(t),this.snsNotiDropdown.on("change",this.model.setNotificationTopic,this.model),this.addSubView(this.snsNotiDropdown),this.snsNotiDropdown},onChangeDescription:function(e){return this.model.setDesc($(e.currentTarget).val())},wheatherHasNoti:function(){var e,t;return e=(t=this.model.notiObject)!=null?t.toJSON():void 0,e&&(e.instanceLaunch||e.instanceLaunchError||e.instanceTerminate||e.instanceTerminateError||e.test)},processNotiTopic:function(e,t){var n;n=this.wheatherHasNoti();if(t&&n)return this.$("#sns-placeholder").html(this.snsNotiDropdown.render().el),this.$(".sns-group").show();if(!e&&n)return this.$("#sns-placeholder").html(this.snsNotiDropdown.render(!0).el),this.$(".sns-group").show();if(e&&!n)return this.createSnsNotiDropdown(),this.model.removeTopic(),this.$(".sns-group").hide()},processPolicyTopic:function(e,t,n){var r,i;return i=t?t.getTopicName():null,r=new s({selection:i}),this.addSubView(r),e?($(".policy-sns-placeholder").html(r.render(n).el),$(".sns-policy-field").show()):(r=new s,$(".sns-policy-field").hide())},setASGCoolDown:function(e){var t;t=$(e.target),t.parsley("custom",function(e){return _.isNumber(+e)&&+e>86400?i.PARSLEY.MAX_VALUE_86400:null});if(t.parsley("validate"))return this.model.setASGCoolDown(t.val())},setASGName:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(MC.aws.aws.checkResName(this.model.get("uid"),n,"ASG"))return this.model.setName(t),this.setTitle(t)},setSizeGroup:function(e){var t,n,r,s;s=this,r=this.$el.find("#property-asg-min"),n=this.$el.find("#property-asg-max"),t=this.$el.find("#property-asg-capacity"),r.parsley("custom",function(e){return+e>+n.val()?i.PARSLEY.MINIMUM_SIZE_MUST_BE_LESSTHAN_MAXIMUM_SIZE:s.constantCheck(e)}),n.parsley("custom",function(e){return+e<+r.val()?i.PARSLEY.MAXIMUM_SIZE_MUST_BE_MORETHAN_MINIMUM_SIZE:s.constantCheck(e)}),t.parsley("custom",function(e){return+e<+r.val()||+e>+n.val()?i.PARSLEY.DESIRED_CAPACITY_IN_ALLOW_SCOPE:s.constantCheck(e)});if($(e.currentTarget).parsley("validateForm"))return this.model.setASGMin(r.val()),this.model.setASGMax(n.val()),this.model.setASGDesireCapacity(t.val())},constantCheck:function(e){return e=+e,e>65534?sprintf(i.PARSLEY.VALUE_MUST_BE_LESSTHAN_VAR,65534):null},setHealthCheckGrace:function(e){var t;t=$(e.currentTarget),t.parsley("custom",function(e){e=+e;if(e<0||e>86400)return sprintf(i.PARSLEY.VALUE_MUST_IN_ALLOW_SCOPE,0,86400)});if(t.parsley("validate"))return this.model.setHealthCheckGrace(t.val())},showTermPolicy:function(){var e,t,n,s,u,a,f,l,c,h,p,d;t=[],e={},p=this.model.get("terminationPolicies");for(f=0,c=p.length;f<c;f++)u=p[f],u==="Default"?t.useDefault=!0:(t.push({name:u,checked:!0,text:u}),e[u]=!0);d=["OldestInstance","NewestInstance","OldestLaunchConfiguration","ClosestToNextInstanceHour"];for(l=0,h=d.length;l<h;l++)s=d[l],e[s]||t.push({name:s,checked:!1,text:s});return n=new o({title:i.PROP.ASG_TERMINATION_EDIT,width:420,template:r(t),confirm:{text:i.PROP.LBL_DONE}}),a=this,n.on("confirm",function(){return a.onEditTermPolicy(),n.close()}),$("#property-asg-term").on("click","input",function(){var t,n;return t=$("#property-asg-term").find("input:checked"),t.length===0?!1:(n=$(this),e=n.is(":checked"),n.closest("li").toggleClass("enabled",e))}),$("#property-asg-term").on("mousedown",".drag-handle",function(){return $(this).trigger("mouseleave")}),$("#property-term-list").sortable({handle:".drag-handle"})},onEditTermPolicy:function(){var e;return e=[],$("#property-term-list .list-name").each(function(){var t;return t=$(this),t.closest("li").hasClass("enabled")&&e.push(t.data("name")),null}),$("#property-asg-term-def").is(":checked")&&e.push("Default"),$(".termination-policy-brief").text(this.getTerminationPoliciesText(e)),this.model.setTerminatePolicy(e)},delScalingPolicy:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.data("uid"),t.remove(),$("#property-asg-policy-add").removeClass("tooltip disabled"),this.model.delPolicy(n)},updateScalingPolicy:function(e){var t,n,r,i,s;i=c[e.alarmData.metricName],r=a[e.adjustmentType],s=h[e.alarmData.metricName]||"";if(!e.uid){void 0;return}return n=$("#property-asg-policies"),t=n.children("[data-uid='"+e.uid+"']"),t.length===0&&(t=n.children(".hide").clone().attr("data-uid",e.uid).removeClass("hide").appendTo(n),$("#property-asg-policy-add").toggleClass("tooltip disabled",$("#property-asg-policies").children().length>=26)),t.find(".name").html(e.name),t.find(".asg-p-metric").html(i),t.find(".asg-p-eval").html(e.alarmData.comparisonOperator+" "+e.alarmData.threshold+s),t.find(".asg-p-periods").html(e.alarmData.evaluationPeriods+"x"+Math.round(e.alarmData.period/60)+"m"),t.find(".asg-p-trigger").html(e.state).attr("class","asg-p-trigger asg-p-tag asg-p-trigger-"+e.state),t.find(".asg-p-adjust").html(e.adjustment+" "+e.adjustmentType)},editScalingPolicy:function(e){var t,n,r,s,o,u,a,f,l,c,h,p;f=$(e.currentTarget).closest("li").data("uid"),s=this.model.getPolicy(f),s.uid=f,s.title=i.PROP.ASG_ADD_POLICY_TITLE_EDIT,this.showScalingPolicy(s),a={metric:s.alarmData.metricName,eval:s.alarmData.comparisonOperator,trigger:s.state,"adjust-type":s.adjustmentType,statistics:s.alarmData.statistic};for(u in a){l=a[u],n=$("#asg-policy-"+u),r=null,p=n.find(".item");for(c=0,h=p.length;c<h;c++){o=p[c],t=$(o);if(t.data("id")===l){r=t;break}}r&&(n.find(".selected").removeClass("selected"),n.find(".selection").html(r.addClass("selected").html()))}return $(".pecentcapcity").toggle($("#asg-policy-adjust-type").find(".selected").data("id")==="PercentChangeInCapacity")},addScalingPolicy:function(e){return $(e.currentTarget).hasClass("disabled")?!1:(this.showScalingPolicy(),!1)},openPolicyModal:function(e){var t,r,s;return r={template:n(e),title:i.PROP.ASG_ADD_POLICY_TITLE_ADD+" "+i.PROP.ASG_ADD_POLICY_TITLE_CONTENT,width:"480px",compact:!0,confirm:{text:i.PROP.LBL_DONE}},t=new o(r),s=this,t.on("confirm",function(){var e;return e=$("#asg-termination-policy").parsley("validate"),e===!1?!1:(s.onPolicyDone(),t.close())},this)},showScalingPolicy:function(e){var t,n;return e||(e={title:i.PROP.ASG_ADD_POLICY_TITLE_ADD,name:this.model.defaultScalingPolicyName(),minAdjustStep:1,alarmData:{evaluationPeriods:2,period:5}}),e.uid&&(t=Design.instance().component(e.uid)),e.alarmData&&e.alarmData.metricName?e.unit=h[e.alarmData.metricName]:e.unit="%",this.openPolicyModal(e),n=this,$("#asg-policy-name").parsley("custom",function(e){var t;t=$("#property-asg-policy").data("uid");if(n.model.isDupPolicyName(t,e))return i.PARSLEY.DUPLICATED_POLICY_NAME}),$("#asg-policy-periods").on("change",function(){var e;e=parseInt($(this).val(),10),(!e||e<1)&&$(this).val("1");if(e>86400)return $(this).val(86400)}),$("#asg-policy-second").on("change",function(){var e;e=parseInt($(this).val(),10),(!e||e<1)&&$(this).val("1");if(e>1440)return $(this).val(1440)}),$("#asg-policy-adjust-type").on("OPTION_CHANGE",function(){var e;return e=$(this).find(".selected").data("id"),e==="PercentChangeInCapacity"?($(".pecentcapcity").toggle(!0),$("#asg-policy-step").val()===""&&$("#asg-policy-step").val(1)):$(".pecentcapcity").toggle(!1),$("#asg-policy-adjust").attr("placeholder",l[e]).data("tooltip",f[e]).trigger("change")}),$("#asg-policy-adjust").on("change",function(){var e,t;return e=$("#asg-policy-adjust-type").find(".selected").data("id"),t=parseInt($(this).val(),10),e==="ExactCapacity"?(!t||t<1)&&$(this).val("1"):e==="PercentChangeInCapacity"&&(t?t<-100&&$(this).val("-100"):$(this).val("0")),t<-65534?$(this).val(-65534):t>65534&&$(this).val(65534),$("#").data("tooltip",f[e]).trigger("change")}),$("#asg-policy-cooldown").on("change",function(){var e,t;e=$("#asg-policy-cooldown"),t=parseInt(e.val(),10);if(isNaN(t))return;return t<0?t=0:t>86400&&(t=86400),e.val(t)}),$("#asg-policy-step").on("change",function(){var e,t;e=$("#asg-policy-step"),t=parseInt(e.val(),10);if(isNaN(t))return;return t<0?t=0:t>65534&&(t=65534),e.val(t)}),$("#asg-policy-threshold").on("change",function(){var e,t;e=$("#asg-policy-metric .selected").data("id"),t=parseInt($(this).val(),10);if(e==="CPUUtilization"){if(isNaN(t)||t<1)return $(this).val("1");if(t>100)return $(this).val("100")}}),this.processPolicyTopic($("#asg-policy-notify").prop("checked"),t,!1),$("#asg-policy-notify").off("click").on("click",function(e){return e.stopPropagation(),n.processPolicyTopic(e.target.checked,t,!0),null}),$("#asg-policy-metric").on("OPTION_CHANGE",function(){return $("#asg-policy-unit").html(h[$(this).find(".selected").data("id")]||""),$("#asg-policy-threshold").val("")}),null},onPolicyDone:function(){var e,t;return e={uid:$("#property-asg-policy").data("uid"),name:$("#asg-policy-name").val(),cooldown:$("#asg-policy-cooldown").val(),minAdjustStep:"",adjustment:$("#asg-policy-adjust").val(),adjustmentType:$("#asg-policy-adjust-type .selected").data("id"),state:$("#asg-policy-trigger .selected").data("id"),sendNotification:$("#asg-policy-notify").is(":checked"),alarmData:{metricName:$("#asg-policy-metric .selected").data("id"),comparisonOperator:$("#asg-policy-eval .selected").data("id"),period:$("#asg-policy-second").val()*60,evaluationPeriods:$("#asg-policy-periods").val(),statistic:$("#asg-policy-statistics .selected").data("id"),threshold:$("#asg-policy-threshold").val()}},e.adjustmentType==="PercentChangeInCapacity"&&(e.minAdjustStep=$("#asg-policy-step").val()),e.sendNotification&&(t=$(".policy-sns-placeholder .selected").data(),t&&t.id&&t.name&&(e.topic={appId:t.id,name:t.name})),this.model.setPolicy(e),this.updateScalingPolicy(e),null},setNotification:function(){var e,t,n;return e={},t=!1,$("#property-asg-sns input[type = checkbox]").each(function(){var n;return n=$(this).is(":checked"),e[$(this).attr("data-key")]=n,n&&(t=!0),null}),t?$("#property-asg-sns-info").show():$("#property-asg-sns-info").hide(),n=this.wheatherHasNoti(),this.model.setNotification(e),this.processNotiTopic(n)},setHealthyCheckELBType:function(e){return this.model.setHealthCheckType("ELB"),$("#property-asg-elb-warn").toggle($("#property-asg-elb").is(":checked"))},setHealthyCheckEC2Type:function(e){return this.model.setHealthCheckType("EC2"),$("#property-asg-elb-warn").toggle($("#property-asg-elb").is(":checked"))}}),new u});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/property/asg/app_model",["../base/model","constant","Design","CloudResources"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var i,s,o,u,a,f,l;i=n.instance().component(e),i.type==="ExpandedAsg"&&(i=i.get("originalAsg"),e=i.get("id")),o={uid:e,name:i.get("name"),description:i.get("description"),minSize:i.get("minSize"),maxSize:i.get("maxSize"),capacity:i.get("capacity"),tags:i.tags(),isEditable:this.isAppEdit},this.set(o),f=n.instance().region(),s=(l=r(n.instance().credentialId(),t.RESTYPE.ASG,f).get(i.get("appId")))!=null?l.toJSON():void 0,s&&(this.set("hasData",!0),this.set("awsResName",s.AutoScalingGroupName),this.set("arn",s.id),this.set("createTime",s.CreatedTime),this.set("tagSet",s.tagSet),s.TerminationPolicies&&s.TerminationPolicies&&this.set("term_policy_brief",s.TerminationPolicies.join(" > ")),this.handleInstance(i,s));if(!this.isAppEdit&&i.type===t.RESTYPE.ASG){if(!s)return!1;this.set("lcName",s.LaunchConfigurationName),this.set("cooldown",s.DefaultCooldown),this.set("healCheckType",s.HealthCheckType),this.set("healthCheckGracePeriod",s.HealthCheckGracePeriod),this.set("notiTopicName",this.getNotificationTopicName()),this.handlePolicy(i,s),this.handleNotify(i,s)}else{o=i!=null?i.toJSON():void 0,o.uid=e,this.set(o),u=i.getLc();if(!u){this.set("emptyAsg",!0);return}this.set("has_elb",!!u.connections("ElbAmiAsso").length),this.set("isEC2HealthCheck",i.isEC2HealthCheckType()),this.set("detail_monitor",!!u.get("monitoring")),a=i.getNotification(),this.set("notification",a),this.set("has_notification",a.instanceLaunch||a.instanceLaunchError||a.instanceTerminate||a.instanceTerminateError||a.test),this.notiObject=i.getNotiObject(),this.set("policies",_.map(o.policies,function(e){return o=$.extend(!0,{},e.attributes),o.alarmData.period=Math.round(o.alarmData.period/60),o}))}return null},handleInstance:function(e,t){var n,r,i,s,o,u,a,f,l,c,h;o=0,u=[],f={};if(t.Instances&&t.Instances){o=t.Instances.length,h=t.Instances;for(i=l=0,c=h.length;l<c;i=++l)s=h[i],n={status:s.HealthStatus==="Healthy"?"green":"red",healthy:s.HealthStatus,name:s.InstanceId},r=s.AvailabilityZone,f[r]?f[r].push(n):f[r]=[n];for(r in f)a=f[r],u.push({name:r,instances:a})}else o=0;return this.set("instance_groups",u),this.set("instance_count",o)},handleNotify:function(e,i){var s,o,u,a,f,l,c,h,p;a=n.instance().region(),u=r(n.instance().credentialId(),t.RESTYPE.NC,a).findWhere({AutoScalingGroupName:i.AutoScalingGroupName}),f=!1,s=[!1,!1,!1,!1,!1],o={"autoscaling:EC2_INSTANCE_LAUNCH":0,"autoscaling:EC2_INSTANCE_LAUNCH_ERROR":1,"autoscaling:EC2_INSTANCE_TERMINATE":2,"autoscaling:EC2_INSTANCE_TERMINATE_ERROR":3,"autoscaling:TEST_NOTIFICATION":4};if(u){p=u.get("NotificationType");for(c=0,h=p.length;c<h;c++)l=p[c],s[o[l]]=!0,f=!0}return this.set("notifies",s),this.set("sendNotify",f)},handlePolicy:function(e,i){var s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L;h=[],f={},v=n.instance().region(),g=r(n.instance().credentialId(),t.RESTYPE.SP,v),l=r(n.instance().credentialId(),t.RESTYPE.CW,v),N=e.get("policies"),L=[];for(b=0,S=N.length;b<S;b++){m=N[b],d=(C=g.get(m.get("appId")))!=null?C.toJSON():void 0;if(!d)continue;p={adjusttype:d.AdjustmentType,adjustment:d.ScalingAdjustment,step:d.MinAdjustmentStep,cooldown:d.Cooldown,name:d.PolicyName,arn:m.get("appId")},a=(k=l.get(m.get("alarmData").appId))!=null?k.toJSON():void 0;if(a){u=[a.InsufficientDataActions,a.OKActions,a.AlarmActions],y=["INSUFFICIANT_DATA","OK","ALARM"];for(c=w=0,x=u.length;w<x;c=++w){o=u[c];if(!o)continue;for(E=0,T=o.length;E<T;E++){s=o[E];if(s!==p.arn)continue;p.arn="",p.evaluation=m.get("alarmData").comparisonOperator,p.metric=a.MetricName,p.notify=o.length===2,p.periods=a.EvaluationPeriods,p.minute=Math.round(a.Period/60),p.statistics=a.Statistic,p.threshold=a.Threshold,p.trigger=y[c]}}}else void 0;h.push(p),L.push(this.set("policies",_.sortBy(h,"name")))}return L},setHealthCheckType:function(e){return n.instance().component(this.get("uid")).set("healthCheckType",e)},setASGMin:function(e){var t;return t=this.get("uid"),n.instance().component(t).set("minSize",e),null},setASGMax:function(e){var t;return t=this.get("uid"),n.instance().component(t).set("maxSize",e),null},setASGDesireCapacity:function(e){var t;return t=this.get("uid"),n.instance().component(t).set("capacity",e),null},setASGCoolDown:function(e){return n.instance().component(this.get("uid")).set("cooldown",e)},setHealthCheckGrace:function(e){return n.instance().component(this.get("uid")).set("healthCheckGracePeriod",e)},setNotification:function(e){var t;return t=n.instance().component(this.get("uid")).setNotification(e),this.notiObject=t,null},removeTopic:function(){var e;return e=n.instance().component(this.get("uid")).setNotification(notification),e!=null?e.removeTopic():void 0},getNotificationTopicName:function(){return n.instance().component(this.get("uid")).getNotificationTopicName()},setNotificationTopic:function(e,t){return n.instance().component(this.get("uid")).setNotificationTopic(e,t)},setTerminatePolicy:function(e){return n.instance().component(this.get("uid")).set("terminationPolicies",e),this.set("terminationPolicies",e),null},delPolicy:function(e){return n.instance().component(e).remove(),null},isDupPolicyName:function(e,t){return _.some(n.instance().component(this.get("uid")).get("policies"),function(n){if(n.id!==e&&n.get("name")===t)return!0})},defaultScalingPolicyName:function(){var e,t,r,i,s;e=n.instance().component(this.get("uid")),e.type==="ExpandedAsg"&&(e=e.get("originalAsg")),s=e.get("policies"),t=s.length,i=""+this.attributes.name+"-policy-"+t,r=_.map(s,function(e){return e.get("name")});while(__indexOf.call(r,i)>=0)i=""+this.attributes.name+"-policy-"+ ++t;return i},getPolicy:function(e){var t;return t=$.extend(!0,{},n.instance().component(e).attributes),t.alarmData.period=Math.round(t.alarmData.period/60),t},setPolicy:function(e){var r,i,s,o;return s=n.instance().component(this.get("uid")),s.type==="ExpandedAsg"&&(s=s.get("originalAsg")),e.sendNotification&&n.modelClassForType(t.RESTYPE.TOPIC).ensureExistence(),e.uid?(o=n.instance().component(e.uid),i=e.alarmData,o.setAlarm(i),delete e.alarmData,o.set(e),e.alarmData=i):(r=n.modelClassForType(t.RESTYPE.SP),o=new r(e),s.addScalingPolicy(o),e.uid=o.id,this.get("policies").push(o!=null?o.toJSON():void 0)),e.sendNotification&&e.topic&&o.setTopic(e.topic.appId,e.topic.name),null}}),new i}),define("wspace/awseditor/property/asg/template/app",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.ASG_SUMMARY",{hash:{},data:t}))+'</div>\n  <div class="option-group">\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP.ASG_NAME",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.awsResName,typeof i===a?i.apply(e):i))+"</dd>\n      ",i=n.unless.call(e,e&&e.isEditable,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+="\n    </dl>\n    ",i=n["if"].call(e,e&&e.isEditable,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+='\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP.ASG_ARN",{hash:{},data:t}))+'</dt>\n      <dd class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_TIP_CLICK_TO_SELECT",{hash:{},data:t}))+'">'+u((i=e&&e.arn,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.ASG_CREATE_TIME",{hash:{},data:t}))+"</dt>\n      <dd>"+u(n.timeStr.call(e,e&&e.createTime,{hash:{},data:t}))+"</dd>\n\n    ",i=n["if"].call(e,e&&e.isEditable,{hash:{},inverse:f.program(8,d,t),fn:f.program(6,p,t),data:t});if(i||i===0)r+=i;return r+="\n  </div>\n  ",r}function c(e,t){var r="",i;return r+="\n      <dt>"+u(n.i18n.call(e,"PROP.NAME",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.name,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+"</dt>\n      <dd>"+u(n.emptyStr.call(e,e&&e.description,{hash:{},data:t}))+"</dd>\n      ",r}function h(e,t){var r="",i;return r+='\n    <section class="property-control-group">\n      <label class="left" for="property-asg-name" >'+u(n.i18n.call(e,"PROP.NAME",{hash:{},data:t}))+'</label>\n      <span class="required-input right">'+u(n.i18n.call(e,"PROP.ASG_REQUIRED",{hash:{},data:t}))+'</span>\n      <input class="input" type="text" value="'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'" id="property-asg-name" maxlength="255" data-ignore="true" data-required-rollback="true"/>\n    </section>\n    <section class="property-control-group">\n      <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n      <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===a?i.apply(e):i))+"</textarea>\n    </section>\n    ",r}function p(e,t){return"\n    </dl>\n    "}function d(e,t){var r="",i;return r+="\n      <dt>"+u(n.i18n.call(e,"PROP.LC_TITLE",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.lcName,typeof i===a?i.apply(e):i))+'</dd>\n    </dl>\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP.ASG_MIN_SIZE",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.minSize,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.ASG_MAX_SIZE",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.maxSize,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.ASG_DESIRE_CAPACITY",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.capacity,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.ASG_COOL_DOWN",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.cooldown,typeof i===a?i.apply(e):i))+'</dd>\n    </dl>\n    <dl class="dl-vertical">\n      <dt>'+u(n.i18n.call(e,"PROP.ASG_HEALTH_CHECK_TYPE",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.healCheckType,typeof i===a?i.apply(e):i))+"</dd>\n      <dt>"+u(n.i18n.call(e,"PROP.ASG_HEALTH_CHECK_CRACE_PERIOD",{hash:{},data:t}))+"</dt>\n      <dd>"+u((i=e&&e.healthCheckGracePeriod,typeof i===a?i.apply(e):i))+"</dd>\n    </dl>\n    ",r}function v(e,t){var n="",r;return n+='\n  <div class="property-control-group">\n    <p class="property-info tac">Auto Scaling Group '+u((r=e&&e.name,typeof r===a?r.apply(e):r))+" is deleted in stopped app.</p>\n  </div>\n  ",n}function m(e,t){var r="",i;r+='\n  <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.ASG_DETAILS",{hash:{},data:t}))+'</div>\n  <div class="option-group" data-bind="true">\n    <section class="property-control-group">\n      <div class="property-asg-size">\n        <label class="left" for="property-asg-min">'+u(n.i18n.call(e,"PROP.ASG_MIN_SIZE",{hash:{},data:t}))+'</label>\n        <input class="input" type="text" id="property-asg-min" value="'+u((i=e&&e.minSize,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true" data-required-rollback="true">\n      </div>\n      <div class="property-asg-size">\n        <label class="left" for="property-asg-max">'+u(n.i18n.call(e,"PROP.ASG_MAX_SIZE",{hash:{},data:t}))+'</label>\n        <input class="input" type="text" id="property-asg-max" value="'+u((i=e&&e.maxSize,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true" data-required-rollback="true">\n      </div>\n      <div class="property-asg-size">\n        <label class="left" for="property-asg-capacity">'+u(n.i18n.call(e,"PROP.ASG_DESIRE_CAPACITY",{hash:{},data:t}))+'</label>\n        <input class="input" type="text" id="property-asg-capacity" value="'+u((i=e&&e.capacity,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true">\n      </div>\n    </section>\n    <section class="property-control-group">\n      <label class="left" for="property-asg-cooldown">'+u(n.i18n.call(e,"PROP.ASG_COOL_DOWN",{hash:{},data:t}))+'</label>\n      <input class="input input-short" type="text" id="property-asg-cooldown" value="'+u((i=e&&e.cooldown,typeof i===a?i.apply(e):i))+'" data-type="digits" max="86400">\n      <span>'+u(n.i18n.call(e,"PROP.ASG_UNIT_SECONDS",{hash:{},data:t}))+'</span>\n    </section>\n\n    <section class="property-control-group clearfix">\n      <label clas="left">'+u(n.i18n.call(e,"PROP.ASG_HEALTH_CHECK_TYPE",{hash:{},data:t}))+'</label>\n      <div class="mgt5">\n        <div class="radio">\n          <input id="property-asg-ec2" type="radio" value="ec2" ',i=n["if"].call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(13,g,t),data:t});if(i||i===0)r+=i;r+=' name="property-asg-hc-option" />\n          <label for="property-asg-ec2"></label>\n        </div>\n        <label for="property-asg-ec2">EC2</label>\n      </div>\n      <div ',i=n.unless.call(e,e&&e.has_elb,{hash:{},inverse:f.program(17,b,t),fn:f.program(15,y,t),data:t});if(i||i===0)r+=i;r+='>\n        <div class="radio">\n          <input id="property-asg-elb" type="radio" ',i=n.unless.call(e,e&&e.has_elb,{hash:{},inverse:f.noop,fn:f.program(19,w,t),data:t});if(i||i===0)r+=i;r+=' value="elb" ',i=n.unless.call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(13,g,t),data:t});if(i||i===0)r+=i;r+=' name="property-asg-hc-option" />\n          <label for="property-asg-elb"></label>\n        </div>\n        <label for="property-asg-elb">ELB</label>\n        <p id="property-asg-elb-warn" class="hide property-info" ',i=n.unless.call(e,e&&e.isEC2HealthCheck,{hash:{},inverse:f.noop,fn:f.program(21,E,t),data:t});if(i||i===0)r+=i;return r+=">"+u(n.i18n.call(e,"PROP.ASG_ELB_WARN",{hash:{},data:t}))+'</p>\n      </div>\n    </section>\n\n    <section class="property-control-group">\n      <label class="left" for="property-asg-healthcheck">'+u(n.i18n.call(e,"PROP.ASG_HEALTH_CHECK_CRACE_PERIOD",{hash:{},data:t}))+'</label>\n      <input class="input input-short" type="text" id="property-asg-healthcheck" value="'+u((i=e&&e.healthCheckGracePeriod,typeof i===a?i.apply(e):i))+'" maxlength="255" data-type="digits" data-ignore="true">\n      <span>'+u(n.i18n.call(e,"PROP.ASG_UNIT_SECONDS",{hash:{},data:t}))+"</span>\n    </section>\n\n  </div>\n  ",r}function g(e,t){return'checked="true"'}function y(e,t){var r="";return r+='data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_HAS_ELB_WARN",{hash:{},data:t}))+'" class="mgt5 tooltip"',r}function b(e,t){return'class="mgt5"'}function w(e,t){return'disabled="disabled"'}function E(e,t){return' style="display: block"'}function S(e,t){var r="",i;r+='\n    <div class="option-group-head">'+u(n.i18n.call(e,"PROP.ASG_INSTANCE",{hash:{},data:t}))+' <span class="property-head-num-wrap">('+u((i=e&&e.instance_count,typeof i===a?i.apply(e):i))+')</span></div>\n    <div class="option-group">\n      ',i=n.each.call(e,e&&e.instance_groups,{hash:{},inverse:f.noop,fn:f.program(24,x,t),data:t});if(i||i===0)r+=i;return r+="\n    </div>\n  ",r}function x(e,t){var r="",i;r+='\n      <div class="mega-list-wraper-header">'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'</div>\n      <ul class="mega-list-wraper">\n        ',i=n.each.call(e,e&&e.instances,{hash:{},inverse:f.noop,fn:f.program(25,T,t),data:t});if(i||i===0)r+=i;return r+="\n      </ul>\n      ",r}function T(e,t){var n="",r;return n+='\n          <li><i class="status status-'+u((r=e&&e.status,typeof r===a?r.apply(e):r))+' icon-label tooltip" data-tooltip="'+u((r=e&&e.healthy,typeof r===a?r.apply(e):r))+'" ></i>'+u((r=e&&e.name,typeof r===a?r.apply(e):r))+"</li>\n        ",n}function N(e,t){var r="",i;r+='\n      <section class="property-control-group pos-r">\n        <h5>'+u(n.i18n.call(e,"PROP.ASG_TERMINATION_POLICY",{hash:{},data:t}))+'</h5>\n        <p class="termination-policy-brief">'+u(n.emptyStr.call(e,e&&e.term_policy_brief,{hash:{},data:t}))+'</p>\n      </section>\n      <ul id="property-asg-policies" class="mega-list-wraper">\n        ',i=n.each.call(e,e&&e.policies,{hash:{},inverse:f.noop,fn:f.program(28,C,t),data:t});if(i||i===0)r+=i;return r+="\n      </ul>\n    ",r}function C(e,t){var r="",i;r+='\n          <li class="pos-r" data-uid="'+u((i=e&&e.uid,typeof i===a?i.apply(e):i))+'">\n            <div class="property-asg-policy-name" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_NAME",{hash:{},data:t}))+'">'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+"</div>\n            ",i=n["if"].call(e,e&&e.arn,{hash:{},inverse:f.program(31,L,t),fn:f.program(29,k,t),data:t});if(i||i===0)r+=i;return r+="\n\n          </li>\n\n        ",r}function k(e,t){var r="",i;return r+='\n            <div class="click-select tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_TIP_CLICK_TO_SELECT",{hash:{},data:t}))+'">'+u((i=e&&e.arn,typeof i===a?i.apply(e):i))+"</div>\n            ",r}function L(e,t){var r="",i;return r+='\n            <span class="asg-p-metric asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ALARM_METRIC",{hash:{},data:t}))+'">'+u((i=e&&e.metric,typeof i===a?i.apply(e):i))+'</span>\n            <span class="asg-p-eval asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_THRESHOLD",{hash:{},data:t}))+'">'+u((i=e&&e.evaluation,typeof i===a?i.apply(e):i))+" "+u((i=e&&e.threshold,typeof i===a?i.apply(e):i))+u((i=e&&e.unit,typeof i===a?i.apply(e):i))+'</span>\n            <span class="asg-p-periods asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_PERIOD",{hash:{},data:t}))+'">'+u((i=e&&e.periods,typeof i===a?i.apply(e):i))+"x"+u((i=e&&e.minute,typeof i===a?i.apply(e):i))+'m</span>\n            <span class="asg-p-trigger asg-p-tag asg-p-trigger-'+u((i=e&&e.trigger,typeof i===a?i.apply(e):i))+'" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ACTION",{hash:{},data:t}))+'">'+u((i=e&&e.trigger,typeof i===a?i.apply(e):i))+'</span>\n            <span class="asg-p-adjust asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ADJUSTMENT",{hash:{},data:t}))+'">'+u((i=e&&e.adjustment,typeof i===a?i.apply(e):i))+" "+u((i=e&&e.adjusttype,typeof i===a?i.apply(e):i))+"</span>\n            ",r}function A(e,t){var r="",i;r+='\n      <section class="property-control-group pos-r property-term-p">\n        <h5>'+u(n.i18n.call(e,"PROP.ASG_TERMINATION_POLICY",{hash:{},data:t}))+'</h5>\n        <div class="termination-policy-brief">'+u((i=e&&e.term_policy_brief,typeof i===a?i.apply(e):i))+'</div>\n        <div class="asg-p-action"><i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_TERMINATION_EDIT",{hash:{},data:t}))+'" id="property-asg-term-edit"></i></div>\n      </section>\n      <ul id="property-asg-policies" class="mega-list-wraper">\n        <li class="pos-r hide">\n          <h5 class="property-asg-policy-name name"></h5>\n          <span class="asg-p-metric asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ALARM_METRIC",{hash:{},data:t}))+'"></span>\n          <span class="asg-p-eval asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_THRESHOLD",{hash:{},data:t}))+'"></span>\n          <span class="asg-p-periods asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_PERIOD",{hash:{},data:t}))+'"></span>\n          <span class="asg-p-trigger asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ACTION",{hash:{},data:t}))+'"></span>\n          <span class="asg-p-adjust asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ADJUSTMENT",{hash:{},data:t}))+'"></span>\n          <div class="asg-p-action">\n            <i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_EDIT",{hash:{},data:t}))+'"></i>\n            <i class="icon-del tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_REMOVE",{hash:{},data:t}))+'"></i>\n          </div>\n        </li>\n        ',i=n.each.call(e,e&&e.policies,{hash:{},inverse:f.noop,fn:f.program(34,O,t),data:t});if(i||i===0)r+=i;r+='\n\n      </ul>\n      <div class="property-control-group tac">\n        <button class="btn btn-blue btn-long ',i=n.unless.call(e,e&&e.can_add_policy,{hash:{},inverse:f.noop,fn:f.program(36,M,t),data:t});if(i||i===0)r+=i;return r+='" id="property-asg-policy-add" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_TIP_YOU_CAN_ONLY_ADD_25_SCALING_POLICIES",{hash:{},data:t}))+'">'+u(n.i18n.call(e,"PROP.ASG_BTN_ADD_SCALING_POLICY",{hash:{},data:t}))+"</button>\n      </div>\n    ",r}function O(e,t){var r="",i;return r+='\n        <li class="pos-r" data-uid="'+u((i=e&&e.id,typeof i===a?i.apply(e):i))+'" data-old="true">\n          <h5 class="property-asg-policy-name name" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_NAME",{hash:{},data:t}))+'">'+u((i=e&&e.name,typeof i===a?i.apply(e):i))+'</h5>\n          <span class="asg-p-metric asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ALARM_METRIC",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.metricName),typeof i===a?i.apply(e):i))+'</span>\n          <span class="asg-p-eval asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_THRESHOLD",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.comparisonOperator),typeof i===a?i.apply(e):i))+" "+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.threshold),typeof i===a?i.apply(e):i))+u((i=e&&e.unit,typeof i===a?i.apply(e):i))+'</span>\n          <span class="asg-p-periods asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_PERIOD",{hash:{},data:t}))+'">'+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.evaluationPeriods),typeof i===a?i.apply(e):i))+"x"+u((i=(i=e&&e.alarmData,i==null||i===!1?i:i.period),typeof i===a?i.apply(e):i))+'m</span>\n          <span class="asg-p-trigger asg-p-tag asg-p-trigger-'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ACTION",{hash:{},data:t}))+'">'+u((i=e&&e.state,typeof i===a?i.apply(e):i))+'</span>\n          <span class="asg-p-adjust asg-p-tag" title="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_ADJUSTMENT",{hash:{},data:t}))+'">'+u((i=e&&e.adjustment,typeof i===a?i.apply(e):i))+" "+u((i=e&&e.adjustmentType,typeof i===a?i.apply(e):i))+'</span>\n          <div class="asg-p-action">\n            <i class="icon-edit tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_EDIT",{hash:{},data:t}))+'"></i>\n            <i class="icon-remove icon-del tooltip" data-tooltip="'+u(n.i18n.call(e,"PROP.ASG_POLICY_TLT_REMOVE",{hash:{},data:t}))+'"></i>\n          </div>\n        </li>\n        ',r}function M(e,t){return"disabled tooltip"}function _(e,t){var r="",i;r+='\n      <dl class="dl-vertical">\n        ',i=n["if"].call(e,e&&e.sendNotify,{hash:{},inverse:f.program(50,I,t),fn:f.program(39,D,t),data:t});if(i||i===0)r+=i;return r+="\n\n        <dt>"+u(n.i18n.call(e,"PROP.SNS_TOPIC",{hash:{},data:t}))+"</dt>\n        <dd>"+u((i=e&&e.notiTopicName,typeof i===a?i.apply(e):i))+"</dd>\n      </dl>\n\n    ",r}function D(e,t){var r="",i;r+="\n        <dt>"+u(n.i18n.call(e,"PROP.ASG_LBL_SEND_NOTIFICATION",{hash:{},data:t}))+"</dt>\n          ",i=n["if"].call(e,(i=e&&e.notifies,i==null||i===!1?i:i[0]),{hash:{},inverse:f.noop,fn:f.program(40,P,t),data:t});if(i||i===0)r+=i;r+="\n          ",i=n["if"].call(e,(i=e&&e.notifies,i==null||i===!1?i:i[1]),{hash:{},inverse:f.noop,fn:f.program(42,H,t),data:t});if(i||i===0)r+=i;r+="\n          ",i=n["if"].call(e,(i=e&&e.notifies,i==null||i===!1?i:i[2]),{hash:{},inverse:f.noop,fn:f.program(44,B,t),data:t});if(i||i===0)r+=i;r+="\n          ",i=n["if"].call(e,(i=e&&e.notifies,i==null||i===!1?i:i[3]),{hash:{},inverse:f.noop,fn:f.program(46,j,t),data:t});if(i||i===0)r+=i;r+="\n          ",i=n["if"].call(e,(i=e&&e.notifies,i==null||i===!1?i:i[4]),{hash:{},inverse:f.noop,fn:f.program(48,F,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function P(e,t){var r="";return r+="<dd>"+u(n.i18n.call(e,"PROP.ASG_LBL_SUCCESS_INSTANCES_LAUNCH",{hash:{},data:t}))+"</dd>",r}function H(e,t){var r="";return r+="<dd>"+u(n.i18n.call(e,"PROP.ASG_LBL_FAILED_INSTANCES_LAUNCH",{hash:{},data:t}))+"</dd>",r}function B(e,t){var r="";return r+="<dd>"+u(n.i18n.call(e,"PROP.ASG_LBL_SUCCESS_INSTANCES_TERMINATE",{hash:{},data:t}))+"</dd>",r}function j(e,t){var r="";return r+="<dd>"+u(n.i18n.call(e,"PROP.ASG_LBL_FAILED_INSTANCES_TERMINATE",{hash:{},data:t}))+"</dd>",r}function F(e,t){var r="";return r+="<dd>"+u(n.i18n.call(e,"PROP.ASG_LBL_VALIDATE_SNS",{hash:{},data:t}))+"</dd>",r}function I(e,t){var r="";return r+='\n        <dd class="property-info tac">'+u(n.i18n.call(e,"PROP.ASG_MSG_NO_NOTIFICATION_WARN",{hash:{},data:t}))+"</dd>\n        ",r}function q(e,t){var r="",i;r+='\n      <div class="property-control-group property-asg-notification-wrap">\n        <p>'+u(n.i18n.call(e,"PROP.ASG_LBL_SEND_NOTIFICATION",{hash:{},data:t}))+'</p>\n        <div><div class="checkbox">\n          <input id="property-asg-sns1" type="checkbox" data-key="instanceLaunch" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceLaunch),{hash:{},inverse:f.noop,fn:f.program(53,R,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="property-asg-sns1"></label>\n        </div>\n        <label for="property-asg-sns1">'+u(n.i18n.call(e,"PROP.ASG_LBL_SUCCESS_INSTANCES_LAUNCH",{hash:{},data:t}))+'</label></div>\n\n        <div><div class="checkbox">\n          <input id="property-asg-sns2" type="checkbox" data-key="instanceLaunchError" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceLaunchError),{hash:{},inverse:f.noop,fn:f.program(53,R,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="property-asg-sns2"></label>\n        </div>\n        <label for="property-asg-sns2">'+u(n.i18n.call(e,"PROP.ASG_LBL_FAILED_INSTANCES_LAUNCH",{hash:{},data:t}))+'</label></div>\n\n        <div><div class="checkbox">\n          <input id="property-asg-sns3" type="checkbox" data-key="instanceTerminate" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceTerminate),{hash:{},inverse:f.noop,fn:f.program(53,R,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="property-asg-sns3"></label>\n        </div>\n        <label for="property-asg-sns3">'+u(n.i18n.call(e,"PROP.ASG_LBL_SUCCESS_INSTANCES_TERMINATE",{hash:{},data:t}))+'</label></div>\n\n        <div><div class="checkbox">\n          <input id="property-asg-sns4" type="checkbox" data-key="instanceTerminateError" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.instanceTerminateError),{hash:{},inverse:f.noop,fn:f.program(53,R,t),data:t});if(i||i===0)r+=i;r+='/>\n          <label for="property-asg-sns4"></label>\n        </div>\n        <label for="property-asg-sns4">'+u(n.i18n.call(e,"PROP.ASG_LBL_FAILED_INSTANCES_TERMINATE",{hash:{},data:t}))+'</label></div>\n\n        <div><div class="checkbox">\n          <input id="property-asg-sns5" type="checkbox" data-key="test" ',i=n["if"].call(e,(i=e&&e.notification,i==null||i===!1?i:i.test),{hash:{},inverse:f.noop,fn:f.program(53,R,t),data:t});if(i||i===0)r+=i;return r+='/>\n          <label for="property-asg-sns5"></label>\n        </div>\n        <label for="property-asg-sns5">'+u(n.i18n.call(e,"PROP.ASG_LBL_VALIDATE_SNS",{hash:{},data:t}))+'</label></div>\n\n      </div>\n      <div class="property-control-group sns-group" style="display:none;">\n        <label for="sns-placeholder">'+u(n.i18n.call(e,"PROP.SELECT_SNS_TOPIC",{hash:{},data:t}))+'</label>\n        <div id="sns-placeholder"></div>\n      </div>\n    ',r}function R(e,t){return'checked="checked"'}function U(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(56,z,t),data:t});if(i||i===0)r+=i;return r+="\n    ",r}function z(e,t){var r="",i;r+='\n    <div class="option-group-head">\n        '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n    </div>\n    <div class="option-group">\n      ',i=n["if"].call(e,e&&e.tagSet,{hash:{},inverse:f.program(60,V,t),fn:f.program(57,W,t),data:t});if(i||i===0)r+=i;return r+='\n        <div class="tags-action">\n          \n        </div>\n    </div>\n    ',r}function W(e,t){var r="",i;r+='\n      <table class="table cost-estimation-table">\n        <tbody>\n        ',i=n.each.call(e,e&&e.tagSet,{hash:{},inverse:f.noop,fn:f.program(58,X,t),data:t});if(i||i===0)r+=i;return r+="\n        </tbody>\n      </table>\n      ",r}function X(e,t){var n="",r;return n+='\n        <tr> <td style="min-width:70px;">'+u((r=t==null||t===!1?t:t.key,typeof r===a?r.apply(e):r))+"</td><td>"+u(typeof e===a?e.apply(e):e)+"</td> </tr>\n        ",n}function V(e,t){var r="";return r+='\n      <div class="empty-tag">'+u(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</div>\n      ",r}function $(e,t){var r="",i;r+='\n    <div class="option-group-head expand">\n      '+u(n.i18n.call(e,"PROP.RESOURCE_TAGS",{hash:{},data:t}))+'\n    </div>\n    <div class="option-group">\n      ',i=n["if"].call(e,(i=e&&e.tags,i==null||i===!1?i:i.length),{hash:{},inverse:f.program(60,V,t),fn:f.program(63,J,t),data:t});if(i||i===0)r+=i;return r+='\n      <div class="tags-action">\n        \n        <button class="btn open-tag-manager modal-confirm btn-blue">'+u(n.i18n.call(e,"PROP.RESOURCE_EDIT_TAG",{hash:{},data:t}))+"</button>\n      </div>\n    </div>\n    ",r}function J(e,t){var r="",i;r+='\n      <table class="table cost-estimation-table">\n        <tbody>\n        ',i=n.each.call(e,e&&e.tags,{hash:{},inverse:f.noop,fn:f.program(64,K,t),data:t});if(i||i===0)r+=i;return r+="\n        </tbody>\n      </table>\n      ",r}function K(e,t){var n="",r;return n+='\n        <tr> <td style="min-width:70px;">'+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.key),typeof r===a?r.apply(e):r))+"</td><td>"+u((r=(r=e&&e.attributes,r==null||r===!1?r:r.value),typeof r===a?r.apply(e):r))+"</td> </tr>\n        ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-app" data-bind="true">\n  ',o=n["if"].call(t,t&&t.hasData,{hash:{},inverse:f.program(10,v,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n["if"].call(t,t&&t.isEditable,{hash:{},inverse:f.noop,fn:f.program(12,m,i),data:i});if(o||o===0)s+=o;s+="\n\n  ",o=n["if"].call(t,t&&t.hasData,{hash:{},inverse:f.noop,fn:f.program(23,S,i),data:i});if(o||o===0)s+=o;s+='\n\n  <div class="option-group-head">'+u(n.i18n.call(t,"PROP.ASG_POLICY",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n\n    ',o=n.unless.call(t,t&&t.isEditable,{hash:{},inverse:f.program(33,A,i),fn:f.program(27,N,i),data:i});if(o||o===0)s+=o;s+='\n\n\n  </div>\n\n  <div class="option-group-head">'+u(n.i18n.call(t,"PROP.ASG_LBL_NOTIFICATION",{hash:{},data:i}))+'</div>\n  <div class="option-group" id="property-asg-sns">\n\n    ',o=n.unless.call(t,t&&t.isEditable,{hash:{},inverse:f.program(52,q,i),fn:f.program(38,_,i),data:i});if(o||o===0)s+=o;s+="\n  </div>\n    ",o=n.unless.call(t,t&&t.isEditable,{hash:{},inverse:f.program(62,$,i),fn:f.program(55,U,i),data:i});if(o||o===0)s+=o;return s+="\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/asg/app_view",["../base/view","./template/app","./template/policy","./template/term","i18n!/nls/lang.js","sns_dropdown","UI.modalplus"],function(e,t,n,r,i,s,o){var u,a,f,l,c,h;return c={CPUUtilization:i.PROP.ASG_POLICY_CPU,DiskReadBytes:i.PROP.ASG_POLICY_DISC_READS,DiskReadOps:i.PROP.ASG_POLICY_DISK_READ_OPERATIONS,DiskWriteBytes:i.PROP.ASG_POLICY_DISK_WRITES,DiskWriteOps:i.PROP.ASG_POLICY_DISK_WRITE_OPERATIONS,NetworkIn:i.PROP.ASG_POLICY_NETWORK_IN,NetworkOut:i.PROP.ASG_POLICY_NETWORK_OUT,StatusCheckFailed:i.PROP.ASG_POLICY_STATUS_CHECK_FAILED_ANY,StatusCheckFailed_Instance:i.PROP.ASG_POLICY_STATUS_CHECK_FAILED_INSTANCE,StatusCheckFailed_System:i.PROP.ASG_POLICY_STATUS_CHECK_FAILED_SYSTEM},a={ChangeInCapacity:i.PROP.ASG_ADD_POLICY_ADJUSTMENT_CHANGE,ExactCapacity:i.PROP.ASG_ADD_POLICY_ADJUSTMENT_EXACT,PercentChangeInCapacity:i.PROP.ASG_ADD_POLICY_ADJUSTMENT_PERCENT},l={ChangeInCapacity:i.PROP.EG_MINUS_1,ExactCapacity:i.PROP.EG_5,PercentChangeInCapacity:i.PROP.EG_MINUS_30},f={ChangeInCapacity:i.PROP.ASG_ADJUST_TOOLTIP_CHANGE,ExactCapacity:i.PROP.ASG_ADJUST_TOOLTIP_EXACT,PercentChangeInCapacity:i.PROP.ASG_ADJUST_TOOLTIP_PERCENT},h={CPUUtilization:"%",DiskReadBytes:"B",DiskWriteBytes:"B",NetworkIn:"B",NetworkOut:"B"},u=e.extend({events:{"change #property-asg-min":"setSizeGroup","change #property-asg-max":"setSizeGroup","change #property-asg-capacity":"setSizeGroup","click #property-asg-term-edit":"showTermPolicy","click #property-asg-sns input[type=checkbox]":"setNotification","change #property-asg-elb":"setHealthyCheckELBType","change #property-asg-ec2":"setHealthyCheckEC2Type","change #property-asg-cooldown":"setASGCoolDown","change #property-asg-healthcheck":"setHealthCheckGrace","click #property-asg-policy-add":"addScalingPolicy","click #property-asg-policies .icon-edit":"editScalingPolicy","click #property-asg-policies .icon-del":"delScalingPolicy","change #property-res-desc":"onChangeDescription","change #property-asg-name":"setASGName"},onChangeDescription:function(e){return this.model.setDesc($(e.currentTarget).val())},setASGName:function(e){var t,n;n=$(e.currentTarget),t=n.val();if(MC.aws.aws.checkResName(this.model.get("uid"),n,"ASG"))return this.model.setName(t),this.setTitle(t)},setASGCoolDown:function(e){var t;t=$(e.target),t.parsley("custom",function(e){return _.isNumber(+e)&&+e>86400?i.PARSLEY.MAX_VALUE_86400:null});if(t.parsley("validate"))return this.model.setASGCoolDown(t.val())},setHealthCheckGrace:function(e){return this.model.setHealthCheckGrace(e.target.value)},showTermPolicy:function(){var e,t,n,s,u,a,f,l,c,h,p,d;t=[],e={},p=this.model.get("terminationPolicies");for(f=0,c=p.length;f<c;f++)u=p[f],u==="Default"?t.useDefault=!0:(t.push({name:u,checked:!0,text:u}),e[u]=!0);d=["OldestInstance","NewestInstance","OldestLaunchConfiguration","ClosestToNextInstanceHour"];for(l=0,h=d.length;l<h;l++)s=d[l],e[s]||t.push({name:s,checked:!1,text:s});return n=new o({title:i.PROP.ASG_TERMINATION_EDIT,width:420,template:r(t),confirm:{text:i.PROP.LBL_DONE}}),a=this,n.on("confirm",function(){return a.onEditTermPolicy(),n.close()}),$("#property-asg-term").on("click","input",function(){var t,n;return t=$("#property-asg-term").find("input:checked"),t.length===0?!1:(n=$(this),e=n.is(":checked"),n.closest("li").toggleClass("enabled",e))}),$("#property-asg-term").on("mousedown",".drag-handle",function(){return $(this).trigger("mouseleave")}),$("#property-term-list").sortable({handle:".drag-handle"})},onEditTermPolicy:function(){var e;return e=[],$("#property-term-list .list-name").each(function(){var t;return t=$(this),t.closest("li").hasClass("enabled")&&e.push(t.data("name")),null}),$("#property-asg-term-def").is(":checked")&&e.push("Default"),$(".termination-policy-brief").text(this.getTerminationPoliciesText(e)),this.model.setTerminatePolicy(e)},delScalingPolicy:function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.data("uid"),t.remove(),$("#property-asg-policy-add").removeClass("tooltip disabled"),this.model.delPolicy(n)},updateScalingPolicy:function(e){var t,n,r,i,s;i=c[e.alarmData.metricName],r=a[e.adjustmentType],s=h[e.alarmData.metricName]||"";if(!e.uid){void 0;return}return n=$("#property-asg-policies"),t=n.children("[data-uid='"+e.uid+"']"),t.length===0&&(t=n.children(".hide").clone().attr("data-uid",e.uid).removeClass("hide").appendTo(n),$("#property-asg-policy-add").toggleClass("tooltip disabled",$("#property-asg-policies").children().length>=26)),t.find(".name").html(e.name),t.find(".asg-p-metric").html(i),t.find(".asg-p-eval").html(e.alarmData.comparisonOperator+" "+e.alarmData.threshold+s),t.find(".asg-p-periods").html(e.alarmData.evaluationPeriods+"x"+Math.round(e.alarmData.period/60)+"m"),t.find(".asg-p-trigger").html(e.state).attr("class","asg-p-trigger asg-p-tag asg-p-trigger-"+e.state),t.find(".asg-p-adjust").html(e.adjustment+" "+e.adjustmentType)},editScalingPolicy:function(e){var t,n,r,s,o,u,a,f,l,c,h,p,d,v;n=$(e.currentTarget).closest("li"),c=n.data("uid"),u=n.data("old"),o=this.model.getPolicy(c),o.uid=c,o.title=i.PROP.ASG_ADD_POLICY_TITLE_EDIT,o.isOld=u,this.showScalingPolicy(o),l={metric:o.alarmData.metricName,eval:o.alarmData.comparisonOperator,trigger:o.state,"adjust-type":o.adjustmentType,statistics:o.alarmData.statistic};for(f in l){h=l[f],r=$("#asg-policy-"+f),s=null,v=r.find(".item");for(p=0,d=v.length;p<d;p++){a=v[p],t=$(a);if(t.data("id")===h){s=t;break}}s&&(r.find(".selected").removeClass("selected"),r.find(".selection").html(s.addClass("selected").html()))}return $(".pecentcapcity").toggle($("#asg-policy-adjust-type").find(".selected").data("id")==="PercentChangeInCapacity")},addScalingPolicy:function(e){return $(e.currentTarget).hasClass("disabled")?!1:(this.showScalingPolicy(),!1)},openPolicyModal:function(e){var t,r,s;return r={template:n(e),title:i.PROP.ASG_ADD_POLICY_TITLE_ADD,width:"480px",compact:!0,confirm:{text:"Done"}},t=new o(r),s=this,t.on("confirm",function(){var e;return e=$("#asg-termination-policy").parsley("validate"),e===!1?!1:(s.onPolicyDone(),t.close())},this)},showScalingPolicy:function(e){var t,n,r,o;return e||(e={title:i.PROP.ASG_ADD_POLICY_TITLE_ADD,name:this.model.defaultScalingPolicyName(),minAdjustStep:1,alarmData:{evaluationPeriods:2,period:5}}),e.uid&&(t=Design.instance().component(e.uid)),e.alarmData&&e.alarmData.metricName?e.unit=h[e.alarmData.metricName]:e.unit="%",e.detail_monitor=this.model.attributes.detail_monitor,this.openPolicyModal(e),r=this,$("#asg-policy-name").parsley("custom",function(e){var t;t=$("#property-asg-policy").data("uid");if(r.model.isDupPolicyName(t,e))return i.PARSLEY.DUPLICATED_POLICY_NAME}),$("#asg-policy-periods").on("change",function(){var e;e=parseInt($(this).val(),10),(!e||e<1)&&$(this).val("1");if(e>86400)return $(this).val(86400)}),$("#asg-policy-second").on("change",function(){var e;e=parseInt($(this).val(),10),(!e||e<1)&&$(this).val("1");if(e>1440)return $(this).val(1440)}),$("#asg-policy-adjust-type").on("OPTION_CHANGE",function(){var e;return e=$(this).find(".selected").data("id"),e==="PercentChangeInCapacity"?($(".pecentcapcity").toggle(!0),$("#asg-policy-step").val()===""&&$("#asg-policy-step").val(1)):$(".pecentcapcity").toggle(!1),$("#asg-policy-adjust").attr("placeholder",l[e]).data("tooltip",f[e]).trigger("change")}),$("#asg-policy-adjust").on("change",function(){var e,t;return e=$("#asg-policy-adjust-type").find(".selected").data("id"),t=parseInt($(this).val(),10),e==="ExactCapacity"?(!t||t<1)&&$(this).val("1"):e==="PercentChangeInCapacity"&&(t?t<-100&&$(this).val("-100"):$(this).val("0")),t<-65534?$(this).val(-65534):t>65534&&$(this).val(65534),$("#").data("tooltip",f[e]).trigger("change")}),$("#asg-policy-cooldown").on("change",function(){var e,t;e=$("#asg-policy-cooldown"),t=parseInt(e.val(),10);if(isNaN(t))return;return t<0?t=0:t>86400&&(t=86400),e.val(t)}),$("#asg-policy-step").on("change",function(){var e,t;e=$("#asg-policy-step"),t=parseInt(e.val(),10);if(isNaN(t))return;return t<0?t=0:t>65534&&(t=65534),e.val(t)}),$("#asg-policy-threshold").on("change",function(){var e,t;e=$("#asg-policy-metric .selected").data("id"),t=parseInt($(this).val(),10);if(e==="CPUUtilization"){if(isNaN(t)||t<1)return $(this).val("1");if(t>100)return $(this).val("100")}}),n=t?t.getTopicName():null,o=new s({selection:n}),this.processPolicyTopic($("#asg-policy-notify").prop("checked"),o,!1),$("#asg-policy-notify").off("click").on("click",function(e){return e.stopPropagation(),r.processPolicyTopic(e.target.checked,o,!0),null}),$("#asg-policy-metric").on("OPTION_CHANGE",function(){return $("#asg-policy-unit").html(h[$(this).find(".selected").data("id")]||""),$("#asg-policy-threshold").val("")}),null},onPolicyDone:function(){var e,t;return e={uid:$("#property-asg-policy").data("uid"),name:$("#asg-policy-name").val(),cooldown:$("#asg-policy-cooldown").val(),minAdjustStep:"",adjustment:$("#asg-policy-adjust").val(),adjustmentType:$("#asg-policy-adjust-type .selected").data("id"),state:$("#asg-policy-trigger .selected").data("id"),sendNotification:$("#asg-policy-notify").is(":checked"),alarmData:{metricName:$("#asg-policy-metric .selected").data("id"),comparisonOperator:$("#asg-policy-eval .selected").data("id"),period:$("#asg-policy-second").val()*60,evaluationPeriods:$("#asg-policy-periods").val(),statistic:$("#asg-policy-statistics .selected").data("id"),threshold:$("#asg-policy-threshold").val()}},e.adjustmentType==="PercentChangeInCapacity"&&(e.minAdjustStep=$("#asg-policy-step").val()),e.sendNotification&&(t=$(".policy-sns-placeholder .selected").data(),t&&t.id&&t.name&&(e.topic={appId:t.id,name:t.name})),this.model.setPolicy(e),this.updateScalingPolicy(e),null},setNotification:function(){var e,t,n;return e={},t=!1,$("#property-asg-sns input[type = checkbox]").each(function(){var n;return n=$(this).is(":checked"),e[$(this).attr("data-key")]=n,n&&(t=!0),null}),t?$("#property-asg-sns-info").show():$("#property-asg-sns-info").hide(),n=this.wheatherHasNoti(),this.model.setNotification(e),this.processNotiTopic(n)},setHealthyCheckELBType:function(e){return this.model.setHealthCheckType("ELB"),$("#property-asg-elb-warn").toggle($("#property-asg-elb").is(":checked"))},setHealthyCheckEC2Type:function(e){return this.model.setHealthCheckType("EC2"),$("#property-asg-elb-warn").toggle($("#property-asg-elb").is(":checked"))},render:function(){var e,n,r,i,o,u;r=this.model.getNotificationTopicName(),this.snsNotiDropdown=new s({selection:r}),this.snsNotiDropdown.on("change",this.model.setNotificationTopic,this.model),e=this.model.toJSON();if(e.isEditable){u=e.policies;for(i=0,o=u.length;i<o;i++)n=u[i],n.alarmData.metricName=c[n.alarmData.metricName],n.unit=h[n.alarmData.metricName],n.adjustmentType=a[n.adjustmentType],n.isNew=!n.appId;e.term_policy_brief=this.getTerminationPoliciesText(e.terminationPolicies),e.can_add_policy=e.policies.length<25}return this.$el.html(t(e)),this.processNotiTopic(null,!0),e.name},getTerminationPoliciesText:function(e){return _.map(e,function(e){return e}).join(" > ")},wheatherHasNoti:function(){var e,t;return e=(t=this.model.notiObject)!=null?t.toJSON():void 0,e&&(e.instanceLaunch||e.instanceLaunchError||e.instanceTerminate||e.instanceTerminateError||e.test)},processNotiTopic:function(e,t){var n;n=this.wheatherHasNoti();if(t&&n)return this.$("#sns-placeholder").html(this.snsNotiDropdown.render().el),this.$(".sns-group").show();if(!e&&n)return this.$("#sns-placeholder").html(this.snsNotiDropdown.render(!0).el),this.$(".sns-group").show();if(e&&!n)return this.model.removeTopic(),this.$(".sns-group").hide()},processPolicyTopic:function(e,t,n){return e?($(".policy-sns-placeholder").html(t.render(n).el),$(".sns-policy-field").show()):$(".sns-policy-field").hide()},setSizeGroup:function(e){var t,n,r,s;s=this,r=this.$el.find("#property-asg-min"),n=this.$el.find("#property-asg-max"),t=this.$el.find("#property-asg-capacity"),r.parsley("custom",function(e){return+e>+n.val()?i.PARSLEY.MINIMUM_SIZE_MUST_BE_LESSTHAN_MAXIMUM_SIZE:s.constantCheck(e)}),n.parsley("custom",function(e){return+e<+r.val()?i.PARSLEY.MINIMUM_SIZE_MUST_BE_LESSTHAN_MAXIMUM_SIZE:s.constantCheck(e)}),t.parsley("custom",function(e){return+e<+r.val()||+e>+n.val()?i.PARSLEY.DESIRED_CAPACITY_IN_ALLOW_SCOPE:s.constantCheck(e)});if($(e.currentTarget).parsley("validateForm"))return this.model.setASGMin(r.val()),this.model.setASGMax(n.val()),this.model.setASGDesireCapacity(t.val())},constantCheck:function(e){return e=+e,e>65534?sprintf(i.PARSLEY.VALUE_MUST_BE_LESSTHAN_VAR,65534):null}}),new u}),define("wspace/awseditor/property/asg/main",["../base/main","./model","./view","constant","./app_model","./app_view"],function(e,t,n,r,i,s){var o;return o=e.extend({handleTypes:[r.RESTYPE.ASG,"ExpandedAsg"],initStack:function(){return this.model=t,this.view=n,null},initApp:function(){return this.model=i,this.model.isAppEdit=!1,this.view=s,null},initAppEdit:function(){return this.model=i,this.model.isAppEdit=!0,this.view=s,null}}),null}),define("wspace/awseditor/property/dbinstance/model",["../base/model","constant","event","i18n!/nls/lang.js"],function(e,t,n,r){var i;return i=e.extend({init:function(e){var t,n;return n=Design.instance().component(e),t=n!=null?n.toJSON():void 0,t.uid=e,this.set(t),null}}),new i}),define("wspace/awseditor/property/dbinstance/template/stack_instance",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,e&&e.isCanPromote,{hash:{},inverse:a.noop,fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;r+="\n    ",i=n["if"].call(e,e&&e.isPromoted,{hash:{},inverse:a.program(6,p,t),fn:a.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n    ",r}function c(e,t){var r="";return r+='\n    <section class="property-control-group property-dbinstance-promote-replica hide">\n        <button class="btn btn-primary btn-long" id="property-dbinstance-promote-replica" >'+u(n.i18n.call(e,"PROP.DBINSTANCE_READ_REPLICA",{hash:{},data:t}))+"</button>\n    </section>\n    ",r}function h(e,t){var r="";return r+='\n    <section class="property-control-group property-dbinstance-promote-replica hide">\n        <button class="btn" id="property-dbinstance-promote-replica" style="width: 200px;">'+u(n.i18n.call(e,"PROP.DBINSTANCE_CANCEL_PROMOTE",{hash:{},data:t}))+"</button>\n    </section>\n    ",r}function p(e,t){var r="",i;r+='\n    <section class="property-control-group apply-immediately-section ',i=n.unless.call(e,e&&e.isChanged,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;r+='">\n        <div class="checkbox">\n            <input id="property-dbinstance-apply-immediately" type="checkbox" ',i=n["if"].call(e,e&&e.applyImmediately,{hash:{},inverse:a.noop,fn:a.program(9,v,t),data:t});if(i||i===0)r+=i;return r+=' value="None" name="property-dbinstance-apply-immediately">\n            <label for="property-dbinstance-apply-immediately"></label>\n        </div>\n        <label for="property-dbinstance-apply-immediately">'+u(n.i18n.call(e,"PROP.DBINSTANCE_APPLY_IMMEDIATELY",{hash:{},data:t}))+'</label>\n        <a class="tooltip icon-info" href="http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.html#Overview.DBInstance.Modifying" data-tooltip="'+u(n.i18n.call(e,"PROP.DBINSTANCE_APPLY_IMMEDIATELY_LINK_TOOLTIP",{hash:{},data:t}))+'" target="_blank"></a>\n    </section>\n    ',r}function d(e,t){return"hide"}function v(e,t){return'checked="true"'}function m(e,t){var r="",i;r+='\n    <div class="option-group-head expand">\n        '+u(n.i18n.call(e,"PROP.DBINSTANCE_DETAILS",{hash:{},data:t}))+"\n        ",i=n["if"].call(e,e&&e.isRestoreDB,{hash:{},inverse:a.noop,fn:a.program(12,g,t),data:t});if(i||i===0)r+=i;r+='\n    </div>\n    <div class="option-group">\n\n        ',i=n["if"].call(e,e&&e.isRestoreDB,{hash:{},inverse:a.noop,fn:a.program(14,y,t),data:t});if(i||i===0)r+=i;r+="\n\n        ",i=n["if"].call(e,e&&e.snapshotId,{hash:{},inverse:a.noop,fn:a.program(16,b,t),data:t});if(i||i===0)r+=i;r+="\n\n        ",i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(18,w,t),data:t});if(i||i===0)r+=i;r+='\n\n        <section class="property-control-group" >\n            <label class="left" for="property-dbinstance-name" >'+u(n.i18n.call(e,"PROP.DBINSTANCE_APP_DBINSTANCE_ID",{hash:{},data:t}))+'</label>\n            <span class="required-input right">'+u(n.i18n.call(e,"PROP.INSTANCE_REQUIRE",{hash:{},data:t}))+'</span>\n            <input class="input" type="text" value="'+u((i=e&&e.name,typeof i===f?i.apply(e):i))+'" id="property-dbinstance-name" data-ignore="true" data-required-rollback="true"/>\n        </section>\n\n        <section class="property-control-group" data-bind="true">\n          <label class="left" for="property-res-desc">'+u(n.i18n.call(e,"PROP.DESCRIPTION",{hash:{},data:t}))+'</label>\n          <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((i=e&&e.description,typeof i===f?i.apply(e):i))+'</textarea>\n        </section>\n\n        <div id ="lvia-container"></div>\n\n        <section class="property-control-group">\n            <div class="checkbox">\n                <input id="property-dbinstance-version-update" type="checkbox" ',i=n["if"].call(e,e&&e.autoMinorVersionUpgrade,{hash:{},inverse:a.noop,fn:a.program(9,v,t),data:t});if(i||i===0)r+=i;r+=' value="None" name="property-dbinstance-version-update">\n                <label for="property-dbinstance-version-update"></label>\n            </div>\n            <label for="property-dbinstance-version-update">'+u(n.i18n.call(e,"PROP.DBINSTANCE_AUTO_MINOR_VERSION_UPDATE",{hash:{},data:t}))+"</label>\n        </section>\n\n        ",i=n.unless.call(e,e&&e.isRestoreDB,{hash:{},inverse:a.noop,fn:a.program(20,E,t),data:t});if(i||i===0)r+=i;r+="\n\n        ",i=n.ifLogic.call(e,e&&e.isRestoreDB,"and",e&&e.isSqlserver,{hash:{},inverse:a.program(29,k,t),fn:a.program(27,C,t),data:t});if(i||i===0)r+=i;r+="\n\n        ",i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(37,_,t),data:t});if(i||i===0)r+=i;r+="\n\n        ",i=n.unless.call(e,e&&e.isRestoreDB,{hash:{},inverse:a.noop,fn:a.program(39,D,t),data:t});if(i||i===0)r+=i;r+='\n\n    </div>\n\n    <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.DBINSTANCE_DATABASE_CONFIG",{hash:{},data:t}))+'</div>\n    <div class="option-group">\n\n        ',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:a.program(58,W,t),fn:a.program(51,q,t),data:t});if(i||i===0)r+=i;r+='\n\n        <div class="property-control-group clearfix property-dbinstance-optiongroup"></div>\n\n        ',i=n.unless.call(e,e&&e.isRestoreDB,{hash:{},inverse:a.noop,fn:a.program(65,K,t),data:t});if(i||i===0)r+=i;r+="\n\n    </div>\n\n    ",i=n.unless.call(e,e&&e.hideAZConfig,{hash:{},inverse:a.noop,fn:a.program(71,Z,t),data:t});if(i||i===0)r+=i;return r+="\n\n    ",r}function g(e,t){return'<a href="#" class="icon-rds-restore tooltip property-btn-db-restore-config" data-tooltip="Restore to point in time config" ></a>'}function y(e,t){var n="",r;return n+='\n        <section class="property-control-group clearfix">\n            <label>Source DB Instance</label>\n            <div>'+u((r=e&&e.sourceDbIdForRestore,typeof r===f?r.apply(e):r))+"</div>\n        </section>\n        ",n}function b(e,t){var r="",i;return r+='\n        <section class="property-control-group clearfix">\n            <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_DBSNAPSHOT_ID",{hash:{},data:t}))+"</label>\n            <div>"+u((i=e&&e.snapshotId,typeof i===f?i.apply(e):i))+'</div>\n        </section>\n        <section class="property-control-group clearfix">\n            <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_DBSNAPSHOT_SIZE",{hash:{},data:t}))+"</label>\n            <div>"+u((i=e&&e.snapshotSize,typeof i===f?i.apply(e):i))+"GiB</div>\n        </section>\n        ",r}function w(e,t){var r="",i;return r+='\n        <section class="property-control-group clearfix">\n            <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_APP_DBINSTANCE_ID",{hash:{},data:t}))+"</label>\n            <div>"+u((i=e&&e.DBInstanceIdentifier,typeof i===f?i.apply(e):i))+"</div>\n        </section>\n        ",r}function E(e,t){var r="",i;r+='\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_ALLOCATED_STORAGE",{hash:{},data:t}))+'</label>\n            <span class="required-input right">'+u(n.i18n.call(e,"PROP.INSTANCE_REQUIRE",{hash:{},data:t}))+'</span>\n            <div class="ranged-number-input">\n                <label for="property-dbinstance-storage"></label>\n                <input id="property-dbinstance-storage" type="text" class="input parsley-validated input-short tooltip" value="'+u((i=e&&e.allocatedStorage,typeof i===f?i.apply(e):i))+'" name="property-dbinstance-storage" data-ignore="true" maxlength="4" data-required="true" data-type="number" ',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(21,S,t),data:t});if(i||i===0)r+=i;r+='>\n                <label for="property-dbinstance-storage">GB</label>\n            </div>\n            ',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(24,T,t),data:t});if(i||i===0)r+=i;return r+="\n        </section>\n        ",r}function S(e,t){var r;return r=n["if"].call(e,e&&e.isSqlserver,{hash:{},inverse:a.noop,fn:a.program(22,x,t),data:t}),r||r===0?r:""}function x(e,t){var r="";return r+='disabled data-tooltip="'+u(n.i18n.call(e,"PROP.DBINSTANCE_SCALLING_NOT_SUPPORT",{hash:{},data:t}))+'"',r}function T(e,t){var r="",i;r+="\n                ",i=n["if"].call(e,e&&e.originAllocatedStorage,{hash:{},inverse:a.noop,fn:a.program(25,N,t),data:t});if(i||i===0)r+=i;return r+="\n            ",r}function N(e,t){var r="",i;return r+='\n                <div class="property-info">'+u(n.i18n.call(e,"PROP.DBINSTANCE_CURRENT_ALLOCATED_STORAGE",{hash:{},data:t}))+u((i=e&&e.originAllocatedStorage,typeof i===f?i.apply(e):i))+" GB</div>\n                ",r}function C(e,t){return"\n        "}function k(e,t){var r="",i;r+='\n        <section class="property-control-group">\n            <label class="left">'+u(n.i18n.call(e,"PROP.DBINSTANCE_STORAGE_TYPE",{hash:{},data:t}))+'</label>\n            <div class="selectbox" id="property-dbinstance-storage-type">\n                <div class="selection"></div>\n                <ul class="dropdown" tabindex="-1">\n                    <li class="item ',i=n.ifCond.call(e,e&&e.storageType,"gp2",{hash:{},inverse:a.noop,fn:a.program(30,L,t),data:t});if(i||i===0)r+=i;r+='" data-id="gp2">General Purpose (SSD)</li>\n                    <li class="item ',i=n.ifCond.call(e,e&&e.storageType,"io1",{hash:{},inverse:a.noop,fn:a.program(30,L,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,e&&e.iops,{hash:{},inverse:a.noop,fn:a.program(30,L,t),data:t});if(i||i===0)r+=i;r+='" ',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(32,A,t),data:t});if(i||i===0)r+=i;r+=' data-id="io1">Provisioned IOPS (SSD)</li>\n                    <li class="item ',i=n.ifCond.call(e,e&&e.storageType,"standard",{hash:{},inverse:a.noop,fn:a.program(30,L,t),data:t});if(i||i===0)r+=i;r+='" data-id="standard">Magnetic</li>\n                </ul>\n            </div>\n        </section>\n        <section class="property-control-group property-dbinstance-iops-value-section ',i=n.unless.call(e,e&&e.iops,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;r+='">\n            <label class="left">'+u(n.i18n.call(e,"PROP.DBINSTANCE_PROVISIONED_IOPS",{hash:{},data:t}))+'</label>\n            <div class="ranged-number-input">\n                <input class="input" id="property-dbinstance-iops-value" ',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(34,O,t),data:t});if(i||i===0)r+=i;return r+=' type="text" value="'+u((i=e&&e.iops,typeof i===f?i.apply(e):i))+'" name="iops-ranged" data-ignore="true" data-required="true" data-type="number">\n                <label for="property-dbinstance-iops-value"></label>\n            </div>\n            <div class="property-info">'+u((i=e&&e.iopsInfo,typeof i===f?i.apply(e):i))+"</div>\n        </section>\n        ",r}function L(e,t){return"selected"}function A(e,t){var r;return r=n["if"].call(e,e&&e.isSqlserver,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t}),r||r===0?r:""}function O(e,t){var r;return r=n["if"].call(e,e&&e.isSqlserver,{hash:{},inverse:a.noop,fn:a.program(35,M,t),data:t}),r||r===0?r:""}function M(e,t){return"disabled"}function _(e,t){var r="",i;r+='\n        <div class="property-info property-info-iops-adjust-tip ',i=n.ifCond.call(e,e&&e.originIOPS,e&&e.iops,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;r+=" ",i=n.unless.call(e,e&&e.originIOPS,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;return r+='">'+u(n.i18n.call(e,"PROP.DBINSTANCE_IOPS_AVAILABILITY_IMPACT",{hash:{},data:t}))+"</div>\n        ",r}function D(e,t){var r="",i;r+="\n        ",i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:a.program(42,H,t),fn:a.program(40,P,t),data:t});if(i||i===0)r+=i;r+='\n\n        <section class="property-control-group" >\n            <label class="left" for="property-dbinstance-master-password" >'+u(n.i18n.call(e,"PROP.DBINSTANCE_MASTER_PASSWORD",{hash:{},data:t}))+'</label>\n            <span class="required-input right">'+u(n.i18n.call(e,"PROP.INSTANCE_REQUIRE",{hash:{},data:t}))+'</span>\n            <input class="input tooltip" data-tooltip="',i=n.ifCond.call(e,e&&e.password,"****",{hash:{},inverse:a.program(46,j,t),fn:a.program(44,B,t),data:t});if(i||i===0)r+=i;r+='" type="password" placeholder="****" id="property-dbinstance-master-password" value="',i=n.ifCond.call(e,e&&e.password,"****",{hash:{},inverse:a.program(49,I,t),fn:a.program(44,B,t),data:t});if(i||i===0)r+=i;return r+='" data-type="ascii" data-ignore="true" data-required="true"/>\n        </section>\n        ',r}function P(e,t){var r="",i;return r+='\n        <section class="property-control-group clearfix">\n            <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_USERNAME",{hash:{},data:t}))+"</label>\n            <div>"+u((i=e&&e.MasterUsername,typeof i===f?i.apply(e):i))+"</div>\n        </section>\n        ",r}function H(e,t){var r="",i;return r+='\n        <section class="property-control-group" >\n            <label class="left" for="property-dbinstance-master-username" >'+u(n.i18n.call(e,"PROP.DBINSTANCE_MASTER_USERNAME",{hash:{},data:t}))+'</label>\n            <span class="required-input right">'+u(n.i18n.call(e,"PROP.INSTANCE_REQUIRE",{hash:{},data:t}))+'</span>\n            <input class="input"  type="text" id="property-dbinstance-master-username" value="'+u((i=e&&e.username,typeof i===f?i.apply(e):i))+'" data-ignore-regexp="^[a-zA-Z]+[0-9a-zA-Z_]*$" data-required-rollback="true"/>\n        </section>\n        ',r}function B(e,t){var n="";return n}function j(e,t){var r;return r=n["if"].call(e,e&&e.password,{hash:{},inverse:a.noop,fn:a.program(47,F,t),data:t}),r||r===0?r:""}function F(e,t){return"Default Password: 12345678"}function I(e,t){var n;return u((n=e&&e.password,typeof n===f?n.apply(e):n))}function q(e,t){var r="",i;r+='\n        <section class="property-control-group clearfix">\n            ',i=n["if"].call(e,e&&e.dbName,{hash:{},inverse:a.noop,fn:a.program(52,R,t),data:t});if(i||i===0)r+=i;r+="\n            <label>"+u(n.i18n.call(e,"PROP.DBINSTANCE_PORT",{hash:{},data:t}))+"</label>\n            <div>",i=n["if"].call(e,e&&e.Endpoint,{hash:{},inverse:a.program(56,z,t),fn:a.program(54,U,t),data:t});if(i||i===0)r+=i;return r+="</div>\n        </section>\n        ",r}function R(e,t){var r="",i;return r+="<label>"+u(n.i18n.call(e,"PROP.DATABASE_NAME",{hash:{},data:t}))+"</label>\n            <div>"+u((i=e&&e.dbName,typeof i===f?i.apply(e):i))+"</div>",r}function U(e,t){var n;return u((n=(n=e&&e.Endpoint,n==null||n===!1?n:n.Port),typeof n===f?n.apply(e):n))}function z(e,t){return u(n.i18n.call(e,"PROP.DBINSTANCE_NOT_READY",{hash:{},data:t}))}function W(e,t){var r="",i;r+="\n\n        ",i=n.unless.call(e,e&&e.isRestoreDB,{hash:{},inverse:a.noop,fn:a.program(59,X,t),data:t});if(i||i===0)r+=i;return r+='\n\n        <section class="property-control-group" >\n            <label class="left" for="property-dbinstance-database-port" >'+u(n.i18n.call(e,"PROP.DBINSTANCE_DATABASE_PORT",{hash:{},data:t}))+'</label>\n            <input class="input"  type="text" id="property-dbinstance-database-port" value="'+u((i=e&&e.port,typeof i===f?i.apply(e):i))+'" data-ignore="true" data-type="number" data-required="true" data-min="1150" data-max="65535"/>\n        </section>\n        ',r}function X(e,t){var r="",i;r+="\n        ",i=n.unless.call(e,e&&e.isSqlserver,{hash:{},inverse:a.noop,fn:a.program(60,V,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function V(e,t){var r="",i;r+="\n        ",i=n.unless.call(e,e&&e.snapshotId,{hash:{},inverse:a.program(63,J,t),fn:a.program(61,$,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function $(e,t){var r="",i;return r+='\n        <section class="property-control-group" >\n            <label class="left" for="property-dbinstance-database-name" >'+u(n.i18n.call(e,"PROP.DBINSTANCE_DATABASE_NAME",{hash:{},data:t}))+'</label>\n            <input class="input"  type="text" id="property-dbinstance-database-name" value="'+u((i=e&&e.dbName,typeof i===f?i.apply(e):i))+'" data-ignore="true" data-required="true" data-ignore-regexp="^[a-zA-Z]+[0-9a-zA-Z_]*$"/>\n        </section>\n        ',r}function J(e,t){var r="",i;r+="\n        ",i=n.unless.call(e,e&&e.isMysql,{hash:{},inverse:a.noop,fn:a.program(61,$,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function K(e,t){var r="",i;r+="\n        ",i=n.unless.call(e,e&&e.snapshotId,{hash:{},inverse:a.noop,fn:a.program(66,Q,t),data:t});if(i||i===0)r+=i;r+="\n\n        ",i=n["if"].call(e,e&&e.isOracle,{hash:{},inverse:a.noop,fn:a.program(68,G,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function Q(e,t){var r="";return r+='\n        <section class="property-control-group">\n            <label class="left">'+u(n.i18n.call(e,"PROP.DBINSTANCE_PG",{hash:{},data:t}))+'</label>\n            <div id="property-dbinstance-parameter-group-select">\n            </div>\n        </section>\n        ',r}function G(e,t){var r="",i;r+='\n        <section class="property-control-group">\n            <label class="left">'+u(n.i18n.call(e,"PROP.DBINSTANCE_CHARACTER_SET_NAME",{hash:{},data:t}))+'</label>\n            <div class="selectbox combo-dd" id="property-dbinstance-charset-select">\n                <div class="selection"></div>\n                <div class="dropdown">\n                    <div class="scroll-wrap scrollbar-auto-hide clearfix">\n                        <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n                        <div class="scroll-content">\n                            <ul>\n                                ',i=n.each.call(e,e&&e.oracleCharset,{hash:{},inverse:a.noop,fn:a.program(69,Y,t),data:t});if(i||i===0)r+=i;return r+="\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </section>\n        ",r}function Y(e,t){var r="",i;r+='\n                                <li class="item ',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(30,L,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+u((i=e&&e.charset,typeof i===f?i.apply(e):i))+'">'+u((i=e&&e.charset,typeof i===f?i.apply(e):i))+"</li>\n                                ",r}function Z(e,t){var r="",i;r+='\n\n    <div class="option-group-head expand">'+u(n.i18n.call(e,"PROP.DBINSTANCE_NETWORK_AZ_DEPLOYMENT",{hash:{},data:t}))+'</div>\n    <div class="option-group">\n        ',i=n.unless.call(e,e&&e.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(72,et,t),data:t});if(i||i===0)r+=i;return r+='\n\n        <div id="property-dbinstance-mutil-az"></div>\n\n    </div>\n\n    ',r}function et(e,t){var r="",i;r+='\n        <section class="property-control-group">\n            <div class="checkbox">\n                <input id="property-dbinstance-public-access-check" type="checkbox" ',i=n["if"].call(e,e&&e.accessible,{hash:{},inverse:a.noop,fn:a.program(9,v,t),data:t});if(i||i===0)r+=i;return r+=' value="None" name="property-dbinstance-public-access-check">\n                <label for="property-dbinstance-public-access-check"></label>\n            </div>\n            <label for="property-dbinstance-public-access-check">'+u(n.i18n.call(e,"PROP.DBINSTANCE_PUBLICLY_ACCESSIBLE",{hash:{},data:t}))+"</label>\n        </section>\n        ",r}function tt(e,t){var r="",i;r+='\n    <div class="option-group-head ',i=n["if"].call(e,e&&e.isPromoted,{hash:{},inverse:a.noop,fn:a.program(75,nt,t),data:t});if(i||i===0)r+=i;r+='">'+u(n.i18n.call(e,"PROP.DBINSTANCE_BACKUP_OPTION",{hash:{},data:t}))+'</div>\n    <div class="option-group">\n\n        <section class="property-control-group tooltip" ',i=n["if"].call(e,e&&e.hasSlave,{hash:{},inverse:a.program(79,it,t),fn:a.program(77,rt,t),data:t});if(i||i===0)r+=i;r+='>\n\n            <div class="checkbox">\n                <input id="property-dbinstance-auto-backup-check" type="checkbox" ',i=n["if"].call(e,e&&e.backupRetentionPeriod,{hash:{},inverse:a.noop,fn:a.program(9,v,t),data:t});if(i||i===0)r+=i;r+=' value="None" name="property-dbinstance-auto-backup-check" ',i=n["if"].call(e,e&&e.hasSlave,{hash:{},inverse:a.noop,fn:a.program(82,ot,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,e&&e.disableBackupForOldMySQL,{hash:{},inverse:a.noop,fn:a.program(35,M,t),data:t});if(i||i===0)r+=i;r+='>\n                <label for="property-dbinstance-auto-backup-check"></label>\n            </div>\n            <label for="property-dbinstance-auto-backup-check">'+u(n.i18n.call(e,"PROP.DBINSTANCE_ENABLE_AUTOMATIC_BACKUP",{hash:{},data:t}))+'</label>\n        </section>\n\n        <div id="property-dbinstance-auto-backup-group" class="',i=n.unless.call(e,e&&e.backupRetentionPeriod,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;r+='">\n\n            <section id="group-dbinstance-backup-period" class="property-control-group ',i=n.unless.call(e,e&&e.backupRetentionPeriod,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;r+='" >\n                <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_BACKUP_RETENTION_PERIOD",{hash:{},data:t}))+'</label>\n                <input class="input input-shorter" value="'+u((i=e&&e.backupRetentionPeriod,typeof i===f?i.apply(e):i))+'" id="property-dbinstance-backup-period" type="text" data-type="digits" data-min="1" data-max="35" data-ignore="true">\n                <label class="property-label-right" for="property-dbinstance-backup-period">'+u(n.i18n.call(e,"PROP.DBINSTANCE_BACK_RETANTION_PERIOD_DAY",{hash:{},data:t}))+'</label>\n            </section>\n\n            <section id="property-dbinstance-backup-window-select" class="property-control-group">\n                <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_BACKUP_WINDOW",{hash:{},data:t}))+'</label>\n                <div class="mgt5">\n                    <div class="radio">\n                        <input id="property-dbinstance-backup-radio-no" name="property-dbinstance-backup-radio" type="radio" ',i=n.unless.call(e,e&&e.backupWindow,{hash:{},inverse:a.noop,fn:a.program(84,ut,t),data:t});if(i||i===0)r+=i;r+=' value="no">\n                        <label for="property-dbinstance-backup-radio-no"></label>\n                    </div>\n                    <label for="property-dbinstance-backup-radio-no">'+u(n.i18n.call(e,"PROP.DBINSTANCE_NO_PREFERENCE",{hash:{},data:t}))+'</label>\n                </div>\n                <div class="mgt5">\n                    <div class="radio">\n                        <input id="property-dbinstance-backup-radio-window" name="property-dbinstance-backup-radio" type="radio" ',i=n["if"].call(e,e&&e.backupWindow,{hash:{},inverse:a.noop,fn:a.program(84,ut,t),data:t});if(i||i===0)r+=i;r+=' value="window">\n                        <label for="property-dbinstance-backup-radio-window"></label>\n                    </div>\n                    <label for="property-dbinstance-backup-radio-window">'+u(n.i18n.call(e,"PROP.DBINSTANCE_SELECT_WINDOW",{hash:{},data:t}))+'</label>\n                </div>\n            </section>\n\n            <section id="property-dbinstance-backup-window-group" class="',i=n.unless.call(e,e&&e.backupWindow,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;r+=' property-control-group">\n                <section class="property-control-group">\n                    <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_START_TIME",{hash:{},data:t}))+'</label>\n                    <input class="input input-shorter" type="text" id="property-dbinstance-backup-window-start-time" value="'+u((i=(i=e&&e.backup,i==null||i===!1?i:i.startTime),typeof i===f?i.apply(e):i))+'" data-ignore="true" data-ignore-regexp="^[0-9:]*$"/>\n                    <label>UTC</label>\n                </section>\n                <section class="property-control-group">\n                    <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_DURATION",{hash:{},data:t}))+'</label>\n                    <div class="selectbox" id="property-dbinstance-backup-window-duration">\n                        <div class="selection"></div>\n                        <ul class="dropdown">\n                            ',i=n.each.call(e,e&&e.backupDurations,{hash:{},inverse:a.noop,fn:a.program(86,at,t),data:t});if(i||i===0)r+=i;r+='\n                        </ul>\n                    </div>\n                    <label for="property-dbinstance-maintenance-window-duration">'+u(n.i18n.call(e,"PROP.DBINSTANCE_BACKUP_DURATION_HOUR",{hash:{},data:t}))+"</label>\n                </section>\n            </section>\n\n            ",i=n["if"].call(e,e&&e.originBackupWindow,{hash:{},inverse:a.noop,fn:a.program(88,ft,t),data:t});if(i||i===0)r+=i;r+="\n        </div>\n    </div>\n\n    ",i=n.unless.call(e,e&&e.isPromoted,{hash:{},inverse:a.noop,fn:a.program(90,lt,t),data:t});if(i||i===0)r+=i;r+="\n\n    ",i=n.unless.call(e,e&&e.isRestoreDB,{hash:{},inverse:a.noop,fn:a.program(95,pt,t),data:t});if(i||i===0)r+=i;return r+="\n\n    ",r}function nt(e,t){return"expand"}function rt(e,t){var r="";return r+='data-tooltip="'+u(n.i18n.call(e,"PROP.DBINSTANCE_REPLICA_MUST_ENABLE_AUTOMATIC_BACKUPS",{hash:{},data:t}))+'"',r}function it(e,t){var r;return r=n["if"].call(e,e&&e.disableBackupForOldMySQL,{hash:{},inverse:a.noop,fn:a.program(80,st,t),data:t}),r||r===0?r:""}function st(e,t){return'data-tooltip="DB Backups not supported on a read replica running a mysql version before 5.6"'}function ot(e,t){return"disabled checked"}function ut(e,t){return'checked="checked"'}function at(e,t){var r="",i;r+='\n                            <li class="item ',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(30,L,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+u((i=e&&e.value,typeof i===f?i.apply(e):i))+'">'+u((i=e&&e.value,typeof i===f?i.apply(e):i))+"</li>\n                            ",r}function ft(e,t){var r="",i;return r+='\n            <section class="property-control-group">\n                <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_CURRENT_BACKUP_WINDOW",{hash:{},data:t}))+u((i=e&&e.originBackupWindow,typeof i===f?i.apply(e):i))+"</label>\n            </section>\n            ",r}function lt(e,t){var r="",i;r+='\n    <div class="option-group-head">'+u(n.i18n.call(e,"PROP.DBINSTANCE_MAINTENANCE_OPTION",{hash:{},data:t}))+'</div>\n    <div class="option-group">\n\n        <section id="property-dbinstance-maintenance-window-select" class="property-control-group">\n            <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_MAINTENANCE_WINDOW",{hash:{},data:t}))+'</label>\n            <div class="mgt5">\n                <div class="radio">\n                    <input id="property-dbinstance-maintenance-radio-no" name="property-dbinstance-maintenance-radio" type="radio" ',i=n.unless.call(e,e&&e.maintenanceWindow,{hash:{},inverse:a.noop,fn:a.program(84,ut,t),data:t});if(i||i===0)r+=i;r+=' value="no">\n                    <label for="property-dbinstance-maintenance-radio-no"></label>\n                </div>\n                <label for="property-dbinstance-maintenance-radio-no">'+u(n.i18n.call(e,"PROP.DBINSTANCE_NO_PREFERENCE",{hash:{},data:t}))+'</label>\n            </div>\n            <div class="mgt5">\n                <div class="radio">\n                    <input id="property-dbinstance-maintenance-radio-window" name="property-dbinstance-maintenance-radio" type="radio" ',i=n["if"].call(e,e&&e.maintenanceWindow,{hash:{},inverse:a.noop,fn:a.program(84,ut,t),data:t});if(i||i===0)r+=i;r+=' value="window">\n                    <label for="property-dbinstance-maintenance-radio-window"></label>\n                </div>\n                <label for="property-dbinstance-maintenance-radio-window">'+u(n.i18n.call(e,"PROP.DBINSTANCE_SELECT_WINDOW",{hash:{},data:t}))+'</label>\n            </div>\n        </section>\n\n        <section id="property-dbinstance-maintenance-window-group" class="property-control-group ',i=n.unless.call(e,e&&e.maintenanceWindow,{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(i||i===0)r+=i;r+='">\n            <section class="property-control-group" >\n                <label class="left">'+u(n.i18n.call(e,"PROP.DBINSTANCE_MAINTENANCE_START_DAY",{hash:{},data:t}))+'</label>\n                <div class="selectbox" id="property-dbinstance-maintenance-window-start-day-select">\n                    <div class="selection">'+u(n.i18n.call(e,"PROP.WEEKDAY_MONDAY",{hash:{},data:t}))+'</div>\n                    <ul class="dropdown" tabindex="-1">\n                        <li class="item" data-id="mon">'+u(n.i18n.call(e,"PROP.WEEKDAY_MONDAY",{hash:{},data:t}))+'</li>\n                        <li class="item" data-id="tue">'+u(n.i18n.call(e,"PROP.WEEKDAY_TUESDAY",{hash:{},data:t}))+'</li>\n                        <li class="item" data-id="wed">'+u(n.i18n.call(e,"PROP.WEEKDAY_WEDNESDAY",{hash:{},data:t}))+'</li>\n                        <li class="item" data-id="thu">'+u(n.i18n.call(e,"PROP.WEEKDAY_THURSDAY",{hash:{},data:t}))+'</li>\n                        <li class="item" data-id="fri">'+u(n.i18n.call(e,"PROP.WEEKDAY_FRIDAY",{hash:{},data:t}))+'</li>\n                        <li class="item" data-id="sat">'+u(n.i18n.call(e,"PROP.WEEKDAY_SATURDAY",{hash:{},data:t}))+'</li>\n                        <li class="item" data-id="sun">'+u(n.i18n.call(e,"PROP.WEEKDAY_SUNDAY",{hash:{},data:t}))+'</li>\n                    </ul>\n                </div>\n            </section>\n            <section class="property-control-group" >\n                <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_START_TIME",{hash:{},data:t}))+'</label>\n                <input class="input input-shorter" type="text" id="property-dbinstance-maintenance-window-start-time" value="'+u((i=(i=e&&e.maintenance,i==null||i===!1?i:i.startTime),typeof i===f?i.apply(e):i))+'" data-required-rollback="true" data-ignore="true" data-ignore-regexp="^[0-9:]*$"/>\n                <label>UTC</label>\n            </section>\n            <section class="property-control-group" >\n                <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_DURATION",{hash:{},data:t}))+'</label>\n                <div class="selectbox" id="property-dbinstance-maintenance-window-duration">\n                    <div class="selection"></div>\n                    <ul class="dropdown" tabindex="-1">\n                        ',i=n.each.call(e,e&&e.maintenanceDurations,{hash:{},inverse:a.noop,fn:a.program(91,ct,t),data:t});if(i||i===0)r+=i;r+='\n                    </ul>\n                </div>\n                <label for="property-dbinstance-maintenance-window-duration">'+u(n.i18n.call(e,"PROP.DBINSTANCE_BACKUP_DURATION_HOUR",{hash:{},data:t}))+"</label>\n            </section>\n\n        </section>\n\n        ",i=n["if"].call(e,e&&e.originMaintenanceWindow,{hash:{},inverse:a.noop,fn:a.program(93,ht,t),data:t});if(i||i===0)r+=i;return r+="\n    </div>\n    ",r}function ct(e,t){var r="",i;r+='\n                        <li class="item ',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:a.noop,fn:a.program(30,L,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+u((i=e&&e.value,typeof i===f?i.apply(e):i))+'">'+u((i=e&&e.value,typeof i===f?i.apply(e):i))+"</li>\n                        ",r}function ht(e,t){var r="",i;return r+='\n        <section class="property-control-group">\n            <label>'+u(n.i18n.call(e,"PROP.DBINSTANCE_CURRENT_BACKUP_WINDOW",{hash:{},data:t}))+" <br/>"+u((i=e&&e.originMaintenanceWindow,typeof i===f?i.apply(e):i))+"</label>\n        </section>\n        ",r}function pt(e,t){var r="",i;r+="\n    ",i=n["if"].call(e,e&&e.snapshotId,{hash:{},inverse:a.program(97,vt,t),fn:a.program(96,dt,t),data:t});if(i||i===0)r+=i;return r+="\n    ",r}function dt(e,t){var r="",i;r+="\n\n    ",i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:a.program(99,mt,t),fn:a.program(97,vt,t),data:t});if(i||i===0)r+=i;return r+="\n\n    ",r}function vt(e,t){var r="";return r+='\n    <div class="option-group-head" id="sg-head">'+u(n.i18n.call(e,"PROP.INSTANCE_SG_DETAIL",{hash:{},data:t}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n    <div class="option-group sg-group"></div>\n    ',r}function mt(e,t){return"\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<article class="property-dbinstance" data-bind="true">\n\n    <div class="property-dbinstance-not-available-info property-warning-block hide">\n        '+u(n.i18n.call(t,"PROP.DBINSTANCE_NOT_AVAILABLE",{hash:{},data:i}))+"\n    </div>\n\n    ",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n    ",o=n.unless.call(t,t&&t.isPromoted,{hash:{},inverse:a.noop,fn:a.program(11,m,i),data:i});if(o||o===0)s+=o;s+="\n\n\n    ",o=n.unless.call(t,t&&t.isRestoreDB,{hash:{},inverse:a.noop,fn:a.program(74,tt,i),data:i});if(o||o===0)s+=o;return s+="\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/dbinstance/template/stack_replica",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n        <dl class="dl-vertical">\n            <dt>'+u(n.i18n.call(e,"PROP.DBINSTANCE_MASTER_DB_INSTANCE",{hash:{},data:t}))+"</dt>\n            <dd>"+u((i=e&&e.sourceDbName,typeof i===a?i.apply(e):i))+"</dd>\n        </dl>\n        ",r}function c(e,t){var r="",i;r+='\n                    <li class="',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+='tooltip item" data-id="'+u((i=e&&e.instanceClass,typeof i===a?i.apply(e):i))+'">\n                        <div class="main truncate">'+u((i=e&&e.instanceClass,typeof i===a?i.apply(e):i))+'</div>\n                        <div class="sub"><span>'+u((i=e&&e.ecu,typeof i===a?i.apply(e):i))+"</span> <span>"+u((i=e&&e.cpu,typeof i===a?i.apply(e):i))+"</span> <span>"+u((i=e&&e.memory,typeof i===a?i.apply(e):i))+"</span></div>\n                    </li>\n                    ",r}function h(e,t){return"selected "}function p(e,t){return'checked="true"'}function d(e,t){var r="",i;r+='\n        <section class="property-control-group">\n            <label class="left">'+u(n.i18n.call(e,"PROP.DBINSTANCE_STORAGE_TYPE",{hash:{},data:t}))+'</label>\n            <div class="selectbox" id="property-dbinstance-storage-type">\n                <div class="selection"></div>\n                <ul class="dropdown" tabindex="-1">\n                    <li class="item ',i=n.ifCond.call(e,e&&e.storageType,"gp2",{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+='" data-id="gp2">General Purpose (SSD)</li>\n                    <li class="item ',i=n.ifCond.call(e,e&&e.storageType,"io1",{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,e&&e.iops,{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+='" ',i=n["if"].call(e,e&&e.isAppEdit,{hash:{},inverse:f.noop,fn:f.program(11,m,t),data:t});if(i||i===0)r+=i;r+=' data-id="io1">Provisioned IOPS (SSD)</li>\n                    <li class="item ',i=n.ifCond.call(e,e&&e.storageType,"standard",{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;return r+='" data-id="standard">Magnetic</li>\n                </ul>\n            </div>\n        </section>\n        ',r}function v(e,t){return"selected"}function m(e,t){var r;return r=n["if"].call(e,e&&e.isSqlserver,{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t}),r||r===0?r:""}function g(e,t){return"hide"}function y(e,t){var r="",i;r+='\n\n        <div class="property-control-group clearfix">\n            ',i=n.unless.call(e,e&&e.multiAz,{hash:{},inverse:f.program(18,E,t),fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+="\n        </div>\n\n    ",r}function b(e,t){var r="",i;r+="\n                ",i=n["if"].call(e,e&&e.AvailabilityZone,{hash:{},inverse:f.noop,fn:f.program(16,w,t),data:t});if(i||i===0)r+=i;return r+="\n            ",r}function w(e,t){var r="",i;return r+="\n                    <label>"+u(n.i18n.call(e,"PROP.DBINSTANCE_PREFERRED_ZONE",{hash:{},data:t}))+"</label>\n                    <div>"+u((i=e&&e.AvailabilityZone,typeof i===a?i.apply(e):i))+"</div>\n                ",r}function E(e,t){var r="",i;r+="\n                ",i=n["if"].call(e,e&&e.SecondaryAvailabilityZone,{hash:{},inverse:f.noop,fn:f.program(19,S,t),data:t});if(i||i===0)r+=i;return r+="\n            ",r}function S(e,t){var r="",i;return r+="\n                <label>"+u(n.i18n.call(e,"PROP.DBINSTANCE_SECONDARY_ZONE",{hash:{},data:t}))+"</label>\n                <div>"+u((i=e&&e.SecondaryAvailabilityZone,typeof i===a?i.apply(e):i))+"</div>\n                ",r}function x(e,t){var r="",i;r+="\n\n        ",i=n["if"].call(e,e&&e.azNotEnough,{hash:{},inverse:f.program(24,N,t),fn:f.program(22,T,t),data:t});if(i||i===0)r+=i;return r+="\n\n    ",r}function T(e,t){var r="";return r+='\n        <section class="property-control-group">\n            <div class="property-info">'+u(n.i18n.call(e,"PROP.DBINSTANCE_SUBNETGROUP_NOT_SETUP",e&&e.subnetGroupName,e&&e.subnetGroupName,{hash:{},data:t}))+"</div>\n        </section>\n        ",r}function N(e,t){var r="",i;r+='\n        <section class="property-control-group property-dbinstance-preferred-az ',i=n["if"].call(e,e&&e.multiAz,{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;return r+='">\n            <label class="left">'+u(n.i18n.call(e,"PROP.DBINSTANCE_PREFERRED_ZONE",{hash:{},data:t}))+'</label>\n            <div class="selectbox" id="property-dbinstance-preferred-az"></div>\n        </section>\n        ',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<article class="property-dbinstance">\n    <div class="option-group-head expand">'+u(n.i18n.call(t,"PROP.DBINSTANCE_DETAILS",{hash:{},data:i}))+'</div>\n    <div class="option-group">\n\n        ',o=n["if"].call(t,t&&t.sourceDbName,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n\n        <section class="property-control-group" data-bind="true">\n            <label class="left" for="property-dbinstance-name" >'+u(n.i18n.call(t,"PROP.DATABASE_NAME",{hash:{},data:i}))+'</label>\n            <span class="required-input right">'+u(n.i18n.call(t,"PROP.INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n            <input class="input"  type="text" value="'+u((o=t&&t.name,typeof o===a?o.apply(t):o))+'" id="property-dbinstance-name" data-ignore="true" data-required-rollback="true"/>\n        </section>\n\n        <section class="property-control-group" data-bind="true">\n          <label class="left" for="property-res-desc">'+u(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+'</label>\n          <textarea id="property-res-desc" data-type="ascii" data-ignore="true" class="input">'+u((o=t&&t.description,typeof o===a?o.apply(t):o))+'</textarea>\n        </section>\n\n        <section class="property-control-group">\n            <label class="left">'+u(n.i18n.call(t,"PROP.DBINSTANCE_CLASS",{hash:{},data:i}))+'</label>\n            <div class="selectbox selectbox-mega" id="property-dbinstance-class-select">\n                <div class="selection"></div>\n                <ul class="dropdown">\n                    ',o=n.each.call(t,t&&t.classes,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n                </ul>\n            </div>\n        </section>\n\n        <section class="property-control-group">\n            <div class="checkbox">\n                <input id="property-dbinstance-version-update" type="checkbox" ',o=n["if"].call(t,t&&t.autoMinorVersionUpgrade,{hash:{},inverse:f.noop,fn:f.program(6,p,i),data:i});if(o||o===0)s+=o;s+=' value="None" name="property-dbinstance-version-update">\n                <label for="property-dbinstance-version-update"></label>\n            </div>\n            <label for="property-dbinstance-version-update">'+u(n.i18n.call(t,"PROP.DBINSTANCE_AUTO_MINOR_VERSION_UPDATE",{hash:{},data:i}))+"</label>\n        </section>\n\n        ",o=n["if"].call(t,t&&t.masterIops,{hash:{},inverse:f.noop,fn:f.program(8,d,i),data:i});if(o||o===0)s+=o;s+='\n\n        <section class="property-control-group" data-bind="true">\n            <label class="left" for="property-dbinstance-database-port" >'+u(n.i18n.call(t,"PROP.DBINSTANCE_DATABASE_PORT",{hash:{},data:i}))+'</label>\n            <input class="input"  type="text" id="property-dbinstance-database-port" value="'+u((o=t&&t.port,typeof o===a?o.apply(t):o))+'" data-ignore="true" data-type="number" data-required="true"/>\n        </section>\n\n        <section class="property-control-group">\n            <div class="checkbox">\n                <input id="property-dbinstance-public-access-check" type="checkbox" ',o=n["if"].call(t,t&&t.accessible,{hash:{},inverse:f.noop,fn:f.program(6,p,i),data:i});if(o||o===0)s+=o;s+=' value="None" name="property-dbinstance-public-access-check">\n                <label for="property-dbinstance-public-access-check"></label>\n            </div>\n            <label for="property-dbinstance-public-access-check">'+u(n.i18n.call(t,"PROP.DBINSTANCE_PUBLIC_ACCESS",{hash:{},data:i}))+"</label>\n        </section>\n\n    ",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.program(21,x,i),fn:f.program(14,y,i),data:i});if(o||o===0)s+=o;return s+="\n\n    </div>\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/dbinstance/template/stack_component",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n",i=n.ifLogic.call(e,(i=e&&e.engines,i==null||i===!1?i:i.length),">",1,{hash:{},inverse:u.noop,fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){var r="",i;r+='\n<section class="property-control-group">\n    <label class="left">DB Engine</label>\n    <div class="selectbox" id="property-dbinstance-engine-select">\n        <div class="selection">'+f((i=e&&e.engine,typeof i===a?i.apply(e):i))+'</div>\n        <ul class="dropdown" tabindex="-1">\n            ',i=n.each.call(e,e&&e.engines,{hash:{},inverse:u.noop,fn:u.programWithDepth(3,h,t,e),data:t});if(i||i===0)r+=i;return r+="\n        </ul>\n    </div>\n</section>\n",r}function h(e,t,r){var i="",s;i+='\n            <li class="item ',s=n.ifCond.call(e,r&&r.engine,e,{hash:{},inverse:u.noop,fn:u.program(4,p,t),data:t});if(s||s===0)i+=s;return i+='" data-id="'+f(typeof e===a?e.apply(e):e)+'">'+f(typeof e===a?e.apply(e):e)+"</li>\n            ",i}function p(e,t){return"selected"}function d(e,t){return"\n"}function v(e,t){var r="",i;r+='\n<section class="property-control-group">\n    <label class="left">'+f(n.i18n.call(e,"PROP.DBINSTANCE_LICENSE_MODEL",{hash:{},data:t}))+'</label>\n    <div class="selectbox" id="property-dbinstance-license-select">\n        <div class="selection">'+f((i=e&&e.license,typeof i===a?i.apply(e):i))+'</div>\n        <ul class="dropdown" tabindex="-1">\n            ',i=n.each.call(e,e&&e.licenses,{hash:{},inverse:u.noop,fn:u.program(9,m,t),data:t});if(i||i===0)r+=i;return r+="\n        </ul>\n    </div>\n</section>\n",r}function m(e,t){var r="",i;r+='\n            <li class="item ',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(4,p,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+f((i=e&&e.license,typeof i===a?i.apply(e):i))+'">'+f((i=e&&e.license,typeof i===a?i.apply(e):i))+"</li>\n            ",r}function g(e,t){var r="",i;r+="\n",i=n.unless.call(e,e&&e.isAppEdit,{hash:{},inverse:u.program(16,E,t),fn:u.program(12,y,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function y(e,t){var r="",i;r+="\n    ",i=n.unless.call(e,e&&e.snapshotId,{hash:{},inverse:u.noop,fn:u.program(13,b,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function b(e,t){var r="",i;r+='\n    <section class="property-control-group">\n        <label class="left">'+f(n.i18n.call(e,"PROP.DBINSTANCE_DB_ENGINE_VERSION",{hash:{},data:t}))+'</label>\n        <div class="selectbox combo-dd" id="property-dbinstance-engine-version-select">\n            <div class="property-engine-label left" >'+f((i=e&&e.engine,typeof i===a?i.apply(e):i))+'</div>\n            <div class="property-engineversion-label selection">'+f((i=e&&e.engineVersion,typeof i===a?i.apply(e):i))+'</div>\n            <div class="property-engineversion-dropdown dropdown">\n                <div class="scroll-wrap scrollbar-auto-hide clearfix">\n                    <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n                    <div class="scroll-content">\n                        <ul>\n                            ',i=n.each.call(e,e&&e.versions,{hash:{},inverse:u.noop,fn:u.program(14,w,t),data:t});if(i||i===0)r+=i;return r+="\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </section>\n    ",r}function w(e,t){var r="",i;r+='\n                            <li class="item ',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(4,p,t),data:t});if(i||i===0)r+=i;return r+='" data-id="'+f((i=e&&e.version,typeof i===a?i.apply(e):i))+'">'+f((i=e&&e.version,typeof i===a?i.apply(e):i))+"</li>\n                            ",r}function E(e,t){var r="",i;return r+='\n    <section class="property-control-group clearfix">\n        <label>'+f(n.i18n.call(e,"PROP.DBINSTANCE_DB_ENGINE_VERSION",{hash:{},data:t}))+"</label>\n        <div>"+f((i=e&&e.engine,typeof i===a?i.apply(e):i))+"("+f((i=e&&e.engineVersion,typeof i===a?i.apply(e):i))+")</div>\n    </section>\n",r}function S(e,t){var r="",i;r+='\n                            <li class="',i=n["if"].call(e,e&&e.selected,{hash:{},inverse:u.noop,fn:u.program(19,x,t),data:t});if(i||i===0)r+=i;return r+='tooltip item" data-id="'+f((i=e&&e.instanceClass,typeof i===a?i.apply(e):i))+'">\n                                <div class="main truncate">'+f((i=e&&e.instanceClass,typeof i===a?i.apply(e):i))+'</div>\n                                <div class="sub"><span>'+f((i=e&&e.ecu,typeof i===a?i.apply(e):i))+" ECU</span><span>"+f((i=e&&e.cpu,typeof i===a?i.apply(e):i))+"</span> <span>"+f((i=e&&e.memory,typeof i===a?i.apply(e):i))+"</span>\n                                </div>\n                            </li>\n                        ",r}function x(e,t){return"selected "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;o=n["if"].call(t,t&&t.isRestoreDB,{hash:{},inverse:u.noop,fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:u.program(8,v,i),fn:u.program(6,d,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n.unless.call(t,t&&t.isRestoreDB,{hash:{},inverse:u.noop,fn:u.program(11,g,i),data:i});if(o||o===0)s+=o;s+='\n\n<section class="property-control-group">\n    <label class="left">'+f(n.i18n.call(t,"PROP.DBINSTANCE_DB_INSTANCE_CLASS",{hash:{},data:i}))+'</label>\n\n    <div class="selectbox selectbox-mega combo-dd" id="property-dbinstance-class-select">\n        <div class="selection">\n            <div class="main truncate">'+f((o=(o=t&&t.classInfo,o==null||o===!1?o:o.instanceClass),typeof o===a?o.apply(t):o))+'</div>\n            <div class="sub"><span>'+f((o=(o=t&&t.classInfo,o==null||o===!1?o:o.ecu),typeof o===a?o.apply(t):o))+" ECU</span><span>"+f((o=(o=t&&t.classInfo,o==null||o===!1?o:o.cpu),typeof o===a?o.apply(t):o))+"</span>\n                <span>"+f((o=(o=t&&t.classInfo,o==null||o===!1?o:o.memory),typeof o===a?o.apply(t):o))+'</span></div>\n        </div>\n        <div class="dropdown">\n            <div class="scroll-wrap scrollbar-auto-hide clearfix">\n                <div class="scrollbar-veritical-wrap"><div class="scrollbar-veritical-thumb"></div></div>\n                <div class="scroll-content">\n                    <ul>\n                        ',o=n.each.call(t,t&&t.classes,{hash:{},inverse:u.noop,fn:u.program(18,S,i),data:i});if(o||o===0)s+=o;return s+="\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n</section>",s},n.lvi=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n    <li class="item" data-id="'+a((r=e&&e.name,typeof r===u?r.apply(e):r))+'">'+a((r=e&&e.name,typeof r===u?r.apply(e):r))+"</li>\n    ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="selection">'+a(n.i18n.call(t,"PROP.DBINSTANCE_SELECT_WINDOW",{hash:{},data:i}))+'</div>\n<ul class="dropdown" tabindex="-1">\n    <li class="item" data-id="no">'+a(n.i18n.call(t,"PROP.DBINSTANCE_NO_PREFERENCE",{hash:{},data:i}))+"</li>\n    ",o=n.each.call(t,t,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n</ul>",s},n.preferred_az=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n            <button class="icon-new-stack btn btn-blue t-m-btn" data-btn="create">'+a((r=e&&e.btnValueCreate,typeof r===u?r.apply(e):r))+"</button>\n            ",n}function c(e,t){var r="",i;r+='\n                <button class="icon-'+a((i=e&&e.icon,typeof i===u?i.apply(e):i))+' t-m-btn" data-btn="'+a((i=e&&e.type,typeof i===u?i.apply(e):i))+'" ',i=n["if"].call(e,e&&e.disabled,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+=">"+a((i=e&&e.name,typeof i===u?i.apply(e):i))+"</button>\n                ",r}function h(e,t){return"disabled"}function p(e,t){var r="",i;r+='\n                            <th class="',i=n["if"].call(e,e&&e.sortable,{hash:{},inverse:f.noop,fn:f.program(7,d,t),data:t});if(i||i===0)r+=i;r+='" data-row-type="',i=n["if"].call(e,e&&e.rowType,{hash:{},inverse:f.program(11,m,t),fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;r+='" style="',i=n["if"].call(e,e&&e.width,{hash:{},inverse:f.noop,fn:f.program(13,g,t),data:t});if(i||i===0)r+=i;return r+='">'+a((i=e&&e.name,typeof i===u?i.apply(e):i))+"</th>\n                            ",r}function d(e,t){return"sortable"}function v(e,t){var n;return a((n=e&&e.rowType,typeof n===u?n.apply(e):n))}function m(e,t){return"string"}function g(e,t){var n="",r;return n+="width:"+a((r=e&&e.width,typeof r===u?r.apply(e):r))+";",n}function y(e,t){var r="",i;r+='\n                                    <th style="',i=n["if"].call(e,e&&e.width,{hash:{},inverse:f.noop,fn:f.program(13,g,t),data:t});if(i||i===0)r+=i;return r+='"><div class="th-inner"></div></th>\n                                    ',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="modal-toolbar '+a((o=t&&t.classList,typeof o===u?o.apply(t):o))+'">\n    <div class="content-wrap">\n        <div class="toolbar">\n            ',o=n["if"].call(t,t&&t.btnValueCreate,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='\n            <div class="btn-group">\n                ',o=n.each.call(t,t&&t.buttons,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n            </div>\n        </div>\n        <div class="list">\n            <div class="slidebox" style="'+a((o=t&&t.slideStyle,typeof o===u?o.apply(t):o))+'">\n                <div class="content clearfix">\n                </div>\n                <div class="error">\n                    '+a(n.i18n.call(t,"PROP.DBINSTANCE_SOMETHING_ERROR",{hash:{},data:i}))+'\n                </div>\n            </div>\n            <div class="table-head-fix">\n                <table class="table-head">\n                    <thead>\n                        <tr>\n                            <th>\n                                <div class="checkbox">\n                                    <input id="t-m-select-all" type="checkbox" value="None">\n                                    <label for="t-m-select-all"></label>\n                                </div>\n                            </th>\n                            ',o=n.each.call(t,t&&t.columns,{hash:{},inverse:f.noop,fn:f.program(6,p,i),data:i});if(o||o===0)s+=o;s+='\n                        </tr>\n                    </thead>\n                </table>\n                <div class="scroll-wrap">\n                    <div class="scrollbar-veritical-wrap" style="display: block;"><div class="scrollbar-veritical-thumb"></div></div>\n                    <div class="scroll-content" style="display:block;">\n                        <table class="table">\n                            <thead>\n                                <tr>\n                                    <th><div class="th-inner"></div></th>\n                                    ',o=n.each.call(t,t&&t.columns,{hash:{},inverse:f.noop,fn:f.program(15,y,i),data:i});if(o||o===0)s+=o;return s+="\n                                </tr>\n                            </thead>\n                            <tbody class='t-m-content'>\n\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>",s},n.optionGroupModal=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="";return r+="\n<label>"+o(n.i18n.call(e,"PROP.DBINSTANCE_OPTION_GROUP",{hash:{},data:t}))+'</label>\n<div class="property-dbinstance-optiongroup-placeholder"></div>\n',r}function l(e,t){var r="",i;return r+="\n<label>"+o(n.i18n.call(e,"PROP.DBINSTANCE_OPTION_GROUP",{hash:{},data:t}))+"</label>\n<div>"+o((i=e&&e.ogName,typeof i===u?i.apply(e):i))+"</div>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u="function",a=this;return s=n["if"].call(t,t&&t.canCustomOG,{hash:{},inverse:a.program(3,l,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.optionGroupDropDown=e.template(t),t=function(e,t,n,r,i){function l(e,t){return'disabled="disabled"'}function c(e,t){return'checked="true"'}function h(e,t){var r="";return r+='data-tooltip="'+u(n.i18n.call(e,"PROP.DBINSTANCE_SQLSERVER_MIRROR_TIP",{hash:{},data:t}))+'"',r}function p(e,t){var r="",i;r+='\n\n    <div class="property-control-group clearfix">\n        ',i=n.unless.call(e,e&&e.multiAz,{hash:{},inverse:f.program(11,m,t),fn:f.program(8,d,t),data:t});if(i||i===0)r+=i;return r+="\n    </div>\n\n",r}function d(e,t){var r="",i;r+="\n            ",i=n["if"].call(e,e&&e.AvailabilityZone,{hash:{},inverse:f.noop,fn:f.program(9,v,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function v(e,t){var r="",i;return r+="\n                <label>"+u(n.i18n.call(e,"PROP.DBINSTANCE_PREFERRED_ZONE",{hash:{},data:t}))+"</label>\n                <div>"+u((i=e&&e.AvailabilityZone,typeof i===a?i.apply(e):i))+"</div>\n            ",r}function m(e,t){var r="",i;r+="\n            ",i=n["if"].call(e,e&&e.SecondaryAvailabilityZone,{hash:{},inverse:f.noop,fn:f.program(12,g,t),data:t});if(i||i===0)r+=i;return r+="\n        ",r}function g(e,t){var r="",i;return r+="\n            <label>"+u(n.i18n.call(e,"PROP.DBINSTANCE_SECONDARY_ZONE",{hash:{},data:t}))+"</label>\n            <div>"+u((i=e&&e.SecondaryAvailabilityZone,typeof i===a?i.apply(e):i))+"</div>\n            ",r}function y(e,t){var r="",i;r+="\n\n    ",i=n["if"].call(e,e&&e.azNotEnough,{hash:{},inverse:f.program(17,w,t),fn:f.program(15,b,t),data:t});if(i||i===0)r+=i;return r+="\n\n",r}function b(e,t){var r="";return r+='\n    <section class="property-control-group">\n        <div class="property-info">'+u(n.i18n.call(e,"PROP.DBINSTANCE_SUBNETGROUP_NOT_SETUP",e&&e.subnetGroupName,e&&e.subnetGroupName,{hash:{},data:t}))+"</div>\n    </section>\n    ",r}function w(e,t){var r="",i;r+='\n    <section class="property-control-group property-dbinstance-preferred-az ',i=n["if"].call(e,e&&e.multiAz,{hash:{},inverse:f.noop,fn:f.program(18,E,t),data:t});if(i||i===0)r+=i;return r+='">\n        <label class="left">'+u(n.i18n.call(e,"PROP.DBINSTANCE_PREFERRED_ZONE",{hash:{},data:t}))+'</label>\n        <div class="selectbox" id="property-dbinstance-preferred-az"></div>\n    </section>\n    ',r}function E(e,t){return"hide"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<section class="property-control-group">\n    <div class="checkbox">\n        <input id="property-dbinstance-mutil-az-check" ',o=n["if"].call(t,t&&t.disableMutilAZForMirror,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+=' type="checkbox" ',o=n["if"].call(t,t&&t.multiAz,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+=' name="property-dbinstance-mutil-az-check">\n        <label for="property-dbinstance-mutil-az-check"></label>\n    </div>\n    <label for="property-dbinstance-mutil-az-check" class="tooltip" ',o=n["if"].call(t,t&&t.disableMutilAZForMirror,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+=">"+u(n.i18n.call(t,"PROP.DBINSTANCE_MUTIL_AZ_DEPLOY",{hash:{},data:i}))+"</label>\n</section>\n\n",o=n["if"].call(t,t&&t.isAppEdit,{hash:{},inverse:f.program(14,y,i),fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;return s},n.propertyDbinstanceMutilAZ=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<section class="modal-db-replica-promote-confirm">\n    <h5 class="modal-text-major">'+o(n.i18n.call(t,"PROP.DBINSTANCE_PROMOTE_CONFIRM_MAJOR",{hash:{},data:i}))+"</h5>\n    <ul>\n        <li>"+o(n.i18n.call(t,"PROP.DBINSTANCE_PROMOTE_CONFIRM_CONTENT_1",{hash:{},data:i}))+"</li>\n        <li>"+o(n.i18n.call(t,"PROP.DBINSTANCE_PROMOTE_CONFIRM_CONTENT_2",{hash:{},data:i}))+"</li>\n        <li>"+o(n.i18n.call(t,"PROP.DBINSTANCE_PROMOTE_CONFIRM_CONTENT_3",{hash:{},data:i}))+"</li>\n        <li>"+o(n.i18n.call(t,"PROP.DBINSTANCE_PROMOTE_CONFIRM_CONTENT_4",{hash:{},data:i}))+'</li>\n    </ul>\n    <h5 class="modal-text-major">Note</h5>\n    <p>'+o(n.i18n.call(t,"PROP.RDS_PROMOTE_REPLICA_WARNING",{hash:{},data:i}))+'</p>\n    <a href="http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_ReadRepl.html" target="_blank">'+o(n.i18n.call(t,"PROP.RDS_READ_AWS_DOC",{hash:{},data:i}))+"</a>\n</section>",s},n.modalPromoteConfirm=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="";return r+='\n        <div class="modal-db-instance-restore-no-restore">'+u(n.i18n.call(e,"PROP.RDS_NO_BACKUP_TIP",{hash:{},data:t}))+"</div>\n    ",r}function c(e,t){var r="",i;r+='\n        <h5 class="modal-text-major">'+u(n.i18n.call(e,"PROP.RDS_RESTORE_DB_TIP",{hash:{},data:t}))+'</h5>\n\n        <div class="modal-db-instance-restore-option">\n            <label class="title">'+u(n.i18n.call(e,"PROP.RDS_RESTORE_USE_LASTEST_TIME",{hash:{},data:t}))+'</label>\n            <input id="modal-db-instance-restore-radio-latest" type="radio" value="latest" name="modal-db-instance-restore-radio" ',i=n["if"].call(e,e&&e.custom,{hash:{},inverse:a.noop,fn:a.program(4,h,t),data:t});if(i||i===0)r+=i;r+='>\n            <label for="modal-db-instance-restore-radio-latest">'+u((i=e&&e.lastest,typeof i===f?i.apply(e):i))+'</label>\n        </div>\n\n        <div class="modal-db-instance-restore-option">\n            <label class="title">'+u(n.i18n.call(e,"PROP.RDS_RESTORE_USE_CUSTOM_TIME",{hash:{},data:t}))+'</label>\n            <input id="modal-db-instance-restore-radio-custom" type="radio" value="custom" name="modal-db-instance-restore-radio" ',i=n.unless.call(e,e&&e.custom,{hash:{},inverse:a.noop,fn:a.program(4,h,t),data:t});if(i||i===0)r+=i;return r+='>\n            <div class="datetimepicker">\n                <input class="input datepicker" type="text" >\n                <input class="input timepicker hour" value="" data-ignore="true" maxlength="2" data-required="true" data-type="number" type="text" >\n                <label>:</label>\n                <input class="input timepicker minute" value="" data-ignore="true" maxlength="2" data-required="true" data-type="number" type="text" >\n                <label>:</label>\n                <input class="input timepicker second" value="" data-ignore="true" maxlength="2" data-required="true" data-type="number" type="text" >\n                <label>UTC '+u((i=e&&e.timezone,typeof i===f?i.apply(e):i))+"</label>\n            </div>\n        </div>\n    ",r}function h(e,t){return'checked="checked"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<section class="modal-db-instance-restore-config" data-bind="true">\n\n    ',o=n["if"].call(t,t&&t.noRestore,{hash:{},inverse:a.program(3,c,i),fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n\n</section>",s},n.modalRestoreConfirm=e.template(t),n});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/property/dbinstance/view",["ApiRequest","ResDiff","../base/view","og_dropdown","./template/stack_instance","./template/stack_replica","./template/stack_component","i18n!/nls/lang.js","constant","CloudResources","rds_pg","UI.modalplus","jqtimepicker","jqdatetimepicker"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h,p;return p=function(){return null},h=n.extend({events:{"change #property-dbinstance-name":"changeInstanceName","change #property-res-desc":"onChangeDesc","change #property-dbinstance-mutil-az-check":"changeMutilAZ","change #property-dbinstance-storage":"changeAllocatedStorage","keyup #property-dbinstance-storage":"inputAllocatedStorage","OPTION_CHANGE #property-dbinstance-storage-type":"changeStorageType","change #property-dbinstance-iops-value":"changeProvisionedIOPS","change #property-dbinstance-master-username":"changeUserName","change #property-dbinstance-master-password":"changePassWord","change #property-dbinstance-database-name":"changeDatabaseName","change #property-dbinstance-database-port":"changeDatabasePort","change #property-dbinstance-public-access-check":"changePublicAccessCheck","change #property-dbinstance-version-update":"changeVersionUpdate","change #property-dbinstance-auto-backup-check":"changeAutoBackupCheck","change #property-dbinstance-backup-period":"changeBackupPeriod","click #property-dbinstance-backup-window-select input":"changeBackupOption","change #property-dbinstance-backup-window-start-time":"changeBackupTime","OPTION_CHANGE #property-dbinstance-backup-window-duration":"changeBackupTime","click #property-dbinstance-maintenance-window-select input":"changeMaintenanceOption","OPTION_CHANGE #property-dbinstance-maintenance-window-start-day-select":"changeMaintenanceTime","OPTION_CHANGE #property-dbinstance-maintenance-window-duration":"changeMaintenanceTime","change #property-dbinstance-maintenance-window-start-time":"changeMaintenanceTime","OPTION_CHANGE #property-dbinstance-engine-select":"changeEngine","OPTION_CHANGE #property-dbinstance-license-select":"changeLicense","OPTION_CHANGE #property-dbinstance-engine-version-select":"changeVersion","OPTION_CHANGE #property-dbinstance-class-select":"changeClass","OPTION_CHANGE #property-dbinstance-preferred-az":"changeAZ","OPTION_CHANGE #property-dbinstance-charset-select":"changeCharset",OPTION_CHANGE:"checkChange","change *":"checkChange","click #property-dbinstance-promote-replica":"promoteReplica","click .property-btn-db-restore-config":"openRestoreConfigModal"},promoteReplica:function(){var e,t;t=this,this.isPromoted()?(this.unsetPromote(),t.refreshProperty()):e=new c({title:u.IDE.TITLE_CONFIRM_PROMOTE_READ_REPLICA,template:o.modalPromoteConfirm({}),confirm:{text:u.PROP.DB_CONFIRM_PROMOTE},disableClose:!0,onConfirm:function(){return t.setPromote(),t.refreshProperty(),e.close()}})},refreshProperty:function(){if(this._render)return this._render()},openRestoreConfigModal:function(e){var t,n,r,i,s,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k;if(!e||e.type!==a.RESTYPE.DBINSTANCE)e=this.resModel;return T=this,x=e.getSourceDBForRestore(),S=f(Design.instance().credentialId(),a.RESTYPE.DBINSTANCE,Design.instance().region()).get(x.get("appId")),S?(E=S.get("PendingModifiedValues"),w=!S.get("LatestRestorableTime")||S.get("BackupRetentionPeriod")===0||E&&E.BackupRetentionPeriod===0,new Date(S.get("LatestRestorableTime"))==="Invalid Date"&&(w=!0)):w=!0,w?b=new c({title:u.IDE.TITLE_RESTORE_TO_POINT_IN_TIME_CONFIG,template:o.modalRestoreConfirm({noRestore:w}),confirm:{hide:!0},cancel:{text:"Close"},disableClose:!0,disableConfirm:!0,width:"580",onCancel:function(){return e.remove()},onClose:function(){return e.remove()}}):(g=new Date(S.get("LatestRestorableTime")),d=e.get("dbRestoreTime"),d?t=new Date(d):t=g,y=g.getFullYear(),m=g.getMonth()+1,v=g.getDate(),l=t.getFullYear(),i=t.getMonth()+1,n=t.getDate(),h=String(l).length===1?"0"+l:l,s=String(i).length===1?"0"+i:i,r=String(n).length===1?"0"+n:n,N=-((new Date).getTimezoneOffset()/60),N>0?N="+"+N:N=""+N,C=function(){var e,t,n,r,i;return e=$(".modal-db-instance-restore-config .datepicker").val(),i=new Date(e),t=$(".modal-db-instance-restore-config .timepicker.hour").val(),n=$(".modal-db-instance-restore-config .timepicker.minute").val(),r=$(".modal-db-instance-restore-config .timepicker.second").val(),i.setHours(Number(t)),i.setMinutes(Number(n)),i.setSeconds(Number(r)),i},k=function(e){var n,r,i,s,o,u;return e?(r=String(g.getHours()),s=String(g.getMinutes()),u=String(g.getSeconds())):(r=String(t.getHours()),s=String(t.getMinutes()),u=String(t.getSeconds())),n=r.length===1?"0"+r:r,i=s.length===1?"0"+s:s,o=u.length===1?"0"+u:u,$(".modal-db-instance-restore-config .timepicker.hour").val(n),$(".modal-db-instance-restore-config .timepicker.minute").val(i),$(".modal-db-instance-restore-config .timepicker.second").val(o)},b=new c({title:u.IDE.TITLE_RESTORE_TO_POINT_IN_TIME_CONFIG,template:o.modalRestoreConfirm({lastest:g.toString(),custom:!d,timezone:N,noRestore:w}),confirm:{text:u.PROP.RDS_RESTORE},disableClose:!0,width:"580",onConfirm:function(){var t,n;return t=$("#modal-db-instance-restore-radio-custom")[0].checked,t?(n=C(),e.set("dbRestoreTime",n.toISOString())):e.set("dbRestoreTime",""),e.isRestored=!0,b.close()},onCancel:function(){if(!e.isRestored)return e.remove()},onClose:function(){if(!e.isRestored)return e.remove()}}),k(),p="en",language==="zh-cn"&&(p="ch"),$(".modal-db-instance-restore-config .datepicker").datetimepicker({timepicker:!1,defaultDate:""+i+"/"+n+"/"+l,maxDate:""+m+"/"+v+"/"+y,closeOnDateSelect:!0,format:"m/d/Y",formatDate:"m/d/Y",value:""+s+"/"+r+"/"+h,lang:p,onSelectDate:function(){var e;e=C();if(e>g)return k(!0)}}),$(".modal-db-instance-restore-config .datepicker, .modal-db-instance-restore-config .timepicker").on("focus",function(e){return $("#modal-db-instance-restore-radio-custom").prop("checked",!0)}),$(".modal-db-instance-restore-config .timepicker").on("change",function(e){var n,r,i,s,o,u;u=$(e.target).val(),n=Number(u),$(e.target).hasClass("hour")?(i=23,r=t.getHours()):$(e.target).hasClass("minute")?(i=59,r=t.getMinutes()):$(e.target).hasClass("second")&&(i=59,r=t.getSeconds()),n>i?$(e.target).val(i):(!n||n<0)&&$(e.target).val("00"),o=C(),o>g&&k(),s=$(e.target).val();if(s.length<2)return s="0"+s,$(e.target).val(s)})),!1},checkChange:function(e){var n,r;if(!this.resModel.get("appId"))return;r=this,n=function(e,n){var i,s,o;i=r.resModel.serialize(),s=new t({old:{component:r.originComp},"new":i});if(s.modifiedComps&&_.keys(s.addedComps).length===0&&_.keys(s.removedComps).length===0){o=_.keys(s.modifiedComps);if(o.length===1&&o[0]==="name")return!1}return s.getChangeInfo().hasResChange};if(!e)return n();if(!this.isPromoted())return _.defer(function(){return n()?($(".apply-immediately-section").show(),$(".property-panel-wrapper").addClass("immediately")):($(".apply-immediately-section").hide(),$(".property-panel-wrapper").removeClass("immediately"))})},durationOpertions:[.5,1,2,2.5,3],genDuration:function(e){return _.map(this.durationOpertions,function(t){return{value:t,selected:t===e}})},changeCharset:function(e,t,n){return this.resModel.set("characterSetName",t)},changeApplyImmediately:function(e){var t;return t=e.target.checked,this.resModel.set("applyImmediately",t)},changeEngine:function(e,t,n){return this.resModel.set("engine",t),this.resModel.setDefaultParameterGroup(),this.resModel.setDefaultOptionGroup(),this.renderOptionGroup(),this.renderLVIA()},changeLicense:function(e,t,n){return this.resModel.set("license",t),this.renderLVIA()},changeVersion:function(e,t,n){var r;return r=this.resModel.get("engineVersion"),this.resModel.set("engineVersion",t),this.resModel.setDefaultParameterGroup(r),this.resModel.setDefaultOptionGroup(r),this.renderOptionGroup(),this.renderParameterGroup(),this.renderLVIA()},changeClass:function(e,t,n){return this.resModel.set("instanceClass",t),this.setDefaultAllocatedStorage(),!0},setDefaultAllocatedStorage:function(){var e,t,n;n=this.resModel.getAllocatedRange(),e=this.resModel.get("allocatedStorage");if(n.min>e||n.max<e)return t=this.resModel.getDefaultAllocatedStorage(),this.resModel.set("allocatedStorage",t),$("#property-dbinstance-storage").val(t),this.updateIOPSCheckStatus()},_getTimeData:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;t={startHour:"00",startMin:"00",startTime:"00:00",duration:.5,startWeek:"Mondey"};if(!e)return t;try{return b=function(e){return e.length===1?"0"+e:e},y=e.split("-"),m=y[0],u=y[1],v=m.split(":"),o=u.split(":"),v.length===3&&(g=v[0],a=o[0],v=v.slice(1),o=o.slice(1)),c=Number(v[0]),p=Number(v[1]),i=Number(o[0]),s=Number(o[1]),l=new Date,r=new Date(l),l.setHours(c),l.setMinutes(p),r.setHours(i),r.setMinutes(s),n=(r-l)/1e3/60/60,n<0&&(n=24+n),h=b(String(c)),d=b(String(p)),{startHour:h,startMin:d,startTime:""+h+":"+d,duration:n,startWeek:g}}catch(w){return f=w,t}},_getTimeStr:function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m;r=function(e){var t;return t=String(e),t.length===1&&(t="0"+t),t};try{return d=e.split(":"),h=Number(d[0]),p=Number(d[1]),c=new Date,c.setHours(h),c.setMinutes(p),i=new Date(c.getTime()+36e5*t),s=i.getHours(),o=i.getMinutes(),h=r(h),p=r(p),s=r(s),o=r(o),e=""+h+":"+p,u=""+s+":"+o,n&&(a=n,m=["mon","tue","wed","thu","fri","sat","sun"],c.getDay()!==i.getDay()&&(v=m.indexOf(n)+1,f=(v+1)%7,a=m[f-1]),e=""+n+":"+e,u=""+a+":"+u),""+e+"-"+u}catch(g){return l=g,""}},_setBackupTime:function(){var e,t,n;return t=$("#property-dbinstance-backup-window-start-time").val(),e=Number($("#property-dbinstance-backup-window-duration .selection").text()),n=this._getTimeStr(t,e),this.resModel.set("backupWindow",n)},_setMaintenanceTime:function(){var e,t,n,r;return t=$("#property-dbinstance-maintenance-window-start-time").val(),e=Number($("#property-dbinstance-maintenance-window-duration .selection").text()),r=$("#property-dbinstance-maintenance-window-start-day-select").find(".item.selected").data("id"),n=this._getTimeStr(t,e,r),this.resModel.set("maintenanceWindow",n)},getModelJSON:function(){var e,t,n;return e=this.resModel.toJSON(),this.isAppEdit&&(e.isAppEdit=this.isAppEdit,this.appModel&&_.extend(e,this.appModel.toJSON()),_.extend(e,this.getOriginAttr())),e.snapshotId=e.instanceId?"":e.snapshotId,e.isCanPromote=this.isCanPromote(),e.isPromoted=this.isPromoted(),e.isPromote=this.isCanPromote()||this.isPromoted(),t=this.resModel.getSourceDBForRestore(),t&&(e.isRestoreDB=!0,e.sourceDbIdForRestore=t.get("appId")),this.resModel.isMysql&&this.resModel.master()&&((n=this.resModel.getMajorVersion())==="5.1"||n==="5.5")&&(e.disableBackupForOldMySQL=!0),e},isPromoted:function(){var e,t;return e=f(Design.instance().credentialId(),a.RESTYPE.DBINSTANCE,Design.instance().region()).get(this.resModel.get("appId")),e?(t=e.get("ReadReplicaSourceDBInstanceIdentifier"),this.isAppEdit&&t&&!this.resModel.master()):!1},isCanPromote:function(){var e,t;return e=f(Design.instance().credentialId(),a.RESTYPE.DBINSTANCE,Design.instance().region()).get(this.resModel.get("appId")),e?(t=e.get("ReadReplicaSourceDBInstanceIdentifier"),this.isAppEdit&&t&&this.resModel.master()):!1},setPromote:function(){this.resModel.unsetMaster();if(!this.resModel.autobackup())return this.resModel.autobackup(1)},unsetPromote:function(){var e,t,n;e=(n=f(Design.instance().credentialId(),a.RESTYPE.DBINSTANCE,Design.instance().region()).get(this.resModel.get("appId")))!=null?n.get("ReadReplicaSourceDBInstanceIdentifier"):void 0;if(e){t=Design.modelClassForType(a.RESTYPE.DBINSTANCE).findWhere({appId:e});if(t)return this.resModel.setMaster(t)}},getOriginAttr:function(){var e,t;return this.originComp&&this.appModel?(e=this.originComp.resource.AllocatedStorage,t=this.originComp.resource.Iops,{originAllocatedStorage:e,originIOPS:t,originBackupWindow:this.appModel.get("PreferredBackupWindow"),originMaintenanceWindow:this.appModel.get("PreferredMaintenanceWindow")}):null},render:function(){var e,t,n,r,o,f,c,h,p,d,v,m,g;n=this.getModelJSON(),r=this._getTimeData(n.backupWindow),h=this._getTimeData(n.maintenanceWindow),n.backup=r,n.maintenance=h,n.backupDurations=this.genDuration(r.duration),n.maintenanceDurations=this.genDuration(h.duration),n.hasSlave=!!this.resModel.slaves().length,n.engineType=this.resModel.engineType(),n.isChanged=this.checkChange(),_.extend(n,{isOracle:this.resModel.isOracle(),isSqlserver:this.resModel.isSqlserver(),isPostgresql:this.resModel.isPostgresql(),isMysql:this.resModel.isMysql()}),this.resModel.master()&&(n.sourceDbName=this.resModel.master().get("name")),d=this.resModel.getSpecifications(),c=this.resModel.getLVIA(d),n.licenses=c[0],n.versions=c[1],n.classes=c[2],v=i,this.isAppEdit&&(g=this.resModel.get("engine"))!=="sqlserver-ee"&&g!=="sqlserver-se"&&(n.hideAZConfig=!0),this.resModel.master()?(this.isAppEdit?n.hideAZConfig=!0:v=s,n.masterIops=this.resModel.master().get("iops")):n.snapshotId&&(v=i,p=this.resModel.getSnapshotModel(),n.snapshotSize=Number((p!=null?p.get("AllocatedStorage"):void 0)||this.resModel.get("allocatedStorage"))),this.resModel.isOracle()&&(n.isOracle=!0,n.oracleCharset=_.map(Design.modelClassForType(a.RESTYPE.DBINSTANCE).oracleCharset,function(e){return{charset:e,selected:e===n.characterSetName}})),this.resModel.isSqlserver()?n.iopsInfo=u.PROP.DBINSTANCE_STORAGE_REQUIRE_10_RATIO:n.iopsInfo=u.PROP.DBINSTANCE_STORAGE_IOPS_3_10_RATIO,this.$el.html(v(n)),f=this.checkChange.bind(this),o=this.changeApplyImmediately.bind(this),$("header.property-sidebar-title").siblings(".apply-immediately-section").remove(),this.$el.find(".apply-immediately-section").insertAfter("header.property-sidebar-title").click(o).click(f),this.isAppEdit&&!this.isPromoted()&&$(".property-panel-wrapper").toggleClass("immediately",f()),this.setTitle(n.name),this.renderLVIA(),this.renderOptionGroup(),m=h!=null?h.startWeek:void 0,m&&(t=$("#property-dbinstance-maintenance-window-start-day-select"),e=t.find(".item[data-id='"+m+"']").addClass("selected"),t.find(".selection").text(e.text())),this.updateIOPSCheckStatus(),this.pgDropdown=(new l(this.resModel)).renderDropdown(),$("#property-dbinstance-parameter-group-select").html(this.pgDropdown.el),this.bindParsley(),$("#property-dbinstance-maintenance-window-start-time, #property-dbinstance-backup-window-start-time").timepicker({timeFormat:"H:i",step:1}),this.isAppEdit&&this.getInstanceStatus(),this.resModel.on("change:iops",function(e){var t,n;if(this.isAppEdit)return n=that.getOriginAttr(),t=this.$el.find(".property-info-iops-adjust-tip"),n===e?t.removeClass("hide"):t.addClass("hide")}),n.name;if(this.resModel.getSourceDBForRestore()&&!this.resModel.isRestored)return this.openRestoreConfigModal(this.resModel)},bindParsley:function(){var e,t,n;return t=this,e=this.resModel,n=function(e){if(!/^(([0-1]?[0-9])|(2?[0-3])):[0-5]?[0-9]$/.test(e))return u.PARSLEY.PROVIDE_VALID_TIME_VALUE},this.$("#property-dbinstance-backup-window-start-time").parsley("custom",n),this.$("#property-dbinstance-maintenance-window-start-time").parsley("custom",n),this.$("#property-dbinstance-database-name").parsley("custom",function(t){switch(e.engineType()){case"mysql":if(t.length>64)return u.PARSLEY.MAX_LENGTH_IS_64;break;case"postgresql":if(t.length>63)return u.PARSLEY.MAX_LENGTH_IS_63;if(!/[a-z_]/.test(t[0]))return u.PARSLEY.MUST_BEGIN_WITH_LETTER_OR_UNDERSCORE;break;case"oracle":if(t.length>8)return u.PARSLEY.MAX_LENGTH_IS_8}return null}),this.$("#property-dbinstance-storage").parsley("custom",function(e){var n,r,i,s,o,a,f,l;l=Number(e),a=t.getOriginAttr(),n=t.resModel.getAllocatedRange(),s=n.min,i=n.max;if(t.isAppEdit){if(a&&l<a.originAllocatedStorage)return u.PARSLEY.ALLOCATED_STORAGE_CANNOT_BE_REDUCED;r=l-a.originAllocatedStorage;if(r>0){o=Math.ceil(a.originAllocatedStorage*.1);if(r<o)return sprintf(u.PARSLEY.ALLOCATED_STORAGE_MUST_INCREASE_BY_AT_LEAST_10,a.originAllocatedStorage+o)}}if(!(l>=s&&l<=i))return sprintf(u.PARSLEY.MUST_BE_AN_INTEGER_FROM_MIN_TO_MAX,s,i);f=t.resModel.source();if(f&&l<+f.get("AllocatedStorage"))return u.PARSLEY.SNAPSHOT_STORAGE_NEED_LARGE_THAN_ORIGINAL_VALUE}),this.$("#property-dbinstance-iops-value").parsley("custom",function(e){var n,r,i,s,o,a;return r=$("#property-dbinstance-storage").val(),o=t.resModel.get("allocatedStorage"),a=Number(r||o),s=t._getIOPSRange(a),n=t._getDefaultIOPS(a),i=Number(e),i<1e3?u.PARSLEY.REQUIRE_AT_LEAST_1000_IOPS:!t.resModel.isSqlserver()||i%1e3===0&&a*10===i?i>=s.minIOPS&&i<=s.maxIOPS?null:u.PARSLEY.REQUIRE_IOPS_GB_RATIOS_BETWEEN_3_AND_10:u.PARSLEY.SQLSERVER_IOPS_REQUIRES_A_MULTIPLE_OF_1000}),this.$("#property-dbinstance-master-password").parsley("custom",function(e){var n,r;return e.indexOf("/")!==-1||e.indexOf('"')!==-1||e.indexOf("@")!==-1?u.PARSLEY.CANNOT_CONTAIN_CHARACTER_SPLASH:(t.resModel.isMysql()&&(r=8,n=41),t.resModel.isOracle()&&(r=8,n=30),t.resModel.isSqlserver()&&(r=8,n=128),t.resModel.isPostgresql()&&(r=8,n=128),e.length>=r&&e.length<=n?null:sprintf(u.PARSLEY.MUST_CONTAIN_FROM_MIN_TO_MAX_CHARACTERS,r,n))}),this.$("#property-dbinstance-database-port").parsley("custom",function(t){return!e.isSqlserver()||+t!==1434&&+t!==3389&&+t!==47001&&+t!==49152&&+t!==49153&&+t!==49154&&+t!==49155&&+t!==49156?null:u.PARSLEY.THIS_VALUE_CANNOT_BE_1434_3389_47001_49152_49156})},renderOptionGroup:function(){var e,t,n,i,s,u,l,c;c=Design.instance().region(),t=this.getModelJSON(),t.canCustomOG=!1,t.ogName=this.resModel.getOptionGroupName(),i=f(Design.instance().credentialId(),a.RESTYPE.DBENGINE,c),s=i.getOptionGroupsByEngine(c,t.engine),s&&(l=s[this.resModel.getMajorVersion()]),n=i.getDefaultByNameVersion(c,t.engine,t.engineVersion),n&&n.canCustomOG?t.canCustomOG=n.canCustomOG:s&&l&&(t.canCustomOG=!0),this.$el.find(".property-dbinstance-optiongroup").html(o.optionGroupDropDown(t));if(t.canCustomOG)return e=this.$el.find(".property-dbinstance-optiongroup-placeholder"),u=new r({el:e,dbInstance:this.resModel}),e.html(u.render({engine:t.engine,engineVersion:t.engineVersion,majorVersion:this.resModel.getMajorVersion()}).el)},renderParameterGroup:function(){return this.pgDropdown.setSelection(this.resModel.get("pgName")),null},renderLVIA:function(){var e,t,n,r,i,s,u,f,l,c,h,p,d,v;h=this.resModel.getSpecifications(),u=this.resModel.getLVIA(h),r={licenses:u[0],versions:u[1],classes:u[2],azCapable:u[3],engines:a.DB_ENGINE_ARY[this.resModel.engineType()]},e=this.getModelJSON(),e.classInfo=this.resModel.getInstanceClassDict(),_.extend(r,e),$("#lvia-container").html(o.lvi(r)),h=this.resModel.getSpecifications(),u=this.resModel.getLVIA(h),l=u[3],s=this.resModel.get("engine"),i=!1;if(s==="sqlserver-ee"||s==="sqlserver-se")i=!0;return l||this.resModel.set("multiAz",""),c={disableMutilAZForMirror:i,multiAZCapable:l},c=_.extend(c,e),p=this.resModel.parent(),c.subnetGroupName=p.get("name"),n=p.get("__connections"),t={},_.each(n,function(e){var n;return n=e.getTarget(a.RESTYPE.SUBNET).parent().get("name"),t[n]=!0,null}),d=_.size(t),(v=Design.instance().region())==="cn-north-1"?f=1:f=2,d<f&&(c.azNotEnough=!0),l&&$("#property-dbinstance-mutil-az").html(o.propertyDbinstanceMutilAZ(c)),this.renderAZList(),this},renderAZList:function(){var e,t,n,r,i,s,u,f,l,c,h,p;return h=this.resModel.getSpecifications(),u=this.resModel.getLVIA(h),f=u[4],n=this.getModelJSON(),l=Design.instance().get("region"),s=Design.modelClassForType(a.RESTYPE.AZ).allObjects(),s=_.map(s,function(e){return e.get("name")}),r=[],_.each(f,function(e){return r.push(e),null}),r=_.intersection(r,s),i=_.map(r,function(e){return{name:e}}),$("#property-dbinstance-preferred-az").html(o.preferred_az(i)),n.az&&(p=n.az,__indexOf.call(r,p)>=0)?c=n.az:c="no",t=$("#property-dbinstance-preferred-az"),e=t.find(".item[data-id='"+c+"']").addClass("selected"),t.find(".selection").text(e.text())},changeInstanceName:function(e){var t,n,r;return n=this,t=$(e.currentTarget),r=t.val().toLowerCase(),t.val(r),MC.aws.aws.checkResName(this.resModel.get("id"),t,"DBInstance")&&(t.parsley("custom",function(e){var t,r,i;e=e.toLowerCase();if(e[e.length-1]==="-"||e.indexOf("--")!==-1)return t;n.resModel.isSqlserver()?(i=1,r=10):(i=1,r=58),t=sprintf(u.PARSLEY.MUST_CONTAIN_FROM_MIN_TO_MAX_ALPHANUMERIC_CHARACTERS_HYPHEN,i,r);if(e.length<i||e.length>r)return t;if(!MC.validate("letters",e[0]))return t}),t.parsley("validate")&&(this.resModel.setName(r),this.setTitle(r))),null},onChangeDesc:function(e){return this.resModel.setDesc($(e.currentTarget).val())},changeMutilAZ:function(e){var t,n,r;return r=e.target.checked,n=$(".property-dbinstance-preferred-az"),r?(n.find(".item").remove("selected"),t=n.find(".item[data-id='no']").addClass("selected"),n.find(".selection").text(t.text()),n.hide(),this.resModel.set("az",""),this.renderAZList()):n.show(),this.resModel.set("multiAz",r)},changeAZ:function(e,t,n){return t==="no"?this.resModel.set("az",""):this.resModel.set("az",t)},updateIOPSCheckStatus:function(e){var t,n,r,i;i=this,e?r=e:r=i.resModel.get("allocatedStorage");if(!i.resModel.master()||!!i.isAppEdit)return t=i.resModel.get("iops"),n=this._getIOPSRange(r),n.minIOPS>=1e3||n.maxIOPS>=1e3?(this.resModel.isSqlserver()&&this.isAppEdit?i._disableIOPSCheck(!0):i._disableIOPSCheck(!1),$(".property-dbinstance-iops-check-tooltip").attr("data-tooltip","")):(n.minIOPS>=1e3||n.maxIOPS,i._disableIOPSCheck(!0),$(".property-dbinstance-iops-check-tooltip").attr("data-tooltip",u.PROP.VOLUME_DISABLE_IOPS_TOOLTIP))},_disableIOPSCheck:function(e){var t,n,r,i;return t=function(e){var t;return $("#property-dbinstance-storage-type").find(".item").removeClass("selected"),t=$("#property-dbinstance-storage-type").find('.item[data-id="'+e+'"]'),t.addClass("selected"),$("#property-dbinstance-storage-type").find(".selection").text(t.text())},i=function(e){return e?(t("standard"),$(".property-dbinstance-iops-value-section").hide()):t("io1")},r=function(e){var t;t=$("#property-dbinstance-storage-type").find('.item[data-id="io1"]');if(!e)return t.show();t.hide();if(n())return i(!0)},n=function(){var e;return e=$("#property-dbinstance-storage-type").find('.item[data-id="io1"]'),e.hasClass("selected")},e?(n()&&i(!0),r(!0),$("#property-dbinstance-iops-value").val(""),this.resModel.setIops(0)):r(!1)},_getIOPSRange:function(e){var t,n;return this.resModel.isSqlserver()?(n=e*10,t=e*10):(n=e*3,t=e*10),{minIOPS:n,maxIOPS:t}},_getDefaultIOPS:function(e){var t,n,r,i;t=1e3,n=0,r=this._getIOPSRange(e);while(++n){i=t*n;if(i>=r.minIOPS&&i<=r.maxIOPS)return i;if(i>r.maxIOPS)return null}},changeAllocatedStorage:function(e){var t,n,r;n=this,t=$(e.target),r=Number(t.val());if(t.parsley("validate")&&n.changeProvisionedIOPS())return n.resModel.set("allocatedStorage",r),n.updateIOPSCheckStatus()},inputAllocatedStorage:function(e){var t,n,r;return n=this,t=$(e.target),r=Number(t.val()),n.updateIOPSCheckStatus(r)},changeStorageType:function(){var e,t,n,r,i,s,o,u,a;s=this,u=function(){var e;return e=$("#property-dbinstance-storage-type").find('.item[data-id="io1"]'),e.hasClass("selected")},a=function(){var e;return e=$("#property-dbinstance-storage-type").find(".item.selected"),e.attr("data-id")},o=u(),t=$("#property-dbinstance-storage").val(),r=this.resModel.get("allocatedStorage"),i=Number(t||r),n=this._getIOPSRange(i);if(this.resModel.master()&&!this.isAppEdit)o?this.resModel.setIops(this.resModel.master().get("iops")):this.resModel.setIops(0);else if(o){$(".property-dbinstance-iops-value-section").show();if(n.minIOPS>=1e3||n.maxIOPS>=1e3)e=this._getDefaultIOPS(i),e&&($("#property-dbinstance-iops-value").val(e),s.changeProvisionedIOPS())}else $(".property-dbinstance-iops-value-section").hide(),$("#property-dbinstance-iops-value").val(""),this.resModel.setIops(0);return this.resModel.set("storageType",a())},changeProvisionedIOPS:function(e){var t,n,r,i,s,o,u,a;return o=this,a=function(){var e;return e=$("#property-dbinstance-storage-type").find('.item[data-id="io1"]'),e.hasClass("selected")},a()?(s=$("#property-dbinstance-iops-value"),u=s.val(),n=Number(u),t=$("#property-dbinstance-storage").val(),r=this.resModel.get("allocatedStorage"),i=Number(t||r),s.parsley("validate")?(r=o.getOriginAttr(),r&&r.originIOPS&&n!==r.originIOPS?$(".property-info-iops-adjust-tip").show():$(".property-info-iops-adjust-tip").hide(),o.resModel.setIops(Number(n)),o.resModel.set("allocatedStorage",i),!0):!1):!0},changeUserName:function(e){var t,n,r;n=this,t=$(e.target),r=t.val(),t.parsley("custom",function(e){var t,r;if(MC.validate("alphanum",e)&&MC.validate("letters",e[0])){n.resModel.isMysql()&&(r=1,t=16),n.resModel.isOracle()&&(r=1,t=30),n.resModel.isSqlserver()&&(r=1,t=128),n.resModel.isPostgresql()&&(r=2,t=16);if(e.length>=r&&e.length<=t)return null}return sprintf(u.PARSLEY.MUST_CONTAIN_FROM_MIN_TO_MAX_ALPHANUMERIC_CHARACTERS,r,t)});if(t.parsley("validate"))return this.resModel.set("username",r)},changePassWord:function(e){var t,n,r;n=this,t=$(e.target),r=t.val();if(t.parsley("validate"))return this.resModel.set("password",r)},changeDatabaseName:function(e){var t;t=$(e.currentTarget);if(!t.parsley("validate"))return;return this.resModel.set("dbName",t.val())},changeDatabasePort:function(e){var t;t=$(e.currentTarget);if(!t.parsley("validate"))return;return this.resModel.set("port",t.val())},changePublicAccessCheck:function(e){var t;return t=e.target.checked,this.resModel.set("accessible",t)},changeVersionUpdate:function(e){var t;return t=e.target.checked,this.resModel.set("autoMinorVersionUpgrade",t)},changeAutoBackupCheck:function(e){var t;return t=e.target.checked?"1":"0",this.changeBackupPeriod(null,t)},changeBackupPeriod:function(e,t){var n;if(e){n=$(e.currentTarget);if(!n.parsley("validate"))return;t=n.val()}else{if(!t)return void 0,null;$("#property-dbinstance-backup-period").val(t).parsley("validate")}return t!=="0"?($("#group-dbinstance-backup-period").removeClass("hide"),$("#property-dbinstance-auto-backup-group").removeClass("hide")):($("#group-dbinstance-backup-period").addClass("hide"),$("#property-dbinstance-auto-backup-group").addClass("hide")),this.resModel.autobackup(Number(t))},changeBackupOption:function(e){var t,n;return t=$("#property-dbinstance-backup-window-group"),n=$(e.currentTarget).val(),n==="window"?(t.show(),this.changeBackupTime()):(t.hide(),this.resModel.set("backupWindow",""))},changeMaintenanceOption:function(e){var t,n;return t=$("#property-dbinstance-maintenance-window-group"),n=$(e.currentTarget).val(),n==="window"?(t.show(),this.changeMaintenanceTime()):(t.hide(),this.resModel.set("maintenanceWindow",""))},changeBackupTime:function(e){if($("#property-dbinstance-backup-window-start-time").parsley("validate"))return this._setBackupTime()},changeMaintenanceTime:function(e){if($("#property-dbinstance-maintenance-window-start-time").parsley("validate"))return this._setMaintenanceTime()},getInstanceStatus:function(){var t,n,r,i,s;i=this,s=function(e){var t;return $(".property-dbinstance-status-icon-warning").remove(),i.appModel&&i.setTitle(i.appModel.get("name")),e===!0?($(".property-dbinstance-status-loading").remove(),$(".property-dbinstance-not-available-info").show(),t='<i class="property-dbinstance-status-icon-warning icon-warning"></i>'):e===!1?($(".property-dbinstance-status-loading").remove(),t=""):t='<div class="property-dbinstance-status-loading loading-spinner loading-spinner-small"></div>',i.prependTitle(t)},s(),r=Design.instance().region(),n=i.resModel.get("appId"),t=f(Design.instance().credentialId(),a.RESTYPE.DBINSTANCE,r).get(n);if(t)return e("rds_ins_DescribeDBInstances",{key_id:Design.instance().credentialId(),region_name:r,id:n}).then(function(e){var n,r,o,u,a;e=((a=e.DescribeDBInstancesResponse.DescribeDBInstancesResult.DBInstances)!=null?a.DBInstance:void 0)||[],n=_.isArray(e)?e[0]:e;if(n){u=t.get("ReadReplicaSourceDBInstanceIdentifier"),o=n.ReadReplicaSourceDBInstanceIdentifier;if(u!==o)t.set("ReadReplicaSourceDBInstanceIdentifier",o),i.refreshProperty();else{r=n.DBInstanceStatus;if(r!=="available"){s(!0);return}i.$el.find(".property-dbinstance-promote-replica").show()}}return s(!1)},function(){return s(!1)})}}),new h}),define("wspace/awseditor/property/dbinstance/template/app",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='<span class="highlight-status">(Pending)=>['+a((r=(r=e&&e.PendingModifiedValues,r==null||r===!1?r:r.DbinstanceIdentifier),typeof r===u?r.apply(e):r))+"]</span>",n}function c(e,t){var r="",i;i=n["if"].call(e,(i=e&&e.Endpoint,i==null||i===!1?i:i.Address),{hash:{},inverse:f.program(6,p,t),fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;r+=":",i=n["if"].call(e,e&&e.Endpoint,{hash:{},inverse:f.program(10,v,t),fn:f.program(8,d,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,(i=e&&e.PendingModifiedValues,i==null||i===!1?i:i.Port),{hash:{},inverse:f.noop,fn:f.program(12,m,t),data:t});if(i||i===0)r+=i;return r}function h(e,t){var n;return a((n=(n=e&&e.Endpoint,n==null||n===!1?n:n.Address),typeof n===u?n.apply(e):n))}function p(e,t){return"(Not Ready)"}function d(e,t){var n;return a((n=(n=e&&e.Endpoint,n==null||n===!1?n:n.Port),typeof n===u?n.apply(e):n))}function v(e,t){return"Not Ready"}function m(e,t){var n="",r;return n+='<span class="highlight-status">(Pending)=>['+a((r=(r=e&&e.PendingModifiedValues,r==null||r===!1?r:r.Port),typeof r===u?r.apply(e):r))+"]</span>",n}function g(e,t){return"green"}function y(e,t){return"yellow"}function b(e,t){var n;return a((n=e&&e.DBInstanceStatus,typeof n===u?n.apply(e):n))}function w(e,t){return"Unavailable"}function E(e,t){var n="",r;return n+='<span class="highlight-status">(Pending)=>['+a((r=(r=e&&e.PendingModifiedValues,r==null||r===!1?r:r.EngineVersion),typeof r===u?r.apply(e):r))+"]</span>",n}function S(e,t){return"Yes"}function x(e,t){return"No"}function T(e,t){var n="",r;return n+='<span class="highlight-status">(Pending)=>['+a((r=(r=e&&e.PendingModifiedValues,r==null||r===!1?r:r.DBInstanceClass),typeof r===u?r.apply(e):r))+"]</span>",n}function N(e,t){var n;return a((n=e&&e.Iops,typeof n===u?n.apply(e):n))}function C(e,t){return"Disabled"}function k(e,t){var n="",r;return n+='<span class="highlight-status">(Pending)=>['+a((r=(r=e&&e.PendingModifiedValues,r==null||r===!1?r:r.Iops),typeof r===u?r.apply(e):r))+"]</span>",n}function L(e,t){var n="",r;return n+='<span class="highlight-status">(Pending)=>['+a((r=(r=e&&e.PendingModifiedValues,r==null||r===!1?r:r.AllocatedStorage),typeof r===u?r.apply(e):r))+" GB]</span>",n}function A(e,t){var n="",r;return n+='<span class="highlight-status">(Pending)=>['+a((r=(r=e&&e.PendingModifiedValues,r==null||r===!1?r:r.StorageType),typeof r===u?r.apply(e):r))+"]</span>",n}function O(e,t){var r="",i;r+="\n                ",i=n.each.call(e,e&&e.ReadReplicaDBInstanceIdentifiers,{hash:{},inverse:f.noop,fn:f.program(41,M,t),data:t});if(i||i===0)r+=i;return r+="\n            ",r}function M(e,t){var r="";return r+="\n                    <dt>"+a(n.i18n.call(e,"PROP.DBINSTANCE_READ_REPLICAS",{hash:{},data:t}))+"</dt>\n                    <dd>"+a(typeof e===u?e.apply(e):e)+"</dd>\n                ",r}function _(e,t){var r="",i;return r+="\n                <dt>"+a(n.i18n.call(e,"PROP.DBINSTANCE_REPLICAS_SOURCE",{hash:{},data:t}))+"</dt>\n                <dd>"+a((i=e&&e.ReadReplicaSourceDBInstanceIdentifier,typeof i===u?i.apply(e):i))+"</dd>\n            ",r}function D(e,t){var r="",i;return r+="<dt>"+a(n.i18n.call(e,"PROP.DATABASE_NAME",{hash:{},data:t}))+"</dt>\n            <dd>"+a((i=e&&e.DBName,typeof i===u?i.apply(e):i))+"</dd>",r}function P(e,t){var r="",i;r+="\n                <dt>"+a(n.i18n.call(e,"PROP.DBINSTANCE_OG",{hash:{},data:t}))+"</dt>\n                <dd>",i=n.each.call(e,e&&e.optionGroups,{hash:{},inverse:f.noop,fn:f.program(48,H,t),data:t});if(i||i===0)r+=i;return r+="\n                </dd>\n            ",r}function H(e,t){var r="",i;r+="\n                    ",i=n["if"].call(e,e&&e.isDefault,{hash:{},inverse:f.program(51,j,t),fn:f.program(49,B,t),data:t});if(i||i===0)r+=i;return r+="\n                ",r}function B(e,t){var n="",r;return n+="\n                        "+a((r=e&&e.OptionGroupName,typeof r===u?r.apply(e):r))+'<span class="highlight-status '+a((r=e&&e.Status,typeof r===u?r.apply(e):r))+'">('+a((r=e&&e.Status,typeof r===u?r.apply(e):r))+")</span>\n                    ",n}function j(e,t){var n="",r;return n+='\n                        <a class="db-og-in-app">'+a((r=e&&e.OptionGroupName,typeof r===u?r.apply(e):r))+'</a><span class="highlight-status '+a((r=e&&e.Status,typeof r===u?r.apply(e):r))+'">('+a((r=e&&e.Status,typeof r===u?r.apply(e):r))+")</span>\n                    ",n}function F(e,t){var r="",i;r+="\n                <dt>"+a(n.i18n.call(e,"PROP.DBINSTANCE_PG",{hash:{},data:t}))+"</dt>\n                <dd>\n                    ",i=n.each.call(e,e&&e.DBParameterGroups,{hash:{},inverse:f.noop,fn:f.program(54,I,t),data:t});if(i||i===0)r+=i;return r+="\n                </dd>\n            ",r}function I(e,t){var n="",r;return n+="\n                        "+a((r=e&&e.DBParameterGroupName,typeof r===u?r.apply(e):r))+'<span class="highlight-status '+a((r=e&&e.ParameterApplyStatus,typeof r===u?r.apply(e):r))+'">('+a((r=e&&e.ParameterApplyStatus,typeof r===u?r.apply(e):r))+")</span>\n                    ",n}function q(e,t){var r="",i;r+="(",i=n.each.call(e,(i=e&&e.DBSubnetGroup,i==null||i===!1?i:i.Subnets),{hash:{},inverse:f.noop,fn:f.program(57,R,t),data:t});if(i||i===0)r+=i;return r+=")",r}function R(e,t){var n="",r;return n+=a((r=e&&e.SubnetIdentifier,typeof r===u?r.apply(e):r))+", ",n}function U(e,t){var r="",i;return r+="\n                <dt>"+a(n.i18n.call(e,"PROP.DBINSTANCE_PREFERRED_ZONE",{hash:{},data:t}))+"</dt>\n                <dd>"+a((i=e&&e.AvailabilityZone,typeof i===u?i.apply(e):i))+"</dd>\n            ",r}function z(e,t){var r="",i;return r+="\n                <dt>"+a(n.i18n.call(e,"PROP.DBINSTANCE_SECONDARY_ZONE",{hash:{},data:t}))+"</dt>\n                <dd>"+a((i=e&&e.SecondaryAvailabilityZone,typeof i===u?i.apply(e):i))+"</dd>\n            ",r}function W(e,t){return"true"}function X(e,t){return"false"}function V(e,t){var n="",r;return n+="Enabled ("+a((r=e&&e.BackupRetentionPeriod,typeof r===u?r.apply(e):r))+" day)",n}function $(e,t){var r="",i;return r+="\n                <dt>"+a(n.i18n.call(e,"PROP.DBINSTANCE_BACKUP_WINDOW",{hash:{},data:t}))+"</dt>\n                <dd>"+a((i=e&&e.PreferredBackupWindow,typeof i===u?i.apply(e):i))+"</dd>\n            ",r}function J(e,t){var r="",i;return r+="\n                <dt>"+a(n.i18n.call(e,"PROP.DBINSTANCE_MAINTENANCE_WINDOW",{hash:{},data:t}))+"</dt>\n                <dd>"+a((i=e&&e.PreferredMaintenanceWindow,typeof i===u?i.apply(e):i))+"</dd>\n            ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article class="property-app app-dbinstance">\n    <div class="option-group-head expand">\n        '+a(n.i18n.call(t,"PROP.DBINSTANCE_TIT_DETAIL",{hash:{},data:i}))+'\n        <a href="#" class="icon-syslog tooltip property-btn-get-system-log" data-tooltip="'+a(n.i18n.call(t,"PROP.DB_INSTANCE_TIP_GET_LOG",{hash:{},data:i}))+'" ></a>\n    </div>\n\n    <div class="option-group" style="display: block">\n        <dl class="dl-vertical">\n            <dt>'+a(n.i18n.call(t,"PROP.DBINSTANCE_APP_DBINSTANCE_ID",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.DBInstanceIdentifier,typeof o===u?o.apply(t):o)),o=n["if"].call(t,(o=t&&t.PendingModifiedValues,o==null||o===!1?o:o.DbinstanceIdentifier),{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.NAME",{hash:{},data:i}))+"</dt>\n            <dd>"+a(n.emptyStr.call(t,t&&t.name,{hash:{},data:i}))+"</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DESCRIPTION",{hash:{},data:i}))+"</dt>\n            <dd>"+a(n.emptyStr.call(t,t&&t.description,{hash:{},data:i}))+"</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.ENDPOINT",{hash:{},data:i}))+"</dt>\n            <dd>",o=n["if"].call(t,t&&t.Endpoint,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_STATUS",{hash:{},data:i}))+'</dt>\n            <dd><i class="status status-',o=n.ifCond.call(t,t&&t.DBInstanceStatus,"available",{hash:{},inverse:f.program(16,y,i),fn:f.program(14,g,i),data:i});if(o||o===0)s+=o;s+='"></i>',o=n["if"].call(t,t&&t.DBInstanceStatus,{hash:{},inverse:f.program(20,w,i),fn:f.program(18,b,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.ENGINE",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.Engine,typeof o===u?o.apply(t):o))+"("+a((o=t&&t.EngineVersion,typeof o===u?o.apply(t):o))+")",o=n["if"].call(t,(o=t&&t.PendingModifiedValues,o==null||o===!1?o:o.EngineVersion),{hash:{},inverse:f.noop,fn:f.program(22,E,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_AUTO_UPGRADE",{hash:{},data:i}))+"</dt>\n            <dd>",o=n["if"].call(t,t&&t.AutoMinorVersionUpgrade,{hash:{},inverse:f.program(26,x,i),fn:f.program(24,S,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_CLASS",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.DBInstanceClass,typeof o===u?o.apply(t):o)),o=n["if"].call(t,(o=t&&t.PendingModifiedValues,o==null||o===!1?o:o.DBInstanceClass),{hash:{},inverse:f.noop,fn:f.program(28,T,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_IOPS",{hash:{},data:i}))+"</dt>\n            <dd>",o=n["if"].call(t,t&&t.Iops,{hash:{},inverse:f.program(32,C,i),fn:f.program(30,N,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,(o=t&&t.PendingModifiedValues,o==null||o===!1?o:o.Iops),{hash:{},inverse:f.noop,fn:f.program(34,k,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_STORAGE",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.AllocatedStorage,typeof o===u?o.apply(t):o))+" GB",o=n["if"].call(t,(o=t&&t.PendingModifiedValues,o==null||o===!1?o:o.AllocatedStorage),{hash:{},inverse:f.noop,fn:f.program(36,L,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_STORAGE_TYPE",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.StorageType,typeof o===u?o.apply(t):o)),o=n["if"].call(t,(o=t&&t.PendingModifiedValues,o==null||o===!1?o:o.StorageType),{hash:{},inverse:f.noop,fn:f.program(38,A,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_USERNAME",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.MasterUsername,typeof o===u?o.apply(t):o))+"</dd>\n            ",o=n["if"].call(t,(o=t&&t.ReadReplicaDBInstanceIdentifiers,o==null||o===!1?o:o.length),{hash:{},inverse:f.noop,fn:f.program(40,O,i),data:i});if(o||o===0)s+=o;s+="\n            ",o=n["if"].call(t,t&&t.ReadReplicaSourceDBInstanceIdentifier,{hash:{},inverse:f.noop,fn:f.program(43,_,i),data:i});if(o||o===0)s+=o;s+='\n        </dl>\n    </div>\n\n    <div class="option-group-head">'+a(n.i18n.call(t,"PROP.DBINSTANCE_DBCONFIG",{hash:{},data:i}))+'</div>\n    <div class="option-group">\n        <dl class="dl-vertical">\n            ',o=n["if"].call(t,t&&t.DBName,{hash:{},inverse:f.noop,fn:f.program(45,D,i),data:i});if(o||o===0)s+=o;s+="\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_PORT",{hash:{},data:i}))+"</dt>\n            <dd>",o=n["if"].call(t,t&&t.Endpoint,{hash:{},inverse:f.program(10,v,i),fn:f.program(8,d,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,(o=t&&t.PendingModifiedValues,o==null||o===!1?o:o.Port),{hash:{},inverse:f.noop,fn:f.program(12,m,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            ",o=n["if"].call(t,(o=t&&t.optionGroups,o==null||o===!1?o:o.length),{hash:{},inverse:f.noop,fn:f.program(47,P,i),data:i});if(o||o===0)s+=o;s+="\n            ",o=n["if"].call(t,(o=t&&t.DBParameterGroups,o==null||o===!1?o:o.length),{hash:{},inverse:f.noop,fn:f.program(53,F,i),data:i});if(o||o===0)s+=o;s+='\n\n        </dl>\n    </div>\n    <div class="option-group-head">'+a(n.i18n.call(t,"PROP.DBINSTANCE_NETWORK_AVAILABILITY",{hash:{},data:i}))+'</div>\n    <div class="option-group">\n        <dl class="dl-vertical">\n            <dt>'+a(n.i18n.call(t,"PROP.DBINSTANCE_SUBNETGROUP",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=(o=t&&t.DBSubnetGroup,o==null||o===!1?o:o.DBSubnetGroupName),typeof o===u?o.apply(t):o))+"\n                ",o=n["if"].call(t,(o=(o=t&&t.DBSubnetGroup,o==null||o===!1?o:o.Subnets),o==null||o===!1?o:o.length),{hash:{},inverse:f.noop,fn:f.program(56,q,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            ",o=n["if"].call(t,t&&t.AvailabilityZone,{hash:{},inverse:f.noop,fn:f.program(59,U,i),data:i});if(o||o===0)s+=o;s+="\n            ",o=n["if"].call(t,t&&t.SecondaryAvailabilityZone,{hash:{},inverse:f.noop,fn:f.program(61,z,i),data:i});if(o||o===0)s+=o;s+="\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_PUBLIC_ACCESS",{hash:{},data:i}))+"</dt>\n            <dd>",o=n["if"].call(t,t&&t.PubliclyAccessible,{hash:{},inverse:f.program(65,X,i),fn:f.program(63,W,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_LICENSE_MODEL",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.LicenseModel,typeof o===u?o.apply(t):o))+'</dd>\n        </dl>\n    </div>\n    <div class="option-group-head">'+a(n.i18n.call(t,"PROP.DBINSTANCE_BACKUP_MAINTENANCE",{hash:{},data:i}))+'</div>\n    <div class="option-group">\n        <dl class="dl-vertical">\n            <dt>'+a(n.i18n.call(t,"PROP.DBINSTANCE_AUTOBACKUP",{hash:{},data:i}))+"</dt>\n            <dd>",o=n["if"].call(t,t&&t.BackupRetentionPeriod,{hash:{},inverse:f.program(32,C,i),fn:f.program(67,V,i),data:i});if(o||o===0)s+=o;s+="</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_LAST_RESTORE",{hash:{},data:i}))+"</dt>\n            <dd>"+a(n.timeStr.call(t,t&&t.LatestRestorableTime,{hash:{},data:i}))+"</dd>\n            ",o=n["if"].call(t,t&&t.PreferredBackupWindow,{hash:{},inverse:f.noop,fn:f.program(69,$,i),data:i});if(o||o===0)s+=o;s+="\n            ",o=n["if"].call(t,t&&t.PreferredMaintenanceWindow,{hash:{},inverse:f.noop,fn:f.program(71,J,i),data:i});if(o||o===0)s+=o;return s+='\n        </dl>\n    </div>\n    <div class="option-group-head">\n        '+a(n.i18n.call(t,"PROP.RESOURCE_TAGS",{hash:{},data:i}))+'\n    </div>\n    <div class="option-group">\n        <div class="tagTable">\n            <div class="loading-spinner"></div>\n        </div>\n    </div>\n    <div class="option-group-head">'+a(n.i18n.call(t,"PROP.STACK_TIT_SG",{hash:{},data:i}))+'<span class="property-head-num-wrap">(<span id="property-head-sg-num"></span>)</span></div>\n    <div class="option-group sg-group"></div>\n</article>',s},n.appView=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<tr class="item">\n    <td>'+u((i=e&&e.LogFileName,typeof i===o?i.apply(e):i))+"</td>\n    <td>"+u(n.timeStr.call(e,e&&e.LastWritten,{hash:{},data:t}))+"</td>\n    <td>"+u((i=e&&e.Size,typeof i===o?i.apply(e):i))+"</td>\n    <td>",i=n["if"].call(e,e&&e.LogFileName,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+="</td>\n    ",i=n.unless.call(e,e&&e.isSafari,{hash:{},inverse:a.noop,fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;return r+="\n</tr>\n",r}function l(e,t){var r="",i;return r+='<a class="view" data-file-name="'+u((i=e&&e.LogFileName,typeof i===o?i.apply(e):i))+'">'+u(n.i18n.call(e,"PROP.LBL_VIEW",{hash:{},data:t}))+"</a>",r}function c(e,t){var r="",i;r+="\n    <td>\n        ",i=n["if"].call(e,e&&e.LogFileName,{hash:{},inverse:a.noop,fn:a.program(5,h,t),data:t});if(i||i===0)r+=i;return r+="\n    </td>\n    ",r}function h(e,t){var r="",i;return r+='<a class="download" data-file-name="'+u((i=e&&e.LogFileName,typeof i===o?i.apply(e):i))+'">'+u(n.i18n.call(e,"PROP.LBL_DOWNLOAD",{hash:{},data:t}))+"</a>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.log_list=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;return r+='\n<tr class="item">\n    <td>'+o(n.timeStr.call(e,e&&e.Date,{hash:{},data:t}))+"</td>\n    <td>"+o((i=e&&e.SourceIdentifier,typeof i===u?i.apply(e):i))+"</td>\n    <td>"+o((i=e&&e.Message,typeof i===u?i.apply(e):i))+"</td>\n</tr>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u="function",a=this;return s=n.each.call(t,t,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.event_list=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+='<section class="db-sys-log-content font-mono">\n    '+u(n.breaklines.call(t,t&&t.LogFileData,{hash:{},data:i}))+'\n    <br/>\n    ----------------------- END OF LOG ----------------------\n</section>\n<div class="action">\n    <button class="btn btn-blue refresh-log" data-file-name="'+u((o=t&&t.filename,typeof o===a?o.apply(t):o))+'">'+u(n.i18n.call(t,"PROP.RDS_LBL_REFRESH",{hash:{},data:i}))+'</button>\n    <button class="btn btn-silver close cancel">'+u(n.i18n.call(t,"PROP.RDS_LBL_CLOSE",{hash:{},data:i}))+"</button>\n</div>",s},n.log_content=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="text-center no-data">'+o(n.i18n.call(t,"PROP.RDS_NO_RECORDS_FOUND",{hash:{},data:i}))+"</div>",s},n.list_empty=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n        <tr> <td style="min-width:70px;">'+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</td><td>"+a(typeof e===u?e.apply(e):e)+"</td> </tr>\n    ",n}function c(e,t){var r="";return r+="\n        <tr>"+a(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</tr>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table cost-estimation-table">\n    <tbody>\n    ',o=n.each.call(t,t&&t.tagSet,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n    </tbody>\n</table>",s},n.tagSets=e.template(t),n}),define("wspace/awseditor/property/dbinstance/app_view",["../base/view","./template/app","og_manage_app","constant","toolbar_modal","ApiRequest","JsonExporter","i18n!/nls/lang.js"],function(e,t,n,r,i,s,o,u){var a;return a=e.extend({events:{"click .db-og-in-app":"openOgModal","click .property-btn-get-system-log":"openModal"},initialize:function(){this.isSafari=$("body").hasClass("safari")},render:function(){var e;return e=this.model?this.model.toJSON():this.resModel.serialize().component.resource,e.Endpoint||(e=_.extend(this.resModel.serialize().component.resource,e),e.DBSubnetGroup.DBSubnetGroupName=this.resModel.parent().get("name")),e.optionGroups=_.map(e.OptionGroupMemberships,function(e){var t;return t=Design.modelClassForType(r.RESTYPE.DBOG).findWhere({appId:e.OptionGroupName}),_.extend({},e,{isDefault:!t,uid:(t!=null?t.id:void 0)||""})}),e.description=this.resModel.get("description"),e.name=this.resModel.get("name"),this.$el.html(t.appView(e)),this.renderTagSet(),this.resModel.get("name")},renderTagSet:function(e,n){var r,i,o,a,f,l;return e&&n?(this.$el.find(".tagTable").html("<div class='dl-vertical'>"+n+"</div>"),!1):this.tagSet?this.$el.find(".tagTable").html(t.tagSets({tagSet:this.tagSet})):(l=this,a=this.resModel.design().region(),r=Design.instance().credential().get("awsAccount").split("-").join(""),/^\d+$/.test(r)===!1?(l.renderTagSet(!0,u.PROP.DB_SNAPSHOT_ACCOUNT_NUMBER_INVALID),!1):(f="db",o=this.model.get("id"),i="arn:aws:rds:"+a+":"+r+":"+f+":"+o,s("rds_ListTagsForResource",{key_id:Design.instance().credentialId(),region_name:a,resource_name:i}).then(function(e){var t,n;return t={},n=e.ListTagsForResourceResponse.ListTagsForResourceResult.TagList.Tag||[],!n.length&&!_.isArray(n)&&(n=[n]),_.each(n,function(e){return t[e.Key]=e.Value,null}),l.tagSet=t,l.renderTagSet()},function(){return l.renderTagSet(!0,u.PROP.DB_DB_SUBGROUP_FAILED_FETCHING_TAGS)})))},renderLogList:function(e){var n;return n=this,e?(e=_.map(e,function(e){return e.isSafari=n.isSafari,e}),this.modal.options.columns=this.getLogColumns(),this.modal.setContent(t.log_list(e))):this.modal.setContent(t.list_empty({}),!0),null},renderEventList:function(e){var n;return n=this,e?(this.modal.options.columns=this.getEventColumns(),this.modal.setContent(t.event_list(e))):this.modal.setContent(t.list_empty({}),!0),null},openOgModal:function(){var e;return e=this.resModel.connectionTargets("OgUsage")[0],new n({model:e})},openModal:function(){return new i(this.getModalOptions()),this.modal.on("slidedown",this.switchLogEvent,this),this.modal.delegate({"click a.view":"viewLog","click a.download":"downloadLog","click .refresh-log":"viewLog"},this),this.modal.render(),this.switchLog(),!1},switchLog:function(){return this.getLogList()},switchEvent:function(){return this.getEventList()},switchLogEvent:function(e){return this.modal.toggleSlide(!1).renderListLoading(),e==="event"?this.switchEvent():this.switchLog()},getEventList:function(){var e;return e=this,s("rds_DescribeEvents",{region_name:this.resModel.design().region(),key_id:Design.instance().credentialId(),source_id:this.resModel.get("appId"),source_type:"db-instance",event_categories:null,duration:20160}).then(function(t){var n,r,i,s;return n=(t!=null?(r=t.DescribeEventsResponse)!=null?(i=r.DescribeEventsResult)!=null?(s=i.Events)!=null?s.Event:void 0:void 0:void 0:void 0)||null,n&&!_.isArray(n)&&(n=[n]),e.renderEventList(n)},function(){}),null},getLogList:function(){var e;return e=this,s("rds_DescribeDBLogFiles",{db_identifier:this.resModel.get("appId"),region_name:this.resModel.design().region(),key_id:Design.instance().credentialId()}).then(function(t){var n,r,i,s;return n=(t!=null?(r=t.DescribeDBLogFilesResponse)!=null?(i=r.DescribeDBLogFilesResult)!=null?(s=i.DescribeDBLogFiles)!=null?s.DescribeDBLogFilesDetails:void 0:void 0:void 0:void 0)||null,n&&!_.isArray(n)&&(n=[n]),e.renderLogList(n)},function(){return e.renderLogList(null),null}),null},viewLog:function(e){var n,r;return r=this.modal,n=$(e.currentTarget).data("fileName"),r.toggleSlide(!0),this.getLogContent(n).then(function(e){return e.filename=n,r.setSlide(t.log_content(e))},function(){var e;return e={LogFileData:"",filename:n},r.setSlide(t.log_content(e))})},downloadLog:function(e){var t,n;return n=this.modal,t=$(e.currentTarget).data("fileName"),n.toggleSlide(!0),this.getLogContent(t).then(function(e){var r,i;return n.toggleSlide(!1),i=o.download,r=new Blob([e.LogFileData||""]),i(r,t)})},getLogContent:function(e){return s("rds_DownloadDBLogFilePortion",{region_name:this.resModel.design().region(),db_identifier:this.resModel.get("appId"),log_filename:e}).then(function(e){var t;return(e!=null?(t=e.DownloadDBLogFilePortionResponse)!=null?t.DownloadDBLogFilePortionResult:void 0:void 0)||{}},function(){return{}})},getModalOptions:function(){var e,t,n;return n=this,e=this.resModel.get("appId"),t={title:sprintf(u.IDE.TITLE_LOG_AND_EVENT,e),classList:"syslog-dbinstance",context:n,noCheckbox:!0,longtermActive:!0,buttons:[{icon:"unknown",type:"log",name:u.IDE.LBL_LOG,active:!0},{icon:"unknown",type:"event",name:u.IDE.LBL_EVENT}]},t.columns=this.getLogColumns(),this.isSafari&&t.columns.pop(),t},getLogColumns:function(){return[{sortable:!0,name:u.PROP.LBL_NAME},{sortable:!0,rowType:"datetime",name:u.IDE.LBL_LAST_WRITTEN,width:"28%"},{sortable:!0,rowType:"number",width:"10%",name:u.IDE.LBL_SIZE_B},{sortable:!1,width:"10%",name:u.PROP.LBL_VIEW},{sortable:!1,width:"10%",name:u.PROP.LBL_DOWNLOAD}]},getEventColumns:function(){return[{sortable:!0,rowType:"datetime",name:u.IDE.LBL_TIME,width:"28%"},{sortable:!0,width:"20%",name:u.PROP.LBL_SOURCE},{sortable:!1,name:u.IDE.LBL_SYSTEM_NOTES}]}}),new a}),define("wspace/awseditor/property/dbinstance/main",["Design","CloudResources","../base/main","./model","./view","./app_view","../sglist/main","constant","event"],function(e,t,n,r,i,s,o,u){var a;return a=n.extend({handleTypes:[u.RESTYPE.DBINSTANCE],onUnloadSubPanel:function(e){return o.onUnloadSubPanel(e),null},setupStack:function(){return null},initStack:function(t){return this.view=i,this.model=r,this.view.resModel=e.instance().component(t),this.view.isAppEdit=!1,null},afterLoadStack:function(){return o.loadModule(this.model),null},setupApp:function(){return null},initApp:function(n){var r;return r=e.instance().component(n),r.serialize().component.resource.ReadReplicaSourceDBInstanceIdentifier&&(n=r.serialize().component.resource.ReadReplicaSourceDBInstanceIdentifier.split(".")[0].split("{").pop()),this.model=t(e.instance().credentialId(),u.RESTYPE.DBINSTANCE,e.instance().region()).get(r.get("appId"))||t(e.instance().credentialId(),u.RESTYPE.DBSNAP,e.instance().region()).get(r.get("snapshotId"))||r,this.view=s,this.view.model=this.model,this.view.resModel=r,this.view.isAppEdit=!1,null},initAppEdit:function(n){var s,o;return o=e.instance().component(n),this.view=i,this.model=r,this.view.resModel=o,s=e.instance().__opsModel.getJsonData(),i.originComp=s.component[o.id],o.get("appId")?(this.view.isAppEdit=!0,this.view.appModel=t(e.instance().credentialId(),u.RESTYPE.DBINSTANCE,e.instance().region()).get(o.get("appId"))):this.view.isAppEdit=!1,null},afterLoadAppEdit:function(){return o.loadModule(this.view.resModel),null},afterLoadApp:function(){return o.loadModule(this.view.resModel),null}}),null,a}),define("wspace/awseditor/property/subnetgroup/template/stack",["handlebars"],function(e){var t=function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n<div class='mega-list-wraper-header'>"+a((i=t==null||t===!1?t:t.key,typeof i===u?i.apply(e):i))+'</div>\n<dl class="dl-vertical">\n',i=n.each.call(e,e,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="</dl>\n",r}function c(e,t){var n="",r;return n+="\n    <dt>"+a((r=e&&e.name,typeof r===u?r.apply(e):r))+"</dt>\n    <dd>("+a((r=e&&e.cidr,typeof r===u?r.apply(e):r))+")</dd>\n",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article class="property-subnet-group">\n  <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP.SUBNET_GROUP_DETAILS",{hash:{},data:i}))+'</div>\n  <div class="option-group">\n\n   <section class="property-control-group" data-bind="true">\n    <label class="left" for="property-dbinstance-name" >'+a(n.i18n.call(t,"PROP.SUBNET_GROUP_NAME",{hash:{},data:i}))+'</label>\n    <span class="required-input right">'+a(n.i18n.call(t,"PROP.INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n    <input class="input"  type="text" value="'+a((o=t&&t.name,typeof o===u?o.apply(t):o))+'" id="property-subnet-name" data-ignore="true" data-required-rollback="true"/>\n  </section>\n\n\n  <section class="property-control-group" data-bind="true">\n    <label class="left" for="property-dbinstance-name" >'+a(n.i18n.call(t,"PROP.SUBNET_GROUP_DESCRIPTION",{hash:{},data:i}))+'</label>\n    <span class="required-input right">'+a(n.i18n.call(t,"PROP.INSTANCE_REQUIRE",{hash:{},data:i}))+'</span>\n    <input class="input"  type="text" value="'+a((o=t&&t.description,typeof o===u?o.apply(t):o))+'" id="property-subnet-desc" data-ignore="true" data-required-rollback="true"/>\n  </section>\n</div>\n\n<div class="option-group-head expand">'+a(n.i18n.call(t,"PROP.SUBNET_GROUP_MEMBER",{hash:{},data:i}))+'<span class="property-head-num-wrap">('+a((o=t&&t.sbCount,typeof o===u?o.apply(t):o))+')</span>\n<button class="icon-edit tooltip add-rule" data-tooltip="Edit subnet group"></button></div>\n\n',o=n.each.call(t,t&&t.azSb,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n\n\n</article>",s};return e.template(t)}),define("wspace/awseditor/property/subnetgroup/view",["../base/view","./template/stack","i18n!/nls/lang.js","constant","Design","DbSubnetGPopup"],function(e,t,n,r,i,s){var o;return o=e.extend({events:{"change #property-subnet-name":"setName","change #property-subnet-desc":"setDesc","click .icon-edit":"editSgb"},setName:function(e){var t;t=$(e.currentTarget);if(t.parsley("validate")&&MC.aws.aws.checkResName(this.model.get("id"),t,"Subnet Group"))return this.model.set("name",t.val())},setDesc:function(e){var t;t=$(e.currentTarget);if(t.parsley("validate"))return this.model.set("description",t.val())},editSgb:function(){var e,t;return t=this,e=new s({model:this.model}),this.listenTo(e,"update",function(){return t.render(),this.stopListening(e),e.remove()}),!1},render:function(){var e,n;return n=this.model.connectionTargets("SubnetgAsso").map(function(e){return{name:e.get("name"),cidr:e.get("cidr"),az:e.parent().get("name")}}),e=this.model.toJSON(),e.sbCount=n.length,e.azSb=_.groupBy(n,"az"),e.isAppEdit=this.isAppEdit,this.$el.html(t(e)),this.model.get("name")}}),new o}),define("wspace/awseditor/property/subnetgroup/template/app",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n        <div class="mega-list-wraper-header">\n            '+a((i=e&&e.az,typeof i===u?i.apply(e):i))+'\n        </div>\n            <dl class="dl-vertical">\n            ',i=n.each.call(e,e&&e.subnets,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n            </dl>\n            ",r}function c(e,t){var n="",r;return n+="\n                <dt>"+a((r=e&&e.name,typeof r===u?r.apply(e):r))+"</dt>\n                <dd>("+a((r=e&&e.cidr,typeof r===u?r.apply(e):r))+")</dd>\n            ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<article class="property-app property-subnet-group">\n    <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP.SUBNET_GROUP_DETAILS",{hash:{},data:i}))+'</div>\n    <div class="option-group">\n        <dl class="dl-vertical">\n            <dt>'+a(n.i18n.call(t,"PROP.NAME",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.name,typeof o===u?o.apply(t):o))+"</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_SUBNET_GROUP_NAME",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.DBSubnetGroupName,typeof o===u?o.apply(t):o))+"</dd>\n            <dt>"+a(n.i18n.call(t,"PROP.DBINSTANCE_SUBNET_GROUP_DESC",{hash:{},data:i}))+"</dt>\n            <dd>"+a((o=t&&t.DBSubnetGroupDescription,typeof o===u?o.apply(t):o))+'</dd>\n        </dl>\n    </div>\n    <div class="option-group-head expand">'+a(n.i18n.call(t,"PROP.DBINSTANCE_SUBNET_GROUP_MEMBERS",{hash:{},data:i}))+'</div>\n    <div class="option-group">\n        ',o=n.each.call(t,t&&t.azSb,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='\n    </div>\n    <div class="option-group-head">\n        '+a(n.i18n.call(t,"PROP.RESOURCE_TAGS",{hash:{},data:i}))+'\n    </div>\n    <div class="option-group">\n        <div class="tagTable">\n            <div class="loading-spinner"></div>\n        </div>\n    </div>\n</article>',s},n.app=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+='\n        <tr> <td style="min-width:70px;">'+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</td><td>"+a(typeof e===u?e.apply(e):e)+"</td> </tr>\n    ",n}function c(e,t){var r="";return r+="\n        <tr>"+a(n.i18n.call(e,"PROP.RESOURCE_NO_TAGS",{hash:{},data:t}))+"</tr>\n    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<table class="table cost-estimation-table">\n    <tbody>\n    ',o=n.each.call(t,t&&t.tagSet,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n    </tbody>\n</table>",s},n.tagSets=e.template(t),n}),define("wspace/awseditor/property/subnetgroup/app_view",["../base/view","./template/app","i18n!/nls/lang.js","constant","Design","CloudResources","ApiRequest"],function(e,t,n,r,i,s,o){var u;return u=e.extend({render:function(){var e,n;if(!this.appModel)return;return e=this.appModel.toJSON(),e.azSb=this.getAzSb(),e.sbCount=((n=this.appModel.get("Subnets"))!=null?n.length:void 0)||0,e.name=this.model.get("name"),this.$el.html(t.app(e)),this.renderTagSet(),e.name},renderTagSet:function(e,r){var s,u,a,f,l,c;return e&&r?(this.$el.find(".tagTable").html("<div class='dl-vertical'>"+r+"</div>"),!1):this.tagSet?this.$el.find(".tagTable").html(t.tagSets({tagSet:this.tagSet})):(c=this,f=i.instance().region(),s=i.instance().credential().get("awsAccount").split("-").join(""),/^\d+$/.test(s)===!1?(c.renderTagSet(!0,n.PROP.DB_SNAPSHOT_ACCOUNT_NUMBER_INVALID),!1):(l="subgrp",a=this.appModel.get("id"),u="arn:aws:rds:"+f+":"+s+":"+l+":"+a,o("rds_ListTagsForResource",{key_id:i.instance().credentialId(),region_name:f,resource_name:u}).then(function(e){var t,n;return t={},n=e.ListTagsForResourceResponse.ListTagsForResourceResult.TagList.Tag||[],!n.length&&!_.isArray(n)&&(n=[n]),_.each(n,function(e){return t[e.Key]=e.Value,null}),c.tagSet=t,c.renderTagSet()},function(){return c.renderTagSet(!0,n.PROP.DB_DB_SUBGROUP_FAILED_FETCHING_TAGS)})))},getAzSb:function(){var e,t;return e={},t=s(i.instance().credentialId(),r.RESTYPE.SUBNET,i.instance().region()),_.each(this.appModel.get("Subnets"),function(n){var r,i;return r=n.SubnetAvailabilityZone.Name,i=t.get(n.SubnetIdentifier),e[r]||(e[r]=[]),e[r].push({name:i.get("subnetId"),cidr:i.get("cidrBlock")})}),e=_.map(e,function(e,t){return{az:t,subnets:e}}),e}}),new u}),define("wspace/awseditor/property/subnetgroup/main",["Design","../base/main","./view","./app_view","CloudResources","constant"],function(e,t,n,r,i,s){var o;return o=t.extend({handleTypes:[s.RESTYPE.DBSBG],initStack:function(t){return this.model=e.instance().component(t),this.view=n,this.view.isAppEdit=!1,null},initApp:function(t){var n;return this.model=e.instance().component(t),this.view=r,this.view.appModel=(n=i(e.instance().credentialId(),s.RESTYPE.DBSBG,e.instance().region()))!=null?n.get(this.model.get("appId")):void 0,this.view.isAppEdit=!1,null},initAppEdit:function(t){return this.model=e.instance().component(t),this.view=n,this.view.isAppEdit=!0,null}}),null}),define("wspace/awseditor/subviews/PropertyPanel",["../template/TplRightPanel","../property/base/main","StateEditor","constant","Design","OpsModel","event","CloudResources","tag_manager","backbone","../property/stack/main","../property/instance/main","../property/servergroup/main","../property/connection/main","../property/staticsub/main","../property/missing/main","../property/sg/main","../property/sgrule/main","../property/volume/main","../property/elb/main","../property/az/main","../property/subnet/main","../property/vpc/main","../property/rtb/main","../property/static/main","../property/cgw/main","../property/vpn/main","../property/eni/main","../property/acl/main","../property/launchconfig/main","../property/asg/main","../property/dbinstance/main","../property/subnetgroup/main"],function(e,t,n,r,i,s,o,u,a){var f;return o.onLongListen(o.REFRESH_PROPERTY,function(){$("#OEPanelRight").trigger("REFRESH")}),o.onLongListen(o.FORCE_OPEN_PROPERTY,function(){$("#OEPanelRight").trigger("FORCE_SHOW"),$("#OEPanelRight").trigger("SHOW_PROPERTY")}),o.onLongListen(o.SHOW_STATE_EDITOR,function(e){$("#OEPanelRight").trigger("SHOW_STATEEDITOR",[e])}),o.onLongListen(o.OPEN_PROPERTY,function(e,t){$("#OEPanelRight").trigger("OPEN",[e,t])}),f=function(e){return function(){var t;return t=Array.prototype.slice.call(arguments,0),t.shift(),this[e].apply(this,t)}},Backbone.View.extend({events:{"click .HideSecondPanel":"hideSecondPanel","click .option-group-head":"updateRightPanelOption",OPEN_SUBPANEL:f("showSecondPanel"),HIDE_SUBPANEL:f("immHideSecondPanel"),OPEN_SUBPANEL_IMM:f("immShowSecondPanel"),OPEN:f("openPanel"),SHOW_STATEEDITOR:"showStateEditor",FORCE_SHOW:"forceShow",REFRESH:"refresh",SHOW_PROPERTY:"switchToProperty","click #btn-switch-property":"switchToProperty","click #btn-switch-state":"showStateEditor","click .open-tag-manager":"openTagManager"},initialize:function(e){return _.extend(this,e),this.render()},render:function(){this.setElement(this.parent.$el.find(".OEPanelRight").html(e())),this.$el.toggleClass("hidden",this.__rightPanelHidden||!1),this.__backup?(t.restore(this.__backup),this.restoreAccordion(this.__backup.activeModuleType,this.__backup.activeModuleId)):this.openPanel(),this.__showingState&&this.showStateEditor()},backup:function(){this.$el.empty().attr("id",""),this.__backup=t.snapshot()},recover:function(){this.$el.attr("id","OEPanelRight"),this.render()},toggleRightPanel:function(){return this.__rightPanelHidden=this.$el.toggleClass("hidden").hasClass("hidden"),null},showSecondPanel:function(e,t){return this.$el.find(".HideSecondPanel").data("tooltip","Back to "+this.$el.find(".property-title").text()),this.$el.find(".property-second-panel").show().animate({left:"0%"},200),this.$el.find(".property-first-panel").animate({left:"-30%"},200,function(){}),this.$el.find(".property-first-panel").hide()},immShowSecondPanel:function(e,t){return this.$el.find(".HideSecondPanel").data("tooltip","Back to "+this.$el.find(".property-title").text()),this.$el.find(".property-second-panel").show().css({left:"0%"}),this.$el.find(".property-first-panel").css({left:"-30%",display:"none"}),null},immHideSecondPanel:function(){return this.$el.find(".property-second-panel").css({display:"none",left:"100%"}).children(".scroll-wrap").children(".property-content").empty(),this.$el.find(".property-first-panel").css({display:"block",left:"0px"}),null},hideSecondPanel:function(){var e;return e=this.$el.find(".property-second-panel"),e.animate({left:"100%"},200,function(e){return function(){return e.$el.find(".property-second-panel").hide()}}(this)),this.$el.find(".property-first-panel").show().animate({left:"0%"},200),t.onUnloadSubPanel(),!1},updateRightPanelOption:function(e){var n,r,i,s,o;r=$(e.currentTarget);if(r.is("button")||r.is("a"))return;s=r.hasClass("expand"),n=r.next(),s?n.css("display","block").slideUp(200):n.slideDown(200),r.toggleClass("expand");if(!r.parents(".property-first-panel").length)return;return this.__optionStates=this.__optionStates||{},i=t.activeModule().uid||"Stack",o=_.map(this.$el.find(".property-first-panel").find(".option-group-head"),function(e){return $(e).hasClass("expand")}),this.__optionStates[i]=o,i=this.workspace.design.component(i),i&&(this.__optionStates[i.type]=o),!1},openPanel:function(e,n){var r,i,s,o,u;if(this.__lastOpenType===e&&this.__lastOpenId===n&&this.__showingState)return;this.__lastOpenType=e,this.__lastOpenId=n,$(document.activeElement).filter("input, textarea").blur(),this.immHideSecondPanel(),i=this.workspace.design;if(!i)return;n?(r=i.component(n),r&&r.type===e&&i.modeIsApp()&&r.get("appId")&&!r.hasAppResource()&&(e=r.type||"Missing_Resource")):e="Stack",i.modeIsApp()||i.modeIsAppView()?o=t.TYPE.App:i.modeIsStack()?o=t.TYPE.Stack:!r||r.get("appId")||r.type==="ExpandedAsg"&&((u=r.get("originalAsg"))!=null?u.get("appId"):void 0)?o=t.TYPE.AppEdit:o=t.TYPE.Stack;try{t.load(e,n,o)}catch(a){s=a,void 0}this.restoreAccordion(e,n),this.updateStateSwitcher(e,n),this.$el.toggleClass("state",!1),this.__showingState=!1},restoreAccordion:function(e,t){var n,r,i,s,o,u,a;if(!this.__optionStates)return;i=this.__optionStates[t],i||(i=this.__optionStates[e]);if(i){u=this.$el.find(".property-first-panel").find(".option-group-head");for(r=s=0,o=u.length;s<o;r=++s)n=u[r],$(n).toggleClass("expand",i[r]);a=this.__optionStates;for(t in a){i=a[t];if(!t||this.workspace.design.component(t)||t.indexOf("i-")===0||t==="Stack")continue;delete this.__optionStates[t]}}},updateStateSwitcher:function(e,n){var o,u,a,f;a=!1,u=this.workspace.design;if(e==="component_server_group"||e===r.RESTYPE.LC||e===r.RESTYPE.INSTANCE||e===r.RESTYPE.MESOSMASTER||e===r.RESTYPE.MESOSSLAVE||e===r.RESTYPE.MESOSLC){i.instance().attributes.agent.enabled?(a=!0,$("#state-editor-body").trigger("SAVE_STATE")):a=!1;if(u.modeIsApp()){e==="component_server_group"&&(a=!1);if(e===r.RESTYPE.LC||e===r.RESTYPE.MESOSLC)a=this.workspace.opsModel.testState(s.State.Stopped)}}return this.$el.toggleClass("no-state",!a),a&&(o=u.component(n)||u.component(t.activeModule().model.attributes.uid),o=(o!=null?(f=o.get("state"))!=null?f.length:void 0:void 0)||0,$("#btn-switch-state").find("b").text("("+o+")")),a},forceShow:function(){var e;this.__rightPanelHidden&&(this.__rightPanelHidden=!1,this.$el.toggleClass("no-transition",!0).removeClass("hidden"),e=this,setTimeout(function(){return e.$el.removeClass("no-transition")},100))},refresh:function(){var e;e=t.activeModule()||{},this.openPanel(e.handle,e.uid)},switchToProperty:function(){this.__showingState=!1,this.$el.toggleClass("state",!1),this.refresh()},showStateEditor:function(e,s){var o,a,f,l,c,h;if((e!=null?e.type:void 0)==="SHOW_STATEEDITOR"&&this.__showingState)return!1;s||(s=t.activeModule().uid),l=this.workspace.design,a=l.component(s)||((h=u(i.instance().credentialId(),r.RESTYPE.INSTANCE,i.instance().get("region")).findWhere({id:s}))!=null?h.toJSON():void 0);if(!a)return;a.type||(a.type=r.RESTYPE.INSTANCE);if(!this.updateStateSwitcher(a.type,s)){this.openPanel(a.type,s);return}this.__showingState=!0,this.$el.toggleClass("state",!0),l.modeIsApp()&&(s=i.modelClassForType(r.RESTYPE.INSTANCE).getEffectiveId(s).uid),o=l.serialize().component,f=o[s],a&&a.id.indexOf("i-")===0&&(c=a.id),n.loadModule(o,s,c),this.forceShow()},openTagManager:function(){var e,n;return n=t.activeModule().uid,e=this.workspace.design.component(n),new a(e)}})}),define("wspace/awseditor/template/TplOpsEditor",["handlebars"],function(e){var t,n={toolbar:{},confirm:{},"export":{},modal:{}};return t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<button class="btn-toolbar tooltip icon-export-png toolbar-btn-primary" data-tooltip=\''+o(n.i18n.call(t,"TOOLBAR.EXPORT_AS_PNG",{hash:{},data:i}))+'\' data-analytics-plus="export_vis_png">'+o(n.i18n.call(t,"TOOLBAR.EXPORT_AS_PNG",{hash:{},data:i}))+"</button>",s},n.toolbar.BtnActionPng=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<button class="btn-toolbar icon-zoom-in tooltip" data-tooltip=\''+o(n.i18n.call(t,"TOOLBAR.TIP_ZOOM_IN",{hash:{},data:i}))+"'></button>\n<button class=\"btn-toolbar icon-zoom-out seperator tooltip\" data-tooltip='"+o(n.i18n.call(t,"TOOLBAR.TIP_ZOOM_OUT",{hash:{},data:i}))+"'></button>",s},n.toolbar.BtnZoom=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="selectbox btn-toolbar toolbar-line-style">\n  <button class="selection tooltip" data-tooltip="'+o(n.i18n.call(t,"TOOLBAR.TIP_SG_LINE_STYLE",{hash:{},data:i}))+'"></button>\n  <ul class="dropdown">\n    <li class=\'item\' data-id="0"><span class="icon-straight">'+o(n.i18n.call(t,"TOOLBAR.LBL_LINESTYLE_STRAIGHT",{hash:{},data:i}))+'</span></li>\n    <li class=\'item\' data-id="1"><span class="icon-elbow">'+o(n.i18n.call(t,"TOOLBAR.LBL_LINESTYLE_ELBOW",{hash:{},data:i}))+'</span></li>\n    <li class=\'item\' data-id="2"><span class="icon-bezier-q">'+o(n.i18n.call(t,"TOOLBAR.LBL_LINESTYLE_CURVE",{hash:{},data:i}))+'</span></li>\n  </ul>\n</div>\n<button class="btn-toolbar icon-hide-sg tooltip" data-tooltip=\''+o(n.i18n.call(t,"TOOLBAR.LBL_LINESTYLE_HIDE_SG",{hash:{},data:i}))+"'></button>",s},n.toolbar.BtnLinestyle=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<button class="btn-toolbar icon-play tooltip toolbar-btn-primary runApp" data-tooltip=\''+o(n.i18n.call(t,"TOOLBAR.TIP_BTN_RUN_STACK",{hash:{},data:i}))+"'>"+o(n.i18n.call(t,"TOOLBAR.BTN_RUN_STACK",{hash:{},data:i}))+"</button>",s},n.toolbar.BtnRunStack=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<button class="btn-toolbar tooltip icon-save" data-tooltip=\''+o(n.i18n.call(t,"TOOLBAR.TIP_SAVE_STACK",{hash:{},data:i}))+"'></button>\n<button class=\"btn-toolbar icon-delete tooltip seperator\" data-tooltip='"+o(n.i18n.call(t,"TOOLBAR.TIP_DELETE_STACK",{hash:{},data:i}))+"'></button>\n<button class=\"btn-toolbar tooltip icon-duplicate\" data-tooltip='"+o(n.i18n.call(t,"TOOLBAR.TIP_DUPLICATE_STACK",{hash:{},data:i}))+"'></button>\n<button class=\"btn-toolbar icon-new-stack tooltip seperator\" data-tooltip='"+o(n.i18n.call(t,"TOOLBAR.TIP_CREATE_STACK",{hash:{},data:i}))+"'></button>",s},n.toolbar.BtnStackOps=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="selectbox btn-toolbar seperator">\n  <button class="selection tooltip icon-send" data-tooltip=\''+o(n.i18n.call(t,"TOOLBAR.EXPORT",{hash:{},data:i}))+'\'></button>\n  <ul class="dropdown">\n    <li data-analytics-plus="export_png" class="icon-export-png">'+o(n.i18n.call(t,"TOOLBAR.EXPORT_AS_PNG",{hash:{},data:i}))+'</li>\n    <li data-analytics-plus="export_json" class="icon-export-json">'+o(n.i18n.call(t,"TOOLBAR.EXPORT_AS_JSON",{hash:{},data:i}))+'</li>\n    <li data-analytics-plus="cloudformation" class="icon-toolbar-cloudformation">'+o(n.i18n.call(t,"TOOLBAR.EXPORT_AS_CF",{hash:{},data:i}))+"</li>\n  </ul>\n</div>",s},n.toolbar.BtnExport=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<button class="tooltip btn-toolbar icon-update-app toolbar-btn-primary" data-tooltip="'+o(n.i18n.call(t,"TOOLBAR.TIP_UPDATE_APP",{hash:{},data:i}))+'">'+o(n.i18n.call(t,"TOOLBAR.EDIT_APP",{hash:{},data:i}))+'</button>\n<button class="tooltip btn-toolbar icon-apply-app toolbar-btn-primary" data-tooltip="'+o(n.i18n.call(t,"TOOLBAR.TIP_SAVE_UPDATE_APP",{hash:{},data:i}))+'">'+o(n.i18n.call(t,"TOOLBAR.APPLY_EDIT",{hash:{},data:i}))+'</button>\n<button class="tooltip btn-toolbar icon-cancel-update-app seperator" data-tooltip="'+o(n.i18n.call(t,"TOOLBAR.TIP_CANCEL_UPDATE_APP",{hash:{},data:i}))+'"></button>',s},n.toolbar.BtnEditApp=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression;s+='<button class="tooltip btn-toolbar icon-stop" data-tooltip="'+u(n.i18n.call(t,"TOOLBAR.TIP_STOP_APP",{hash:{},data:i}))+'"></button>\n<button class="tooltip btn-toolbar icon-play startApp" data-tooltip="'+u(n.i18n.call(t,"TOOLBAR.TIP_START_APP",{hash:{},data:i}))+'"><span style="display: none">'+u(n.i18n.call(t,"TOOLBAR.START_APP",{hash:{},data:i}))+'</span></button>\n<button class="btn-toolbar tooltip icon-terminate seperator" data-tooltip="',o=n.i18n.call(t,"TOOLBAR.TIP_TERMINATE_APP",{hash:{},data:i});if(o||o===0)s+=o;s+='"></button>\n<button class="btn-toolbar tooltip icon-forget-app seperator" data-tooltip="',o=n.i18n.call(t,"TOOLBAR.TIP_FORGET_APP",{hash:{},data:i});if(o||o===0)s+=o;return s+='"></button>\n<button class="btn-toolbar tooltip icon-save-app seperator" data-tooltip=\''+u(n.i18n.call(t,"TOOLBAR.TIP_SAVE_APP_TO_STACK",{hash:{},data:i}))+"'></button>",s},n.toolbar.BtnAppOps=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<button class="btn-toolbar icon-export-png tooltip seperator" data-analytics-plus="export_png" data-tooltip=\''+o(n.i18n.call(t,"TOOLBAR.EXPORT_AS_PNG",{hash:{},data:i}))+"'></button>",s},n.toolbar.BtnPng=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<button class="btn-toolbar tooltip icon-refresh" data-tooltip="'+o(n.i18n.call(t,"TOOLBAR.TIP_REFRESH_RESOURCES",{hash:{},data:i}))+'"></button>',s},n.toolbar.BtnReloadRes=e.template(t),t=function(e,t,n,r,i){function f(e,t){return" on"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a=this.escapeExpression;s+='<label class="switch toolbar-visual-ops-switch tooltip',o=n["if"].call(t,t&&t.stateOn,{hash:{},inverse:u.noop,fn:u.program(1,f,i),data:i});if(o||o===0)s+=o;return s+='" data-tooltip="'+a(n.i18n.call(t,"TOOLBAR.TIP_CUSTOM_USER_DATA",{hash:{},data:i}))+'">\n    <span class="switch-label" data-on="'+a(n.i18n.call(t,"TOOLBAR.TOGGLE_VISUALOPS_ON",{hash:{},data:i}))+'" data-off="'+a(n.i18n.call(t,"TOOLBAR.TOGGLE_VISUALOPS_OFF",{hash:{},data:i}))+'"></span>\n    <span class="switch-handle"></span>\n</label>',s},n.toolbar.BtnSwitchStates=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<button class="icon-reload tooltip btn btn-blue reload-states" data-original="'+o(n.i18n.call(t,"TOOLBAR.RELOAD_STATES",{hash:{},data:i}))+'" data-disabled="'+o(n.i18n.call(t,"TOOLBAR.INITIATING",{hash:{},data:i}))+'…"  data-tooltip="'+o(n.i18n.call(t,"TOOLBAR.INSTANTLY_RERUN_ALL_STATES_IN_THIS_APP",{hash:{},data:i}))+'">'+o(n.i18n.call(t,"TOOLBAR.RELOAD_STATES",{hash:{},data:i}))+"</button>",s},n.toolbar.BtnReloadStates=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="modal-text-wraper">\n    <div class="modal-center-align-helper">\n        <div class="modal-text-major">'+o(n.i18n.call(t,"TOOLBAR.CONFIRM_ENABLE_STATE",{hash:{},data:i}))+"</div>\n    </div>\n</div>",s},n.confirm.enableState=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="";return r+='\n            <div class="modal-text-highlight">'+u(n.i18n.call(e,"TOOLBAR.EXPORT_CLOUDFORMATION_WARNING",{hash:{},data:t}))+"</div>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this;s+='<div class="modal-text-wraper">\n    <div class="modal-center-align-helper">\n        ',o=n["if"].call(t,t&&t.hasCustomOG,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i});if(o||o===0)s+=o;return s+='\n        <div class="modal-text-minor">'+u(n.i18n.call(t,"TOOLBAR.POP_EXPORT_CF_INFO",{hash:{},data:i}))+'</div>\n    </div>\n</div>\n<div class="stack-validation">\n    <details open style="display:none;">\n        <summary>'+u(n.i18n.call(t,"POP_CONFIRM_UPDATE_VALIDATION",{hash:{},data:i}))+'<span class="nutshell">:<label></label></span></summary>\n        <div id="stack-run-validation-container"></div>\n    </details>\n    <div class="validating">\n        <div class="loading-spinner loading-spinner-small"></div>\n        <p>'+u(n.i18n.call(t,"TOOLBAR.VALIDATING_STACK",{hash:{},data:i}))+'</p>\n    </div>\n</div>\n<div style="padding-top:20px;text-align:right;">\n    <a class="btn btn-blue disabled">'+u(n.i18n.call(t,"HEAD_INFO_LOADING",{hash:{},data:i}))+'</a>\n    <button class="btn modal-close btn-silver">'+u(n.i18n.call(t,"TOOLBAR.POP_BTN_CANCEL",{hash:{},data:i}))+"</button>\n</div>",s},n.export.CF=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function";return s+='<div class="modal-text-wraper">\n    <div class="modal-center-align-helper" style="padding:40px 20px;">\n        <div class="modal-text-major"></div>\n        <div class="modal-text-minor">'+u(n.i18n.call(t,"TOOLBAR.POP_BODY_EXPORT_AS_JSON",{hash:{},data:i}))+'</div>\n    </div>\n</div>\n<div class="modal-footer">\n    <a class="btn btn-blue" href="'+u((o=t&&t.data,typeof o===a?o.apply(t):o))+'" target="_blank">'+u(n.i18n.call(t,"TOOLBAR.POP_BTN_DOWNLOAD",{hash:{},data:i}))+'</a>\n    <button id="tpl-cancel" class="btn modal-close btn-silver">'+u(n.i18n.call(t,"TOOLBAR.POP_BTN_CANCEL",{hash:{},data:i}))+"</button>\n</div>",s},n.export.JSON=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="loading-spinner"></div>\n<section style="margin:10px 10px 0;max-height:420px;overflow:hidden;text-align:center;display:none;"></section>\n<div class="modal-footer">\n    <a class="btn btn-blue" style="display: inline-block;">'+o(n.i18n.call(t,"TOOLBAR.LBL_DOWNLOAD",{hash:{},data:i}))+'</a>\n    <button class="btn modal-close btn-silver">'+o(n.i18n.call(t,"TOOLBAR.LBL_CANCEL",{hash:{},data:i}))+"</button>\n</div>",s},n.export.PNG=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="modal-text-wraper">\n    <div class="modal-center-align-helper">\n        <div class="modal-text-major">'+o(n.i18n.call(t,"TOOLBAR.CANCEL_UPDATE_CONFIRM",{hash:{},data:i}))+'</div>\n        <div class="modal-text-major">'+o(n.i18n.call(t,"TOOLBAR.DISCARD_UPDATE_CHANGE",{hash:{},data:i}))+"</div>\n    </div>\n</div>",s},n.modal.cancelUpdate=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+='<div class="modal-text-wrapper">\n    <div class="modal-center-align-helper">\n        <div class="modal-text-major">'+o(n.i18n.call(t,"IDE.CONTENT_OPS_CONFLICT",{hash:{},data:i}))+"</div>\n    </div>\n</div>",s},n.modal.confliction=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;return r+='\n        <div id="replace_stack" style="padding: 10px 0">\n            <div class="radio">\n                <input id="radio-replace-stack" type="radio" name="save-stack-type" value="replace" checked>\n                <label for="radio-replace-stack"></label>\n            </div>\n            <label class="modal-text-minor" for="radio-replace-stack">'+u(n.i18n.call(e,"TOOLBAR.POP_REPLACE_STACK",{hash:{},data:t}))+'</label>\n            <div style="padding: 10px 22px" class="radio-instruction">\n                '+u(n.i18n.call(e,"TOOLBAR.POP_REPLACE_STACK_INTRO",{hash:{},data:t}))+' "'+u((i=e&&e.input,typeof i===a?i.apply(e):i))+'" '+u(n.i18n.call(e,"TOOLBAR.POP_REPLACE_STACK_INTRO_END",{hash:{},data:t}))+'\n            </div>\n        </div>\n        <div id="save_new_stack">\n            <div class="radio">\n                <input id="radio-new-stack" type="radio" name="save-stack-type">\n                <label for="radio-new-stack"></label>\n            </div>\n            <label class="modal-text-minor" for="radio-new-stack">'+u(n.i18n.call(e,"TOOLBAR.POP_SAVE_NEW_STACK",{hash:{},data:t}))+'</label>\n            <div style="padding: 10px 22px" class="radio-instruction hide">\n                <p>'+u(n.i18n.call(e,"TOOLBAR.POP_SAVE_STACK_INSTRUCTION",{hash:{},data:t}))+'</p>\n                <input class="input" id="modal-input-value" value="'+u((i=e&&e.stackName,typeof i===a?i.apply(e):i))+'" type="text" style="width: 400px"/>\n                <div id="stack-name-exist" class="hide" style="color: #ec3c38">\n                  '+u(n.i18n.call(e,"TOOLBAR.POP_STACK_NAME_ERROR",{hash:{},data:t}))+"</div>\n            </div>\n        </div>\n        ",r}function c(e,t){var r="",i;return r+='\n        <div id="name_new_stack">\n            <input id="radio-new-stack" type="hidden" name="save-stack-type" checked>\n            <div style="padding: 10px 22px" class="radio-instruction">\n                <p>'+u(n.i18n.call(e,"TOOLBAR.POP_SAVE_STACK_INSTRUCTION",{hash:{},data:t}))+'</p>\n                <input class="input" id="modal-input-value" value="'+u((i=e&&e.stackName,typeof i===a?i.apply(e):i))+'" type="text" style="width: 400px"/>\n                <div id="stack-name-exist" class="hide" style="color: #ec3c38">'+u(n.i18n.call(e,"TOOLBAR.POP_STACK_NAME_ERROR",{hash:{},data:t}))+"</div>\n            </div>\n        </div>\n        ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a="function",f=this;s+='<p class="modal-text-major">'+u(n.i18n.call(t,"TOOLBAR.POP_INTRO_1",{hash:{},data:i}))+'</p>\n<p class="modal-text-minor">'+u(n.i18n.call(t,"TOOLBAR.POP_INTRO_2",{hash:{},data:i}))+'</p>\n<div class="modal-center-align-helper">\n    <div class="modal-control-group">\n        ',o=n["if"].call(t,t&&t.originStackExist,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n    </div>\n</div>",s},n.saveAppToStack=e.template(t),n});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/subviews/Toolbar",["OpsModel","../template/TplOpsEditor","ThumbnailUtil","JsonExporter","ApiRequest","i18n!/nls/lang.js","UI.modalplus","kp_dropdown","ResDiff","constant","event","TaGui","CloudResources","AppAction","FilterInput","UI.notification","backbone"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){return Backbone.View.extend({events:{"click .icon-save":"saveStack","click .icon-delete":"deleteStack","click .icon-duplicate":"duplicateStack","click .icon-new-stack":"createStack","click .icon-zoom-in":"zoomIn","click .icon-zoom-out":"zoomOut","click .icon-export-png":"exportPNG","click .icon-export-json":"exportJson","click .icon-toolbar-cloudformation":"exportCF","click .runApp":"runStack","OPTION_CHANGE .toolbar-line-style":"setTbLineStyle","click .icon-hide-sg":"toggleSgLine","click .icon-stop":"stopApp","click .startApp":"startApp","click .icon-terminate":"terminateApp","click .icon-forget-app":"forgetApp","click .icon-refresh":"refreshResource","click .icon-update-app":"switchToAppEdit","click .icon-apply-app":"applyAppEdit","click .icon-cancel-update-app":"cancelAppEdit","click .toolbar-visual-ops-switch":"opsOptionChanged","click .reload-states":"reloadState","click .icon-save-app":"appToStack"},initialize:function(e){var n,r,i,s,o,u,a,f;_.extend(this,e),this.appAction=new p({workspace:this.workspace}),s=this.workspace.opsModel,s.isStack()?(i=["BtnRunStack","BtnStackOps","BtnZoom","BtnExport","BtnLinestyle"],s.isMesos()||i.push("BtnSwitchStates")):i=["BtnEditApp","BtnAppOps","BtnZoom","BtnPng","BtnLinestyle","BtnReloadRes"],u="";for(a=0,f=i.length;a<f;a++)r=i[a],n={stateOn:this.workspace.design.get("agent").enabled},u+=t.toolbar[r](n);this.workspace.opsModel.isApp()&&this.workspace.design.attributes.agent.enabled&&(u+=t.toolbar.BtnReloadStates()),this.setElement(this.parent.$el.find(".OEPanelTop").html(u)),o=this,setTimeout(function(){if(!o.workspace.isRemoved())return o.updateTbBtns()},1e3),this.updateZoomButtons(),this.updateTbBtns(),this.initFilter(),this.listenTo(this.workspace.opsModel,"change:state",this.updateTbBtns)},initFilter:function(){return this.filter=new d({isVisual:!0}),this.listenTo(this.filter,"change:filter",this.highlightCanvas),this.listenTo(this.filter,"focus",this.highlightCanvas),this.listenTo(this.filter,"hover",this.highlightCanvas),this.$(".btn-toolbar").last().after(this.filter.render().el)},highlightCanvas:function(e,t){var n;return arguments.length||(n=this.filter.getMatchedResource(!0),e=n.matched,t=n.effect),t?this.workspace.view.highLightModels(e):this.workspace.view.removeHighlight()},updateTbBtns:function(){var t,n,r,i,s,o;if(this.workspace.isRemoved())return;i=this.workspace.opsModel,this.$el.children(".toolbar-line-style").children(".dropdown").children().eq(parseInt(localStorage.getItem("canvas/lineStyle"),10)||2).click(),i.isApp()&&(r=this.workspace.isAppEditMode&&this.workspace.isAppEditMode(),this.$el.children(".icon-update-app").toggle(!r),this.$el.children(".icon-apply-app, .icon-cancel-update-app").toggle(r),r?(this.$el.children(".icon-terminate, .icon-forget-app, .icon-stop, .icon-play, .icon-refresh, .icon-save-app, .icon-reload").hide(),this.$el.find(".icon-refresh").hide()):(s=i.testState(e.State.Running),o=i.testState(e.State.Stopped),this.$el.children(".icon-terminate, .icon-forget-app, .icon-refresh, .icon-save-app, .icon-reload").show(),this.$el.children(".icon-stop").toggle(i.get("stoppable")&&s),this.$el.children(".icon-play").toggle(o).toggleClass("toolbar-btn-primary seperator",i.testState(e.State.Stopped)).find("span").toggle(o),this.$el.children(".icon-update-app").toggle(!o),this.$el.find(".icon-refresh").toggle(s),t=[].concat(this.workspace.design.componentsOfType(f.RESTYPE.INSTANCE),this.workspace.design.componentsOfType(f.RESTYPE.LC)),n=_.find(t,function(e){var t;return e&&((t=e.attributes.state)!=null?t.length:void 0)>0}),this.$el.find(".reload-states").toggle(!!n))),this.workspace.opsModel.testState(e.State.Saving)?this.$el.children(".icon-save").attr("disabled","disabled"):this.$el.children(".icon-save").removeAttr("disabled"),this.updateZoomButtons()},setTbLineStyle:function(e,t){localStorage.setItem("canvas/lineStyle",t),this.parent.canvas&&this.parent.canvas.updateLineStyle()},toggleSgLine:function(){var e,t;e=$(".icon-hide-sg"),t=e.hasClass("selected"),t?e.data("tooltip",s.TOOLBAR.LBL_LINESTYLE_HIDE_SG).removeClass("selected"):e.data("tooltip",s.TOOLBAR.LBL_LINESTYLE_SHOW_SG).addClass("selected"),this.parent.canvas.toggleSgLine(t)},saveStack:function(e){var n;n=this,this.workspace.saveStack().then(function(){return notification("info",sprintf(s.NOTIFY.ERR_SAVE_SUCCESS,n.workspace.opsModel.get("name")))},function(e){var n;return e.error===i.Errors.StackConflict?n=new o({title:s.IDE.TITLE_OPS_CONFLICT,width:"420",disableClose:!0,template:t.modal.confliction(),cancel:{hide:!0},confirm:{color:"blue",text:s.IDE.HEAD_BTN_DONE},onConfirm:function(){return n.close()}}):notification("error",e.msg)})},deleteStack:function(){return this.appAction.deleteStack(this.workspace.opsModel.cid,this.workspace.opsModel.get("name"),this.workspace)},createStack:function(){return App.loadUrl(this.workspace.scene.project.createStack(this.workspace.design.region()).url())},duplicateStack:function(){return App.loadUrl(this.workspace.scene.project.createStackByJson(this.workspace.design.serialize()).url())},zoomIn:function(){return this.parent.canvas.zoomIn(),this.updateZoomButtons()},zoomOut:function(){return this.parent.canvas.zoomOut(),this.updateZoomButtons()},updateZoomButtons:function(){var e;e=this.parent.canvas?this.parent.canvas.scale():1,e<=1?this.$el.find(".icon-zoom-in").attr("disabled","disabled"):this.$el.find(".icon-zoom-in").removeAttr("disabled"),e>=1.6?this.$el.find(".icon-zoom-out").attr("disabled","disabled"):this.$el.find(".icon-zoom-out").removeAttr("disabled")},exportPNG:function(){var e,i,u;i=new o({title:s.IDE.TITLE_EXPORT_PNG,template:t["export"].PNG(),width:"470",disableFooter:!0,compact:!0,onClose:function(){i=null}}),e=this.workspace.design,u=e.get("name"),n.exportPNG(this.parent.getSvgElement(),{isExport:!0,createBlob:!0,name:u,id:e.get("id"),onFinish:function(e){var t;if(!i)return;i.tpl.find(".loading-spinner").remove(),i.tpl.find("section").show().prepend("<img style='max-height:100%;display:inline-block;' src='"+e.image+"' />"),t=i.tpl.find("a.btn-blue").click(function(){return i.close()}),e.blob?t.click(function(){return r.download(e.blob,""+u+".png"),!1}):t.attr({href:e.image,download:""+u+".png"}),i.resize()}})},exportJson:function(){var e,n,i,u,a;i=this.workspace.design,a=App.user.get("username"),n=MC.dateFormat(new Date,"yyyy-MM-dd"),u=[i.get("name"),a,n].join("-"),e=r.exportJson(i.serialize(),""+u+".json");if(e)return new o({title:s.TOOLBAR.EXPORT_AS_JSON,template:t["export"].JSON(e),width:"470",disableFooter:!0,compact:!0})},exportCF:function(){var e,n,u,a,l,h,p;return a=this.workspace.design,l=!1,u=a.serialize({usage:"runStack"}).component,_.each(u,function(e){if(e.type===f.RESTYPE.DBOG)return l=!0}),h=new o({title:s.TOOLBAR.POP_EXPORT_CF,template:t["export"].CF({hasCustomOG:l}),width:"470",disableFooter:!0}),p=a.get("name"),n=c.loadModule("stack"),e=i("stack_export_cloudformation",{region:a.get("region"),stack:a.serialize()}),Q.spread([n,e],function(e,t){var n;h!=null&&h.resize(),n=h.tpl.find("a.btn-blue").text(s.TOOLBAR.POP_BTN_EXPORT_CF).removeClass("disabled"),r.genericExport(n,t,""+p+".json"),n.click(function(){return h.close()})},function(e){h!=null&&h.resize(),h.tpl.find("a.btn-blue").text(s.TOOLBAR.POP_BTN_EXPORT_CF),e.error&&notification("error",sprintf(s.NOTIFY.FAIL_TO_EXPORT_TO_CLOUDFORMATION,e.error))})},reloadState:function(e){var t,n,r;return t=$(e.currentTarget),t.hasClass("disabled")?!1:(t.toggleClass("disabled").html(t.attr("data-disabled")),n=Design.instance().get("id"),r={user:this.workspace.opsModel.project().get("id"),token:this.workspace.opsModel.project().get("defaultToken")},$.ajax({url:window.MC_API_HOST+"/v1/apps/"+n,method:"POST",data:JSON.stringify(r),dataType:"json",statusCode:{200:function(){return notification("info",s.NOTIFY.RELOAD_STATE_SUCCESS),l.trigger(l.REFRESH_PROPERTY)},401:function(){return notification("error",s.NOTIFY.RELOAD_STATE_INVALID_REQUEST)},404:function(){return notification("error",s.NOTIFY.RELOAD_STATE_NETWORKERROR)},429:function(){return notification("error",s.NOTIFY.RELOAD_STATE_NOT_READY)},500:function(){return notification("error",s.NOTIFY.RELOAD_STATE_INTERNAL_SERVER_ERROR)}},error:function(){return void 0},success:function(){return void 0}}).always(function(){return window.setTimeout(function(){return t.removeClass("disabled").html(t.attr("data-original"))})}))},runStack:function(e){var t;return t=this,$(e.currentTarget).attr("disabled")?!1:this.appAction.showPayment(null,this.workspace.opsModel).then(function(e){var n,r;return r=e.result,n=e.modal,t.appAction.runStack(r,n,t.workspace)})},appToStack:function(){var e,n,r,i,u,a;return n=this.workspace.design.attributes.name,r=this.getStackNameFromApp(n),a=this.workspace.opsModel.project().stacks().get(this.workspace.design.attributes.stack_id),i=function(t){return function(){var n,r,i;MC.Analytics.increase("app_to_stack"),n=e.tpl.find("input[name='save-stack-type']:checked").val()!=="replace";if(!n)return r=Design.instance().serializeAsStack(),r.id=t.workspace.design.attributes.stack_id,e.close(),r.name=a.get("name"),a.save(r).then(function(){return notification("info",sprintf(s.NOTIFY.INFO_HDL_SUCCESS,s.TOOLBAR.TOOLBAR_HANDLE_SAVE_STACK,r.name)),App.loadUrl(a.url())},function(){return notification("error",sprintf(s.NOTIFY.ERR_SAVE_FAILED,r.name))});i=t.workspace.opsModel.project().createStackByJson(t.workspace.design.serializeAsStack(e.tpl.find("#modal-input-value").val())),e.close(),App.loadUrl(i.url())}}(this),u=!!a,e=new o({title:s.TOOLBAR.POP_TIT_APP_TO_STACK,template:t.saveAppToStack({input:n,stackName:r,originStackExist:u}),confirm:{text:s.TOOLBAR.POP_BTN_SAVE_TO_STACK},onConfirm:i}),e.tpl.find("input[name='save-stack-type']").change(function(){return e.tpl.find(".radio-instruction").toggleClass("hide")})},getStackNameFromApp:function(e){var t,n,r,i,s,o;e||(e="untitled"),n=0,s=/.*-\d+$/,s.test(e)?(i=e.substr(0,e.lastIndexOf("-")),n=Number(e.substr(e.lastIndexOf("-")+1)),t=i):e.charAt(e.length-1)==="-"?t=e.substr(0,e.length-1):t=e,o=/.-stack+$/,o.test(t)?t=t:t+="-stack",r=this.workspace.opsModel.project().stacks().pluck("name")||[],n++;while(n<=r.length){if($.inArray(t+"-"+n,r)===-1)break;n++}return t+"-"+n},checkAppNameRepeat:function(e){return this.workspace.scene.project.apps().findWhere({name:e})?(this.showError("appname",s.PROP.MSG_WARN_REPEATED_APP_NAME),!0):e?(this.hideError("appname"),!1):(this.showError("appname",s.PROP.MSG_WARN_NO_APP_NAME),!0)},hideDefaultKpError:function(e){return e.hideError("kp")},hideError:function(e){var t;return t=e?$("#runtime-error-"+e):$(".runtime-error"),t.hide()},showError:function(e,t){return $("#runtime-error-"+e).text(t).show()},defaultKpIsSet:function(){var e,t;return u.hasResourceWithDefaultKp()?(t=Design.modelClassForType(f.RESTYPE.KP),e=t.getDefaultKP(),!e.get("isSet")||!this.modal&&!this.updateModal||!(this.modal||this.updateModal).tpl.find("#kp-runtime-placeholder .item.selected").size()?(this.showError("kp",s.IDE.RUN_STACK_MODAL_KP_WARNNING),!1):!0):!0},startApp:function(){return this.appAction.startApp(this.workspace.opsModel.id),!1},stopApp:function(){return this.appAction.stopApp(this.workspace.opsModel.id),!1},terminateApp:function(){return this.appAction.terminateApp(this.workspace.opsModel.id,!0),!1},forgetApp:function(){return this.appAction.forgetApp(this.workspace.opsModel.id),!1},refreshResource:function(){return this.workspace.reloadAppData(),!1},switchToAppEdit:function(){return this.workspace.switchToEditMode(),!1},checkDBinstance:function(e){var t,n;return n=new Q.defer,e.length?(t=h(this.workspace.opsModel.credentialId(),f.RESTYPE.DBINSTANCE,Design.instance().get("region")),t.fetchForce().then(function(){return n.resolve(t)})):n.resolve([]),n.promise},applyAppEdit:function(){var t,n,r,i,u,l,h,p,d,v,m;return v=this,d=!1,l=this.workspace.opsModel.getJsonData(),i=this.workspace.design.serialize({usage:"updateApp"}),r=new a({old:l,"new":i}),p=r.getDiffInfo(),m=l.usage!==i.usage,!p.compChange&&!p.layoutChange&&!p.stateChange&&!m?this.workspace.applyAppEdit():(h=r.removedComps,n=[],void 0,t=i.component,_.each(t,function(e){if(e.type===f.RESTYPE.DBINSTANCE)return n.push(e.resource.DBInstanceIdentifier)}),this.updateModal=new o({title:s.IDE.HEAD_INFO_LOADING,template:MC.template.loadingSpinner,disableClose:!0,cancel:"Close"}),this.updateModal.tpl.find(".modal-footer").hide(),u=[],_.each(l.component,function(e){if(e.type===f.RESTYPE.DBINSTANCE)return u.push(e.resource.DBInstanceIdentifier)}),this.checkDBinstance(u).then(function(t){var o,u,a,l,m,g,y,b,w;g=t.filter(function(e){var t;return(t=e.attributes.DBInstanceIdentifier,__indexOf.call(n,t)>=0)&&e.attributes.DBInstanceStatus!=="available"});if(g.length)return v.updateModal.find(".modal-footer").show().find(".modal-confirm").hide(),v.updateModal.setContent(MC.template.cantUpdateApp({data:g})),v.updateModal.setTitle(s.IDE.UPDATE_APP_MODAL_TITLE),!1;y=[],_.each(h,function(e){var n;if(e.type===f.RESTYPE.DBINSTANCE){n=t.get(e.resource.DBInstanceIdentifier);if(n)return y.push(t.get(e.resource.DBInstanceIdentifier))}}),b=_.filter(y,function(e){return e.attributes.DBInstanceStatus!=="available"}),v.updateModal.tpl.children().css("width","450px").find(".modal-footer").show(),v.updateModal.find(".modal-wrapper-fix").width(665).find(".modal-body").css("padding",0),v.updateModal.setContent(MC.template.updateApp({isRunning:v.workspace.opsModel.testState(e.State.Running),notReadyDB:b,removeList:y})),m=_.filter(h,function(e){return e.type===f.RESTYPE.EIP}),void 0,m.length&&v.updateModal.tpl.find("#release-eips-placeholder").html(MC.template.releaseEipCheck({eipsToRelease:m})),v.updateModal.tpl.find(".modal-header").find("h3").text(s.IDE.UPDATE_APP_MODAL_TITLE),v.updateModal.tpl.find(".modal-confirm").prop("disabled",!0).text(Design.instance().credential()?s.IDE.UPDATE_APP_CONFIRM_BTN:s.IDE.UPDATE_APP_MODAL_NEED_CREDENTIAL),v.updateModal.resize(),a=Design.instance().getCost(),l=Design.instance().getCurrency(),v.updateModal.find("#label-total-fee").find("b").text(""+(l+a.totalFee)),v.updateModal.find("#label-visualops-fee").find("b").text(""+(l+a.visualOpsFee)),window.setTimeout(function(){return v.updateModal.resize()},100),(b!=null?b.length:void 0)&&v.updateModal.tpl.find("#take-rds-snapshot").attr("checked",!1).on("change",function(){return v.updateModal.tpl.find(".modal-confirm").prop("disabled",$(this).is(":checked"))}),u=v.updateModal.find("#app-usage-selectbox.selectbox"),u.on("OPTION_CHANGE",function(e,t,n){return u.parent().find("input.custom-app-usage").toggleClass("show",n.value==="custom")}),(w=i.usage)==="testing"||w==="development"||w==="production"||w==="others"?u.find(".dropdown li.item[data-value='"+i.usage+"']").click():(u.find(".dropdown li.item[data-value='custom']").click(),u.parent().find("input.custom-app-usage").val(i.usage)),v.updateModal.on("confirm",function(){var e,t,n;if(!d)return;return Design.instance().credential()?v.defaultKpIsSet()?(i=v.workspace.design.serialize({usage:"updateApp"}),t=$("#app-usage-selectbox").find(".dropdown .item.selected").data("value"),t==="custom"&&(t=$.trim(u.parent().find("input.custom-app-usage").val())||"custom"),i.usage=t,e=v.updateModal.tpl.find("#release-eip-checkbox").is(":checked"),v.workspace.applyAppEdit(i,!p.compChange,{release_eip:e}),(n=v.updateModal)!=null?n.close():void 0):!1:(Design.instance().project().showCredential(),!1)}),p.compChange&&(o=r.renderAppUpdateView(),$("#app-update-summary-table").html(o)),v.appAction.renderKpDropdown(v.updateModal),c.loadModule("stack").then(function(){return d=!0})["catch"](function(e){var t,n;return void 0,(t=v.updateModal)!=null&&t.tpl.find("#take-rds-snapshot").off("change"),(n=v.updateModal)!=null?n.find(".modal-confirm").addClass("disabled").addClass("tooltip").attr("data-tooltip",s.TOOLBAR.FIX_THE_ERROR_TO_UPDATE):void 0}).fin(function(){var e,t;return(e=v.updateModal)!=null&&e.resize(),(t=v.updateModal)!=null?t.toggleConfirm(!1):void 0})}))},opsOptionChanged:function(){var e,n,r,i,u,a;return e=$(".toolbar-visual-ops-switch").toggleClass("on"),u=e.hasClass("on"),n=this.workspace.design.get("agent"),u?(i=this.workspace.design.instancesNoUserData(),a=this.workspace,i?(n.enabled=!0,this.workspace.design.set("agent",n),l.trigger(l.REFRESH_PROPERTY)):(e.removeClass("on"),r=new o({title:s.IDE.TITLE_CONFIRM_TO_ENABLE_VISUALOPS,width:"420px",template:t.confirm.enableState(),confirm:{text:s.IDE.ENABLE_VISUALOPS},onConfirm:function(){return n.enabled=!0,r.close(),e.addClass("on"),a.design.set("agent",n),l.trigger(l.FORCE_OPEN_PROPERTY)}}),null)):(n.enabled=!1,this.workspace.design.set("agent",n),l.trigger(l.FORCE_OPEN_PROPERTY))},cancelAppEdit:function(){var e,n;return this.workspace.cancelEditMode()||(n=this,e=new o({title:s.IDE.TITLE_CHANGE_NOT_APPLIED,template:t.modal.cancelUpdate(),width:"400",confirm:{text:"Discard",color:"red"},onConfirm:function(){e.close(),n.workspace.cancelEditMode(!0)}})),!1},xxxxxx:function(){return this.setElement(this.parent.$el.find(".OEPanelTop").html(t.toolbar.BtnActionPng()))}})}),define("wspace/awseditor/template/TplLeftPanel",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function l(e,t){return"disabled"}function c(e,t){return'\n  <section class="accordion-group">\n    <header class="fixedaccordion-head">Mesos</header>\n    <div class="accordion-body">\n      <ul class="resource-list-ami"></ul>\n    </div>\n  </section>\n  '}function h(e,t){var r="";return r+='\n  <section class="accordion-group">\n    <header class="fixedaccordion-head ami-header">'+u(n.i18n.call(e,"RES_TIT_AMI",{hash:{},data:t}))+'\n      <nav class="selectbox AmiTypeSelect js-toggle-dropdown">\n        <div class="selection">'+u(n.i18n.call(e,"RES_LBL_QUICK_START_AMI",{hash:{},data:t}))+'</div>\n        <ul class="dropdown">\n          <li class="item selected" data-id="QuickStartAmi">'+u(n.i18n.call(e,"RES_LBL_QUICK_START_AMI",{hash:{},data:t}))+'</li>\n          <li class="item" data-id="MyAmi">'+u(n.i18n.call(e,"RES_LBL_MY_AMI",{hash:{},data:t}))+'</li>\n          <li class="item" data-id="FavoriteAmi">'+u(n.i18n.call(e,"RES_LBL_FAVORITE_AMI",{hash:{},data:t}))+'</li>\n        </ul>\n      </nav>\n    </header>\n    <button class="btn btn-primary BrowseCommunityAmi">'+u(n.i18n.call(e,"RES_BTN_BROWSE_COMMUNITY_AMI",{hash:{},data:t}))+'</button>\n    <div class="accordion-body">\n      <ul class="resource-list-ami"></ul>\n    </div>\n  </section>\n  ',r}function p(e,t){return"disableRds"}function d(e,t){var r="";return r+='<section class="accordion-group">\n    <header class="fixedaccordion-head">'+u(n.i18n.call(e,"RES_TIT_ELB_ASG",{hash:{},data:t}))+'</header>\n    <ul class="resource-list-asg clearfix accordion-body">\n      <li class="tooltip resource-item elb" data-tooltip=\''+u(n.i18n.call(e,"RES_TIP_DRAG_NEW_ELB",{hash:{},data:t}))+'\' data-type="ELB">'+u(n.i18n.call(e,"RES_LBL_NEW_ELB",{hash:{},data:t}))+'</li>\n      <li class="tooltip resource-item asg" data-tooltip=\''+u(n.i18n.call(e,"RES_TIP_DRAG_NEW_ASG",{hash:{},data:t}))+'\' data-type="ASG">'+u(n.i18n.call(e,"RES_LBL_NEW_ASG",{hash:{},data:t}))+"</li>\n    </ul>\n  </section>\n  ",r}function v(e,t){var r="";return r+='<li class="tooltip resource-item vgw" data-tooltip=\''+u(n.i18n.call(e,"RES_TIP_DRAG_NEW_VGW",{hash:{},data:t}))+'\' data-type="VGW">'+u(n.i18n.call(e,"RES_LBL_NEW_VGW",{hash:{},data:t}))+"</li>",r}function m(e,t){var r="";return r+='<li class="tooltip resource-item cgw" data-tooltip=\''+u(n.i18n.call(e,"RES_TIP_DRAG_NEW_CGW",{hash:{},data:t}))+'\' data-type="CGW">'+u(n.i18n.call(e,"RES_LBL_NEW_CGW",{hash:{},data:t}))+"</li>",r}function g(e,t){var r="";return r+='\n          <li class="tooltip resource-item eni" data-tooltip=\''+u(n.i18n.call(e,"RES_TIP_DRAG_NEW_ENI",{hash:{},data:t}))+'\' data-type="ENI">'+u(n.i18n.call(e,"RES_LBL_NEW_ENI",{hash:{},data:t}))+"</li>\n      ",r}function y(e,t){var r="";return r+='\n          <li class="tooltip resource-item elb" data-tooltip=\''+u(n.i18n.call(e,"RES_TIP_DRAG_NEW_ELB",{hash:{},data:t}))+'\' data-type="ELB">'+u(n.i18n.call(e,"RES_LBL_NEW_ELB",{hash:{},data:t}))+"</li>\n      ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression,a=this,f="function";s+='<button class="tooltip sidebar-hider icon-caret-left HideOEPanelLeft" data-tooltip=\''+u(n.i18n.call(t,"RES_TIP_TOGGLE_RESOURCE_PANEL",{hash:{},data:i}))+'\'></button>\n\n<nav class="sidebar-title clearfix">\n    <button class="sidebar-nav-resource">'+u(n.i18n.call(t,"RES_TIT_RESOURCES",{hash:{},data:i}))+'</button>\n    <button class="sidebar-nav-container">Container</button>\n</nav>\n\n<div class="resource-panel">\n  <div class="sidebar-tool">\n    <button class="refresh-resource-panel"><i class="icon-refresh tooltip" data-tooltip="'+u(n.i18n.call(t,"RES_TIP_REFRESH_RESOURCE_LIST",{hash:{},data:i}))+'"></i>Refresh</button>\n    <button class="js-toggle-dropdown menu-manage-shard-res tooltip" data-tooltip="'+u(n.i18n.call(t,"RES_TIP_SHARED_RESOURCES",{hash:{},data:i}))+'">\n        <i class="icon-resources">Manage...</i>\n        <ul class="dropdown-menu resources-dropdown-wrapper">\n          <li data-action="keypair" class="icon-kp"><span>'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_KEY_PAIR",{hash:{},data:i}))+'</span></li>\n          <li data-action="snapshot" class="icon-ebs-snap"><span>'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_EBS_SNAPSHOT",{hash:{},data:i}))+'</span></li>\n          <li data-action="sns" class="icon-sns"><span>'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_SNS_SUBSCRIPTION",{hash:{},data:i}))+'</span></li>\n          <li data-action="sslcert" class="icon-cert"><span>'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_SERVER_CERTIFICATE",{hash:{},data:i}))+'</span></li>\n          <li data-action="dhcp" class="icon-dhcp"><span>'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_DHCP_OPTION_SETS",{hash:{},data:i}))+'</span></li>\n          <li data-action="rdspg" class="icon-pg ',o=n["if"].call(t,t&&t.rdsDisabled,{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='"><span>'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_DB_PARAMETER_GROUPS",{hash:{},data:i}))+'</span></li>\n          <li data-action="rdssnapshot" class="icon-rds-snap ',o=n["if"].call(t,t&&t.rdsDisabled,{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i});if(o||o===0)s+=o;s+='"><span>'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_DB_SNAPSHOT",{hash:{},data:i}))+'</span></li>\n          <li data-action="eip" class="icon-eip"><span>'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_EIP",{hash:{},data:i}))+'</span></li>\n        </ul>\n    </button>\n  </div>\n  <div class="fixedaccordion">\n\n  ',o=n["if"].call(t,t&&t.isMesos,{hash:{},inverse:a.noop,fn:a.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n\n  <section class="accordion-group">\n    <header class="fixedaccordion-head">'+u(n.i18n.call(t,"RES_TIT_AZ",{hash:{},data:i}))+'</header>\n    <ul class="resource-list-az clearfix accordion-body">\n      <li class="tooltip resource-item az" data-tooltip=\''+u(n.i18n.call(t,"RES_TIP_DRAG_AZ",{hash:{},data:i}))+'\' data-type="AZ">\n        <div class="resource-count">'+u((o=t&&t.count,typeof o===f?o.apply(t):o))+'</div>\n        <div class="res-name">'+u(n.i18n.call(t,"PROP.AZ_AND_SUBNET",{hash:{},data:i}))+'</div>\n      </li>\n      <li class="tooltip resource-item subnet" data-tooltip=\''+u(n.i18n.call(t,"RES_TIP_DRAG_NEW_SUBNET",{hash:{},data:i}))+'\' data-type="SUBNET">'+u(n.i18n.call(t,"RES_LBL_NEW_SUBNET",{hash:{},data:i}))+'</li>\n      <li class="tooltip resource-item subnetgroup" data-type="DBSBG">'+u(n.i18n.call(t,"RES_LBL_NEW_SUBNET_GROUP",{hash:{},data:i}))+"</li>\n    </ul>\n  </section>\n\n  ",o=n.unless.call(t,t&&t.isMesos,{hash:{},inverse:a.noop,fn:a.program(5,h,i),data:i});if(o||o===0)s+=o;s+='\n\n\n  <section class="accordion-group">\n    <header class="fixedaccordion-head">'+u(n.i18n.call(t,"RES_TIT_VOL",{hash:{},data:i}))+'</header>\n    <button class="btn btn-primary ManageSnapshot ManageEbsSnapshot">'+u(n.i18n.call(t,"RES_TIT_SNAPSHOT_MANAGE",{hash:{},data:i}))+'</button>\n    <div class="accordion-body">\n      <div class="resource-list-head">'+u(n.i18n.call(t,"RES_LBL_NEW_BLANK_VOL",{hash:{},data:i}))+'</div>\n      <ul class="clearfix"><li class="tooltip resource-item volume" data-tooltip=\''+u(n.i18n.call(t,"RES_TIP_DRAG_NEW_VOLUME",{hash:{},data:i}))+'\' data-type="VOL">'+u(n.i18n.call(t,"RES_LBL_NEW_VOL",{hash:{},data:i}))+'</li></ul>\n      <div class="resource-list-head">\n        '+u(n.i18n.call(t,"RES_LBL_NEW_VOL_FROM_SNAPSHOT",{hash:{},data:i}))+'\n        <div class="selectbox resource-list-sort-select dark" id="resource-list-sort-select-snapshot">\n          <div class="selection">'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_SORT_BY_DATE",{hash:{},data:i}))+'</div>\n          <ul class="dropdown">\n            <li class="item selected focused" data-id="date">'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_SORT_BY_DATE",{hash:{},data:i}))+'</li>\n            <li class="item" data-id="storge">'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_SORT_BY_STORAGE",{hash:{},data:i}))+'</li>\n          </ul>\n        </div>\n      </div>\n      <ul class="resource-list-snapshot"></ul>\n    </div>\n  </section>\n\n  <section class="accordion-group">\n    <header class="fixedaccordion-head">'+u(n.i18n.call(t,"RES_TIT_RDS",{hash:{},data:i}))+'</header>\n    <button class="btn btn-primary ManageSnapshot ManageRdsSnapshot">'+u(n.i18n.call(t,"RES_TIT_RDS_SNAPSHOT_MANAGE",{hash:{},data:i}))+'</button>\n    <div class="accordion-body ',o=n["if"].call(t,t&&t.rdsDisabled,{hash:{},inverse:a.noop,fn:a.program(7,p,i),data:i});if(o||o===0)s+=o;s+='">\n      <div class="disableRds-content">'+u(n.i18n.call(t,"RES_MSG_RDS_DISABLED",{hash:{},data:i}))+'</div>\n\n      <div>\n        <div class="resource-list-head">'+u(n.i18n.call(t,"RES_LBL_NEW_RDS_INSTANCE",{hash:{},data:i}))+'</div>\n        <ul class="resource-list-rds"></ul>\n        <div class="resource-list-head">\n          '+u(n.i18n.call(t,"RES_LBL_NEW_RDS_INSTANCE_FROM_SNAPSHOT",{hash:{},data:i}))+'\n          <div class="selectbox resource-list-sort-select dark" id="resource-list-sort-select-rds-snapshot">\n            <div class="selection">'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_SORT_BY_DATE",{hash:{},data:i}))+'</div>\n            <ul class="dropdown">\n              <li class="item selected focused" data-id="date">'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_SORT_BY_DATE",{hash:{},data:i}))+'</li>\n              <li class="item" data-id="engine">'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_SORT_BY_ENGINE",{hash:{},data:i}))+'</li>\n              <li class="item" data-id="storge">'+u(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_SORT_BY_STORAGE",{hash:{},data:i}))+'</li>\n            </ul>\n          </div>\n        </div>\n        <ul class="resource-list-rds-snapshot"></ul>\n      </div>\n    </div>\n  </section>\n\n  ',o=n.unless.call(t,t&&t.isMesos,{hash:{},inverse:a.noop,fn:a.program(9,d,i),data:i});if(o||o===0)s+=o;s+="\n\n  <section class='accordion-group'>\n    <header class=\"fixedaccordion-head\">"+u(n.i18n.call(t,"RES_TIT_VPC",{hash:{},data:i}))+'</header>\n    <ul class="accordion-body">\n      <li class="tooltip resource-item rtb" data-tooltip=\''+u(n.i18n.call(t,"RES_TIP_DRAG_NEW_RTB",{hash:{},data:i}))+'\' data-type="RT">'+u(n.i18n.call(t,"RES_LBL_NEW_RTB",{hash:{},data:i}))+'</li>\n\n      <li class="tooltip resource-item igw" data-tooltip=\''+u(n.i18n.call(t,"RES_TIP_DRAG_NEW_IGW",{hash:{},data:i}))+'\' data-type="IGW">'+u(n.i18n.call(t,"RES_LBL_NEW_IGW",{hash:{},data:i}))+"</li>\n\n      ",o=n["if"].call(t,t&&t.hasVGW,{hash:{},inverse:a.noop,fn:a.program(11,v,i),data:i});if(o||o===0)s+=o;s+="\n\n      ",o=n["if"].call(t,t&&t.hasCGW,{hash:{},inverse:a.noop,fn:a.program(13,m,i),data:i});if(o||o===0)s+=o;s+="\n\n      ",o=n.unless.call(t,t&&t.isMesos,{hash:{},inverse:a.program(17,y,i),fn:a.program(15,g,i),data:i});if(o||o===0)s+=o;return s+='\n\n    </ul>\n  </section>\n</div>\n</div>\n\n\n<div class="panel container-panel hide">\n    <div class="marathon-app-ready">\n        <div class="loading-bounce"><div class="bounce-one"></div><div class="bounce-two"></div></div>\n        <div class="desc">Trying to load marathon apps list...</div>\n        <div class="desc">App list will be available once marathon framework and the apps are ready on the Mesos cluster.</div>\n    </div>\n    <div class="marathon-app-list" class="hide"></div>\n</div>',s},n.panel=e.template(t),t=function(e,t,n,r,i){function f(e,t,r){var i;return i=n["with"].call(e,e&&e.attributes,{hash:{},inverse:a.noop,fn:a.programWithDepth(2,l,t,r),data:t}),i||i===0?i:""}function l(e,t,r){var i="",s;i+='\n<li class="resource-item bubble snapshot" data-date="'+u((s=e&&e.startTime,typeof s===o?s.apply(e):s))+'" data-storge="'+u((s=e&&e.volumeSize,typeof s===o?s.apply(e):s))+'" data-bubble-template="resPanelSnapshot" data-bubble-data=\'{"id":"'+u((s=e&&e.id,typeof s===o?s.apply(e):s))+'", "region":"'+u((s=r&&r.region,typeof s===o?s.apply(e):s))+'"}\' data-type="VOL" data-option=\'{"volumeSize":'+u((s=e&&e.volumeSize,typeof s===o?s.apply(e):s))+', "snapshotId": "'+u((s=e&&e.id,typeof s===o?s.apply(e):s))+'", "encrypted": "',s=n["if"].call(e,e&&e.encrypted,{hash:{},inverse:a.program(5,h,t),fn:a.program(3,c,t),data:t});if(s||s===0)i+=s;return i+='"}\'>\n  <div class="ebs-size">'+u((s=e&&e.volumeSize,typeof s===o?s.apply(e):s))+" GB</div>"+u((s=e&&e.id,typeof s===o?s.apply(e):s))+"\n</li>",i}function c(e,t){return"true"}function h(e,t){return"false"}function p(e,t){var r="";return r+='\n<div style="padding-bottom:15px;">'+u(n.i18n.call(e,"TOOLBAR.CLOUD_RESOURCE_NO_EBS_SNAPSHOT",e&&e.region,{hash:{},data:t}))+"</div>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t,{hash:{},inverse:a.program(7,p,i),fn:a.programWithDepth(1,f,i,t),data:i}),s||s===0?s:""},n.snapshot=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;i=n["with"].call(e,(i=e&&e[0],i==null||i===!1?i:i.attributes),{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function l(e,t){var r="",i;return r+='\n<li class="resource-item dbinstance tooltip" data-tooltip="'+u((i=t==null||t===!1?t:t.key,typeof i===o?i.apply(e):i))+'" data-type="DBINSTANCE" data-option=\'{"engine":"'+u((i=e&&e.Engine,typeof i===o?i.apply(e):i))+'"}\'>\n<div class="resource-icon-dbinstance"><img src="/assets/images/ide/icon/rds-'+u(n.firstOfSplit.call(e,e&&e.Engine,"-",{hash:{},data:t}))+'.png" width="42" height="30"></div>\n'+u((i=t==null||t===!1?t:t.key,typeof i===o?i.apply(e):i))+"\n</li>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.rds=e.template(t),t=function(e,t,n,r,i){function f(e,t,r){var i="",s;return i+='\n<li class="resource-item dbsnapshot bubble" data-date="'+u((s=e&&e.SnapshotCreateTime,typeof s===o?s.apply(e):s))+'" data-engine="'+u((s=e&&e.EngineVersion,typeof s===o?s.apply(e):s))+'" data-storge="'+u((s=e&&e.AllocatedStorage,typeof s===o?s.apply(e):s))+'" data-type="DBINSTANCE" data-option=\'{"engine":"'+u((s=e&&e.Engine,typeof s===o?s.apply(e):s))+'", "snapshotId": "'+u((s=e&&e.DBSnapshotIdentifier,typeof s===o?s.apply(e):s))+'","allocatedStorage": "'+u((s=e&&e.AllocatedStorage,typeof s===o?s.apply(e):s))+'" }\' data-bubble-template="resPanelDbSnapshot" data-bubble-data=\'{"id":"'+u((s=e&&e.DBSnapshotIdentifier,typeof s===o?s.apply(e):s))+'","region":"'+u((s=r&&r.region,typeof s===o?s.apply(e):s))+'"}\'>\n  <div class="resource-icon-dbsnapshot"><img src="/assets/images/ide/icon/rds-'+u(n.firstOfSplit.call(e,e&&e.Engine,"-",{hash:{},data:t}))+'.png" width="32" height="23">\n  <div class="rds-snapshot-size">'+u((s=e&&e.AllocatedStorage,typeof s===o?s.apply(e):s))+" GB</div></div>"+u((s=e&&e.DBInstanceIdentifier,typeof s===o?s.apply(e):s))+"\n</li>\n",i}function l(e,t){var r="";return r+='\n<div style="padding-bottom:15px;">'+u(n.i18n.call(e,"TOOLBAR.CLOUD_RESOURCE_NO_DB_SNAPSHOT",e&&e.region,{hash:{},data:t}))+"</div>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n.each.call(t,t,{hash:{},inverse:a.program(3,l,i),fn:a.programWithDepth(1,f,i,t),data:i}),s||s===0?s:""},n.rds_snapshot=e.template(t),t=function(e,t,n,r,i){function f(e,t,r){var i="",s;s=n["with"].call(e,e&&e.attributes,{hash:{},inverse:a.noop,fn:a.programWithDepth(2,l,t,r),data:t});if(s||s===0)i+=s;return i+="\n",i}function l(e,t,r){var i="",s;i+='\n<li class="bubble resource-item instance" data-bubble-template="resPanelAmiInfo" data-bubble-data=\'{"region":"'+o((s=r&&r.region,typeof s===u?s.apply(e):s))+'","imageId":"'+o((s=e&&e.id,typeof s===u?s.apply(e):s))+'"}\' data-type="INSTANCE" data-option=\'{"imageId":"'+o((s=e&&e.id,typeof s===u?s.apply(e):s))+"\"}'>\n  ",s=n["if"].call(e,r&&r.fav,{hash:{},inverse:a.noop,fn:a.program(3,c,t),data:t});if(s||s===0)i+=s;return i+='\n  <div class="resource-icon-instance"><img src="/assets/images/ide/ami/'+o((s=e&&e.osType,typeof s===u?s.apply(e):s))+"."+o((s=e&&e.architecture,typeof s===u?s.apply(e):s))+"."+o((s=e&&e.rootDeviceType,typeof s===u?s.apply(e):s))+".png\" width='39' height='27' /></div>\n  "+o((s=e&&e.name,typeof s===u?s.apply(e):s))+"\n</li>",i}function c(e,t){var r="",i;return r+='<button class="btn-fav-ami fav tooltip" data-tooltip="'+o(n.i18n.call(e,"RES_TIT_TOGGLE_FAVORITE",{hash:{},data:t}))+'" data-id="'+o((i=e&&e.id,typeof i===u?i.apply(e):i))+'"></button>',r}function h(e,t){var r;return r=n["if"].call(e,e&&e.fav,{hash:{},inverse:a.noop,fn:a.program(6,p,t),data:t}),r||r===0?r:""}function p(e,t){var r="";return r+='<p class="blank-slate">'+o(n.i18n.call(e,"TOOLBAR.CLOUD_RESOURCE_BROWSE_COMMUNITY_AMI",{hash:{},data:t}))+"</p>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u="function",a=this;return s=n.each.call(t,t,{hash:{},inverse:a.program(5,h,i),fn:a.programWithDepth(1,f,i,t),data:i}),s||s===0?s:""},n.ami=e.template(t),t=function(e,t,n,r,i,s,o){function h(e,t,n){var r="",i;return r+='\n<li class="resource-item instance mesos" data-bubble-template="resPanelAmiInfo" data-bubble-data=\'{"region":"'+l((i=n&&n.region,typeof i===f?i.apply(e):i))+'","imageId":"'+l((i=e&&e.imageId,typeof i===f?i.apply(e):i))+'"}\' data-type="INSTANCE" data-option=\'{"imageId":"'+l((i=e&&e.imageId,typeof i===f?i.apply(e):i))+'", "subType": "MESOSMASTER"}\'>\n  <div class="resource-icon-instance">\n    <img src="/assets/images/ide/ami/mesos-master.png" width=\'39\' height=\'27\' />\n  </div>\n  Master\n</li>\n',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var u="",a,f="function",l=this.escapeExpression,c=this;a=n.unless.call(t,t&&t.isAppEdit,{hash:{},inverse:c.noop,fn:c.programWithDepth(1,h,i,s),data:i});if(a||a===0)u+=a;return u+='\n<li class="resource-item instance mesos" data-bubble-template="resPanelAmiInfo" data-bubble-data=\'{"region":"'+l((a=o&&o.region,typeof a===f?a.apply(t):a))+'","imageId":"'+l((a=t&&t.imageId,typeof a===f?a.apply(t):a))+'"\' data-type="INSTANCE" data-option=\'{"imageId":"'+l((a=t&&t.imageId,typeof a===f?a.apply(t):a))+'", "subType": "MESOSSLAVE"}\'>\n  <div class="resource-icon-instance">\n    <img src="/assets/images/ide/ami/mesos-slave.png" width=\'39\' height=\'27\' />\n  </div>\n  Slave\n</li>\n<li class="resource-item asg" data-type="ASG" data-option=\'{"lcId": "MESOS.LC"}\'>\n  <div class="resource-icon-instance"><img src="/assets/images/ide/ami/mesos-slave.png" /></div>\nSlave Auto Scaling Group\n</li>',u},n.mesos=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="resource-icon-instance" >\n  <img src="/assets/images/ide/ami/'+a((o=(o=t&&t.cachedAmi,o==null||o===!1?o:o.osType),typeof o===u?o.apply(t):o))+"."+a((o=(o=t&&t.cachedAmi,o==null||o===!1?o:o.architecture),typeof o===u?o.apply(t):o))+"."+a((o=(o=t&&t.cachedAmi,o==null||o===!1?o:o.rootDeviceType),typeof o===u?o.apply(t):o))+'.png"/>\n</div>'+a(n.i18n.call(t,"TOOLBAR.CLOUD_RESOURCE_AUTO_SCALING_GROUP",{hash:{},data:i}))+" ("+a((o=t&&t.name,typeof o===u?o.apply(t):o))+")",s},n.reuse_lc=e.template(t),t=function(e,t,n,r,i){function l(e,t){var n="",r;return n+="<dt>"+a((r=t==null||t===!1?t:t.key,typeof r===u?r.apply(e):r))+"</dt><dd>"+a(typeof e===u?e.apply(e):e)+"</dd>",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="bubble-head">'+a(n.or.call(t,t&&t.id,t&&t.ID,{hash:{},data:i}))+'</div>\n<dl class="bubble-content dl-horizontal">',o=n.each.call(t,t,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="</dl>",s},n.resourcePanelBubble=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n  <li class="container-item tooltip" data-tooltip="Click to view app placement on canvas" data-hosts="'+a((i=e&&e.hosts,typeof i===u?i.apply(e):i))+'" data-name="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'">\n      <div class="task tooltip">'+a((i=e&&e.task,typeof i===u?i.apply(e):i))+"/"+a((i=e&&e.instance,typeof i===u?i.apply(e):i))+'</div>\n      <div class="info">\n          <img class="container-icon" src="/assets/images/ide/icon-mrth/icn-'+a((i=e&&e.image,typeof i===u?i.apply(e):i))+'.png" width="32" ',i=n["if"].call(e,e&&e.image,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;r+=' />\n          <span class="name tooltip" data-tooltip="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'">'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'</span>\n      </div>\n      <img class="container-info-icon" src="/assets/images/ide/icon-mrth/cvs-appicon.png" width="120" height="32" />\n      <span class="container-info">\n          <span class="tooltip" data-tooltip="CPU">'+a((i=e&&e.cpu,typeof i===u?i.apply(e):i))+'</span>\n          <span class="tooltip" data-tooltip="Memory">'+a((i=e&&e.memory,typeof i===u?i.apply(e):i))+"</span>\n      </span>\n  </li>\n  ",i=n["if"].call(e,e&&e.constraints,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+="\n  ",r}function c(e,t){return'height="32"'}function h(e,t){var r="",i;r+='\n  <li class="constraint-list hide">\n    <header>'+a((i=e&&e.title,typeof i===u?i.apply(e):i))+'</header>\n    <section class="constraint-info">\n      ',i=n.each.call(e,e&&e.constraints,{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;return r+="\n  </section>\n  </li>\n  ",r}function p(e,t){var r="",i;r+="\n      ",i=n.ifCond.call(e,t==null||t===!1?t:t.index,0,{hash:{},inverse:f.noop,fn:f.program(6,d,t),data:t});if(i||i===0)r+=i;r+="\n      ",i=n.ifCond.call(e,t==null||t===!1?t:t.index,1,{hash:{},inverse:f.noop,fn:f.program(8,v,t),data:t});if(i||i===0)r+=i;r+="\n      ",i=n.ifCond.call(e,t==null||t===!1?t:t.index,2,{hash:{},inverse:f.noop,fn:f.program(10,m,t),data:t});if(i||i===0)r+=i;return r+="\n      ",r}function d(e,t){var n="";return n+='<p class="attribute">'+a(typeof e===u?e.apply(e):e)+"</p>",n}function v(e,t){var n="";return n+='<p class="operator">'+a(typeof e===u?e.apply(e):e)+"</p>",n}function m(e,t){var n="";return n+='<p class="value">'+a(typeof e===u?e.apply(e):e)+"</p>",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<input id="filter-containers" class="input filter-containers" type="text" placeholder="Filter app..."/>\n<ul class="container-list">\n  ',o=n.each.call(t,t,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+='\n</ul>\n<!-- <div class="container-change">Change Marathon Stack…</div> -->',s},n.containerList=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<img class="logo" src="/assets/images/ide/marathon.png">\n<div class="desc">Marathon framework is ready, but there\'s no app deployed on Mesos cluster.</div>'},n.emptyContainer=e.template(t),t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<img class="logo" src="/assets/images/ide/marathon.png">\n<div class="desc">Marathon framework is not ready yet.</div>\n<div class="desc">App list will be available once marathon framework and the apps are ready on the Mesos cluster.</div>'},n.mesosNotReady=e.template(t),n}),define("wspace/awseditor/template/TplAmiBrowser",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this.escapeExpression;s+='<div class="ami-content-wrap" style="position:relative;">\n  <div id="ami-search-option">\n    <input id="community-ami-input" class="input" type="text" placeholder="',o=n.i18n.call(t,"AMI_LBL_ALL_SEARCH_AMI_BY_NAME_OR_ID",{hash:{},data:i});if(o||o===0)s+=o;return s+='" />\n\n    <div id="selectbox-ami-platform" class="selectbox">\n      <div class="selection">'+u(n.i18n.call(t,"AMI_LBL_ALL_PLATFORMS",{hash:{},data:i}))+'</div>\n      <ul class="dropdown" tabindex="-1">\n        <li class="item selected" data-id="">'+u(n.i18n.call(t,"AMI_LBL_ALL_PLATFORMS",{hash:{},data:i}))+'</li>\n        <li class="item" data-id="amazonlinux"> <span class="icon-ami-os amz-linux">Amazon Linux</span> </li>\n        <li class="item" data-id="centos"> <span class="icon-ami-os centos">Cent OS</span> </li>\n        <li class="item" data-id="debian"> <span class="icon-ami-os debian">Debian</span> </li>\n        <li class="item" data-id="fedora"> <span class="icon-ami-os fedora">Fedora</span> </li>\n        <li class="item" data-id="gentoo"> <span class="icon-ami-os gentoo">Gentoo</span> </li>\n        <li class="item" data-id="opensuse"><span class="icon-ami-os opensuse">OpenSUSE</span> </li>\n        <li class="item" data-id="ubuntu"> <span class="icon-ami-os ubuntu">Ubuntu</span> </li>\n        <li class="item" data-id="redhat"> <span class="icon-ami-os redhat">Red Hat</span> </li>\n        <li class="item" data-id="windows"><span class="icon-ami-os windows">Windows</span> </li>\n        <li class="item" data-id="otherlinux"> <span class="icon-ami-os linux-other">Other Linux</span> </li>\n      </ul>\n    </div>\n\n    <div class="ami-option-group">\n      <h5>'+u(n.i18n.call(t,"AMI_LBL_VISIBILITY",{hash:{},data:i}))+'</h5>\n      <div class="ami-option-wrap" id="filter-ami-type">\n        <button type="button" class="btn active" data-value="true">'+u(n.i18n.call(t,"AMI_LBL_PUBLIC",{hash:{},data:i}))+'</button>\n        <button type="button" class="btn" data-value="false">'+u(n.i18n.call(t,"AMI_LBL_PRIVATE",{hash:{},data:i}))+'</button>\n      </div>\n    </div>\n\n    <div class="ami-option-group">\n      <h5>'+u(n.i18n.call(t,"AMI_LBL_ARCHITECTURE",{hash:{},data:i}))+'</h5>\n      <div class="ami-option-wrap" id="filter-ami-32bit-64bit">\n        <button type="button" class="btn active" data-value="32-bit">'+u(n.i18n.call(t,"AMI_LBL_32_BIT",{hash:{},data:i}))+'</button>\n        <button type="button" class="btn" data-value="64-bit">'+u(n.i18n.call(t,"AMI_LBL_64_BIT",{hash:{},data:i}))+'</button>\n      </div>\n    </div>\n\n    <div class="ami-option-group">\n      <h5>'+u(n.i18n.call(t,"AMI_LBL_ROOT_DEVICE_TYPE",{hash:{},data:i}))+'</h5>\n      <div class="ami-option-wrap" id="filter-ami-EBS-Instance">\n        <button type="button" class="btn active" data-value="EBS">'+u(n.i18n.call(t,"AMI_LBL_EBS",{hash:{},data:i}))+'</button>\n        <button type="button" class="btn" data-value="Instance Store">'+u(n.i18n.call(t,"AMI_LBL_INSTANCE_STORE",{hash:{},data:i}))+'</button>\n      </div>\n    </div>\n\n    <div id="btn-search-ami" class="btn btn-blue" disabled>'+u(n.i18n.call(t,"AMI_LBL_SEARCHING",{hash:{},data:i}))+'</div>\n  </div>\n\n  <div id="ami-data-wrap">\n    <div id="ami-table-wrap" class="table-head-fix">\n      <table class="table-head">\n        <thead>\n        <tr>\n          <th style="width: 44px;"></th>\n          <th style="width: 104px;">'+u(n.i18n.call(t,"AMI_LBL_AMI_ID",{hash:{},data:i}))+"</th>\n          <th>"+u(n.i18n.call(t,"AMI_LBL_AMI_NAME",{hash:{},data:i}))+'</th>\n          <th style="width: 62px;padding-left:4px;text-align:left;" class="sortable">'+u(n.i18n.call(t,"AMI_LBL_SIZE",{hash:{},data:i}))+'</th>\n        </tr>\n        </thead>\n      </table>\n      <div class="scroll-wrap">\n        <div class="scrollbar-veritical-wrap" style="display: block;"><div class="scrollbar-veritical-thumb"></div></div>\n        <div class="show-loading">\n          <div class="loading-spinner"></div>\n        </div>\n        <div class="scroll-content" style="display:block;">\n          <table class="table">\n            <thead>\n            <tr>\n              <th style="width: 16px;"><div class="th-inner"></div></th>\n              <th style="width: 80px;"><div class="th-inner"></div></th>\n              <th><div class="th-inner"></div></th>\n              <th style="width: 42px;"><div class="th-inner"></div></th>\n            </tr>\n            </thead>\n            <tbody id="community_ami_table"></tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n\n    <div id="community-ami-page">\n      <div class="page-tip" style="display: none;"></div>\n      <div class="pagination" style="display: none;">\n        <a href="#" class="previous" data-action="previous">&lsaquo;</a>\n        <input type="text" readonly="readonly" data-max-page="40" />\n        <a href="#" class="next" data-action="next">&rsaquo;</a>\n      </div>\n    </div>\n  </div>\n</div>',s},n.dialog=e.template(t),t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='<tr class="item" data-id="'+o((i=t==null||t===!1?t:t.key,typeof i===u?i.apply(e):i))+'">\n  <td><div class="toggle-fav ',i=n["if"].call(e,e&&e.faved,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;r+=' tooltip" data-tooltip="'+o(n.i18n.call(e,"RES_TIT_TOGGLE_FAVORITE",{hash:{},data:t}))+'"></div></td>\n  <td>'+o((i=t==null||t===!1?t:t.key,typeof i===u?i.apply(e):i))+'</td>\n  <td>\n    <span class="ami-table-name">'+o((i=e&&e.name,typeof i===u?i.apply(e):i))+'</span>\n    <div class="ami-meta '+o((i=e&&e.osType,typeof i===u?i.apply(e):i))+' icon-ami-os"> ',i=n.ifCond.call(e,e&&e.isPublic,"true",{hash:{},inverse:a.program(6,h,t),fn:a.program(4,c,t),data:t});if(i||i===0)r+=i;return r+=" | "+o((i=e&&e.architecture,typeof i===u?i.apply(e):i))+" | "+o((i=e&&e.rootDeviceType,typeof i===u?i.apply(e):i))+"</div>\n  </td>\n  <td>"+o((i=e&&e.imageSize,typeof i===u?i.apply(e):i))+"</td>\n</tr>\n",r}function l(e,t){return"fav"}function c(e,t){return o(n.i18n.call(e,"AMI_TYPE_PUBLIC",{hash:{},data:t}))}function h(e,t){return o(n.i18n.call(e,"AMI_TYPE_PRIVATE",{hash:{},data:t}))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this.escapeExpression,u="function",a=this;return s=n.each.call(t,t,{hash:{},inverse:a.noop,fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.amiItem=e.template(t),n});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/subviews/AmiBrowser",["../template/TplAmiBrowser","i18n!/nls/lang.js","UI.modalplus","ApiRequest","CloudResources","backbone","jqpagination"],function(e,t,n,r,i){return Backbone.View.extend({events:{"click .ami-option-group .ami-option-wrap .btn":"clickOptionBtn","keypress #community-ami-input":"search","click    #btn-search-ami":"search","click    .toggle-fav":"toggleFav"},initialize:function(r){var i,s;$.extend(this,r),i=new n({title:t.IDE.AMI_LBL_COMMUNITY_AMIS,width:"855px",template:e.dialog(),disableFooter:!0,compact:!0}),s=this,i.on("close",function(){s.onClose&&s.onClose()}),this.setElement(i.tpl),this.doSearch()},clickOptionBtn:function(e){var t;if($(e.target).hasClass("active")){t=$(e.target).parent().find(".active");if(t.length===1&&t[0]===e.target)return;$(e.target).removeClass("active")}else $(e.target).addClass("active");return null},toggleFav:function(e){var n,r,s,o,u,a,f;return r=$(e.target),f=this,o=i(this.credential,"FavoriteAmi",this.region),a=null,u=r.closest("tr").attr("data-id"),n=r.hasClass("fav"),n?a=o.unfav(u):(s=$.extend({id:u},this.communityAmiData[u]),a=o.fav(s)),a.then(function(){var e;return r.toggleClass("fav"),e=n?t.IDE.AMI_IS_REMOVED_FROM_FAVOURITE_AMI:t.IDE.AMI_IS_ADDED_TO_FAVOURITE_AMI,notification("info",sprintf(e,u))})},doSearch:function(e,n){var s,o,u,a,f,l,c,h,p,d,v,m;return e=e||1,this.renderAmiLoading(),l=$("#community-ami-input").val(),h=$("#selectbox-ami-platform").find(".selected").data("id"),f=null,a=null,v=null,s=$("#filter-ami-type").find(".active"),s.length===1&&(f=s.attr("data-value")),s=$("#filter-ami-32bit-64bit").find(".active"),s.length===1&&(a=s.attr("data-value")),s=$("#filter-ami-EBS-Instance").find(".active"),s.length===1&&(v=s.attr("data-value")),c=parseInt(n||50,10),d=parseInt(e,10),m=this,p=/ami-[a-zA-Z0-9]{8}$/,o=l.trim(),o&&p.test(o)?(u=i(this.credential,"AWS.EC2.AMI",m.region),u.fetchAmis([o]).then(function(){var e,t,n;return e=u.where({id:o}),t={ami:{curPageNum:1,result:{},totalNum:0,totalPageNum:1}},e.length>0&&(t.ami.result[o]=e[0].toJSON(),t.ami.totalNum=1),t=m.addFavStar(t),m.communityAmiData=((n=t.ami)!=null?n.result:void 0)||{},m.communityAmiRender(t)})):r("aws_public",{region_name:this.region,filters:{ami:{name:l,platform:h,isPublic:f,architecture:a,rootDeviceType:v,perPageNum:c,returnPage:d}}}).then(function(e){var t;return e=m.addFavStar(e),m.communityAmiData=((t=e.ami)!=null?t.result:void 0)||{},m.communityAmiRender(e)},function(e){return notification("error",t.NOTIFY.UNABLE_TO_LOAD_COMMUNITY_AMIS),m.communityAmiRender({ami:[]})})},searchPrev:function(){var e;return e=parseInt($("#community_ami_page_current").attr("page"),10),this.doSearch(e+1)},searchNext:function(){var e;return e=parseInt($("#community_ami_page_current").attr("page"),10),this.doSearch(e-1)},search:function(e){if(e.keyCode&&e.keyCode!==13)return;return this.doSearch()},addFavStar:function(e){var t,n,r;return n=i(this.credential,"FavoriteAmi",this.region).getModels()||[],t=_.clone(e.ami.result),r=_.pluck(_.pluck(n,"attributes"),"id"),_.each(t,function(e,t){__indexOf.call(r,t)>=0&&(e.faved=!0)}),e.ami.result=t,e},communityAmiRender:function(t){var n;this.communityShowContent(),n=0;if(!t.ami)return;return t=t.ami,$("#community_ami_table").html(e.amiItem(t.result)),this.communityPagerRender(t.curPageNum,t.totalPageNum,t.totalNum)},communityPagerRender:function(e,n,r){var i,s,o,u,a;return a=this,o=r>50?50:r,i=(e-1)*50+1,s=i+o-1,s>r&&(s=r),s===0&&(i=0),$(".page-tip").text(sprintf(t.IDE.AMI_LBL_PAGEINFO,i,s,r)),u=$(".pagination"),n===0?u.hide():u.show(),u.data("jqPagination")&&(u.jqPagination("destroy"),u.find("input").data("current-page",e)),u.jqPagination({current_page:e,max_page:n,page_string:"{current_page} / {max_page}",paged:function(e,t){return function(n){if(n!==e&&t>=n&&n>0)return a.doSearch(n)}}(e,n)})},communityShowContent:function(){return $(".show-loading").hide(),$("#ami-table-wrap .scroll-content").show(),$("#btn-search-ami").text(t.IDE.AMI_LBL_SEARCH).removeAttr("disabled"),$("#community-ami-page>div").show()},renderAmiLoading:function(){return $("#ami-table-wrap .scroll-content").hide(),$(".show-loading").show(),$("#btn-search-ami").text(t.IDE.AMI_LBL_SEARCHING).attr("disabled",""),$("#community-ami-page>div").hide()}})}),define("wspace/awseditor/subviews/ResourcePanel",["CloudResources","Design","UI.modalplus","../template/TplLeftPanel","constant","dhcp_manage","snapshotManager","rds_snapshot","sslcert_manage","sns_manage","kp_manage","rds_pg","rds_snapshot","eip_manager","./AmiBrowser","i18n!/nls/lang.js","ApiRequest","OpsModel","backbone","UI.dnd"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y,b;return b=null,$(window).on("resize",function(){b&&clearTimeout(b),b=setTimeout(function(){return $("#OpsEditor").filter(":visible").children(".OEPanelLeft").trigger("RECALC")},150)}),MC.template.resPanelAmiInfo=function(n){var r,s,o,u;if(!n.region||!n.imageId)return;r=e(t.instance().credentialId(),i.RESTYPE.AMI,n.region).get(n.imageId);if(!r)return;r=r.toJSON(),r.imageSize=r.imageSize||((u=r.blockDeviceMapping[r.rootDeviceName])!=null?u.volumeSize:void 0);try{s=App.model.getOsFamilyConfig(n.region),s=s[r.osFamily]||s[i.OS_TYPE_MAPPING[r.osType]],s=r.rootDeviceType==="ebs"?s.ebs:s["instance store"],s=s[r.architecture],s=s[r.virtualizationType||"paravirtual"],r.instanceType=s.join(", ")}catch(a){o=a}return MC.template.bubbleAMIInfo(r)},MC.template.resPanelDbSnapshot=function(n){var s;if(!n.region||!n.id)return;s=e(t.instance().credentialId(),i.RESTYPE.DBSNAP,n.region).get(n.id);if(!s)return;return r.resourcePanelBubble(s.toJSON())},MC.template.resPanelSnapshot=function(n){var s,o;if(!n.region||!n.id)return;o=e(t.instance().credentialId(),i.RESTYPE.SNAP,n.region).get(n.id);if(!o)return;return s={},_.each(o.toJSON(),function(e,t){var n;n=v.IDE["DASH_BUB_"+t.toUpperCase()]||t,s[n]=e}),r.resourcePanelBubble(s)},y=Backbone.View.extend({tagName:"li",className:"resource-item asg",initialize:function(e){this.parent=e.parent,(this.parent||this).$el.find(".resource-list-asg").append(this.$el),this.listenTo(this.model,"change:name",this.render),this.listenTo(this.model,"change:imageId",this.render),this.listenTo(this.model,"destroy",this.remove),this.render(),this.$el.attr({"data-type":"ASG","data-option":'{"lcId":"'+this.model.id+'"}'})},render:function(){return this.$el.html(r.reuse_lc({name:this.model.get("name"),cachedAmi:this.model.getAmi()||this.model.get("cachedAmi")}))}}),Backbone.View.extend({events:{"click nav button":"switchPanel","click .btn-fav-ami":"toggleFav","OPTION_CHANGE .AmiTypeSelect":"changeAmiType","click .BrowseCommunityAmi":"browseCommunityAmi","click .ManageEbsSnapshot":"manageEbsSnapshot","click .ManageRdsSnapshot":"manageRdsSnapshot","click .fixedaccordion-head":"updateAccordion",RECALC:"recalcAccordion","mousedown .resource-item":"startDrag","click .refresh-resource-panel":"refreshPanelData","click .resources-dropdown-wrapper li":"resourcesMenuClick","OPTION_CHANGE #resource-list-sort-select-snapshot":"resourceListSortSelectSnapshotEvent","OPTION_CHANGE #resource-list-sort-select-rds-snapshot":"resourceListSortSelectRdsEvent","click .container-item":"toggleConstraint","keyup #filter-containers":"filterContainers","change #filter-containers":"filterContainers","click .group-header":"toggleGroup"},initialize:function(n){var r,s,o;return _.extend(this,n),this.subViews=[],o=this.workspace.design.region(),r=this.workspace.design.credentialId(),this.listenTo(e(r,"MyAmi",o),"update",this.updateMyAmiList),this.listenTo(e(r,i.RESTYPE.AZ,o),"update",this.updateAZ),this.listenTo(e(r,i.RESTYPE.SNAP,o),"update",this.updateSnapshot),this.listenTo(e(r,i.RESTYPE.DBSNAP,o),"update",this.updateRDSSnapshotList),s=this.workspace.design,this.listenTo(s,t.EVENT.ChangeResource,this.onResChanged),this.listenTo(s,t.EVENT.AddResource,this.updateDisableItems),this.listenTo(s,t.EVENT.RemoveResource,this.updateDisableItems),this.listenTo(s,t.EVENT.AddResource,this.updateLc),this.listenTo(this.workspace,"toggleRdsFeature",this.toggleRdsFeature),this.__amiType="QuickStartAmi",this.setElement(this.parent.$el.find(".OEPanelLeft")),$(document).off("keydown",this.bindKey.bind(this)).on("keydown",this.bindKey.bind(this)),this.render()},render:function(){var e,n,s;n=e=!0,s=this.workspace.opsModel.isMesos(),t.instance().region()==="cn-north-1"&&(n=e=!1);if(t.instance().get("state")==="Stopped")return!1;this.$el.html(r.panel({rdsDisabled:this.workspace.isRdsDisabled(),hasVGW:n,hasCGW:e,isMesos:s})),this.$el.toggleClass("hidden",this.__leftPanelHidden||!1),this.recalcAccordion(),this.updateAZ(),this.updateSnapshot(),s?(this.workspace.opsModel.getMesosData()&&this.getContainerList(),this.updateMesos(),this.workspace.design.modeIsApp()&&t.modelClassForType(i.RESTYPE.MESOSMASTER).getMarathon()&&this.workspace.opsModel.getMesosData().on("change",this.getContainerList,this)):this.updateAmi(),this.updateRDSList(),this.updateRDSSnapshotList(),this.updateDisableItems(),this.renderReuse()},switchPanel:function(e){var t;if(!e){this.$el.find(".resource-panel").addClass("hide"),this.$el.find(".container-panel").removeClass("hide");return}return t=$(e.currentTarget),this.$el.find(".container-panel").addClass("hide"),this.$el.find(".resource-panel").addClass("hide"),t.hasClass("sidebar-nav-resource")?this.$el.find(".resource-panel").removeClass("hide"):this.$el.find(".container-panel").removeClass("hide")},toggleConstraint:function(e){var t,n,r;return r=150,n=$(e.currentTarget),this.$(".container-item").removeClass("selected"),n.addClass("selected"),t=n.next(".constraint-list"),t.is(":visible")||(this.$(".constraint-list").each(function(){var e;e=$(this);if(e.is(":visible"))return e.stop().slideUp(r)}),t.stop().slideDown(r)),this.highlightCanvas(e)},highlightCanvas:function(e){var n,r,s,o,u;n=$(e.currentTarget),o=n.data("hosts"),s=o.split(","),u=[],r=t.modelClassForType(i.RESTYPE.MESOSMASTER),_.each(s,function(e){var t,n,s,o,a,f;if(e){o=r.getCompByIp(e);if(o.type===i.RESTYPE.LC){t=o.connectionTargets("LcUsage")[0],s=t.get("expandedList")||[];for(a=0,f=s.length;a<f;a++)n=s[a],u.push(n.getLc())}if(o)return u.push(o)}});if(u.length)return this.workspace.view.highLightModels(u)},resourceListSortSelectRdsEvent:function(e){var t,n,r;r="date",e&&(t=$(e.currentTarget),r=t.find(".selected").data("id")),n=[],r==="date"&&(n=this.$el.find(".resource-list-rds-snapshot li").sort(function(e,t){return new Date($(t).data("date"))-new Date($(e).data("date"))})),r==="engine"&&(n=this.$el.find(".resource-list-rds-snapshot li").sort(function(e,t){return $(e).data("engine")-$(t).data("engine")})),r==="storge"&&(n=this.$el.find(".resource-list-rds-snapshot li").sort(function(e,t){return Number($(t).data("storge"))-Number($(e).data("storge"))}));if(n.length)return this.$el.find(".resource-list-rds-snapshot").html(n)},resourceListSortSelectSnapshotEvent:function(e){var t,n,r;r="date",e&&(t=$(e.currentTarget),r=t.find(".selected").data("id")),n=[],r==="date"&&(n=this.$el.find(".resource-list-snapshot li").sort(function(e,t){return new Date($(t).data("date"))-new Date($(e).data("date"))})),r==="storge"&&(n=this.$el.find(".resource-list-snapshot li").sort(function(e,t){return Number($(e).data("storge"))-Number($(t).data("storge"))}));if(n.length)return this.$el.find(".resource-list-snapshot").html(n)},bindKey:function(e){var t,n,r,i,s,o;o=this,n=e.which,r=e.ctrlKey||e.metaKey,i=e.shiftKey,s=e.target.tagName.toLowerCase(),t=s==="input"||s==="textarea";if(r===!1&&i===!1&&n===82&&t===!1)return o.toggleResourcePanel(),!1},renderReuse:function(){var e,t,n,r;r=this.workspace.design.componentsOfType(i.RESTYPE.LC);for(t=0,n=r.length;t<n;t++)e=r[t],e.get("appId")||new y({model:e,parent:this});return this},updateLc:function(e){if(e.type===i.RESTYPE.LC&&!e.get("appId"))return new y({model:e,parent:this})},onResChanged:function(e){if(!e)return;if(e.type!==i.RESTYPE.AZ)return;this.updateAZ()},updateAZ:function(t){var n,r,s,o,u,a,f;if(!this.workspace.isAwake())return;if(t&&t.type!==i.RESTYPE.AZ)return;s=this.workspace.design.region(),o=function(){var e,t,n,s;n=this.workspace.design.componentsOfType(i.RESTYPE.AZ)||[],s=[];for(e=0,t=n.length;e<t;e++)r=n[e],s.push(r.get("name"));return s}.call(this),n=[],f=e(this.workspace.design.credentialId(),i.RESTYPE.AZ,s).where({category:s})||[];for(u=0,a=f.length;u<a;u++)r=f[u],o.indexOf(r.id)===-1&&n.push(r.id);this.$el.find(".az").toggleClass("disabled",n.length===0).data("option",{name:n[0]}).children(".resource-count").text(n.length)},updateSnapshot:function(){var t,n;return n=this.workspace.design.region(),t=e(this.workspace.design.credentialId(),i.RESTYPE.SNAP,n).where({category:n})||[],t.region=t.length?n:i.REGION_SHORT_LABEL[n],this.$el.find(".resource-list-snapshot").html(r.snapshot(t))},toggleRdsFeature:function(){this.$el.find(".ManageRdsSnapshot").parent().toggleClass("disableRds",this.workspace.isRdsDisabled()),this.workspace.isRdsDisabled()||(this.updateRDSList(),this.updateRDSSnapshotList()),this.updateDisableItems(),this.$el.children(".sidebar-title").find(".icon-rds-snap,.icon-pg").toggleClass("disabled",this.workspace.isRdsDisabled())},updateRDSList:function(){var t;return t=e(this.workspace.design.credentialId(),i.RESTYPE.DBENGINE,this.workspace.design.region()).groupBy("DBEngineDescription"),this.$el.find(".resource-list-rds").html(r.rds(t))},updateRDSSnapshotList:function(){var t,n;return n=this.workspace.design.region(),t=e(this.workspace.design.credentialId(),i.RESTYPE.DBSNAP,n).toJSON(),t.region=t.length?n:i.REGION_SHORT_LABEL[n],this.$el.find(".resource-list-rds-snapshot").html(r.rds_snapshot(t))},changeAmiType:function(e,t){this.__amiType=t||"QuickStartAmi",this.updateAmi(),$(e.currentTarget).parent().hasClass(".open")||$(e.currentTarget).parent().click()},updateAmi:function(){var t,n;return n=e(this.workspace.design.credentialId(),this.__amiType,this.workspace.design.region()).getModels().sort(function(e,t){var n,r;return e=e.attributes,t=t.attributes,e.osType==="windows"&&t.osType!=="windows"?1:e.osType!=="windows"&&t.osType==="windows"?-1:(n=e.osType,r=t.osType,n===r&&(n=e.architecture,r=t.architecture,n===r&&(n=e.name,r=t.name)),n>r?1:-1)}),n.fav=this.__amiType==="FavoriteAmi",n.region=this.workspace.opsModel.get("region"),t=r.ami(n),this.$el.find(".resource-list-ami").html(t)},updateMesos:function(){var e,n,s,o,u;return u=this.workspace.design.region(),s=_.findWhere(i.MESOS_AMI_IDS,{region:u}).imageId,o=t.instance().modeIsAppEdit(),e={region:u,imageId:s,isAppEdit:o},n=r.mesos(e),this.$(".resource-list-ami").html(n)},updateDisableItems:function(e){var n,r,s,o,u,a,f,l,c,h,p,d;if(!this.workspace.isAwake())return;this.updateAZ(e),o=this.workspace.design,r=i.RESTYPE,n=this.$el.find(".resource-item.igw").parent(),n.children(".resource-item.igw").toggleClass("disabled",o.componentsOfType(r.IGW).length>0),n.children(".resource-item.vgw").toggleClass("disabled",o.componentsOfType(r.VGW).length>0),s={},p=o.componentsOfType(r.SUBNET);for(c=0,h=p.length;c<h;c++)f=p[c],s[f.parent().get("name")]=!0;this.sbg=this.$el.find(".resource-item.subnetgroup"),(d=t.instance().region())==="cn-north-1"?a=1:a=2,_.keys(s).length<a?(u=!0,l=sprintf(v.IDE.RES_TIP_DRAG_CREATE_SUBNET_GROUP,a),this.sbg.toggleClass("disabled",!0).attr("data-tooltip")):(u=!1,l=v.IDE.RES_TIP_DRAG_NEW_SUBNET_GROUP),this.workspace.isRdsDisabled()&&(u=!0,l=v.IDE.RES_MSG_RDS_DISABLED),this.sbg.toggleClass("disabled",u).attr("data-tooltip",l)},updateFavList:function(){if(this.__amiType==="FavoriteAmi")return this.updateAmi()},updateMyAmiList:function(){if(this.__amiType==="MyAmi")return this.updateAmi()},toggleFav:function(t){var n,r;return n=$(t.currentTarget).toggleClass("fav"),r=e(this.workspace.design.credentialId(),"FavoriteAmi",this.workspace.design.region()),n.hasClass("fav")?r.fav(n.attr("data-id")):r.unfav(n.attr("data-id")),!1},toggleLeftPanel:function(){return this.__leftPanelHidden=this.$el.toggleClass("hidden").hasClass("hidden"),null},toggleResourcePanel:function(){return this.toggleLeftPanel()},updateAccordion:function(e,t){var n,r,i,s,o,u,a;o=$(e.currentTarget),n=o.closest(".accordion-group");if(e.target&&!$(e.target).hasClass("fixedaccordion-head"))return;return n.hasClass("expanded")?!1:(this.__openedAccordion=n.index(),s=n.siblings(".expanded"),i=n.closest(".fixedaccordion"),r=i.parents(".OEPanelLeft"),a=o.outerHeight(),u=r.outerHeight()-82-(i.children().length-1)*a,t?(n.innerHeight(u).addClass("expanded"),s.innerHeight(a).removeClass("expanded"),!1):(n.animate({height:u+"px"},200,function(){return n.addClass("expanded")}),s.animate({height:a+"px"},200,function(){return s.removeClass("expanded")}),!1))},recalcAccordion:function(){var e,t,n,r,i,s;i=this.$el;if(!i.length)return;return t=i.find(".fixedaccordion").children(),s=t.children(".fixedaccordion-head").outerHeight(),r=i.outerHeight()-82-t.length*s,t.children(".accordion-body").innerHeight(r),e=t.filter(".expanded"),e.length===0&&(e=t.eq(this.__openedAccordion||0)),e.innerHeight(r+s),e.siblings().innerHeight(s),n=e.removeClass("expanded").children(".fixedaccordion-head"),this.updateAccordion({currentTarget:n[0]},!0)},browseCommunityAmi:function(){var t,n,r;return r=this.workspace.design.region(),n=this.workspace.design.credentialId(),this.listenTo(e(n,"FavoriteAmi",r),"update",this.updateFavList),t=new d({region:r,credential:n}),t.onClose=function(t){return function(){return t.stopListening(e(n,"FavoriteAmi",r),"update",t.updateFavList)}}(this),!1},manageEbsSnapshot:function(){return(new o).render()},manageRdsSnapshot:function(){return(new u).render()},refreshPanelData:function(t){var n,r,s,o;n=$(t.currentTarget).find(".icon-refresh");if(n.hasClass("reloading"))return;n.addClass("reloading"),o=this.workspace.design.region(),r=this.workspace.design.credentialId(),s=[e(r,"MyAmi",o).fetchForce(),e(r,i.RESTYPE.SNAP,o).fetchForce()],this.workspace.isRdsDisabled()?s.push(this.workspace.fetchRdsData()):s.push(e(r,i.RESTYPE.DBSNAP,o).fetchForce()),Q.all(s).done(function(){return n.removeClass("reloading")})},resourcesMenuClick:function(e){var t,n,r;t=$(e.currentTarget),n=t.data("action");switch(n){case"keypair":r=l;break;case"snapshot":r=o;break;case"sns":r=f;break;case"sslcert":r=a;break;case"dhcp":r=s;break;case"rdspg":r=c;break;case"rdssnapshot":r=h;break;case"eip":r=p}return(new r({workspace:this.workspace})).render()},startDrag:function(e){var t,n,r,s;if(e.button!==0)return!1;t=$(e.currentTarget);if(t.hasClass("disabled"))return!1;if(e.target&&$(e.target).hasClass("btn-fav-ami"))return;return s=i.RESTYPE[t.attr("data-type")],n="#OpsEditor .OEPanelCenter",s===i.RESTYPE.INSTANCE&&(n+=",#changeAmiDropZone"),r=$.extend(!0,{},t.data("option")||{}),r.type=s,t.dnd(e,{dropTargets:$(n),dataTransfer:r,eventPrefix:s===i.RESTYPE.VOL?"addVol_":"addItem_",onDragStart:function(e){if(s===i.RESTYPE.AZ)return e.shadow.children(".res-name").text(t.data("option").name);if(s===i.RESTYPE.ASG)return e.shadow.text("ASG")}}),!1},remove:function(){_.invoke(this.subViews,"remove"),this.subViews=null,Backbone.View.prototype.remove.call(this)},getContainerList:function(){var e,t,n,r,i,s;return s=this,n=this.workspace.opsModel.getMesosData(),e=null,i=null,t=3e4,r=function(){var o,u;u=n.get("leaderIp");if(!u)return;return s.workspace.isAwake()?o=[s.getMarathonAppList(u).then(function(t){return e=t}),s.getMarathonTaskList(u).then(function(e){return i=e})]:o=[],Q.all(o).then(function(t){if(e)return s.renderContainerList(e,i)}).fail(function(){return s.renderMarathonNotReady()})["finally"](function(){return clearTimeout(s.timeOutLoop),s.timeOutLoop=setTimeout(function(){return r()},t)})},r()},getMarathonAppList:function(e){return m("marathon_app_list",{key_id:this.workspace.opsModel.credentialId(),leader_ip:e})},getMarathonTaskList:function(e){return m("marathon_task_list",{key_id:this.workspace.opsModel.credentialId(),leader_ip:e})},renderMarathonNotReady:function(){return this.workspace.__mesosIsReady?!1:this.$(".marathon-app-ready").show().html(r.mesosNotReady)},renderContainerList:function(e,t){var n,i,s,o,u,a,f,l,c;if(!this.workspace.isAwake())return;return u=this,this.workspace.__mesosIsReady=!0,n=(l=e[1])!=null?l.apps:void 0,i=(c=t[1])!=null?c.tasks:void 0,s={},i&&i.length&&_.each(i,function(e){var t,n;return t=e.appId,n=e.host,s[t]||(s[t]=[]),s[t].push(n)}),n&&n.length?(u.$(".marathon-app-list").show(),u.$(".marathon-app-ready").hide(),a=[],_.each(n,function(e){return a.push({id:e.id,task:e.tasksRunning,instance:e.instances,cpu:e.cpus,memory:e.mem,hosts:_.uniq(s[e.id]||[]).join(",")})}),u.tempTaskFlag=u.$el.find("li.container-item.selected").data("name"),f=u.$("#filter-containers").val(),u.$(".marathon-app-list").html(r.containerList(a)),u.$("#filter-containers").val(f),u.filterContainers(),u.recalcAccordion(),o=u.$el.find(".container-item[data-name='"+u.tempTaskFlag+"']"),u.tempTaskFlag&&o?o.addClass("selected"):this.workspace.view.removeHighlight()):(u.$(".marathon-app-list").hide(),u.$(".marathon-app-ready").show().html(r.emptyContainer()))},removeHighlight:function(){return this.$(".container-item.selected").removeClass("selected")},toggleGroup:function(e){var t,n;return n=$(e.currentTarget),n.toggleClass("expand"),t=n.next(".container-list"),n.hasClass("expand")?t.removeClass("hide"):t.addClass("hide")},filterContainers:function(){var e;return e=this.$("#filter-containers").val().toLowerCase(),$(".container-list .container-item").each(function(t,n){var r,i;return r=$(n).data("name").toLowerCase(),i=r.indexOf(e)>=0,!i&&$(n).hasClass("selected")&&$(n).next().hide(),$(n).toggle(i)})}})}),define("wspace/awseditor/template/TplStatusbar",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<ul class="status-bar"></ul>\n<div class="status-bar-modal"></div>'},n.frame=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o=this.escapeExpression;return s+=o(n.i18n.call(t,"IDE.LAST_SAVED",{hash:{},data:i}))+' <span class="stack-save-time">-<span>',s},n.lastSaved=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<span class="state-success"><i class="status status-green icon-label"></i><b>'+a((o=t&&t.successCount,typeof o===u?o.apply(t):o))+'</b></span>\n<span class="state-failed"><i class="status status-red icon-label"></i><b>'+a((o=t&&t.failCount,typeof o===u?o.apply(t):o))+"</b></span>",s},n.state=e.template(t),t=function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s=this.escapeExpression;return s(n.i18n.call(t,"IDE.LBL_VALIDATE",{hash:{},data:i}))},n.ta=e.template(t),n}),define("wspace/awseditor/subviews/Statusbar",["OpsModel","Design","../template/TplStatusbar","constant","backbone","event","state_status","i18n!/nls/lang.js"],function(e,t,n,r,i,s,o,u){var a,f;return f=[{name:"lastSaved",className:"info",visible:!0,events:{update:function(){return[{obj:null,event:"jsonDataSaved"}]}},update:function(e,t){var n;return n=jQuery.now()/1e3,this.timer&&clearInterval(this.timer),this.timer=setInterval(function(){var t,r;t=e(".stack-save-time"),r=MC.intervalDate(n);if(t.text()!==r)return t.text(r)},1e3),null},click:function(e){return null},remove:function(){return clearInterval(this.timer)}},{name:"ta",className:"status-bar-btn",visible:function(e,t){var n,r;return r=t.design.mode(),r==="app"||r==="appview"?n=!1:n=!0,typeof e=="function"&&e(n),n},changeVisible:!0,click:function(e){var t,n;return t=$(e.currentTarget),n=u.IDE.LBL_VALIDATE,t.text(u.IDE.VALIDATING_3DOT),setTimeout(function(){return MC.ta.validAll(),t.text(n),require(["TaGui"],function(e){return e.loadModule("statusbar",null)})},50)}},{name:"state",className:"status-bar-btn",visible:function(t,n){var r,i,s;return s=n.design.mode(),r=_.every([e.State.Updating,e.State.Running,e.State.Saving],function(e){return!n.opsModel.testState(e)}),i=!1,s==="app"||s==="appedit"?i=!r:s==="appview"&&(i=!1),typeof t=="function"&&t(i),i},events:{update:[{obj:s,event:s.UPDATE_STATE_STATUS_DATA}]},changeVisible:!0,update:function(e,t){var n;return n=this.renderData(!0,t),e(".state-success b").text(n.successCount),e(".state-failed b").text(n.failCount)},renderData:function(e,t){var n,r,i,s,o,u,a,f,l,c;this.workspace=t;if(!e)return{};i=App.WS.collection.status.find().fetch(),o=n=0,_.isArray(i)||(i=[i]);for(u=0,f=i.length;u<f;u++){r=i[u];if(r.app_id!==t.opsModel.get("id"))continue;if(r.status){c=r.status;for(a=0,l=c.length;a<l;a++)s=c[a],s.result==="success"?o++:s.result==="failure"&&n++}}return{successCount:o,failCount:n}},click:function(e){return o.loadModule()}}],a=i.View.extend({tagName:"li",initialize:function(){return _.bindAll(this,"render","toggle"),this.clearGarbage=[],this.needUpdate=[]},render:function(){return this.$el.html(this.template(this.data)),this},toggle:function(e){return this.$el.toggle(e)},remove:function(){var e,t,n,r;this.$el.remove(),this.stopListening(),r=this.clearGarbage;for(t=0,n=r.length;t<n;t++)e=r[t],_.isArray(e)?e[1].apply(e[0],e.slice(2)):e();return this.clearGarbage=[],this.needUpdate=[],this},update:function(){var e,t,n,r;r=this.needUpdate;for(t=0,n=r.length;t<n;t++)e=r[t],e();return this}}),i.View.extend({initialize:function(e){var t;return _.extend(this,e),t=this.workspace,this.itemViews=[],this.setElement(this.parent.$el.find(".OEPanelBottom").html(n.frame())),this.renderItem()},ready:!1,bindItem:function(){var e,t,r,i,o,u,l,c,h,p,d,v,m,g,y,b,w;b=jQuery.extend(!0,[],f).reverse();for(r=v=0,g=b.length;v<g;r=++v){o=b[r],l=new a,l.delegateEvents({click:o.click}),l.template=n[o.name],l.$el.addClass(o.className),c=_.bind(l.$,l),h=_.bind(l.toggle,l),_.isFunction(o.visible)&&(d=_.bind(o.visible,o,h,this.workspace)),_.isFunction(o.update)&&(p=_.bind(o.update,o,c,this.workspace)),w=o.events;for(u in w){t=w[u],_.isFunction(t)&&(t=t());if(!_.isArray(t))continue;for(m=0,y=t.length;m<y;m++)e=t[m],u==="update"&&(e.obj===s?(s.onLongListen(e.event,p),l.clearGarbage.push([s,s.offListen,e.event,p])):l.listenTo(e.obj||this.workspace.opsModel,e.event,p))}o.changeVisible&&(o.visible&&l.needUpdate.push(d),o.update&&l.needUpdate.push(p)),_.isFunction(o.visible)?i=o.visible(l.toggle,this.workspace):(l.toggle(o.visible),i=o.visible),l.data=(typeof o.renderData=="function"?o.renderData(i,this.workspace):void 0)||{},o.remove&&l.clearGarbage.push(_.bind(o.remove,o)),this.itemViews.push(l)}return null},renderItem:function(){var e,t,n,r,i;e=this,this.ready||(this.bindItem(),this.ready=!0),i=this.itemViews;for(n=0,r=i.length;n<r;n++)t=i[n],this.$("ul").append(t.render().el);return this},update:function(){var e,t,n,r,i;r=this.itemViews,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.update());return i},remove:function(){var e,t,n,r;this.$el.remove(),this.stopListening(),r=this.itemViews;for(t=0,n=r.length;t<n;t++)e=r[t],e.remove();return this}})}),define("wspace/awseditor/canvas/TplPopup",["handlebars"],function(e){var t,n={};return t=function(e,t,n,r,i){function f(e,t){var r="",i;r+='\n<header class="volume-pph">'+u(n.i18n.call(e,"CANVAS.CVS_POP_ATTACHED_VOLUMES",{hash:{},data:t}))+" <span>("+u((i=e&&e.length,typeof i===o?i.apply(e):i))+')</span></header>\n<ul class="popup-content popup-volume">\n\n    ',i=n.each.call(e,e,{hash:{},inverse:a.noop,fn:a.program(2,l,t),data:t});if(i||i===0)r+=i;return r+="\n</ul>\n",r}function l(e,t){var r="",i;r+='\n    <li data-id="'+u((i=e&&e.id,typeof i===o?i.apply(e):i))+'" class="',i=n["if"].call(e,e&&e.snapshot,{hash:{},inverse:a.program(5,h,t),fn:a.program(3,c,t),data:t});if(i||i===0)r+=i;r+='">\n        <div class="vpp-name">'+u((i=e&&e.name,typeof i===o?i.apply(e):i))+'</div>\n        <div class="vpp-size">'+u((i=e&&e.size,typeof i===o?i.apply(e):i))+"GB</div>\n        ",i=n["if"].call(e,e&&e.appId,{hash:{},inverse:a.noop,fn:a.program(7,p,t),data:t});if(i||i===0)r+=i;return r+="\n    </li>\n",r}function c(e,t){return"vpp-snapshot"}function h(e,t){return"vpp-volume"}function p(e,t){var n="",r;return n+='<i class="status res-state tooltip '+u((r=e&&e.state,typeof r===o?r.apply(e):r))+'" data-tooltip="'+u((r=e&&e.state,typeof r===o?r.apply(e):r))+'"></i>',n}function d(e,t){var r="";return r+='\n<div class="volume-pp-empty">'+u(n.i18n.call(e,"CANVAS.CVS_POP_NO_ATTACHED_VOLUME",{hash:{},data:t}))+"</div>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this;return s=n["if"].call(t,t&&t.length,{hash:{},inverse:a.program(9,d,i),fn:a.program(1,f,i),data:i}),s||s===0?s:""},n.volume=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n<ul class="popup-content popup-instance">\n  ',i=n.each.call(e,e&&e.items,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n</ul>\n",r}function c(e,t){var n="",r;return n+='<li data-id="'+a((r=e&&e.id,typeof r===u?r.apply(e):r))+'" class="vpp-instance">\n    <i class="vpp-ins-state tooltip status-'+a((r=e&&e.state,typeof r===u?r.apply(e):r))+'" data-tooltip="'+a((r=e&&e.state,typeof r===u?r.apply(e):r))+'"></i>\n    <img src="/assets/images/'+a((r=e&&e.icon,typeof r===u?r.apply(e):r))+'" width="39" height="27">\n    <div class="vpp-ins-vol">'+a((r=e&&e.volume,typeof r===u?r.apply(e):r))+'</div>\n    <div class="vpp-ins-name">'+a((r=e&&e.id,typeof r===u?r.apply(e):r))+"</div></li>",n}function h(e,t){var r="";return r+='\n<div class="instance-pp-empty">'+a(n.i18n.call(e,"CANVAS.CVS_POP_NO_INSTANCES",{hash:{},data:t}))+"</div>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<header class="instance-pph">'+a((o=t&&t.name,typeof o===u?o.apply(t):o))+' <span class="instance-pph-close">×</span></header>\n',o=n["if"].call(t,(o=t&&t.items,o==null||o===!1?o:o.length),{hash:{},inverse:f.program(4,h,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s},n.instance=e.template(t),t=function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n<ul class="popup-content popup-instance">\n  ',i=n.each.call(e,e&&e.items,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n</ul>\n",r}function c(e,t){var r="",i;r+='<li data-id="'+a((i=e&&e.id,typeof i===u?i.apply(e):i))+'" class="vpp-instance vpp-eni">\n  ',i=n["if"].call(e,e&&e.eip,{hash:{},inverse:f.noop,fn:f.program(3,h,t),data:t});if(i||i===0)r+=i;return r+="\n  "+a((i=e&&e.id,typeof i===u?i.apply(e):i))+"</li>",r}function h(e,t){var n="",r;return n+='<div class="vpp-eip tooltip" data-tooltip="'+a((r=e&&e.eip,typeof r===u?r.apply(e):r))+'"></div>',n}function p(e,t){var r="";return r+='\n<div class="instance-pp-empty">'+a(n.i18n.call(e,"CANVAS.CVS_POP_NO_NETWORK_INTERFACE",{hash:{},data:t}))+"</div>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<header class="instance-pph">'+a((o=t&&t.name,typeof o===u?o.apply(t):o))+' <span class="instance-pph-close">×</span></header>\n',o=n["if"].call(t,(o=t&&t.items,o==null||o===!1?o:o.length),{hash:{},inverse:f.program(5,p,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s},n.eni=e.template(t),n}),define("wspace/awseditor/canvas/CpVolume",["CanvasPopup","./TplPopup","constant","CloudResources"],function(e,t,n,r){return e.extend({type:"VolumePopup",events:{"mousedown li":"clickVolume","click li":"selectedVolume"},closeOnBlur:!0,initialize:function(){var t,n,r,i,s;e.prototype.initialize.apply(this,arguments),this.host&&this.listenTo(this.host,"change:volumeList",this.render),t=this.models||[];if(t[0]&&t[0].get){s=this.models;for(r=0,i=s.length;r<i;r++)n=s[r],this.listenTo(n,"change:name",this.updateVolume),this.listenTo(n,"change:volumeSize",this.updateVolume)}this.selectAtBegin&&this.clickVolume({currentTarget:this.$el.find("[data-id="+this.selectAtBegin.id+"]")[0]})},migrate:function(e){var t;t=e.$el.find(".selected").attr("data-id"),this.$el.find('[data-id="'+t+'"]').addClass("selected")},updateVolume:function(e){var t;t=this.$el.find("[data-id="+e.id+"]"),t.children(".vpp-name").text(e.get("name")),t.children(".vpp-size").text(e.get("volumeSize")+"GB")},content:function(){var e,n,i,s,o,u,a;i=this.models||[];if(i[0]&&i[0].get){i=[],a=this.models;for(o=0,u=a.length;o<u;o++)s=a[o],n=s.get("appId"),i.push({id:s.get("id"),appId:n,name:s.get("name"),size:s.get("volumeSize"),snapshot:s.get("snapshotId")}),n&&(e=r(s.design().credentialId(),s.type,s.design().region()).get(n),_.last(i).state=(e!=null?e.get("state"):void 0)||"unknown")}return t.volume(i)},clickVolume:function(e){var t,n;return t=$(e.currentTarget).addClass("selected"),n=t.attr("data-id"),this.canvas.selectVolume(n),this.selected&&$(this.selected).removeClass("selected"),this.selected=e.currentTarget,!this.canvas.design.modeIsApp()&&e.which===1&&t.dnd(e,{dropTargets:this.canvas.$el,dataTransfer:{id:n},eventPrefix:"addVol_"}),!1},selectedVolume:function(e){var t,n;return t=$(e.currentTarget).addClass("selected"),n=t.attr("data-id"),this.canvas.selectVolume(n)},remove:function(){this.canvas.selectVolume(null),e.prototype.remove.call(this)}})}),define("wspace/awseditor/canvas/CanvasViewAws",["CanvasView","constant","i18n!/nls/lang.js","./CpVolume","CanvasManager","Design"],function(e,t,n,r,i,s){var o,u;return u=function(e,t){return t.x1<=e.x&&t.y1<=e.y&&t.x2>=e.x&&t.y2>=e.y},o=e.extend({events:function(){return $.extend({addVol_dragover:"__addVolDragOver",addVol_dragleave:"__addVolDragLeave",addVol_drop:"__addVolDrop"},e.prototype.events)},recreateStructure:function(){this.svg.clear().add([this.svg.group().classes("layer_vpc"),this.svg.group().classes("layer_az"),this.svg.group().classes("layer_subnet"),this.svg.group().classes("layer_asg"),this.svg.group().classes("layer_line"),this.svg.group().classes("layer_sgline"),this.svg.group().classes("layer_lc"),this.svg.group().classes("layer_node")])},appendVpc:function(e){return this.__appendSvg(e,".layer_vpc")},appendAz:function(e){return this.__appendSvg(e,".layer_az")},appendSubnet:function(e){return this.__appendSvg(e,".layer_subnet")},appendAsg:function(e){return this.__appendSvg(e,".layer_asg")},appendSgline:function(e){return this.__appendSvg(e,".layer_sgline")},fixConnection:function(e,n,r){var i;if(r.type!==t.RESTYPE.ELB||n.type!==t.RESTYPE.INSTANCE&&n.type!==t.RESTYPE.LC){if(r.type===t.RESTYPE.ASG||r.type==="ExpandedAsg")r=r.getLc(),r&&(r=this.getItem(r.id))}else e.x>r.pos().x+r.size().width/2?i="elb-sg-out":i="elb-sg-in";return{toPort:i,target:r}},errorMessageForDrop:function(e){switch(e){case t.RESTYPE.VOL:return n.CANVAS.WARN_NOTMATCH_VOLUME;case t.RESTYPE.SUBNET:return n.CANVAS.WARN_NOTMATCH_SUBNET;case t.RESTYPE.INSTANCE:return n.CANVAS.WARN_NOTMATCH_INSTANCE_SUBNET;case t.RESTYPE.ENI:return n.CANVAS.WARN_NOTMATCH_ENI;case t.RESTYPE.RT:return n.CANVAS.WARN_NOTMATCH_RTB;case t.RESTYPE.ELB:return n.CANVAS.WARN_NOTMATCH_ELB;case t.RESTYPE.CGW:return n.CANVAS.WARN_NOTMATCH_CGW;case t.RESTYPE.ASG:return n.CANVAS.WARN_NOTMATCH_ASG;case t.RESTYPE.IGW:return n.CANVAS.WARN_NOTMATCH_IGW;case t.RESTYPE.VGW:return n.CANVAS.WARN_NOTMATCH_VGW;case t.RESTYPE.DBSBG:return n.CANVAS.WARN_NOTMATCH_SGP_VPC;case t.RESTYPE.DBINSTANCE:return n.CANVAS.WARN_NOTMATCH_DBINSTANCE_SGP}},selectVolume:function(e){return this.deselectItem(!0),this.__selectedVolume=e,e&&this.triggerSelected(t.RESTYPE.VOL,e),!1},isReadOnly:function(){return this.design.modeIsApp()},delSelectedItem:function(){var t,n,r,i;if(this.isReadOnly())return!1;if(this.__selectedVolume){i=this.design.component(this.__selectedVolume),n=i.isRemovable();if(_.isString(n)){notification("error",n);return}r=this.__selectedVolume,this.__selectedVolume=null,i.remove(),t=$(".canvas-pp .popup-volume").children().eq(0),t.length?t.trigger("mousedown"):this.deselectItem();return}return e.prototype.delSelectedItem.apply(this,arguments)},__addVolDragOver:function(e,n){var s,o,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;this.__scrollOnDrag(n);if(!n.volDropTargets){n.hoverItem=null,s=t.RESTYPE,p=this.design.componentsOfType(s.INSTANCE).concat(this.design.componentsOfType(s.LC)),n.volDropTargets=o=[];for(v=0,b=p.length;v<b;v++){d=p[v],d=this.getItem(d.id),x=d.$el;for(m=0,w=x.length;m<w;m++)a=x[m],h=d.rect(a),h.tgt=d,h.el=a,o.push(h)}}if(!n.effect){n.effect=!0,T=n.volDropTargets||[];for(g=0,E=T.length;g<E;g++)d=T[g],i.addClass(d.tgt.$el,"droppable")}c=this.__localToCanvasCoor(n.pageX-n.zoneDimension.x1,n.pageY-n.zoneDimension.y1),f=null,N=n.volDropTargets;for(y=0,S=N.length;y<S;y++){d=N[y];if(u(c,d)){f=d;break}}f!==n.hoverItem&&(n.popup&&n.popup.remove(),n.hoverItem=f,f&&(l=f.tgt.model,n.popup=new r({attachment:f.el,host:l,models:l.get("volumeList"),canvas:this})))},__addVolDragLeave:function(e,t){var n,r,s,o;this.__clearDragScroll(),o=t.volDropTargets||[];for(r=0,s=o.length;r<s;r++)n=o[r],i.removeClass(n.tgt.$el,"droppable");t.effect=!1,t.popup&&t.popup.remove()},__addVolDrop:function(e,i){var o,u,a,f,l,c;if(!i.hoverItem)return;u=i.dataTransfer||{},f=i.hoverItem.tgt.model;if(u.id){c=this.design.component(u.id),a=c.isReparentable(f);if(_.isString(a))return notification("error",a);a&&(c.attachTo(f),this.selectItem(i.hoverItem.el));return}if(f.type===t.RESTYPE.LC&&f.get("appId")){notification("error",n.NOTIFY.WARN_OPERATE_NOT_SUPPORT_YET);return}u.owner=f,_.isString(u.encrypted)&&(u.encrypted=u.encrypted==="true"),o=s.modelClassForType(t.RESTYPE.VOL),l=new o(u),new r({attachment:i.hoverItem.el,host:f,models:f.get("volumeList"),canvas:this,selectAtBegin:l})}}),o}),define("wspace/awseditor/AwsViewStack",["CoreEditorView","./subviews/PropertyPanel","./subviews/Toolbar","./subviews/ResourcePanel","./subviews/Statusbar","./canvas/CanvasViewAws","event"],function(e,t,n,r,i,s,o){return e.extend({constructor:function(o){return _.extend(o,{TopPanel:n,RightPanel:t,LeftPanel:r,BottomPanel:i,CanvasView:s}),e.apply(this,arguments)},showProperty:function(){o.trigger(o.FORCE_OPEN_PROPERTY)},onItemSelected:function(e,t){o.trigger(o.OPEN_PROPERTY,e,t)},showStateEditor:function(){var e;e=this.workspace.getSelectedComponent(),e&&o.trigger(o.SHOW_STATE_EDITOR,e.id)}})}),define("wspace/awseditor/model/DesignAws",["Design","constant","CloudResources"],function(e,t,n){var r;return r=e.extend({serialize:function(t){var n;return n=e.prototype.serialize.apply(this,arguments),n.property.stoppable=this.isStoppable(),n},preserveName:function(){var e,n,r,i;if(!this.modeIsAppEdit())return;this.__preservedNames={},i=this.__componentMap;for(r in i){e=i[r];switch(e.type){case t.RESTYPE.ELB:case t.RESTYPE.ASG:case t.RESTYPE.LC:case t.RESTYPE.DBINSTANCE:n=this.__preservedNames[e.type]||(this.__preservedNames[e.type]={}),n[e.get("name")]=!0}}},isStoppable:function(){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;r=e.modelClassForType(t.RESTYPE.INSTANCE),i=e.modelClassForType(t.RESTYPE.LC),s=r.allObjects(this).concat(i.allObjects(this));for(p=0,m=s.length;p<m;p++){a=s[p],o=a.getAmi()||a.get("cachedAmi");if(o&&o.rootDeviceType==="instance-store")return!1}c=e.modelClassForType(t.RESTYPE.VPC).allObjects(this);if(c.length>0){h=c[0].get("appId"),l=n(this.credentialId(),t.RESTYPE.INSTANCE,this.region()).filter(function(e){return e.get("vpcId")===h});for(d=0,g=l.length;d<g;d++){f=l[d],f=f.attributes,b=f.blockDeviceMapping||[];for(v=0,y=b.length;v<y;v++){u=b[v];if(u.ebs===null&&u.VirtualName)return!1}}}return!0},instancesNoUserData:function(){var n,r,i;return i=!0,n=e.modelClassForType(t.RESTYPE.INSTANCE).allObjects(),_.each(n,function(e){return i=e.get("userData")?!1:!0,null}),r=e.modelClassForType(t.RESTYPE.LC).allObjects(),_.each(r,function(e){return i=e.get("userData")?!1:!0,null}),i},getCost:function(e){var n,r,i,s,o,u,a,f,l,c,h,p,d;s=[],f=0,a=App.model.getPriceData(this.region());if(a){o=a.currency||"USD",p=this.__componentMap;for(l in p){r=p[l];if(e&&(d=r.type)!==t.RESTYPE.EIP&&d!==t.RESTYPE.VOL&&d!==t.RESTYPE.ELB&&d!==t.RESTYPE.CW)continue;if(r.getCost){i=null;try{i=r.getCost(a,o)}catch(v){u=v,void 0}if(!i)continue;if(i.length)for(c=0,h=i.length;c<h;c++)n=i[c],f+=n.fee,s.push(n);else f+=i.fee,s.push(i)}}s=_.sortBy(s,"resource")}return{costList:s,totalFee:Math.round(f*100)/100}},getCurrency:function(){var t,n;return t="$",(n=e.instance().region())==="cn-north-1"&&(t="￥"),t}}),r}),define("wspace/awseditor/model/connection/EniAttachment",["constant","ConnectionModel","i18n!/nls/lang.js"],function(e,t,n){var r;return r=t.extend({type:"EniAttachment",defaults:{index:1},initialize:function(t){var n;return n=this.getTarget(e.RESTYPE.INSTANCE),t&&t.index?this.ensureAttachmentOrder():this.attributes.index=n.connectionTargets("EniAttachment").length+1,null},ensureAttachmentOrder:function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d;t=this.getTarget(e.RESTYPE.INSTANCE),i=t.connections("EniAttachment");for(a=0,c=i.length;a<c;a++){r=i[a];if(r!==this&&r.attributes.index===this.attributes.index){for(o=f=0,h=i.length;f<h;o=++f)r=i[o],r.attributes.index=o+1,r.getOtherTarget(t).updateName();return}}u=i.sort(function(e,t){return e.attributes.index-t.attributes.index});if(i.indexOf(this)!==u.indexOf(this)){n=[],d=t.get("__connections");for(l=0,p=d.length;l<p;l++)s=d[l],s.type!=="EniAttachment"&&n.push(s);t.attributes.__connections=n.concat(u)}return null},remove:function(){var n,r,i,s,o,u;t.prototype.remove.apply(this,arguments),r=this.getTarget(e.RESTYPE.INSTANCE),o=this.getTarget(e.RESTYPE.ENI);if(!r.isRemoved()){s=r.connections("EniAttachment"),u=1;while(u<=s.length)i=s[u-1],i.attributes.index!==u&&(i.attributes.index=u,i.getTarget(e.RESTYPE.ENI).updateName()),++u}return!r.isRemoved()&&!o.isRemoved()&&(n=Design.modelClassForType(e.RESTYPE.SG),n.tryDrawLine(r,o)),null},portDefs:{port1:{name:"instance-attach",type:e.RESTYPE.INSTANCE},port2:{name:"eni-attach",type:e.RESTYPE.ENI}}},{isConnectable:function(t,r){var i,s,o,u,a;return u=t.parent(),a=r.parent(),!u||!a?!1:(u.type===e.RESTYPE.SUBNET&&(u=u.parent(),a=a.parent()),u!==a?!1:(t.type===e.RESTYPE.INSTANCE?(s=t,i=r):(s=r,i=t),i.connections("EniAttachment").length>0?!1:s.isMesos()?n.IDE.CANT_ATTACH_ENI_TO_MESOS_INSTANCE:(o=s.getMaxEniCount(),s.connections("EniAttachment").length+1>=o?sprintf(n.CANVAS.CVS_WARN_EXCEED_ENI_LIMIT,s.get("name"),s.get("instanceType"),o):s.getEmbedEni().get("assoPublicIp")===!0?{confirm:!0,title:n.CANVAS.ATTACH_NETWORK_INTERFACE_TO_INTERFACE,action:n.CANVAS.ATTACH_AND_REMOVE_PUBLIC_IP,template:MC.template.modalAttachingEni({host:s.get("name"),eni:i.get("name")})}:!0)))}}),r}),define("wspace/awseditor/model/connection/VPNConnection",["constant","ConnectionModel","ComplexResModel"],function(e,t,n){var r,i;return i=n.extend({type:"VpnResource",isVisual:function(){return!1},createRef:function(){return n.prototype.createRef.call(this.getRealBody(),"VpnConnectionId")},setRealBody:function(e){return this.__realbody=e},getRealBody:function(){return this.__realbody}}),r=t.extend({type:e.RESTYPE.VPN,defaults:function(){return{routes:[]}},portDefs:{port1:{name:"vgw-vpn",type:e.RESTYPE.VGW},port2:{name:"cgw-vpn",type:e.RESTYPE.CGW}},initialize:function(){return this.__resource=new i,this.__resource.setRealBody(this)},getResourceModel:function(){return this.__resource},connectionTargets:function(){return this.__resource.connectionTargets.apply(this.__resource,arguments)},tags:function(){return this.__resource.tags.apply(this.__resource,arguments)},get:function(n){return n==="name"?"vpn:"+this.getTarget(e.RESTYPE.CGW).get("name"):t.prototype.get.call(this,n)},serialize:function(t){var n,r,i,s;return s=this.getTarget(e.RESTYPE.VGW),n=this.getTarget(e.RESTYPE.CGW),n.isDynamic()?i=[]:i=_.map(this.get("routes"),function(e){return{DestinationCidrBlock:e}}),r={name:this.get("name"),type:this.type,uid:this.id,resource:{CustomerGatewayId:n.createRef("CustomerGatewayId"),Options:{StaticRoutesOnly:!n.isDynamic()},Type:"ipsec.1",Routes:i,VpnConnectionId:this.get("appId"),VpnGatewayId:s.createRef("VpnGatewayId")}},t&&(t[this.id]=r)||r},remove:function(){return this.getResourceModel().remove(),t.prototype.remove.apply(this,arguments)}},{handleTypes:e.RESTYPE.VPN,deserialize:function(e,t,n){var i,s;i=n(MC.extractID(e.resource.CustomerGatewayId)),s=n(MC.extractID(e.resource.VpnGatewayId));if(!i||!s)return;return new r(i,s,{id:e.uid,appId:e.resource.VpnConnectionId,routes:_.map(e.resource.Routes,function(e){return e.DestinationCidrBlock})})}}),r}),define("wspace/awseditor/model/connection/DbReplication",["constant","ConnectionModel"],function(e,t){return t.extend({type:"DbReplication",portDefs:{port1:{name:"replica",type:e.RESTYPE.DBINSTANCE},port2:{name:"replica",type:e.RESTYPE.DBINSTANCE}},master:function(){return this.__port1Comp},slave:function(){return this.__port2Comp},isRemovable:function(){return!1}})}),define("wspace/awseditor/model/InstanceModel",["ComplexResModel","Design","constant","i18n!/nls/lang.js","CloudResources"],function(e,t,n,r,i){var s,o;return o=[],s=e.extend({type:n.RESTYPE.INSTANCE,newNameTmpl:"host-",defaults:function(){return{count:1,imageId:"",tenancy:"default",ebsOptimized:!1,instanceType:"m1.small",monitoring:!1,userData:"",volumeList:[],rdSize:0,rdIops:0,rdType:"gp2",cachedAmi:null,state:null}},constructor:function(r,i){var o;if(i&&i.createByUser&&r.subType)return o=r.subType,delete r.subType,new(t.modelClassForType(n.RESTYPE[o]))(r,i);if(!i||!i.createBySubClass){if(s.isMesosMaster(r))return new(t.modelClassForType(n.RESTYPE.MESOSMASTER))(r,i);if(s.isMesosSlave(r))return new(t.modelClassForType(n.RESTYPE.MESOSSLAVE))(r,i)}return e.apply(this,arguments)},initialize:function(e,r){var i,s,o,u,a,f,l,c,h;r=r||{},r.cloneSource&&(e.imageId=r.cloneSource.get("imageId")),void 0,this.setAmi(e.imageId);if(r.createByUser||r.cloneSource)i=t.modelClassForType(n.RESTYPE.ENI),this.setEmbedEni(new i({name:"eni0",assoPublicIp:!1},{instance:this}));return r.cloneSource?this.clone(r.cloneSource):r.createByUser&&this.initInstanceType(),this.get("rdSize")||(c=this.getAmiRootDeviceVolumeSize(),c>0&&this.set("rdSize",c)),r.createByUser&&!r.cloneSource&&(s=t.modelClassForType(n.RESTYPE.KP),a=s.getDefaultKP(),a?a.assignTo(this):void 0,this.isMesos()?this.assignMesosSg():(u=t.modelClassForType(n.RESTYPE.SG),f=u.getDefaultSg(),f?(o=t.modelClassForType("SgAsso"),new o(this,f)):void 0)),l=this.get("tenancy"),h=t.modelClassForType(n.RESTYPE.VPC).theVPC(),h&&!h.isDefaultTenancy()&&(l="dedicated"),this.setTenancy(l),null},groupMembers:function(){return this.__groupMembers||(this.__groupMembers=[]),this.__groupMembers},getAvailabilityZone:function(){var e;return e=this.parent(),e.type===n.RESTYPE.SUBNET?e.parent():e},getOSFamily:function(){var e;return e=this.getAmi()||this.get("cachedAmi"),!e||!e.osType||!e.osFamily?(void 0,"linux"):e.osFamily?e.osFamily:i(this.design.credentialId(),n.RESTYPE.AMI,this.design.region()).getOSFamily(e.id)},initInstanceType:function(){var e,t,n,r,i;i=this.getInstanceTypeList();for(n=0,r=i.length;n<r;n++){e=i[n];if(e.name!=="t1.micro"){t=e.name;break}}this.attributes.instanceType=t||"m1.small"},getCost:function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m;if(!e.instance)return null;n=this.getAmi()||this.get("cachedAmi"),l=n?n.osType:"linux-other",f=this.getOSFamily(),u=this.get("instanceType").split("."),p=e.instance.unit,s=e.instance[u[0]][u[1]],s=s?s.onDemand:void 0,s&&(s[f]===void 0&&f.indexOf("mswin")===0&&(f="mswin"),s=s[f]),s=s?s[t]:void 0;if(!s)return null;p==="perhr"?(o=s+"/hr",s*=720):o=s+"/mo",r=this.get("count")||1,a=this.get("name"),r>1&&(a+=" (x"+r+")",s*=r),c={resource:a,type:this.get("instanceType"),fee:s,formatedFee:o};if(this.get("monitoring")){m=e.cloudwatch.types;for(d=0,v=m.length;d<v;d++){h=m[d];if(h.ec2Monitoring)return s=h.ec2Monitoring[t],i={resource:this.get("name")+"-monitoring",type:"CloudWatch",fee:s*r,formatedFee:s+"/mo"},[c,i]}}return c},isReparentable:function(e){var t;return e.type===n.RESTYPE.ASG||e.type==="ExpandedAsg"?!1:(e.type===n.RESTYPE.SUBNET?e.parent()!==this.parent().parent()&&(t=!0):t=!0,t&&this.connectionTargets("EniAttachment").length>0?r.CANVAS.ERR_MOVE_ATTACHED_ENI:!0)},connect:function(e){var t;if(e.type==="EniAttachment"){t=this.getEmbedEni();if(t)return t.set("assoPublicIp",!1)}},setPrimaryEip:function(e,t){var n;n=this.getEmbedEni(),n?n.setPrimaryEip(e,t):(this.set("hasEip",e),e&&(this.attributes.eipData||(this.attributes.eipData={}),this.attributes.eipData.id||(this.attributes.eipData.id=MC.guid())))},hasPrimaryEip:function(){var e;return e=this.getEmbedEni(),e?e.hasPrimaryEip():this.get("hasEip")},hasAutoAssignPublicIp:function(){return this.getEmbedEni().get("assoPublicIp")},isPublic:function(){return this.hasAutoAssignPublicIp()||this.getEmbedEni().hasEip()},setCount:function(e){var t,n,r,i,s,o,u,a,f;this.set("count",e),e>1&&(r=this.connections("RTB_Route")[0],r&&r.remove()),a=this.connectionTargets("EniAttachment");for(i=0,o=a.length;i<o;i++){n=a[i];if(e>1){f=n.connections("RTB_Route");for(s=0,u=f.length;s<u;s++)t=f[s],t.remove()}}return null},isDefaultTenancy:function(){var e,r;return e=t.modelClassForType(n.RESTYPE.VPC),r=e.allObjects()[0],r&&!r.isDefaultTenancy()?!1:this.get("tenancy")!=="dedicated"},setAmi:function(e){var t,n,r,i,s;return this.set("imageId",e),t=this.getAmi(),n=this.get("cachedAmi"),t&&n&&(n.osType=t.osType,n.architecture=t.architecture,n.rootDeviceType=t.rootDeviceType),t&&t.blockDeviceMapping&&!$.isEmptyObject(t.blockDeviceMapping)&&(s=t.rootDeviceName,i=t.blockDeviceMapping[s],i||_.each(t.blockDeviceMapping,function(e,t){return s.indexOf(t)!==-1&&!i&&(i=e),null}),r=i?parseInt(i.volumeSize,10):10,this.get("rdSize")<r&&this.set("rdSize",r)),null},getAmi:function(){var e;return e=i(this.design().credentialId(),n.RESTYPE.AMI,this.design().region()).get(this.get("imageId")),e?e.toJSON():null},getBlockDeviceMapping:function(){var e,t,n,r;return e=this.getAmi()||this.get("cachedAmi"),e&&e.rootDeviceType==="ebs"&&e.blockDeviceMapping&&!$.isEmptyObject(e.blockDeviceMapping)&&(r=e.rootDeviceName,n=e.blockDeviceMapping[r],n||_.each(e.blockDeviceMapping,function(e,t){return r.indexOf(t)!==-1&&!n&&(n=e,r=t),null}),t=[{DeviceName:r,Ebs:{SnapshotId:n.snapshotId,VolumeSize:this.get("rdSize")||n.volumeSize,VolumeType:this.get("rdType")}}],this.get("rdIops")&&parseInt(this.get("rdSize"),10)>=10&&(t[0].Ebs.Iops=this.get("rdIops"))),t||[]},getAmiRootDevice:function(){var e,t,n,r;return e=this.getAmi()||this.get("cachedAmi"),t=null,e&&e.rootDeviceType==="ebs"&&e.blockDeviceMapping&&(r=e.rootDeviceName,n=e.blockDeviceMapping[r],r&&!n&&_.each(e.blockDeviceMapping,function(e,t){return r.indexOf(t)!==-1&&!n&&(n=e,r=t),null}),r&&n?(t={DeviceName:r,Ebs:{VolumeSize:Number(n.volumeSize),SnapshotId:n.snapshotId,VolumeType:n.volumeType}},n.volumeType==="io1"&&(t.Ebs.Iops=n.iops)):void 0),t},getAmiRootDeviceVolumeSize:function(){var e,t,n,r;return n=0,e=this.getAmi(),e?(e.osType==="windows"?r=30:r=10,t=this.getAmiRootDevice(),t?n=t.Ebs.VolumeSize:void 0):void 0,n},getAmiRootDeviceName:function(){var e;return e=this.getAmiRootDevice(),e&&e.DeviceName?e.DeviceName:""},getInstanceTypeConfig:function(e){var t;return t=App.model.getInstanceTypeConfig(this.design().region()),t?t[e||this.get("instanceType")]:null},getMaxEniCount:function(){var e;return e=this.getInstanceTypeConfig(),e&&(e=e.max_eni),e||16},isEbsOptimizedEnabled:function(){var e,t,n;return t=this.getAmi()||this.get("cachedAmi"),t&&t.rootDeviceType==="instance-store"?!1:(n=this.getInstanceTypeConfig(),n&&n.ebs_optimized?n.ebs_optimized==="Yes":(e={"m1.large":!0,"m1.xlarge":!0,"m2.2xlarge":!0,"m2.4xlarge":!0,"m3.xlarge":!0,"m3.2xlarge":!0,"c1.xlarge":!0,"c3.xlarge":!0,"c3.2xlarge":!0,"c3.4xlarge":!0,"c4.large":!0,"c4.xlarge":!0,"c4.4xlarge":!0,"c4.8xlarge":!0,"g2.2xlarge":!0,"i2.xlarge":!0,"i2.2xlarge":!0,"i2.4xlarge":!0,"r3.xlarge":!0,"r3.2xlarge":!0,"r3.4xlarge":!0,"d2.xlarge":!0,"d2.2xlarge":!0,"d2.4xlarge":!0,"d2.8xlarge":!0},!!e[this.get("instanceType")]))},setInstanceType:function(e){var t,n,r,i,s;e==="t1.micro"&&!this.isDefaultTenancy()&&(e="m1.small"),this.set("instanceType",e),this.isEbsOptimizedEnabled()||this.set("ebsOptimized",!1),r=this.get("volumeList"),r&&_.each(r,function(e){return e.isSupportEncrypted()||e.set("encrypted",!1),null});if(this.getEmbedEni){n=this.connectionTargets("EniAttachment"),n.push(this.getEmbedEni());for(i=0,s=n.length;i<s;i++)t=n[i],t.limitIpAddress()}return null},setTenancy:function(e){return this.set("tenancy",e),e==="dedicated"&&this.get("instanceType")==="t1.micro"&&this.initInstanceType(),null},getInstanceType:function(){return s.getInstanceType(this.getAmi(),this.design().region())},getInstanceTypeList:function(){var e,t,n;return n=this.isDefaultTenancy(),e=this.get("instanceType"),t=this.design().region(),_.map(this.getInstanceType(),function(r){var i;return i=App.model.getInstanceTypeConfig(t),i?(i=i[r].formated_desc,{main:i[0],ecu:i[1],core:i[2],mem:i[3],name:r,selected:e===r,hide:!n&&r==="t1.micro"}):{}})},remove:function(){var n,r,i,s,u,a,f,l;this.__mainEni&&this.__mainEni.remove(),f=(this.get("volumeList")||o).slice(0);for(i=0,u=f.length;i<u;i++)r=f[i],r.remove();if(t.instance().modeIsAppEdit()){l=this.connectionTargets("EniAttachment");for(s=0,a=l.length;s<a;s++)n=l[s],n.remove()}return e.prototype.remove.call(this),null},isRemovable:function(){var e;return this.design().modeIsAppEdit()&&this.isMesosMaster()?{error:r.CANVAS.MASTER_NODE_CANNOT_BE_DELETED}:(e=this.get("state"),e&&_.isArray(e)&&e.length>0||$("#state-editor-model").is(":visible")&&$("#state-editor-model .state-list .state-item").length>=1?MC.template.NodeStateRemoveConfirmation({name:this.get("name")}):!0)},clone:function(e){var r,i,s,o,u,a,f,l,c;this.cloneAttributes(e,{reserve:"volumeList",copyConnection:["KeypairUsage","SgAsso","ElbAmiAsso"]}),l=this.get("state")||[];for(o=0,a=l.length;o<a;o++)i=l[o],i.id="state-"+this.design().guid();r=t.modelClassForType(n.RESTYPE.VOL),c=e.get("volumeList")||[];for(u=0,f=c.length;u<f;u++)s=c[u],new r({owner:this},{cloneSource:s});return this.getEmbedEni().clone(e.getEmbedEni()),null},setEmbedEni:function(e){return this.__mainEni=e,null},getEmbedEni:function(){return this.__mainEni},getRealGroupMemberIds:function(){var e,t,n,r,i,s;this.ensureEnoughMember(),e=this.get("count"),n=[this.id],s=this.groupMembers();for(r=0,i=s.length;r<i;r++){t=s[r];if(n.length>=e)break;n.push(t.id)}return n},ensureEnoughMember:function(){var e;e=this.get("count")-1;while(this.groupMembers().length<e)this.groupMembers().push({id:MC.guid(),appId:"",eipData:{id:MC.guid()}});return null},onParentChanged:function(){var e;e=this.getEmbedEni();if(e)return e.onParentChanged()},generateJSON:function(){var e,t,r,i,s,o;return s=this.get("tenancy"),i=this.parent(),i.type===n.RESTYPE.SUBNET&&(o=i.parent().parent(),o.isDefaultTenancy()||(s="dedicated")),r=this.get("name"),this.get("count")>1&&(r+="-0"),e=this.getBlockDeviceMapping(),t={type:this.type,uid:this.id,name:r,description:this.get("description")||"",index:0,number:this.get("count"),serverGroupUid:this.id,serverGroupName:this.get("name"),state:this.get("state"),resource:{UserData:{Base64Encoded:!1,Data:this.get("userData")},BlockDeviceMapping:e,Placement:{Tenancy:s==="dedicated"?"dedicated":"",AvailabilityZone:this.getAvailabilityZone().createRef()},InstanceId:this.get("appId"),ImageId:this.get("imageId"),KeyName:this.get("keyName"),EbsOptimized:this.isEbsOptimizedEnabled()?this.get("ebsOptimized"):!1,VpcId:this.getVpcRef(),SubnetId:this.getSubnetRef(),Monitoring:this.get("monitoring")?"enabled":"disabled",NetworkInterface:[],InstanceType:this.get("instanceType"),DisableApiTermination:!1,ShutdownBehavior:"terminate",SecurityGroup:[],SecurityGroupId:[]}},t},createEipJson:function(e,t){return t=t||this.id,{uid:e.id,type:n.RESTYPE.EIP,index:0,name:"EIP",resource:{Domain:"standard",InstanceId:this.createRef("InstanceId",t),AllocationId:e.allocationId||"",NetworkInterfaceId:"",PublicIp:e.publicIp||""}}},getStateData:function(){return this.get("state")},setStateData:function(e){return this.set("state",e)},setKey:function(e,r){var i,s,o;return i=t.modelClassForType(n.RESTYPE.KP),s=i.getDefaultKP(),r?s?s.assignTo(this):void 0:(o=this.connectionTargets("KeypairUsage")[0],o&&o.dissociate(this),this.set("keyName",e))},getKeyName:function(){var e;return e=this.connectionTargets("KeypairUsage")[0],e?e.isDefault()?"$DefaultKeyPair":e.get("name"):this.get("keyName")||r.PROP.INSTANCE_NO_KP},isDefaultKey:function(){var e;return e=this.connectionTargets("KeypairUsage")[0],e?e&&e.isDefault():!0},isNoKey:function(){var e;return e=this.connectionTargets("KeypairUsage")[0],!e&&!this.get("keyName")},serialize:function(){var e,t,n,r,i,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D;e=[],t=this.getAmi()||this.get("cachedAmi"),p=this.generateLayout(),t&&(p.osType=t.osType,p.architecture=t.architecture,p.rootDeviceType=t.rootDeviceType),e.push({layout:p}),(s.isMesosMaster(this.attributes)||s.isMesosSlave(this.attributes))&&this.setMesosState&&this.setMesosState(),h=[this.generateJSON()],f=h.length,this.ensureEnoughMember();while(f<this.get("count"))d=$.extend(!0,{},h[0]),d.name=this.get("name")+"-"+f,d.index=f,v=this.groupMembers()[h.length-1],d.uid=v.id,d.resource.InstanceId=v.appId,++f,h.push(d);g={number:h.length,instanceId:""},w=this.get("volumeList")||o,u=this.getEmbedEni()?[this.getEmbedEni()]:[],_=this.connections("EniAttachment");for(S=0,C=_.length;S<C;S++)n=_[S],u[n.get("index")]=n.getOtherTarget(this);E=[],a=[];for(l=x=0,k=h.length;x<k;l=++x){c=h[l],g.instanceId=c.uid,g.instanceName=c.name+"-";for(T=0,L=w.length;T<L;T++)b=w[T],y=b.generateJSON(l,g),E.push(y);for(i=N=0,A=u.length;N<A;i=++N)r=u[i],a=a.concat(r.generateJSON(l,g,i))}D=h.concat(E).concat(a);for(M=0,O=D.length;M<O;M++)m=D[M],e.push({component:m});return e},assignMesosSg:function(){var e,r,i;e=t.modelClassForType("SgAsso"),r=t.modelClassForType(n.RESTYPE.SG).find(function(e){return e.isMesosBase()});if(!r)return void 0;new e(this,r);if(this.isMesosMaster()){i=t.modelClassForType(n.RESTYPE.SG).find(function(e){return e.isMesosMaster()});if(i)return new e(this,i)}},isMesosMaster:function(){return this.subType===n.RESTYPE.MESOSMASTER},isMesosSlave:function(){var e;return(e=this.subType)===n.RESTYPE.MESOSSLAVE||e===n.RESTYPE.MESOSLC},isMesos:function(){return!!this.subType}},{handleTypes:n.RESTYPE.INSTANCE,isMesosMaster:function(e){var t;return t=e.state,t&&t[0]&&t[0].module==="linux.mesos.master"?!0:!1},isMesosSlave:function(e){var t;return t=e.state,t&&t[0]&&t[0].module==="linux.mesos.slave"?!0:!1},getInstanceType:function(e,t){var r,i;if(!e||!t)return[];r=App.model.getOsFamilyConfig(t);try{r=r[e.osFamily]||r[n.OS_TYPE_MAPPING[e.osType]],r=e.rootDeviceType==="ebs"?r.ebs:r.instance_store,r=r[e.architecture],r=r[e.virtualizationType||"paravirtual"]}catch(s){i=s,void 0,r=[]}return r||[]},getEffectiveId:function(e){var r,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T;o=t.instance();if(o.component(e))return{uid:e,mid:null};a=t.modelClassForType(n.RESTYPE.INSTANCE).allObjects(),a=a.concat(t.modelClassForType(n.RESTYPE.ENI).allObjects());for(p=0,g=a.length;p<g;p++){f=a[p];if(f.get("appId")===e)return{uid:f.id,mid:""+f.id+"_0"};if(f.groupMembers){E=f.groupMembers();for(u=d=0,y=E.length;d<y;u=++d){l=E[u];if(l&&l.appId===e)return{uid:f.id,mid:""+l.id+"_"+(u+1)}}}}h=i(o.credentialId(),n.RESTYPE.ASG,o.region()),S=t.modelClassForType(n.RESTYPE.ASG).allObjects();for(v=0,b=S.length;v<b;v++){r=S[v],s=(x=h.get(r.get("appId")))!=null?x.toJSON():void 0;if(!s||!s.Instances)continue;s=s.Instances,T=s.member||s;for(m=0,w=T.length;m<w;m++){c=T[m];if(c===e||c.InstanceId===e)return{uid:r.getLc().id,mid:e}}}return{uid:null,mid:null}},deserialize:function(e,r,i){var o,u,a,f,l,c,h,p,d,v;if(e.serverGroupUid&&e.serverGroupUid!==e.uid){c=i(e.serverGroupUid).groupMembers();for(d=0,v=c.length;d<v;d++){l=c[d];if(l&&l.id===e.uid){void 0;return}}e.resource.EipResource&&(a={id:e.resource.EipResource.uid,allocationId:e.resource.EipResource.resource.AllocationId,publicIp:e.resource.EipResource.resource.PublicIp}),c[e.index-1]={id:e.uid,appId:e.resource.InstanceId,eipData:a||{id:MC.guid()}};return}p=e.resource.BlockDeviceMapping[0];if(!p||_.isString(p))p={Ebs:{VolumeSize:0,Iops:""}};if(!_.isArray(e.state)||!e.state.length)e.state=null;return u={id:e.uid,name:e.serverGroupName||e.name,description:e.description||"",appId:e.resource.InstanceId,count:e.number,imageId:e.resource.ImageId,tenancy:e.resource.Placement.Tenancy,ebsOptimized:e.resource.EbsOptimized,instanceType:e.resource.InstanceType,monitoring:e.resource.Monitoring!=="disabled",userData:e.resource.UserData.Data||"",rdSize:p.Ebs.VolumeSize,rdIops:p.Ebs.Iops,rdType:p.Ebs.VolumeType,parent:i(r.groupUId),x:r.coordinate[0],y:r.coordinate[1],state:e.state},e.resource.EipResource&&(u.hasEip=!0,u.eipData={id:e.resource.EipResource.uid,allocationId:e.resource.EipResource.resource.AllocationId}),r.osType&&r.architecture&&r.rootDeviceType&&(r.osType==="win"&&(r.osType="windows"),u.cachedAmi={osType:r.osType,architecture:r.architecture,rootDeviceType:r.rootDeviceType}),h=new s(u),f=MC.extractID(e.resource.KeyName),f&&f!==e.resource.KeyName&&(o=i(f)),o?o.assignTo(h):e.resource.KeyName||e.resource.KeyName===""?h.set("keyName",e.resource.KeyName):_.defer(function(){return t.modelClassForType(n.RESTYPE.KP).getDefaultKP().assignTo(h)}),null}}),s}),define("wspace/awseditor/model/connection/SgAsso",["constant","ConnectionModel","Design"],function(e,t,n){var r;return r=t.extend({type:"SgAsso",isVisual:function(){return!0},assignCompsToPorts:function(t,n){if(t.type===e.RESTYPE.SG)this.__port1Comp=t,this.__port2Comp=n;else{if(n.type!==e.RESTYPE.SG)return!1;this.__port1Comp=n,this.__port2Comp=t}return!0},remove:function(){var i,s;t.prototype.remove.apply(this,arguments),s=this.getOtherTarget(e.RESTYPE.SG);if(s.isRemoved())return;return s=this.getOtherTarget(e.RESTYPE.SG),s.connections("SgAsso").length===0&&(i=n.modelClassForType(e.RESTYPE.SG).getDefaultSg(),i&&new r(s,i)),null},sortedSgList:function(){var t,n,r;return t=this.getOtherTarget(e.RESTYPE.SG),n=t.connections("SgAsso"),r=_.map(n,function(t){return t.getTarget(e.RESTYPE.SG)}),r.sort(function(e,t){var n,r;if(e.isDefault())return-1;if(t.isDefault())return 1;n=e.get("name"),r=t.get("name");if(n<r)return-1;if(n===r)return 0;if(n>r)return 1})}}),r});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/model/EniModel",["ComplexResModel","Design","./connection/SgAsso","./connection/EniAttachment","constant","i18n!/nls/lang.js"],function(e,t,n,r,i,s){var o,u;return o=function(e){e||(e={}),e.ip=e.ip||"";if(e.ip.split(".").length!==4||e.ip[e.ip.length-1]===".")e.ip="";return this.hasEip=e.hasEip||!1,this.autoAssign=e.autoAssign!==void 0?e.autoAssign:!0,this.ip=e.ip||"x.x.x.x",this.eipData=e.eipData||{id:MC.guid()},this.fixedIpInApp=e.fixedIpInApp||!1,null},u=e.extend({defaults:function(){return{sourceDestCheck:!0,description:"",ips:[],assoPublicIp:!1,name:"eni"}},type:i.RESTYPE.ENI,constructor:function(t,n){return n&&n.instance&&(this.__embedInstance=n.instance),t.ips||(t.ips=[]),t.ips.length===0&&t.ips.push(new o),e.call(this,t,n)},initialize:function(e,r){var s;return r=r||{},r.createByUser&&!r.instance&&(s=t.modelClassForType(i.RESTYPE.SG).getDefaultSg(),n=t.modelClassForType("SgAsso"),new n(s,this)),r.cloneSource&&this.clone(r.cloneSource),null},clone:function(e){var t,n,r,i;this.cloneAttributes(e),i=this.get("ips");for(n=0,r=i.length;n<r;n++)t=i[n],t.ip="x.x.x.x",t.autoAssign=!0,t.eipData.id=this.design().guid();return null},groupMembers:function(){return this.__groupMembers||(this.__groupMembers=[]),this.__groupMembers},updateName:function(){return this.trigger("change:name"),this.trigger("change")},get:function(e){return e==="name"?this.getName():this.attributes[e]},getName:function(){var e;return this.__embedInstance?"eni0":(e=this.connections("EniAttachment")[0],e?"eni"+e.get("index"):"eni")},isReparentable:function(e){var t;return e.type===i.RESTYPE.SUBNET?e.parent()!==this.parent().parent()&&(t=!0):t=!0,t&&this.connectionTargets("EniAttachment").length>0?s.CANVAS.ERR_MOVE_ATTACHED_ENI:!0},isVisual:function(){return!this.__embedInstance},embedInstance:function(){return this.__embedInstance},attachedInstance:function(){var e,t;return e=this.__embedInstance,e||(t=this.connectionTargets("EniAttachment"),t.length&&(e=t[0])),e},serverGroupCount:function(){var e,t;return t=this.attachedInstance(),t&&(e=t.get("count")),e||1},maxIpCount:function(){var e,t;t=this.attachedInstance();if(t){e=t.getInstanceTypeConfig();if(e)return e.ip_per_eni}return 1},limitIpAddress:function(){var e,t;return e=this.attachedInstance(),e&&e.getInstanceTypeConfig()&&(t=this.maxIpCount(),this.get("ips").length>t&&(this.get("ips").length=t)),null},getCurrentEip:function(){var e;return t.instance().modeIsAppEdit()?(e=this,_.find(t.instance().opsModel().getJsonData().component,function(t){var n;return t.type==="AWS.EC2.EIP"?(n=t.resource.NetworkInterfaceId.match(/^@{([^\.]+)\..*/)[1],n===e.id):!1})):!1},setPrimaryEip:function(e,t){var n,r;if(!this.attachedInstance())return;r=this,this.get("ips")[0].hasEip=e;if(t&&typeof t!="string"&&t.get("publicIp"))this.get("ips")[0].eipData={id:MC.guid(),publicIp:t.get("publicIp"),allocationId:t.get("allocationId")};else{if(t==="old")return n=r.getCurrentEip(),this.attributes.ips[0].eipData={id:n.uid,publicIp:n.resource.PublicIp,allocationId:n.resource.AllocationId},null;t==="new"&&(n=r.getCurrentEip(),n&&(this.get("ips")[0].eipData={id:MC.guid()}))}return null},getPrimaryEip:function(){var e,t;return(e=this.get("ips"))!=null?(t=e[0])!=null?t.eipData:void 0:void 0},hasPrimaryEip:function(){return this.get("ips")[0].hasEip},hasEip:function(){return this.get("ips").some(function(e){return e.hasEip})},subnetCidr:function(){var e;return e=this.parent()||this.__embedInstance.parent(),void 0,e.get("cidr")||"10.0.0.1"},getIpArray:function(){var e,n,r,s,o,u,a,f,l,c,h;e=this.subnetCidr(),u=this.serverGroupCount()>1,f=t.modelClassForType(i.RESTYPE.SUBNET).genCIDRPrefixSuffix(e),o=[],h=this.get("ips");for(n=l=0,c=h.length;l<c;n=++l)r=h[n],a={hasEip:r.hasEip,autoAssign:r.autoAssign,editable:!(u||r.fixedIpInApp&&r.ip!=="x.x.x.x"),prefix:f[0]},a.autoAssign||u?a.suffix=f[1]:(s=r.ip.split("."),f[1]==="x.x"?a.suffix=s[2]+"."+s[3]:a.suffix=s[3]),a.ip=a.prefix+a.suffix,o.push(a);return o},getRealIp:function(e,n){var r,s,o;return e==="x.x.x.x"?e:(n||(n=this.subnetCidr()),n?(s=t.modelClassForType(i.RESTYPE.SUBNET).genCIDRPrefixSuffix(n),r=e.split("."),s[1]==="x.x"?o=s[0]+r[2]+"."+r[3]:o=s[0]+r[3],o):e)},isValidIp:function(e){var n,r,o,a,f,l,c,h,p,d,v,m;if(e.indexOf("x")!==-1)return!0;n=this.subnetCidr(),l=t.modelClassForType(i.RESTYPE.SUBNET).isIPInSubnet(e,n);if(!l.isValid)return l.isReserved?s.IDE.VALIDATION_IP_IN_SUBNET_REVERSED_RANGE:s.IDE.VALIDATION_IP_CONFLICTS_WITH_SUBNET_IP_RANGE;f=this.getRealIp(e,n),v=u.allObjects();for(c=0,p=v.length;c<p;c++){r=v[c];if(!r.attachedInstance())continue;m=r.attributes.ips;for(h=0,d=m.length;h<d;h++){o=m[h];if(o.autoAssign)continue;a=r.getRealIp(o.ip);if(a===f)return r===this?s.IDE.VALIDATION_IP_CONFLICTS_WITH_OTHER_IP:s.IDE.VALIDATION_IP_CONFLICTS_WITH_OTHER_NETWORK_INTERFACE_IP}}return!0},addIp:function(e,t,n,r){var i;return i=this.get("ips"),this.maxIpCount()<=i.length?!1:(t=new o({hasEip:!1,ip:"x.x.x.x",autoAssign:!0}),i=i.slice(0),i.push(t),this.set("ips",i),!0)},setIp:function(e,t,n,r){var i;return i=this.get("ips")[e],t!==void 0&&t!==null&&(i.ip=t),n!==void 0&&n!==null&&(i.autoAssign=n),r!==void 0&&r!==null&&r!==i.hasEip&&(i.hasEip=r,e===0&&(this.__embedInstance||this).trigger("change:primaryEip")),null},removeIp:function(e){var t;t=this.get("ips");if(t.length<=1||e===0)return;return t=t.slice(0),t.splice(e,1),this.set("ips",t),null},canAddIp:function(){var e,t,n,r,i;return e=this.attachedInstance(),e?(n=this.maxIpCount(),t=this.get("ips"),t.length>=n?sprintf(s.PROP.MSG_WARN_ENI_IP_EXTEND,e.get("instanceType"),n):(i=this.__embedInstance?this.__embedInstance.parent():this.parent(),r=!0,t.push({ip:"fake"}),i.getAvailableIPCountInSubnet()<=0&&(r="Ip count limit has reached in "+i.get("name")),t.length=t.length-1,r)):!1},connect:function(e){var n;if(e.type!=="EniAttachment")return;return this.limitIpAddress(),this.updateName(),n=t.modelClassForType(i.RESTYPE.SG),n.tryDrawLine(this),null},disconnect:function(e){var t,n,r,i,s;if(e.type!=="EniAttachment")return;this.attributes.name="eni",t={reason:e},s=this.connections("SgRuleLine");for(r=0,i=s.length;r<i;r++)n=s[r],n.remove(t);return null},ensureEnoughMember:function(){var e,t,n,r,i,s,o,u,a,f,l,c;n=this.attachedInstance();if(!n)return;e=n.get("count")-1,i=this.get("ips"),c=this.groupMembers();for(u=0,f=c.length;u<f;u++){o=c[u];while(o.ips.length<i.length)o.ips.push({autoAssign:!0,ip:"x.x.x.x",eipData:{id:MC.guid()}})}while(this.groupMembers().length<e){s=[];for(t=a=0,l=i.length;a<l;t=++a)r=i[t],s.push({autoAssign:!0,ip:"x.x.x.x",eipData:{id:MC.guid()}});this.groupMembers().push({id:MC.guid(),appId:"",forceAutoAssign:!0,ips:s})}return null},onParentChanged:function(e){var t,n,r,i,s,o;if(e){s=this.get("ips"),o=[];for(t=r=0,i=s.length;r<i;t=++r)n=s[t],o.push(this.setIp(t,null,!0,n.hasEip));return o}},generateJSON:function(e,t,n){var r,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x;m=[{}],this.ensureEnoughMember(),a=(t.instanceName||"")+this.get("name"),p=[],e===0?d={id:this.id,appId:this.get("appId"),ips:this.get("ips"),attachmentId:this.get("attachmentId")}:d=this.groupMembers()[e-1],x=this.get("ips");for(l=E=0,S=x.length;E<S;l=++E)h=x[l],f=h.hasEip,h=d.ips[l],void 0,t.number>1?r=!0:r=h.autoAssign,h.fixedIpInApp&&h.ip.indexOf("x")===-1&&(r=!1),p.push({PrivateIpAddress:this.getRealIp(h.ip),AutoAssign:r,Primary:!1}),f&&(u=h.eipData,m.push({uid:u.id||MC.guid(),type:i.RESTYPE.EIP,name:""+a+"-eip"+l,index:e,resource:{Domain:"vpc",InstanceId:"",AllocationId:u.allocationId||"",NetworkInterfaceId:this.createRef("NetworkInterfaceId",d.id),PrivateIpAddress:this.createRef("PrivateIpAddressSet."+l+".PrivateIpAddress",d.id),PublicIp:u.publicIp||""}}));return p[0].Primary=!0,y=this.__embedInstance?this.__embedInstance:this,g=_.map(y.connectionTargets("SgAsso"),function(e){return{GroupName:e.createRef("GroupName"),GroupId:e.createRef("GroupId")}}),t.instanceId?c=this.createRef("InstanceId",t.instanceId):c="",s="",this.__embedInstance?v=this.__embedInstance.parent():v=this.parent(),v.type===i.RESTYPE.SUBNET?(b=v.createRef("SubnetId"),w=v.parent().parent().createRef("VpcId"),s=v.parent()):s=v,o={index:e,uid:d.id,type:this.type,name:a,serverGroupUid:this.id,serverGroupName:this.get("name"),number:t.number||1,resource:{SourceDestCheck:this.get("sourceDestCheck"),Description:this.get("description"),NetworkInterfaceId:d.appId,AvailabilityZone:s.createRef(),VpcId:v.getVpcRef(),SubnetId:v.getSubnetRef(),AssociatePublicIpAddress:this.get("assoPublicIp"),PrivateIpAddressSet:p,GroupSet:g,Attachment:{InstanceId:c,DeviceIndex:n===void 0?"1":""+n,AttachmentId:d.attachmentId||""}}},m[0]=o,m},serialize:function(){var e,t,n,r;return r=[],this.__embedInstance||(n=this.generateLayout(),r[0]={layout:n}),this.attachedInstance()||(t=this.__embedInstance?0:1,e=this.generateJSON(0,{number:1},t),r[0]||(r[0]={}),r[0].component=e[0],e[1]&&r.push({component:e[1]})),r}},{handleTypes:[i.RESTYPE.ENI,i.RESTYPE.EIP],getAvailableIPInCIDR:function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k;r||(r=[0,1,2,3]),o=e.split("/"),a=o[0],T=Number(o[1]),S=32-T,f=a.split("."),l=f.map(function(e){return MC.leftPadString(parseInt(e).toString(2),8,"0")}),h=l.join(""),c=h.slice(0,T),d=h.slice(T).replace(/1/g,"0"),p=d.replace(/0/g,"1"),m=parseInt(d,2),v=parseInt(p,2),i=[],s=0,x=v-m+1,u=-1;for(N=C=m,k=v+1;m<=k?C<k:C>k;N=m<=k?++C:--C){u++,b=c+MC.leftPadString(N.toString(2),S,"0"),g=!0,__indexOf.call(r,u)>=0&&(g=!1),u===x-1&&(g=!1),y=_.map([0,8,16,24],function(e){var t;return t=parseInt(b.slice(e,e+8),2),t}),E=y.join("."),__indexOf.call(t,E)>=0&&(g=!1),w={ip:E,available:g},i.push(w),g&&s++;if(s>n)break;null}return void 0,i},getAvailableIPCountInCIDR:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p;return n=e.split("/"),r=n[0],p=Number(n[1]),h=32-p,i=r.split("."),s=i.map(function(e){return MC.leftPadString(parseInt(e).toString(2),8,"0")}),u=s.join(""),o=u.slice(0,p),f=u.slice(p).replace(/1/g,"0"),a=f.replace(/0/g,"1"),c=parseInt(f,2),l=parseInt(a,2),t=l-c+1-5,t<0&&(t=0),t},createServerGroupMember:function(e){var n,r,i,s,u,a,f;n=e.resource.Attachment||{},s={id:e.uid,appId:e.resource.NetworkInterfaceId,attachmentId:n.AttachmentId||"",ips:[]},f=e.resource.PrivateIpAddressSet||[];for(u=0,a=f.length;u<a;u++)r=f[u],i=new o({autoAssign:r.AutoAssign,ip:r.PrivateIpAddress,fixedIpInApp:t.instance().modeIsApp()||t.instance().modeIsAppView()}),r.EipResource&&(i.eipData={id:r.EipResource.uid,allocationId:r.EipResource.resource.AllocationId,publicIp:r.EipResource.resource.PublicIp}),s.ips.push(i);return s},deserialize:function(e,s,a){var f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;if(e.type===i.RESTYPE.EIP)return;if(e.serverGroupUid&&e.serverGroupUid!==e.uid){w=a(e.serverGroupUid).groupMembers();for(x=0,C=w.length;x<C;x++){b=w[x];if(b&&b.id===e.uid){void 0;return}}w[e.index-1]=this.createServerGroupMember(e);return}f=e.resource.Attachment,h=f&&(f.DeviceIndex==="0"||f.DeviceIndex===0),m=f&&f.InstanceId?a(MC.extractID(f.InstanceId)):null,l={id:e.uid,appId:e.resource.NetworkInterfaceId,description:e.resource.Description||e.description||"",sourceDestCheck:e.resource.SourceDestCheck,assoPublicIp:e.resource.AssociatePublicIpAddress,attachmentId:f?f.AttachmentId:"",ips:[],x:h?0:s.coordinate[0],y:h?0:s.coordinate[1]},A=e.resource.PrivateIpAddressSet||[];for(T=0,k=A.length;T<k;T++)g=A[T],c=t.instance().modeIsStack()?g.AutoAssign:!1,y=new o({autoAssign:c,ip:g.PrivateIpAddress,fixedIpInApp:t.instance().modeIsApp()||t.instance().modeIsAppView()}),g.EipResource&&(y.hasEip=!0,y.eipData={id:g.EipResource.uid,allocationId:g.EipResource.resource.AllocationId,publicIp:g.EipResource.resource.PublicIp}),l.ips.push(y);h?E={instance:m}:l.parent=a(s.groupUId),p=new u(l,E),S=p.embedInstance()||p,O=e.resource.GroupSet||[];for(N=0,L=O.length;N<L;N++)v=O[N],new n(S,a(MC.extractID(v.GroupId)));return m&&(h?m.setEmbedEni(p):(d=f&&f.DeviceIndex?f.DeviceIndex:1,new r(p,m,{index:d*1}))),null},postDeserialize:function(e,n){var r,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;r=e.resource.Attachment;if(!r)return;o=r.DeviceIndex==="0";if(!o)return;s=t.instance(),h=MC.extractID(r.InstanceId),c=s.component(h);if(c)return;u=s.component(e.uid);if(!u)return;void 0,u.remove(),a=this.createServerGroupMember(e),y=t.modelClassForType(i.RESTYPE.INSTANCE).allObjects();for(d=0,m=y.length;d<m;d++){c=y[d],b=c.groupMembers();for(l=v=0,g=b.length;v<g;l=++v){p=b[l];if(p.id===h){f=!0;break}}}if(!f){void 0;return}return c.getEmbedEni().groupMembers()[l]=a,null}}),u});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/model/VolumeModel",["i18n!/nls/lang.js","ComplexResModel","constant","CloudResources"],function(e,t,n,r){var i;return i=t.extend({defaults:{name:"",owner:null,volumeSize:1,snapshotId:"",appId:"",volumeType:"gp2",iops:"",encrypted:!1},type:n.RESTYPE.VOL,constructor:function(e,n){var r;return r=e.owner,delete e.owner,e.name||(e.name=this.getDeviceName(r)),e.name&&(t.call(this,e),this.attachTo(r,n)),n&&n.cloneSource&&this.clone(n.cloneSource),e.iops&&(e.volumeType="io1"),null},clone:function(e){return this.cloneAttributes(e,{reserve:"owner"}),null},isVisual:function(){return!1},isNameAvailable:function(){return!0},isReparentable:function(t){var r;if(this.design().modeIsAppEdit()){r=this.get("owner");if(r.type!==t.type)return!1;if(!this.get("appId"))return!0;if(r.get("count")>1)return e.CANVAS.ERR_SERVERGROUP_VOLUME;if(t.get("count")>1)return e.CANVAS.ERR_SERVERGROUP_VOLUME2;while(r&&r.type!==n.RESTYPE.AZ)r=r.parent(),t=t.parent();if(r&&t&&r!==t)return e.IDE.VALIDATION_CANNOT_MOVE_VOLUME_ACROSS_AZ}return!0},groupMembers:function(){return this.__groupMembers||(this.__groupMembers=[]),this.__groupMembers},isRemovable:function(){return this.design().modeIsAppEdit()&&(this.get("owner")||{}).type===n.RESTYPE.LC?e.NOTIFY.WARN_OPERATE_NOT_SUPPORT_YET:!0},remove:function(){var e;return e=this.attributes.owner.get("volumeList"),e.splice(e.indexOf(this),1),this.attributes.owner.trigger("change:volumeList"),t.prototype.remove.call(this),null},genFullName:function(e){return this.get("name")[0]!=="/"?"xvd"+e:"/dev/"+e},getCost:function(e,t,r){var i,s,o,u,a,f,l,c,h,p,d,v,m;if(!e.ebs)return;u=this.get("owner");if(!u){void 0;return}if(!r&&this.get("owner").type!==n.RESTYPE.INSTANCE)return;f=this.get("volumeType")==="standard",m=e.ebs.types;for(h=0,d=m.length;h<d;h++)l=m[h],f?l.ebsVols&&(c=l.ebsVols):l.ebsPIOPSVols&&(c=l.ebsPIOPSVols);if(!c)return;i=this.get("owner").get("count")||1,o=u.get("name")+" - "+this.get("name"),i>1&&(o+=" (x"+i+")");for(p=0,v=c.length;p<v;p++){a=c[p];if(a.unit==="perGBmoProvStorage")return s=a[t],{resource:o,type:this.get("volumeSize")+"G",fee:s*this.get("volumeSize")*i,formatedFee:s+"/GB/mo"}}return null},attachTo:function(e,t){var n,r,i;if(!e)return!1;if(e===this.attributes.owner)return!1;n=this.attributes.owner,n&&(r=n.get("volumeList"),r.splice(r.indexOf(this),1),n.trigger("change:volumeList")),this.attributes.owner=e;if(!t||!t.noNeedGenName){this.attributes.name=this.getDeviceName(e);if(!this.attributes.name)return!1}return this.isSupportEncrypted()||(this.attributes.encrypted=!1),i=e.get("volumeList"),i?i.push(this):e.set("volumeList",[this]),e.trigger("change:volumeList"),!0},isSupportEncrypted:function(){var e,t,n,r;return r=["m3.medium","m3.large","m3.xlarge","m3.2xlarge","c3.large","c3.xlarge","c3.2xlarge","c3.4xlarge","c3.8xlarge","cr1.8xlarge","r3.large","r3.xlarge","r3.2xlarge","r3.4xlarge","r3.8xlarge","i2.xlarge","i2.2xlarge","i2.4xlarge","i2.8xlarge","g2.2xlarge"],t=this.attributes.owner,e=t.get("instanceType"),n=!1,__indexOf.call(r,e)>=0&&(n=!0),n},getDeviceName:function(t){var n,r,i,s;return i=t.get("imageId"),n=t.getAmi(),n?(r=null,n.osType!=="windows"?r=["f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","a","b","c","d","e"]:r=["f","g","h","i","j","k","l","m","n","o","p","r","s","t","u","v","w","x","y","z","a","b","c","d","e"],$.each(n.blockDeviceMapping||[],function(e,t){var n,i,s;s=/(sd|hd|xvd)(\w+)/i.exec(e);if(!s)return;i=s[2][0],n=r.indexOf(i);if(n>=0)return r.splice(n,1)}),s=t.get("volumeList"),s&&s.length>0&&$.each(s,function(e,t){var n,i,s;s=/(sd|hd|xvd)(\w+)/i.exec(t.get("name"));if(!s)return;i=s[2][0],n=r.indexOf(i);if(n>=0)return r.splice(n,1)}),r.length===0?(notification("warning",e.NOTIFY.WARN_ATTACH_VOLUME_REACH_INSTANCE_LIMIT,!1),null):(n.osType!=="windows"?r="/dev/sd"+r[0]:r="xvd"+r[0],r)):(n||notification("warning",sprintf(e.NOTIFY.WARN_AMI_NOT_EXIST_TRY_USE_OTHER,i),!1),null)},ensureEnoughMember:function(){var e;if(!this.get("owner"))return;e=this.get("owner").get("count");if(!e)return;e-=1;while(this.groupMembers().length<e)this.groupMembers().push({id:MC.guid(),appId:""});return null},generateJSON:function(e,t){var n,r,i,s,o,u;return void 0,this.ensureEnoughMember(),u=(t.instanceName||"")+this.get("name"),n="",e>0?(i=this.groupMembers()[e-1],o=i.id,n=i.appId):(o=this.id,n=this.get("appId")),r=this.createRef("InstanceId",t.instanceId),s=this.get("owner"),{uid:o,type:this.type,name:u,serverGroupUid:this.id,serverGroupName:this.get("name"),index:e,number:t.number||1,resource:{VolumeId:n,Size:this.get("volumeSize"),SnapshotId:this.get("snapshotId"),Iops:this.get("iops"),VolumeType:this.get("volumeType"),AvailabilityZone:s?s.getAvailabilityZone().createRef():"",AttachmentSet:{InstanceId:r,Device:this.get("device")||this.get("name")},Encrypted:this.get("encrypted")}}},serialize:function(){if(this.get("owner"))return;return{component:this.generateJSON(0,{number:1})}}},{handleTypes:n.RESTYPE.VOL,deserialize:function(e,t,n){var r,s,o,u,a,f,l,c,h;if(e.serverGroupUid&&e.serverGroupUid!==e.uid){f=n(e.serverGroupUid).groupMembers();for(c=0,h=f.length;c<h;c++){a=f[c];if(a&&a.id===e.uid){void 0;return}}f[e.index-1]={id:e.uid,appId:e.resource.VolumeId};return}return e.resource.AttachmentSet?(r=e.resource.AttachmentSet,u=r&&r.InstanceId?n(MC.extractID(r.InstanceId)):null,o=r.Device,!u||u.getAmiRootDeviceName()===r.Device?null:(s={id:e.uid,name:e.serverGroupName||e.name,owner:u,volumeSize:e.resource.Size,snapshotId:e.resource.SnapshotId,volumeType:e.resource.VolumeType,iops:e.resource.Iops,appId:e.resource.VolumeId,encrypted:e.resource.Encrypted,device:o},l=new i(s,{noNeedGenName:!0}),null)):(void 0,null)}}),i}),define("wspace/awseditor/model/AclModel",["ComplexResModel","ConnectionModel","constant"],function(e,t,n){var r,i,s,o,u;return o={Code:"",Type:""},u={From:"",To:""},r=t.extend({type:"AclAsso",oneToMany:n.RESTYPE.ACL,defaults:{associationId:""},serialize:function(e){var t,r;return r=this.getTarget(n.RESTYPE.SUBNET),t=this.getTarget(n.RESTYPE.ACL),e[t.id].resource.AssociationSet.push({NetworkAclAssociationId:this.get("associationId"),SubnetId:r.createRef("SubnetId")}),null}}),s=function(e){return!e||!e.length?[]:_.map(e,function(e){var t;return t={id:_.uniqueId("aclrule_"),cidr:e.CidrBlock,egress:e.Egress,protocol:parseInt(e.Protocol,10),number:parseInt(e.RuleNumber,10),action:e.RuleAction,port:""},e.PortRange||(e.PortRange={From:"",To:""}),t.protocol===1&&e.IcmpTypeCode&&e.IcmpTypeCode.Code&&e.IcmpTypeCode.Type?t.port=e.IcmpTypeCode.Type+"/"+e.IcmpTypeCode.Code:e.PortRange.From&&e.PortRange.To&&(e.PortRange.From===e.PortRange.To?t.port=e.PortRange.From+"":t.port=e.PortRange.From+"-"+e.PortRange.To),t})},i=e.extend({type:n.RESTYPE.ACL,newNameTmpl:"CustomACL-",defaults:function(){return{rules:[{action:"deny",cidr:"0.0.0.0/0",egress:!0,id:_.uniqueId("aclrule_"),number:32767,port:"",protocol:-1},{action:"deny",cidr:"0.0.0.0/0",egress:!1,id:_.uniqueId("aclrule_"),number:32767,port:"",protocol:-1}]}},isVisual:function(){return!1},isDefault:function(){return this.attributes.name==="DefaultACL"},remove:function(){var t,n,s,o,u;void 0,t=i.getDefaultAcl(),u=this.connectionTargets();for(s=0,o=u.length;s<o;s++)n=u[s],new r(t,n);return e.prototype.remove.call(this),null},addRule:function(e){var t,n,r,i;void 0,e.protocol=parseInt(e.protocol,10),e.number=parseInt(e.number,10),e.cidr=MC.getValidCIDR(e.cidr),t=this.get("rules");for(r=0,i=t.length;r<i;r++){n=t[r];if(n.number===e.number)return!1}return e.id=_.uniqueId("aclrule_"),t=t.slice(0),t.push(e),this.set("rules",t),!0},removeRule:function(e){var t,n,r,i,s,o;r=this.get("rules");for(t=s=0,o=r.length;s<o;t=++s){n=r[t];if(n.id===e){i=n;break}}return i.number===32767?!1:this.isDefault()&&i.number===100?!1:(r=r.slice(0),r.splice(t,1),this.set("rules",r),!0)},getRuleCount:function(){return this.get("rules").length},getAssoCount:function(){return this.connections().length},serialize:function(){var e,t,r,i,s,a,f,l,c;a=Design.modelClassForType(n.RESTYPE.VPC).theVPC(),s=[],e={name:this.get("name"),type:this.type,uid:this.id,resource:{AssociationSet:[],Default:this.isDefault(),EntrySet:s,NetworkAclId:this.get("appId"),VpcId:a.createRef("VpcId"),Tags:[{Key:"visops_default",Value:this.isDefault()?"true":"false"}]}},c=this.get("rules");for(f=0,l=c.length;f<l;f++)i=c[f],r={Egress:i.egress,Protocol:i.protocol,RuleAction:i.action,RuleNumber:i.number,CidrBlock:i.cidr,IcmpTypeCode:o,PortRange:u},i.protocol===1?(t=i.port.split("/"),r.IcmpTypeCode={Code:t[1],Type:t[0]}):i.port&&(t=(i.port+"-"+i.port).split("-"),r.PortRange={From:t[0],To:t[1]}),s.push(r);return{component:e}}},{handleTypes:n.RESTYPE.ACL,resolveFirst:!0,getDefaultAcl:function(){return _.find(i.allObjects(),function(e){return e.isDefault()})},preDeserialize:function(e,t){return new i({id:e.uid,name:e.resource.Default?"DefaultACL":e.name,appId:e.resource.NetworkAclId,rules:s(e.resource.EntrySet)}),null},deserialize:function(e,t,n){var i,s,o,u,a,f,l;i=n(e.uid),l=e.resource.AssociationSet||[];for(a=0,f=l.length;a<f;a++){s=l[a],s.NetworkAclAssociationId="",u=n(MC.extractID(s.SubnetId));if(!u)continue;o=new r(i,u),o.set("associationId",s.NetworkAclAssociationId)}return null}}),i}),define("wspace/awseditor/model/connection/LcUsage",["ConnectionModel","constant"],function(e,t){return e.extend({type:"LcUsage",remove:function(){var n;n=this.getOtherTarget(t.RESTYPE.ASG),e.prototype.remove.apply(this,arguments),n.connections("LcUsage").length===0&&n.remove()}})}),define("wspace/awseditor/model/AsgModel",["ResourceModel","ComplexResModel","Design","constant","i18n!/nls/lang.js","./connection/LcUsage","CanvasElement"],function(e,t,n,r,i,s,o){var u,a,f;return f=t.extend({type:r.RESTYPE.NC,isUsed:function(){return this.get("instanceLaunch")||this.get("instanceLaunchError")||this.get("instanceTerminate")||this.get("instanceTerminateError")||this.get("test")},initialize:function(){return n.modelClassForType(r.RESTYPE.TOPIC).ensureExistence(),null},isVisual:function(){return!1},getTopic:function(){return this.connectionTargets("TopicUsage")[0]},removeTopic:function(){var e;return(e=this.connections("TopicUsage")[0])!=null?e.remove():void 0},isEffective:function(){var e;return e=this.toJSON(),e.instanceLaunch||e.instanceLaunchError||e.instanceTerminate||e.instanceTerminateError||e.test},getTopicName:function(){var e;return(e=this.getTopic())!=null?e.get("name"):void 0},setTopic:function(e,t){var i;return i=n.modelClassForType(r.RESTYPE.TOPIC),i.get(e,t).assignTo(this)},serialize:function(){var e,t,n,r,i;if(!this.isUsed()||!this.get("asg"))return;r=this.getTopic(),n=[],i=f.typeMap;for(e in i)t=i[e],this.get(t)&&n.push(e);return{component:{name:"SnsNotification",type:this.type,uid:this.id,resource:{AutoScalingGroupName:this.get("asg").createRef("AutoScalingGroupName"),TopicARN:r&&r.createRef("TopicArn")||"",NotificationType:n}}}}},{handleTypes:r.RESTYPE.NC,typeMap:{"autoscaling:EC2_INSTANCE_LAUNCH":"instanceLaunch","autoscaling:EC2_INSTANCE_LAUNCH_ERROR":"instanceLaunchError","autoscaling:EC2_INSTANCE_TERMINATE":"instanceTerminate","autoscaling:EC2_INSTANCE_TERMINATE_ERROR":"instanceTerminateError","autoscaling:TEST_NOTIFICATION":"test"},deserialize:function(e,t,n){var r,i,s,o,u,a,l,c;i={id:e.uid},l=e.resource.NotificationType;for(u=0,a=l.length;u<a;u++)o=l[u],i[f.typeMap[o]]=!0;return s=new f(i),r=n(MC.extractID(e.resource.AutoScalingGroupName)),r&&(r.set("notification",s),s.set("asg",r)),(c=n(MC.extractID(e.resource.TopicARN)))!=null&&c.assignTo(s),null}}),u=t.extend({type:"ExpandedAsg",defaults:{originalAsg:null},constructor:function(e,n){var r,i,s,o,u;void 0,r=e.originalAsg,u=[r].concat(r.get("expandedList"));for(s=0,o=u.length;s<o;s++){i=u[s];if(e.parent===i.parent())return}return t.call(this,e,n),null},isReparentable:function(e){var t,n,r,i,s;t=this.attributes.originalAsg,s=[t].concat(t.get("expandedList"));for(r=0,i=s.length;r<i;r++){n=s[r];if(n!==this&&e===n.parent())return!1}return!0},initialize:function(){var e;return void 0,this.get("originalAsg").get("expandedList").push(this),(e=this.getLc())!=null&&e.trigger("change:expandedList",this),null},remove:function(){var e,n;return e=this.get("originalAsg").get("expandedList"),e.splice(e.indexOf(this),1),(n=this.getLc())!=null&&n.trigger("change:expandedList",this),t.prototype.remove.call(this)},getLc:function(){return this.attributes.originalAsg.getLc()},serialize:function(){var e;return e=this.generateLayout(),e.type="ExpandedAsg",e.originalId=this.get("originalAsg").id,{layout:e}}},{handleTypes:"ExpandedAsg",deserialize:function(e,t,n){var r;r=n(t.originalId);if(!r){void 0;return}return new u({id:e.uid,originalAsg:r,parent:n(t.groupUId),x:t.coordinate[0],y:t.coordinate[1]}),null}}),a=t.extend({defaults:function(){return{cooldown:"300",capacity:"1",minSize:"1",maxSize:"2",healthCheckGracePeriod:"300",healthCheckType:"EC2",terminationPolicies:["Default"],expandedList:[],policies:[]}},type:r.RESTYPE.ASG,newNameTmpl:"asg",isReparentable:function(e){var t,n,r,s;s=this.get("expandedList");for(n=0,r=s.length;n<r;n++){t=s[n];if(e.parent()===t.parent().parent())return sprintf(i.CANVAS.ERR_DROP_ASG,this.get("name"),e.parent().get("name"))}return!0},setName:function(e){var n,r,i,s;t.prototype.setName.call(this,e),s=this.get("expandedList");for(r=0,i=s.length;r<i;r++)n=s[r],n.trigger("change:name");return null},setLc:function(e){if(this.getLc()||!e)return;return _.isString(e)&&(e===r.RESTYPE.MESOSLC?e=this.createMesosLc():e=this.design().component(e)),new s(this,e)},createMesosLc:function(){var e,t,i;return e=n.modelClassForType(r.RESTYPE.MESOSLC),i=this.design().region(),t={parent:this,imageId:_.findWhere(r.MESOS_AMI_IDS,{region:i}).imageId},o.createResource(r.RESTYPE.MESOSLC,t,{createByUser:!0})},getLc:function(){return this.connectionTargets("LcUsage")[0]},getCost:function(e,t){var i,s,o,u,a,f,l,c,h;s=this.getLc();if(!s)return null;i=n.modelClassForType(r.RESTYPE.INSTANCE),u=i.prototype.getCost.call(s,e,t);if(!u)return null;u.length&&(u=u[0]),u.resource=this.get("name"),o=u.fee,f=s.get("volumeList");if(f&&f.length)for(c=0,h=f.length;c<h;c++)a=f[c],l=a.getCost(e,t,!0),l&&(o+=l.fee);return u.fee!==o&&(u.resource+=" (& volumes)",u.fee=o),u.type=parseInt(this.get("capacity")||this.get("minSize"),10),u.fee*=u.type,u.fee=Math.round(u.fee*100)/100,u.formatedFee=u.fee+"/mo",u},getTagModel:function(){return n.modelClassForType(r.RESTYPE.ASGTAG).getCustom()},getNotification:function(){var e;return((e=this.get("notification"))!=null?e.toJSON():void 0)||{}},getNotiObject:function(){return this.get("notification")},setNotification:function(e){var t;return t=this.get("notification"),t?t.set(e):(e.asg=this,t=new f(e),this.set("notification",t)),t},setNotificationTopic:function(e,t){var n;return(n=this.get("notification"))!=null?n.setTopic(e,t):void 0},getNotificationTopicName:function(){var e;return(e=this.get("notification"))!=null?e.getTopicName():void 0},addScalingPolicy:function(e){return e.__asg=this,this.get("policies").push(e),this.listenTo(e,"destroy",this.__removeScalingPolicy),null},__removeScalingPolicy:function(e){return this.stopListening(e),this.get("policies").splice(this.get("policies").indexOf(e),1),null},isEC2HealthCheckType:function(){var e;return e=this.getLc(),e&&e.connections("ElbAmiAsso").length&&this.get("healthCheckType")==="ELB"?!1:!0},remove:function(){var e,n,r,i,s,o,u,a,f;u=this.get("expandedList");for(r=0,s=u.length;r<s;r++)e=u[r],e.remove();a=this.get("policies");for(i=0,o=a.length;i<o;i++)n=a[i],n.off(),n.remove();return(f=this.get("notification"))!=null&&f.remove(),t.prototype.remove.call(this),null},getExpandSubnets:function(){var e,t,n,r,i;t=[this.parent()],i=this.get("expandedList");for(n=0,r=i.length;n<r;n++)e=i[n],t.push(e.parent());return t},getExpandAzs:function(){var e,t,n,r,i;e=[],i=this.getExpandSubnets();for(n=0,r=i.length;n<r;n++)t=i[n],e.push(t.parent());return _.uniq(e)},serialize:function(){var e,t,n,r,i,s,o;return o=this.getExpandSubnets(),e=_.uniq(_.map(o,function(e){return e.parent().createRef()})),o=_.map(o,function(e){return e.createRef("SubnetId")}),s=this.getLc(),s&&(r=s.connectionTargets("ElbAmiAsso"),r.length&&(i=this.get("healthCheckType"),n=_.map(r,function(e){return e.createRef("LoadBalancerName")}))),t={uid:this.id,name:this.get("name"),description:this.get("description")||"",type:this.type,resource:{AvailabilityZones:e,VPCZoneIdentifier:o.join(" , "),LoadBalancerNames:n||[],AutoScalingGroupARN:this.get("appId"),DefaultCooldown:this.get("cooldown"),MinSize:this.get("minSize"),MaxSize:this.get("maxSize"),HealthCheckType:i||"EC2",HealthCheckGracePeriod:this.get("healthCheckGracePeriod"),TerminationPolicies:this.get("terminationPolicies"),AutoScalingGroupName:this.get("groupName")||this.get("name"),DesiredCapacity:this.get("capacity"),LaunchConfigurationName:(s!=null?s.createRef("LaunchConfigurationName"):void 0)||""}},{component:t,layout:this.generateLayout()}}},{handleTypes:r.RESTYPE.ASG,deserialize:function(e,t,r){var i,o,u,f,l,c,h,p;o=new a({id:e.uid,name:e.name,description:e.description||"",appId:e.resource.AutoScalingGroupARN,parent:r(MC.extractID(t.groupUId)),cooldown:String(e.resource.DefaultCooldown),capacity:String(e.resource.DesiredCapacity),minSize:String(e.resource.MinSize),maxSize:String(e.resource.MaxSize),healthCheckType:e.resource.HealthCheckType,healthCheckGracePeriod:String(e.resource.HealthCheckGracePeriod),terminationPolicies:e.resource.TerminationPolicies,groupName:e.resource.AutoScalingGroupName,x:t.coordinate[0],y:t.coordinate[1]});if(e.resource.LaunchConfigurationName){l=r(MC.extractID(e.resource.LaunchConfigurationName)),new s(o,l),i=n.modelClassForType("ElbAmiAsso"),p=e.resource.LoadBalancerNames||[];for(c=0,h=p.length;c<h;c++)f=p[c],u=r(MC.extractID(f)),new i(l,u)}return null}}),a}),define("wspace/awseditor/model/AzModel",["GroupModel","constant","i18n!/nls/lang.js","Design"],function(e,t,n,r){var i;return i=e.extend({type:t.RESTYPE.AZ,isRemovable:function(){return _.some(this.children(),function(e){return e.connections("SubnetgAsso").length>0})?{error:n.IDE.RDS_MSG_ERR_REMOVE_AZ_FAILED_CAUSEDBY_CHILD_USEDBY_SBG}:this.children().length>0?sprintf(n.CANVAS.CVS_CFM_DEL_GROUP,this.get("name")):!0},createRef:function(){return i.__super__.createRef("ZoneName",!0,this.id)},getAvailableIPCountInSubnet:function(e){var n,i,s,o,u,a,f;if(!e)return!0;s=0,f=this.children();for(u=0,a=f.length;u<a;u++){n=f[u];if(n.type===t.RESTYPE.INSTANCE)i=n.getEmbedEni();else{if(n.type!==t.RESTYPE.ENI)continue;i=n}s+=i.get("ips").length*i.serverGroupCount()}return o=r.modelClassForType(t.RESTYPE.ENI).getAvailableIPCountInCIDR(e),o-s},serialize:function(){var e,t;return t=this.get("name"),e={uid:this.id,name:t,type:this.type,resource:{ZoneName:t,RegionName:t.substring(0,t.length-1)}},{layout:this.generateLayout(),component:e}}},{handleTypes:t.RESTYPE.AZ,deserialize:function(e,t,n){var s;return r.instance().modeIsStack()||(s=e.name),new i({id:e.uid,name:e.name,appId:s,parent:n(t.groupUId),x:t.coordinate[0],y:t.coordinate[1],width:t.size[0],height:t.size[1]}),null},getAzByName:function(e){var t,n,r,s;s=i.allObjects();for(n=0,r=s.length;n<r;n++){t=s[n];if(t.get("name")===e)return t}return null}}),i}),define("wspace/awseditor/model/CgwModel",["ComplexResModel","Design","constant"],function(e,t,n){var r;return r=e.extend({defaults:{bgpAsn:""},newNameTmpl:"customer-gateway-",type:n.RESTYPE.CGW,isDynamic:function(){return!!this.get("bgpAsn")},serialize:function(){var e;return e={name:this.get("name"),description:this.get("description")||"",type:this.type,uid:this.id,resource:{CustomerGatewayId:this.get("appId"),BgpAsn:this.get("bgpAsn"),Type:"ipsec.1",IpAddress:this.get("ip")}},{component:e,layout:this.generateLayout()}}},{handleTypes:n.RESTYPE.CGW,deserialize:function(e,t,n){return new r({id:e.uid,name:e.name,description:e.description||"",appId:e.resource.CustomerGatewayId,bgpAsn:e.resource.BgpAsn,ip:e.resource.IpAddress,x:t.coordinate[0],y:t.coordinate[1]})}}),r}),define("wspace/awseditor/model/connection/SgRuleSet",["constant","ConnectionModel","Design"],function(e,t,n){var r;return r=t.extend({type:"SgRuleSet","default":{in1:null,out1:null,in2:null,out2:null},initialize:function(){var e;return this.port1Comp().type==="SgIpTarget"&&(e=this.port2Comp(),this.__port2Comp=this.__port1Comp,this.__port1Comp=e),this.attributes.in1=[],this.attributes.out1=[],this.port1Comp()===this.port2Comp()?(this.attributes.in2=this.attributes.in1,this.attributes.out2=this.attributes.out1):(this.attributes.in2=[],this.attributes.out2=[]),null},ruleCount:function(e){return e===this.port1Comp().id||e===this.port1Comp().get("name")?this.attributes.in1.length+this.attributes.out1.length:this.attributes.in2.length+this.attributes.out2.length},toPlainObjects:function(e,t){var n,i,s,o,u,a,f,l,c,h,p;o=[{ary:this.attributes.in1,direction:r.DIRECTION.IN,relation:this.port2Comp(),owner:this.port1Comp()},{ary:this.attributes.out1,direction:r.DIRECTION.OUT,relation:this.port2Comp(),owner:this.port1Comp()}],this.port1Comp()!==this.port2Comp()&&!this.getTarget("SgIpTarget")&&(o.push({ary:this.attributes.in2,direction:r.DIRECTION.IN,relation:this.port1Comp(),owner:this.port2Comp()}),o.push({ary:this.attributes.out2,direction:r.DIRECTION.OUT,relation:this.port1Comp(),owner:this.port2Comp()})),a=[];for(f=0,c=o.length;f<c;f++){s=o[f];if(e)if(_.isString(e)){if(s.owner.id!==e&&s.owner.get("name")!==e)continue}else if(!e(s.owner))continue;p=s.ary;for(l=0,h=p.length;l<h;l++)u=p[l],u.protocol==="icmp"?i=u.fromPort+"/"+u.toPort:u.fromPort===u.toPort||!u.toPort?i=u.fromPort:i=u.fromPort+"-"+u.toPort,n={ruleSetId:this.id,port:i,protocol:u.protocol,direction:s.direction,relation:s.relation.get("name"),color:s.relation.color},t&&(n.relationId=s.relation.id,n.ownerId=s.owner.id),a.push(n)}return a},hasRawRuleTo:function(e){return void 0,e===this.port1Comp()?this.attributes.in1.length>0||this.attributes.out2.length>0:this.attributes.in2.length>0||this.attributes.out1.length>0},addRawRule:function(t,i,s){var o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;void 0,void 0,void 0,E=this.get("in1").length+this.get("in2").length+this.get("out1").length+this.get("out2").length===0,l=this.get("in1").length,h=this.get("in2").length,c=this.get("out1").length,p=this.get("out2").length,w={protocol:s.protocol,fromPort:""+s.fromPort,toPort:""+s.toPort},""+w.protocol=="-1"||w.protocol==="all"?(w.protocol="all",w.fromPort="0",w.toPort="65535"):parseInt(s.protocol,10)+""===s.protocol&&(w.fromPort="",w.toPort=""),w.fromPort===w.toPort&&w.protocol!=="icmp"&&(w.toPort=""),m=t===this.port1Comp().id||t===this.port1Comp().get("name");if(!m&&this.getTarget("SgIpTarget")){void 0;return}switch(i){case r.DIRECTION.IN:b=[m?"in1":"in2"];break;case r.DIRECTION.OUT:b=[m?"out1":"out2"];break;case r.DIRECTION.BIWAY:b=[m?"in1":"in2",m?"out1":"out2"]}for(S=0,C=b.length;S<C;S++){y=b[S],a=!1,g=this.get(y);for(x=0,k=g.length;x<k;x++){f=g[x];if(f.fromPort===w.fromPort&&f.toPort===w.toPort&&f.protocol===w.protocol){a=!0;break}}a||(g=g.slice(0),g.push(w),this.set(y,g))}if(E)d=this.port1Comp(),v=this.port2Comp(),d!==v&&d.type!=="SgIpTarget"&&v.type!=="SgIpTarget"&&d.vlineAddBatch(v);else{o=n.modelClassForType(e.RESTYPE.SG);if(l+p===0&&this.get("in1").length+this.get("out2").length>0){O=this.port1Comp().connectionTargets("SgAsso");for(T=0,L=O.length;T<L;T++)u=O[T],u.type===e.RESTYPE.ELB&&o.tryDrawLine(u)}if(h+c===0&&this.get("in2").length+this.get("out1").length>0){M=this.port2Comp().connectionTargets("SgAsso");for(N=0,A=M.length;N<A;N++)u=M[N],u.type===e.RESTYPE.ELB&&o.tryDrawLine(u)}}return null},addRule:function(e,t,n){var i;void 0,e===this.port1Comp().id||e===this.port1Comp().get("name")?i=this.port2Comp().id:(e=this.port2Comp().id,i=this.port1Comp().id);if(t===r.DIRECTION.IN||t===r.DIRECTION.BIWAY)this.addRawRule(e,r.DIRECTION.IN,n),this.addRawRule(i,r.DIRECTION.OUT,n);if(t===r.DIRECTION.OUT||t===r.DIRECTION.BIWAY)this.addRawRule(e,r.DIRECTION.OUT,n),this.addRawRule(i,r.DIRECTION.IN,n);return null},removeRawRule:function(t,i,s){var o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H;void 0,void 0,void 0,c=this.get("in1").length,p=this.get("in2").length,h=this.get("out1").length,d=this.get("out2").length,s.protocol==="-1"&&(s.protocol="all"),s.fromPort===s.toPort&&(s.toPort=""),v=t===this.port1Comp().id||t===this.port1Comp().get("name");switch(i){case r.DIRECTION.IN:y=[v?"in1":"in2"];break;case r.DIRECTION.OUT:y=[v?"out1":"out2"];break;case r.DIRECTION.BIWAY:y=[v?"in1":"in2",v?"out1":"out2"]}f=!1;for(w=0,T=y.length;w<T;w++){g=y[w],m=this.get(g);for(l=E=0,N=m.length;E<N;l=++E){a=m[l];if(a.fromPort===s.fromPort&&a.toPort===s.toPort&&a.protocol===s.protocol){m=m.slice(0),m.splice(l,1),f=!0,this.set(g,m);break}}}if(this.get("in1").length+this.get("in2").length+this.get("out1").length+this.get("out2").length===0)this.remove();else{o=n.modelClassForType(e.RESTYPE.SG);if(this.get("in1").length+this.get("out2").length===0&&c+d>0){_=this.port1Comp().connectionTargets("SgAsso");for(S=0,C=_.length;S<C;S++){u=_[S];if(u.type===e.RESTYPE.ELB){D=u.connections("SgRuleLine");for(x=0,k=D.length;x<k;x++)b=D[x],b.validate()}}}if(this.get("in2").length+this.get("out1").length===0&&p+h>0){P=this.port2Comp().connectionTargets("SgAsso");for(O=0,L=P.length;O<L;O++){u=P[O];if(u.type===e.RESTYPE.ELB){H=u.connections("SgRuleLine");for(M=0,A=H.length;M<A;M++)b=H[M],b.validate()}}}}return void 0,null},removeRuleByPlainObj:function(e){var t,n;return void 0,void 0,void 0,e.relation===this.port1Comp().id||e.relation===this.port1Comp().get("name")?t=this.port2Comp().id:t=this.port1Comp().id,n=""+e.port,n.indexOf("/")>=0?n=n.split("/"):n=n.split("-"),e.fromPort=n[0],e.toPort=n[1]||"",this.removeRawRule(t,e.direction,e),null},serialize:function(e){var t,n,r,i,s,o,u,a,f,l,c,h;i=this.port1Comp(),o=this.port2Comp(),s=i.createRef("GroupId"),u=o.type==="SgIpTarget"?o.get("name"):o.createRef("GroupId"),n=[{ary:this.get("in1"),owner:e[i.id].resource.IpPermissions,target:u},{ary:this.get("out1"),owner:e[i.id].resource.IpPermissionsEgress,target:u}],o.type!=="SgIpTarget"&&i!==o&&(n.push({ary:this.get("in2"),owner:e[o.id].resource.IpPermissions,target:s}),n.push({ary:this.get("out2"),owner:e[o.id].resource.IpPermissionsEgress,target:s}));for(a=0,l=n.length;a<l;a++){t=n[a],h=t.ary;for(f=0,c=h.length;f<c;f++)r=h[f],r.protocol==="1"&&(r.protocol="icmp",r.fromPort="0",r.toPort="0"),t.owner.push({FromPort:r.fromPort,ToPort:r.toPort?r.toPort:r.fromPort,IpRanges:t.target,IpProtocol:r.protocol==="all"?"-1":r.protocol})}return null},remove:function(){t.prototype.remove.apply(this,arguments);if(this.getTarget("SgIpTarget"))return;this.port1Comp().isRemoved()?this.port2Comp().vlineRemoveBatch(this.port1Comp(),this):this.port1Comp().vlineRemoveBatch(this.port2Comp(),this)}},{getResourceSgRuleSets:function(e){var t,n,r,i,s,o,u,a,f,l;i={},r=[],f=e.connectionTargets("SgAsso");for(s=0,u=f.length;s<u;s++){n=f[s],l=n.connections("SgRuleSet");for(o=0,a=l.length;o<a;o++){t=l[o];if(i[t.id])continue;i[t.id]=!0,r.push(t)}}return r},getRelatedSgRuleSets:function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d;r={},h=e.connectionTargets("SgAsso");for(o=0,f=h.length;o<f;o++)s=h[o],r[s.id]=!0;n=[],p=t.connectionTargets("SgAsso");for(u=0,l=p.length;u<l;u++){s=p[u],d=s.connections("SgRuleSet");for(a=0,c=d.length;a<c;a++)i=d[a],r[i.getOtherTarget(s).id]&&n.push(i)}return _.uniq(n)},getPlainObjFromRuleSets:function(e){var t,n,r,i,s,o;n={},i=[];for(s=0,o=e.length;s<o;s++){t=e[s],r=t.direction+t.target+t.protocol+t.port;if(n[r])continue;n[r]=!0,i.push(t)}return i},getGroupedObjFromRuleSets:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d;a={};for(l=0,h=e.length;l<h;l++){u=e[l],s=u.getTarget("SgIpTarget");if(s&&!s.isClassicElbSg())continue;n=u.port1Comp(),i=n.id,a[i]||(a[i]={ownerId:i,ownerName:n.get("name"),ownerColor:n.color,rules:[]}),n=u.port2Comp(),i=n.id,a[i]||(a[i]={ownerId:i,ownerName:n.get("name"),ownerColor:n.color,rules:[]}),d=u.toPlainObjects(null,!0);for(c=0,p=d.length;c<p;c++)o=d[c],a[o.ownerId].rules.push(o)}t=[];for(f in a)r=a[f],r.rules.length&&t.push(r);return t.sort(function(e,t){return e.ownerName==="DefaultSG"?-1:t.ownerName==="DefaultSG"?1:e.ownerName<t.ownerName?-1:e.ownerName>t.ownerName?1:0})}}),r.DIRECTION={BIWAY:"biway",IN:"inbound",OUT:"outbound"},r}),define("wspace/awseditor/model/connection/SgLine",["constant","ConnectionModel","ResourceModel","i18n!/nls/lang.js"],function(e,t,n,r){var i;return i=t.extend({constructor:function(e,n,r,i){void 0;if(!this.assignCompsToPorts(e,n)||!this.isValid())return;return t.call(this,e,n,r,i)},isValid:function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x;l=this.port1Comp(),c=this.port2Comp(),t=e.RESTYPE;if(l.type===c.type&&l.type===t.AWS_ELB)return!1;n=this.getTarget(t.INSTANCE),o=this.getTarget(t.ENI);if(o){r=o.connectionTargets("EniAttachment");if(r.length===0)return!1;if(r.indexOf(n)>=0)return!1}u=this.getTarget("ExpandedAsg"),f=this.getTarget(t.LC);if(u&&f&&u.get("originalAsg").getLc()===f)return!1;i=this.getTarget(t.ELB);if(i){if(!i.get("internal"))return!1;s={},a=!1,E=i.connectionTargets("SgAsso");for(v=0,y=E.length;v<y;v++)p=E[v],s[p.id]=p;S=this.getOtherTarget(i).connectionTargets("SgAsso");for(m=0,b=S.length;m<b;m++){p=S[m],x=p.connections("SgRuleSet");for(g=0,w=x.length;g<w;g++){h=x[g],d=h.getOtherTarget(p);if(!s[d.id])continue;if(h.hasRawRuleTo(s[d.id])){a=!0;break}}if(a)break}if(!a)return!1}return!0},validate:function(){this.isValid()||this.remove({reason:"Validation Failed"})},isRemovable:function(){var e,t,n,r,i,s;e=Design.modelClassForType("SgRuleSet"),t=e.getRelatedSgRuleSets(this.port1Comp(),this.port2Comp()),r=e.getGroupedObjFromRuleSets(t);for(i=0,s=r.length;i<s;i++)n=r[i],n.content=MC.template.sgRuleList(n.rules);return MC.template.groupedSgRuleListDelConfirm(r)},remove:function(e){var n,r,i,s,o;t.prototype.remove.apply(this,arguments);if(e)return;if(this.port1Comp().isRemoved()||this.port2Comp().isRemoved())return;n=Design.modelClassForType("SgRuleSet"),o=n.getRelatedSgRuleSets(this.port1Comp(),this.port2Comp());for(i=0,s=o.length;i<s;i++)r=o[i],r.remove();return null},silentRemove:function(){var e;return e=this.__view,e&&e.detach(),n.prototype.remove.apply(this,arguments),null},type:"SgRuleLine",defaults:{name:"Security Group Rule"},portDefs:[{port1:{name:"instance-sg",type:e.RESTYPE.INSTANCE},port2:{name:"instance-sg",type:e.RESTYPE.INSTANCE}},{port1:{name:"instance-sg",type:e.RESTYPE.INSTANCE},port2:{name:"eni-sg",type:e.RESTYPE.ENI}},{port1:{name:"instance-sg",type:e.RESTYPE.INSTANCE},port2:{name:"launchconfig-sg",type:e.RESTYPE.LC}},{port1:{name:"instance-sg",type:e.RESTYPE.INSTANCE},port2:{name:"launchconfig-sg",type:"ExpandedAsg"}},{port1:{name:"instance-sg",type:e.RESTYPE.INSTANCE},port2:{name:"elb-sg-in",type:e.RESTYPE.ELB}},{port1:{name:"instance-sg",type:e.RESTYPE.INSTANCE},port2:{name:"db-sg",type:e.RESTYPE.DBINSTANCE}},{port1:{name:"eni-sg",type:e.RESTYPE.ENI},port2:{name:"eni-sg",type:e.RESTYPE.ENI}},{port1:{name:"launchconfig-sg",type:e.RESTYPE.LC},port2:{name:"eni-sg",type:e.RESTYPE.ENI}},{port1:{name:"launchconfig-sg",type:"ExpandedAsg"},port2:{name:"eni-sg",type:e.RESTYPE.ENI}},{port1:{name:"elb-sg-in",type:e.RESTYPE.ELB},port2:{name:"eni-sg",type:e.RESTYPE.ENI}},{port1:{name:"launchconfig-sg",type:e.RESTYPE.LC},port2:{name:"launchconfig-sg",type:e.RESTYPE.LC}},{port1:{name:"launchconfig-sg",type:e.RESTYPE.LC},port2:{name:"launchconfig-sg",type:"ExpandedAsg"}},{port1:{name:"launchconfig-sg",type:e.RESTYPE.LC},port2:{name:"elb-sg-in",type:e.RESTYPE.ELB}},{port1:{name:"launchconfig-sg",type:e.RESTYPE.LC},port2:{name:"elb-sg-in",type:e.RESTYPE.ELB}},{port1:{name:"launchconfig-sg",type:"ExpandedAsg"},port2:{name:"elb-sg-in",type:e.RESTYPE.ELB}},{port1:{name:"db-sg",type:e.RESTYPE.DBINSTANCE},port2:{name:"db-sg",type:e.RESTYPE.DBINSTANCE}},{port1:{name:"db-sg",type:e.RESTYPE.DBINSTANCE},port2:{name:"eni-sg",type:e.RESTYPE.ENI}},{port1:{name:"db-sg",type:e.RESTYPE.DBINSTANCE},port2:{name:"launchconfig-sg",type:e.RESTYPE.LC}},{port1:{name:"db-sg",type:e.RESTYPE.DBINSTANCE},port2:{name:"launchconfig-sg",type:"ExpandedAsg"}},{port1:{name:"db-sg",type:e.RESTYPE.DBINSTANCE},port2:{name:"instance-sg",type:e.RESTYPE.INSTANCE}}]},{isConnectable:function(t,n){var i,s,o,u,a;s=t.type+">"+n.type;if(s.indexOf(e.RESTYPE.INSTANCE)!==-1&&s.indexOf(e.RESTYPE.ENI)!==-1){a=t.connectionTargets("EniAttachment");for(o=0,u=a.length;o<u;o++){i=a[o];if(i===n)return r.CANVAS.NETWORK_INTERFACE_ATTACHED_INTERFACE_NO_NEED_FOR_SG_RULE}}return!0}}),i}),define("wspace/awseditor/model/SgModel",["ComplexResModel","ResourceModel","./connection/SgRuleSet","./connection/SgLine","Design","constant"],function(e,t,n,r,i,s){var o,u,a;return u=["#f26c4f","#7dc476","#00bef2","#615ca8","#fcec00","#ff9900","#ffcc00","#ffcc99","#ff99ff","#00cccc","#99cc99","#9999ff","#ffff99","#ff00ff","#663300","#336600","#660066","#003300","#0000ff","#666600"],a=e.extend({type:"SgIpTarget",constructor:function(e){var t,n,r,s;t=i.instance().classCacheForCid(this.classId);for(r=0,s=t.length;r<s;r++){n=t[r];if(n.attributes.name===e)return n}return t.push(this),Backbone.Model.call(this,{id:MC.guid(),name:e}),this},isClassicElbSg:function(){return this.attributes.name==="amazon-elb/amazon-elb-sg"},isVisual:function(){return!1}}),o=e.extend({type:s.RESTYPE.SG,newNameTmpl:"custom-sg-",color:"#f26c4f",defaults:{description:"Custom Security Group",groupName:""},initialize:function(e,t){var r,i;this.color=this.generateColor();if(!t||!t.isDeserialize)this.isElbSg()?(i=n.DIRECTION.IN,r={fromPort:"22",toPort:"",protocol:"tcp"}):(i=n.DIRECTION.OUT,r={fromPort:"0",toPort:"65535",protocol:"-1"}),(new n(this,this.createIpTarget("0.0.0.0/0"))).addRawRule(this.id,i,r);return null},isElbSg:function(){return this.get("isElbSg")},setAsElbSg:function(){return this.set("isElbSg",!0)},isDefault:function(){return this.attributes.name==="DefaultSG"},isVisual:function(){return!1},isMesos:function(){var e;return(e=this.attributes.name)==="MesosSG"||e==="MesosMaster"},isMesosBase:function(){return this.attributes.name==="MesosSG"},isMesosMaster:function(){return this.attributes.name==="MesosMaster"},createIpTarget:function(e){return new a(MC.getValidCIDR(e))},getNewName:function(){var e;return e=i.modelClassForType(this.type).allObjects(),t.prototype.getNewName.call(this,e.length-1)},ruleCount:function(){var e,t,n,r,i;e=0,i=this.connections("SgRuleSet");for(n=0,r=i.length;n<r;n++)t=i[n],e+=t.ruleCount(this.id);return e},getMemberList:function(){return _.filter(this.connectionTargets("SgAsso"),function(e){return e.type!=="ExpandedAsg"})},connect:function(e){return e.type==="SgAsso"&&this.vlineAdd(e.getOtherTarget(this)),null},disconnect:function(e){return e.type==="SgAsso"&&this.vlineRemove(e.getOtherTarget(this),void 0,e),null},vlineAdd:function(e){var t,n,i,s,o,u,a,f,l;if(this.design().initializing())return;t={},f=this.getVisualConnectedSg();for(s=0,u=f.length;s<u;s++){i=f[s],l=i.connectionTargets("SgAsso");for(o=0,a=l.length;o<a;o++){n=l[o];if(t[n.id])continue;e!==n&&new r(e,n),t[n.id]=!0}}return null},vlineAddBatch:function(e){var t,n,i,s,o,u,a,f;if(this.design().initializing())return;if(e===this)return;t=this.connectionTargets("SgAsso"),f=e.connectionTargets("SgAsso");for(s=0,u=f.length;s<u;s++){i=f[s];for(o=0,a=t.length;o<a;o++)n=t[o],n!==i&&new r(n,i)}return null},vlineRemove:function(e,t,n){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x;if(this.design().initializing())return;if(!t){t=[],w=this.getVisualConnectedSg();for(l=0,d=w.length;l<d;l++)a=w[l],t=t.concat(a.connectionTargets("SgAsso"))}s={},E=e.connectionTargets("SgAsso");for(c=0,v=E.length;c<v;c++){u=E[c],S=u.getVisualConnectedSg();for(h=0,m=S.length;h<m;h++){a=S[h],x=a.connectionTargets("SgAsso");for(p=0,g=x.length;p<g;p++)f=x[p],s[f.id]=!0}}for(b=0,y=t.length;b<y;b++){o=t[b];if(o===e)continue;i=r.findExisting(e,o),i&&(s[o.id]?i.validate():i.remove(n))}return null},vlineRemoveBatch:function(e,t){var n,r,i,s,o;if(this.design().initializing())return;n=e.connectionTargets("SgAsso"),o=this.connectionTargets("SgAsso");for(i=0,s=o.length;i<s;i++)r=o[i],this.vlineRemove(r,n,t);return null},getVisualConnectedSg:function(){var e,t,n,r,i;t=[],i=this.get("__connections");for(n=0,r=i.length;n<r;n++)e=i[n],e.type==="SgRuleSet"&&e.port1Comp()!==e.port2Comp()&&!e.getTarget("SgIpTarget")&&t.push(e.getOtherTarget(this));return t},generateColor:function(){var e,t,n,r,i,s,a,f;if(this.isDefault())return u[0];i={},f=o.allObjects();for(s=0,a=f.length;s<a;s++)r=f[s],i[r.color]=!0;n=1;while(n<u.length){e=u[n];if(!i[e]){t=e;break}++n}if(!t){t=Math.floor(Math.random()*16777215).toString(16);while(t.length<6)t="0"+t;t="#"+t}return t},serialize:function(){var e;return e={name:this.get("name"),type:this.type,uid:this.id,resource:{Default:this.isDefault(),GroupId:this.get("appId"),GroupName:this.get("groupName")||this.get("name"),GroupDescription:this.get("description"),VpcId:this.getVpcRef(),IpPermissions:[],IpPermissionsEgress:[],Tags:[{Key:"visops_default",Value:this.isDefault()?"true":"false"}]}},{component:e}}},{getDefaultSg:function(){return _.find(o.allObjects(),function(e){return e.isDefault()})},tryDrawLine:function(e,t){var n,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T;if(t){s={},w=t.connectionTargets("SgAsso");for(a=0,h=w.length;a<h;a++)u=w[a],s[u.id]=!0;E=e.connectionTargets("SgAsso");for(f=0,p=E.length;f<p;f++){u=E[f],S=u.getVisualConnectedSg();for(l=0,d=S.length;l<d;l++){n=S[l];if(s[n.id]){new r(e,t);return}}}}else{o=[],x=e.connectionTargets("SgAsso");for(c=0,v=x.length;c<v;c++){u=x[c],T=u.getVisualConnectedSg();for(y=0,m=T.length;y<m;y++)i=T[y],o=_.union(o,i.connectionTargets("SgAsso"))}for(b=0,g=o.length;b<g;b++)t=o[b],e!==t&&new r(e,t)}return null},updateSgLines:function(){var e,t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;t={},b=n.allObjects();for(p=0,m=b.length;p<m;p++){l=b[p],c=l.port1Comp(),h=l.port2Comp();if(c===h||c.type==="SgIpTarget"||h.type==="SgIpTarget")continue;o=c.connectionTargets("SgAsso"),w=h.connectionTargets("SgAsso");for(d=0,g=w.length;d<g;d++){a=w[d];for(v=0,y=o.length;v<y;v++){u=o[v];if(u.id===a.id)continue;u.id<a.id?s=u.id+"|"+a.id:s=a.id+"|"+u.id,e=t[s]||[],e[0]=u,e[1]=a,t[s]=e}}}for(i in t)f=t[i],new r(f[0],f[1],void 0,{detectDuplicate:!1});return null},handleTypes:s.RESTYPE.SG,deserialize:function(e,t,r){var i,s,u,f,l,c,h,p,d,v,m,g,y,b,w;u=new o({name:e.resource.Default?"DefaultSG":e.name,id:e.uid,appId:e.resource.GroupId,groupName:e.resource.GroupName,description:e.resource.GroupDescription},{isDeserialize:!0}),h=[];if(e.resource.IpPermissions){b=e.resource.IpPermissions;for(p=0,m=b.length;p<m;p++)f=b[p],h.push({rule:f})}if(e.resource.IpPermissionsEgress){w=e.resource.IpPermissionsEgress;for(d=0,g=w.length;d<g;d++)f=w[d],h.push({rule:f,out:!0})}for(v=0,y=h.length;v<y;v++){l=h[v],f=l.rule,f.IpRanges[0]==="@"?c=r(MC.extractID(f.IpRanges)):c=new a(f.IpRanges);if(!c)continue;i={fromPort:f.FromPort,toPort:f.ToPort,protocol:f.IpProtocol},s=l.out?n.DIRECTION.OUT:n.DIRECTION.IN,(new n(u,c)).addRawRule(u.id,s,i)}return null}}),i.on(i.EVENT.Deserialized,o.updateSgLines),o}),define("wspace/awseditor/model/SslCertModel",["constant","ComplexResModel","ConnectionModel"],function(e,t,n){var r,i;return i=n.extend({type:"SslCertUsage",oneToMany:e.RESTYPE.IAM}),r=t.extend({type:e.RESTYPE.IAM,defaults:{name:"v",body:"",chain:"",key:"",arn:"",certId:""},isVisual:function(){return!1},assignTo:function(e){return new i(this,e)},serialize:function(){var t,n,r;return n=this,r=!1,t=Design.modelClassForType(e.RESTYPE.ELB).allObjects(),_.each(t,function(e){return _.each(e.get("listeners"),function(e){return e.sslCert===n&&(r=!0),null}),null}),r?{component:{uid:this.id,type:"AWS.IAM.ServerCertificate",name:this.get("name"),resource:{PrivateKey:this.get("key"),CertificateBody:this.get("body"),CertificateChain:this.get("chain"),ServerCertificateMetadata:{ServerCertificateName:this.get("appName")||this.get("name"),Arn:this.get("arn")||"",ServerCertificateId:this.get("certId")||""}}}}:{}},updateValue:function(e){var t,n;for(t in e)n=e[t],this.set(t,n);return null}},{handleTypes:e.RESTYPE.IAM,deserialize:function(e){return new r({id:e.uid,name:e.name,body:e.resource.CertificateBody,chain:e.resource.CertificateChain,key:e.resource.PrivateKey,arn:e.resource.ServerCertificateMetadata.Arn,certId:e.resource.ServerCertificateMetadata.ServerCertificateId,appName:e.resource.ServerCertificateMetadata.ServerCertificateName}),null},createNew:function(t){var n,i,s;return i=null,s=Design.modelClassForType(e.RESTYPE.IAM).allObjects(),n=!0,_.each(s,function(e){return e.get("body")?e.remove():e.get("arn")===t.get("Arn")&&(n=!1,i=e),null}),n&&(i=new r({name:t.get("Name"),body:t.get("CertificateBody"),chain:t.get("CertificateChain"),key:t.get("PrivateKey"),arn:t.get("Arn"),certId:t.get("id")})),i}}),r}),define("wspace/awseditor/model/connection/ElbAsso",["constant","ConnectionModel","i18n!/nls/lang.js","Design"],function(e,t,n,r){var i,s;return s=t.extend({type:"ElbSubnetAsso",defaults:{deserialized:!1},portDefs:[{port1:{name:"elb-assoc",type:e.RESTYPE.ELB},port2:{name:"subnet-assoc-in",type:e.RESTYPE.SUBNET}}],initialize:function(){var t,n,r,i,s,o;r=this.getTarget(e.RESTYPE.SUBNET),t=r.parent(),o=this.getTarget(e.RESTYPE.ELB).connections("ElbSubnetAsso");for(i=0,s=o.length;i<s;i++)n=o[i],n.getTarget(e.RESTYPE.SUBNET).parent()===t&&(n.hasAppUpdateRestriction()?this.setDestroyAfterInit():n.remove());return null},hasAppUpdateRestriction:function(){var t,n,r,i,s;n=this.getTarget(e.RESTYPE.ELB);if(this.design().modeIsAppEdit()&&this.get("deserialized")){s=n.connections("ElbSubnetAsso");for(r=0,i=s.length;r<i;r++){t=s[r];if(t!==this&&t.get("deserialized"))return!1}return!0}return!1},isRemovable:function(){var t,r,i,s,o,u,a,f,l,c,h,p,d;if(this.design().modeIsAppEdit()&&this.hasAppUpdateRestriction())return{error:n.CANVAS.ERR_DEL_ELB_LINE_2};o=this.getTarget(e.RESTYPE.ELB),a=this.getTarget(e.RESTYPE.SUBNET),t=a.parent(),p=o.connectionTargets("ElbAmiAsso");for(f=0,c=p.length;f<c;f++){r=p[f],i=r.parent();while(i){if(i.type===e.RESTYPE.AZ)break;i=i.parent()}if(!i)continue;if(i===t){s=!0;break}}if(!s)return!0;d=o.connectionTargets("ElbSubnetAsso");for(l=0,h=d.length;l<h;l++){u=d[l];if(u!==a&&u.parent()===t){s=!1;break}}return s?{error:n.CANVAS.ERR_DEL_ELB_LINE_2}:!0}},{}),i=t.extend({type:"ElbAmiAsso",portDefs:[{port1:{name:"elb-sg-out",type:e.RESTYPE.ELB},port2:{name:"instance-sg",type:e.RESTYPE.INSTANCE}},{port1:{name:"elb-sg-out",type:e.RESTYPE.ELB},port2:{name:"launchconfig-sg",type:e.RESTYPE.LC}},{port1:{name:"elb-sg-out",type:e.RESTYPE.ELB},port2:{name:"launchconfig-sg",type:"ExpandedAsg"}}],initialize:function(t,n){var r,i,o,u,a,f,l,c;r=this.getOtherTarget(e.RESTYPE.ELB),o=this.getTarget(e.RESTYPE.ELB);if(r.type===e.RESTYPE.LC)this.listenTo(r,"change:expandedList",this.updateLcSubnetAsso),this.listenTo(r,"change:connections",this.updateLcSubnetAssoIfNeeded),n.createByUser&&this.updateLcSubnetAsso();else{i=o.connectionTargets("ElbSubnetAsso"),c=r.parent().parent().children();for(f=0,l=c.length;f<l;f++){a=c[f];if(i.indexOf(a)!==-1){u=!0;break}}u||new s(r.parent(),o)}},updateLcSubnetAssoIfNeeded:function(e){if(e.type==="LcUsage")return this.updateLcSubnetAsso()},updateLcSubnetAsso:function(){var t,n,r,i,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T;if(this.design().initializing())return;f=this.getTarget(e.RESTYPE.ELB),l=this.getTarget(e.RESTYPE.LC),u=l.design().componentsOfType(e.RESTYPE.AZ),i={};for(h=0,m=u.length;h<m;h++){r=u[h],o=r.get("name"),S=r.children();for(p=0,g=S.length;p<g;p++){c=S[p],x=c.connectionTargets("ElbSubnetAsso");for(d=0,y=x.length;d<y;d++){a=x[d];if(a===f){i[o]=!0;break}}if(i[o])break}}T=l.connectionTargets("LcUsage");for(v=0,b=T.length;v<b;v++){t=T[v],n=t.get("expandedList").slice(0),n.push(t);for(E=0,w=n.length;E<w;E++)t=n[E],o=t.parent().parent().get("name"),i[o]||(new s(t.parent(),f),i[o]=!0)}},serialize:function(t){var n,r,i,s,o,u,a;i=this.getTarget(e.RESTYPE.INSTANCE);if(!i)return;n=this.getTarget(e.RESTYPE.ELB),s=t[n.id].resource.Instances,a=i.getRealGroupMemberIds();for(o=0,u=a.length;o<u;o++)r=a[o],s.push({InstanceId:this.createRef("InstanceId",r)});return null}},{isConnectable:function(){return!0}}),null}),define("wspace/awseditor/model/ElbModel",["Design","constant","ResourceModel","ComplexResModel","./SgModel","./SslCertModel","./connection/SgAsso","i18n!/nls/lang.js","CloudResources","./connection/ElbAsso"],function(e,t,n,r,i,s,o,u,a){var f;return f=r.extend({defaults:function(){return{internal:!0,crossZone:!0,healthyThreshold:"9",unHealthyThreshold:"4",healthCheckTarget:"HTTP:80/index.html",healthCheckInterval:"30",healthCheckTimeout:"5",listeners:[{port:"80",protocol:"HTTP",instanceProtocol:"HTTP",instancePort:"80",sslCertName:null}],AvailabilityZones:[],ConnectionDraining:{Enabled:!0,Timeout:300},idleTimeout:60,otherPoliciesMap:{}}},type:t.RESTYPE.ELB,newNameTmpl:"load-balancer-",initialize:function(t,n){var r,s;return n.createByUser&&(s=new i({name:this.getElbSgName(),isElbSg:!0,description:u.IDE.AUTOMATICALLY_CREATED_SG_FOR_LOAD_BALANCER}),this.__elbSg=s,r=e.modelClassForType("SgAsso"),new r(this,s)),null},isRemovable:function(){var e;return e=this.getElbSg(),e&&e.connections("SgAsso").length>1?MC.template.ElbRemoveConfirmation({name:this.get("name"),sg:e.get("name")}):!0},remove:function(){return this.getElbSg()&&this.getElbSg().remove(),r.prototype.remove.call(this),null},getElbSg:function(){return this.__elbSg&&this.__elbSg.isRemoved()&&(this.__elbSg=void 0),this.__elbSg},getElbSgName:function(){return"elbsg-"+this.get("name")},setName:function(e){if(this.get("name")===e)return;return this.set("name",e),this.getElbSg()&&this.getElbSg().set("name",this.getElbSgName()),null},setListener:function(e,t){var n,r;return void 0,n=this.get("listeners"),e>=n.length?n.push(t):(n[e]||(n[e]={}),n[e]=$.extend(n[e],t)),(r=n[e].protocol)!=="HTTPS"&&r!=="SSL"&&(n[e].sslCert=null),null},removeListener:function(e){var t;return t=this.get("listeners"),t.splice(e,1),this.set("listeners",t),null},setSSLCert:function(e,n){var r,i,o;e>=0&&(i=a(this.design().credentialId(),t.RESTYPE.IAM,this.design().region()),r=this.get("listeners"),o=i.get(n),r[e].sslCert=s.createNew(o))},removeSSLCert:function(e){var t;return t=this.get("listeners"),t[e].sslCert=null,null},getSSLCert:function(e){var t;return t=this.get("listeners"),t[e].sslCert},getHealthCheckTarget:function(){var e,t,n,r,i;return i=this.attributes.healthCheckTarget,r=i.indexOf(":"),n=i.substring(0,r),i=i.substring(r+1),t=parseInt(i,10),isNaN(t)&&(t=80),e=i.replace(/[^\/]+\//,""),[n,t,e]},setHealthCheckTarget:function(e,t,n){var r;return r=this.getHealthCheckTarget(),e&&(r[0]=e),t!==void 0&&(r[1]=t),n!==void 0&&(r[2]=n),this.set("healthCheckTarget",r[0]+":"+r[1]+"/"+r[2]),null},setInternal:function(n){var r,s,o,u;this.set("internal",!!n);if(n)i=e.modelClassForType(t.RESTYPE.SG),i.tryDrawLine(this);else{u=this.connections("SgRuleLine");for(s=0,o=u.length;s<o;s++)r=u[s],r.remove(this)}return null},getCost:function(e,n){var r,i,s,o,u;if(!e.elb||!e.elb.types)return null;u=e.elb.types;for(s=0,o=u.length;s<o;s++){i=u[s];if(i.unit==="perELBHour"){r=parseFloat(i[n],10)||0;break}}if(r)return{resource:this.get("name"),type:t.RESTYPE.ELB,fee:r*24*30,formatedFee:r+"/hr"}},getAvailabilityZones:function(){var e;return e=_.map(this.connectionTargets("ElbSubnetAsso"),function(e){return e.parent().createRef()}),_.uniq(e)},setPolicyProxyProtocol:function(e,t){var n;return n=this.get("otherPoliciesMap"),e?n.EnableProxyProtocol={PolicyName:"EnableProxyProtocol",PolicyTypeName:"ProxyProtocolPolicyType",PolicyAttributes:{ProxyProtocol:!0},InstancePort:t}:delete n.EnableProxyProtocol,this.set("otherPoliciesMap",n)},serialize:function(){var e,t,n,r,i,s,o,u,a,f,l,c;t=this.get("healthCheckTarget");if(t.indexOf("TCP")!==-1||t.indexOf("SSL")!==-1)t=t.split("/")[0];i=[],c=this.get("listeners");for(f=0,l=c.length;f<l;f++)r=c[f],n="",(r.protocol==="SSL"||r.protocol==="HTTPS")&&r.sslCert&&(n=r.sslCert.createRef("ServerCertificateMetadata.Arn")),i.push({PolicyNames:"",Listener:{LoadBalancerPort:r.port,Protocol:r.protocol,InstanceProtocol:r.instanceProtocol,InstancePort:r.instancePort,SSLCertificateId:n}});return u=_.map(this.connectionTargets("SgAsso"),function(e){return e.createRef("GroupId")}),a=_.map(this.connectionTargets("ElbSubnetAsso"),function(e){return e.createRef("SubnetId")}),o=this.get("otherPoliciesMap"),s=_.map(o,function(e){return e}),s||(s=[]),e={type:this.type,uid:this.id,name:this.get("name"),description:this.get("description")||"",resource:{AvailabilityZones:[],Subnets:a,Instances:[],CrossZoneLoadBalancing:this.get("crossZone"),ConnectionDraining:this.get("ConnectionDraining"),VpcId:this.getVpcRef(),LoadBalancerName:this.get("elbName")||this.get("name"),SecurityGroups:u,Scheme:this.get("internal")?"internal":"internet-facing",ListenerDescriptions:i,HealthCheck:{Interval:String(this.get("healthCheckInterval")),Target:t,Timeout:String(this.get("healthCheckTimeout")),HealthyThreshold:String(this.get("healthyThreshold")),UnhealthyThreshold:String(this.get("unHealthyThreshold"))},DNSName:this.get("dnsName")||"",Policies:{LBCookieStickinessPolicies:[{PolicyName:"",CookieExpirationPeriod:""}],AppCookieStickinessPolicies:[{PolicyName:"",CookieName:""}],OtherPolicies:s},BackendServerDescriptions:[{InstantPort:"",PoliciyNames:""}],ConnectionSettings:{IdleTimeout:this.get("idleTimeout")||60}}},{component:e,layout:this.generateLayout()}}},{handleTypes:t.RESTYPE.ELB,deserialize:function(t,n,r){var i,s,u,a,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;a={id:t.uid,name:t.name,description:t.description||"",appId:t.resource.DNSName,parent:r(n.groupUId),internal:t.resource.Scheme==="internal",crossZone:!!t.resource.CrossZoneLoadBalancing,ConnectionDraining:t.resource.ConnectionDraining||{Enabled:!0,Timeout:300},listeners:[],dnsName:t.resource.DNSName,elbName:t.resource.LoadBalancerName,healthyThreshold:String(t.resource.HealthCheck.HealthyThreshold),unHealthyThreshold:String(t.resource.HealthCheck.UnhealthyThreshold),healthCheckTarget:t.resource.HealthCheck.Target,healthCheckInterval:String(t.resource.HealthCheck.Interval),healthCheckTimeout:String(t.resource.HealthCheck.Timeout),x:n.coordinate[0],y:n.coordinate[1],idleTimeout:((N=t.resource)!=null?(C=N.ConnectionSettings)!=null?C.IdleTimeout:void 0:void 0)||60,otherPoliciesMap:{}},t.resource.Policies&&t.resource.Policies.OtherPolicies&&_.each(t.resource.Policies.OtherPolicies,function(e){return a.otherPoliciesMap[e.PolicyName]=e,null}),a.AvailabilityZones=_.map(t.resource.AvailabilityZones||[],function(e){return e[0]==="@"?r(MC.extractID(e)).get("name"):e}),k=t.resource.ListenerDescriptions||[];for(c=g=0,E=k.length;g<E;c=++g)p=k[c],p=p.Listener,a.listeners.push({port:p.LoadBalancerPort,protocol:p.Protocol,instanceProtocol:p.InstanceProtocol,instancePort:p.InstancePort}),p.SSLCertificateId&&(m=r(MC.extractID(p.SSLCertificateId)),m&&(a.listeners[c].sslCert=m));l=new f(a),i=e.modelClassForType("ElbAmiAsso"),s=e.modelClassForType("ElbSubnetAsso"),L=t.resource.SecurityGroups||[];for(y=0,S=L.length;y<S;y++)v=L[y],new o(l,r(MC.extractID(v)));A=t.resource.Subnets||[];for(b=0,x=A.length;b<x;b++)d=A[b],new s(l,r(MC.extractID(d)),{deserialized:!0});O=t.resource.Instances||[];for(w=0,T=O.length;w<T;w++)u=O[w],h=r(MC.extractID(u.InstanceId)),h&&new i(l,h);return null},postDeserialize:function(t,n){var r,s,o,u,a,f;r=e.instance().component(t.uid),o=r.getElbSgName(),f=i.allObjects();for(u=0,a=f.length;u<a;u++){s=f[u];if(s.get("name")===o){r.__elbSg=s,s.setAsElbSg();return}}}}),f}),define("wspace/awseditor/model/LcModel",["ComplexResModel","./InstanceModel","Design","constant","./VolumeModel","i18n!/nls/lang.js","CloudResources"],function(e,t,n,r,i,s,o){var u,a;return a=[],u=e.extend({defaults:function(){return{imageId:"",ebsOptimized:!1,instanceType:"m1.small",monitoring:!1,userData:"",publicIp:!1,state:null,rdSize:0,rdIops:"",rdType:"gp2"}},type:r.RESTYPE.LC,newNameTmpl:"launch-config-",constructor:function(t,i){if(!i||!i.createBySubClass)if(u.isMesosSlave(t))return new(n.modelClassForType(r.RESTYPE.MESOSLC))(t,i);return e.apply(this,arguments)},initialize:function(e,t){var i;return t&&t.createByUser&&(this.initInstanceType(),n.modelClassForType(r.RESTYPE.KP).getDefaultKP().assignTo(this),this.isMesos()||(i=n.modelClassForType("SgAsso"),new i(n.modelClassForType(r.RESTYPE.SG).getDefaultSg(),this))),this.get("rdSize")||this.set("rdSize",this.getAmiRootDeviceVolumeSize()),null},getNewName:function(e){var t,i,s,u,a;if(!this.newNameTmpl)return s=this.defaults?this.defaults.name:void 0,s||"";e===void 0&&(e=this.getAllObjects().length),i={},this.design().eachComponent(function(e){return e.get("name")&&(i[e.get("name")]=!0),null});if(n.instance().modeIsAppEdit()){u=o(this.design().credentialId(),r.RESTYPE.LC,this.design().region()).toJSON();for(t in u)a=u[t],a.LaunchConfigurationName&&(i[_.first(a.LaunchConfigurationName.split("---"))]=!0)}for(;;){s=this.newNameTmpl+e;if(!i[s])break;e+=1}return s},isRemovable:function(){var e;return this.design().modeIsAppEdit()&&this.get("appId")?{error:s.CANVAS.ERR_DEL_LC}:(e=this.get("state"),e&&e.length>0?MC.template.NodeStateRemoveConfirmation({name:this.get("name")}):!0)},isPublic:function(){return this.get("publicIp")},isDefaultTenancy:function(){return!0},groupMembers:function(){var e,t,n,i,s,u,a,f;i=o(this.design().credentialId(),r.RESTYPE.ASG,this.design().region());if(!i)return[];n=(a=i.get(this.connectionTargets("LcUsage")[0].get("appId")))!=null?a.toJSON():void 0;if(n&&n.Instances&&n.Instances.length){e=[],f=n.Instances;for(s=0,u=f.length;s<u;s++)t=f[s],e.push({id:t.InstanceId,appId:t.InstanceId,state:t.HealthStatus})}return e||[]},getAsgs:function(){return this.connectionTargets("LcUsage")},getAsgsIncludeExpanded:function(){var e,t;return t=[],e=this.getAsgs(),_.each(e,function(e){return t=t.concat(e.get("expandedList"))}),t.concat(e)},remove:function(){var t,n,r,i;i=(this.get("volumeList")||a).slice(0);for(n=0,r=i.length;n<r;n++)t=i[n],t.remove();return e.prototype.remove.call(this),null},getStateData:t.prototype.getStateData,setStateData:t.prototype.setStateData,setKey:t.prototype.setKey,getKeyName:t.prototype.getKeyName,isDefaultKey:t.prototype.isDefaultKey,isNoKey:t.prototype.isNoKey,setAmi:t.prototype.setAmi,getAmi:t.prototype.getAmi,getOSFamily:t.prototype.getOSFamily,setInstanceType:t.prototype.setInstanceType,initInstanceType:t.prototype.initInstanceType,isEbsOptimizedEnabled:t.prototype.isEbsOptimizedEnabled,getBlockDeviceMapping:t.prototype.getBlockDeviceMapping,getAmiRootDevice:t.prototype.getAmiRootDevice,getAmiRootDeviceName:t.prototype.getAmiRootDeviceName,getAmiRootDeviceVolumeSize:t.prototype.getAmiRootDeviceVolumeSize,getInstanceType:t.prototype.getInstanceType,getInstanceTypeConfig:t.prototype.getInstanceTypeConfig,getInstanceTypeList:t.prototype.getInstanceTypeList,isMesos:t.prototype.isMesos,isMesosMaster:t.prototype.isMesosMaster,isMesosSlave:t.prototype.isMesosSlave,serialize:function(){var e,n,r,i,s,o,u,f,l;e=this.getAmi()||this.get("cachedAmi"),i=this.generateLayout(),e&&(i.osType=e.osType,i.architecture=e.architecture,i.rootDeviceType=e.rootDeviceType),n=this.getBlockDeviceMapping(),l=this.get("volumeList")||a;for(u=0,f=l.length;u<f;u++)o=l[u],s={DeviceName:o.get("name"),Ebs:{VolumeSize:o.get("volumeSize"),VolumeType:o.get("volumeType")}},o.get("volumeType")==="io1"&&(s.Ebs.Iops=o.get("iops")),o.get("snapshotId")&&(s.Ebs.SnapshotId=o.get("snapshotId")),n.push(s);return(t.isMesosMaster(this.attributes)||t.isMesosSlave(this.attributes))&&this.setMesosState(),r={type:this.type,uid:this.id,name:this.get("name"),description:this.get("description")||"",state:this.get("state"),resource:{UserData:this.get("userData"),LaunchConfigurationARN:this.get("appId"),InstanceMonitoring:this.get("monitoring"),ImageId:this.get("imageId"),KeyName:this.get("keyName"),EbsOptimized:this.isEbsOptimizedEnabled()?this.get("ebsOptimized"):!1,BlockDeviceMapping:n,SecurityGroups:_.map(this.connectionTargets("SgAsso"),function(e){return e.createRef("GroupId")}),LaunchConfigurationName:this.get("configName")||this.get("name"),InstanceType:this.get("instanceType"),AssociatePublicIpAddress:this.get("publicIp")}},{component:r,layout:i}}},{handleTypes:r.RESTYPE.LC,isMesosMaster:t.isMesosMaster,isMesosSlave:t.isMesosSlave,resolveFirst:!0,preDeserialize:function(e,t){var n;if(!_.isArray(e.state)||!e.state.length)e.state=null;return n={id:e.uid,name:e.name,description:e.description||"",state:e.state,appId:e.resource.LaunchConfigurationARN,imageId:e.resource.ImageId,ebsOptimized:e.resource.EbsOptimized,instanceType:e.resource.InstanceType,monitoring:e.resource.InstanceMonitoring,userData:e.resource.UserData,publicIp:e.resource.AssociatePublicIpAddress,configName:e.resource.LaunchConfigurationName},t.osType&&t.architecture&&t.rootDeviceType&&(n.cachedAmi={osType:t.osType,architecture:t.architecture,rootDeviceType:t.rootDeviceType}),new u(n),null},deserialize:function(e,t,s){var o,u,a,f,l,c,h,p,d,v,m,g,y,b;a=s(e.uid),f=a.getAmiRootDevice(),g=e.resource.BlockDeviceMapping||[];for(p=0,v=g.length;p<v;p++)c=g[p],f&&c.DeviceName===f.DeviceName||!f&&((y=c.DeviceName)==="/dev/xvda"||y==="/dev/sda1")?(a.set("rdSize",c.Ebs.VolumeSize),a.set("rdIops",c.Ebs.Iops),a.set("rdType",c.Ebs.VolumeType)):c.Ebs&&(h={name:c.DeviceName,snapshotId:c.Ebs.SnapshotId,volumeSize:c.Ebs.VolumeSize,volumeType:c.Ebs.VolumeType,iops:c.Ebs.Iops,owner:a},new i(h,{noNeedGenName:!0}));u=n.modelClassForType("SgAsso"),b=e.resource.SecurityGroups||[];for(d=0,m=b.length;d<m;d++)l=b[d],new u(a,s(MC.extractID(l)));return o=s(MC.extractID(e.resource.KeyName)),o?o.assignTo(a):e.resource.KeyName||e.resource.KeyName===""?a.set("keyName",e.resource.KeyName):_.defer(function(){return n.modelClassForType(r.RESTYPE.KP).getDefaultKP().assignTo(a)}),null}}),u}),define("wspace/awseditor/model/KeypairModel",["constant","ComplexResModel","ConnectionModel","Design"],function(e,t,n,r){var i,s,o;return o=n.extend({type:"KeypairUsage",oneToMany:e.RESTYPE.KP,serialize:function(t){var n,r,i,s,o,u,a,f;r=this.getTarget(e.RESTYPE.KP);if(r){s=this.getOtherTarget(r),o=t[s.id];if(!o)return;u=r.createRef("KeyName"),o.resource.KeyName=u,n=s.groupMembers?s.groupMembers():[];for(a=0,f=n.length;a<f;a++)i=n[a],t[i.id]&&(t[i.id].resource.KeyName=u)}return null}}),i="DefaultKP",s=t.extend({type:e.RESTYPE.KP,defaults:{fingerprint:"",isSet:!1},isVisual:function(){return!1},isDefault:function(){return this.get("name")===i},remove:function(){var e,n,r,i,u;e=s.getDefaultKP(),u=this.connectionTargets("KeypairUsage");for(r=0,i=u.length;r<i;r++)n=u[r],new o(e,n);return t.prototype.remove.call(this),null},assignTo:function(e){return new o(this,e)},dissociate:function(t){var n;return n=this.connections(),_.each(n,function(n){if(n.getOtherTarget(e.RESTYPE.KP)===t)return n.remove()})},isSet:function(){return this.get("appId")&&this.get("fingerprint")},getKPList:function(){var e,t,n,r,o;t=[],o=s.allObjects();for(n=0,r=o.length;n<r;n++)e=o[n],t.push({id:e.id,name:e.get("name"),selected:e===this,using:e.connections("KeypairUsage").length>1});return _.sortBy(t,function(e,t){if(e.name===i)return-1;if(t.name==="DefaultKpName")return 1;if(e.name>t.name)return 1;if(e.name===t.name)return 0;if(e.name<t.name)return-1})},serialize:function(){return{component:{name:this.get("name"),type:this.type,uid:this.id,resource:{KeyFingerprint:this.get("fingerprint")||"",KeyName:this.get("appId")}}}}},{getDefaultKP:function(){var e,t;return e=s.allObjects(),t=_.find(e,function(e){return e.get("name")===i}),t},setDefaultKP:function(e,t){var n;return n=this.getDefaultKP(),n.set("appId",e||""),n.set("fingerprint",t||""),n.set("isSet",!0)},ensureDefaultKp:function(){return this.getDefaultKP()||new s({name:i})},handleTypes:e.RESTYPE.KP,deserialize:function(e,t,n){return new s({id:e.uid,name:e.name,appId:e.resource.KeyName,fingerprint:e.resource.KeyFingerprint}),null}}),r.on(r.EVENT.Deserialized,s.ensureDefaultKp,s),s}),define("wspace/awseditor/model/connection/Route",["constant","ConnectionModel","ComplexResModel","Design"],function(e,t,n,r){var i,s;return s=n.extend({type:"ExternalVpcRouteTarget",defaults:{targetId:"",targetType:""},constructor:function(e){var t,i,o,u,a,f,l,c,h,p,d;if(!(e.GatewayId||e.InstanceId||e.NetworkInterfaceId||e.VpcPeeringConnectionId)){void 0;return}i=MC.extractID(e.GatewayId||e.InstanceId||e.NetworkInterfaceId);if(i){o=r.instance().component(i);if(o)return o}p=["GatewayId","InstanceId","NetworkInterfaceId","VpcPeeringConnectionId"];for(f=0,c=p.length;f<c;f++){t=p[f];if(e[t]){u={name:e[t],targetId:e[t],targetType:t};break}}if(u){d=s.allObjects();for(l=0,h=d.length;l<h;l++){a=d[l];if(a.get("targetId")===u.targetId&&a.get("targetType")===u.targetType)return a}return n.call(this,u)}},serialize:function(){}}),i=t.extend({type:"RTB_Route",isVisual:function(){return!this.getTarget("ExternalVpcRouteTarget")},isRemovable:function(){return this.getTarget(e.RESTYPE.IGW)&&this.getTarget(e.RESTYPE.RT).get("main")&&this.design().opsModel().isMesos()?{error:"Cannot be deleted, subnets must connect to internet."}:!0},constructor:function(n,r,i,s){var o,u;return n.type===e.RESTYPE.ENI?(o=n,u=r):r.type===e.RESTYPE.ENI&&(o=r,u=n),o&&o.embedInstance()&&(n=o.embedInstance(),r=u),t.call(this,n,r,i,s)},defaults:function(){return{routes:[]}},initialize:function(t,n){var r;return r=this.getTarget(e.RESTYPE.IGW),r&&n&&n.createByUser&&this.get("routes").push("0.0.0.0/0"),null},addRoute:function(e){var t,n;if(!e)return;return n=this.get("routes"),t=_.indexOf(n,e),t!==-1?!1:(n.push(e),this.set("routes",n),!0)},removeRoute:function(e){var t,n;if(!e)return;return n=this.get("routes"),t=_.indexOf(n,e),t!==-1?!1:(n.splice(t,1),this.set("routes",n),!0)},setPropagate:function(e){return void 0,this.set("propagate",e)},serialize:function(t){var n,r,i,s,o,u,a,f,l,c;u=this.getTarget(e.RESTYPE.RT),i=this.getOtherTarget(u),a=t[u.id],this.get("propagate")&&a.resource.PropagatingVgwSet.push(i.createRef("VpnGatewayId")),o={Origin:"",InstanceId:"",NetworkInterfaceId:"",GatewayId:""},n=e.RESTYPE;switch(i.type){case n.ENI:o.NetworkInterfaceId=i.createRef("NetworkInterfaceId");break;case n.IGW:o.GatewayId=i.createRef("InternetGatewayId");break;case n.VGW:o.GatewayId=i.createRef("VpnGatewayId");break;case n.INSTANCE:o.NetworkInterfaceId=i.getEmbedEni().createRef("NetworkInterfaceId");break;case"ExternalVpcRouteTarget":o[i.get("targetType")]=i.get("targetId")}c=this.get("routes");for(f=0,l=c.length;f<l;f++)s=c[f],r={DestinationCidrBlock:s},a.resource.RouteSet.push($.extend(r,o));return null},portDefs:[{port1:{name:"igw-tgt",type:e.RESTYPE.IGW},port2:{name:"rtb-tgt",type:e.RESTYPE.RT}},{port1:{name:"instance-rtb",type:e.RESTYPE.INSTANCE},port2:{name:"rtb-tgt",type:e.RESTYPE.RT}},{port1:{name:"eni-rtb",type:e.RESTYPE.ENI},port2:{name:"rtb-tgt",type:e.RESTYPE.RT}},{port1:{name:"vgw-tgt",type:e.RESTYPE.VGW},port2:{name:"rtb-tgt",type:e.RESTYPE.RT}},{port1:{name:"rtb-tgt",type:e.RESTYPE.RT},port2:{name:"vpc-route",type:"ExternalVpcRouteTarget"}}]},{isConnectable:function(t,n){var r;return t.type===e.RESTYPE.INSTANCE?r=t:n.type===e.RESTYPE.INSTANCE&&(r=n),r&&r.get("count")>1?!1:!0},VpcRouteTarget:s}),i}),define("wspace/awseditor/model/connection/RtbAsso",["constant","ConnectionModel"],function(e,t){var n;return n=t.extend({type:"RTB_Asso",oneToMany:e.RESTYPE.RT,defaults:{implicit:!1},portDefs:{port1:{name:"subnet-assoc-out",type:e.RESTYPE.SUBNET},port2:{name:"rtb-src",type:e.RESTYPE.RT}},serialize:function(t){var n,r,i;if(this.get("implicit"))return;return i=this.getTarget(e.RESTYPE.SUBNET),n=this.getTarget(e.RESTYPE.RT),r=t[n.id],r.resource.AssociationSet.push({SubnetId:i.createRef("SubnetId"),RouteTableAssociationId:this.get("assoId")||"",Main:!1}),null},remove:function(){var r,i,s,o,u;o=this.getTarget(e.RESTYPE.SUBNET);if(!o.isRemoved()){u=o.connections("RTB_Asso");if(u.length===0||u.length===1&&u[0]===this){s=this.getTarget(e.RESTYPE.RT);if(s.get("main")){this.set("implicit",!0);return}t.prototype.remove.apply(this,arguments),r=Design.modelClassForType(e.RESTYPE.RT),i=r.getMainRouteTable(),new n(o,i,{implicit:!0});return}}return t.prototype.remove.apply(this,arguments),null}}),n}),define("wspace/awseditor/model/RtbModel",["ComplexResModel","Design","./connection/Route","./connection/RtbAsso","constant","i18n!/nls/lang.js"],function(e,t,n,r,i,s){var o;return o=e.extend({defaults:{main:!1,implicit:!1},type:i.RESTYPE.RT,newNameTmpl:"RT-",isRemovable:function(){return this.get("main")?{error:sprintf(s.CANVAS.ERR_DEL_MAIN_RT,this.get("name"))}:!0},setMain:function(){var e,n,s,u,a,f;if(this.get("main"))return;o.getMainRouteTable().set("main",!1),this.set("main",!0),s=t.modelClassForType(i.RESTYPE.SUBNET).allObjects(),f=[];for(u=0,a=s.length;u<a;u++)n=s[u],e=n.connections("RTB_Asso")[0],void 0,e.get("implicit")?f.push(new r(this,n,{implicit:!0})):f.push(void 0);return f},addRoute:function(e,r,i){var s,o;_.isString(e)?s=t.instance().component(e):s=new n.VpcRouteTarget(e);if(!s||!s.id){void 0;return}return o=new n(this,s),o.addRoute(r),i!==void 0&&o.setPropagate(i),null},serialize:function(){var e;return e={name:this.get("name"),description:this.get("description")||"",type:this.type,uid:this.id,resource:{PropagatingVgwSet:[],RouteTableId:this.get("appId"),VpcId:this.parent().createRef("VpcId"),AssociationSet:[],RouteSet:[{Origin:"CreateRouteTable",DestinationCidrBlock:this.parent().get("cidr"),InstanceId:"",NetworkInterfaceId:"",GatewayId:"local"}],Tags:[{Key:"visops_default",Value:this.get("main")?"true":"false"}]}},this.get("main")&&e.resource.AssociationSet.push({Main:"true",RouteTableAssociationId:"",SubnetId:""}),{component:e,layout:this.generateLayout()}}},{getMainRouteTable:function(){return _.find(o.allObjects(),function(e){return e.get("main")})},handleTypes:i.RESTYPE.RT,resolveFirst:!0,preDeserialize:function(e,t){var n,r,i,s,u,a,f,l,c;if(e.resource.AssociationSet){i=-1,c=e.resource.AssociationSet;for(s=f=0,l=c.length;f<l;s=++f)r=c[s],r.Main&&i===-1&&(i=s);i>0&&(u=e.resource.AssociationSet.splice(i,1),e.resource.AssociationSet.splice(0,0,u[0])),e.resource.AssociationSet[0]&&(n=""+e.resource.AssociationSet[0].Main=="true")}return a=new o({id:e.uid,appId:e.resource.RouteTableId,name:e.name,description:e.description||"",main:!!n,x:t.coordinate[0],y:t.coordinate[1]}),null},deserialize:function(e,n,r){var s,o,u;return o=r(e.uid),u=r(n.groupUId),s=t.modelClassForType(i.RESTYPE.VPC),u||(u=s.theVPC()),u.addChild(o),null},postDeserialize:function(e,n){var i,s,o,u,a,f,l,c,h,p,d,v,m,g;i=t.instance(),f=i.component(e.uid),m=e.resource.AssociationSet||[];for(l=0,p=m.length;l<p;l++)o=m[l],!o.Main&&o.SubnetId&&new r(f,i.component(MC.extractID(o.SubnetId)),{implicit:!1,assoId:o.RouteTableAssociationId});a=e.resource.RouteSet;if(a&&a.length>1){s={},g=e.resource.PropagatingVgwSet||[];for(c=0,d=g.length;c<d;c++)u=g[c],s[u]=!0;for(h=0,v=a.length;h<v;h++){o=a[h];if(o.GatewayId==="local")continue;f.addRoute(o,o.DestinationCidrBlock,s[o.GatewayId])}}return null}}),o});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/model/SubnetModel",["constant","Design","GroupModel","./connection/RtbAsso","i18n!/nls/lang.js"],function(e,t,n,r,i){var s;return s=n.extend({type:e.RESTYPE.SUBNET,newNameTmpl:"subnet",defaults:{cidr:""},initialize:function(n,i){var s,o,u,a;return this.attributes.cidr||(this.attributes.cidr=this.generateCidr()),u=t.modelClassForType(e.RESTYPE.RT),new r(this,u.getMainRouteTable(),{implicit:!0}),s=t.modelClassForType(e.RESTYPE.ACL),a=s.getDefaultAcl(),a&&(o=t.modelClassForType("AclAsso"),new o(this,a)),null},setCidr:function(e){var t;return t=MC.getValidCIDR(e),this.set("cidr",t),null},setAcl:function(e){var n;return n=t.modelClassForType("AclAsso"),new n(this,t.instance().component(e)),null},isPublic:function(){var t,n,r;return n=this.connectionTargets("RTB_Asso")[0],r=n.connectionTargets("RTB_Route"),t=_.where(r,{type:e.RESTYPE.IGW}),t.length>0},isReparentable:function(t){var n,r,s,o,u,a,f,l;f=this.children();for(s=0,u=f.length;s<u;s++){r=f[s];if(r.type===e.RESTYPE.INSTANCE||r.type===e.RESTYPE.ENI){l=r.connectionTargets("EniAttachment");for(o=0,a=l.length;o<a;o++){n=l[o];if(n.parent()!==this)return i.CANVAS.ERR_MOVE_ATTACHED_ENI}}if(r.type===e.RESTYPE.ASG||r.type==="ExpandedAsg"){r.type==="ExpandedAsg"&&(r=r.get("originalAsg"));if(r.getExpandAzs().indexOf(t)!==-1)return sprintf(i.CANVAS.ERR_DROP_ASG,r.get("name"),t.get("name"))}}return!0},isRemovable:function(){var e,t,n,r,s,o,u,a,f,l,c;n=this.parent(),e=this.connectionTargets("SubnetgAsso");if(e.length>0)return{error:sprintf(i.IDE.RDS_MSG_ERR_REMOVE_SUBNET_FAILED_CAUSEDBY_USEDBY_SBG,this.get("name"),e[0].get("name"))};l=this.connections("ElbSubnetAsso");for(o=0,a=l.length;o<a;o++){s=l[o];if(s.isRemovable()!==!0){if(!this.design().modeIsStack())return{error:i.CANVAS.ERR_DEL_LINKED_ELB};c=s.getOtherTarget(this).connectionTargets("ElbAmiAsso");for(u=0,f=c.length;u<f;u++){t=c[u];if(t.parent()===this||t.parent().parent()===this)continue;r=t.parent();while(r){if(r===n)return{error:i.CANVAS.ERR_DEL_LINKED_ELB};r=r.parent()}}}}return!0},onParentChanged:function(){var t,n,r,i,s;t=this.connections("ElbSubnetAsso")[0];if(!t)return;s=t.getTarget(e.RESTYPE.ELB).connectionTargets("ElbSubnetAsso");for(r=0,i=s.length;r<i;r++){n=s[r];if(n.parent()===this.parent()){t.remove();return}}return null},isValidCidr:function(e){return s.isInVPCCIDR(this.parent().parent().get("cidr"),e)?this.isCidrConfilctWithSubnets(e)?{error:""+e+" conflicts with other subnet.",detail:"Please choose a CIDR block not conflicting with existing subnet."}:this.getAvailableIPCountInSubnet(e)<=0?{error:""+e+" has not enough IP for the ENIs in this subnet."}:!0:{error:""+e+" conflicts with VPC CIDR.",detail:"Subnet CIDR block should be a subset of VPC's."}},isCidrConfilctWithSubnets:function(e){var t,n,r,i,o;e=e||this.get("cidr"),o=s.allObjects();for(r=0,i=o.length;r<i;r++){n=o[r];if(n!==this){t=s.isCidrConflict(n.get("cidr"),e);if(t)return!0}}return!1},getAvailableIPCountInSubnet:function(n){var r,i,s,o,u,a,f;n=n||this.get("cidr"),s=0,f=this.children();for(u=0,a=f.length;u<a;u++){r=f[u];if(r.type===e.RESTYPE.INSTANCE)i=r.getEmbedEni();else{if(r.type!==e.RESTYPE.ENI)continue;i=r}s+=i.get("ips").length*i.serverGroupCount()}return o=t.modelClassForType(e.RESTYPE.ENI).getAvailableIPCountInCIDR(n),o-s},generateCidr:function(){var e,t,n,r,i,o,u,a,f,l,c,h,p,d,v,m,g;n=this.parent().parent().get("cidr"),c=n.split("/"),h=c[0],p=h.split("."),d=Number(c[1]);if(d!==16)return"";r=-1,g=s.allObjects();for(v=0,m=g.length;v<m;v++)e=g[v],o=e.get("cidr"),u=o.split("/"),f=u[0],l=Number(u[1]),a=f.split("."),t=Number(a[2]),r<t&&(r=t);return i=r+1,i>255?"":(p[2]=String(i),p.join(".")+"/24")},serialize:function(){var e;return e={name:this.get("name"),description:this.get("description")||"",type:this.type,uid:this.id,resource:{AvailabilityZone:this.parent().createRef(),VpcId:this.parent().parent().createRef("VpcId"),SubnetId:this.get("appId"),CidrBlock:this.get("cidr")}},{component:e,layout:this.generateLayout()}}},{handleTypes:e.RESTYPE.SUBNET,genCIDRPrefixSuffix:function(e){var t,n,r,i,s,o;return t=e.split("/"),n=t[0],o=Number(t[1]),r=n.split("."),i="",s="",o>23?(i=r[0]+"."+r[1]+"."+r[2]+".",s="x"):(i=r[0]+"."+r[1]+".",s="x.x"),[i,s]},isIPInSubnet:function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k;return n||(n=[0,1,2,3]),u=!0,h=t.split("/"),v=Number(h[1]),c=h[0].split("."),p=MC.getCidrBinStr(h[0]),d=p.slice(0,v),i=MC.getCidrBinStr(e),s=i.slice(0,v),o=i.slice(v),m=32-v,b=_.map(function(){C=[];for(var e=1,t=m+1;1<=t?e<t:e>t;1<=t?e++:e--)C.push(e);return C}.apply(this),function(){return"0"}),w=b.join(""),g=w.replace(/0/g,"1"),E=parseInt(w,2),y=parseInt(g,2),a=function(){k=[];for(var e=E,t=y+1;E<=t?e<t:e>t;E<=t?e++:e--)k.push(e);return k}.apply(this),f=a.length,l=!1,r=[],_.each(a,function(e,t){var i,s;return s=MC.leftPadString(e.toString(2),m,"0"),i=n.concat([f-1]),__indexOf.call(i,t)>=0&&r.push(s),null}),__indexOf.call(r,o)>=0?{isValid:!1,isReserved:!0}:(u=d===s,{isValid:u,isReserved:!1})},isCidrConflict:function(e,t){var n,r,i,s,o;return n=MC.getCidrBinStr(e),i=MC.getCidrBinStr(t),r=Number(e.split("/")[1]),s=Number(t.split("/")[1]),r===0&&r===s?!0:(o=r,r>s&&(o=s),n.slice(0,o)===i.slice(0,o)&&o!==0?!0:!1)},isInVPCCIDR:function(e,t){return this.isCidrConflict(e,t)?Number(t.split("/")[1])>=Number(e.split("/")[1]):!1},isValidSubnetCIDR:function(e){var t,n,r,i;return t=MC.getCidrBinStr(e),n=Number(e.split("/")[1]),r=t.slice(n),i=parseInt(r),i===0||r===""?!0:!1},autoAssignAllCIDR:function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p;i=Math.ceil(Math.log(t)/Math.log(2)),p=Number(e.split("/")[1]),h=MC.getCidrBinStr(e),c=h.slice(0,p),l=p+i,u=[],r=0;while(r<t)n=MC.leftPadString(r.toString(2),i,"0"),a=MC.rightPadString(c+n,32,"0"),s=_.map([0,8,16,24],function(e){return parseInt(a.slice(e,e+8),2)}),o=s.join("."),f=o+"/"+l,u.push(f),++r;return u},autoAssignSimpleCIDR:function(e,t,n){var r,i,s,o,u,a,f,l,c;r=[],s=e.split("/"),o=s[0],u=Number(s[1]),c=o.split("."),i=Number(n.split("/")[1]);if(u===16||u===24&&i===u)a=c[0],f=c[1],l=c[2],_.each(t,function(e){var t,n,i,s,o;return n=e.split("/"),i=n[0],s=Number(n[1]),o=i.split("."),o[0]=a,o[1]=f,u===24&&(o[2]=l),t=o.join(".")+"/"+s,r.push(t),null});return r},deserialize:function(e,t,n){return new s({id:e.uid,name:e.name,description:e.description||"",appId:e.resource.SubnetId,cidr:e.resource.CidrBlock,x:t.coordinate[0],y:t.coordinate[1],width:t.size[0],height:t.size[1],parent:n(t.groupUId)}),null}}),s}),define("wspace/awseditor/model/DhcpModel",["constant","ComplexResModel","Design"],function(e,t,n){var r;return r=t.extend({type:e.RESTYPE.DHCP,defaults:function(){return{appId:""}},isAuto:function(){return this.attributes.appId===""},isDefault:function(){return this.attributes.appId==="default"},isCustom:function(){return this.attributes.appId!==""&&this.attributes.appId!=="default"},getDhcp:function(){return this.get("appId")},setAuto:function(){return this.set("appId","")},setDefault:function(){return this.set("appId","default")},setDhcp:function(e){if(this.get("appId")!==e)return this.set("appId",e)},serialize:function(){}},{handleTypes:e.RESTYPE.DHCP,deserialize:function(e){var t;return t={},t.id=e.uid,t.appId=e.resource.DhcpOptionsId,new r(t),null}}),r}),define("wspace/awseditor/model/VpcModel",["constant","GroupModel","./DhcpModel","Design"],function(e,t,n,r){var i;return i=t.extend({type:e.RESTYPE.VPC,defaults:{description:"",dnsSupport:!0,dnsHostnames:!1,tenancy:"default",cidr:"10.0.0.0/16"},initialize:function(){return this.attributes.dhcp||(this.attributes.dhcp=new n),null},isRemovable:function(){return!1},isDefaultTenancy:function(){return this.get("tenancy")!=="dedicated"},setTenancy:function(t){var n,i,s,o;this.set("tenancy",t);if(t==="dedicated"){o=r.modelClassForType(e.RESTYPE.INSTANCE).allObjects();for(i=0,s=o.length;i<s;i++)n=o[i],n.setTenancy(t)}return null},setCidr:function(t){var n,i,s,o,u,a,f,l,c;n=r.modelClassForType(e.RESTYPE.SUBNET),a=n.allObjects(),o=!1,u=_.map(a,function(e){var r;return r=e.get("cidr"),n.isInVPCCIDR(t,r)||(o=!0),r});if(o){u=this.generateSubnetCidr(t,u);if(!u)return!1;for(i=l=0,c=a.length;l<c;i=++l)s=a[i],s.setCidr(u[i])}return f=MC.getValidCIDR(t),this.set("cidr",f),!0},generateSubnetCidr:function(t,n){var i,s;return i=r.modelClassForType(e.RESTYPE.SUBNET),s=i.allObjects(),n=i.autoAssignSimpleCIDR(t,n,this.get("cidr")),n.length||(n=i.autoAssignAllCIDR(t,s.length)),n.length!==s.length?null:n},serialize:function(){var e,t,n;return void 0,n=this.get("dhcp"),n.isAuto()?t="":n.isDefault()?t="default":t=n.getDhcp(),e={name:this.get("name"),description:this.get("description")||"",type:this.type,uid:this.id,resource:{EnableDnsSupport:this.get("dnsSupport"),InstanceTenancy:this.get("tenancy"),EnableDnsHostnames:this.get("dnsHostnames"),DhcpOptionsId:t,VpcId:this.get("appId"),CidrBlock:this.get("cidr")}},{component:e,layout:this.generateLayout()}}},{handleTypes:e.RESTYPE.VPC,resolveFirst:!0,theVPC:function(){return r.instance().classCacheForCid(this.prototype.classId)[0]},preDeserialize:function(e,t){return new i({id:e.uid,name:e.name,description:e.description||"",appId:e.resource.VpcId,cidr:e.resource.CidrBlock,dnsHostnames:e.resource.EnableDnsHostnames,dnsSupport:e.resource.EnableDnsSupport,tenancy:e.resource.InstanceTenancy,x:t.coordinate[0],y:t.coordinate[1],width:t.size[0],height:t.size[1]}),null},deserialize:function(e,t,n){var r,i,s;return s=n(e.uid),r=e.resource.DhcpOptionsId,r===void 0?s.get("dhcp").setAuto():r?r==="default"?s.get("dhcp").setDefault():r[0]==="@"?(i=s.get("dhcp"),i&&i.remove(),s.set("dhcp",n(MC.extractID(r)))):s.get("dhcp").setDhcp(r):s.get("dhcp").setAuto(),null}}),i}),define("wspace/awseditor/model/IgwModel",["ComplexResModel","Design","constant","i18n!/nls/lang.js"],function(e,t,n,r){var i;return i=e.extend({defaults:{name:"Internet-gateway"},type:n.RESTYPE.IGW,isRemovable:function(){var e,i,s,o;return this.design().opsModel().isMesos()?{error:"Cannot be deleted, subnets must connect to internet."}:(e=t.modelClassForType(n.RESTYPE.ELB),o=e.allObjects().some(function(e){return!e.get("internal")}),o||(i=t.modelClassForType(n.RESTYPE.ENI),o=i.allObjects().some(function(e){return e.hasEip()||e.get("assoPublicIp")})),o||(s=t.modelClassForType(n.RESTYPE.LC),o=s.allObjects().some(function(e){return e.get("publicIp")})),o?{error:r.CANVAS.CVS_CFM_DEL_IGW}:!0)},serialize:function(){var e;return e={name:this.get("name"),type:this.type,uid:this.id,resource:{InternetGatewayId:this.get("appId"),AttachmentSet:[{VpcId:this.parent().createRef("VpcId")}]}},{component:e,layout:this.generateLayout()}}},{tryCreateIgw:function(){var e;if(i.allObjects().length>0)return;return notification("info",r.CANVAS.CVS_CFM_ADD_IGW_MSG),e=t.modelClassForType(n.RESTYPE.VPC).theVPC(),new i({x:-1,y:-1,parent:e}),null},handleTypes:n.RESTYPE.IGW,deserialize:function(e,t,n){return new i({id:e.uid,name:e.name,appId:e.resource.InternetGatewayId,parent:n(MC.extractID(e.resource.AttachmentSet[0].VpcId)),x:t.coordinate[0],y:t.coordinate[1]})}}),i}),define("wspace/awseditor/model/VgwModel",["ComplexResModel","Design","constant"],function(e,t,n){var r;return r=e.extend({defaults:{name:"VPN-gateway"},type:n.RESTYPE.VGW,serialize:function(){var e;return e={name:this.get("name"),type:this.type,uid:this.id,resource:{Type:"ipsec.1",VpnGatewayId:this.get("appId"),Attachments:[{VpcId:this.parent().createRef("VpcId")}]}},{component:e,layout:this.generateLayout()}}},{handleTypes:n.RESTYPE.VGW,deserialize:function(e,t,n){return new r({id:e.uid,name:e.name,appId:e.resource.VpnGatewayId,parent:n(MC.extractID(e.resource.Attachments[0].VpcId)),x:t.coordinate[0],y:t.coordinate[1]}),null}}),r}),define("wspace/awseditor/model/SnsModel",["ResourceModel","ComplexResModel","constant","ConnectionModel"],function(e,t,n,r){var i,s;return s=r.extend({type:"TopicUsage",oneToMany:n.RESTYPE.TOPIC}),i=t.extend({type:n.RESTYPE.TOPIC,isVisual:function(){return!1},serialize:function(){var e;e=!!this.connections().length;if(!e){void 0;return}return{component:{name:this.get("name"),type:this.type,uid:this.id,resource:{TopicArn:this.get("appId")}}}},assignTo:function(e){if(this.get("appId"))return new s(this,e)}},{handleTypes:n.RESTYPE.TOPIC,resolveFirst:!0,isTopicNeeded:function(){var e,t,r,i,s,o,u,a,f,l;e=Design.modelClassForType(n.RESTYPE.SP),f=e.allObjects();for(s=0,u=f.length;s<u;s++){r=f[s];if(r.get("sendNotification")){i=!0;break}}if(!i){l=Design.modelClassForType(n.RESTYPE.NC).allObjects();for(o=0,a=l.length;o<a;o++){t=l[o];if(t.isUsed()){i=!0;break}}}return i},ensureExistence:function(){return this.allObjects().length===0&&new i,this.allObjects()[0]},get:function(e,t){var n;return n=_.first(_.filter(this.allObjects(),function(t){return t.get("appId")===e})),n||new i({appId:e,name:t})},preDeserialize:function(e,t){return new i({id:e.uid,appId:e.resource.TopicArn,name:e.resource.Name||e.name}),null},deserialize:function(){return null}}),null}),define("wspace/awseditor/model/StorageModel",["Design","ResourceModel"],function(e,t){var n;return n=t.extend({type:"AWS.Tag",serialize:function(){return{component:$.extend(!0,{},this.get("data"))}}},{handleTypes:["AWS.EC2.Tag","AWS.AutoScaling.Tag"],deserialize:function(e){return new n({id:e.uid,data:e}),null}}),n}),define("wspace/awseditor/model/ScalingPolicyModel",["ResourceModel","ComplexResModel","constant"],function(e,t,n){var r;return r=t.extend({type:n.RESTYPE.SP,defaults:function(){return{cooldown:"",minAdjustStep:"",adjustment:"-1",adjustmentType:"ChangeInCapacity",state:"ALARM",sendNotification:!1,alarmData:{id:MC.guid(),alarmName:"",namespace:"AWS/EC2",metricName:"CPUUtilization",comparisonOperator:">=",evaluationPeriods:"2",period:"300",statistic:"Average",threshold:"10",unit:"",appId:""}}},isVisual:function(){return!1},constructor:function(t,n){var r;return r=this.defaults(),t.alarmData=$.extend(r.alarmData,t.alarmData),e.call(this,t,n)},setAlarm:function(e){return this.set("alarmData",$.extend({id:this.attributes.alarmData.id,namespace:"AWS/EC2",unit:"",appId:this.attributes.alarmData.appId,alarmName:this.attributes.alarmData.alarmName},e)),null},isNotificate:function(){return this.get("sendNotification")},getCost:function(e,t){var n,r,i,s,o,u,a,f;n=this.get("alarmData"),o=parseInt(n.period,10);if(o<=300&&n.namespace==="AWS/EC2"){f=e.cloudwatch.types;for(u=0,a=f.length;u<a;u++){s=f[u];if(s.ec2Monitoring){i=parseFloat(s.ec2Monitoring[t],10)||0;break}}return i&&this.__asg?(r=Design.instance().modeIsStack()?this.__asg.get("minSize"):this.__asg.get("capacity"),i=Math.round(i/7*1e3)/1e3,{resource:this.get("name")+"-alarm",type:"CloudWatch",fee:i,formatedFee:i+"/mo"}):null}return null},setTopic:function(e,t){var r;return r=Design.modelClassForType(n.RESTYPE.TOPIC),r.get(e,t).assignTo(this)},removeTopic:function(){var e;return(e=this.connections("TopicUsage")[0])!=null?e.remove():void 0},getTopic:function(){return this.connectionTargets("TopicUsage")[0]},getTopicName:function(){var e;return(e=this.getTopic())!=null?e.get("name"):void 0},serialize:function(){var e,t,r,i,s,o,u,a;if(!this.__asg){void 0;return}return u={name:this.get("name"),type:this.type,uid:this.id,resource:{ScalingAdjustment:this.get("adjustment"),PolicyName:this.get("name"),PolicyARN:this.get("appId"),Cooldown:this.get("cooldown"),AutoScalingGroupName:this.__asg.createRef("AutoScalingGroupName"),AdjustmentType:this.get("adjustmentType"),MinAdjustmentStep:this.get("adjustmentType")==="PercentChangeInCapacity"?this.get("minAdjustStep"):""}},o=this.get("alarmData"),e=t=r=[],i=[this.createRef("PolicyARN")],this.get("sendNotification")&&(a=this.getTopic(),a&&i.push(a.createRef("TopicArn"))),this.get("state")==="ALARM"?e=i:this.get("state")==="INSUFFICIANT_DATA"?t=i:r=i,s={name:this.get("name")+"-alarm",type:n.RESTYPE.CW,uid:o.id,resource:{AlarmArn:o.appId,AlarmName:o.alarmName||this.get("name")+"-alarm",ComparisonOperator:o.comparisonOperator,EvaluationPeriods:o.evaluationPeriods,MetricName:o.metricName,Namespace:o.namespace,Period:Math.round(o.period/60)*60,Statistic:o.statistic,Threshold:o.threshold,Unit:o.unit,Dimensions:[{name:"AutoScalingGroupName",value:this.__asg.createRef("AutoScalingGroupName")}],AlarmActions:e,InsufficientDataActions:t,OKAction:r}},[{component:u},{component:s}]}},{handleTypes:[n.RESTYPE.SP,n.RESTYPE.CW],deserialize:function(e,t,i){var s,o,u,a,f,l,c,h,p,d;if(e.type===n.RESTYPE.CW){s={id:e.uid,name:e.name,alarmName:e.resource.AlarmName,appId:e.resource.AlarmArn,comparisonOperator:e.resource.ComparisonOperator,evaluationPeriods:e.resource.EvaluationPeriods,metricName:e.resource.MetricName,period:e.resource.Period,statistic:e.resource.Statistic,threshold:e.resource.Threshold,namespace:e.resource.Namespace,unit:e.resource.Unit},f=[],e.resource.AlarmActions.length&&(c="ALARM",f.push(e.resource.AlarmActions[0]),f.push(e.resource.AlarmActions[1])),e.resource.OKAction.length&&(c="OK",f.push(e.resource.OKAction[0]),f.push(e.resource.OKAction[1])),e.resource.InsufficientDataActions&&e.resource.InsufficientDataActions.length&&(c="INSUFFICIANT_DATA",f.push(e.resource.InsufficientDataActions[0]),f.push(e.resource.InsufficientDataActions[1])),l=!1;for(p=0,d=f.length;p<d;p++){u=f[p];if(!u)continue;u.indexOf("PolicyARN")!==-1?a=i(MC.extractID(u))||new Backbone.Model:u.indexOf("TopicArn")!==-1&&(h=i(MC.extractID(u)),l=!0)}h!=null&&h.assignTo(a),a&&a.set({alarmData:s,sendNotification:l,state:c})}else a=new r({id:e.uid,name:e.resource.PolicyName||e.name,appId:e.resource.PolicyARN,cooldown:e.resource.Cooldown,minAdjustStep:e.resource.MinAdjustmentStep,adjustment:e.resource.ScalingAdjustment,adjustmentType:e.resource.AdjustmentType}),o=i(MC.extractID(e.resource.AutoScalingGroupName)),o&&o.addScalingPolicy(a);return null}}),r}),define("wspace/awseditor/model/DBSbgModel",["constant","GroupModel","ConnectionModel"],function(e,t,n){var r,i;return i=n.extend({type:"SubnetgAsso"}),r=t.extend({type:e.RESTYPE.DBSBG,newNameTmpl:"subnetgroup",defaults:{x:2,y:2,width:17,height:17,createdBy:""},constructor:function(n,r){var i,s,o,u,a,f,l,c;if(r&&r.createByUser){s=Design.instance(),i={},l=s.componentsOfType(e.RESTYPE.SUBNET);for(a=0,f=l.length;a<f;a++)u=l[a],i[u.parent().get("name")]=!0;(c=Design.instance().region())==="cn-north-1"?o=1:o=2;if(_.keys(i).length<o)return this}return t.apply(this,arguments)},initialize:function(e,t){return this.get("description")||this.set("description",""+this.get("name")+" default description"),null},serialize:function(){var e,t;return t=_.map(this.connectionTargets("SubnetgAsso"),function(e){return e.createRef("SubnetId")}),e={name:this.get("name"),type:this.type,uid:this.id,resource:{CreatedBy:this.get("createdBy"),DBSubnetGroupName:this.get("appId"),SubnetIds:t,DBSubnetGroupDescription:this.get("description")}},{component:e,layout:this.generateLayout()}}},{handleTypes:e.RESTYPE.DBSBG,deserialize:function(e,t,n){var s,o,u,a,f;s=new r({id:e.uid,name:e.name||e.resource.DBSubnetGroupName,appId:e.resource.DBSubnetGroupName,createdBy:e.resource.CreatedBy,description:e.resource.DBSubnetGroupDescription,x:t.coordinate[0],y:t.coordinate[1],width:t.size[0],height:t.size[1],parent:n(t.groupUId)}),f=e.resource.SubnetIds||[];for(u=0,a=f.length;u<a;u++)o=f[u],new i(s,n(MC.extractID(o)));return null}}),r}),define("wspace/awseditor/model/DBOgModel",["ComplexResModel","Design","constant","i18n!/nls/lang.js"],function(e,t,n,r){var i;return i=e.extend({newNameTmpl:"-og-",type:n.RESTYPE.DBOG,isDefault:function(){return!!this.get("default")},isVisual:function(){return!1},initialize:function(e,t){var n,i;if(this.isDefault())return;return this.get("description")||(n=this.engineType()+this.get("engineVersion").replace(/\./g,"-"),this.set("name",n+this.get("name")),this.set("name",n+this.getNewName(void 0,this.newNameTmpl)),i=this,this.set("description",sprintf(r.IDE.CUSTOM_OPTION_GROUP_FOR_ENGINE,i.get("engineName"),i.get("engineVersion")))),null},defaults:function(){return{engineName:"",engineVersion:"",options:[],applyImmediately:!0}},engineType:function(){var e;e=this.get("engineName");switch(!1){case e!=="mysql":return"mysql";case e!=="postgresql":return"postgresql";case e!=="oracle-ee"&&e!=="oracle-se"&&e!=="oracle-se1":return"oracle";case e!=="sqlserver-ee"&&e!=="sqlserver-ex"&&e!=="sqlserver-se"&&e!=="sqlserver-web":return"sqlserver"}},remove:function(){return _.invoke(this.connectionTargets("OgUsage"),"setDefaultOptionGroup"),e.prototype.remove.apply(this,arguments)},createRef:function(){return this.isDefault()?this.get("name"):e.prototype.createRef.apply(this,arguments)},serialize:function(e){var r,i;if(this.isDefault())return;return i=t.modelClassForType(n.RESTYPE.VPC).theVPC(),r={name:this.get("name"),type:this.type,uid:this.id,resource:{CreatedBy:this.get("createdBy")||"",EngineName:this.get("engineName"),MajorEngineVersion:this.get("engineVersion"),OptionGroupDescription:this.get("description"),OptionGroupName:this.get("appId")||"",Options:this.get("options"),ApplyImmediately:this.get("applyImmediately"),VpcId:this.getVpcRef()}},{component:r}}},{handleTypes:n.RESTYPE.DBOG,deserialize:function(e,n,r){var s;return t.instance().modeIsStack()?s="":s=e.resource.CreatedBy,new i({id:e.uid,name:e.name,appId:e.resource.OptionGroupName,createdBy:s,engineName:e.resource.EngineName,engineVersion:e.resource.MajorEngineVersion,options:e.resource.Options,description:e.resource.OptionGroupDescription,applyImmediately:e.resource.ApplyImmediately})}}),i});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/model/DBInstanceModel",["ComplexResModel","ConnectionModel","./DBOgModel","Design","constant","i18n!/nls/lang.js","CloudResources"],function(e,t,n,r,i,s,o){var u,a;return a=t.extend({type:"OgUsage",oneToMany:i.RESTYPE.DBOG}),u=e.extend({defaults:{newInstanceId:"",instanceId:"",snapshotId:"",createdBy:"",accessible:!1,username:"root",password:"12345678",multiAz:!0,iops:0,autoMinorVersionUpgrade:!0,allowMajorVersionUpgrade:"",backupRetentionPeriod:1,allocatedStorage:10,backupWindow:"",maintenanceWindow:"",characterSetName:"",dbName:"",port:"",pending:"",az:"",ogName:"",pgName:"",applyImmediately:!1,dbRestoreTime:"",isRestored:!1,storageType:"standard"},type:i.RESTYPE.DBINSTANCE,newNameTmpl:"db",__cachedSpecifications:null,source:function(){return o(this.design().credentialId(),i.RESTYPE.DBSNAP,this.design().region()).get(this.get("snapshotId"))},slaveIndependentAttr:"id|appId|x|y|width|height|name|accessible|createdBy|instanceId|instanceClass|autoMinorVersionUpgrade|accessible|backupRetentionPeriod|multiAz|password|__connections|__parent",sourceDbIndependentAttrForRestore:"id|appId|x|y|width|height|name|accessible|createdBy|instanceId|instanceClass|autoMinorVersionUpgrade|multiAz|__connections|__parent|license|iops|port|ogName|pgName|az",slaves:function(){var e;return e=this,this.master()&&this.master().master()?[]:_.filter(this.connectionTargets("DbReplication"),function(t){return t.category()==="instance"&&t.get("appId")?!1:e.category()==="replica"&&!e.get("appId")?!1:!0})},getAllRestoreDB:function(){var e,t,n;return t=this.getSourceDBForRestore(),t?[]:(n=this,e=r.modelClassForType(i.RESTYPE.DBINSTANCE).allObjects(),_.filter(e,function(e){return e.getSourceDBForRestore()===n?!0:!1}))},master:function(){var e;return e=this.connections("DbReplication")[0],e&&e.master()!==this?e.master():null},copyMaster:function(e){this.clone(e);if(!this.get("appId"))return this.set({backupRetentionPeriod:0,multiAz:!1,instanceId:"",snapshotId:"",password:"****"})},setMaster:function(e){var t;return this.unsetMaster(),t=r.modelClassForType("DbReplication"),new t(e,this),this.listenTo(e,"change",this.syncMasterAttr),null},unsetMaster:function(){var e;return e=this,_.each(this.connections("DbReplication"),function(t){if(t.slave()===e)return t.remove()})},setSourceDBForRestore:function(e){var t,n;return this.sourceDBForRestore=e,this.setDefaultParameterGroup(),n=r.modelClassForType(i.RESTYPE.SG).getDefaultSg(),t=r.modelClassForType("SgAsso"),new t(n,this),this.listenTo(e,"change",this.syncAttrSourceDBForRestore)},getSourceDBForRestore:function(){return this.sourceDBForRestore},syncMasterAttr:function(e){var t,n,r,i;if(this.get("appId"))return!1;n={},i=e.changedAttributes();for(t in i)r=i[t],this.slaveIndependentAttr.indexOf(t)<0&&(n[t]=r);return n.iops&&delete n.iops,this.set(n)},syncAttrSourceDBForRestore:function(e){var t,n,r,i;n={},i=e.changedAttributes();for(t in i)r=i[t],this.sourceDbIndependentAttrForRestore.indexOf(t)<0&&(n[t]=r);return this.set(n)},needSyncMasterConn:function(e){var t,n;return this.master()?!1:(this.get("appId")?t=[]:t=["SgAsso","OgUsage"],(n=e.type,__indexOf.call(t,n)<0)?!1:!0)},connect:function(e){var t,n,i,s,o,u;if(!this.needSyncMasterConn(e))return;n=e.getOtherTarget(this),t=r.modelClassForType(e.type),u=this.slaves();for(s=0,o=u.length;s<o;s++)i=u[s],new t(i,n)},disconnect:function(e){var t,n,i,s,o,u;if(!this.needSyncMasterConn(e))return;if(e.oneToMany)return;n=e.getOtherTarget(this),t=r.modelClassForType(e.type),u=this.slaves();for(s=0,o=u.length;s<o;s++)i=u[s],(new t(i,n)).remove()},restoreMaster:function(e){return this.clone(e),this.set("snapshotId",e.get("snapshotId")),null},constructor:function(t,n){var r;return n&&!n.master&&n.createByUser&&t.snapshotId&&(r=this.getSnapshotModel(t.snapshotId),_.extend(t,{engine:r.get("Engine"),engineVersion:r.get("EngineVersion"),snapshotId:r.get("DBSnapshotIdentifier"),allocatedStorage:r.get("AllocatedStorage"),port:r.get("Port"),iops:r.get("Iops")||0,multiAz:r.get("MultiAZ"),ogName:r.get("OptionGroupName"),license:r.get("LicenseModel"),az:r.get("AvailabilityZone"),username:r.get("MasterUsername")})),e.call(this,t,n)},initialize:function(e,t){var n,s;t=t||{};if(t.cloneSource){this.clone(t.cloneSource);return}t.master?t.isRestore?(this.cloneForRestore(t.master),this.setSourceDBForRestore(t.master)):(this.copyMaster(t.master),this.setMaster(t.master)):t.createByUser&&(n=r.modelClassForType("SgAsso"),s=r.modelClassForType(i.RESTYPE.SG).getDefaultSg(),new n(s,this),this.set(_.defaults(e,{license:this.getDefaultLicense(),engineVersion:this.getDefaultVersion(),instanceClass:this.getDefaultInstanceClass(),port:this.getDefaultPort(),dbName:this.getDefaultDBName(),characterSetName:this.getDefaultCharSet(),allocatedStorage:this.getDefaultAllocatedStorage(),snapshotId:"",multiAz:!!e.multiAz})),e.iops&&Number(e.iops)>0&&this.set("storageType","io1"),this.setDefaultOptionGroup(),this.setDefaultParameterGroup())},clone:function(e){this.cloneAttributes(e,{reserve:"newInstanceId|instanceId|createdBy",copyConnection:["SgAsso","OgUsage"]}),this.set("snapshotId",""),this.get("password")==="****"&&this.set("password","12345678")},cloneForRestore:function(e){this.cloneAttributes(e,{reserve:"newInstanceId|instanceId|createdBy|pgName",copyConnection:["OgUsage"]}),this.set("snapshotId",""),this.get("password")==="****"&&this.set("password","12345678")},setDefaultOptionGroup:function(e){var t,n,r,s,u;return u=this.design().region(),r=o(this.design().credentialId(),i.RESTYPE.DBENGINE,u),t=r.getDefaultByNameVersion(u,this.get("engine"),this.get("engineVersion")),e&&(s=r.getDefaultByNameVersion(u,this.get("engine"),e)),s&&s.family&&t&&t.family&&s.family===t.family?null:(t&&t.defaultOGName?n=t.defaultOGName:(n="default:"+this.get("engine")+"-"+this.getMajorVersion().replace(".","-"),void 0),new a(this,this.getDefaultOgInstance(n)),null)},getDefaultOgInstance:function(e){return n.findWhere({name:e,"default":!0})||new n({name:e,"default":!0})},setDefaultParameterGroup:function(e){var t,n,r,s;return s=this.design().region(),r=o(this.design().credentialId(),i.RESTYPE.DBENGINE,s),t=r.getDefaultByNameVersion(s,this.get("engine"),this.get("engineVersion")),t&&t.defaultPGName?n=t.defaultPGName:(n="default."+this.get("engine")+this.getMajorVersion(),void 0),this.set("pgName",n||""),n},getAllocatedRange:function(){var e,t;e=this.get("engine"),this.isMysql()&&(t={min:5,max:3072}),this.isPostgresql()&&(t={min:5,max:3072}),this.isOracle()&&(t={min:10,max:3072});if(this.isSqlserver()){e=this.get("engine");if(e==="sqlserver-ee"||e==="sqlserver-se")t={min:200,max:1024};if(e==="sqlserver-ex"||e==="sqlserver-web")t={min:30,max:1024}}return t},getLicenseObj:function(e){var t,n;return t=this.get("license"),t&&(n=_.findWhere(this.getSpecifications(),{license:t})),!n&&e&&(n=this.getSpecifications()[0]),n},getVersionObj:function(e){var t,n,r;return r=this.getLicenseObj(!0).versions,t=this.get("engineVersion"),t&&(n=_.findWhere(r,{version:t})),!n&&e&&(n=r[0]),n},getInstanceClassObj:function(e){var t,n,r,i;return r=this.getVersionObj(!0).instanceClasses,n=this.get("instanceClass"),n&&(i=_.findWhere(r,{instanceClass:n})),!i&&e&&(t="db.t1.micro",i=_.find(r,function(e){return e.instanceClass===t}),i||(i=r[0])),i},setIops:function(e){return this.set("iops",e)},getIops:function(){return this.get("iops")},getDefaultLicense:function(){return this.getLicenseObj(!0).license},getDefaultVersion:function(){return this.getVersionObj(!0).version},getDefaultInstanceClass:function(){return this.getInstanceClassObj(!0).instanceClass},getMajorVersion:function(){var e;return(e=this.get("engineVersion"))!=null?e.split(".").slice(0,2).join("."):void 0},getMinorVersion:function(){var e;return(e=this.get("engineVersion"))!=null?e.split(".").slice(2).join("."):void 0},getRdsInstances:function(){var e;return(e=App.model.getRdsData(this.design().region()))!=null?e.instance[this.get("engine")]:void 0},getDefaultPort:function(){return i.DB_DEFAULTSETTING[this.get("engine")].port},getDefaultDBName:function(){return i.DB_DEFAULTSETTING[this.get("engine")].dbname},getDefaultCharSet:function(){return i.DB_DEFAULTSETTING[this.get("engine")].charset},getInstanceClassDict:function(){return _.find(i.DB_INSTANCECLASS,function(e){return function(t){return t.instanceClass===e.get("instanceClass")}}(this))},getDefaultAllocatedStorage:function(){var e;return e=i.DB_DEFAULTSETTING[this.get("engine")].allocatedStorage,e},getOptionGroup:function(){return this.connectionTargets("OgUsage")[0]},getOptionGroupName:function(){var e;return(e=this.getOptionGroup())!=null?e.get("name"):void 0},setOptionGroup:function(e){var t;return t=n.findWhere({name:e})||new n({name:e,"default":!0}),new a(this,t)},isMysql:function(){return this.engineType()==="mysql"},isOracle:function(){return this.engineType()==="oracle"},isSqlserver:function(){return this.engineType()==="sqlserver"},isPostgresql:function(){return this.engineType()==="postgresql"},engineType:function(){var e;return e=this.get("engine"),i.DB_ENGINTYPE[e]||e},getSpecifications:function(){var e,t,n,r,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;if(this.__cachedSpecifications)return this.__cachedSpecifications;h=this,u=this.getRdsInstances();if(!u)return null;l={},c=[];for(m=0,y=u.length;m<y;m++)s=u[m],l[s.LicenseModel]||(l[s.LicenseModel]={}),l[s.LicenseModel][s.EngineVersion]||(l[s.LicenseModel][s.EngineVersion]={}),l[s.LicenseModel][s.EngineVersion][s.DBInstanceClass]={multiAZCapable:s.MultiAZCapable,availabilityZones:s.AvailabilityZones};for(f in l){v=l[f],a={license:f,versions:[]};for(d in v){r=v[d],p={version:d,instanceClasses:[]},o={};for(t in r)e=r[t],o[t]={multiAZCapable:e.multiAZCapable,availabilityZones:e.availabilityZones};w=i.DB_INSTANCECLASS;for(g=0,b=w.length;g<b;g++)n=w[g],_.has(o,n.instanceClass)&&p.instanceClasses.push(_.extend(o[n.instanceClass],n));a.versions.push(p)}a.versions.sort(function(e,t){return MC.versionCompare(t.version,e.version)}),c.push(a)}return this.__cachedSpecifications=c,c},getLVIA:function(e){var t,n,r,i,s,o,u,a,f,l;if(!e)return[];n=this.get("license"),r=this.get("engineVersion"),t=this.get("instanceClass"),o=_.first(_.filter(e,function(e){return e.license===n?(e.selected=!0,!0):(delete e.selected,!1)})),a=_.first(_.filter(o.versions,function(e){return e.version===r?(e.selected=!0,!0):(delete e.selected,!1)})),a||(a=this.getVersionObj(!0),this.set("engineVersion",a.version),(f=_.findWhere(o.versions,{version:a.version}))!=null&&(f.selected=!0)),s=_.first(_.filter(a.instanceClasses,function(e){return e.instanceClass===t?(e.selected=!0,!0):(delete e.selected,!1)})),s||(s=this.getInstanceClassObj(!0),this.set("instanceClass",s.instanceClass),(l=_.where(a.instanceClasses,{instanceClass:s.instanceClass}))!=null&&(l.selected=!0)),u=s.multiAZCapable,u||this.set("multiAz",""),i=this.get("engine");if(i==="sqlserver-ee"||i==="sqlserver-se")u=!0;return[e,o.versions,a.instanceClasses,u,s.availabilityZones]},getCost:function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d;if(!e.database)return null;i=this.engineType(),i==="sqlserver"&&(c=this.get("engine").split("-")[1]),n=this.attributes.instanceClass.split("."),r=this.attributes.multiAz?"multiAZ":"standard";if(!i||!r)return null;h=e.database.rds.unit;try{o=e.database.rds[i][n[0]][n[1]][n[2]],a=null,this.attributes.license==="license-included"?a="li":this.attributes.license==="bring-your-own-license"&&(a="byol"),a==="li"&&i==="sqlserver"&&(a=a+"-"+c);for(p=0,d=o.length;p<d;p++){f=o[p];if(f.deploy!==r)continue;if(a&&a!==f.license)continue;o=f[t];break}return!o||typeof o!="number"?null:(h==="pricePerHour"?(u=o+"/hr",o*=720):u=o+"/mo",l={resource:this.attributes.name,type:this.attributes.instanceClass,fee:o,formatedFee:u},l)}catch(v){s=v}finally{}},category:function(e){switch(e){case"instance":return!this.get("snapshotId")&&!this.master();case"replica":return!!this.master();case"snapshot":return!!this.get("snapshotId")}return this.get("snapshotId")?"snapshot":this.master()?"replica":"instance"},getSnapshotModel:function(e){var t;return t=r.instance(),o(t.credentialId(),i.RESTYPE.DBSNAP,t.region()).findWhere({id:e||this.get("snapshotId")})},autobackup:function(e){if(e!==void 0){this.set("backupRetentionPeriod",e);return}return this.get("backupRetentionPeriod")||0},getNewName:function(){var t;return t=[].slice.call(arguments,0),t[0]=u.getInstances().length,e.prototype.getNewName.apply(this,t)},isRemovable:function(){var e,t,n;return this.slaves(!0).length>0?(this.get("appId")?(n=sprintf(s.CANVAS.CVS_CFM_DEL_EXISTENT_DBINSTANCE,this.get("name")),n="<div class='modal-text-major'>"+n+"</div>"):(n=sprintf(s.CANVAS.CVS_CFM_DEL_NONEXISTENT_DBINSTANCE,this.get("name")),n="<div class='modal-text-major'>"+n+"</div>"),n):(e=this.getAllRestoreDB(),e.length>0?(t=[],_.each(e,function(e){return t.push("<span class='resource-tag'>"+e.get("name")+"</span>")}),n=sprintf(s.CANVAS.CVS_CFM_DEL_RELATED_RESTORE_DBINSTANCE,this.get("name"),t.join(", ")),n="<div class='modal-text-major'>"+n+"</div>",n):!0)},remove:function(){var t,n,r,i,s,o,u,a;u=this.slaves();for(r=0,s=u.length;r<s;r++)n=u[r],n.get("appId")||n!==this&&n.remove();a=this.getAllRestoreDB();for(i=0,o=a.length;i<o;i++)t=a[i],t.remove();return e.prototype.remove.call(this),null},isReparentable:function(e){return this.master()&&e.get("id")!==this.get("id")?(notification("error","Cannot move read replica to another DBSubnetGroup."),!1):!0},serialize:function(){var e,t,n,r,i,s;return t=this.master(),r="",this.getSourceDBForRestore()&&(r=this.get("dbRestoreTime")?!1:!0),n="",this.get("dbRestoreTime")&&(n=this.get("dbRestoreTime")),e={name:this.get("name"),description:this.get("description")||"",type:this.type,uid:this.id,resource:{CreatedBy:this.get("createdBy"),DBInstanceIdentifier:this.get("instanceId"),NewDBInstanceIdentifier:this.get("newInstanceId"),DBSnapshotIdentifier:this.get("snapshotId"),AllocatedStorage:this.get("allocatedStorage"),AutoMinorVersionUpgrade:this.get("autoMinorVersionUpgrade"),AllowMajorVersionUpgrade:this.get("allowMajorVersionUpgrade"),AvailabilityZone:this.get("az"),MultiAZ:this.get("multiAz"),Iops:this.getIops()||0,BackupRetentionPeriod:this.get("backupRetentionPeriod"),CharacterSetName:this.get("characterSetName"),DBInstanceClass:this.get("instanceClass"),DBName:this.isMysql()&&this.get("snapshotId")?"":this.get("dbName"),Endpoint:{Port:this.get("port")},Engine:this.get("engine"),EngineVersion:this.get("engineVersion"),LicenseModel:this.get("license"),MasterUsername:this.get("username"),MasterUserPassword:this.get("password"),OptionGroupMembership:{OptionGroupName:(i=this.connectionTargets("OgUsage")[0])!=null?i.createRef("OptionGroupName"):void 0},DBParameterGroups:{DBParameterGroupName:this.get("pgName")},ApplyImmediately:this.get("applyImmediately"),PendingModifiedValues:this.get("pending"),PreferredBackupWindow:this.get("backupWindow"),PreferredMaintenanceWindow:this.get("maintenanceWindow"),PubliclyAccessible:this.get("accessible"),DBSubnetGroup:{DBSubnetGroupName:this.parent().createRef("DBSubnetGroupName")},VpcSecurityGroupIds:_.map(this.connectionTargets("SgAsso"),function(e){return e.createRef("GroupId")}),ReadReplicaSourceDBInstanceIdentifier:(t!=null?t.createRef("DBInstanceIdentifier"):void 0)||"",SourceDBInstanceIdentifierForPoint:((s=this.getSourceDBForRestore())!=null?s.createRef("DBInstanceIdentifier"):void 0)||"",UseLatestRestorableTime:r,RestoreTime:n,StorageType:this.get("storageType")}},{component:e,layout:this.generateLayout()}}},{handleTypes:i.RESTYPE.DBINSTANCE,oracleCharset:["AL32UTF8","JA16EUC","JA16EUCTILDE","JA16SJIS","JA16SJISTILDE","KO16MSWIN949","TH8TISASCII","VN8MSWIN1258","ZHS16GBK","ZHT16HKSCS","ZHT16MSWIN950","ZHT32EUC","BLT8ISO8859P13","BLT8MSWIN1257","CL8ISO8859P5","CL8MSWIN1251","EE8ISO8859P2","EL8ISO8859P7","EL8MSWIN1253","EE8MSWIN1250","NE8ISO8859P10","NEE8ISO8859P4","WE8ISO8859P15","WE8MSWIN1252","AR8ISO8859P6","AR8MSWIN1256","IW8ISO8859P8","IW8MSWIN1255","TR8MSWIN1254","WE8ISO8859P9","US7ASCII","UTF8","WE8ISO8859P1"],getInstances:function(){return this.reject(function(e){return e.master()||e.get("snapshotId")})},getReplicas:function(){return this.filter(function(e){return!!e.master()})},getSnapShots:function(){return this.filter(function(e){return!!e.get("snapshotId")})},getDefaultOgInstance:function(e){return n.findWhere({name:e,"default":!0})||new n({name:e,"default":!0})},deserialize:function(e,t,n){var i,s,o,f,l,c,h,p,d,v,m,g,y,b,w;d=this,c=e.resource,p=c.StorageType,p||(c.Iops&&Number(c.Iops)>0?p="io1":p="standard"),s=new u({id:e.uid,name:e.name,description:e.description||"",createdBy:c.CreatedBy,appId:c.DBInstanceIdentifier,instanceId:c.DBInstanceIdentifier,newInstanceId:c.NewDBInstanceIdentifier,snapshotId:c.DBSnapshotIdentifier,allocatedStorage:c.AllocatedStorage,autoMinorVersionUpgrade:c.AutoMinorVersionUpgrade,allowMajorVersionUpgrade:c.AllowMajorVersionUpgrade,az:c.AvailabilityZone,multiAz:c.MultiAZ,iops:c.Iops,backupRetentionPeriod:c.BackupRetentionPeriod,characterSetName:c.CharacterSetName,dbName:c.DBName,port:(g=c.Endpoint)!=null?g.Port:void 0,engine:c.Engine,license:c.LicenseModel,engineVersion:c.EngineVersion,instanceClass:c.DBInstanceClass,username:c.MasterUsername,password:c.MasterUserPassword,pending:c.PendingModifiedValues,backupWindow:c.PreferredBackupWindow,maintenanceWindow:c.PreferredMaintenanceWindow,accessible:c.PubliclyAccessible,pgName:(y=c.DBParameterGroups)!=null?y.DBParameterGroupName:void 0,applyImmediately:c.ApplyImmediately,storageType:p,x:t.coordinate[0],y:t.coordinate[1],parent:n(t.groupUId)}),e.resource.ReadReplicaSourceDBInstanceIdentifier&&s.setMaster(n(MC.extractID(e.resource.ReadReplicaSourceDBInstanceIdentifier))),i=r.modelClassForType("SgAsso"),b=e.resource.VpcSecurityGroupIds||[];for(v=0,m=b.length;v<m;v++)h=b[v],new i(s,n(MC.extractID(h)));f=(w=e.resource.OptionGroupMembership)!=null?w.OptionGroupName:void 0;if(f)return f.indexOf("default:")!==0&&(l=MC.extractID(f),l&&l!==f&&(o=n(l))),new a(s,o||s.getDefaultOgInstance(f))}}),u});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/model/MesosMasterModel",["./InstanceModel","Design","constant","i18n!/nls/lang.js","CloudResources"],function(e,t,n,r,i){var s,o;return o=[],s=e.extend({type:n.RESTYPE.INSTANCE,subType:n.RESTYPE.MESOSMASTER,newNameTmpl:"master-",defaults:function(){return{count:1,imageId:"",tenancy:"default",ebsOptimized:!1,instanceType:"m1.small",monitoring:!1,userData:"",volumeList:[],rdSize:0,rdIops:0,rdType:"gp2",cachedAmi:null,state:null}},constructor:function(t,n){e.call(this,t,_.extend({},n,{createBySubClass:!0}));if(!e.isMesosMaster(t))return this.setMesosState()},initialize:function(t,n){e.prototype.initialize.apply(this,arguments);if(n.createByUser||n.cloneSource)return this.getEmbedEni().set("assoPublicIp",!0),this.setMarathon(s.getMarathon())},setMesosState:function(e){var r,i,o,u,a,f,l,c;return e==null&&(e=s.getMarathon()),r=s.getMasterIPs(),l=t.instance().get("name"),u=t.modelClassForType(n.RESTYPE.MESOSMASTER).allObjects(),o=[],i=[],_.each(u,function(e){var t;if(e.isMesosMaster())return t="@{"+e.id+".PrivateIpAddress}",o.push({key:t,value:e.get("name")}),i.push(e.id)}),i=i.sort(),f=String(i.indexOf(this.id)+1),o=_.sortBy(o,function(e){var t;return t=MC.extractID(e.key),i.indexOf(t)}),a=[{id:"state-"+this.get("name"),module:"linux.mesos.master",parameter:{cluster_name:l,master_ip:"@{self.PrivateIpAddress}",server_id:f,masters_addresses:o,hostname:this.get("name"),framework:e?["marathon"]:[]}}],c=this.get("state")||[],c=_.filter(c,function(e){var t;return(t=e.module)==="linux.mesos.master"||t==="linux.mesos.slave"?!1:!0}),this.set("state",c.concat(a))},getMesosState:function(){var e;return e=this.get("state"),e&&e[0]&&e[0].module==="linux.mesos.master"?e[0]:null},setMarathon:function(e){return this.setMesosState(e)},getMarathon:function(){var e,t,n;return t=this.getMesosState(),e=(t!=null?(n=t.parameter)!=null?n.framework:void 0:void 0)||[],__indexOf.call(e,"marathon")>=0?!0:!1}},{handleTypes:n.RESTYPE.MESOSMASTER,deserialize:function(e,t,n){},setMarathon:function(e){return this.each(function(t){if(t.isMesosMaster())return t.setMarathon(e)})},getMarathon:function(){return this.some(function(e){return e.isMesosMaster()&&e.getMarathon()})},getMasterIPs:function(){var e,r,s;return s=t.instance().mode(),s==="stack"?{}:(e=i(t.instance().credentialId(),n.RESTYPE.ENI,t.instance().region()),r={},this.each(function(t){var n,i,s,o,u;return t.isMesosMaster()&&(i=t.getEmbedEni().get("appId"),n=e.get(i),n&&(s=n.get("privateIpAddress"),o=(u=n.get("association"))!=null?u.publicIp:void 0,s&&o&&(r[s]=o))),null}),r)},getCompByIp:function(e){var r,s,o,u,a,f,l,c,h;return t.instance().mode()==="stack"?null:(s=t.instance(),o=s.componentsOfType(n.RESTYPE.ENI),l=_.find(o,function(t){return _.some(t.getIpArray(),function(t){return t.ip===e})}),l?(c=l.attachedInstance(),c):(h=s.componentsOfType(n.RESTYPE.VPC)[0].get("appId"),u=i(s.credentialId(),n.RESTYPE.INSTANCE,s.region()),c=_.find(u.where({vpcId:h}),function(t){return t.get("privateIpAddress")===e}),c?(r=i(s.credentialId(),n.RESTYPE.ASG,s.region()),f=_.find(r.toJSON(),function(e){return _.some(e.Instances,function(e){return e.InstanceId===c.get("instanceId")})}).id,a=_.find(s.componentsOfType(n.RESTYPE.ASG),function(e){return e.get("appId")===f}),a.getLc()):null))}}),s.prototype.classId=e.prototype.classId,s}),define("wspace/awseditor/model/MesosSlaveModel",["./InstanceModel","Design","constant","i18n!/nls/lang.js","CloudResources"],function(e,t,n,r,i){var s,o;return o=[],s=e.extend({type:n.RESTYPE.INSTANCE,subType:n.RESTYPE.MESOSSLAVE,newNameTmpl:"slave-",defaults:function(){return{count:1,imageId:"",tenancy:"default",ebsOptimized:!1,instanceType:"m1.small",monitoring:!1,userData:"",volumeList:[],rdSize:0,rdIops:0,rdType:"gp2",cachedAmi:null,state:null}},constructor:function(t,n){e.call(this,t,_.extend({},n,{createBySubClass:!0}));if(!e.isMesosSlave(t))return this.setMesosState()},initialize:function(t,n){e.prototype.initialize.apply(this,arguments);if(n.createByUser||n.cloneSource)return this.getEmbedEni().set("assoPublicIp",!0)},setMesosState:function(e){var r,i,s,o,u,a,f;return r=e||this._getMesosAttributes()||this.getDefaultMesosAttributes(),r.az&&delete r.az,r=_.map(r,function(e,t){return{key:t,value:e}}),o=t.modelClassForType(n.RESTYPE.MESOSMASTER).allObjects(),s=[],i=[],_.each(o,function(e){var t;if(e.isMesosMaster())return t="@{"+e.id+".PrivateIpAddress}",s.push({key:t,value:e.get("name")}),i.push(e.id)}),i=i.sort(),a=String(i.indexOf(this.id)+1),s=_.sortBy(s,function(e){var t;return t=MC.extractID(e.key),i.indexOf(t)}),u=[{id:this.get("name"),module:"linux.mesos.slave",parameter:{masters_addresses:s,attributes:r,slave_ip:"@{self.PrivateIpAddress}"}}],f=this.get("state")||[],f=_.filter(f,function(e){var t;return(t=e.module)==="linux.mesos.master"||t==="linux.mesos.slave"?!1:!0}),this.set("state",f.concat(u))},getMesosState:function(){var e;return e=this.get("state"),e&&e[0]&&e[0].module==="linux.mesos.slave"?e[0]:null},getDefaultMesosAttributes:function(){var e,t,r;return this.type===n.RESTYPE.LC?(e=this.connectionTargets("LcUsage"),r=[],t=[],_.each(e,function(e){var n;return t.push(e.get("name")),n=_.map(e.getExpandAzs(),function(e){return e.get("name")}),r=r.concat(n)}),{az:r.join("|"),asg:t.join(",")}):{az:this.parent().parent().get("name"),subnet:this.parent().get("name"),"subnet-position":this.parent().isPublic()?"public":"private"}},setMesosAttributes:function(e){var t;return t=this.getDefaultMesosAttributes(),this.setMesosState(_.extend(e||{},t))},_getMesosAttributes:function(){var e,t,n,r,i;r=this.getMesosState(),t=r!=null?(i=r.parameter)!=null?i.attributes:void 0:void 0;if(!_.isArray(t)||!t.length)t=[];return e={},_.each(t,function(t){return e[t.key]=t.value}),n=this.getDefaultMesosAttributes(),_.extend(e,n)},getMesosAttributes:function(){var e,t,n,r;return n=_.keys(this.getDefaultMesosAttributes()),e=this._getMesosAttributes(),r=_.keys(e),t=_.difference(r,n),t.unshift(e),_.pick.apply(null,t)},getMesosAppAttributes:function(e){var r,s,o,u,a;return e==null&&(e=this.get("appId")),r=i(t.instance().credentialId(),n.RESTYPE.INSTANCE,t.instance().region()),o=r!=null?r.get(e):void 0,s=o!=null?(u=o.get("networkInterfaceSet"))!=null?(a=u[0])!=null?a.privateIpAddress:void 0:void 0:void 0,this.design().opsModel().getMesosData().getSlave(s)}},{handleTypes:n.RESTYPE.MESOSSLAVE,deserialize:function(e,t,n){}}),s.prototype.classId=e.prototype.classId,s}),define("wspace/awseditor/model/MesosLcModel",["./LcModel","./MesosSlaveModel","Design","constant","./VolumeModel","i18n!/nls/lang.js","CloudResources"],function(e,t,n,r,i,s,o){var u,a;return a=[],u=e.extend({type:r.RESTYPE.LC,subType:r.RESTYPE.MESOSLC,newNameTmpl:"slave-lc-",defaults:function(){return{imageId:"",ebsOptimized:!1,instanceType:"m1.small",monitoring:!1,userData:"",state:null,rdSize:0,rdIops:"",rdType:"gp2",attributes:{},publicIp:!0}},constructor:function(t,i){e.call(this,t,_.extend({},i,{createBySubClass:!0})),u=n.modelClassForType(r.RESTYPE.INSTANCE);if(!u.isMesosSlave(t))return this.setMesosState()},initialize:function(t,n){e.prototype.initialize.apply(this,arguments);if(n&&n.createByUser)return this.assignMesosSg()},setMesosState:t.prototype.setMesosState,getMesosState:t.prototype.getMesosState,getDefaultMesosAttributes:t.prototype.getDefaultMesosAttributes,setMesosAttributes:t.prototype.setMesosAttributes,_getMesosAttributes:t.prototype._getMesosAttributes,getMesosAttributes:t.prototype.getMesosAttributes,getMesosAppAttributes:t.prototype.getMesosAppAttributes,assignMesosSg:t.prototype.assignMesosSg,isRemovable:function(){return{error:s.CANVAS.ERR_DEL_LC}}},{handleTypes:r.RESTYPE.MESOSLC}),u.prototype.classId=e.prototype.classId,u}),define("wspace/awseditor/model/connection/TagUsage",["ConnectionModel","constant"],function(e,t){return e.extend({type:"TagUsage",constructor:function(n,r,i,s){return n.type===t.RESTYPE.VPN?n=n.getResourceModel():r.type===t.RESTYPE.VPN&&(r=r.getResourceModel()),e.apply(this,arguments)}})});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("wspace/awseditor/model/TagModel",["constant","ComplexResModel","GroupModel","Design","./connection/TagUsage"],function(e,t,n,r,i){var s,o,u;return s=["visualops","Name"],o=t.extend({type:"TagItem",isVisual:function(){return!1},initialize:function(e){if(e&&e.inherit===void 0)return this.unset("inherit")},serialize:function(){return _.extend({Key:this.get("key"),Value:this.get("value"),ResourceIds:this.genResourceIds()},this.has("inherit")?{PropagateAtLaunch:this.get("inherit")}:null)},genResourceIds:function(){return _.map(this.connectionTargets(),function(t){var n;return t.type===e.RESTYPE.ASG?n="AutoScalingGroupName":n=e.AWS_RESOURCE_KEY[t.type],t.createRef(n)})},update:function(e,t,n,r){var i;return t===this.get("key")?(this.parent().removeTag(e,this),this.parent().addTag(e,t,n,r)):(i=this.parent().addTag(e,t,n,r),i||this.parent().removeTag(e,this))}},{deserialize:function(e,t,n){var r,s,u,a,f,l,c;r={key:e.Key,value:e.Value,inherit:e.PropagateAtLaunch},t.get("name")!==t.constructor.customTagName&&(r.retain=!0),a=new o(r),t.addChild(a),c=e.ResourceIds;for(f=0,l=c.length;f<l;f++){s=c[f],u=n(MC.extractID(s));if(!u)continue;new i(u,a)}return a}}),u=n.extend({type:e.RESTYPE.TAG,isVisual:function(){return!1},serialize:function(){var e;e=_.invoke(_.filter(this.all(),function(e){return!!e.connections().length}),"serialize");if(!e.length)return;return{component:{name:this.get("name"),type:this.type,uid:this.id,resource:e}}},addTag:function(t,n,r,s){var u,a,f,l;r==null&&(r=""),_.isArray(t)||(t=[t]);if(this.tagKeyExist(t,n))return{error:"A tag with key '"+n+"' already exists"};this.type===e.RESTYPE.ASGTAG&&s===void 0&&(s=!0),this.type===e.RESTYPE.TAG&&(s=void 0),a=this.find(n,r,s),a||(a=new o({key:n,value:r,inherit:s,__parent:this}));for(f=0,l=t.length;f<l;f++)u=t[f],new i(u,a);return null},tagKeyExist:function(e,t){return __indexOf.call(s,t)>=0?!0:_.some(e,function(e){return _.some(e.connectionTargets("TagUsage"),function(e){return e.get("key")===t})})},find:function(e,t,n){var r;return r={key:e},arguments.length>1&&(r.value=t),arguments.length>2&&n!==void 0&&(r.inherit=n),_.find(this.all(),function(e){return _.isEqual(e.pick(_.keys(r)),r)})},removeTag:function(e,t){var n,r,s,o;_.isArray(e)||(e=[e]),o=[];for(r=0,s=e.length;r<s;r++)n=e[r],o.push((new i(n,t)).remove());return o},all:function(){return _.filter(this.children(),function(e){return!!e.connections().length})}},{handleTypes:[e.RESTYPE.TAG],customTagName:"EC2CustomTags",all:function(){var t,n;return n=[],t=r.modelClassForType(e.RESTYPE.ASGTAG),t.each(function(e){return n=n.concat(e.all())}),u.each(function(e){return n=n.concat(e.all())}),n},getCustom:function(){var e;return e=this.find(function(e){return function(t){return t.get("name")===e.customTagName}}(this)),e||new this({name:this.customTagName})},deserialize:function(e,t,n){var r,i,s,u,a,f,l;r={id:e.uid,name:e.name},u=new this(r),l=e.resource;for(a=0,f=l.length;a<f;a++)s=l[a],i=o.deserialize(s,u,n);return null}}),u}),define("wspace/awseditor/model/AsgTagModel",["constant","./TagModel","Design","./connection/TagUsage"],function(e,t,n,r){var i;return i=t.extend({type:e.RESTYPE.ASGTAG},{handleTypes:[e.RESTYPE.ASGTAG],customTagName:"AutoScalingCustomTags"}),i}),define("wspace/awseditor/model/deserializeVisitor/JsonFixer",["../DesignAws"],function(e){return e.registerDeserializeVisitor(function(e,t,n){var r,i,s,o,u,a,f,l;if(n>="2014-01-25")return;s={},i=[];for(a in t)u=t[a],u.type==="AWS.EC2.AvailabilityZone"?(u.groupUId==="Canvas"&&delete u.groupUId,i.push({uid:a,type:"AWS.EC2.AvailabilityZone",name:u.name}),s[u.name]=MC.genResRef(a,"name")):u.type==="AWS.AutoScaling.Group"&&u.originalId&&(e[a]={type:"ExpandedAsg",uid:a});o=function(e){var t,n,r,i,u,a;for(t in e){n=e[t];if(_.isString(n))n==="true"?e[t]=!0:n==="false"?e[t]=!1:s[n]&&(e[t]=s[n]);else if(_.isArray(n))for(i=u=0,a=n.length;u<a;i=++u)r=n[i],_.isObject(r)&&o(r),_.isString(r)&&(n==="true"?n[i]=!0:n==="false"?n[i]=!1:s[n]&&(n[i]=s[n]));else _.isObject(n)&&o(n)}return null};for(a in e)u=e[a],o(u);for(f=0,l=i.length;f<l;f++)r=i[f],e[r.uid]=r;return null}),null}),define("wspace/awseditor/model/deserializeVisitor/EipMerge",["../DesignAws"],function(e){return e.registerDeserializeVisitor(function(e,t){var n,r,i,s,o,u;for(u in e){n=e[u];if(n.type==="AWS.EC2.EIP")if(n.resource.NetworkInterfaceId){o=n.resource.PrivateIpAddress.split("."),r=e[MC.extractID(o[0])];if(!r)continue;s=r.resource.PrivateIpAddressSet[o[3]*1];if(!s)continue;s.EipResource=n}else i=e[MC.extractID(n.resource.InstanceId)],i&&(i.resource.EipResource=n)}return null}),null}),define("wspace/awseditor/model/deserializeVisitor/FixOldStack",["../DesignAws","constant","i18n!/nls/lang.js"],function(e,t,n){return e.registerDeserializeVisitor(function(r,i,s){var o,u,a,f;if(s>="2014-01-15")return;if(!e.instance().modeIsStack())return;for(f in r){o=r[f];if(o.type===t.RESTYPE.KP){if(o.name==="DefaultKP"){u=!0;if(a)break}}else if(o.type===t.RESTYPE.SG&&o.name==="DefaultSG"){a=!0;if(u)break}}return u||(f=MC.guid(),r[f]={uid:f,type:t.RESTYPE.KP,name:"DefaultKP",resource:{KeyName:"DefaultKP"}}),a||(f=MC.guid(),r[f]={uid:f,type:t.RESTYPE.SG,name:"DefaultSG",resource:{IpPermissions:[{IpProtocol:"tcp",IpRanges:"0.0.0.0/0",FromPort:"22",ToPort:"22",Groups:[{GroupId:"",UserId:"",GroupName:""}]}],IpPermissionsEgress:[],Default:"true",GroupName:"DefaultSG",GroupDescription:n.IDE.DESERIALIZE_VISITOR_GROUP_DESCRIPTION}}),null}),null}),define("wspace/awseditor/model/deserializeVisitor/AsgExpandor",["../DesignAws"],function(e){return e.registerDeserializeVisitor(function(e,t,n){var r,i,s;if(n<"2014-01-25")return;s=[];for(i in t)r=t[i],r.type==="ExpandedAsg"?s.push(e[i]={type:"ExpandedAsg",uid:i}):s.push(void 0);return s}),null}),define("wspace/awseditor/model/deserializeVisitor/ElbSgNamePatch",["../DesignAws","constant"],function(e,t){return e.registerDeserializeVisitor(function(e,n,r){var i,s,o,u,a,f,l,c,h,p,d,v;if(r>="2014-02-11")return;i=t.RESTYPE,u=[],l=[];for(c in e)s=e[c],s.type===i.ELB?u.push(s):s.type===i.SG&&l.push(s);for(h=0,d=u.length;h<d;h++){o=u[h],f=o.name+"-sg";for(p=0,v=l.length;p<v;p++){a=l[p];if(a.name===f){a.name="elbsg-"+o.name,a.resource.GroupName===f&&(a.resource.GroupName=a.name);break}}}return null}),null}),define("wspace/awseditor/model/serializeVisitor/EniIpAssigner",["../DesignAws","constant"],function(e,t){var n,r;return r=function(n,r){var i,s,o,u,a,f,l,c,h,p,d,v;f=e.instance().component(n),i=e.modelClassForType(t.RESTYPE.AZ),void 0,l=f.get("cidr");if(!l){void 0;return}u=[],a=[];for(c=0,p=r.length;c<p;c++){s=r[c],v=s.resource.PrivateIpAddressSet;for(h=0,d=v.length;h<d;h++)o=v[h],o.AutoAssign===!0?u.push(o):a.push(o.PrivateIpAddress)}return{subnetCid:l,ipSet:u,reserveIpSet:a}},n=function(n){var r,i,s,o,u,a;s=e.modelClassForType(t.RESTYPE.ENI).getAvailableIPInCIDR(n.subnetCid,n.reserveIpSet,n.ipSet.length),s=_.filter(s,function(e){return e.available}),a=n.ipSet;for(r=o=0,u=a.length;o<u;r=++o)i=a[r],s[r]?i.PrivateIpAddress=s[r].ip:i.PrivateIpAddress="";return null},e.registerSerializeVisitor(function(i){var s,o,u,a,f,l,c;if(e.instance().modeIsApp())return;l={};for(c in i)o=i[c],o.type===t.RESTYPE.ENI&&(o.resource.SubnetId&&o.resource.SubnetId[0]==="@"?f=o.resource.SubnetId:f=o.resource.AvailabilityZone,s=l[f],s||(s=l[f]=[]),s.splice(_.sortedIndex(s,o,"name"),0,o));for(c in l)a=l[c],c=MC.extractID(c),u=r(c,a),u&&n(u);return null}),null}),define("wspace/awseditor/model/serializeVisitor/AppToStack",["../DesignAws"],function(e){return e.registerSerializeVisitor(function(e,t,n){var r,i,s,o,u,a;if(!n||!n.toStack)return;a=[];for(r in e){i=e[r];switch(i.type){case"AWS.VPC.VPC":a.push(i.resource.VpcId="");break;case"AWS.VPC.NetworkInterface":i.resource.NetworkInterfaceId="",a.push(i.resource.Attachment.AttachmentId="");break;case"AWS.EC2.Instance":i.resource.InstanceId="",a.push(_.each(i.resource.BlockDeviceMapping,function(e){var t;if(((t=e.Ebs)!=null?t.VolumeType:void 0)&&e.Ebs.VolumeType!=="io1"&&e.Ebs.Iops)return i.Ebs.Iops=""}));break;case"AWS.VPC.Subnet":a.push(i.resource.SubnetId="");break;case"AWS.EC2.EIP":i.resource.AllocationId="",a.push(i.resource.PublicIp="");break;case"AWS.VPC.RouteTable":i.resource.RouteTableId="",a.push(i.resource.AssociationSet.forEach(function(e){e.RouteTableAssociationId=""}));break;case"AWS.EC2.SecurityGroup":i.resource.GroupId="",a.push(i.resource.GroupName=i.name);break;case"AWS.VPC.InternetGateway":a.push(i.resource.InternetGatewayId="");break;case"AWS.VPC.NetworkAcl":i.resource.NetworkAclId="",a.push(i.resource.AssociationSet.forEach(function(e){e.NetworkAclAssociationId=""}));break;case"AWS.VPC.VPNGateway":a.push(i.resource.VpnGatewayId="");break;case"AWS.VPC.VPNConnection":a.push(i.resource.VpnConnectionId="");break;case"AWS.VPC.CustomerGateway":a.push(i.resource.CustomerGatewayId="");break;case"AWS.EC2.EBS.Volume":i.resource.VolumeId="",i.resource.VolumeType&&i.resource.VolumeType!=="io1"&&i.resource.Iops?(i.resource.Iops="",a.push(null)):a.push(void 0);break;case"AWS.EC2.Tag":i.name==="EC2InternalTags"?a.push(delete e[r]):a.push(void 0);break;case"AWS.AutoScaling.Tag":i.name==="AutoScalingInternalTags"?a.push(delete e[r]):a.push(void 0);break;case"AWS.ELB":i.resource.DNSName="",a.push(i.resource.LoadBalancerName=i.name);break;case"AWS.AutoScaling.LaunchConfiguration":i.resource.LaunchConfigurationARN="",i.resource.LaunchConfigurationName=i.name,a.push(_.each(i.resource.BlockDeviceMapping,function(e){var t;if(((t=e.Ebs)!=null?t.VolumeType:void 0)&&e.Ebs.VolumeType!=="io1"&&e.Ebs.Iops)return e.Ebs.Iops="",null}));break;case"AWS.AutoScaling.Group":i.resource.AutoScalingGroupARN="",a.push(i.resource.AutoScalingGroupName=i.name);break;case"AWS.AutoScaling.NotificationConfiguration":a.push(void 0);break;case"AWS.SNS.Subscription":a.push(void 0);break;case"AWS.AutoScaling.ScalingPolicy":a.push(i.resource.PolicyARN="");break;case"AWS.CloudWatch.CloudWatch":i.resource.AlarmArn="",a.push(i.resource.AlarmName=i.name);break;case"AWS.RDS.DBInstance":u="",o=MC.extractID(i.resource.ReadReplicaSourceDBInstanceIdentifier),o&&(s=e[o],s&&(u=s.resource.ReadReplicaSourceDBInstanceIdentifier)),u?(s.resource.BackupRetentionPeriod=0,a.push(delete e[i.uid])):(i.resource.CreatedBy="",i.resource.DBInstanceIdentifier="",i.resource.Endpoint.Address="",i.resource.PreferredBackupWindow="",i.resource.PreferredMaintenanceWindow="",i.resource.ReadReplicaSourceDBInstanceIdentifier?a.push(i.resource.MasterUserPassword="****"):a.push(i.resource.MasterUserPassword="12345678"));break;case"AWS.RDS.DBSubnetGroup":i.resource.CreatedBy="",a.push(i.resource.DBSubnetGroupName="");break;case"AWS.RDS.OptionGroup":i.resource.OptionGroupName="",a.push(i.resource.CreatedBy="")}}return a}),null}),define("wspace/awseditor/canvas/CanvasViewAwsLayout",["./CanvasViewAws","CanvasViewLayout","constant"],function(e,t,n){var r,i,s,o,u,a,f,l,c;return c=function(e){return e.sort(function(e,t){return t.component.connections("ElbAmiAsso").length-e.component.connections("ElbAmiAsso")})},f=function(e){var n,r,i,s,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;l=t.DefaultGroupMethod.call(this,e),p=null,s=null,n=null,f=null,b=[];for(w=0,T=l.length;w<T;w++)r=l[w],r.type==="AWS.VPC.NetworkInterface_group"?s=r:r.type==="AWS.EC2.Instance_group"?p=r:r.type==="ExpandedAsg_group"?f=r:r.type==="AWS.AutoScaling.Group_group"?n=r:b.push(r);f&&(n?n.children=n.children.concat(f.children):(f.type="AWS.AutoScaling.Group_group",n=f)),n&&b.unshift(n);if(p&&s){v={},d={},y=[],a={},O=s.children;for(E=0,N=O.length;E<N;E++)i=O[E],a[i.component.id]=i;g=[],m=[],M=p.children;for(S=0,C=M.length;S<C;S++){h=M[S],u=h.component.connectionTargets("EniAttachment");if(!u.length)g.push(h);else{o=[h],v[h.component.id]=!0;for(x=0,k=u.length;x<k;x++)i=u[x],a[i.id]&&(d[i.id]=!0,o.push(a[i.id]));y.push({type:"AmiEniPair",children:o})}}_=s.children;for(A=0,L=_.length;A<L;A++)i=_[A],d[i.component.id]||m.push(i);return c(g),b.push({type:"AWS.EC2.Instance_group",children:g}),b.push({type:"AmiEniPari_group",children:y}),b.push({type:"AWS.VPC.NetworkInterface_group",children:m}),b}return p&&(c(p.children),b.push(p)),s&&b.push(s),b},a=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p;a=[],f=[],u={},i=[];for(l=0,h=e.length;l<h;l++)t=e[l],t.component.slaves().length&&(u[t.component.id]=[t]);for(c=0,p=e.length;c<p;c++)t=e[c],s=t.component.master(),s?u[s.id]?u[s.id].push(t):i.push(t):u[t.component.id]||f.push(t);r=[];for(n in u)o=u[n],o.length===1?r.push(o[0]):a.push({type:"MasterSlave",children:o});return r.length&&a.push({type:"MasterSlave",children:r}),t=[],a.length&&t.push({type:"MasterSlave_group",children:a}),i.length&&t.push({type:"AWS.RDS.DBInstance_group",children:i}),f.length&&t.push({type:"AWS.RDS.DBInstance_group",children:f}),t},r=function(e){var t,n,r,i,s,o;if(!e.length)return{width:0,height:0};if(e.length===1)return{width:e[0].width,height:e[0].height};e.sort(function(e,t){return t.height-e.height}),r=0;while(r<e.length)t=e[r],n=e[r+1],n&&n.width*n.height>t.width*t.height&&(e[r]=n,e[r+1]=t),r+=2;o=e[0].height+5,i=0,s=0,r=0;while(r<e.length)t=e[r],n=e[r+1],t.y=0,n?(t.x=i,i+=t.width+4,n.x=s,n.y=o,s+=n.width+4):i>s?(t.x=s,t.y=o,s+=t.width+4):(t.x=i,t.y=0,i+=t.width+4),r+=2;return{width:Math.max(i,s)-4,height:e[1].height+o}},o=function(e){var t,r,i,s,o,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;f=u[n.RESTYPE.VPC],a={};for(m=0,b=e.length;m<b;m++)o=e[m],a[o.type]=o;i=a["AWS.ELB_group"]?18:5,s=4,p=i,o=a["AWS.VPC.RouteTable_group"],o&&(o.x=i,o.y=s,s+=o.height+3),l=s,o=a["AWS.EC2.AvailabilityZone_group"],o&&(o.x=i,o.y=s,p=i+o.width+4,l+=o.children[0].y+o.children[0].height+3),o=a["AWS.ELB_group"];if(o){o.x=5,o.y=l,o.x+o.width>p&&(p=o.x+o.width+4),r=a["AWS.EC2.AvailabilityZone_group"];if(r){S=r.children;for(g=0,w=S.length;g<w;g++)t=S[g],t.y!==0&&(t.y+=o.height+6-5);r.height+=o.height+6-5}}o=a["AWS.RDS.DBSubnetGroup_group"],o&&(o.x=p,o.y=s),v=0,h=0;for(y=0,E=e.length;y<E;y++)o=e[y],d=o.x+o.width,d>v&&(v=d),c=o.y+o.height,c>h&&(h=c);return{width:v+5,height:h+4}},s=function(e){var n,r,i,s;r=[];for(i=0,s=e.length;i<s;i++)n=e[i],n.type==="AWS.VPC.VPC_group"?r.unshift(n):r.push(n);return t.DefaultArrangeMethod.call(this,r)},i=function(e){var t,n,r,i,s;r=Math.ceil(Math.sqrt(e.length/6));for(n=i=0,s=e.length;i<s;n=++i)t=e[n],t.x=Math.floor(n/r)*22,t.y=n%r*11;return{width:Math.ceil(e.length/r)*22-10,height:r*11-2}},l=function(e){var t,r,i,s,o,u,a;t=[],r=[],o=[];for(u=0,a=e.length;u<a;u++){i=e[u];if(i.type===n.RESTYPE.RT&&i.get("main")){o.unshift(i);continue}if(i.type===n.RESTYPE.ELB){s=i.get("internal")?r:t,i.connections("ElbAmiAsso").length?s.unshift(i):s.push(i);continue}o.push(i)}return o.concat(t,r)},u=e.prototype.autoLayoutConfig={SVG:{arrangeMethod:s,space:6},"AWS.VPC.CustomerGateway_group":{arrangeMethod:"ArrangeVertical",space:2},"AWS.VPC.VPC":{arrangeMethod:o,space:4,sortMethod:l,margin:2,width:60,height:60},"AWS.VPC.VPNGateway":{sticky:!0},"AWS.VPC.InternetGateway":{sticky:!0},"AWS.ELB_group":{space:11,arrangeMethod:i},"AWS.ELB":{width:9,height:9},"AWS.VPC.RouteTable_group":{space:4},"AWS.VPC.RouteTable":{width:9,height:9},"AWS.EC2.AvailabilityZone_group":{arrangeMethod:r},"AWS.EC2.AvailabilityZone":{margin:2,width:15,height:15},"AWS.RDS.DBSubnetGroup_group":{arrangeMethod:"ArrangeBinPack",space:4},"AWS.RDS.DBSubnetGroup":{groupMethod:a,margin:2,space:3,width:11,height:11},"AWS.RDS.DBInstance":{width:9,height:9},"AWS.RDS.DBInstance_group":{arrangeMethod:"ArrangeBinPack",space:2},MasterSlave:{arrangeMethod:"ArrangeVertical",space:2},MasterSlave_group:{space:1},"AWS.AutoScaling.LaunchConfiguration":{ignore:!0},"AWS.VPC.NetworkInterface_group":{arrangeMethod:"ArrangeBinPack",space:4},"AWS.VPC.NetworkInterface":{width:9,height:9},"AWS.EC2.Instance_group":{arrangeMethod:"ArrangeBinPack",space:2},"AWS.EC2.Instance":{width:9,height:9},"AWS.AutoScaling.Group_group":{arrangeMethod:"ArrangeBinPack",space:2},"AWS.AutoScaling.Group":{width:13,height:13},ExpandedAsg:{width:13,height:13},"AWS.VPC.Subnet_group":{arrangeMethod:"ArrangeBinPack",space:2},"AWS.VPC.Subnet":{groupMethod:f,margin:2,space:2,width:13,height:13},"AWS.VPC.CustomerGateway":{width:17,height:10},AmiEniPair:{space:1},AmiEniPari_group:{arrangeMethod:"ArrangeVertical",space:1}},null}),define("wspace/awseditor/canvas/CeVpc",["CanvasElement","constant","CanvasManager","CanvasView"],function(e,t,n,r){return e.extend({type:t.RESTYPE.VPC,parentType:["SVG"],listenModelEvents:function(){this.listenTo(this.model,"change:cidr",this.render)},create:function(){return this.canvas.appendVpc(this.createGroup())},siblings:function(){var e;return e=this.canvas,e.design.componentsOfType(t.RESTYPE.CGW).map(function(t){return e.getItem(t.id)})},label:function(){return""+this.model.get("name")+" ("+this.model.get("cidr")+")"},render:function(){var e;return e=this.model,n.setLabel(this,this.$el.children("text")),this.$el[0].instance.move(e.x()*r.GRID_WIDTH,e.y()*r.GRID_WIDTH)}})}),define("wspace/awseditor/canvas/CeAz",["CanvasElement","constant","CanvasManager","CanvasView"],function(e,t,n,r){return e.extend({type:t.RESTYPE.AZ,parentType:[t.RESTYPE.VPC],defaultSize:[23,23],create:function(){return this.canvas.appendAz(this.createGroup())},render:function(){var e;return e=this.model,n.update(this.$el.children("text"),e.get("name")),this.$el[0].instance.move(e.x()*r.GRID_WIDTH,e.y()*r.GRID_WIDTH)}},{createResource:function(n,r,i){var s;return r.width=21,r.height=21,s=e.createResource(n,r,i),e.createResource(t.RESTYPE.SUBNET,{x:r.x+2,y:r.y+2,width:r.width-4,height:r.height-4,parent:s},i)}})}),define("wspace/awseditor/canvas/CeSubnet",["CanvasElement","constant","CanvasManager","i18n!/nls/lang.js","CanvasView"],function(e,t,n,r,i){return e.extend({type:t.RESTYPE.SUBNET,parentType:[t.RESTYPE.AZ],defaultSize:[19,19],portPosition:function(t,n){var r,s,o;return r=this.model,s=r.height()*i.GRID_HEIGHT/2-5,t==="subnet-assoc-in"?[-12,s,e.constant.PORT_LEFT_ANGLE]:(o=r.width()*i.GRID_WIDTH+4,n&&(o+=8),[o,s,e.constant.PORT_RIGHT_ANGLE])},listenModelEvents:function(){this.listenTo(this.model,"change:cidr",this.render)},create:function(){var e,t,n;return t=this.canvas.svg,n=this.canvas.appendSubnet(this.createGroup()),n.add([t.use("port_right").attr({"class":"port port-gray tooltip","data-name":"subnet-assoc-in","data-tooltip":r.IDE.PORT_TIP_L}),t.use("port_right").attr({"class":"port port-gray tooltip","data-name":"subnet-assoc-out","data-tooltip":r.IDE.PORT_TIP_M})]),e=this.model,this.initNode(n,e.x(),e.y()),n},label:function(){return""+this.model.get("name")+" ("+this.model.get("cidr")+")"},render:function(){var e;return e=this.model,n.setLabel(this,this.$el.children("text")),this.$el[0].instance.move(e.x()*i.GRID_WIDTH,e.y()*i.GRID_WIDTH)},containPoint:function(e,t){var n,r,i;return r=this.model.x()-2,i=this.model.y(),n=this.size(),r<=e&&i<=t&&r+n.width+4>=e&&i+n.height>=t}})}),define("wspace/awseditor/canvas/CeRtb",["CanvasElement","constant","CanvasManager","i18n!/nls/lang.js"],function(e,t,n,r){return e.extend({type:t.RESTYPE.RT,parentType:[t.RESTYPE.VPC],defaultSize:[8,8],portPosMap:{"rtb-tgt-left":[10,35,e.constant.PORT_LEFT_ANGLE,8,35],"rtb-tgt-right":[70,35,e.constant.PORT_RIGHT_ANGLE,72,35],"rtb-src-top":[40,3,e.constant.PORT_UP_ANGLE],"rtb-src-bottom":[40,77,e.constant.PORT_DOWN_ANGLE]},portDirMap:{"rtb-tgt":"horizontal","rtb-src":"vertical"},iconUrl:function(){return this.model.get("main")?"ide/icon/cvs-rtb-main.png":"ide/icon/cvs-rtb.png"},listenModelEvents:function(){this.listenTo(this.model,"change:main",this.render)},create:function(){var e,t,n;return e=this.model,n=this.canvas.svg,t=this.createNode({image:this.iconUrl(),imageX:10,imageY:13,imageW:60,imageH:57}).add([n.text("").move(41,27).classes("node-label"),n.use("port_left").attr({"class":"port port-blue tooltip","data-name":"rtb-tgt","data-alias":"rtb-tgt-left","data-tooltip":r.IDE.PORT_TIP_B}),n.use("port_right").attr({"class":"port port-blue tooltip","data-name":"rtb-tgt","data-alias":"rtb-tgt-right","data-tooltip":r.IDE.PORT_TIP_B}),n.use("port_bottom").attr({"class":"port port-gray tooltip","data-name":"rtb-src","data-alias":"rtb-src-top","data-tooltip":r.IDE.PORT_TIP_A}),n.use("port_top").attr({"class":"port port-gray tooltip","data-name":"rtb-src","data-alias":"rtb-src-bottom","data-tooltip":r.IDE.PORT_TIP_A})]),this.canvas.appendNode(t),this.initNode(t,e.x(),e.y()),t},labelWidth:function(t){return e.prototype.labelWidth.call(this,t)-20},render:function(){return n.setLabel(this,this.$el.children(".node-label")),n.update(this.$el.children("image"),this.iconUrl(),"href")}})}),define("wspace/awseditor/canvas/CeIgw",["CanvasElement","constant","CanvasManager","i18n!/nls/lang.js","Design"],function(e,t,n,r,i){return e.extend({type:t.RESTYPE.IGW,parentType:[t.RESTYPE.VPC],defaultSize:[8,8],portPosMap:{"igw-tgt":[78,35,e.constant.PORT_RIGHT_ANGLE]},sticky:"left",create:function(){var e,t,n;return e=this.model,t=this.canvas.svg,n=this.createNode({image:"ide/icon/cvs-igw.png",imageX:10,imageY:16,imageW:60,imageH:46,label:e.get("name")}).add(t.use("port_left").attr({"class":"port port-blue tooltip","data-name":"igw-tgt","data-tooltip":r.IDE.PORT_TIP_C})),this.canvas.appendNode(n),this.initNode(n,e.x(),e.y()),n}})}),define("wspace/awseditor/canvas/CeVgw",["CanvasElement","constant","CanvasManager","i18n!/nls/lang.js"],function(e,t,n,r){return e.extend({type:t.RESTYPE.VGW,parentType:[t.RESTYPE.VPC],defaultSize:[8,8],portPosMap:{"vgw-tgt":[3,35,e.constant.PORT_LEFT_ANGLE],"vgw-vpn":[70,35,e.constant.PORT_RIGHT_ANGLE,72,35]},sticky:"right",create:function(){var e,t,n;return e=this.model,t=this.canvas.svg,n=this.createNode({image:"ide/icon/cvs-vgw.png",imageX:10,imageY:16,imageW:60,imageH:46,label:e.get("name")}).add([t.use("port_right").attr({"class":"port port-blue tooltip","data-name":"vgw-tgt","data-tooltip":r.IDE.PORT_TIP_C}),t.use("port_right").attr({"class":"port port-purple tooltip","data-name":"vgw-vpn","data-tooltip":r.IDE.PORT_TIP_H})]),this.canvas.appendNode(n),this.initNode(n,e.x(),e.y()),n}},{createResource:function(n,r,i){var s;s=Design.modelClassForType(t.RESTYPE.VPC).theVPC(),r.x=s.x()+s.width()-4;if(r.y<s.y()||r.y+8>s.y()+s.height())r.y=s.y()+Math.round(s.height()/2)-4;return r.parent=s,e.createResource(n,r,i)}})}),define("wspace/awseditor/canvas/CeCgw",["CanvasElement","constant","CanvasManager","i18n!/nls/lang.js"],function(e,t,n,r){return e.extend({type:t.RESTYPE.CGW,parentType:["SVG"],defaultSize:[17,10],portPosMap:{"cgw-vpn":[6,45,e.constant.PORT_LEFT_ANGLE]},create:function(){var e,t,n;return e=this.model,t=this.canvas.svg,n=this.createNode({image:"ide/icon/cvs-cgw.png",imageX:13,imageY:8,imageW:151,imageH:76}).add([t.text("").move(90,95).classes("node-label"),t.use("port_right").attr({"class":"port port-purple tooltip","data-name":"cgw-vpn","data-tooltip":r.IDE.PORT_TIP_I})]),this.canvas.appendNode(n),this.initNode(n,e.x(),e.y()),n},labelWidth:function(t){return e.prototype.labelWidth.call(this,t)-4},render:function(){return n.setLabel(this,this.$el.children(".node-label"))}})}),define("wspace/awseditor/canvas/CeElb",["CanvasElement","constant","CanvasManager","i18n!/nls/lang.js"],function(e,t,n,r){return e.extend({type:t.RESTYPE.ELB,parentType:[t.RESTYPE.VPC],defaultSize:[9,9],portPosMap:{"elb-sg-in":[2,35,e.constant.PORT_LEFT_ANGLE],"elb-assoc":[79,50,e.constant.PORT_RIGHT_ANGLE,81,50],"elb-sg-out":[79,20,e.constant.PORT_RIGHT_ANGLE,81,20]},iconUrl:function(){return this.model.get("internal")?"ide/icon/cvs-elb-int.png":"ide/icon/cvs-elb-ext.png"},listenModelEvents:function(){this.listenTo(this.model,"change:internal",this.render)},create:function(){var e,t,n;return e=this.model,t=this.canvas.svg,n=this.createNode({image:this.iconUrl(),imageX:9,imageY:11,imageW:70,imageH:53,label:e.get("name"),sg:!0}).add([t.use("port_right").attr({"class":"port port-blue tooltip","data-name":"elb-sg-in","data-tooltip":r.IDE.PORT_TIP_D}),t.use("port_right").attr({"class":"port port-gray tooltip","data-name":"elb-assoc","data-tooltip":r.IDE.PORT_TIP_K}),t.use("port_right").attr({"class":"port port-blue tooltip","data-name":"elb-sg-out","data-tooltip":r.IDE.PORT_TIP_J})]),this.canvas.appendNode(n),this.initNode(n,e.x(),e.y()),n},render:function(){var e;return e=this.model,n.setLabel(this,this.$el.children(".node-label")),n.update(this.$el.children("image"),this.iconUrl(),"href"),n.toggle(this.$el.children('[data-name="elb-sg-in"]'),e.get("internal"))}})}),define("wspace/awseditor/canvas/CpInstance",["CanvasPopup","./TplPopup","./CpVolume","event","constant","CloudResources"],function(e,t,n,r,i,s){return e.extend({type:"InstancePopup",attachType:"overlay",className:"canvas-pp instance",events:{"click .instance-pph-close":"remove","click li":"selectItem","click .vpp-ins-vol":"showVolume"},initialize:function(){e.prototype.initialize.apply(this,arguments),this.selectItem({currentTarget:this.$el.find("li")[0]})},content:function(){return t.instance({name:this.host.get("name"),items:this.models||[]})},selectItem:function(e){return this.canvas.deselectItem(!0),this.$el.find(".selected").removeClass("selected"),this.canvas.triggerSelected(i.RESTYPE.INSTANCE,$(e.currentTarget).addClass("selected").attr("data-id")),!1},remove:function(){return this.volPopup&&this.volPopup.remove(),e.prototype.remove.apply(this,arguments)},showVolume:function(e){var t,r,o,u,a,f,l,c,h,p,d,v;u=this.canvas.design.region(),t=$(e.currentTarget).closest(".vpp-instance"),o=s(this.canvas.design.credentialId(),i.RESTYPE.INSTANCE,u).get(t.attr("data-id"));if(!o)return;o=o.attributes,f=s(this.canvas.design.credentialId(),i.RESTYPE.VOL,u),l=[],d=o.blockDeviceMapping;for(h=0,p=d.length;h<p;h++){r=d[h];if(r.deviceName!==o.rootDeviceName){c=(v=r.ebs)!=null?v.volumeId:void 0;if(!c)continue;a=f.get(c);if(!a)continue;l.push({id:a.id,appId:a.id,name:r.deviceName,snapshot:a.get("snapshotId"),size:a.get("size"),state:a.get("state")||"unknown"})}}return this.volPopup=new n({attachment:t[0],models:l,canvas:this.canvas}),!1}})}),define("wspace/awseditor/canvas/CpEni",["./CpInstance","./TplPopup","constant"],function(e,t,n){return e.extend({content:function(){return t.eni({name:this.host.get("name"),items:this.models||[]})},selectItem:function(e){return this.canvas.deselectItem(!0),this.$el.find(".selected").removeClass("selected"),this.canvas.triggerSelected(n.RESTYPE.ENI,$(e.currentTarget).addClass("selected").attr("data-id")),!1}})}),define("wspace/awseditor/canvas/CeEni",["CanvasElement","constant","CanvasManager","eip_selector","i18n!/nls/lang.js","CloudResources","./CpEni","event"],function(e,t,n,r,i,s,o,u){return e.extend({type:t.RESTYPE.ENI,parentType:[t.RESTYPE.SUBNET],defaultSize:[9,9],portPosMap:{"eni-sg-left":[10,20,e.constant.PORT_LEFT_ANGLE],"eni-attach":[8,50,e.constant.PORT_LEFT_ANGLE],"eni-sg-right":[80,20,e.constant.PORT_RIGHT_ANGLE],"eni-rtb":[45,2,e.constant.PORT_UP_ANGLE]},portDirMap:{"eni-sg":"horizontal"},events:{"mousedown .eip-status":"toggleEip","mousedown .server-number-group":"showGroup","click .eip-status":function(){return!1}},iconUrl:function(){return this.model.connections("EniAttachment").length?"ide/icon/cvs-eni-att.png":"ide/icon/cvs-eni-unatt.png"},listenModelEvents:function(){this.listenTo(this.model,"change:connections",this.onConnectionChange),this.listenTo(this.model,"change:primaryEip",this.render),this.listenTo(this.canvas,"switchMode",this.render)},onConnectionChange:function(e){if(e.type==="EniAttachment")return this.render()},toggleEip:function(){var e;return this.canvas.design.modeIsApp()?!1:(e=!this.model.hasPrimaryEip(),this.canvas.design.modeIsAppEdit()&&e?(this.selectEip(),!1):(this.model.setPrimaryEip(e),e&&Design.modelClassForType(t.RESTYPE.IGW).tryCreateIgw(),n.updateEip(this.$el.children(".eip-status"),this.model),u.trigger(u.PROPERTY_REFRESH_ENI_IP_LIST),!1))},selectEip:function(){var e,i;return i=this,!this.canvas.design.modeIsAppEdit||this.model.hasPrimaryEip()?!1:(e=new r(i.model),e.on("assign",function(){return Design.modelClassForType(t.RESTYPE.IGW).tryCreateIgw(),n.updateEip(i.$el.children(".eip-status"),i.model),u.trigger(u.PROPERTY_REFRESH_ENI_IP_LIST),e.off("assign"),!1}))},create:function(){var e,t,n;return e=this.model,t=this.canvas.svg,n=this.createNode({image:this.iconUrl(),imageX:16,imageY:15,imageW:59,imageH:49,label:!0,labelBg:!0,sg:!0}).add([t.image("",12,14).move(44,37).classes("eip-status tooltip"),t.use("port_diamond").attr({"class":"port port-blue tooltip","data-name":"eni-sg","data-alias":"eni-sg-left","data-tooltip":i.IDE.PORT_TIP_D}),t.use("port_right").attr({"class":"port port-green tooltip","data-name":"eni-attach","data-tooltip":i.IDE.PORT_TIP_G}),t.use("port_diamond").attr({"class":"port port-blue tooltip","data-name":"eni-sg","data-alias":"eni-sg-right","data-tooltip":i.IDE.PORT_TIP_F}),t.use("port_bottom").attr({"class":"port port-blue tooltip","data-name":"eni-rtb","data-tooltip":i.IDE.PORT_TIP_C}),t.group().add([t.rect(20,14).move(36,2).radius(3).classes("server-number-bg"),t.plain("0").move(46,13).classes("server-number")]).classes("server-number-group")]),this.canvas.appendNode(n),this.initNode(n,e.x(),e.y()),n},render:function(){var e,t,r;return t=this.model,n.setLabel(this,this.$el.children(".node-label")),n.update(this.$el.children("image:not(.eip-status)"),this.iconUrl(),"href"),e=t.serverGroupCount(),r=this.$el.children(".server-number-group"),n.toggle(this.$el.children(".port-eni-rtb"),e<=1),n.toggle(r,e>1),r.children("text").text(e),n.updateEip(this.$el.children(".eip-status"),t)},showGroup:function(){var e,t,n,r,i,u,a,f,l,c,h;if(!this.canvas.design.modeIsApp())return;i=s(this.model.design().credentialId(),this.type,this.model.design().region()),a=(this.model.groupMembers()||[]).slice(0),a.unshift({appId:this.model.get("appId"),ips:this.model.get("ips")}),f=this.model.get("name"),t=[];for(n=l=0,c=a.length;l<c;n=++l){u=a[n],r=i.get(u.appId);if(!r){void 0;continue}r=r.attributes,e=(u.ips||[])[0],t.push({name:""+f+"-"+n,id:u.appId,eip:e!=null?(h=e.eipData)!=null?h.publicIp:void 0:void 0})}new o({attachment:this.$el[0],host:this.model,models:t,canvas:this.canvas})}})}),define("wspace/awseditor/canvas/CeInstance",["CanvasElement","constant","CanvasManager","./CpVolume","./CpInstance","i18n!/nls/lang.js","CloudResources","eip_selector","event","UI.notification"],function(e,t,n,r,i,s,o,u,a){return e.extend({type:t.RESTYPE.INSTANCE,parentType:[t.RESTYPE.AZ,t.RESTYPE.SUBNET,t.RESTYPE.ASG,"ExpandedAsg"],defaultSize:[9,9],portPosMap:{"instance-sg-left":[10,20,e.constant.PORT_LEFT_ANGLE],"instance-sg-right":[80,20,e.constant.PORT_RIGHT_ANGLE],"instance-attach":[78,50,e.constant.PORT_RIGHT_ANGLE,80,50],"instance-rtb":[45,2,e.constant.PORT_UP_ANGLE]},portDirMap:{"instance-sg":"horizontal"},events:{"mousedown .eip-status":"toggleEip","mousedown .volume-image":"showVolume","mousedown .server-number-group":"showGroup","click .eip-status":"suppressEvent","click .volume-image":"suppressEvent","click .server-number-group":"suppressEvent"},suppressEvent:function(){return!1},iconUrl:function(){var e,t,n,r;return this.model.isMesosMaster()?r="ide/ami/mesos-master.png":this.model.isMesosSlave()?r="ide/ami/mesos-slave.png":(e=this.model.getAmi()||this.model.get("cachedAmi"),e?r="ide/ami/"+e.osType+"."+e.architecture+"."+e.rootDeviceType+".png":(n=this.model,t=o(n.design().credentialId(),n.type,n.design().region()).get(n.get("appId")),t?(t=t.attributes,t.platform&&t.platform==="windows"?r="ide/ami/windows."+t.architecture+"."+t.rootDeviceType+".png":r="ide/ami/linux-other."+t.architecture+"."+t.rootDeviceType+".png"):r="ide/ami/ami-not-available.png")),r},listenModelEvents:function(){this.listenTo(this.model,"change:primaryEip",this.render),this.listenTo(this.model,"change:imageId",this.render),this.listenTo(this.model,"change:volumeList",this.render),this.listenTo(this.model,"change:count",this.updateServerCount),this.listenTo(this.canvas,"switchMode",this.render),this.listenTo(this.canvas,"change:externalData",this.render)},updateServerCount:function(){var e,t,n,r,i;this.render(),r=this.model.connectionTargets("EniAttachment");for(t=0,n=r.length;t<n;t++)e=r[t],(i=this.canvas.getItem(e.id))!=null&&i.render()},toggleEip:function(){var e;return this.canvas.design.modeIsApp()?!1:(e=!this.model.hasPrimaryEip(),this.canvas.design.modeIsAppEdit()&&e?(this.selectEip(),!1):(this.model.setPrimaryEip(e),e&&Design.modelClassForType(t.RESTYPE.IGW).tryCreateIgw(),n.updateEip(this.$el.children(".eip-status"),this.model),a.trigger(a.PROPERTY_REFRESH_ENI_IP_LIST),!1))},selectEip:function(){var e,r;return r=this,!this.canvas.design.modeIsAppEdit||this.model.hasPrimaryEip()?!1:(e=new u(r.model),e.on("assign",function(){return Design.modelClassForType(t.RESTYPE.IGW).tryCreateIgw(),n.updateEip(r.$el.children(".eip-status"),r.model),a.trigger(a.PROPERTY_REFRESH_ENI_IP_LIST),e.off("assign"),!1}))},select:function(e){var t;t=this.type,this.model.get("appId")&&this.canvas.design.modeIsAppEdit()&&(t="component_server_group"),this.canvas.triggerSelected(t,this.model.id)},create:function(){var e,t,n;return e=this.model,t=this.canvas.svg,n=this.createNode({image:"ide/icon/cvs-instance.png",imageX:15,imageY:11,imageW:61,imageH:62,label:!0,labelBg:!0,sg:!0}).add([t.image(MC.IMG_URL+this.iconUrl(),39,27).move(27,15).classes("ami-image"),t.image(MC.IMG_URL+"ide/icon/icn-vol.png",29,24).move(21,46).classes("volume-image"),t.text("").move(35,58).classes("volume-number"),t.image("",12,14).move(53,49).classes("eip-status tooltip"),t.use("port_diamond").attr({"class":"port port-blue tooltip","data-name":"instance-sg","data-alias":"instance-sg-left","data-tooltip":s.IDE.PORT_TIP_D}),t.use("port_right").attr({"class":"port port-green tooltip","data-name":"instance-attach","data-tooltip":s.IDE.PORT_TIP_E}),t.use("port_diamond").attr({"class":"port port-blue tooltip","data-name":"instance-sg","data-alias":"instance-sg-right","data-tooltip":s.IDE.PORT_TIP_D}),t.use("port_bottom").attr({"class":"port port-blue tooltip","data-name":"instance-rtb","data-tooltip":s.IDE.PORT_TIP_C}),t.group().add([t.rect(20,14).move(36,2).radius(3).classes("server-number-bg"),t.plain("0").move(46,13).classes("server-number")]).classes("server-number-group")]),!this.model.design().modeIsStack()&&e.get("appId")&&n.add(t.circle(8).move(63,14).classes("res-state unknown")),this.canvas.appendNode(n),this.initNode(n,e.x(),e.y()),n},render:function(){var e,t,r,i,s,u;return t=this.model,n.setLabel(this,this.$el.children(".node-label")),n.update(this.$el.children(".ami-image"),this.iconUrl(),"href"),r=this.$el.children(".server-number-group"),s=this.$el.children(".res-state"),t.get("count")>1?(n.toggle(s,!1),n.toggle(r,!0),n.update(r.children("text"),t.get("count"))):(n.toggle(s,!0),n.toggle(r,!1),s.length&&(e=o(t.design().credentialId(),t.type,t.design().region()).get(t.get("appId")),i=(e!=null?e.get("instanceState").name:void 0)||"unknown",s.data("tooltip",i).attr("data-tooltip",i).attr("class","res-state tooltip "+i))),n.updateEip(this.$el.children(".eip-status"),t),u=t.get("volumeList")?t.get("volumeList").length:0,n.update(this.$el.children(".volume-number"),u)},showVolume:function(){var e;return this.canvas.design.modeIsApp()&&this.model.get("count")>1?!1:this.volPopup?!1:(e=this,this.volPopup=new r({attachment:this.$el[0],host:this.model,models:this.model.get("volumeList"),selectAtBegin:this.model.get("volumeList")[0],canvas:this.canvas,onRemove:function(){return _.defer(function(){e.volPopup=null})}}),!1)},showGroup:function(){var e,t,n,r,s,u,a,f,l,c,h,p,d,v,m,g;if(!this.canvas.design.modeIsApp())return;u=o(this.model.design().credentialId(),this.type,this.model.design().region()),f=(this.model.groupMembers()||[]).slice(0),f.unshift({appId:this.model.get("appId")}),l=this.model.get("name"),t=[],n=this.iconUrl();for(r=h=0,d=f.length;h<d;r=++h){a=f[r],s=u.get(a.appId);if(!s){void 0;continue}s=s.attributes,c=s.blockDeviceMapping.length,m=s.blockDeviceMapping;for(p=0,v=m.length;p<v;p++){e=m[p];if(e.deviceName===s.rootDeviceName){--c;break}}t.push({name:""+l+"-"+r,id:a.appId,icon:n,volume:c,state:((g=s.instanceState)!=null?g.name:void 0)||"unknown"})}new i({attachment:this.$el[0],host:this.model,models:t,canvas:this.canvas})}},{isDirectParentType:function(e){return e!==t.RESTYPE.AZ},createResource:function(n,r,i){var o;if(!r.parent)return;switch(r.parent.type){case t.RESTYPE.SUBNET:return e.createResource(n,r,i);case t.RESTYPE.ASG:case"ExpandedAsg":if(i.cloneSource){notification("error",s.CANVAS.LAUNCH_CONFIGURATION_MUST_BE_CREATED_FROM_AMI_IN_RESOURCE_PANEL);return}return o=t.RESTYPE.LC,e.getClassByType(o).createResource(o,r,i);case t.RESTYPE.AZ:return r.parent=e.createResource(t.RESTYPE.SUBNET,{x:r.x+1,y:r.y+1,width:11,height:11,parent:r.parent},i),r.x+=2,r.y+=2,e.createResource(t.RESTYPE.INSTANCE,r,i)}}})}),define("wspace/awseditor/canvas/CeAsg",["CanvasElement","constant","CanvasManager","i18n!/nls/lang.js","CanvasView"],function(e,t,n,r,i){var s;return s=e.extend({type:t.RESTYPE.ASG,parentType:[t.RESTYPE.SUBNET],defaultSize:[15,15],events:{"mousedown .asg-dragger":"dragExpand"},isGroup:function(){return!0},size:function(){return{width:13,height:13}},dragExpand:function(e){return this.canvas.design.modeIsApp()||this.canvas.dragItem(e,{onDrop:this.onDropExpand}),!1},onDropExpand:function(e,t){var n,i,s,o,u;i=t.item,s=i.model,s.type==="ExpandedAsg"&&(s=s.get("originalAsg")),u=t.parent.model,n=Design.modelClassForType("ExpandedAsg"),o=new n({x:t.x,y:t.y,parent:u,originalAsg:s});if(o&&o.id)return;notification("error",sprintf(r.CANVAS.ERR_DROP_ASG,s.get("name"),u.parent().get("name")))},create:function(){var e,t,n;return e=this.model,t=this.canvas.svg,n=t.group().add([t.rect(129,129).move(1,1).radius(5).classes("asg-group"),t.use("asg_frame",!0).classes("asg-frame"),t.use("asg_prompt",!0).classes("asg-prompt"),t.use("asg_dragger").classes("asg-dragger tooltip").attr("data-tooltip",r.CANVAS.CVS_TIP_ASG_DRAGGER),t.plain("").move(4,14).classes("group-label")]).attr({"data-id":this.cid}).classes("canvasel "+this.type.split(".").join("-")),this.canvas.appendAsg(n),this.initNode(n,e.x(),e.y()),n},getLc:function(){return this.model.getLc()},labelWidth:function(e){return(e||this.size().width*i.GRID_WIDTH)-22},render:function(){return n.setLabel(this,this.$el.children("text"))},updateConnections:function(){var e,t,n,r,i;t=this.model.getLc();if(!t)return;i=this.canvas.getItem(t.id).connections();for(n=0,r=i.length;n<r;n++)e=i[n],e.update()},destroy:function(t){var n,r,i;n=this.model.get("expandedList");if(n&&n[0]){n=n[0],n.parent().addChild(this.model),r=n.get("x"),i=n.get("y"),n.remove(),this.moveBy(r-this.model.get("x"),i-this.model.get("y")),this.model.set({x:r,y:i});return}return e.prototype.destroy.apply(this,arguments)}},{createResource:function(t,n,r){var i,s;return n.lcId&&(s=n.lcId,delete n.lcId),n.x+=1,n.y+=1,i=e.createResource(t,n,r),i.setLc(s),i}}),s.extend({type:"ExpandedAsg",listenModelEvents:function(){this.listenTo(this.model.get("originalAsg"),"change:name",this.render)},label:function(){return(this.model.get("originalAsg")||this.model).get("name")},render:function(){return n.setLabel(this,this.$el.children("text"))}}),s}),define("wspace/awseditor/canvas/CeLc",["CanvasElement","constant","CanvasManager","i18n!/nls/lang.js","./CpVolume","./CpInstance","CloudResources"],function(e,t,n,r,i,s,o){return e.extend({type:t.RESTYPE.LC,portPosMap:{"launchconfig-sg-left":[10,20,e.constant.PORT_LEFT_ANGLE],"launchconfig-sg-right":[80,20,e.constant.PORT_RIGHT_ANGLE]},portDirMap:{"launchconfig-sg":"horizontal"},defaultSize:[9,9],events:{"mousedown .server-number-group":"showGroup","mousedown .volume-image":"showVolume","click .volume-image":"suppressEvent","click .server-number-group":"suppressEvent"},hover:function(e){var t,r,i,s,o,u,a,f;r=$(e.currentTarget),t=r.parent(),s=t[0].instance.transform();if(!n.hasClass(t,"AWS-AutoScaling-Group")&&!n.hasClass(t,"ExpandedAsg"))return;i=this.canvas.getLayer("layer_lc"),i.attr({transform:"translate("+s.x+" "+s.y+")","data-id":t.attr("data-id")}),i.append(r),f=this.connections();for(u=0,a=f.length;u<a;u++)o=f[u],n.addClass(o.$el,"hover")},hoverOut:function(e){var t,r,i,s,o,u,a;r=$(e.currentTarget),t=r.parent();if(!n.hasClass(t,"layer_lc"))return;s=t.attr("data-id"),t.attr("data-id",""),this.canvas.getItem(s).$el.children().eq(0).after(r[0]),a=this.connections();for(o=0,u=a.length;o<u;o++)i=a[o],n.removeClass(i.$el,"hover")},suppressEvent:function(){return!1},listenModelEvents:function(){this.listenTo(this.model,"change:connections",this.render),this.listenTo(this.model,"change:volumeList",this.render),this.listenTo(this.model,"change:imageId",this.render),this.listenTo(this.canvas,"switchMode",this.render),this.listenTo(this.canvas,"change:externalData",this.render),this.listenTo(this.model,"change:expandedList",function(){var e;return e=this,setTimeout(function(){if(!e.model.isRemoved())return e.render()},0)})},iconUrl:function(){var e;return this.model.isMesos()?"ide/ami/mesos-slave.png":(e=this.model.getAmi()||this.model.get("cachedAmi"),e?"ide/ami/"+e.osType+"."+e.architecture+"."+e.rootDeviceType+".png":"ide/ami/ami-not-available.png")},pos:function(e){var t,n;return e?n=this.canvas.getItem(e.parentNode.getAttribute("data-id")):(void 0,n=n=this.canvas.getItem(this.model.connectionTargets("LcUsage")[0].id)),n?(t=n.pos(),t.x+=2,t.y+=3,t):{x:0,y:0}},isTopLevel:function(){return!1},ensureLcView:function(){var e,t,n,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T;t=!1,s={},S=this.model.connectionTargets("LcUsage");for(d=0,y=S.length;d<y;d++){e=S[d],s[e.id]=e,x=e.get("expandedList");for(v=0,b=x.length;v<b;v++)n=x[v],s[n.id]=n}p=[],T=this.$el;for(m=0,w=T.length;m<w;m++)f=T[m],p.push(f);for(g=0,E=p.length;g<E;g++)f=p[g],o=$(f.parentNode).attr("data-id"),u=this.canvas.getItem(o),u?(a=u.model,s[a.id]?delete s[a.id]:(this.removeView(f),t=!0)):(this.removeView(f),t=!0);l=this.canvas.svg;for(h in s)a=s[h],i=a.type!=="ExpandedAsg",c=this.createNode({image:"ide/icon/cvs-instance.png",imageX:15,imageY:11,imageW:61,imageH:62,label:!0,labelBg:!0,sg:i}).add([l.image(MC.IMG_URL+this.iconUrl(),39,27).move(27,15).classes("ami-image"),l.use("port_diamond").move(10,20).attr({"class":"port port-blue tooltip","data-name":"launchconfig-sg","data-alias":"launchconfig-sg-left","data-tooltip":r.IDE.PORT_TIP_D}),l.use("port_diamond").move(80,20).attr({"class":"port port-blue tooltip","data-name":"launchconfig-sg","data-alias":"launchconfig-sg-right","data-tooltip":r.IDE.PORT_TIP_D}),l.image(MC.IMG_URL+"ide/icon/icn-vol.png",29,24).move(31,46).classes("volume-image"),l.plain("").move(45,58).classes("volume-number"),l.group().add([l.rect(20,14).move(36,2).radius(3).classes("server-number-bg"),l.plain("0").move(46,13).classes("server-number")]).classes("server-number-group")]).classes("canvasel fixed AWS-AutoScaling-LaunchConfiguration").move(20,30),this.addView(c),this.canvas.getItem(h).$el.children().eq(0).after(c.node),t=!0;t&&this.updateConnections()},render:function(e){var r,i,s,u,a,f,l,c,h,p;if(this.canvas.initializing&&!e)return;this.ensureLcView(),u=this.model,n.setLabel(this,this.$el.children(".node-label")),n.update(this.$el.children(".ami-image"),this.iconUrl(),"href"),f=u.get("volumeList")?u.get("volumeList").length:0,n.update(this.$el.children(".volume-number"),f),this.$el.children(".server-number-group").hide();if(u.design().modeIsApp()){this.$el.children(".server-number-group").show(),i=o(u.design().credentialId(),t.RESTYPE.ASG,u.design().region()),h=this.$el;for(l=0,c=h.length;l<c;l++){s=h[l],r=this.canvas.getItem(s.parentNode.getAttribute("data-id")).model,r=i.get((r.get("originalAsg")||r).get("appId"));if(!r)continue;r=r.attributes;if((p=r.Instances)!=null?p.length:void 0)a=$(s).children(".server-number-group").show(),n.update(a.children("text"),r.Instances.length)}}},destroy:function(t){var n,r,i;if(this.model.connections("LcUsage").length>1){r=this.canvas.getItem(t.parentNode.getAttribute("data-id"));if(!r)return;n=Design.modelClassForType("LcUsage"),i=r.model,i.type==="ExpandedAsg"&&(i=i.get("originalAsg")),(new n(i,this.model)).remove();return}return e.prototype.destroy.apply(this,arguments)},doDestroyModel:function(){var e;return(e=this.model.connections("LcUsage")[0])!=null?e.remove():void 0},showVolume:function(e){var t;return this.volPopup?!1:(t=this,this.canvas.design.modeIsApp()?!1:(this.volPopup=new i({attachment:$(e.currentTarget).closest("g")[0],host:this.model,models:this.model.get("volumeList"),canvas:this.canvas,onRemove:function(){return _.defer(function(){t.volPopup=null})}}),!1))},showGroup:function(e){var n,r,i,u,a,f,l,c,h,p,d,v,m,g,y,b;f=o(this.model.design().credentialId(),t.RESTYPE.INSTANCE,this.model.design().region()),c=this.model.get("name"),r=[],i=this.iconUrl(),g=this.model.groupMembers();for(u=p=0,v=g.length;p<v;u=++p){l=g[u],a=f.get(l.appId);if(!a){void 0;continue}a=a.attributes,h=a.blockDeviceMapping.length,y=a.blockDeviceMapping;for(d=0,m=y.length;d<m;d++){n=y[d];if(n.deviceName===a.rootDeviceName){--h;break}}r.push({name:""+c+"-"+u,id:l.appId,icon:i,volume:h,state:((b=a.instanceState)!=null?b.name:void 0)||"unknown"})}new s({attachment:$(e.currentTarget).closest(".canvasel")[0],host:this.model,models:r,canvas:this.canvas})}},{render:function(e){var n,r,i,s,o;s=e.design.componentsOfType(t.RESTYPE.LC),o=[];for(r=0,i=s.length;r<i;r++)n=s[r],o.push(e.getItem(n.id).render(!0));return o},createResource:function(t,n,r){var i,s;if(!n.parent)return;if(n.parent.getLc())return;return i=n.parent.get("originalAsg")||n.parent,delete n.parent,s=e.createResource(this.type,n,r),i.setLc(s),s}})}),define("wspace/awseditor/canvas/CeSgAsso",["CanvasElement","constant","CanvasManager","i18n!/nls/lang.js"],function(e,t,n,r){return e.extend({type:"SgAsso",initialize:function(n){var r,i,s;this.listenTo(this.model.getTarget(t.RESTYPE.SG),"change:name",this.render),this.canvas=r=n.canvas,this.$el=$(),r.__sgAssoToRender||(r.__sgAssoToRender={}),s=this.model.getOtherTarget(t.RESTYPE.SG).id,r.__sgAssoToRender[s]=this.cid,i=this,_.defer(function(){var e,t;t=r.__sgAssoToRender[s],delete r.__sgAssoToRender[s],e=r.getItem(t),e&&e.render()}),e.prototype.initialize.call(this,n)},remove:function(){this.render(),this.stopListening()},update:function(){},render:function(){var e,r,i,s,o,u,a;if(this.canvas.initializing)return;i=this.model,o=i.getOtherTarget(t.RESTYPE.SG),s=this.canvas.getItem(o.id);if(!s)return;a=i.sortedSgList(),a.length>5&&(a.length=5),e=s.$el.children(".node-sg-color-group").children(":first-child"),r=0;while(r<5)u=a[r],u?(n.update(e,u.color,"color"),n.update(e,u.get("name"),"tooltip")):(n.update(e,"none","color"),n.update(e,"","tooltip")),++r,e=e.next()}})}),define("wspace/awseditor/canvas/CeLine",["CanvasLine","constant","CanvasManager","i18n!/nls/lang.js","SGRulePopup"],function(e,t,n,r,i){return e.extend({type:"EniAttachment"}),e.extend({type:"RTB_Asso"}),e.extend({type:"RTB_Route",lineStyle:function(){return 1},createLine:function(t){var n,r;return n=this.canvas.svg,r=e.prototype.createLine.call(this,t),r.add(n.path(t).classes("dash-line")),r}}),e.extend({type:t.RESTYPE.VPN}),e.extend({type:"ElbSubnetAsso"}),e.extend({type:"ElbAmiAsso"},{connect:function(e,t,n){return new i(t,n),new e(t,n,void 0,{createByUser:!0})}}),e.extend({type:"DbReplication",select:function(){},createLine:function(t){var n,r;return n=this.canvas.svg,r=e.prototype.createLine.call(this,t),r.add(n.path(t).classes("dash-line")),r}}),e}),define("wspace/awseditor/canvas/CeSgLine",["CanvasLine","constant","CanvasManager","i18n!/nls/lang.js","SGRulePopup"],function(e,t,n,r,i){return e.extend({type:"SgRuleLine",createLine:function(e){var t,n;return t=this.canvas.svg,n=t.group().add([t.path(e),t.path(e).classes("fill-line")]).attr({"data-id":this.cid}).classes("line "+this.type.replace(/\./g,"-")),this.canvas.appendSgline(n),n},renderConnection:function(t,n,r,i){return e.prototype.renderConnection.call(this,t,n,r,i)},lineStyle:function(){return this.canvas.lineStyle()}},{connect:function(e,t,n){new i(t,n)}})}),define("wspace/awseditor/canvas/CeDbInstance",["CanvasElement","constant","CanvasManager","./CpVolume","./CpInstance","i18n!/nls/lang.js","CloudResources","DbSubnetGPopup"],function(e,t,n,r,i,s,o,u){return e.extend({type:t.RESTYPE.DBINSTANCE,parentType:[t.RESTYPE.DBSBG,t.RESTYPE.VPC],defaultSize:[9,9],portPosMap:{"db-sg-left":[10,35,e.constant.PORT_LEFT_ANGLE],"db-sg-right":[79,35,e.constant.PORT_RIGHT_ANGLE],replica:[45,45,e.constant.PORT_DOWN_ANGLE]},portDirMap:{"db-sg":"horizontal"},portPosition:function(t,n){var r;return r=this.portPosMap[t],t==="replica"&&(r=r.slice(0),this.model.master()?(r[1]=45,r[2]=e.constant.PORT_2D_V_ANGLE):(r[1]=61,r[2]=e.constant.PORT_DOWN_ANGLE)),r},typeIcon:function(){return"ide/icon/icn-"+this.model.category()+".png"},engineIcon:function(){return"ide/icon/rds-"+(this.model.get("engine")||"").split("-")[0]+".png"},events:{"mousedown .dbreplicate":"replicate","mousedown .dbrestore":"restore"},listenModelEvents:function(){this.listenTo(this.model,"change:backupRetentionPeriod",this.render),this.listenTo(this.model,"change:connections",this.updateReplicaTip),this.listenTo(this.canvas,"change:externalData",this.updateState)},updateState:function(){var e,t,n,r;t=this.model,r=this.$el.children(".res-state");if(r)return e=o(t.design().credentialId(),t.type,t.design().region()).get(t.get("appId")),n=(e!=null?e.get("DBInstanceStatus"):void 0)||"unknown",r.data("tooltip",n).attr("data-tooltip",n).attr("class","res-state tooltip "+n)},updateReplicaTip:function(e){e.type==="DbReplication"&&this.render()},replicate:function(e){var t,n,r;if(!this.canvas.design.modeIsApp()&&this.model.slaves().length<5){t=o(this.model.design().credentialId(),this.model.type,this.model.design().region()).get(this.model.get("appId")),t&&(n=(r=t.get("BackupRetentionPeriod"))!==0&&r!=="0");if(this.model.autobackup()&&this.model.get("appId")&&!n)return!1;this.canvas.dragItem(e,{onDrop:this.onDropReplicate})}return!1},restore:function(e){return this.canvas.design.modeIsApp()||this.canvas.dragItem(e,{onDrop:this.onDropRestore}),!1},onDropReplicate:function(e,n){var r,i,o,u,a;a=n.parent.model;if(a!==n.item.model.parent()){notification("error",s.NOTIFY.READ_REPLICA_MUST_BE_DROPPED_IN_THE_SAME_SBG);return}i=n.item.model.get("name"),o=i.match(/(.+-replica)(\d*)$/),o?i=o[1]+((parseInt(o[2],10)||0)+1):i+="-replica",r=Design.modelClassForType(t.RESTYPE.DBINSTANCE),u=new r({x:n.x,y:n.y,name:i,parent:a,sourceId:n.item.model.id},{master:n.item.model}),u.id&&n.item.canvas.selectItem(u.id)},onDropRestore:function(e,n){var r,i,s,o;o=n.parent.model,i=n.item.model.get("name"),r=Design.modelClassForType(t.RESTYPE.DBINSTANCE),s=new r({x:n.x,y:n.y,name:"from-"+i,parent:o},{master:n.item.model,isRestore:!0}),s.id&&n.item.canvas.selectItem(s.id)},create:function(){var e,n,r;return e=this.model,n=this.canvas.svg,r=this.createNode({image:"ide/icon/cvs-rds.png",imageX:14,imageY:8,imageW:62,imageH:66,label:!0,labelBg:!0,sg:!0}).add([n.image(MC.IMG_URL+this.engineIcon(),46,33).move(22,18).classes("engine-image"),n.use("port_diamond").attr({"class":"port port-blue tooltip","data-name":"db-sg","data-alias":"db-sg-left","data-tooltip":s.IDE.PORT_TIP_D}),n.use("port_diamond").attr({"class":"port port-blue tooltip","data-name":"db-sg","data-alias":"db-sg-right","data-tooltip":s.IDE.PORT_TIP_D})]),this.model.get("engine")===t.DB_ENGINE.MYSQL&&(r.add(n.use("port_diamond").attr({"class":"port","data-name":"replica"}),0),this.model.master()?(r.add(n.plain("REPLICA").move(45,60).classes("replica-text")),r.add(n.use("replica_dragger").attr({"class":"dbreplicate tooltip"}))):(r.add(n.plain("MASTER").move(45,60).classes("master-text")),r.add(n.use("replica_dragger").attr({"class":"dbreplicate tooltip"})))),!e.design().modeIsStack()&&e.get("appId")&&r.add(n.circle(8).move(63,15).classes("res-state unknown")),r.add(n.use("restore_dragger").attr({"class":"dbrestore tooltip"})),this.canvas.appendNode(r),this.initNode(r,e.x(),e.y()),r},render:function(){var e,r,i,u,a,f,l,c;u=this.model,n.setLabel(this,this.$el.children(".node-label")),n.update(this.$el.children(".type-image"),this.typeIcon(),"href"),n.update(this.$el.children(".engine-image"),this.engineIcon(),"href"),n.toggle(this.$el.children(".master-text"),u.design().modeIsApp()&&u.slaves().length),u.get("engine")===t.DB_ENGINE.MYSQL&&(e=this.$el.children(".dbreplicate"),r=o(u.design().credentialId(),u.type,u.design().region()).get(u.get("appId")),r&&(i=""+r.get("BackupRetentionPeriod")!="0"),u.slaves().length<5?(n.removeClass(e,"disabled"),u.autobackup()?(f=s.IDE.RES_TIP_DRAG_TO_DUPLICATE,u.category()==="replica"&&u.master()&&u.master().master()?n.toggle(e,!1):(n.toggle(e,!0),u.get("appId")&&!i&&(f=s.IDE.RES_TIP_PLEASE_WAIT_AUTOBACKUP_ENABLE_TO_CREATE_REPLICA,n.addClass(e,"disabled")))):(f=s.IDE.RES_TIP_DRAG_TO_DUPLICATE,n.toggle(e,!1))):(f=s.IDE.RES_TIP_CANT_CREATE_MORE_REPLICA,n.toggle(e,!0),n.addClass(e,"disabled")),n.update(e,f,"tooltip"),u.getSourceDBForRestore()&&n.toggle(e,!1)),e=this.$el.children(".dbrestore"),n.toggle(e,!!u.get("appId")),n.update(e,s.IDE.RES_TIP_DRAG_TO_RESTORE,"tooltip"),r=o(u.design().credentialId(),u.type,u.design().region()).get(u.get("appId")),r&&(a=r.get("PendingModifiedValues"),((l=r.get("BackupRetentionPeriod"))===0||l==="0"||a&&((c=a.BackupRetentionPeriod)===0||c==="0"))&&n.toggle(e,!1)),this.updateState()}},{isDirectParentType:function(e){return e!==t.RESTYPE.VPC},createResource:function(n,r,i){var o;if(!r.parent)return;if(i&&((o=i.cloneSource)!=null?o.master():void 0)){if(i.cloneSource.master().slaves().length>5){notification("error",s.NOTIFY.CANNOT_CREATE_MORE_READ_REPLICA);return}i.master=i.cloneSource.master(),delete i.cloneSource}switch(r.parent.type){case t.RESTYPE.DBSBG:return e.createResource(n,r,i);case t.RESTYPE.VPC:r.parent=e.createResource(t.RESTYPE.DBSBG,{x:r.x+1,y:r.y+1,width:11,height:11,parent:r.parent},i);if(!r.parent.id){notification("error",s.NOTIFY.CANNOT_CREATE_SBG_DUE_TO_INSUFFICIENT_SUBNETS);return}return r.x+=2,r.y+=2,new u({model:r.parent}),e.createResource(t.RESTYPE.DBINSTANCE,r,i)}}})}),define("wspace/awseditor/canvas/CeDbSubnetGroup",["CanvasElement","constant","CanvasManager","i18n!/nls/lang.js","CanvasView","DbSubnetGPopup"],function(e,t,n,r,i,s){return e.extend({type:t.RESTYPE.DBSBG,parentType:[t.RESTYPE.VPC],defaultSize:[19,19],events:{"mouseenter .tooltip":"hoverLabel","mouseleave .tooltip":"hoverOutLabel"},hoverLabel:function(e){var t,r,i,s,o;o=this.model.connectionTargets("SubnetgAsso");for(i=0,s=o.length;i<s;i++)r=o[i],t=this.canvas.getItem(r.id),t&&n.addClass(t.$el,"highlight")},hoverOutLabel:function(e){var t,r,i,s,o;o=this.model.connectionTargets("SubnetgAsso");for(i=0,s=o.length;i<s;i++)r=o[i],t=this.canvas.getItem(r.id),t&&n.removeClass(t.$el,"highlight")},listenModelEvents:function(){this.listenTo(this.model,"change:connections",this.render)},labelWidth:function(e){return(e||this.model.width()*i.GRID_WIDTH)-20},create:function(){var e,t,n;return t=this.canvas.svg,n=this.canvas.appendSubnet(this.createGroup()),n.add([t.use("sbg_info"),t.rect(16,14).move(4,4).classes("tooltip")]),$(n.node).children(".group-label").attr({"class":"tooltip group-label",x:"17",y:"14"}),e=this.model,this.initNode(n,e.x(),e.y()),n},render:function(){var e,t,s,o,u,a;e=this.model,n.setLabel(this,this.$el.children("text")),this.$el[0].instance.move(e.x()*i.GRID_WIDTH,e.y()*i.GRID_WIDTH),s=[],a=e.connectionTargets("SubnetgAsso");for(o=0,u=a.length;o<u;o++)t=a[o],s.push(t.get("name"));n.update(this.$el.children(".tooltip"),s.join(", ")||r.CANVAS.CVS_NO_SUBNET_ASSIGNED_TO_SG,"tooltip")},doDestroyModel:function(){return this.hoverOut(),e.prototype.doDestroyModel.apply(this,arguments)}},{createResource:function(n,r,i){var o;if(!r.parent)return;o=e.createResource(t.RESTYPE.DBSBG,r,i),new s({model:o})}})}),define("wspace/awseditor/AwsDeps",["./model/connection/EniAttachment","./model/connection/VPNConnection","./model/connection/DbReplication","./model/InstanceModel","./model/EniModel","./model/VolumeModel","./model/AclModel","./model/AsgModel","./model/AzModel","./model/AzModel","./model/CgwModel","./model/ElbModel","./model/LcModel","./model/KeypairModel","./model/SslCertModel","./model/RtbModel","./model/SgModel","./model/SubnetModel","./model/VpcModel","./model/IgwModel","./model/VgwModel","./model/SnsModel","./model/StorageModel","./model/ScalingPolicyModel","./model/DBSbgModel","./model/DBInstanceModel","./model/DBOgModel","./model/MesosMasterModel","./model/MesosSlaveModel","./model/MesosLcModel","./model/TagModel","./model/AsgTagModel","./model/deserializeVisitor/JsonFixer","./model/deserializeVisitor/EipMerge","./model/deserializeVisitor/FixOldStack","./model/deserializeVisitor/AsgExpandor","./model/deserializeVisitor/ElbSgNamePatch","./model/serializeVisitor/EniIpAssigner","./model/serializeVisitor/AppToStack","./canvas/CanvasViewAws","./canvas/CanvasViewAwsLayout","./canvas/CeVpc","./canvas/CeAz","./canvas/CeSubnet","./canvas/CeRtb","./canvas/CeIgw","./canvas/CeVgw","./canvas/CeCgw","./canvas/CeElb","./canvas/CeEni","./canvas/CeInstance","./canvas/CeAsg","./canvas/CeLc","./canvas/CeSgAsso","./canvas/CeLine","./canvas/CeSgLine","./canvas/CeDbInstance","./canvas/CeDbSubnetGroup"],function(){}),define("wspace/awseditor/AwsEditorStack",["CoreEditor","OpsModel","./AwsViewStack","./model/DesignAws","CloudResources","constant","Credential","./AwsDeps"],function(e,t,n,r,i,s,o){return e.extend({type:"AwsEditorStack",viewClass:n,designClass:r,title:function(){return(this.design||this.opsModel).get("name")+" - stack"},fetchData:function(){var e,t,n,r;return n=this.opsModel.get("region"),r=this.opsModel.getJsonData().agent.module,e=this.opsModel.credentialId(),t=[App.model.fetchStateModule(r.repo,r.tag),i(e,s.RESTYPE.AZ,n).fetch(),i(e,s.RESTYPE.SNAP,n).fetch(),i(e,"QuickStartAmi",n).fetch(),i(e,"MyAmi",n).fetch(),i(e,"FavoriteAmi",n).fetch(),this.fetchAmiData(),this.fetchRdsData(!1)],Q.all(t)},fetchAmiData:function(){var e,t,n,r,o,u;n=this.opsModel.getJsonData(),r={},u=n.component;for(o in u){e=u[o];if(e.type===s.RESTYPE.INSTANCE||e.type===s.RESTYPE.LC)t=e.resource.ImageId,t&&(r[t]=!0)}return i(this.opsModel.credentialId(),s.RESTYPE.AMI,this.opsModel.get("region")).fetchAmis(_.keys(r))},isRdsDisabled:function(){return!!this.__disableRds},fetchRdsData:function(e){var t,n,r,o;return e==null&&(e=!0),o=this,r=this.opsModel.get("region"),e?n="fetchForce":n="fetch",t=this.opsModel.credentialId(),Q.all([i(t,s.RESTYPE.DBENGINE,r)[n](),i(t,s.RESTYPE.DBOG,r)[n](),i(t,s.RESTYPE.DBSNAP,r)[n]()]).then(function(){if(o.__disableRds!==!1)return o.__disableRds=!1,o.trigger("toggleRdsFeature",!0)},function(e){if(e.awsErrorCode){void 0,o.__disableRds=!0,o.trigger("toggleRdsFeature",!1);return}throw e})},isModified:function(){return this.opsModel.isPersisted()?this.design&&this.design.isModified():!1}},{canHandle:function(e){return e.opsModel?e.opsModel.type===t.Type.Amazon&&e.opsModel.isStack():!1}})}),define("wspace/awseditor/AwsViewApp",["CoreEditorViewApp","./subviews/ResourcePanel","./subviews/PropertyPanel","./subviews/Toolbar","./subviews/Statusbar","./canvas/CanvasViewAws","event"],function(e,t,n,r,i,s,o){return e.extend({constructor:function(o){return _.extend(o,{TopPanel:r,RightPanel:n,LeftPanel:t,BottomPanel:i,CanvasView:s}),e.apply(this,arguments)},showProperty:function(){o.trigger(o.FORCE_OPEN_PROPERTY)},onItemSelected:function(e,t){o.trigger(o.OPEN_PROPERTY,e,t)},showStateEditor:function(){var e;e=this.workspace.getSelectedComponent(),e&&o.trigger(o.SHOW_STATE_EDITOR,e.id)}})}),define("wspace/awseditor/AwsEditorApp",["CoreEditorApp","./AwsViewApp","./model/DesignAws","./AwsEditorStack","OpsModel","CloudResources","constant","ApiRequest","./model/MesosMasterModel","./AwsDeps"],function(e,t,n,r,i,s,o,u,a){return e.extend({type:"AwsEditorApp",viewClass:t,designClass:n,fetchData:function(){var e,t,n,r;return n=this,t=this.opsModel.get("region"),r=this.opsModel.getJsonData().agent.module,e=this.opsModel.credentialId(),Q.all([App.model.fetchStateModule(r.repo,r.tag),s(e,o.RESTYPE.AZ,t).fetch(),s(e,o.RESTYPE.SNAP,t).fetch(),s(e,o.RESTYPE.DHCP,t).fetch(),s(e,"QuickStartAmi",t).fetch(),s(e,"MyAmi",t).fetch(),s(e,"FavoriteAmi",t).fetch(),this.loadVpcResource(),this.fetchAmiData(),this.fetchRdsData(!1)]).fail(function(e){return n.__handleDataError(e)})},__handleDataError:function(e){if(e.error===286){this.view.showVpcNotExist(this.opsModel.get("name"),function(e){return function(){return e.opsModel.terminate(!0)}}(this)),this.remove();return}throw e},initEditor:function(){e.prototype.initEditor.call(this),this.opsModel.isMesos()&&this.mesosJobs()},cleanup:function(){e.prototype.cleanup.call(this),this.cleanupMesosJobs()},awake:function(){return e.prototype.awake.call(this),this.__inited&&this.mesosJobs(),null},sleep:function(){return e.prototype.sleep.call(this),this.cleanupMesosJobs(),null},fetchAmiData:r.prototype.fetchAmiData,fetchRdsData:r.prototype.fetchRdsData,isRdsDisabled:r.prototype.isRdsDisabled,mesosJobs:function(){var e,t;if(!this.opsModel.isMesos())return;e=3e4,t=this,this.updateMesosInfo().then(function(){t.isRemoved()}).fin(function(){if(t.isRemoved())return;if(!t.isAwake())return;return t.mesosSchedule=setTimeout(function(){return t.mesosJobs()},e),null})},setMesosData:function(e){var t,n,r,i,s,o,u,f,l,c,h,p;return t=e.frameworks[0],n=a.getMasterIPs(),i=e.leader.split("@")[1],r=i.split(":"),o=r[0],u=n[o],s=r[1],t&&(l=t.webui_url.slice(7),f=l.split(":"),h=f[0],p=n[h],c=f[1]),e={framework:t&&"marathon"||"",leaderIp:u,leaderPort:s,marathonIp:p,marathonPort:c,slaves:e.slaves},this.view.workspace.__marathonIsReady=!0,this.opsModel.setMesosData(e)},updateMesosInfo:function(){var e,t;return t=this,this.mesosSchedule=null,e=[],e.push(u("marathon_info",{key_id:this.opsModel.credentialId(),master_ips:a.getMasterIPs()}).then(function(e){return t.setMesosData(e)},function(e){return t.view.showMarathonNotReady()})),Q.all(e)},cleanupMesosJobs:function(){this.mesosSchedule&&(clearTimeout(this.mesosSchedule),this.mesosSchedule=null)}},{canHandle:function(e){return e.opsModel?e.opsModel.type===i.Type.Amazon&&e.opsModel.isApp()&&!e.opsModel.isProcessing():!1}})}),define("wspace/awseditor/EditorAws",function(){});