define(["backbone","constant","../template/TplPanel","./panels/ResourcePanel","./panels/ConfigPanel","./panels/PropertyPanel","StateEditorView"],function(e,t,n,r,i,s,o){var u,a;return u={resource:r,config:i,property:s,state:o},a={uid:"",type:"default"},e.View.extend({events:{"click .anchor li":"__scrollTo","click .option-group-head":"__updateRightPanelOption"},__openArgs:a,__currentPanel:"resource",initialize:function(e){return _.extend(this,e),this.workspace.design.mode()==="app"&&(this.__currentPanel="config"),this.render()},render:function(){return this.setElement(this.parent.$el.find(".OEPanelRight")),this.$el.html(n({})),this.open(this.__currentPanel),this},renderSubPanel:function(e,t){var n;return t=_.extend({workspace:this.workspace,panel:this},t),$(document.activeElement).filter("input, textarea").blur(),(n=this.subPanel)!=null&&n.remove(),this.subPanel=new e(t),this.$(".panel-body").html(this.subPanel.render().el),this.renderStateCount(t),this.__restoreAccordion()},renderStateCount:function(e){var n,r,i,s;return n=this.parent.$el.find(".sidebar-title a.state .state-count"),e&&e.type===t.RESTYPE.OSSERVER?(n.show(),r=Design.instance().component(e.uid),s=r.get("state"),i=0,s&&_.isArray(s)&&(i=s.length),n.text(i)):n.hide()},scrollTo:function(e){var t,n,r,i;return t=this.$(".panel-body"),n=$("section."+e),i=t.offset().top,r=n.offset().top-i+t.scrollTop(),t.animate({scrollTop:r})},open:function(e,t){var n,r,i;t==null&&(t=this.__openArgs),r=this.__currentPanel,n=_.extend({},this.__openArgs),this.__openArgs=t,this.__currentPanel=e,i=u[e];if(!i)return;if(this.hidden())return;return this.$el.removeClass("hide"),this.hideFloatPanel(),this.$el.prop("class","OEPanelRight "+e),this.$el.closest("#OpsEditor").find(".sidebar-title").prop("class","sidebar-title "+e),this.renderSubPanel(i,t),this},floatPanelShowCount:0,showFloatPanel:function(e,t){return this.floatPanelShowCount++,e&&this.$(".panel-float").html(e),this.$(".panel-float").removeClass("hidden"),_.defer(function(e){return function(){return e.$(".panel-body").one("click",e.__hideFloatPanel(e.floatPanelShowCount,t))}}(this))},__hideFloatPanel:function(e,t){var n;return n=this,function(){if(e===n.floatPanelShowCount)return n.hideFloatPanel(),typeof t=="function"?t():void 0}},hideFloatPanel:function(){return this.$(".panel-float").addClass("hidden")},show:function(){return this.$el.removeClass("hidden"),this},hide:function(){return this.$el.addClass("hidden"),$(".sidebar-title").prop("class","sidebar-title"),this},shown:function(){return!this.$el.hasClass("hidden")},hidden:function(){return!this.shown()},openResource:function(e){return this.open("resource",e)},openState:function(e){return this.open("state",e)},openProperty:function(e){return this.open("property",e)},openConfig:function(e){return this.open("config",e)},openCurrent:function(e){return this.workspace.design.mode()==="app"&&this.__currentPanel==="resource"&&(this.__currentPanel="config"),this.open(this.__currentPanel,e)},refresh:function(){return this.openCurrent.apply(this,arguments)},__openOrHidePanel:function(e){var t;return t=$(e.currentTarget).attr("data-target"),this.__currentPanel===t&&this.shown()?this.hide():(this.show(),this.open(t,this.__openArgs))},__scrollTo:function(e){var t;return t=$(e.currentTarget).data("scrollTo"),this.scrollTo(t)},__updateRightPanelOption:function(e){var t,n,r,i,s,o;n=$(e.currentTarget);if(n.is("button")||n.is("a"))return;r=n.hasClass("expand"),t=n.next(),r?t.css("display","block").slideUp(200):t.slideDown(200),n.toggleClass("expand"),this.__optionStates==null&&(this.__optionStates={});if(!n.closest(".panel-body").size())return;return i=""+this.__currentPanel+"_"+this.workspace.design.mode()+"_"+((o=this.__openArgs)!=null?o.uid:void 0),s=_.map(this.$el.find(".panel-body").find(".option-group-head"),function(e){return $(e).hasClass("expand")}),this.__optionStates[i]=s,!1},__restoreAccordion:function(){var e,t,n,r;e=""+this.__currentPanel+"_"+this.workspace.design.mode()+"_"+((n=this.__openArgs)!=null?n.uid:void 0);if(!(t=(r=this.__optionStates)!=null?r[e]:void 0))return;return this.$(".option-group-head").each(function(e){return $(this).toggleClass("expand",t[e])})}})});