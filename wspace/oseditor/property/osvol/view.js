define(["constant","../OsPropertyView","./template","CloudResources"],function(e,t,n,r){return t.extend({events:{"change .selection[data-target]":"updateAttribute"},render:function(){var e;return this.$el.html(n.stackTemplate(this.getRenderData())),((e=this.model)!=null?e.get("snapshot"):void 0)&&this.bindSelectizeEvent(),this},bindSelectizeEvent:function(){var t,n,i,s;return s=this,this.snapshots||(this.snapshots=r(e.RESTYPE.OSSNAP,Design.instance().region())),n=_.map(this.snapshots.models,function(e){var t,n;return t=e.get("name"),n=e.get("id"),{text:t,value:n}}),i=this.$el.find("#property-os-volume-snapshot"),i.on("select_initialize",function(){return this.selectize.addOption(n),this.selectize.setValue(s.model.get("snapshot"))}),t=this.$el.find("#property-os-volume-size"),i.on("change",function(){return _.defer(function(){return t.val(s.model.get("size"))})})},updateAttribute:function(e){var n,r;t.prototype.updateAttribute.apply(this,arguments),n=e.currentTarget||e.target;if($(n).data("target")==="snapshot")return r=this.snapshots.get($(n).val()).get("size"),this.model.set("size",r)},selectTpl:{snapshotOption:function(t){var i,s;return s=r(e.RESTYPE.OSSNAP,Design.instance().region()),i=s.get(t.value),n.snapshotOption(i!=null?i.toJSON():void 0)}}},{handleTypes:[e.RESTYPE.OSVOL],handleModes:["stack","appedit"]})});