define(["ComplexResModel","constant","./MarathonDepIn","i18n!/nls/lang.js"],function(e,t,n,r){var i,s,o,u;return i=["#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50","#f1c40f","#e67e22","#e74c3c","#f39c12","#d35400","#c0392b","#7f8c8d","#95a5a6"],o=function(e){if(!_.isObject(e))return;return _.each(e,function(t,n){if(!_.isArray(t))return o(t);if(!t.length)return delete e[n]})},u=function(e){var t;return t=$.extend(!0,{},e),o(t),t},s=e.extend({type:t.RESTYPE.MRTHAPP,newNameTmpl:"app",defaults:function(){return{color:i[Math.round(Math.random()*i.length)],container:{docker:{},volumes:[]},cpus:1.5,mem:256,instances:3,constraints:[],version:"",upgradeStrategy:{minimumHealthCapacity:.5,maximumOverCapacity:.2}}},path:function(){var e,t;e=[],t=this;while(t)e.unshift(t.get("name")),t=t.parent();return("/"+e.join("/")).replace(/\/+/g,"/")},serialize:function(){var e,t,n,r,i,s;void 0,n={id:this.get("name"),container:this.getContainerJson()},s=["cpus","mem","instances","cmd","args","env","ports","executor","uris","constraints","healthChecks","upgradeStrategy"];for(r=0,i=s.length;r<i;r++)t=s[r],this.get(t)&&(n[t]=this.get(t));return e={uid:this.id,type:this.type,toplevel:!this.parent(),color:this.get("color"),description:this.get("description"),version:this.get("version"),resource:u(n)},{component:e,layout:this.generateLayout()}},getContainerJson:function(){return _.extend({type:"DOCKER"},this.container())},setDescription:function(e){return this.set("description",e)},container:function(){var e;return e=this.get("container"),e.docker.image=this.get("image"),e},isReparentable:function(e){return!e||!_.find(e.children(),function(e){return e.type===t.RESTYPE.MRTHGROUP})}},{handleTypes:t.RESTYPE.MRTHAPP,deserialize:function(e,t,n){var r,i,o,u,a;void 0,r={id:e.uid,name:e.resource.id,parent:t.groupUId?n(t.groupUId):null,description:e.description,container:e.resource.container,image:e.resource.container.docker.image,color:e.color,version:e.version||"",x:t.coordinate[0],y:t.coordinate[1]},a=["cpus","mem","instances","cmd","args","env","ports","executor","uris","constraints","healthChecks","upgradeStrategy"];for(o=0,u=a.length;o<u;o++)i=a[o],e.resource[i]&&(r[i]=e.resource[i]);return new s(r)},postDeserialize:function(e,t){var r,i,s,o;o=e.resource.dependencies||[];for(i=0,s=o.length;i<s;i++)r=o[i],new n(Design.instance().component(e.uid),r)}}),s});